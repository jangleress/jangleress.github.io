function colorToRGBA(a) {
    var b, c;
    return b = document.createElement("canvas"), b.height = 1, b.width = 1, c = b.getContext("2d"), c.fillStyle = a, c.fillRect(0, 0, 1, 1), c.getImageData(0, 0, 1, 1).data
}

function numberWithCommas(a) {
    return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")
}

function isNumber(a) {
    return !isNaN(parseFloat(a)) && isFinite(a)
}

function convertToSlug(a) {
    return a.toLowerCase().replace(/ /g, "-").replace(/[^\w-]+/g, "")
}

function waitFor(a, b, c) {
    c = "undefined" != typeof c ? c : 100, a() ? b() : setTimeout(function() {
        waitFor(a, b)
    }, c)
}
if (! function(a, b) {
        "object" == typeof module && "object" == typeof module.exports ? module.exports = a.document ? b(a, !0) : function(a) {
            if (!a.document) throw new Error("jQuery requires a window with a document");
            return b(a)
        } : b(a)
    }("undefined" != typeof window ? window : this, function(a, b) {
        function c(a) {
            var b = "length" in a && a.length,
                c = ea.type(a);
            return "function" !== c && !ea.isWindow(a) && (!(1 !== a.nodeType || !b) || ("array" === c || 0 === b || "number" == typeof b && b > 0 && b - 1 in a))
        }

        function d(a, b, c) {
            if (ea.isFunction(b)) return ea.grep(a, function(a, d) {
                return !!b.call(a, d, a) !== c
            });
            if (b.nodeType) return ea.grep(a, function(a) {
                return a === b !== c
            });
            if ("string" == typeof b) {
                if (ma.test(b)) return ea.filter(b, a, c);
                b = ea.filter(b, a)
            }
            return ea.grep(a, function(a) {
                return ea.inArray(a, b) >= 0 !== c
            })
        }

        function e(a, b) {
            do a = a[b]; while (a && 1 !== a.nodeType);
            return a
        }

        function f(a) {
            var b = ua[a] = {};
            return ea.each(a.match(ta) || [], function(a, c) {
                b[c] = !0
            }), b
        }

        function g() {
            oa.addEventListener ? (oa.removeEventListener("DOMContentLoaded", h, !1), a.removeEventListener("load", h, !1)) : (oa.detachEvent("onreadystatechange", h), a.detachEvent("onload", h))
        }

        function h() {
            (oa.addEventListener || "load" === event.type || "complete" === oa.readyState) && (g(), ea.ready())
        }

        function i(a, b, c) {
            if (void 0 === c && 1 === a.nodeType) {
                var d = "data-" + b.replace(za, "-$1").toLowerCase();
                if (c = a.getAttribute(d), "string" == typeof c) {
                    try {
                        c = "true" === c || "false" !== c && ("null" === c ? null : +c + "" === c ? +c : ya.test(c) ? ea.parseJSON(c) : c)
                    } catch (a) {}
                    ea.data(a, b, c)
                } else c = void 0
            }
            return c
        }

        function j(a) {
            var b;
            for (b in a)
                if (("data" !== b || !ea.isEmptyObject(a[b])) && "toJSON" !== b) return !1;
            return !0
        }

        function k(a, b, c, d) {
            if (ea.acceptData(a)) {
                var e, f, g = ea.expando,
                    h = a.nodeType,
                    i = h ? ea.cache : a,
                    j = h ? a[g] : a[g] && g;
                if (j && i[j] && (d || i[j].data) || void 0 !== c || "string" != typeof b) return j || (j = h ? a[g] = W.pop() || ea.guid++ : g), i[j] || (i[j] = h ? {} : {
                    toJSON: ea.noop
                }), ("object" == typeof b || "function" == typeof b) && (d ? i[j] = ea.extend(i[j], b) : i[j].data = ea.extend(i[j].data, b)), f = i[j], d || (f.data || (f.data = {}), f = f.data), void 0 !== c && (f[ea.camelCase(b)] = c), "string" == typeof b ? (e = f[b], null == e && (e = f[ea.camelCase(b)])) : e = f, e
            }
        }

        function l(a, b, c) {
            if (ea.acceptData(a)) {
                var d, e, f = a.nodeType,
                    g = f ? ea.cache : a,
                    h = f ? a[ea.expando] : ea.expando;
                if (g[h]) {
                    if (b && (d = c ? g[h] : g[h].data)) {
                        ea.isArray(b) ? b = b.concat(ea.map(b, ea.camelCase)) : b in d ? b = [b] : (b = ea.camelCase(b), b = b in d ? [b] : b.split(" ")), e = b.length;
                        for (; e--;) delete d[b[e]];
                        if (c ? !j(d) : !ea.isEmptyObject(d)) return
                    }(c || (delete g[h].data, j(g[h]))) && (f ? ea.cleanData([a], !0) : ca.deleteExpando || g != g.window ? delete g[h] : g[h] = null)
                }
            }
        }

        function m() {
            return !0
        }

        function n() {
            return !1
        }

        function o() {
            try {
                return oa.activeElement
            } catch (a) {}
        }

        function p(a) {
            var b = Ka.split("|"),
                c = a.createDocumentFragment();
            if (c.createElement)
                for (; b.length;) c.createElement(b.pop());
            return c
        }

        function q(a, b) {
            var c, d, e = 0,
                f = typeof a.getElementsByTagName !== wa ? a.getElementsByTagName(b || "*") : typeof a.querySelectorAll !== wa ? a.querySelectorAll(b || "*") : void 0;
            if (!f)
                for (f = [], c = a.childNodes || a; null != (d = c[e]); e++) !b || ea.nodeName(d, b) ? f.push(d) : ea.merge(f, q(d, b));
            return void 0 === b || b && ea.nodeName(a, b) ? ea.merge([a], f) : f
        }

        function r(a) {
            Ea.test(a.type) && (a.defaultChecked = a.checked)
        }

        function s(a, b) {
            return ea.nodeName(a, "table") && ea.nodeName(11 !== b.nodeType ? b : b.firstChild, "tr") ? a.getElementsByTagName("tbody")[0] || a.appendChild(a.ownerDocument.createElement("tbody")) : a
        }

        function t(a) {
            return a.type = (null !== ea.find.attr(a, "type")) + "/" + a.type, a
        }

        function u(a) {
            var b = Va.exec(a.type);
            return b ? a.type = b[1] : a.removeAttribute("type"), a
        }

        function v(a, b) {
            for (var c, d = 0; null != (c = a[d]); d++) ea._data(c, "globalEval", !b || ea._data(b[d], "globalEval"))
        }

        function w(a, b) {
            if (1 === b.nodeType && ea.hasData(a)) {
                var c, d, e, f = ea._data(a),
                    g = ea._data(b, f),
                    h = f.events;
                if (h) {
                    delete g.handle, g.events = {};
                    for (c in h)
                        for (d = 0, e = h[c].length; e > d; d++) ea.event.add(b, c, h[c][d])
                }
                g.data && (g.data = ea.extend({}, g.data))
            }
        }

        function x(a, b) {
            var c, d, e;
            if (1 === b.nodeType) {
                if (c = b.nodeName.toLowerCase(), !ca.noCloneEvent && b[ea.expando]) {
                    e = ea._data(b);
                    for (d in e.events) ea.removeEvent(b, d, e.handle);
                    b.removeAttribute(ea.expando)
                }
                "script" === c && b.text !== a.text ? (t(b).text = a.text, u(b)) : "object" === c ? (b.parentNode && (b.outerHTML = a.outerHTML), ca.html5Clone && a.innerHTML && !ea.trim(b.innerHTML) && (b.innerHTML = a.innerHTML)) : "input" === c && Ea.test(a.type) ? (b.defaultChecked = b.checked = a.checked, b.value !== a.value && (b.value = a.value)) : "option" === c ? b.defaultSelected = b.selected = a.defaultSelected : ("input" === c || "textarea" === c) && (b.defaultValue = a.defaultValue)
            }
        }

        function y(b, c) {
            var d, e = ea(c.createElement(b)).appendTo(c.body),
                f = a.getDefaultComputedStyle && (d = a.getDefaultComputedStyle(e[0])) ? d.display : ea.css(e[0], "display");
            return e.detach(), f
        }

        function z(a) {
            var b = oa,
                c = _a[a];
            return c || (c = y(a, b), "none" !== c && c || ($a = ($a || ea("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement), b = ($a[0].contentWindow || $a[0].contentDocument).document, b.write(), b.close(), c = y(a, b), $a.detach()), _a[a] = c), c
        }

        function A(a, b) {
            return {
                get: function() {
                    var c = a();
                    if (null != c) return c ? void delete this.get : (this.get = b).apply(this, arguments)
                }
            }
        }

        function B(a, b) {
            if (b in a) return b;
            for (var c = b.charAt(0).toUpperCase() + b.slice(1), d = b, e = mb.length; e--;)
                if (b = mb[e] + c, b in a) return b;
            return d
        }

        function C(a, b) {
            for (var c, d, e, f = [], g = 0, h = a.length; h > g; g++) d = a[g], d.style && (f[g] = ea._data(d, "olddisplay"), c = d.style.display, b ? (f[g] || "none" !== c || (d.style.display = ""), "" === d.style.display && Ca(d) && (f[g] = ea._data(d, "olddisplay", z(d.nodeName)))) : (e = Ca(d), (c && "none" !== c || !e) && ea._data(d, "olddisplay", e ? c : ea.css(d, "display"))));
            for (g = 0; h > g; g++) d = a[g], d.style && (b && "none" !== d.style.display && "" !== d.style.display || (d.style.display = b ? f[g] || "" : "none"));
            return a
        }

        function D(a, b, c) {
            var d = ib.exec(b);
            return d ? Math.max(0, d[1] - (c || 0)) + (d[2] || "px") : b
        }

        function E(a, b, c, d, e) {
            for (var f = c === (d ? "border" : "content") ? 4 : "width" === b ? 1 : 0, g = 0; 4 > f; f += 2) "margin" === c && (g += ea.css(a, c + Ba[f], !0, e)), d ? ("content" === c && (g -= ea.css(a, "padding" + Ba[f], !0, e)), "margin" !== c && (g -= ea.css(a, "border" + Ba[f] + "Width", !0, e))) : (g += ea.css(a, "padding" + Ba[f], !0, e), "padding" !== c && (g += ea.css(a, "border" + Ba[f] + "Width", !0, e)));
            return g
        }

        function F(a, b, c) {
            var d = !0,
                e = "width" === b ? a.offsetWidth : a.offsetHeight,
                f = cb(a),
                g = ca.boxSizing && "border-box" === ea.css(a, "boxSizing", !1, f);
            if (0 >= e || null == e) {
                if (e = db(a, b, f), (0 > e || null == e) && (e = a.style[b]), bb.test(e)) return e;
                d = g && (ca.boxSizingReliable() || e === a.style[b]), e = parseFloat(e) || 0
            }
            return e + E(a, b, c || (g ? "border" : "content"), d, f) + "px"
        }

        function G(a, b, c, d, e) {
            return new G.prototype.init(a, b, c, d, e)
        }

        function H() {
            return setTimeout(function() {
                nb = void 0
            }), nb = ea.now()
        }

        function I(a, b) {
            var c, d = {
                    height: a
                },
                e = 0;
            for (b = b ? 1 : 0; 4 > e; e += 2 - b) c = Ba[e], d["margin" + c] = d["padding" + c] = a;
            return b && (d.opacity = d.width = a), d
        }

        function J(a, b, c) {
            for (var d, e = (tb[b] || []).concat(tb["*"]), f = 0, g = e.length; g > f; f++)
                if (d = e[f].call(c, b, a)) return d
        }

        function K(a, b, c) {
            var d, e, f, g, h, i, j, k, l = this,
                m = {},
                n = a.style,
                o = a.nodeType && Ca(a),
                p = ea._data(a, "fxshow");
            c.queue || (h = ea._queueHooks(a, "fx"), null == h.unqueued && (h.unqueued = 0, i = h.empty.fire, h.empty.fire = function() {
                h.unqueued || i()
            }), h.unqueued++, l.always(function() {
                l.always(function() {
                    h.unqueued--, ea.queue(a, "fx").length || h.empty.fire()
                })
            })), 1 === a.nodeType && ("height" in b || "width" in b) && (c.overflow = [n.overflow, n.overflowX, n.overflowY], j = ea.css(a, "display"), k = "none" === j ? ea._data(a, "olddisplay") || z(a.nodeName) : j, "inline" === k && "none" === ea.css(a, "float") && (ca.inlineBlockNeedsLayout && "inline" !== z(a.nodeName) ? n.zoom = 1 : n.display = "inline-block")), c.overflow && (n.overflow = "hidden", ca.shrinkWrapBlocks() || l.always(function() {
                n.overflow = c.overflow[0], n.overflowX = c.overflow[1], n.overflowY = c.overflow[2]
            }));
            for (d in b)
                if (e = b[d], pb.exec(e)) {
                    if (delete b[d], f = f || "toggle" === e, e === (o ? "hide" : "show")) {
                        if ("show" !== e || !p || void 0 === p[d]) continue;
                        o = !0
                    }
                    m[d] = p && p[d] || ea.style(a, d)
                } else j = void 0;
            if (ea.isEmptyObject(m)) "inline" === ("none" === j ? z(a.nodeName) : j) && (n.display = j);
            else {
                p ? "hidden" in p && (o = p.hidden) : p = ea._data(a, "fxshow", {}), f && (p.hidden = !o), o ? ea(a).show() : l.done(function() {
                    ea(a).hide()
                }), l.done(function() {
                    var b;
                    ea._removeData(a, "fxshow");
                    for (b in m) ea.style(a, b, m[b])
                });
                for (d in m) g = J(o ? p[d] : 0, d, l), d in p || (p[d] = g.start, o && (g.end = g.start, g.start = "width" === d || "height" === d ? 1 : 0))
            }
        }

        function L(a, b) {
            var c, d, e, f, g;
            for (c in a)
                if (d = ea.camelCase(c), e = b[d], f = a[c], ea.isArray(f) && (e = f[1], f = a[c] = f[0]), c !== d && (a[d] = f, delete a[c]), g = ea.cssHooks[d], g && "expand" in g) {
                    f = g.expand(f), delete a[d];
                    for (c in f) c in a || (a[c] = f[c], b[c] = e)
                } else b[d] = e
        }

        function M(a, b, c) {
            var d, e, f = 0,
                g = sb.length,
                h = ea.Deferred().always(function() {
                    delete i.elem
                }),
                i = function() {
                    if (e) return !1;
                    for (var b = nb || H(), c = Math.max(0, j.startTime + j.duration - b), d = c / j.duration || 0, f = 1 - d, g = 0, i = j.tweens.length; i > g; g++) j.tweens[g].run(f);
                    return h.notifyWith(a, [j, f, c]), 1 > f && i ? c : (h.resolveWith(a, [j]), !1)
                },
                j = h.promise({
                    elem: a,
                    props: ea.extend({}, b),
                    opts: ea.extend(!0, {
                        specialEasing: {}
                    }, c),
                    originalProperties: b,
                    originalOptions: c,
                    startTime: nb || H(),
                    duration: c.duration,
                    tweens: [],
                    createTween: function(b, c) {
                        var d = ea.Tween(a, j.opts, b, c, j.opts.specialEasing[b] || j.opts.easing);
                        return j.tweens.push(d), d
                    },
                    stop: function(b) {
                        var c = 0,
                            d = b ? j.tweens.length : 0;
                        if (e) return this;
                        for (e = !0; d > c; c++) j.tweens[c].run(1);
                        return b ? h.resolveWith(a, [j, b]) : h.rejectWith(a, [j, b]), this
                    }
                }),
                k = j.props;
            for (L(k, j.opts.specialEasing); g > f; f++)
                if (d = sb[f].call(j, a, k, j.opts)) return d;
            return ea.map(k, J, j), ea.isFunction(j.opts.start) && j.opts.start.call(a, j), ea.fx.timer(ea.extend(i, {
                elem: a,
                anim: j,
                queue: j.opts.queue
            })), j.progress(j.opts.progress).done(j.opts.done, j.opts.complete).fail(j.opts.fail).always(j.opts.always)
        }

        function N(a) {
            return function(b, c) {
                "string" != typeof b && (c = b, b = "*");
                var d, e = 0,
                    f = b.toLowerCase().match(ta) || [];
                if (ea.isFunction(c))
                    for (; d = f[e++];) "+" === d.charAt(0) ? (d = d.slice(1) || "*", (a[d] = a[d] || []).unshift(c)) : (a[d] = a[d] || []).push(c)
            }
        }

        function O(a, b, c, d) {
            function e(h) {
                var i;
                return f[h] = !0, ea.each(a[h] || [], function(a, h) {
                    var j = h(b, c, d);
                    return "string" != typeof j || g || f[j] ? g ? !(i = j) : void 0 : (b.dataTypes.unshift(j), e(j), !1)
                }), i
            }
            var f = {},
                g = a === Rb;
            return e(b.dataTypes[0]) || !f["*"] && e("*")
        }

        function P(a, b) {
            var c, d, e = ea.ajaxSettings.flatOptions || {};
            for (d in b) void 0 !== b[d] && ((e[d] ? a : c || (c = {}))[d] = b[d]);
            return c && ea.extend(!0, a, c), a
        }

        function Q(a, b, c) {
            for (var d, e, f, g, h = a.contents, i = a.dataTypes;
                "*" === i[0];) i.shift(), void 0 === e && (e = a.mimeType || b.getResponseHeader("Content-Type"));
            if (e)
                for (g in h)
                    if (h[g] && h[g].test(e)) {
                        i.unshift(g);
                        break
                    }
            if (i[0] in c) f = i[0];
            else {
                for (g in c) {
                    if (!i[0] || a.converters[g + " " + i[0]]) {
                        f = g;
                        break
                    }
                    d || (d = g)
                }
                f = f || d
            }
            return f ? (f !== i[0] && i.unshift(f), c[f]) : void 0
        }

        function R(a, b, c, d) {
            var e, f, g, h, i, j = {},
                k = a.dataTypes.slice();
            if (k[1])
                for (g in a.converters) j[g.toLowerCase()] = a.converters[g];
            for (f = k.shift(); f;)
                if (a.responseFields[f] && (c[a.responseFields[f]] = b), !i && d && a.dataFilter && (b = a.dataFilter(b, a.dataType)), i = f, f = k.shift())
                    if ("*" === f) f = i;
                    else if ("*" !== i && i !== f) {
                if (g = j[i + " " + f] || j["* " + f], !g)
                    for (e in j)
                        if (h = e.split(" "), h[1] === f && (g = j[i + " " + h[0]] || j["* " + h[0]])) {
                            g === !0 ? g = j[e] : j[e] !== !0 && (f = h[0], k.unshift(h[1]));
                            break
                        }
                if (g !== !0)
                    if (g && a.throws) b = g(b);
                    else try {
                        b = g(b)
                    } catch (a) {
                        return {
                            state: "parsererror",
                            error: g ? a : "No conversion from " + i + " to " + f
                        }
                    }
            }
            return {
                state: "success",
                data: b
            }
        }

        function S(a, b, c, d) {
            var e;
            if (ea.isArray(b)) ea.each(b, function(b, e) {
                c || Ub.test(a) ? d(a, e) : S(a + "[" + ("object" == typeof e ? b : "") + "]", e, c, d)
            });
            else if (c || "object" !== ea.type(b)) d(a, b);
            else
                for (e in b) S(a + "[" + e + "]", b[e], c, d)
        }

        function T() {
            try {
                return new a.XMLHttpRequest
            } catch (a) {}
        }

        function U() {
            try {
                return new a.ActiveXObject("Microsoft.XMLHTTP")
            } catch (a) {}
        }

        function V(a) {
            return ea.isWindow(a) ? a : 9 === a.nodeType && (a.defaultView || a.parentWindow)
        }
        var W = [],
            X = W.slice,
            Y = W.concat,
            Z = W.push,
            $ = W.indexOf,
            _ = {},
            aa = _.toString,
            ba = _.hasOwnProperty,
            ca = {},
            da = "1.11.3",
            ea = function(a, b) {
                return new ea.fn.init(a, b)
            },
            fa = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
            ga = /^-ms-/,
            ha = /-([\da-z])/gi,
            ia = function(a, b) {
                return b.toUpperCase()
            };
        ea.fn = ea.prototype = {
            jquery: da,
            constructor: ea,
            selector: "",
            length: 0,
            toArray: function() {
                return X.call(this)
            },
            get: function(a) {
                return null != a ? 0 > a ? this[a + this.length] : this[a] : X.call(this)
            },
            pushStack: function(a) {
                var b = ea.merge(this.constructor(), a);
                return b.prevObject = this, b.context = this.context, b
            },
            each: function(a, b) {
                return ea.each(this, a, b)
            },
            map: function(a) {
                return this.pushStack(ea.map(this, function(b, c) {
                    return a.call(b, c, b)
                }))
            },
            slice: function() {
                return this.pushStack(X.apply(this, arguments))
            },
            first: function() {
                return this.eq(0)
            },
            last: function() {
                return this.eq(-1)
            },
            eq: function(a) {
                var b = this.length,
                    c = +a + (0 > a ? b : 0);
                return this.pushStack(c >= 0 && b > c ? [this[c]] : [])
            },
            end: function() {
                return this.prevObject || this.constructor(null)
            },
            push: Z,
            sort: W.sort,
            splice: W.splice
        }, ea.extend = ea.fn.extend = function() {
            var a, b, c, d, e, f, g = arguments[0] || {},
                h = 1,
                i = arguments.length,
                j = !1;
            for ("boolean" == typeof g && (j = g, g = arguments[h] || {}, h++), "object" == typeof g || ea.isFunction(g) || (g = {}), h === i && (g = this, h--); i > h; h++)
                if (null != (e = arguments[h]))
                    for (d in e) a = g[d], c = e[d], g !== c && (j && c && (ea.isPlainObject(c) || (b = ea.isArray(c))) ? (b ? (b = !1, f = a && ea.isArray(a) ? a : []) : f = a && ea.isPlainObject(a) ? a : {}, g[d] = ea.extend(j, f, c)) : void 0 !== c && (g[d] = c));
            return g
        }, ea.extend({
            expando: "jQuery" + (da + Math.random()).replace(/\D/g, ""),
            isReady: !0,
            error: function(a) {
                throw new Error(a)
            },
            noop: function() {},
            isFunction: function(a) {
                return "function" === ea.type(a)
            },
            isArray: Array.isArray || function(a) {
                return "array" === ea.type(a)
            },
            isWindow: function(a) {
                return null != a && a == a.window
            },
            isNumeric: function(a) {
                return !ea.isArray(a) && a - parseFloat(a) + 1 >= 0
            },
            isEmptyObject: function(a) {
                var b;
                for (b in a) return !1;
                return !0
            },
            isPlainObject: function(a) {
                var b;
                if (!a || "object" !== ea.type(a) || a.nodeType || ea.isWindow(a)) return !1;
                try {
                    if (a.constructor && !ba.call(a, "constructor") && !ba.call(a.constructor.prototype, "isPrototypeOf")) return !1
                } catch (a) {
                    return !1
                }
                if (ca.ownLast)
                    for (b in a) return ba.call(a, b);
                for (b in a);
                return void 0 === b || ba.call(a, b)
            },
            type: function(a) {
                return null == a ? a + "" : "object" == typeof a || "function" == typeof a ? _[aa.call(a)] || "object" : typeof a
            },
            globalEval: function(b) {
                b && ea.trim(b) && (a.execScript || function(b) {
                    a.eval.call(a, b)
                })(b)
            },
            camelCase: function(a) {
                return a.replace(ga, "ms-").replace(ha, ia)
            },
            nodeName: function(a, b) {
                return a.nodeName && a.nodeName.toLowerCase() === b.toLowerCase()
            },
            each: function(a, b, d) {
                var e, f = 0,
                    g = a.length,
                    h = c(a);
                if (d) {
                    if (h)
                        for (; g > f && (e = b.apply(a[f], d), e !== !1); f++);
                    else
                        for (f in a)
                            if (e = b.apply(a[f], d), e === !1) break
                } else if (h)
                    for (; g > f && (e = b.call(a[f], f, a[f]), e !== !1); f++);
                else
                    for (f in a)
                        if (e = b.call(a[f], f, a[f]), e === !1) break;
                return a
            },
            trim: function(a) {
                return null == a ? "" : (a + "").replace(fa, "")
            },
            makeArray: function(a, b) {
                var d = b || [];
                return null != a && (c(Object(a)) ? ea.merge(d, "string" == typeof a ? [a] : a) : Z.call(d, a)), d
            },
            inArray: function(a, b, c) {
                var d;
                if (b) {
                    if ($) return $.call(b, a, c);
                    for (d = b.length, c = c ? 0 > c ? Math.max(0, d + c) : c : 0; d > c; c++)
                        if (c in b && b[c] === a) return c
                }
                return -1
            },
            merge: function(a, b) {
                for (var c = +b.length, d = 0, e = a.length; c > d;) a[e++] = b[d++];
                if (c !== c)
                    for (; void 0 !== b[d];) a[e++] = b[d++];
                return a.length = e, a
            },
            grep: function(a, b, c) {
                for (var d, e = [], f = 0, g = a.length, h = !c; g > f; f++) d = !b(a[f], f), d !== h && e.push(a[f]);
                return e
            },
            map: function(a, b, d) {
                var e, f = 0,
                    g = a.length,
                    h = c(a),
                    i = [];
                if (h)
                    for (; g > f; f++) e = b(a[f], f, d), null != e && i.push(e);
                else
                    for (f in a) e = b(a[f], f, d), null != e && i.push(e);
                return Y.apply([], i)
            },
            guid: 1,
            proxy: function(a, b) {
                var c, d, e;
                return "string" == typeof b && (e = a[b], b = a, a = e), ea.isFunction(a) ? (c = X.call(arguments, 2), d = function() {
                    return a.apply(b || this, c.concat(X.call(arguments)))
                }, d.guid = a.guid = a.guid || ea.guid++, d) : void 0
            },
            now: function() {
                return +new Date
            },
            support: ca
        }), ea.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(a, b) {
            _["[object " + b + "]"] = b.toLowerCase()
        });
        var ja = function(a) {
            function b(a, b, c, d) {
                var e, f, g, h, i, j, l, n, o, p;
                if ((b ? b.ownerDocument || b : O) !== G && F(b), b = b || G, c = c || [], h = b.nodeType, "string" != typeof a || !a || 1 !== h && 9 !== h && 11 !== h) return c;
                if (!d && I) {
                    if (11 !== h && (e = sa.exec(a)))
                        if (g = e[1]) {
                            if (9 === h) {
                                if (f = b.getElementById(g), !f || !f.parentNode) return c;
                                if (f.id === g) return c.push(f), c
                            } else if (b.ownerDocument && (f = b.ownerDocument.getElementById(g)) && M(b, f) && f.id === g) return c.push(f), c
                        } else {
                            if (e[2]) return $.apply(c, b.getElementsByTagName(a)), c;
                            if ((g = e[3]) && v.getElementsByClassName) return $.apply(c, b.getElementsByClassName(g)), c
                        }
                    if (v.qsa && (!J || !J.test(a))) {
                        if (n = l = N, o = b, p = 1 !== h && a, 1 === h && "object" !== b.nodeName.toLowerCase()) {
                            for (j = z(a), (l = b.getAttribute("id")) ? n = l.replace(ua, "\\$&") : b.setAttribute("id", n), n = "[id='" + n + "'] ", i = j.length; i--;) j[i] = n + m(j[i]);
                            o = ta.test(a) && k(b.parentNode) || b, p = j.join(",")
                        }
                        if (p) try {
                            return $.apply(c, o.querySelectorAll(p)), c
                        } catch (a) {} finally {
                            l || b.removeAttribute("id")
                        }
                    }
                }
                return B(a.replace(ia, "$1"), b, c, d)
            }

            function c() {
                function a(c, d) {
                    return b.push(c + " ") > w.cacheLength && delete a[b.shift()], a[c + " "] = d
                }
                var b = [];
                return a
            }

            function d(a) {
                return a[N] = !0, a
            }

            function e(a) {
                var b = G.createElement("div");
                try {
                    return !!a(b)
                } catch (a) {
                    return !1
                } finally {
                    b.parentNode && b.parentNode.removeChild(b), b = null
                }
            }

            function f(a, b) {
                for (var c = a.split("|"), d = a.length; d--;) w.attrHandle[c[d]] = b
            }

            function g(a, b) {
                var c = b && a,
                    d = c && 1 === a.nodeType && 1 === b.nodeType && (~b.sourceIndex || V) - (~a.sourceIndex || V);
                if (d) return d;
                if (c)
                    for (; c = c.nextSibling;)
                        if (c === b) return -1;
                return a ? 1 : -1
            }

            function h(a) {
                return function(b) {
                    var c = b.nodeName.toLowerCase();
                    return "input" === c && b.type === a
                }
            }

            function i(a) {
                return function(b) {
                    var c = b.nodeName.toLowerCase();
                    return ("input" === c || "button" === c) && b.type === a
                }
            }

            function j(a) {
                return d(function(b) {
                    return b = +b, d(function(c, d) {
                        for (var e, f = a([], c.length, b), g = f.length; g--;) c[e = f[g]] && (c[e] = !(d[e] = c[e]))
                    })
                })
            }

            function k(a) {
                return a && "undefined" != typeof a.getElementsByTagName && a
            }

            function l() {}

            function m(a) {
                for (var b = 0, c = a.length, d = ""; c > b; b++) d += a[b].value;
                return d
            }

            function n(a, b, c) {
                var d = b.dir,
                    e = c && "parentNode" === d,
                    f = Q++;
                return b.first ? function(b, c, f) {
                    for (; b = b[d];)
                        if (1 === b.nodeType || e) return a(b, c, f)
                } : function(b, c, g) {
                    var h, i, j = [P, f];
                    if (g) {
                        for (; b = b[d];)
                            if ((1 === b.nodeType || e) && a(b, c, g)) return !0
                    } else
                        for (; b = b[d];)
                            if (1 === b.nodeType || e) {
                                if (i = b[N] || (b[N] = {}), (h = i[d]) && h[0] === P && h[1] === f) return j[2] = h[2];
                                if (i[d] = j, j[2] = a(b, c, g)) return !0
                            }
                }
            }

            function o(a) {
                return a.length > 1 ? function(b, c, d) {
                    for (var e = a.length; e--;)
                        if (!a[e](b, c, d)) return !1;
                    return !0
                } : a[0]
            }

            function p(a, c, d) {
                for (var e = 0, f = c.length; f > e; e++) b(a, c[e], d);
                return d
            }

            function q(a, b, c, d, e) {
                for (var f, g = [], h = 0, i = a.length, j = null != b; i > h; h++)(f = a[h]) && (!c || c(f, d, e)) && (g.push(f), j && b.push(h));
                return g
            }

            function r(a, b, c, e, f, g) {
                return e && !e[N] && (e = r(e)), f && !f[N] && (f = r(f, g)), d(function(d, g, h, i) {
                    var j, k, l, m = [],
                        n = [],
                        o = g.length,
                        r = d || p(b || "*", h.nodeType ? [h] : h, []),
                        s = !a || !d && b ? r : q(r, m, a, h, i),
                        t = c ? f || (d ? a : o || e) ? [] : g : s;
                    if (c && c(s, t, h, i), e)
                        for (j = q(t, n), e(j, [], h, i), k = j.length; k--;)(l = j[k]) && (t[n[k]] = !(s[n[k]] = l));
                    if (d) {
                        if (f || a) {
                            if (f) {
                                for (j = [], k = t.length; k--;)(l = t[k]) && j.push(s[k] = l);
                                f(null, t = [], j, i)
                            }
                            for (k = t.length; k--;)(l = t[k]) && (j = f ? aa(d, l) : m[k]) > -1 && (d[j] = !(g[j] = l))
                        }
                    } else t = q(t === g ? t.splice(o, t.length) : t), f ? f(null, g, t, i) : $.apply(g, t)
                })
            }

            function s(a) {
                for (var b, c, d, e = a.length, f = w.relative[a[0].type], g = f || w.relative[" "], h = f ? 1 : 0, i = n(function(a) {
                        return a === b
                    }, g, !0), j = n(function(a) {
                        return aa(b, a) > -1
                    }, g, !0), k = [function(a, c, d) {
                        var e = !f && (d || c !== C) || ((b = c).nodeType ? i(a, c, d) : j(a, c, d));
                        return b = null, e
                    }]; e > h; h++)
                    if (c = w.relative[a[h].type]) k = [n(o(k), c)];
                    else {
                        if (c = w.filter[a[h].type].apply(null, a[h].matches), c[N]) {
                            for (d = ++h; e > d && !w.relative[a[d].type]; d++);
                            return r(h > 1 && o(k), h > 1 && m(a.slice(0, h - 1).concat({
                                value: " " === a[h - 2].type ? "*" : ""
                            })).replace(ia, "$1"), c, d > h && s(a.slice(h, d)), e > d && s(a = a.slice(d)), e > d && m(a))
                        }
                        k.push(c)
                    }
                return o(k)
            }

            function t(a, c) {
                var e = c.length > 0,
                    f = a.length > 0,
                    g = function(d, g, h, i, j) {
                        var k, l, m, n = 0,
                            o = "0",
                            p = d && [],
                            r = [],
                            s = C,
                            t = d || f && w.find.TAG("*", j),
                            u = P += null == s ? 1 : Math.random() || .1,
                            v = t.length;
                        for (j && (C = g !== G && g); o !== v && null != (k = t[o]); o++) {
                            if (f && k) {
                                for (l = 0; m = a[l++];)
                                    if (m(k, g, h)) {
                                        i.push(k);
                                        break
                                    }
                                j && (P = u)
                            }
                            e && ((k = !m && k) && n--, d && p.push(k))
                        }
                        if (n += o, e && o !== n) {
                            for (l = 0; m = c[l++];) m(p, r, g, h);
                            if (d) {
                                if (n > 0)
                                    for (; o--;) p[o] || r[o] || (r[o] = Y.call(i));
                                r = q(r)
                            }
                            $.apply(i, r), j && !d && r.length > 0 && n + c.length > 1 && b.uniqueSort(i)
                        }
                        return j && (P = u, C = s), p
                    };
                return e ? d(g) : g
            }
            var u, v, w, x, y, z, A, B, C, D, E, F, G, H, I, J, K, L, M, N = "sizzle" + 1 * new Date,
                O = a.document,
                P = 0,
                Q = 0,
                R = c(),
                S = c(),
                T = c(),
                U = function(a, b) {
                    return a === b && (E = !0), 0
                },
                V = 1 << 31,
                W = {}.hasOwnProperty,
                X = [],
                Y = X.pop,
                Z = X.push,
                $ = X.push,
                _ = X.slice,
                aa = function(a, b) {
                    for (var c = 0, d = a.length; d > c; c++)
                        if (a[c] === b) return c;
                    return -1
                },
                ba = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
                ca = "[\\x20\\t\\r\\n\\f]",
                da = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",
                ea = da.replace("w", "w#"),
                fa = "\\[" + ca + "*(" + da + ")(?:" + ca + "*([*^$|!~]?=)" + ca + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + ea + "))|)" + ca + "*\\]",
                ga = ":(" + da + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + fa + ")*)|.*)\\)|)",
                ha = new RegExp(ca + "+", "g"),
                ia = new RegExp("^" + ca + "+|((?:^|[^\\\\])(?:\\\\.)*)" + ca + "+$", "g"),
                ja = new RegExp("^" + ca + "*," + ca + "*"),
                ka = new RegExp("^" + ca + "*([>+~]|" + ca + ")" + ca + "*"),
                la = new RegExp("=" + ca + "*([^\\]'\"]*?)" + ca + "*\\]", "g"),
                ma = new RegExp(ga),
                na = new RegExp("^" + ea + "$"),
                oa = {
                    ID: new RegExp("^#(" + da + ")"),
                    CLASS: new RegExp("^\\.(" + da + ")"),
                    TAG: new RegExp("^(" + da.replace("w", "w*") + ")"),
                    ATTR: new RegExp("^" + fa),
                    PSEUDO: new RegExp("^" + ga),
                    CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + ca + "*(even|odd|(([+-]|)(\\d*)n|)" + ca + "*(?:([+-]|)" + ca + "*(\\d+)|))" + ca + "*\\)|)", "i"),
                    bool: new RegExp("^(?:" + ba + ")$", "i"),
                    needsContext: new RegExp("^" + ca + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + ca + "*((?:-\\d)?\\d*)" + ca + "*\\)|)(?=[^-]|$)", "i")
                },
                pa = /^(?:input|select|textarea|button)$/i,
                qa = /^h\d$/i,
                ra = /^[^{]+\{\s*\[native \w/,
                sa = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
                ta = /[+~]/,
                ua = /'|\\/g,
                va = new RegExp("\\\\([\\da-f]{1,6}" + ca + "?|(" + ca + ")|.)", "ig"),
                wa = function(a, b, c) {
                    var d = "0x" + b - 65536;
                    return d !== d || c ? b : 0 > d ? String.fromCharCode(d + 65536) : String.fromCharCode(d >> 10 | 55296, 1023 & d | 56320)
                },
                xa = function() {
                    F()
                };
            try {
                $.apply(X = _.call(O.childNodes), O.childNodes), X[O.childNodes.length].nodeType
            } catch (a) {
                $ = {
                    apply: X.length ? function(a, b) {
                        Z.apply(a, _.call(b))
                    } : function(a, b) {
                        for (var c = a.length, d = 0; a[c++] = b[d++];);
                        a.length = c - 1
                    }
                }
            }
            v = b.support = {}, y = b.isXML = function(a) {
                var b = a && (a.ownerDocument || a).documentElement;
                return !!b && "HTML" !== b.nodeName
            }, F = b.setDocument = function(a) {
                var b, c, d = a ? a.ownerDocument || a : O;
                return d !== G && 9 === d.nodeType && d.documentElement ? (G = d, H = d.documentElement, c = d.defaultView, c && c !== c.top && (c.addEventListener ? c.addEventListener("unload", xa, !1) : c.attachEvent && c.attachEvent("onunload", xa)), I = !y(d), v.attributes = e(function(a) {
                    return a.className = "i", !a.getAttribute("className")
                }), v.getElementsByTagName = e(function(a) {
                    return a.appendChild(d.createComment("")), !a.getElementsByTagName("*").length
                }), v.getElementsByClassName = ra.test(d.getElementsByClassName), v.getById = e(function(a) {
                    return H.appendChild(a).id = N, !d.getElementsByName || !d.getElementsByName(N).length
                }), v.getById ? (w.find.ID = function(a, b) {
                    if ("undefined" != typeof b.getElementById && I) {
                        var c = b.getElementById(a);
                        return c && c.parentNode ? [c] : []
                    }
                }, w.filter.ID = function(a) {
                    var b = a.replace(va, wa);
                    return function(a) {
                        return a.getAttribute("id") === b
                    }
                }) : (delete w.find.ID, w.filter.ID = function(a) {
                    var b = a.replace(va, wa);
                    return function(a) {
                        var c = "undefined" != typeof a.getAttributeNode && a.getAttributeNode("id");
                        return c && c.value === b
                    }
                }), w.find.TAG = v.getElementsByTagName ? function(a, b) {
                    return "undefined" != typeof b.getElementsByTagName ? b.getElementsByTagName(a) : v.qsa ? b.querySelectorAll(a) : void 0
                } : function(a, b) {
                    var c, d = [],
                        e = 0,
                        f = b.getElementsByTagName(a);
                    if ("*" === a) {
                        for (; c = f[e++];) 1 === c.nodeType && d.push(c);
                        return d
                    }
                    return f
                }, w.find.CLASS = v.getElementsByClassName && function(a, b) {
                    return I ? b.getElementsByClassName(a) : void 0
                }, K = [], J = [], (v.qsa = ra.test(d.querySelectorAll)) && (e(function(a) {
                    H.appendChild(a).innerHTML = "<a id='" + N + "'></a><select id='" + N + "-\f]' msallowcapture=''><option selected=''></option></select>", a.querySelectorAll("[msallowcapture^='']").length && J.push("[*^$]=" + ca + "*(?:''|\"\")"), a.querySelectorAll("[selected]").length || J.push("\\[" + ca + "*(?:value|" + ba + ")"), a.querySelectorAll("[id~=" + N + "-]").length || J.push("~="), a.querySelectorAll(":checked").length || J.push(":checked"), a.querySelectorAll("a#" + N + "+*").length || J.push(".#.+[+~]")
                }), e(function(a) {
                    var b = d.createElement("input");
                    b.setAttribute("type", "hidden"), a.appendChild(b).setAttribute("name", "D"), a.querySelectorAll("[name=d]").length && J.push("name" + ca + "*[*^$|!~]?="), a.querySelectorAll(":enabled").length || J.push(":enabled", ":disabled"), a.querySelectorAll("*,:x"), J.push(",.*:")
                })), (v.matchesSelector = ra.test(L = H.matches || H.webkitMatchesSelector || H.mozMatchesSelector || H.oMatchesSelector || H.msMatchesSelector)) && e(function(a) {
                    v.disconnectedMatch = L.call(a, "div"), L.call(a, "[s!='']:x"), K.push("!=", ga)
                }), J = J.length && new RegExp(J.join("|")), K = K.length && new RegExp(K.join("|")), b = ra.test(H.compareDocumentPosition), M = b || ra.test(H.contains) ? function(a, b) {
                    var c = 9 === a.nodeType ? a.documentElement : a,
                        d = b && b.parentNode;
                    return a === d || !!d && 1 === d.nodeType && !!(c.contains ? c.contains(d) : a.compareDocumentPosition && 16 & a.compareDocumentPosition(d))
                } : function(a, b) {
                    if (b)
                        for (; b = b.parentNode;)
                            if (b === a) return !0;
                    return !1
                }, U = b ? function(a, b) {
                    if (a === b) return E = !0, 0;
                    var c = !a.compareDocumentPosition - !b.compareDocumentPosition;
                    return c ? c : (c = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1, 1 & c || !v.sortDetached && b.compareDocumentPosition(a) === c ? a === d || a.ownerDocument === O && M(O, a) ? -1 : b === d || b.ownerDocument === O && M(O, b) ? 1 : D ? aa(D, a) - aa(D, b) : 0 : 4 & c ? -1 : 1)
                } : function(a, b) {
                    if (a === b) return E = !0, 0;
                    var c, e = 0,
                        f = a.parentNode,
                        h = b.parentNode,
                        i = [a],
                        j = [b];
                    if (!f || !h) return a === d ? -1 : b === d ? 1 : f ? -1 : h ? 1 : D ? aa(D, a) - aa(D, b) : 0;
                    if (f === h) return g(a, b);
                    for (c = a; c = c.parentNode;) i.unshift(c);
                    for (c = b; c = c.parentNode;) j.unshift(c);
                    for (; i[e] === j[e];) e++;
                    return e ? g(i[e], j[e]) : i[e] === O ? -1 : j[e] === O ? 1 : 0
                }, d) : G
            }, b.matches = function(a, c) {
                return b(a, null, null, c)
            }, b.matchesSelector = function(a, c) {
                if ((a.ownerDocument || a) !== G && F(a), c = c.replace(la, "='$1']"), !(!v.matchesSelector || !I || K && K.test(c) || J && J.test(c))) try {
                    var d = L.call(a, c);
                    if (d || v.disconnectedMatch || a.document && 11 !== a.document.nodeType) return d
                } catch (a) {}
                return b(c, G, null, [a]).length > 0
            }, b.contains = function(a, b) {
                return (a.ownerDocument || a) !== G && F(a), M(a, b)
            }, b.attr = function(a, b) {
                (a.ownerDocument || a) !== G && F(a);
                var c = w.attrHandle[b.toLowerCase()],
                    d = c && W.call(w.attrHandle, b.toLowerCase()) ? c(a, b, !I) : void 0;
                return void 0 !== d ? d : v.attributes || !I ? a.getAttribute(b) : (d = a.getAttributeNode(b)) && d.specified ? d.value : null
            }, b.error = function(a) {
                throw new Error("Syntax error, unrecognized expression: " + a)
            }, b.uniqueSort = function(a) {
                var b, c = [],
                    d = 0,
                    e = 0;
                if (E = !v.detectDuplicates, D = !v.sortStable && a.slice(0), a.sort(U), E) {
                    for (; b = a[e++];) b === a[e] && (d = c.push(e));
                    for (; d--;) a.splice(c[d], 1)
                }
                return D = null, a
            }, x = b.getText = function(a) {
                var b, c = "",
                    d = 0,
                    e = a.nodeType;
                if (e) {
                    if (1 === e || 9 === e || 11 === e) {
                        if ("string" == typeof a.textContent) return a.textContent;
                        for (a = a.firstChild; a; a = a.nextSibling) c += x(a)
                    } else if (3 === e || 4 === e) return a.nodeValue
                } else
                    for (; b = a[d++];) c += x(b);
                return c
            }, w = b.selectors = {
                cacheLength: 50,
                createPseudo: d,
                match: oa,
                attrHandle: {},
                find: {},
                relative: {
                    ">": {
                        dir: "parentNode",
                        first: !0
                    },
                    " ": {
                        dir: "parentNode"
                    },
                    "+": {
                        dir: "previousSibling",
                        first: !0
                    },
                    "~": {
                        dir: "previousSibling"
                    }
                },
                preFilter: {
                    ATTR: function(a) {
                        return a[1] = a[1].replace(va, wa), a[3] = (a[3] || a[4] || a[5] || "").replace(va, wa), "~=" === a[2] && (a[3] = " " + a[3] + " "), a.slice(0, 4)
                    },
                    CHILD: function(a) {
                        return a[1] = a[1].toLowerCase(), "nth" === a[1].slice(0, 3) ? (a[3] || b.error(a[0]), a[4] = +(a[4] ? a[5] + (a[6] || 1) : 2 * ("even" === a[3] || "odd" === a[3])), a[5] = +(a[7] + a[8] || "odd" === a[3])) : a[3] && b.error(a[0]), a
                    },
                    PSEUDO: function(a) {
                        var b, c = !a[6] && a[2];
                        return oa.CHILD.test(a[0]) ? null : (a[3] ? a[2] = a[4] || a[5] || "" : c && ma.test(c) && (b = z(c, !0)) && (b = c.indexOf(")", c.length - b) - c.length) && (a[0] = a[0].slice(0, b), a[2] = c.slice(0, b)), a.slice(0, 3))
                    }
                },
                filter: {
                    TAG: function(a) {
                        var b = a.replace(va, wa).toLowerCase();
                        return "*" === a ? function() {
                            return !0
                        } : function(a) {
                            return a.nodeName && a.nodeName.toLowerCase() === b
                        }
                    },
                    CLASS: function(a) {
                        var b = R[a + " "];
                        return b || (b = new RegExp("(^|" + ca + ")" + a + "(" + ca + "|$)")) && R(a, function(a) {
                            return b.test("string" == typeof a.className && a.className || "undefined" != typeof a.getAttribute && a.getAttribute("class") || "")
                        })
                    },
                    ATTR: function(a, c, d) {
                        return function(e) {
                            var f = b.attr(e, a);
                            return null == f ? "!=" === c : !c || (f += "", "=" === c ? f === d : "!=" === c ? f !== d : "^=" === c ? d && 0 === f.indexOf(d) : "*=" === c ? d && f.indexOf(d) > -1 : "$=" === c ? d && f.slice(-d.length) === d : "~=" === c ? (" " + f.replace(ha, " ") + " ").indexOf(d) > -1 : "|=" === c && (f === d || f.slice(0, d.length + 1) === d + "-"))
                        }
                    },
                    CHILD: function(a, b, c, d, e) {
                        var f = "nth" !== a.slice(0, 3),
                            g = "last" !== a.slice(-4),
                            h = "of-type" === b;
                        return 1 === d && 0 === e ? function(a) {
                            return !!a.parentNode
                        } : function(b, c, i) {
                            var j, k, l, m, n, o, p = f !== g ? "nextSibling" : "previousSibling",
                                q = b.parentNode,
                                r = h && b.nodeName.toLowerCase(),
                                s = !i && !h;
                            if (q) {
                                if (f) {
                                    for (; p;) {
                                        for (l = b; l = l[p];)
                                            if (h ? l.nodeName.toLowerCase() === r : 1 === l.nodeType) return !1;
                                        o = p = "only" === a && !o && "nextSibling"
                                    }
                                    return !0
                                }
                                if (o = [g ? q.firstChild : q.lastChild], g && s) {
                                    for (k = q[N] || (q[N] = {}), j = k[a] || [], n = j[0] === P && j[1], m = j[0] === P && j[2], l = n && q.childNodes[n]; l = ++n && l && l[p] || (m = n = 0) || o.pop();)
                                        if (1 === l.nodeType && ++m && l === b) {
                                            k[a] = [P, n, m];
                                            break
                                        }
                                } else if (s && (j = (b[N] || (b[N] = {}))[a]) && j[0] === P) m = j[1];
                                else
                                    for (;
                                        (l = ++n && l && l[p] || (m = n = 0) || o.pop()) && ((h ? l.nodeName.toLowerCase() !== r : 1 !== l.nodeType) || !++m || (s && ((l[N] || (l[N] = {}))[a] = [P, m]), l !== b)););
                                return m -= e, m === d || m % d === 0 && m / d >= 0
                            }
                        }
                    },
                    PSEUDO: function(a, c) {
                        var e, f = w.pseudos[a] || w.setFilters[a.toLowerCase()] || b.error("unsupported pseudo: " + a);
                        return f[N] ? f(c) : f.length > 1 ? (e = [a, a, "", c], w.setFilters.hasOwnProperty(a.toLowerCase()) ? d(function(a, b) {
                            for (var d, e = f(a, c), g = e.length; g--;) d = aa(a, e[g]), a[d] = !(b[d] = e[g])
                        }) : function(a) {
                            return f(a, 0, e)
                        }) : f
                    }
                },
                pseudos: {
                    not: d(function(a) {
                        var b = [],
                            c = [],
                            e = A(a.replace(ia, "$1"));
                        return e[N] ? d(function(a, b, c, d) {
                            for (var f, g = e(a, null, d, []), h = a.length; h--;)(f = g[h]) && (a[h] = !(b[h] = f))
                        }) : function(a, d, f) {
                            return b[0] = a, e(b, null, f, c), b[0] = null, !c.pop()
                        }
                    }),
                    has: d(function(a) {
                        return function(c) {
                            return b(a, c).length > 0
                        }
                    }),
                    contains: d(function(a) {
                        return a = a.replace(va, wa),
                            function(b) {
                                return (b.textContent || b.innerText || x(b)).indexOf(a) > -1
                            }
                    }),
                    lang: d(function(a) {
                        return na.test(a || "") || b.error("unsupported lang: " + a), a = a.replace(va, wa).toLowerCase(),
                            function(b) {
                                var c;
                                do
                                    if (c = I ? b.lang : b.getAttribute("xml:lang") || b.getAttribute("lang")) return c = c.toLowerCase(), c === a || 0 === c.indexOf(a + "-"); while ((b = b.parentNode) && 1 === b.nodeType);
                                return !1
                            }
                    }),
                    target: function(b) {
                        var c = a.location && a.location.hash;
                        return c && c.slice(1) === b.id
                    },
                    root: function(a) {
                        return a === H
                    },
                    focus: function(a) {
                        return a === G.activeElement && (!G.hasFocus || G.hasFocus()) && !!(a.type || a.href || ~a.tabIndex)
                    },
                    enabled: function(a) {
                        return a.disabled === !1
                    },
                    disabled: function(a) {
                        return a.disabled === !0
                    },
                    checked: function(a) {
                        var b = a.nodeName.toLowerCase();
                        return "input" === b && !!a.checked || "option" === b && !!a.selected
                    },
                    selected: function(a) {
                        return a.parentNode && a.parentNode.selectedIndex, a.selected === !0
                    },
                    empty: function(a) {
                        for (a = a.firstChild; a; a = a.nextSibling)
                            if (a.nodeType < 6) return !1;
                        return !0
                    },
                    parent: function(a) {
                        return !w.pseudos.empty(a)
                    },
                    header: function(a) {
                        return qa.test(a.nodeName)
                    },
                    input: function(a) {
                        return pa.test(a.nodeName)
                    },
                    button: function(a) {
                        var b = a.nodeName.toLowerCase();
                        return "input" === b && "button" === a.type || "button" === b
                    },
                    text: function(a) {
                        var b;
                        return "input" === a.nodeName.toLowerCase() && "text" === a.type && (null == (b = a.getAttribute("type")) || "text" === b.toLowerCase())
                    },
                    first: j(function() {
                        return [0]
                    }),
                    last: j(function(a, b) {
                        return [b - 1]
                    }),
                    eq: j(function(a, b, c) {
                        return [0 > c ? c + b : c]
                    }),
                    even: j(function(a, b) {
                        for (var c = 0; b > c; c += 2) a.push(c);
                        return a
                    }),
                    odd: j(function(a, b) {
                        for (var c = 1; b > c; c += 2) a.push(c);
                        return a
                    }),
                    lt: j(function(a, b, c) {
                        for (var d = 0 > c ? c + b : c; --d >= 0;) a.push(d);
                        return a
                    }),
                    gt: j(function(a, b, c) {
                        for (var d = 0 > c ? c + b : c; ++d < b;) a.push(d);
                        return a
                    })
                }
            }, w.pseudos.nth = w.pseudos.eq;
            for (u in {
                    radio: !0,
                    checkbox: !0,
                    file: !0,
                    password: !0,
                    image: !0
                }) w.pseudos[u] = h(u);
            for (u in {
                    submit: !0,
                    reset: !0
                }) w.pseudos[u] = i(u);
            return l.prototype = w.filters = w.pseudos, w.setFilters = new l, z = b.tokenize = function(a, c) {
                var d, e, f, g, h, i, j, k = S[a + " "];
                if (k) return c ? 0 : k.slice(0);
                for (h = a, i = [], j = w.preFilter; h;) {
                    (!d || (e = ja.exec(h))) && (e && (h = h.slice(e[0].length) || h), i.push(f = [])), d = !1, (e = ka.exec(h)) && (d = e.shift(), f.push({
                        value: d,
                        type: e[0].replace(ia, " ")
                    }), h = h.slice(d.length));
                    for (g in w.filter) !(e = oa[g].exec(h)) || j[g] && !(e = j[g](e)) || (d = e.shift(), f.push({
                        value: d,
                        type: g,
                        matches: e
                    }), h = h.slice(d.length));
                    if (!d) break
                }
                return c ? h.length : h ? b.error(a) : S(a, i).slice(0)
            }, A = b.compile = function(a, b) {
                var c, d = [],
                    e = [],
                    f = T[a + " "];
                if (!f) {
                    for (b || (b = z(a)), c = b.length; c--;) f = s(b[c]), f[N] ? d.push(f) : e.push(f);
                    f = T(a, t(e, d)), f.selector = a
                }
                return f
            }, B = b.select = function(a, b, c, d) {
                var e, f, g, h, i, j = "function" == typeof a && a,
                    l = !d && z(a = j.selector || a);
                if (c = c || [], 1 === l.length) {
                    if (f = l[0] = l[0].slice(0), f.length > 2 && "ID" === (g = f[0]).type && v.getById && 9 === b.nodeType && I && w.relative[f[1].type]) {
                        if (b = (w.find.ID(g.matches[0].replace(va, wa), b) || [])[0], !b) return c;
                        j && (b = b.parentNode), a = a.slice(f.shift().value.length)
                    }
                    for (e = oa.needsContext.test(a) ? 0 : f.length; e-- && (g = f[e], !w.relative[h = g.type]);)
                        if ((i = w.find[h]) && (d = i(g.matches[0].replace(va, wa), ta.test(f[0].type) && k(b.parentNode) || b))) {
                            if (f.splice(e, 1), a = d.length && m(f), !a) return $.apply(c, d), c;
                            break
                        }
                }
                return (j || A(a, l))(d, b, !I, c, ta.test(a) && k(b.parentNode) || b), c
            }, v.sortStable = N.split("").sort(U).join("") === N, v.detectDuplicates = !!E, F(), v.sortDetached = e(function(a) {
                return 1 & a.compareDocumentPosition(G.createElement("div"))
            }), e(function(a) {
                return a.innerHTML = "<a href='#'></a>", "#" === a.firstChild.getAttribute("href")
            }) || f("type|href|height|width", function(a, b, c) {
                return c ? void 0 : a.getAttribute(b, "type" === b.toLowerCase() ? 1 : 2)
            }), v.attributes && e(function(a) {
                return a.innerHTML = "<input/>", a.firstChild.setAttribute("value", ""), "" === a.firstChild.getAttribute("value")
            }) || f("value", function(a, b, c) {
                return c || "input" !== a.nodeName.toLowerCase() ? void 0 : a.defaultValue
            }), e(function(a) {
                return null == a.getAttribute("disabled")
            }) || f(ba, function(a, b, c) {
                var d;
                return c ? void 0 : a[b] === !0 ? b.toLowerCase() : (d = a.getAttributeNode(b)) && d.specified ? d.value : null
            }), b
        }(a);
        ea.find = ja, ea.expr = ja.selectors, ea.expr[":"] = ea.expr.pseudos, ea.unique = ja.uniqueSort, ea.text = ja.getText, ea.isXMLDoc = ja.isXML, ea.contains = ja.contains;
        var ka = ea.expr.match.needsContext,
            la = /^<(\w+)\s*\/?>(?:<\/\1>|)$/,
            ma = /^.[^:#\[\.,]*$/;
        ea.filter = function(a, b, c) {
            var d = b[0];
            return c && (a = ":not(" + a + ")"), 1 === b.length && 1 === d.nodeType ? ea.find.matchesSelector(d, a) ? [d] : [] : ea.find.matches(a, ea.grep(b, function(a) {
                return 1 === a.nodeType
            }))
        }, ea.fn.extend({
            find: function(a) {
                var b, c = [],
                    d = this,
                    e = d.length;
                if ("string" != typeof a) return this.pushStack(ea(a).filter(function() {
                    for (b = 0; e > b; b++)
                        if (ea.contains(d[b], this)) return !0
                }));
                for (b = 0; e > b; b++) ea.find(a, d[b], c);
                return c = this.pushStack(e > 1 ? ea.unique(c) : c), c.selector = this.selector ? this.selector + " " + a : a, c
            },
            filter: function(a) {
                return this.pushStack(d(this, a || [], !1))
            },
            not: function(a) {
                return this.pushStack(d(this, a || [], !0))
            },
            is: function(a) {
                return !!d(this, "string" == typeof a && ka.test(a) ? ea(a) : a || [], !1).length
            }
        });
        var na, oa = a.document,
            pa = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,
            qa = ea.fn.init = function(a, b) {
                var c, d;
                if (!a) return this;
                if ("string" == typeof a) {
                    if (c = "<" === a.charAt(0) && ">" === a.charAt(a.length - 1) && a.length >= 3 ? [null, a, null] : pa.exec(a), !c || !c[1] && b) return !b || b.jquery ? (b || na).find(a) : this.constructor(b).find(a);
                    if (c[1]) {
                        if (b = b instanceof ea ? b[0] : b, ea.merge(this, ea.parseHTML(c[1], b && b.nodeType ? b.ownerDocument || b : oa, !0)), la.test(c[1]) && ea.isPlainObject(b))
                            for (c in b) ea.isFunction(this[c]) ? this[c](b[c]) : this.attr(c, b[c]);
                        return this
                    }
                    if (d = oa.getElementById(c[2]), d && d.parentNode) {
                        if (d.id !== c[2]) return na.find(a);
                        this.length = 1, this[0] = d
                    }
                    return this.context = oa, this.selector = a, this
                }
                return a.nodeType ? (this.context = this[0] = a, this.length = 1, this) : ea.isFunction(a) ? "undefined" != typeof na.ready ? na.ready(a) : a(ea) : (void 0 !== a.selector && (this.selector = a.selector, this.context = a.context), ea.makeArray(a, this))
            };
        qa.prototype = ea.fn, na = ea(oa);
        var ra = /^(?:parents|prev(?:Until|All))/,
            sa = {
                children: !0,
                contents: !0,
                next: !0,
                prev: !0
            };
        ea.extend({
            dir: function(a, b, c) {
                for (var d = [], e = a[b]; e && 9 !== e.nodeType && (void 0 === c || 1 !== e.nodeType || !ea(e).is(c));) 1 === e.nodeType && d.push(e), e = e[b];
                return d
            },
            sibling: function(a, b) {
                for (var c = []; a; a = a.nextSibling) 1 === a.nodeType && a !== b && c.push(a);
                return c
            }
        }), ea.fn.extend({
            has: function(a) {
                var b, c = ea(a, this),
                    d = c.length;
                return this.filter(function() {
                    for (b = 0; d > b; b++)
                        if (ea.contains(this, c[b])) return !0
                })
            },
            closest: function(a, b) {
                for (var c, d = 0, e = this.length, f = [], g = ka.test(a) || "string" != typeof a ? ea(a, b || this.context) : 0; e > d; d++)
                    for (c = this[d]; c && c !== b; c = c.parentNode)
                        if (c.nodeType < 11 && (g ? g.index(c) > -1 : 1 === c.nodeType && ea.find.matchesSelector(c, a))) {
                            f.push(c);
                            break
                        }
                return this.pushStack(f.length > 1 ? ea.unique(f) : f)
            },
            index: function(a) {
                return a ? "string" == typeof a ? ea.inArray(this[0], ea(a)) : ea.inArray(a.jquery ? a[0] : a, this) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1
            },
            add: function(a, b) {
                return this.pushStack(ea.unique(ea.merge(this.get(), ea(a, b))))
            },
            addBack: function(a) {
                return this.add(null == a ? this.prevObject : this.prevObject.filter(a))
            }
        }), ea.each({
            parent: function(a) {
                var b = a.parentNode;
                return b && 11 !== b.nodeType ? b : null
            },
            parents: function(a) {
                return ea.dir(a, "parentNode")
            },
            parentsUntil: function(a, b, c) {
                return ea.dir(a, "parentNode", c)
            },
            next: function(a) {
                return e(a, "nextSibling")
            },
            prev: function(a) {
                return e(a, "previousSibling")
            },
            nextAll: function(a) {
                return ea.dir(a, "nextSibling")
            },
            prevAll: function(a) {
                return ea.dir(a, "previousSibling")
            },
            nextUntil: function(a, b, c) {
                return ea.dir(a, "nextSibling", c)
            },
            prevUntil: function(a, b, c) {
                return ea.dir(a, "previousSibling", c)
            },
            siblings: function(a) {
                return ea.sibling((a.parentNode || {}).firstChild, a)
            },
            children: function(a) {
                return ea.sibling(a.firstChild)
            },
            contents: function(a) {
                return ea.nodeName(a, "iframe") ? a.contentDocument || a.contentWindow.document : ea.merge([], a.childNodes)
            }
        }, function(a, b) {
            ea.fn[a] = function(c, d) {
                var e = ea.map(this, b, c);
                return "Until" !== a.slice(-5) && (d = c), d && "string" == typeof d && (e = ea.filter(d, e)), this.length > 1 && (sa[a] || (e = ea.unique(e)), ra.test(a) && (e = e.reverse())), this.pushStack(e)
            }
        });
        var ta = /\S+/g,
            ua = {};
        ea.Callbacks = function(a) {
            a = "string" == typeof a ? ua[a] || f(a) : ea.extend({}, a);
            var b, c, d, e, g, h, i = [],
                j = !a.once && [],
                k = function(f) {
                    for (c = a.memory && f, d = !0, g = h || 0, h = 0, e = i.length, b = !0; i && e > g; g++)
                        if (i[g].apply(f[0], f[1]) === !1 && a.stopOnFalse) {
                            c = !1;
                            break
                        }
                    b = !1, i && (j ? j.length && k(j.shift()) : c ? i = [] : l.disable())
                },
                l = {
                    add: function() {
                        if (i) {
                            var d = i.length;
                            ! function b(c) {
                                ea.each(c, function(c, d) {
                                    var e = ea.type(d);
                                    "function" === e ? a.unique && l.has(d) || i.push(d) : d && d.length && "string" !== e && b(d)
                                })
                            }(arguments), b ? e = i.length : c && (h = d, k(c))
                        }
                        return this
                    },
                    remove: function() {
                        return i && ea.each(arguments, function(a, c) {
                            for (var d;
                                (d = ea.inArray(c, i, d)) > -1;) i.splice(d, 1), b && (e >= d && e--, g >= d && g--)
                        }), this
                    },
                    has: function(a) {
                        return a ? ea.inArray(a, i) > -1 : !!i && !!i.length
                    },
                    empty: function() {
                        return i = [], e = 0, this
                    },
                    disable: function() {
                        return i = j = c = void 0, this
                    },
                    disabled: function() {
                        return !i
                    },
                    lock: function() {
                        return j = void 0, c || l.disable(), this
                    },
                    locked: function() {
                        return !j
                    },
                    fireWith: function(a, c) {
                        return !i || d && !j || (c = c || [], c = [a, c.slice ? c.slice() : c], b ? j.push(c) : k(c)), this
                    },
                    fire: function() {
                        return l.fireWith(this, arguments), this
                    },
                    fired: function() {
                        return !!d
                    }
                };
            return l
        }, ea.extend({
            Deferred: function(a) {
                var b = [
                        ["resolve", "done", ea.Callbacks("once memory"), "resolved"],
                        ["reject", "fail", ea.Callbacks("once memory"), "rejected"],
                        ["notify", "progress", ea.Callbacks("memory")]
                    ],
                    c = "pending",
                    d = {
                        state: function() {
                            return c
                        },
                        always: function() {
                            return e.done(arguments).fail(arguments), this
                        },
                        then: function() {
                            var a = arguments;
                            return ea.Deferred(function(c) {
                                ea.each(b, function(b, f) {
                                    var g = ea.isFunction(a[b]) && a[b];
                                    e[f[1]](function() {
                                        var a = g && g.apply(this, arguments);
                                        a && ea.isFunction(a.promise) ? a.promise().done(c.resolve).fail(c.reject).progress(c.notify) : c[f[0] + "With"](this === d ? c.promise() : this, g ? [a] : arguments)
                                    })
                                }), a = null
                            }).promise()
                        },
                        promise: function(a) {
                            return null != a ? ea.extend(a, d) : d
                        }
                    },
                    e = {};
                return d.pipe = d.then, ea.each(b, function(a, f) {
                    var g = f[2],
                        h = f[3];
                    d[f[1]] = g.add, h && g.add(function() {
                        c = h
                    }, b[1 ^ a][2].disable, b[2][2].lock), e[f[0]] = function() {
                        return e[f[0] + "With"](this === e ? d : this, arguments), this
                    }, e[f[0] + "With"] = g.fireWith
                }), d.promise(e), a && a.call(e, e), e
            },
            when: function(a) {
                var h, i, j, b = 0,
                    c = X.call(arguments),
                    d = c.length,
                    e = 1 !== d || a && ea.isFunction(a.promise) ? d : 0,
                    f = 1 === e ? a : ea.Deferred(),
                    g = function(a, b, c) {
                        return function(d) {
                            b[a] = this, c[a] = arguments.length > 1 ? X.call(arguments) : d, c === h ? f.notifyWith(b, c) : --e || f.resolveWith(b, c)
                        }
                    };
                if (d > 1)
                    for (h = new Array(d), i = new Array(d), j = new Array(d); d > b; b++) c[b] && ea.isFunction(c[b].promise) ? c[b].promise().done(g(b, j, c)).fail(f.reject).progress(g(b, i, h)) : --e;
                return e || f.resolveWith(j, c), f.promise()
            }
        });
        var va;
        ea.fn.ready = function(a) {
            return ea.ready.promise().done(a), this
        }, ea.extend({
            isReady: !1,
            readyWait: 1,
            holdReady: function(a) {
                a ? ea.readyWait++ : ea.ready(!0)
            },
            ready: function(a) {
                if (a === !0 ? !--ea.readyWait : !ea.isReady) {
                    if (!oa.body) return setTimeout(ea.ready);
                    ea.isReady = !0, a !== !0 && --ea.readyWait > 0 || (va.resolveWith(oa, [ea]), ea.fn.triggerHandler && (ea(oa).triggerHandler("ready"), ea(oa).off("ready")))
                }
            }
        }), ea.ready.promise = function(b) {
            if (!va)
                if (va = ea.Deferred(), "complete" === oa.readyState) setTimeout(ea.ready);
                else if (oa.addEventListener) oa.addEventListener("DOMContentLoaded", h, !1), a.addEventListener("load", h, !1);
            else {
                oa.attachEvent("onreadystatechange", h), a.attachEvent("onload", h);
                var c = !1;
                try {
                    c = null == a.frameElement && oa.documentElement
                } catch (a) {}
                c && c.doScroll && ! function a() {
                    if (!ea.isReady) {
                        try {
                            c.doScroll("left")
                        } catch (b) {
                            return setTimeout(a, 50)
                        }
                        g(), ea.ready()
                    }
                }()
            }
            return va.promise(b)
        };
        var xa, wa = "undefined";
        for (xa in ea(ca)) break;
        ca.ownLast = "0" !== xa, ca.inlineBlockNeedsLayout = !1, ea(function() {
                var a, b, c, d;
                c = oa.getElementsByTagName("body")[0], c && c.style && (b = oa.createElement("div"), d = oa.createElement("div"), d.style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px", c.appendChild(d).appendChild(b), typeof b.style.zoom !== wa && (b.style.cssText = "display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1", ca.inlineBlockNeedsLayout = a = 3 === b.offsetWidth, a && (c.style.zoom = 1)), c.removeChild(d))
            }),
            function() {
                var a = oa.createElement("div");
                if (null == ca.deleteExpando) {
                    ca.deleteExpando = !0;
                    try {
                        delete a.test
                    } catch (a) {
                        ca.deleteExpando = !1
                    }
                }
                a = null
            }(), ea.acceptData = function(a) {
                var b = ea.noData[(a.nodeName + " ").toLowerCase()],
                    c = +a.nodeType || 1;
                return (1 === c || 9 === c) && (!b || b !== !0 && a.getAttribute("classid") === b)
            };
        var ya = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
            za = /([A-Z])/g;
        ea.extend({
            cache: {},
            noData: {
                "applet ": !0,
                "embed ": !0,
                "object ": "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
            },
            hasData: function(a) {
                return a = a.nodeType ? ea.cache[a[ea.expando]] : a[ea.expando], !!a && !j(a)
            },
            data: function(a, b, c) {
                return k(a, b, c)
            },
            removeData: function(a, b) {
                return l(a, b)
            },
            _data: function(a, b, c) {
                return k(a, b, c, !0)
            },
            _removeData: function(a, b) {
                return l(a, b, !0)
            }
        }), ea.fn.extend({
            data: function(a, b) {
                var c, d, e, f = this[0],
                    g = f && f.attributes;
                if (void 0 === a) {
                    if (this.length && (e = ea.data(f), 1 === f.nodeType && !ea._data(f, "parsedAttrs"))) {
                        for (c = g.length; c--;) g[c] && (d = g[c].name, 0 === d.indexOf("data-") && (d = ea.camelCase(d.slice(5)), i(f, d, e[d])));
                        ea._data(f, "parsedAttrs", !0)
                    }
                    return e
                }
                return "object" == typeof a ? this.each(function() {
                    ea.data(this, a)
                }) : arguments.length > 1 ? this.each(function() {
                    ea.data(this, a, b)
                }) : f ? i(f, a, ea.data(f, a)) : void 0
            },
            removeData: function(a) {
                return this.each(function() {
                    ea.removeData(this, a)
                })
            }
        }), ea.extend({
            queue: function(a, b, c) {
                var d;
                return a ? (b = (b || "fx") + "queue", d = ea._data(a, b), c && (!d || ea.isArray(c) ? d = ea._data(a, b, ea.makeArray(c)) : d.push(c)), d || []) : void 0
            },
            dequeue: function(a, b) {
                b = b || "fx";
                var c = ea.queue(a, b),
                    d = c.length,
                    e = c.shift(),
                    f = ea._queueHooks(a, b),
                    g = function() {
                        ea.dequeue(a, b)
                    };
                "inprogress" === e && (e = c.shift(), d--), e && ("fx" === b && c.unshift("inprogress"), delete f.stop, e.call(a, g, f)), !d && f && f.empty.fire()
            },
            _queueHooks: function(a, b) {
                var c = b + "queueHooks";
                return ea._data(a, c) || ea._data(a, c, {
                    empty: ea.Callbacks("once memory").add(function() {
                        ea._removeData(a, b + "queue"), ea._removeData(a, c)
                    })
                })
            }
        }), ea.fn.extend({
            queue: function(a, b) {
                var c = 2;
                return "string" != typeof a && (b = a, a = "fx", c--), arguments.length < c ? ea.queue(this[0], a) : void 0 === b ? this : this.each(function() {
                    var c = ea.queue(this, a, b);
                    ea._queueHooks(this, a), "fx" === a && "inprogress" !== c[0] && ea.dequeue(this, a)
                })
            },
            dequeue: function(a) {
                return this.each(function() {
                    ea.dequeue(this, a)
                })
            },
            clearQueue: function(a) {
                return this.queue(a || "fx", [])
            },
            promise: function(a, b) {
                var c, d = 1,
                    e = ea.Deferred(),
                    f = this,
                    g = this.length,
                    h = function() {
                        --d || e.resolveWith(f, [f])
                    };
                for ("string" != typeof a && (b = a, a = void 0), a = a || "fx"; g--;) c = ea._data(f[g], a + "queueHooks"), c && c.empty && (d++, c.empty.add(h));
                return h(), e.promise(b)
            }
        });
        var Aa = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
            Ba = ["Top", "Right", "Bottom", "Left"],
            Ca = function(a, b) {
                return a = b || a, "none" === ea.css(a, "display") || !ea.contains(a.ownerDocument, a)
            },
            Da = ea.access = function(a, b, c, d, e, f, g) {
                var h = 0,
                    i = a.length,
                    j = null == c;
                if ("object" === ea.type(c)) {
                    e = !0;
                    for (h in c) ea.access(a, b, h, c[h], !0, f, g)
                } else if (void 0 !== d && (e = !0, ea.isFunction(d) || (g = !0), j && (g ? (b.call(a, d), b = null) : (j = b, b = function(a, b, c) {
                        return j.call(ea(a), c)
                    })), b))
                    for (; i > h; h++) b(a[h], c, g ? d : d.call(a[h], h, b(a[h], c)));
                return e ? a : j ? b.call(a) : i ? b(a[0], c) : f
            },
            Ea = /^(?:checkbox|radio)$/i;
        ! function() {
            var a = oa.createElement("input"),
                b = oa.createElement("div"),
                c = oa.createDocumentFragment();
            if (b.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", ca.leadingWhitespace = 3 === b.firstChild.nodeType, ca.tbody = !b.getElementsByTagName("tbody").length, ca.htmlSerialize = !!b.getElementsByTagName("link").length, ca.html5Clone = "<:nav></:nav>" !== oa.createElement("nav").cloneNode(!0).outerHTML, a.type = "checkbox", a.checked = !0, c.appendChild(a), ca.appendChecked = a.checked, b.innerHTML = "<textarea>x</textarea>", ca.noCloneChecked = !!b.cloneNode(!0).lastChild.defaultValue, c.appendChild(b), b.innerHTML = "<input type='radio' checked='checked' name='t'/>", ca.checkClone = b.cloneNode(!0).cloneNode(!0).lastChild.checked, ca.noCloneEvent = !0, b.attachEvent && (b.attachEvent("onclick", function() {
                    ca.noCloneEvent = !1
                }), b.cloneNode(!0).click()), null == ca.deleteExpando) {
                ca.deleteExpando = !0;
                try {
                    delete b.test
                } catch (a) {
                    ca.deleteExpando = !1
                }
            }
        }(),
        function() {
            var b, c, d = oa.createElement("div");
            for (b in {
                    submit: !0,
                    change: !0,
                    focusin: !0
                }) c = "on" + b, (ca[b + "Bubbles"] = c in a) || (d.setAttribute(c, "t"), ca[b + "Bubbles"] = d.attributes[c].expando === !1);
            d = null
        }();
        var Fa = /^(?:input|select|textarea)$/i,
            Ga = /^key/,
            Ha = /^(?:mouse|pointer|contextmenu)|click/,
            Ia = /^(?:focusinfocus|focusoutblur)$/,
            Ja = /^([^.]*)(?:\.(.+)|)$/;
        ea.event = {
            global: {},
            add: function(a, b, c, d, e) {
                var f, g, h, i, j, k, l, m, n, o, p, q = ea._data(a);
                if (q) {
                    for (c.handler && (i = c, c = i.handler, e = i.selector), c.guid || (c.guid = ea.guid++), (g = q.events) || (g = q.events = {}), (k = q.handle) || (k = q.handle = function(a) {
                            return typeof ea === wa || a && ea.event.triggered === a.type ? void 0 : ea.event.dispatch.apply(k.elem, arguments)
                        }, k.elem = a), b = (b || "").match(ta) || [""], h = b.length; h--;) f = Ja.exec(b[h]) || [], n = p = f[1], o = (f[2] || "").split(".").sort(), n && (j = ea.event.special[n] || {}, n = (e ? j.delegateType : j.bindType) || n, j = ea.event.special[n] || {}, l = ea.extend({
                        type: n,
                        origType: p,
                        data: d,
                        handler: c,
                        guid: c.guid,
                        selector: e,
                        needsContext: e && ea.expr.match.needsContext.test(e),
                        namespace: o.join(".")
                    }, i), (m = g[n]) || (m = g[n] = [], m.delegateCount = 0, j.setup && j.setup.call(a, d, o, k) !== !1 || (a.addEventListener ? a.addEventListener(n, k, !1) : a.attachEvent && a.attachEvent("on" + n, k))), j.add && (j.add.call(a, l), l.handler.guid || (l.handler.guid = c.guid)), e ? m.splice(m.delegateCount++, 0, l) : m.push(l), ea.event.global[n] = !0);
                    a = null
                }
            },
            remove: function(a, b, c, d, e) {
                var f, g, h, i, j, k, l, m, n, o, p, q = ea.hasData(a) && ea._data(a);
                if (q && (k = q.events)) {
                    for (b = (b || "").match(ta) || [""], j = b.length; j--;)
                        if (h = Ja.exec(b[j]) || [], n = p = h[1], o = (h[2] || "").split(".").sort(), n) {
                            for (l = ea.event.special[n] || {}, n = (d ? l.delegateType : l.bindType) || n, m = k[n] || [], h = h[2] && new RegExp("(^|\\.)" + o.join("\\.(?:.*\\.|)") + "(\\.|$)"), i = f = m.length; f--;) g = m[f], !e && p !== g.origType || c && c.guid !== g.guid || h && !h.test(g.namespace) || d && d !== g.selector && ("**" !== d || !g.selector) || (m.splice(f, 1), g.selector && m.delegateCount--, l.remove && l.remove.call(a, g));
                            i && !m.length && (l.teardown && l.teardown.call(a, o, q.handle) !== !1 || ea.removeEvent(a, n, q.handle), delete k[n])
                        } else
                            for (n in k) ea.event.remove(a, n + b[j], c, d, !0);
                    ea.isEmptyObject(k) && (delete q.handle, ea._removeData(a, "events"))
                }
            },
            trigger: function(b, c, d, e) {
                var f, g, h, i, j, k, l, m = [d || oa],
                    n = ba.call(b, "type") ? b.type : b,
                    o = ba.call(b, "namespace") ? b.namespace.split(".") : [];
                if (h = k = d = d || oa, 3 !== d.nodeType && 8 !== d.nodeType && !Ia.test(n + ea.event.triggered) && (n.indexOf(".") >= 0 && (o = n.split("."), n = o.shift(), o.sort()), g = n.indexOf(":") < 0 && "on" + n, b = b[ea.expando] ? b : new ea.Event(n, "object" == typeof b && b), b.isTrigger = e ? 2 : 3, b.namespace = o.join("."), b.namespace_re = b.namespace ? new RegExp("(^|\\.)" + o.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, b.result = void 0, b.target || (b.target = d), c = null == c ? [b] : ea.makeArray(c, [b]), j = ea.event.special[n] || {}, e || !j.trigger || j.trigger.apply(d, c) !== !1)) {
                    if (!e && !j.noBubble && !ea.isWindow(d)) {
                        for (i = j.delegateType || n, Ia.test(i + n) || (h = h.parentNode); h; h = h.parentNode) m.push(h), k = h;
                        k === (d.ownerDocument || oa) && m.push(k.defaultView || k.parentWindow || a)
                    }
                    for (l = 0;
                        (h = m[l++]) && !b.isPropagationStopped();) b.type = l > 1 ? i : j.bindType || n, f = (ea._data(h, "events") || {})[b.type] && ea._data(h, "handle"), f && f.apply(h, c), f = g && h[g], f && f.apply && ea.acceptData(h) && (b.result = f.apply(h, c), b.result === !1 && b.preventDefault());
                    if (b.type = n, !e && !b.isDefaultPrevented() && (!j._default || j._default.apply(m.pop(), c) === !1) && ea.acceptData(d) && g && d[n] && !ea.isWindow(d)) {
                        k = d[g], k && (d[g] = null), ea.event.triggered = n;
                        try {
                            d[n]()
                        } catch (a) {}
                        ea.event.triggered = void 0, k && (d[g] = k)
                    }
                    return b.result
                }
            },
            dispatch: function(a) {
                a = ea.event.fix(a);
                var b, c, d, e, f, g = [],
                    h = X.call(arguments),
                    i = (ea._data(this, "events") || {})[a.type] || [],
                    j = ea.event.special[a.type] || {};
                if (h[0] = a, a.delegateTarget = this, !j.preDispatch || j.preDispatch.call(this, a) !== !1) {
                    for (g = ea.event.handlers.call(this, a, i), b = 0;
                        (e = g[b++]) && !a.isPropagationStopped();)
                        for (a.currentTarget = e.elem, f = 0;
                            (d = e.handlers[f++]) && !a.isImmediatePropagationStopped();)(!a.namespace_re || a.namespace_re.test(d.namespace)) && (a.handleObj = d, a.data = d.data, c = ((ea.event.special[d.origType] || {}).handle || d.handler).apply(e.elem, h), void 0 !== c && (a.result = c) === !1 && (a.preventDefault(), a.stopPropagation()));
                    return j.postDispatch && j.postDispatch.call(this, a), a.result
                }
            },
            handlers: function(a, b) {
                var c, d, e, f, g = [],
                    h = b.delegateCount,
                    i = a.target;
                if (h && i.nodeType && (!a.button || "click" !== a.type))
                    for (; i != this; i = i.parentNode || this)
                        if (1 === i.nodeType && (i.disabled !== !0 || "click" !== a.type)) {
                            for (e = [], f = 0; h > f; f++) d = b[f], c = d.selector + " ", void 0 === e[c] && (e[c] = d.needsContext ? ea(c, this).index(i) >= 0 : ea.find(c, this, null, [i]).length), e[c] && e.push(d);
                            e.length && g.push({
                                elem: i,
                                handlers: e
                            })
                        }
                return h < b.length && g.push({
                    elem: this,
                    handlers: b.slice(h)
                }), g
            },
            fix: function(a) {
                if (a[ea.expando]) return a;
                var b, c, d, e = a.type,
                    f = a,
                    g = this.fixHooks[e];
                for (g || (this.fixHooks[e] = g = Ha.test(e) ? this.mouseHooks : Ga.test(e) ? this.keyHooks : {}), d = g.props ? this.props.concat(g.props) : this.props, a = new ea.Event(f), b = d.length; b--;) c = d[b], a[c] = f[c];
                return a.target || (a.target = f.srcElement || oa), 3 === a.target.nodeType && (a.target = a.target.parentNode), a.metaKey = !!a.metaKey, g.filter ? g.filter(a, f) : a
            },
            props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
            fixHooks: {},
            keyHooks: {
                props: "char charCode key keyCode".split(" "),
                filter: function(a, b) {
                    return null == a.which && (a.which = null != b.charCode ? b.charCode : b.keyCode), a
                }
            },
            mouseHooks: {
                props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
                filter: function(a, b) {
                    var c, d, e, f = b.button,
                        g = b.fromElement;
                    return null == a.pageX && null != b.clientX && (d = a.target.ownerDocument || oa, e = d.documentElement, c = d.body, a.pageX = b.clientX + (e && e.scrollLeft || c && c.scrollLeft || 0) - (e && e.clientLeft || c && c.clientLeft || 0), a.pageY = b.clientY + (e && e.scrollTop || c && c.scrollTop || 0) - (e && e.clientTop || c && c.clientTop || 0)), !a.relatedTarget && g && (a.relatedTarget = g === a.target ? b.toElement : g), a.which || void 0 === f || (a.which = 1 & f ? 1 : 2 & f ? 3 : 4 & f ? 2 : 0), a
                }
            },
            special: {
                load: {
                    noBubble: !0
                },
                focus: {
                    trigger: function() {
                        if (this !== o() && this.focus) try {
                            return this.focus(), !1
                        } catch (a) {}
                    },
                    delegateType: "focusin"
                },
                blur: {
                    trigger: function() {
                        return this === o() && this.blur ? (this.blur(), !1) : void 0
                    },
                    delegateType: "focusout"
                },
                click: {
                    trigger: function() {
                        return ea.nodeName(this, "input") && "checkbox" === this.type && this.click ? (this.click(), !1) : void 0
                    },
                    _default: function(a) {
                        return ea.nodeName(a.target, "a")
                    }
                },
                beforeunload: {
                    postDispatch: function(a) {
                        void 0 !== a.result && a.originalEvent && (a.originalEvent.returnValue = a.result)
                    }
                }
            },
            simulate: function(a, b, c, d) {
                var e = ea.extend(new ea.Event, c, {
                    type: a,
                    isSimulated: !0,
                    originalEvent: {}
                });
                d ? ea.event.trigger(e, null, b) : ea.event.dispatch.call(b, e), e.isDefaultPrevented() && c.preventDefault()
            }
        }, ea.removeEvent = oa.removeEventListener ? function(a, b, c) {
            a.removeEventListener && a.removeEventListener(b, c, !1)
        } : function(a, b, c) {
            var d = "on" + b;
            a.detachEvent && (typeof a[d] === wa && (a[d] = null), a.detachEvent(d, c))
        }, ea.Event = function(a, b) {
            return this instanceof ea.Event ? (a && a.type ? (this.originalEvent = a, this.type = a.type, this.isDefaultPrevented = a.defaultPrevented || void 0 === a.defaultPrevented && a.returnValue === !1 ? m : n) : this.type = a, b && ea.extend(this, b), this.timeStamp = a && a.timeStamp || ea.now(), void(this[ea.expando] = !0)) : new ea.Event(a, b)
        }, ea.Event.prototype = {
            isDefaultPrevented: n,
            isPropagationStopped: n,
            isImmediatePropagationStopped: n,
            preventDefault: function() {
                var a = this.originalEvent;
                this.isDefaultPrevented = m, a && (a.preventDefault ? a.preventDefault() : a.returnValue = !1)
            },
            stopPropagation: function() {
                var a = this.originalEvent;
                this.isPropagationStopped = m, a && (a.stopPropagation && a.stopPropagation(), a.cancelBubble = !0)
            },
            stopImmediatePropagation: function() {
                var a = this.originalEvent;
                this.isImmediatePropagationStopped = m, a && a.stopImmediatePropagation && a.stopImmediatePropagation(), this.stopPropagation()
            }
        }, ea.each({
            mouseenter: "mouseover",
            mouseleave: "mouseout",
            pointerenter: "pointerover",
            pointerleave: "pointerout"
        }, function(a, b) {
            ea.event.special[a] = {
                delegateType: b,
                bindType: b,
                handle: function(a) {
                    var c, d = this,
                        e = a.relatedTarget,
                        f = a.handleObj;
                    return (!e || e !== d && !ea.contains(d, e)) && (a.type = f.origType, c = f.handler.apply(this, arguments), a.type = b), c
                }
            }
        }), ca.submitBubbles || (ea.event.special.submit = {
            setup: function() {
                return !ea.nodeName(this, "form") && void ea.event.add(this, "click._submit keypress._submit", function(a) {
                    var b = a.target,
                        c = ea.nodeName(b, "input") || ea.nodeName(b, "button") ? b.form : void 0;
                    c && !ea._data(c, "submitBubbles") && (ea.event.add(c, "submit._submit", function(a) {
                        a._submit_bubble = !0
                    }), ea._data(c, "submitBubbles", !0))
                })
            },
            postDispatch: function(a) {
                a._submit_bubble && (delete a._submit_bubble, this.parentNode && !a.isTrigger && ea.event.simulate("submit", this.parentNode, a, !0))
            },
            teardown: function() {
                return !ea.nodeName(this, "form") && void ea.event.remove(this, "._submit")
            }
        }), ca.changeBubbles || (ea.event.special.change = {
            setup: function() {
                return Fa.test(this.nodeName) ? (("checkbox" === this.type || "radio" === this.type) && (ea.event.add(this, "propertychange._change", function(a) {
                    "checked" === a.originalEvent.propertyName && (this._just_changed = !0)
                }), ea.event.add(this, "click._change", function(a) {
                    this._just_changed && !a.isTrigger && (this._just_changed = !1), ea.event.simulate("change", this, a, !0)
                })), !1) : void ea.event.add(this, "beforeactivate._change", function(a) {
                    var b = a.target;
                    Fa.test(b.nodeName) && !ea._data(b, "changeBubbles") && (ea.event.add(b, "change._change", function(a) {
                        !this.parentNode || a.isSimulated || a.isTrigger || ea.event.simulate("change", this.parentNode, a, !0)
                    }), ea._data(b, "changeBubbles", !0))
                })
            },
            handle: function(a) {
                var b = a.target;
                return this !== b || a.isSimulated || a.isTrigger || "radio" !== b.type && "checkbox" !== b.type ? a.handleObj.handler.apply(this, arguments) : void 0
            },
            teardown: function() {
                return ea.event.remove(this, "._change"), !Fa.test(this.nodeName)
            }
        }), ca.focusinBubbles || ea.each({
            focus: "focusin",
            blur: "focusout"
        }, function(a, b) {
            var c = function(a) {
                ea.event.simulate(b, a.target, ea.event.fix(a), !0)
            };
            ea.event.special[b] = {
                setup: function() {
                    var d = this.ownerDocument || this,
                        e = ea._data(d, b);
                    e || d.addEventListener(a, c, !0), ea._data(d, b, (e || 0) + 1)
                },
                teardown: function() {
                    var d = this.ownerDocument || this,
                        e = ea._data(d, b) - 1;
                    e ? ea._data(d, b, e) : (d.removeEventListener(a, c, !0), ea._removeData(d, b))
                }
            }
        }), ea.fn.extend({
            on: function(a, b, c, d, e) {
                var f, g;
                if ("object" == typeof a) {
                    "string" != typeof b && (c = c || b, b = void 0);
                    for (f in a) this.on(f, b, c, a[f], e);
                    return this
                }
                if (null == c && null == d ? (d = b, c = b = void 0) : null == d && ("string" == typeof b ? (d = c, c = void 0) : (d = c, c = b, b = void 0)), d === !1) d = n;
                else if (!d) return this;
                return 1 === e && (g = d, d = function(a) {
                    return ea().off(a), g.apply(this, arguments)
                }, d.guid = g.guid || (g.guid = ea.guid++)), this.each(function() {
                    ea.event.add(this, a, d, c, b)
                })
            },
            one: function(a, b, c, d) {
                return this.on(a, b, c, d, 1)
            },
            off: function(a, b, c) {
                var d, e;
                if (a && a.preventDefault && a.handleObj) return d = a.handleObj, ea(a.delegateTarget).off(d.namespace ? d.origType + "." + d.namespace : d.origType, d.selector, d.handler), this;
                if ("object" == typeof a) {
                    for (e in a) this.off(e, b, a[e]);
                    return this
                }
                return (b === !1 || "function" == typeof b) && (c = b, b = void 0), c === !1 && (c = n), this.each(function() {
                    ea.event.remove(this, a, c, b)
                })
            },
            trigger: function(a, b) {
                return this.each(function() {
                    ea.event.trigger(a, b, this)
                })
            },
            triggerHandler: function(a, b) {
                var c = this[0];
                return c ? ea.event.trigger(a, b, c, !0) : void 0
            }
        });
        var Ka = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",
            La = / jQuery\d+="(?:null|\d+)"/g,
            Ma = new RegExp("<(?:" + Ka + ")[\\s/>]", "i"),
            Na = /^\s+/,
            Oa = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
            Pa = /<([\w:]+)/,
            Qa = /<tbody/i,
            Ra = /<|&#?\w+;/,
            Sa = /<(?:script|style|link)/i,
            Ta = /checked\s*(?:[^=]|=\s*.checked.)/i,
            Ua = /^$|\/(?:java|ecma)script/i,
            Va = /^true\/(.*)/,
            Wa = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
            Xa = {
                option: [1, "<select multiple='multiple'>", "</select>"],
                legend: [1, "<fieldset>", "</fieldset>"],
                area: [1, "<map>", "</map>"],
                param: [1, "<object>", "</object>"],
                thead: [1, "<table>", "</table>"],
                tr: [2, "<table><tbody>", "</tbody></table>"],
                col: [2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"],
                td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
                _default: ca.htmlSerialize ? [0, "", ""] : [1, "X<div>", "</div>"]
            },
            Ya = p(oa),
            Za = Ya.appendChild(oa.createElement("div"));
        Xa.optgroup = Xa.option, Xa.tbody = Xa.tfoot = Xa.colgroup = Xa.caption = Xa.thead, Xa.th = Xa.td, ea.extend({
            clone: function(a, b, c) {
                var d, e, f, g, h, i = ea.contains(a.ownerDocument, a);
                if (ca.html5Clone || ea.isXMLDoc(a) || !Ma.test("<" + a.nodeName + ">") ? f = a.cloneNode(!0) : (Za.innerHTML = a.outerHTML, Za.removeChild(f = Za.firstChild)), !(ca.noCloneEvent && ca.noCloneChecked || 1 !== a.nodeType && 11 !== a.nodeType || ea.isXMLDoc(a)))
                    for (d = q(f), h = q(a), g = 0; null != (e = h[g]); ++g) d[g] && x(e, d[g]);
                if (b)
                    if (c)
                        for (h = h || q(a), d = d || q(f), g = 0; null != (e = h[g]); g++) w(e, d[g]);
                    else w(a, f);
                return d = q(f, "script"), d.length > 0 && v(d, !i && q(a, "script")), d = h = e = null, f
            },
            buildFragment: function(a, b, c, d) {
                for (var e, f, g, h, i, j, k, l = a.length, m = p(b), n = [], o = 0; l > o; o++)
                    if (f = a[o], f || 0 === f)
                        if ("object" === ea.type(f)) ea.merge(n, f.nodeType ? [f] : f);
                        else if (Ra.test(f)) {
                    for (h = h || m.appendChild(b.createElement("div")), i = (Pa.exec(f) || ["", ""])[1].toLowerCase(), k = Xa[i] || Xa._default, h.innerHTML = k[1] + f.replace(Oa, "<$1></$2>") + k[2], e = k[0]; e--;) h = h.lastChild;
                    if (!ca.leadingWhitespace && Na.test(f) && n.push(b.createTextNode(Na.exec(f)[0])), !ca.tbody)
                        for (f = "table" !== i || Qa.test(f) ? "<table>" !== k[1] || Qa.test(f) ? 0 : h : h.firstChild, e = f && f.childNodes.length; e--;) ea.nodeName(j = f.childNodes[e], "tbody") && !j.childNodes.length && f.removeChild(j);
                    for (ea.merge(n, h.childNodes), h.textContent = ""; h.firstChild;) h.removeChild(h.firstChild);
                    h = m.lastChild
                } else n.push(b.createTextNode(f));
                for (h && m.removeChild(h), ca.appendChecked || ea.grep(q(n, "input"), r), o = 0; f = n[o++];)
                    if ((!d || -1 === ea.inArray(f, d)) && (g = ea.contains(f.ownerDocument, f), h = q(m.appendChild(f), "script"), g && v(h), c))
                        for (e = 0; f = h[e++];) Ua.test(f.type || "") && c.push(f);
                return h = null, m
            },
            cleanData: function(a, b) {
                for (var c, d, e, f, g = 0, h = ea.expando, i = ea.cache, j = ca.deleteExpando, k = ea.event.special; null != (c = a[g]); g++)
                    if ((b || ea.acceptData(c)) && (e = c[h], f = e && i[e])) {
                        if (f.events)
                            for (d in f.events) k[d] ? ea.event.remove(c, d) : ea.removeEvent(c, d, f.handle);
                        i[e] && (delete i[e], j ? delete c[h] : typeof c.removeAttribute !== wa ? c.removeAttribute(h) : c[h] = null, W.push(e))
                    }
            }
        }), ea.fn.extend({
            text: function(a) {
                return Da(this, function(a) {
                    return void 0 === a ? ea.text(this) : this.empty().append((this[0] && this[0].ownerDocument || oa).createTextNode(a))
                }, null, a, arguments.length)
            },
            append: function() {
                return this.domManip(arguments, function(a) {
                    if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                        var b = s(this, a);
                        b.appendChild(a)
                    }
                })
            },
            prepend: function() {
                return this.domManip(arguments, function(a) {
                    if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                        var b = s(this, a);
                        b.insertBefore(a, b.firstChild)
                    }
                })
            },
            before: function() {
                return this.domManip(arguments, function(a) {
                    this.parentNode && this.parentNode.insertBefore(a, this)
                })
            },
            after: function() {
                return this.domManip(arguments, function(a) {
                    this.parentNode && this.parentNode.insertBefore(a, this.nextSibling)
                })
            },
            remove: function(a, b) {
                for (var c, d = a ? ea.filter(a, this) : this, e = 0; null != (c = d[e]); e++) b || 1 !== c.nodeType || ea.cleanData(q(c)), c.parentNode && (b && ea.contains(c.ownerDocument, c) && v(q(c, "script")), c.parentNode.removeChild(c));
                return this
            },
            empty: function() {
                for (var a, b = 0; null != (a = this[b]); b++) {
                    for (1 === a.nodeType && ea.cleanData(q(a, !1)); a.firstChild;) a.removeChild(a.firstChild);
                    a.options && ea.nodeName(a, "select") && (a.options.length = 0)
                }
                return this
            },
            clone: function(a, b) {
                return a = null != a && a, b = null == b ? a : b, this.map(function() {
                    return ea.clone(this, a, b)
                })
            },
            html: function(a) {
                return Da(this, function(a) {
                    var b = this[0] || {},
                        c = 0,
                        d = this.length;
                    if (void 0 === a) return 1 === b.nodeType ? b.innerHTML.replace(La, "") : void 0;
                    if (!("string" != typeof a || Sa.test(a) || !ca.htmlSerialize && Ma.test(a) || !ca.leadingWhitespace && Na.test(a) || Xa[(Pa.exec(a) || ["", ""])[1].toLowerCase()])) {
                        a = a.replace(Oa, "<$1></$2>");
                        try {
                            for (; d > c; c++) b = this[c] || {}, 1 === b.nodeType && (ea.cleanData(q(b, !1)), b.innerHTML = a);
                            b = 0
                        } catch (a) {}
                    }
                    b && this.empty().append(a)
                }, null, a, arguments.length)
            },
            replaceWith: function() {
                var a = arguments[0];
                return this.domManip(arguments, function(b) {
                    a = this.parentNode, ea.cleanData(q(this)), a && a.replaceChild(b, this)
                }), a && (a.length || a.nodeType) ? this : this.remove()
            },
            detach: function(a) {
                return this.remove(a, !0)
            },
            domManip: function(a, b) {
                a = Y.apply([], a);
                var c, d, e, f, g, h, i = 0,
                    j = this.length,
                    k = this,
                    l = j - 1,
                    m = a[0],
                    n = ea.isFunction(m);
                if (n || j > 1 && "string" == typeof m && !ca.checkClone && Ta.test(m)) return this.each(function(c) {
                    var d = k.eq(c);
                    n && (a[0] = m.call(this, c, d.html())), d.domManip(a, b)
                });
                if (j && (h = ea.buildFragment(a, this[0].ownerDocument, !1, this), c = h.firstChild, 1 === h.childNodes.length && (h = c), c)) {
                    for (f = ea.map(q(h, "script"), t), e = f.length; j > i; i++) d = h, i !== l && (d = ea.clone(d, !0, !0), e && ea.merge(f, q(d, "script"))), b.call(this[i], d, i);
                    if (e)
                        for (g = f[f.length - 1].ownerDocument, ea.map(f, u), i = 0; e > i; i++) d = f[i], Ua.test(d.type || "") && !ea._data(d, "globalEval") && ea.contains(g, d) && (d.src ? ea._evalUrl && ea._evalUrl(d.src) : ea.globalEval((d.text || d.textContent || d.innerHTML || "").replace(Wa, "")));
                    h = c = null
                }
                return this
            }
        }), ea.each({
            appendTo: "append",
            prependTo: "prepend",
            insertBefore: "before",
            insertAfter: "after",
            replaceAll: "replaceWith"
        }, function(a, b) {
            ea.fn[a] = function(a) {
                for (var c, d = 0, e = [], f = ea(a), g = f.length - 1; g >= d; d++) c = d === g ? this : this.clone(!0), ea(f[d])[b](c), Z.apply(e, c.get());
                return this.pushStack(e)
            }
        });
        var $a, _a = {};
        ! function() {
            var a;
            ca.shrinkWrapBlocks = function() {
                if (null != a) return a;
                a = !1;
                var b, c, d;
                return c = oa.getElementsByTagName("body")[0], c && c.style ? (b = oa.createElement("div"), d = oa.createElement("div"), d.style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px", c.appendChild(d).appendChild(b), typeof b.style.zoom !== wa && (b.style.cssText = "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1", b.appendChild(oa.createElement("div")).style.width = "5px",
                    a = 3 !== b.offsetWidth), c.removeChild(d), a) : void 0
            }
        }();
        var cb, db, ab = /^margin/,
            bb = new RegExp("^(" + Aa + ")(?!px)[a-z%]+$", "i"),
            eb = /^(top|right|bottom|left)$/;
        a.getComputedStyle ? (cb = function(b) {
            return b.ownerDocument.defaultView.opener ? b.ownerDocument.defaultView.getComputedStyle(b, null) : a.getComputedStyle(b, null)
        }, db = function(a, b, c) {
            var d, e, f, g, h = a.style;
            return c = c || cb(a), g = c ? c.getPropertyValue(b) || c[b] : void 0, c && ("" !== g || ea.contains(a.ownerDocument, a) || (g = ea.style(a, b)), bb.test(g) && ab.test(b) && (d = h.width, e = h.minWidth, f = h.maxWidth, h.minWidth = h.maxWidth = h.width = g, g = c.width, h.width = d, h.minWidth = e, h.maxWidth = f)), void 0 === g ? g : g + ""
        }) : oa.documentElement.currentStyle && (cb = function(a) {
            return a.currentStyle
        }, db = function(a, b, c) {
            var d, e, f, g, h = a.style;
            return c = c || cb(a), g = c ? c[b] : void 0, null == g && h && h[b] && (g = h[b]), bb.test(g) && !eb.test(b) && (d = h.left, e = a.runtimeStyle, f = e && e.left, f && (e.left = a.currentStyle.left), h.left = "fontSize" === b ? "1em" : g, g = h.pixelLeft + "px", h.left = d, f && (e.left = f)), void 0 === g ? g : g + "" || "auto"
        }), ! function() {
            function i() {
                var b, c, d, i;
                c = oa.getElementsByTagName("body")[0], c && c.style && (b = oa.createElement("div"), d = oa.createElement("div"), d.style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px", c.appendChild(d).appendChild(b), b.style.cssText = "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute", e = f = !1, h = !0, a.getComputedStyle && (e = "1%" !== (a.getComputedStyle(b, null) || {}).top, f = "4px" === (a.getComputedStyle(b, null) || {
                    width: "4px"
                }).width, i = b.appendChild(oa.createElement("div")), i.style.cssText = b.style.cssText = "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0", i.style.marginRight = i.style.width = "0", b.style.width = "1px", h = !parseFloat((a.getComputedStyle(i, null) || {}).marginRight), b.removeChild(i)), b.innerHTML = "<table><tr><td></td><td>t</td></tr></table>", i = b.getElementsByTagName("td"), i[0].style.cssText = "margin:0;border:0;padding:0;display:none", g = 0 === i[0].offsetHeight, g && (i[0].style.display = "", i[1].style.display = "none", g = 0 === i[0].offsetHeight), c.removeChild(d))
            }
            var b, c, d, e, f, g, h;
            b = oa.createElement("div"), b.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", d = b.getElementsByTagName("a")[0], (c = d && d.style) && (c.cssText = "float:left;opacity:.5", ca.opacity = "0.5" === c.opacity, ca.cssFloat = !!c.cssFloat, b.style.backgroundClip = "content-box", b.cloneNode(!0).style.backgroundClip = "", ca.clearCloneStyle = "content-box" === b.style.backgroundClip, ca.boxSizing = "" === c.boxSizing || "" === c.MozBoxSizing || "" === c.WebkitBoxSizing, ea.extend(ca, {
                reliableHiddenOffsets: function() {
                    return null == g && i(), g
                },
                boxSizingReliable: function() {
                    return null == f && i(), f
                },
                pixelPosition: function() {
                    return null == e && i(), e
                },
                reliableMarginRight: function() {
                    return null == h && i(), h
                }
            }))
        }(), ea.swap = function(a, b, c, d) {
            var e, f, g = {};
            for (f in b) g[f] = a.style[f], a.style[f] = b[f];
            e = c.apply(a, d || []);
            for (f in b) a.style[f] = g[f];
            return e
        };
        var fb = /alpha\([^)]*\)/i,
            gb = /opacity\s*=\s*([^)]*)/,
            hb = /^(none|table(?!-c[ea]).+)/,
            ib = new RegExp("^(" + Aa + ")(.*)$", "i"),
            jb = new RegExp("^([+-])=(" + Aa + ")", "i"),
            kb = {
                position: "absolute",
                visibility: "hidden",
                display: "block"
            },
            lb = {
                letterSpacing: "0",
                fontWeight: "400"
            },
            mb = ["Webkit", "O", "Moz", "ms"];
        ea.extend({
            cssHooks: {
                opacity: {
                    get: function(a, b) {
                        if (b) {
                            var c = db(a, "opacity");
                            return "" === c ? "1" : c
                        }
                    }
                }
            },
            cssNumber: {
                columnCount: !0,
                fillOpacity: !0,
                flexGrow: !0,
                flexShrink: !0,
                fontWeight: !0,
                lineHeight: !0,
                opacity: !0,
                order: !0,
                orphans: !0,
                widows: !0,
                zIndex: !0,
                zoom: !0
            },
            cssProps: {
                float: ca.cssFloat ? "cssFloat" : "styleFloat"
            },
            style: function(a, b, c, d) {
                if (a && 3 !== a.nodeType && 8 !== a.nodeType && a.style) {
                    var e, f, g, h = ea.camelCase(b),
                        i = a.style;
                    if (b = ea.cssProps[h] || (ea.cssProps[h] = B(i, h)), g = ea.cssHooks[b] || ea.cssHooks[h], void 0 === c) return g && "get" in g && void 0 !== (e = g.get(a, !1, d)) ? e : i[b];
                    if (f = typeof c, "string" === f && (e = jb.exec(c)) && (c = (e[1] + 1) * e[2] + parseFloat(ea.css(a, b)), f = "number"), null != c && c === c && ("number" !== f || ea.cssNumber[h] || (c += "px"), ca.clearCloneStyle || "" !== c || 0 !== b.indexOf("background") || (i[b] = "inherit"), !(g && "set" in g && void 0 === (c = g.set(a, c, d))))) try {
                        i[b] = c
                    } catch (a) {}
                }
            },
            css: function(a, b, c, d) {
                var e, f, g, h = ea.camelCase(b);
                return b = ea.cssProps[h] || (ea.cssProps[h] = B(a.style, h)), g = ea.cssHooks[b] || ea.cssHooks[h], g && "get" in g && (f = g.get(a, !0, c)), void 0 === f && (f = db(a, b, d)), "normal" === f && b in lb && (f = lb[b]), "" === c || c ? (e = parseFloat(f), c === !0 || ea.isNumeric(e) ? e || 0 : f) : f
            }
        }), ea.each(["height", "width"], function(a, b) {
            ea.cssHooks[b] = {
                get: function(a, c, d) {
                    return c ? hb.test(ea.css(a, "display")) && 0 === a.offsetWidth ? ea.swap(a, kb, function() {
                        return F(a, b, d)
                    }) : F(a, b, d) : void 0
                },
                set: function(a, c, d) {
                    var e = d && cb(a);
                    return D(a, c, d ? E(a, b, d, ca.boxSizing && "border-box" === ea.css(a, "boxSizing", !1, e), e) : 0)
                }
            }
        }), ca.opacity || (ea.cssHooks.opacity = {
            get: function(a, b) {
                return gb.test((b && a.currentStyle ? a.currentStyle.filter : a.style.filter) || "") ? .01 * parseFloat(RegExp.$1) + "" : b ? "1" : ""
            },
            set: function(a, b) {
                var c = a.style,
                    d = a.currentStyle,
                    e = ea.isNumeric(b) ? "alpha(opacity=" + 100 * b + ")" : "",
                    f = d && d.filter || c.filter || "";
                c.zoom = 1, (b >= 1 || "" === b) && "" === ea.trim(f.replace(fb, "")) && c.removeAttribute && (c.removeAttribute("filter"), "" === b || d && !d.filter) || (c.filter = fb.test(f) ? f.replace(fb, e) : f + " " + e)
            }
        }), ea.cssHooks.marginRight = A(ca.reliableMarginRight, function(a, b) {
            return b ? ea.swap(a, {
                display: "inline-block"
            }, db, [a, "marginRight"]) : void 0
        }), ea.each({
            margin: "",
            padding: "",
            border: "Width"
        }, function(a, b) {
            ea.cssHooks[a + b] = {
                expand: function(c) {
                    for (var d = 0, e = {}, f = "string" == typeof c ? c.split(" ") : [c]; 4 > d; d++) e[a + Ba[d] + b] = f[d] || f[d - 2] || f[0];
                    return e
                }
            }, ab.test(a) || (ea.cssHooks[a + b].set = D)
        }), ea.fn.extend({
            css: function(a, b) {
                return Da(this, function(a, b, c) {
                    var d, e, f = {},
                        g = 0;
                    if (ea.isArray(b)) {
                        for (d = cb(a), e = b.length; e > g; g++) f[b[g]] = ea.css(a, b[g], !1, d);
                        return f
                    }
                    return void 0 !== c ? ea.style(a, b, c) : ea.css(a, b)
                }, a, b, arguments.length > 1)
            },
            show: function() {
                return C(this, !0)
            },
            hide: function() {
                return C(this)
            },
            toggle: function(a) {
                return "boolean" == typeof a ? a ? this.show() : this.hide() : this.each(function() {
                    Ca(this) ? ea(this).show() : ea(this).hide()
                })
            }
        }), ea.Tween = G, G.prototype = {
            constructor: G,
            init: function(a, b, c, d, e, f) {
                this.elem = a, this.prop = c, this.easing = e || "swing", this.options = b, this.start = this.now = this.cur(), this.end = d, this.unit = f || (ea.cssNumber[c] ? "" : "px")
            },
            cur: function() {
                var a = G.propHooks[this.prop];
                return a && a.get ? a.get(this) : G.propHooks._default.get(this)
            },
            run: function(a) {
                var b, c = G.propHooks[this.prop];
                return this.options.duration ? this.pos = b = ea.easing[this.easing](a, this.options.duration * a, 0, 1, this.options.duration) : this.pos = b = a, this.now = (this.end - this.start) * b + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), c && c.set ? c.set(this) : G.propHooks._default.set(this), this
            }
        }, G.prototype.init.prototype = G.prototype, G.propHooks = {
            _default: {
                get: function(a) {
                    var b;
                    return null == a.elem[a.prop] || a.elem.style && null != a.elem.style[a.prop] ? (b = ea.css(a.elem, a.prop, ""), b && "auto" !== b ? b : 0) : a.elem[a.prop]
                },
                set: function(a) {
                    ea.fx.step[a.prop] ? ea.fx.step[a.prop](a) : a.elem.style && (null != a.elem.style[ea.cssProps[a.prop]] || ea.cssHooks[a.prop]) ? ea.style(a.elem, a.prop, a.now + a.unit) : a.elem[a.prop] = a.now
                }
            }
        }, G.propHooks.scrollTop = G.propHooks.scrollLeft = {
            set: function(a) {
                a.elem.nodeType && a.elem.parentNode && (a.elem[a.prop] = a.now)
            }
        }, ea.easing = {
            linear: function(a) {
                return a
            },
            swing: function(a) {
                return .5 - Math.cos(a * Math.PI) / 2
            }
        }, ea.fx = G.prototype.init, ea.fx.step = {};
        var nb, ob, pb = /^(?:toggle|show|hide)$/,
            qb = new RegExp("^(?:([+-])=|)(" + Aa + ")([a-z%]*)$", "i"),
            rb = /queueHooks$/,
            sb = [K],
            tb = {
                "*": [function(a, b) {
                    var c = this.createTween(a, b),
                        d = c.cur(),
                        e = qb.exec(b),
                        f = e && e[3] || (ea.cssNumber[a] ? "" : "px"),
                        g = (ea.cssNumber[a] || "px" !== f && +d) && qb.exec(ea.css(c.elem, a)),
                        h = 1,
                        i = 20;
                    if (g && g[3] !== f) {
                        f = f || g[3], e = e || [], g = +d || 1;
                        do h = h || ".5", g /= h, ea.style(c.elem, a, g + f); while (h !== (h = c.cur() / d) && 1 !== h && --i)
                    }
                    return e && (g = c.start = +g || +d || 0, c.unit = f, c.end = e[1] ? g + (e[1] + 1) * e[2] : +e[2]), c
                }]
            };
        ea.Animation = ea.extend(M, {
                tweener: function(a, b) {
                    ea.isFunction(a) ? (b = a, a = ["*"]) : a = a.split(" ");
                    for (var c, d = 0, e = a.length; e > d; d++) c = a[d], tb[c] = tb[c] || [], tb[c].unshift(b)
                },
                prefilter: function(a, b) {
                    b ? sb.unshift(a) : sb.push(a)
                }
            }), ea.speed = function(a, b, c) {
                var d = a && "object" == typeof a ? ea.extend({}, a) : {
                    complete: c || !c && b || ea.isFunction(a) && a,
                    duration: a,
                    easing: c && b || b && !ea.isFunction(b) && b
                };
                return d.duration = ea.fx.off ? 0 : "number" == typeof d.duration ? d.duration : d.duration in ea.fx.speeds ? ea.fx.speeds[d.duration] : ea.fx.speeds._default, (null == d.queue || d.queue === !0) && (d.queue = "fx"), d.old = d.complete, d.complete = function() {
                    ea.isFunction(d.old) && d.old.call(this), d.queue && ea.dequeue(this, d.queue)
                }, d
            }, ea.fn.extend({
                fadeTo: function(a, b, c, d) {
                    return this.filter(Ca).css("opacity", 0).show().end().animate({
                        opacity: b
                    }, a, c, d)
                },
                animate: function(a, b, c, d) {
                    var e = ea.isEmptyObject(a),
                        f = ea.speed(b, c, d),
                        g = function() {
                            var b = M(this, ea.extend({}, a), f);
                            (e || ea._data(this, "finish")) && b.stop(!0)
                        };
                    return g.finish = g, e || f.queue === !1 ? this.each(g) : this.queue(f.queue, g)
                },
                stop: function(a, b, c) {
                    var d = function(a) {
                        var b = a.stop;
                        delete a.stop, b(c)
                    };
                    return "string" != typeof a && (c = b, b = a, a = void 0), b && a !== !1 && this.queue(a || "fx", []), this.each(function() {
                        var b = !0,
                            e = null != a && a + "queueHooks",
                            f = ea.timers,
                            g = ea._data(this);
                        if (e) g[e] && g[e].stop && d(g[e]);
                        else
                            for (e in g) g[e] && g[e].stop && rb.test(e) && d(g[e]);
                        for (e = f.length; e--;) f[e].elem !== this || null != a && f[e].queue !== a || (f[e].anim.stop(c), b = !1, f.splice(e, 1));
                        (b || !c) && ea.dequeue(this, a)
                    })
                },
                finish: function(a) {
                    return a !== !1 && (a = a || "fx"), this.each(function() {
                        var b, c = ea._data(this),
                            d = c[a + "queue"],
                            e = c[a + "queueHooks"],
                            f = ea.timers,
                            g = d ? d.length : 0;
                        for (c.finish = !0, ea.queue(this, a, []), e && e.stop && e.stop.call(this, !0), b = f.length; b--;) f[b].elem === this && f[b].queue === a && (f[b].anim.stop(!0), f.splice(b, 1));
                        for (b = 0; g > b; b++) d[b] && d[b].finish && d[b].finish.call(this);
                        delete c.finish
                    })
                }
            }), ea.each(["toggle", "show", "hide"], function(a, b) {
                var c = ea.fn[b];
                ea.fn[b] = function(a, d, e) {
                    return null == a || "boolean" == typeof a ? c.apply(this, arguments) : this.animate(I(b, !0), a, d, e)
                }
            }), ea.each({
                slideDown: I("show"),
                slideUp: I("hide"),
                slideToggle: I("toggle"),
                fadeIn: {
                    opacity: "show"
                },
                fadeOut: {
                    opacity: "hide"
                },
                fadeToggle: {
                    opacity: "toggle"
                }
            }, function(a, b) {
                ea.fn[a] = function(a, c, d) {
                    return this.animate(b, a, c, d)
                }
            }), ea.timers = [], ea.fx.tick = function() {
                var a, b = ea.timers,
                    c = 0;
                for (nb = ea.now(); c < b.length; c++) a = b[c], a() || b[c] !== a || b.splice(c--, 1);
                b.length || ea.fx.stop(), nb = void 0
            }, ea.fx.timer = function(a) {
                ea.timers.push(a), a() ? ea.fx.start() : ea.timers.pop()
            }, ea.fx.interval = 13, ea.fx.start = function() {
                ob || (ob = setInterval(ea.fx.tick, ea.fx.interval))
            }, ea.fx.stop = function() {
                clearInterval(ob), ob = null
            }, ea.fx.speeds = {
                slow: 600,
                fast: 200,
                _default: 400
            }, ea.fn.delay = function(a, b) {
                return a = ea.fx ? ea.fx.speeds[a] || a : a, b = b || "fx", this.queue(b, function(b, c) {
                    var d = setTimeout(b, a);
                    c.stop = function() {
                        clearTimeout(d)
                    }
                })
            },
            function() {
                var a, b, c, d, e;
                b = oa.createElement("div"), b.setAttribute("className", "t"), b.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", d = b.getElementsByTagName("a")[0], c = oa.createElement("select"), e = c.appendChild(oa.createElement("option")), a = b.getElementsByTagName("input")[0], d.style.cssText = "top:1px", ca.getSetAttribute = "t" !== b.className, ca.style = /top/.test(d.getAttribute("style")), ca.hrefNormalized = "/a" === d.getAttribute("href"), ca.checkOn = !!a.value, ca.optSelected = e.selected, ca.enctype = !!oa.createElement("form").enctype, c.disabled = !0, ca.optDisabled = !e.disabled, a = oa.createElement("input"), a.setAttribute("value", ""), ca.input = "" === a.getAttribute("value"), a.value = "t", a.setAttribute("type", "radio"), ca.radioValue = "t" === a.value
            }();
        var ub = /\r/g;
        ea.fn.extend({
            val: function(a) {
                var b, c, d, e = this[0];
                return arguments.length ? (d = ea.isFunction(a), this.each(function(c) {
                    var e;
                    1 === this.nodeType && (e = d ? a.call(this, c, ea(this).val()) : a, null == e ? e = "" : "number" == typeof e ? e += "" : ea.isArray(e) && (e = ea.map(e, function(a) {
                        return null == a ? "" : a + ""
                    })), b = ea.valHooks[this.type] || ea.valHooks[this.nodeName.toLowerCase()], b && "set" in b && void 0 !== b.set(this, e, "value") || (this.value = e))
                })) : e ? (b = ea.valHooks[e.type] || ea.valHooks[e.nodeName.toLowerCase()], b && "get" in b && void 0 !== (c = b.get(e, "value")) ? c : (c = e.value, "string" == typeof c ? c.replace(ub, "") : null == c ? "" : c)) : void 0
            }
        }), ea.extend({
            valHooks: {
                option: {
                    get: function(a) {
                        var b = ea.find.attr(a, "value");
                        return null != b ? b : ea.trim(ea.text(a))
                    }
                },
                select: {
                    get: function(a) {
                        for (var b, c, d = a.options, e = a.selectedIndex, f = "select-one" === a.type || 0 > e, g = f ? null : [], h = f ? e + 1 : d.length, i = 0 > e ? h : f ? e : 0; h > i; i++)
                            if (c = d[i], !(!c.selected && i !== e || (ca.optDisabled ? c.disabled : null !== c.getAttribute("disabled")) || c.parentNode.disabled && ea.nodeName(c.parentNode, "optgroup"))) {
                                if (b = ea(c).val(), f) return b;
                                g.push(b)
                            }
                        return g
                    },
                    set: function(a, b) {
                        for (var c, d, e = a.options, f = ea.makeArray(b), g = e.length; g--;)
                            if (d = e[g], ea.inArray(ea.valHooks.option.get(d), f) >= 0) try {
                                d.selected = c = !0
                            } catch (a) {
                                d.scrollHeight
                            } else d.selected = !1;
                        return c || (a.selectedIndex = -1), e
                    }
                }
            }
        }), ea.each(["radio", "checkbox"], function() {
            ea.valHooks[this] = {
                set: function(a, b) {
                    return ea.isArray(b) ? a.checked = ea.inArray(ea(a).val(), b) >= 0 : void 0
                }
            }, ca.checkOn || (ea.valHooks[this].get = function(a) {
                return null === a.getAttribute("value") ? "on" : a.value
            })
        });
        var vb, wb, xb = ea.expr.attrHandle,
            yb = /^(?:checked|selected)$/i,
            zb = ca.getSetAttribute,
            Ab = ca.input;
        ea.fn.extend({
            attr: function(a, b) {
                return Da(this, ea.attr, a, b, arguments.length > 1)
            },
            removeAttr: function(a) {
                return this.each(function() {
                    ea.removeAttr(this, a)
                })
            }
        }), ea.extend({
            attr: function(a, b, c) {
                var d, e, f = a.nodeType;
                if (a && 3 !== f && 8 !== f && 2 !== f) return typeof a.getAttribute === wa ? ea.prop(a, b, c) : (1 === f && ea.isXMLDoc(a) || (b = b.toLowerCase(), d = ea.attrHooks[b] || (ea.expr.match.bool.test(b) ? wb : vb)), void 0 === c ? d && "get" in d && null !== (e = d.get(a, b)) ? e : (e = ea.find.attr(a, b), null == e ? void 0 : e) : null !== c ? d && "set" in d && void 0 !== (e = d.set(a, c, b)) ? e : (a.setAttribute(b, c + ""), c) : void ea.removeAttr(a, b))
            },
            removeAttr: function(a, b) {
                var c, d, e = 0,
                    f = b && b.match(ta);
                if (f && 1 === a.nodeType)
                    for (; c = f[e++];) d = ea.propFix[c] || c, ea.expr.match.bool.test(c) ? Ab && zb || !yb.test(c) ? a[d] = !1 : a[ea.camelCase("default-" + c)] = a[d] = !1 : ea.attr(a, c, ""), a.removeAttribute(zb ? c : d)
            },
            attrHooks: {
                type: {
                    set: function(a, b) {
                        if (!ca.radioValue && "radio" === b && ea.nodeName(a, "input")) {
                            var c = a.value;
                            return a.setAttribute("type", b), c && (a.value = c), b
                        }
                    }
                }
            }
        }), wb = {
            set: function(a, b, c) {
                return b === !1 ? ea.removeAttr(a, c) : Ab && zb || !yb.test(c) ? a.setAttribute(!zb && ea.propFix[c] || c, c) : a[ea.camelCase("default-" + c)] = a[c] = !0, c
            }
        }, ea.each(ea.expr.match.bool.source.match(/\w+/g), function(a, b) {
            var c = xb[b] || ea.find.attr;
            xb[b] = Ab && zb || !yb.test(b) ? function(a, b, d) {
                var e, f;
                return d || (f = xb[b], xb[b] = e, e = null != c(a, b, d) ? b.toLowerCase() : null, xb[b] = f), e
            } : function(a, b, c) {
                return c ? void 0 : a[ea.camelCase("default-" + b)] ? b.toLowerCase() : null
            }
        }), Ab && zb || (ea.attrHooks.value = {
            set: function(a, b, c) {
                return ea.nodeName(a, "input") ? void(a.defaultValue = b) : vb && vb.set(a, b, c)
            }
        }), zb || (vb = {
            set: function(a, b, c) {
                var d = a.getAttributeNode(c);
                return d || a.setAttributeNode(d = a.ownerDocument.createAttribute(c)), d.value = b += "", "value" === c || b === a.getAttribute(c) ? b : void 0
            }
        }, xb.id = xb.name = xb.coords = function(a, b, c) {
            var d;
            return c ? void 0 : (d = a.getAttributeNode(b)) && "" !== d.value ? d.value : null
        }, ea.valHooks.button = {
            get: function(a, b) {
                var c = a.getAttributeNode(b);
                return c && c.specified ? c.value : void 0
            },
            set: vb.set
        }, ea.attrHooks.contenteditable = {
            set: function(a, b, c) {
                vb.set(a, "" !== b && b, c)
            }
        }, ea.each(["width", "height"], function(a, b) {
            ea.attrHooks[b] = {
                set: function(a, c) {
                    return "" === c ? (a.setAttribute(b, "auto"), c) : void 0
                }
            }
        })), ca.style || (ea.attrHooks.style = {
            get: function(a) {
                return a.style.cssText || void 0
            },
            set: function(a, b) {
                return a.style.cssText = b + ""
            }
        });
        var Bb = /^(?:input|select|textarea|button|object)$/i,
            Cb = /^(?:a|area)$/i;
        ea.fn.extend({
            prop: function(a, b) {
                return Da(this, ea.prop, a, b, arguments.length > 1)
            },
            removeProp: function(a) {
                return a = ea.propFix[a] || a, this.each(function() {
                    try {
                        this[a] = void 0, delete this[a]
                    } catch (a) {}
                })
            }
        }), ea.extend({
            propFix: {
                for: "htmlFor",
                class: "className"
            },
            prop: function(a, b, c) {
                var d, e, f, g = a.nodeType;
                if (a && 3 !== g && 8 !== g && 2 !== g) return f = 1 !== g || !ea.isXMLDoc(a), f && (b = ea.propFix[b] || b, e = ea.propHooks[b]), void 0 !== c ? e && "set" in e && void 0 !== (d = e.set(a, c, b)) ? d : a[b] = c : e && "get" in e && null !== (d = e.get(a, b)) ? d : a[b]
            },
            propHooks: {
                tabIndex: {
                    get: function(a) {
                        var b = ea.find.attr(a, "tabindex");
                        return b ? parseInt(b, 10) : Bb.test(a.nodeName) || Cb.test(a.nodeName) && a.href ? 0 : -1
                    }
                }
            }
        }), ca.hrefNormalized || ea.each(["href", "src"], function(a, b) {
            ea.propHooks[b] = {
                get: function(a) {
                    return a.getAttribute(b, 4)
                }
            }
        }), ca.optSelected || (ea.propHooks.selected = {
            get: function(a) {
                var b = a.parentNode;
                return b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex), null
            }
        }), ea.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function() {
            ea.propFix[this.toLowerCase()] = this
        }), ca.enctype || (ea.propFix.enctype = "encoding");
        var Db = /[\t\r\n\f]/g;
        ea.fn.extend({
            addClass: function(a) {
                var b, c, d, e, f, g, h = 0,
                    i = this.length,
                    j = "string" == typeof a && a;
                if (ea.isFunction(a)) return this.each(function(b) {
                    ea(this).addClass(a.call(this, b, this.className))
                });
                if (j)
                    for (b = (a || "").match(ta) || []; i > h; h++)
                        if (c = this[h], d = 1 === c.nodeType && (c.className ? (" " + c.className + " ").replace(Db, " ") : " ")) {
                            for (f = 0; e = b[f++];) d.indexOf(" " + e + " ") < 0 && (d += e + " ");
                            g = ea.trim(d), c.className !== g && (c.className = g)
                        }
                return this
            },
            removeClass: function(a) {
                var b, c, d, e, f, g, h = 0,
                    i = this.length,
                    j = 0 === arguments.length || "string" == typeof a && a;
                if (ea.isFunction(a)) return this.each(function(b) {
                    ea(this).removeClass(a.call(this, b, this.className))
                });
                if (j)
                    for (b = (a || "").match(ta) || []; i > h; h++)
                        if (c = this[h], d = 1 === c.nodeType && (c.className ? (" " + c.className + " ").replace(Db, " ") : "")) {
                            for (f = 0; e = b[f++];)
                                for (; d.indexOf(" " + e + " ") >= 0;) d = d.replace(" " + e + " ", " ");
                            g = a ? ea.trim(d) : "", c.className !== g && (c.className = g)
                        }
                return this
            },
            toggleClass: function(a, b) {
                var c = typeof a;
                return "boolean" == typeof b && "string" === c ? b ? this.addClass(a) : this.removeClass(a) : this.each(ea.isFunction(a) ? function(c) {
                    ea(this).toggleClass(a.call(this, c, this.className, b), b)
                } : function() {
                    if ("string" === c)
                        for (var b, d = 0, e = ea(this), f = a.match(ta) || []; b = f[d++];) e.hasClass(b) ? e.removeClass(b) : e.addClass(b);
                    else(c === wa || "boolean" === c) && (this.className && ea._data(this, "__className__", this.className), this.className = this.className || a === !1 ? "" : ea._data(this, "__className__") || "")
                })
            },
            hasClass: function(a) {
                for (var b = " " + a + " ", c = 0, d = this.length; d > c; c++)
                    if (1 === this[c].nodeType && (" " + this[c].className + " ").replace(Db, " ").indexOf(b) >= 0) return !0;
                return !1
            }
        }), ea.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function(a, b) {
            ea.fn[b] = function(a, c) {
                return arguments.length > 0 ? this.on(b, null, a, c) : this.trigger(b)
            }
        }), ea.fn.extend({
            hover: function(a, b) {
                return this.mouseenter(a).mouseleave(b || a)
            },
            bind: function(a, b, c) {
                return this.on(a, null, b, c)
            },
            unbind: function(a, b) {
                return this.off(a, null, b)
            },
            delegate: function(a, b, c, d) {
                return this.on(b, a, c, d)
            },
            undelegate: function(a, b, c) {
                return 1 === arguments.length ? this.off(a, "**") : this.off(b, a || "**", c)
            }
        });
        var Eb = ea.now(),
            Fb = /\?/,
            Gb = /(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;
        ea.parseJSON = function(b) {
            if (a.JSON && a.JSON.parse) return a.JSON.parse(b + "");
            var c, d = null,
                e = ea.trim(b + "");
            return e && !ea.trim(e.replace(Gb, function(a, b, e, f) {
                return c && b && (d = 0), 0 === d ? a : (c = e || b, d += !f - !e, "")
            })) ? Function("return " + e)() : ea.error("Invalid JSON: " + b)
        }, ea.parseXML = function(b) {
            var c, d;
            if (!b || "string" != typeof b) return null;
            try {
                a.DOMParser ? (d = new DOMParser, c = d.parseFromString(b, "text/xml")) : (c = new ActiveXObject("Microsoft.XMLDOM"), c.async = "false", c.loadXML(b))
            } catch (a) {
                c = void 0
            }
            return c && c.documentElement && !c.getElementsByTagName("parsererror").length || ea.error("Invalid XML: " + b), c
        };
        var Hb, Ib, Jb = /#.*$/,
            Kb = /([?&])_=[^&]*/,
            Lb = /^(.*?):[ \t]*([^\r\n]*)\r?$/gm,
            Mb = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
            Nb = /^(?:GET|HEAD)$/,
            Ob = /^\/\//,
            Pb = /^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,
            Qb = {},
            Rb = {},
            Sb = "*/".concat("*");
        try {
            Ib = location.href
        } catch (a) {
            Ib = oa.createElement("a"), Ib.href = "", Ib = Ib.href
        }
        Hb = Pb.exec(Ib.toLowerCase()) || [], ea.extend({
            active: 0,
            lastModified: {},
            etag: {},
            ajaxSettings: {
                url: Ib,
                type: "GET",
                isLocal: Mb.test(Hb[1]),
                global: !0,
                processData: !0,
                async: !0,
                contentType: "application/x-www-form-urlencoded; charset=UTF-8",
                accepts: {
                    "*": Sb,
                    text: "text/plain",
                    html: "text/html",
                    xml: "application/xml, text/xml",
                    json: "application/json, text/javascript"
                },
                contents: {
                    xml: /xml/,
                    html: /html/,
                    json: /json/
                },
                responseFields: {
                    xml: "responseXML",
                    text: "responseText",
                    json: "responseJSON"
                },
                converters: {
                    "* text": String,
                    "text html": !0,
                    "text json": ea.parseJSON,
                    "text xml": ea.parseXML
                },
                flatOptions: {
                    url: !0,
                    context: !0
                }
            },
            ajaxSetup: function(a, b) {
                return b ? P(P(a, ea.ajaxSettings), b) : P(ea.ajaxSettings, a)
            },
            ajaxPrefilter: N(Qb),
            ajaxTransport: N(Rb),
            ajax: function(a, b) {
                function c(a, b, c, d) {
                    var e, k, r, s, u, w = b;
                    2 !== t && (t = 2, h && clearTimeout(h), j = void 0, g = d || "", v.readyState = a > 0 ? 4 : 0, e = a >= 200 && 300 > a || 304 === a, c && (s = Q(l, v, c)), s = R(l, s, v, e), e ? (l.ifModified && (u = v.getResponseHeader("Last-Modified"), u && (ea.lastModified[f] = u), u = v.getResponseHeader("etag"), u && (ea.etag[f] = u)), 204 === a || "HEAD" === l.type ? w = "nocontent" : 304 === a ? w = "notmodified" : (w = s.state, k = s.data, r = s.error, e = !r)) : (r = w, (a || !w) && (w = "error", 0 > a && (a = 0))), v.status = a, v.statusText = (b || w) + "", e ? o.resolveWith(m, [k, w, v]) : o.rejectWith(m, [v, w, r]), v.statusCode(q), q = void 0, i && n.trigger(e ? "ajaxSuccess" : "ajaxError", [v, l, e ? k : r]), p.fireWith(m, [v, w]), i && (n.trigger("ajaxComplete", [v, l]), --ea.active || ea.event.trigger("ajaxStop")))
                }
                "object" == typeof a && (b = a, a = void 0), b = b || {};
                var d, e, f, g, h, i, j, k, l = ea.ajaxSetup({}, b),
                    m = l.context || l,
                    n = l.context && (m.nodeType || m.jquery) ? ea(m) : ea.event,
                    o = ea.Deferred(),
                    p = ea.Callbacks("once memory"),
                    q = l.statusCode || {},
                    r = {},
                    s = {},
                    t = 0,
                    u = "canceled",
                    v = {
                        readyState: 0,
                        getResponseHeader: function(a) {
                            var b;
                            if (2 === t) {
                                if (!k)
                                    for (k = {}; b = Lb.exec(g);) k[b[1].toLowerCase()] = b[2];
                                b = k[a.toLowerCase()]
                            }
                            return null == b ? null : b
                        },
                        getAllResponseHeaders: function() {
                            return 2 === t ? g : null
                        },
                        setRequestHeader: function(a, b) {
                            var c = a.toLowerCase();
                            return t || (a = s[c] = s[c] || a, r[a] = b), this
                        },
                        overrideMimeType: function(a) {
                            return t || (l.mimeType = a), this
                        },
                        statusCode: function(a) {
                            var b;
                            if (a)
                                if (2 > t)
                                    for (b in a) q[b] = [q[b], a[b]];
                                else v.always(a[v.status]);
                            return this
                        },
                        abort: function(a) {
                            var b = a || u;
                            return j && j.abort(b), c(0, b), this
                        }
                    };
                if (o.promise(v).complete = p.add, v.success = v.done, v.error = v.fail, l.url = ((a || l.url || Ib) + "").replace(Jb, "").replace(Ob, Hb[1] + "//"), l.type = b.method || b.type || l.method || l.type, l.dataTypes = ea.trim(l.dataType || "*").toLowerCase().match(ta) || [""], null == l.crossDomain && (d = Pb.exec(l.url.toLowerCase()), l.crossDomain = !(!d || d[1] === Hb[1] && d[2] === Hb[2] && (d[3] || ("http:" === d[1] ? "80" : "443")) === (Hb[3] || ("http:" === Hb[1] ? "80" : "443")))), l.data && l.processData && "string" != typeof l.data && (l.data = ea.param(l.data, l.traditional)), O(Qb, l, b, v), 2 === t) return v;
                i = ea.event && l.global, i && 0 === ea.active++ && ea.event.trigger("ajaxStart"), l.type = l.type.toUpperCase(), l.hasContent = !Nb.test(l.type), f = l.url, l.hasContent || (l.data && (f = l.url += (Fb.test(f) ? "&" : "?") + l.data, delete l.data), l.cache === !1 && (l.url = Kb.test(f) ? f.replace(Kb, "$1_=" + Eb++) : f + (Fb.test(f) ? "&" : "?") + "_=" + Eb++)), l.ifModified && (ea.lastModified[f] && v.setRequestHeader("If-Modified-Since", ea.lastModified[f]), ea.etag[f] && v.setRequestHeader("If-None-Match", ea.etag[f])), (l.data && l.hasContent && l.contentType !== !1 || b.contentType) && v.setRequestHeader("Content-Type", l.contentType), v.setRequestHeader("Accept", l.dataTypes[0] && l.accepts[l.dataTypes[0]] ? l.accepts[l.dataTypes[0]] + ("*" !== l.dataTypes[0] ? ", " + Sb + "; q=0.01" : "") : l.accepts["*"]);
                for (e in l.headers) v.setRequestHeader(e, l.headers[e]);
                if (!l.beforeSend || l.beforeSend.call(m, v, l) !== !1 && 2 !== t) {
                    u = "abort";
                    for (e in {
                            success: 1,
                            error: 1,
                            complete: 1
                        }) v[e](l[e]);
                    if (j = O(Rb, l, b, v)) {
                        v.readyState = 1, i && n.trigger("ajaxSend", [v, l]), l.async && l.timeout > 0 && (h = setTimeout(function() {
                            v.abort("timeout")
                        }, l.timeout));
                        try {
                            t = 1, j.send(r, c)
                        } catch (a) {
                            if (!(2 > t)) throw a;
                            c(-1, a)
                        }
                    } else c(-1, "No Transport");
                    return v
                }
                return v.abort()
            },
            getJSON: function(a, b, c) {
                return ea.get(a, b, c, "json")
            },
            getScript: function(a, b) {
                return ea.get(a, void 0, b, "script")
            }
        }), ea.each(["get", "post"], function(a, b) {
            ea[b] = function(a, c, d, e) {
                return ea.isFunction(c) && (e = e || d, d = c, c = void 0), ea.ajax({
                    url: a,
                    type: b,
                    dataType: e,
                    data: c,
                    success: d
                })
            }
        }), ea._evalUrl = function(a) {
            return ea.ajax({
                url: a,
                type: "GET",
                dataType: "script",
                async: !1,
                global: !1,
                throws: !0
            })
        }, ea.fn.extend({
            wrapAll: function(a) {
                if (ea.isFunction(a)) return this.each(function(b) {
                    ea(this).wrapAll(a.call(this, b))
                });
                if (this[0]) {
                    var b = ea(a, this[0].ownerDocument).eq(0).clone(!0);
                    this[0].parentNode && b.insertBefore(this[0]), b.map(function() {
                        for (var a = this; a.firstChild && 1 === a.firstChild.nodeType;) a = a.firstChild;
                        return a
                    }).append(this)
                }
                return this
            },
            wrapInner: function(a) {
                return this.each(ea.isFunction(a) ? function(b) {
                    ea(this).wrapInner(a.call(this, b))
                } : function() {
                    var b = ea(this),
                        c = b.contents();
                    c.length ? c.wrapAll(a) : b.append(a)
                })
            },
            wrap: function(a) {
                var b = ea.isFunction(a);
                return this.each(function(c) {
                    ea(this).wrapAll(b ? a.call(this, c) : a)
                })
            },
            unwrap: function() {
                return this.parent().each(function() {
                    ea.nodeName(this, "body") || ea(this).replaceWith(this.childNodes)
                }).end()
            }
        }), ea.expr.filters.hidden = function(a) {
            return a.offsetWidth <= 0 && a.offsetHeight <= 0 || !ca.reliableHiddenOffsets() && "none" === (a.style && a.style.display || ea.css(a, "display"))
        }, ea.expr.filters.visible = function(a) {
            return !ea.expr.filters.hidden(a)
        };
        var Tb = /%20/g,
            Ub = /\[\]$/,
            Vb = /\r?\n/g,
            Wb = /^(?:submit|button|image|reset|file)$/i,
            Xb = /^(?:input|select|textarea|keygen)/i;
        ea.param = function(a, b) {
            var c, d = [],
                e = function(a, b) {
                    b = ea.isFunction(b) ? b() : null == b ? "" : b, d[d.length] = encodeURIComponent(a) + "=" + encodeURIComponent(b)
                };
            if (void 0 === b && (b = ea.ajaxSettings && ea.ajaxSettings.traditional), ea.isArray(a) || a.jquery && !ea.isPlainObject(a)) ea.each(a, function() {
                e(this.name, this.value)
            });
            else
                for (c in a) S(c, a[c], b, e);
            return d.join("&").replace(Tb, "+")
        }, ea.fn.extend({
            serialize: function() {
                return ea.param(this.serializeArray())
            },
            serializeArray: function() {
                return this.map(function() {
                    var a = ea.prop(this, "elements");
                    return a ? ea.makeArray(a) : this
                }).filter(function() {
                    var a = this.type;
                    return this.name && !ea(this).is(":disabled") && Xb.test(this.nodeName) && !Wb.test(a) && (this.checked || !Ea.test(a))
                }).map(function(a, b) {
                    var c = ea(this).val();
                    return null == c ? null : ea.isArray(c) ? ea.map(c, function(a) {
                        return {
                            name: b.name,
                            value: a.replace(Vb, "\r\n")
                        }
                    }) : {
                        name: b.name,
                        value: c.replace(Vb, "\r\n")
                    }
                }).get()
            }
        }), ea.ajaxSettings.xhr = void 0 !== a.ActiveXObject ? function() {
            return !this.isLocal && /^(get|post|head|put|delete|options)$/i.test(this.type) && T() || U()
        } : T;
        var Yb = 0,
            Zb = {},
            $b = ea.ajaxSettings.xhr();
        a.attachEvent && a.attachEvent("onunload", function() {
            for (var a in Zb) Zb[a](void 0, !0)
        }), ca.cors = !!$b && "withCredentials" in $b, $b = ca.ajax = !!$b, $b && ea.ajaxTransport(function(a) {
            if (!a.crossDomain || ca.cors) {
                var b;
                return {
                    send: function(c, d) {
                        var e, f = a.xhr(),
                            g = ++Yb;
                        if (f.open(a.type, a.url, a.async, a.username, a.password), a.xhrFields)
                            for (e in a.xhrFields) f[e] = a.xhrFields[e];
                        a.mimeType && f.overrideMimeType && f.overrideMimeType(a.mimeType), a.crossDomain || c["X-Requested-With"] || (c["X-Requested-With"] = "XMLHttpRequest");
                        for (e in c) void 0 !== c[e] && f.setRequestHeader(e, c[e] + "");
                        f.send(a.hasContent && a.data || null), b = function(c, e) {
                            var h, i, j;
                            if (b && (e || 4 === f.readyState))
                                if (delete Zb[g], b = void 0, f.onreadystatechange = ea.noop, e) 4 !== f.readyState && f.abort();
                                else {
                                    j = {}, h = f.status, "string" == typeof f.responseText && (j.text = f.responseText);
                                    try {
                                        i = f.statusText
                                    } catch (a) {
                                        i = ""
                                    }
                                    h || !a.isLocal || a.crossDomain ? 1223 === h && (h = 204) : h = j.text ? 200 : 404
                                }
                            j && d(h, i, j, f.getAllResponseHeaders())
                        }, a.async ? 4 === f.readyState ? setTimeout(b) : f.onreadystatechange = Zb[g] = b : b()
                    },
                    abort: function() {
                        b && b(void 0, !0)
                    }
                }
            }
        }), ea.ajaxSetup({
            accepts: {
                script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
            },
            contents: {
                script: /(?:java|ecma)script/
            },
            converters: {
                "text script": function(a) {
                    return ea.globalEval(a), a
                }
            }
        }), ea.ajaxPrefilter("script", function(a) {
            void 0 === a.cache && (a.cache = !1), a.crossDomain && (a.type = "GET", a.global = !1)
        }), ea.ajaxTransport("script", function(a) {
            if (a.crossDomain) {
                var b, c = oa.head || ea("head")[0] || oa.documentElement;
                return {
                    send: function(d, e) {
                        b = oa.createElement("script"), b.async = !0, a.scriptCharset && (b.charset = a.scriptCharset), b.src = a.url, b.onload = b.onreadystatechange = function(a, c) {
                            (c || !b.readyState || /loaded|complete/.test(b.readyState)) && (b.onload = b.onreadystatechange = null, b.parentNode && b.parentNode.removeChild(b), b = null, c || e(200, "success"))
                        }, c.insertBefore(b, c.firstChild)
                    },
                    abort: function() {
                        b && b.onload(void 0, !0)
                    }
                }
            }
        });
        var _b = [],
            ac = /(=)\?(?=&|$)|\?\?/;
        ea.ajaxSetup({
            jsonp: "callback",
            jsonpCallback: function() {
                var a = _b.pop() || ea.expando + "_" + Eb++;
                return this[a] = !0, a
            }
        }), ea.ajaxPrefilter("json jsonp", function(b, c, d) {
            var e, f, g, h = b.jsonp !== !1 && (ac.test(b.url) ? "url" : "string" == typeof b.data && !(b.contentType || "").indexOf("application/x-www-form-urlencoded") && ac.test(b.data) && "data");
            return h || "jsonp" === b.dataTypes[0] ? (e = b.jsonpCallback = ea.isFunction(b.jsonpCallback) ? b.jsonpCallback() : b.jsonpCallback, h ? b[h] = b[h].replace(ac, "$1" + e) : b.jsonp !== !1 && (b.url += (Fb.test(b.url) ? "&" : "?") + b.jsonp + "=" + e), b.converters["script json"] = function() {
                return g || ea.error(e + " was not called"), g[0]
            }, b.dataTypes[0] = "json", f = a[e], a[e] = function() {
                g = arguments
            }, d.always(function() {
                a[e] = f, b[e] && (b.jsonpCallback = c.jsonpCallback, _b.push(e)), g && ea.isFunction(f) && f(g[0]), g = f = void 0
            }), "script") : void 0
        }), ea.parseHTML = function(a, b, c) {
            if (!a || "string" != typeof a) return null;
            "boolean" == typeof b && (c = b, b = !1), b = b || oa;
            var d = la.exec(a),
                e = !c && [];
            return d ? [b.createElement(d[1])] : (d = ea.buildFragment([a], b, e), e && e.length && ea(e).remove(), ea.merge([], d.childNodes))
        };
        var bc = ea.fn.load;
        ea.fn.load = function(a, b, c) {
            if ("string" != typeof a && bc) return bc.apply(this, arguments);
            var d, e, f, g = this,
                h = a.indexOf(" ");
            return h >= 0 && (d = ea.trim(a.slice(h, a.length)), a = a.slice(0, h)), ea.isFunction(b) ? (c = b, b = void 0) : b && "object" == typeof b && (f = "POST"), g.length > 0 && ea.ajax({
                url: a,
                type: f,
                dataType: "html",
                data: b
            }).done(function(a) {
                e = arguments, g.html(d ? ea("<div>").append(ea.parseHTML(a)).find(d) : a)
            }).complete(c && function(a, b) {
                g.each(c, e || [a.responseText, b, a])
            }), this
        }, ea.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function(a, b) {
            ea.fn[b] = function(a) {
                return this.on(b, a)
            }
        }), ea.expr.filters.animated = function(a) {
            return ea.grep(ea.timers, function(b) {
                return a === b.elem
            }).length
        };
        var cc = a.document.documentElement;
        ea.offset = {
            setOffset: function(a, b, c) {
                var d, e, f, g, h, i, j, k = ea.css(a, "position"),
                    l = ea(a),
                    m = {};
                "static" === k && (a.style.position = "relative"), h = l.offset(), f = ea.css(a, "top"), i = ea.css(a, "left"), j = ("absolute" === k || "fixed" === k) && ea.inArray("auto", [f, i]) > -1, j ? (d = l.position(), g = d.top, e = d.left) : (g = parseFloat(f) || 0, e = parseFloat(i) || 0), ea.isFunction(b) && (b = b.call(a, c, h)), null != b.top && (m.top = b.top - h.top + g), null != b.left && (m.left = b.left - h.left + e), "using" in b ? b.using.call(a, m) : l.css(m)
            }
        }, ea.fn.extend({
            offset: function(a) {
                if (arguments.length) return void 0 === a ? this : this.each(function(b) {
                    ea.offset.setOffset(this, a, b)
                });
                var b, c, d = {
                        top: 0,
                        left: 0
                    },
                    e = this[0],
                    f = e && e.ownerDocument;
                return f ? (b = f.documentElement, ea.contains(b, e) ? (typeof e.getBoundingClientRect !== wa && (d = e.getBoundingClientRect()), c = V(f), {
                    top: d.top + (c.pageYOffset || b.scrollTop) - (b.clientTop || 0),
                    left: d.left + (c.pageXOffset || b.scrollLeft) - (b.clientLeft || 0)
                }) : d) : void 0
            },
            position: function() {
                if (this[0]) {
                    var a, b, c = {
                            top: 0,
                            left: 0
                        },
                        d = this[0];
                    return "fixed" === ea.css(d, "position") ? b = d.getBoundingClientRect() : (a = this.offsetParent(), b = this.offset(), ea.nodeName(a[0], "html") || (c = a.offset()), c.top += ea.css(a[0], "borderTopWidth", !0), c.left += ea.css(a[0], "borderLeftWidth", !0)), {
                        top: b.top - c.top - ea.css(d, "marginTop", !0),
                        left: b.left - c.left - ea.css(d, "marginLeft", !0)
                    }
                }
            },
            offsetParent: function() {
                return this.map(function() {
                    for (var a = this.offsetParent || cc; a && !ea.nodeName(a, "html") && "static" === ea.css(a, "position");) a = a.offsetParent;
                    return a || cc
                })
            }
        }), ea.each({
            scrollLeft: "pageXOffset",
            scrollTop: "pageYOffset"
        }, function(a, b) {
            var c = /Y/.test(b);
            ea.fn[a] = function(d) {
                return Da(this, function(a, d, e) {
                    var f = V(a);
                    return void 0 === e ? f ? b in f ? f[b] : f.document.documentElement[d] : a[d] : void(f ? f.scrollTo(c ? ea(f).scrollLeft() : e, c ? e : ea(f).scrollTop()) : a[d] = e);
                }, a, d, arguments.length, null)
            }
        }), ea.each(["top", "left"], function(a, b) {
            ea.cssHooks[b] = A(ca.pixelPosition, function(a, c) {
                return c ? (c = db(a, b), bb.test(c) ? ea(a).position()[b] + "px" : c) : void 0
            })
        }), ea.each({
            Height: "height",
            Width: "width"
        }, function(a, b) {
            ea.each({
                padding: "inner" + a,
                content: b,
                "": "outer" + a
            }, function(c, d) {
                ea.fn[d] = function(d, e) {
                    var f = arguments.length && (c || "boolean" != typeof d),
                        g = c || (d === !0 || e === !0 ? "margin" : "border");
                    return Da(this, function(b, c, d) {
                        var e;
                        return ea.isWindow(b) ? b.document.documentElement["client" + a] : 9 === b.nodeType ? (e = b.documentElement, Math.max(b.body["scroll" + a], e["scroll" + a], b.body["offset" + a], e["offset" + a], e["client" + a])) : void 0 === d ? ea.css(b, c, g) : ea.style(b, c, d, g)
                    }, b, f ? d : void 0, f, null)
                }
            })
        }), ea.fn.size = function() {
            return this.length
        }, ea.fn.andSelf = ea.fn.addBack, "function" == typeof define && define.amd && define("jquery", [], function() {
            return ea
        });
        var dc = a.jQuery,
            ec = a.$;
        return ea.noConflict = function(b) {
            return a.$ === ea && (a.$ = ec), b && a.jQuery === ea && (a.jQuery = dc), ea
        }, typeof b === wa && (a.jQuery = a.$ = ea), ea
    }), function() {
        function a(a) {
            function b(b, c, d, e, f, g) {
                for (; f >= 0 && g > f; f += a) {
                    var h = e ? e[f] : f;
                    d = c(d, b[h], h, b)
                }
                return d
            }
            return function(c, d, e, f) {
                d = t(d, f, 4);
                var g = !A(c) && s.keys(c),
                    h = (g || c).length,
                    i = a > 0 ? 0 : h - 1;
                return arguments.length < 3 && (e = c[g ? g[i] : i], i += a), b(c, d, e, g, i, h)
            }
        }

        function b(a) {
            return function(b, c, d) {
                c = u(c, d);
                for (var e = z(b), f = a > 0 ? 0 : e - 1; f >= 0 && e > f; f += a)
                    if (c(b[f], f, b)) return f;
                return -1
            }
        }

        function c(a, b, c) {
            return function(d, e, f) {
                var g = 0,
                    h = z(d);
                if ("number" == typeof f) a > 0 ? g = f >= 0 ? f : Math.max(f + h, g) : h = f >= 0 ? Math.min(f + 1, h) : f + h + 1;
                else if (c && f && h) return f = c(d, e), d[f] === e ? f : -1;
                if (e !== e) return f = b(k.call(d, g, h), s.isNaN), f >= 0 ? f + g : -1;
                for (f = a > 0 ? g : h - 1; f >= 0 && h > f; f += a)
                    if (d[f] === e) return f;
                return -1
            }
        }

        function d(a, b) {
            var c = F.length,
                d = a.constructor,
                e = s.isFunction(d) && d.prototype || h,
                f = "constructor";
            for (s.has(a, f) && !s.contains(b, f) && b.push(f); c--;) f = F[c], f in a && a[f] !== e[f] && !s.contains(b, f) && b.push(f)
        }
        var e = this,
            f = e._,
            g = Array.prototype,
            h = Object.prototype,
            i = Function.prototype,
            j = g.push,
            k = g.slice,
            l = h.toString,
            m = h.hasOwnProperty,
            n = Array.isArray,
            o = Object.keys,
            p = i.bind,
            q = Object.create,
            r = function() {},
            s = function(a) {
                return a instanceof s ? a : this instanceof s ? void(this._wrapped = a) : new s(a)
            };
        "undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = s), exports._ = s) : e._ = s, s.VERSION = "1.8.3";
        var t = function(a, b, c) {
                if (void 0 === b) return a;
                switch (null == c ? 3 : c) {
                    case 1:
                        return function(c) {
                            return a.call(b, c)
                        };
                    case 2:
                        return function(c, d) {
                            return a.call(b, c, d)
                        };
                    case 3:
                        return function(c, d, e) {
                            return a.call(b, c, d, e)
                        };
                    case 4:
                        return function(c, d, e, f) {
                            return a.call(b, c, d, e, f)
                        }
                }
                return function() {
                    return a.apply(b, arguments)
                }
            },
            u = function(a, b, c) {
                return null == a ? s.identity : s.isFunction(a) ? t(a, b, c) : s.isObject(a) ? s.matcher(a) : s.property(a)
            };
        s.iteratee = function(a, b) {
            return u(a, b, 1 / 0)
        };
        var v = function(a, b) {
                return function(c) {
                    var d = arguments.length;
                    if (2 > d || null == c) return c;
                    for (var e = 1; d > e; e++)
                        for (var f = arguments[e], g = a(f), h = g.length, i = 0; h > i; i++) {
                            var j = g[i];
                            b && void 0 !== c[j] || (c[j] = f[j])
                        }
                    return c
                }
            },
            w = function(a) {
                if (!s.isObject(a)) return {};
                if (q) return q(a);
                r.prototype = a;
                var b = new r;
                return r.prototype = null, b
            },
            x = function(a) {
                return function(b) {
                    return null == b ? void 0 : b[a]
                }
            },
            y = Math.pow(2, 53) - 1,
            z = x("length"),
            A = function(a) {
                var b = z(a);
                return "number" == typeof b && b >= 0 && y >= b
            };
        s.each = s.forEach = function(a, b, c) {
            b = t(b, c);
            var d, e;
            if (A(a))
                for (d = 0, e = a.length; e > d; d++) b(a[d], d, a);
            else {
                var f = s.keys(a);
                for (d = 0, e = f.length; e > d; d++) b(a[f[d]], f[d], a)
            }
            return a
        }, s.map = s.collect = function(a, b, c) {
            b = u(b, c);
            for (var d = !A(a) && s.keys(a), e = (d || a).length, f = Array(e), g = 0; e > g; g++) {
                var h = d ? d[g] : g;
                f[g] = b(a[h], h, a)
            }
            return f
        }, s.reduce = s.foldl = s.inject = a(1), s.reduceRight = s.foldr = a(-1), s.find = s.detect = function(a, b, c) {
            var d;
            return d = A(a) ? s.findIndex(a, b, c) : s.findKey(a, b, c), void 0 !== d && d !== -1 ? a[d] : void 0
        }, s.filter = s.select = function(a, b, c) {
            var d = [];
            return b = u(b, c), s.each(a, function(a, c, e) {
                b(a, c, e) && d.push(a)
            }), d
        }, s.reject = function(a, b, c) {
            return s.filter(a, s.negate(u(b)), c)
        }, s.every = s.all = function(a, b, c) {
            b = u(b, c);
            for (var d = !A(a) && s.keys(a), e = (d || a).length, f = 0; e > f; f++) {
                var g = d ? d[f] : f;
                if (!b(a[g], g, a)) return !1
            }
            return !0
        }, s.some = s.any = function(a, b, c) {
            b = u(b, c);
            for (var d = !A(a) && s.keys(a), e = (d || a).length, f = 0; e > f; f++) {
                var g = d ? d[f] : f;
                if (b(a[g], g, a)) return !0
            }
            return !1
        }, s.contains = s.includes = s.include = function(a, b, c, d) {
            return A(a) || (a = s.values(a)), ("number" != typeof c || d) && (c = 0), s.indexOf(a, b, c) >= 0
        }, s.invoke = function(a, b) {
            var c = k.call(arguments, 2),
                d = s.isFunction(b);
            return s.map(a, function(a) {
                var e = d ? b : a[b];
                return null == e ? e : e.apply(a, c)
            })
        }, s.pluck = function(a, b) {
            return s.map(a, s.property(b))
        }, s.where = function(a, b) {
            return s.filter(a, s.matcher(b))
        }, s.findWhere = function(a, b) {
            return s.find(a, s.matcher(b))
        }, s.max = function(a, b, c) {
            var d, e, f = -1 / 0,
                g = -1 / 0;
            if (null == b && null != a) {
                a = A(a) ? a : s.values(a);
                for (var h = 0, i = a.length; i > h; h++) d = a[h], d > f && (f = d)
            } else b = u(b, c), s.each(a, function(a, c, d) {
                e = b(a, c, d), (e > g || e === -1 / 0 && f === -1 / 0) && (f = a, g = e)
            });
            return f
        }, s.min = function(a, b, c) {
            var d, e, f = 1 / 0,
                g = 1 / 0;
            if (null == b && null != a) {
                a = A(a) ? a : s.values(a);
                for (var h = 0, i = a.length; i > h; h++) d = a[h], f > d && (f = d)
            } else b = u(b, c), s.each(a, function(a, c, d) {
                e = b(a, c, d), (g > e || 1 / 0 === e && 1 / 0 === f) && (f = a, g = e)
            });
            return f
        }, s.shuffle = function(a) {
            for (var b, c = A(a) ? a : s.values(a), d = c.length, e = Array(d), f = 0; d > f; f++) b = s.random(0, f), b !== f && (e[f] = e[b]), e[b] = c[f];
            return e
        }, s.sample = function(a, b, c) {
            return null == b || c ? (A(a) || (a = s.values(a)), a[s.random(a.length - 1)]) : s.shuffle(a).slice(0, Math.max(0, b))
        }, s.sortBy = function(a, b, c) {
            return b = u(b, c), s.pluck(s.map(a, function(a, c, d) {
                return {
                    value: a,
                    index: c,
                    criteria: b(a, c, d)
                }
            }).sort(function(a, b) {
                var c = a.criteria,
                    d = b.criteria;
                if (c !== d) {
                    if (c > d || void 0 === c) return 1;
                    if (d > c || void 0 === d) return -1
                }
                return a.index - b.index
            }), "value")
        };
        var B = function(a) {
            return function(b, c, d) {
                var e = {};
                return c = u(c, d), s.each(b, function(d, f) {
                    var g = c(d, f, b);
                    a(e, d, g)
                }), e
            }
        };
        s.groupBy = B(function(a, b, c) {
            s.has(a, c) ? a[c].push(b) : a[c] = [b]
        }), s.indexBy = B(function(a, b, c) {
            a[c] = b
        }), s.countBy = B(function(a, b, c) {
            s.has(a, c) ? a[c]++ : a[c] = 1
        }), s.toArray = function(a) {
            return a ? s.isArray(a) ? k.call(a) : A(a) ? s.map(a, s.identity) : s.values(a) : []
        }, s.size = function(a) {
            return null == a ? 0 : A(a) ? a.length : s.keys(a).length
        }, s.partition = function(a, b, c) {
            b = u(b, c);
            var d = [],
                e = [];
            return s.each(a, function(a, c, f) {
                (b(a, c, f) ? d : e).push(a)
            }), [d, e]
        }, s.first = s.head = s.take = function(a, b, c) {
            return null == a ? void 0 : null == b || c ? a[0] : s.initial(a, a.length - b)
        }, s.initial = function(a, b, c) {
            return k.call(a, 0, Math.max(0, a.length - (null == b || c ? 1 : b)))
        }, s.last = function(a, b, c) {
            return null == a ? void 0 : null == b || c ? a[a.length - 1] : s.rest(a, Math.max(0, a.length - b))
        }, s.rest = s.tail = s.drop = function(a, b, c) {
            return k.call(a, null == b || c ? 1 : b)
        }, s.compact = function(a) {
            return s.filter(a, s.identity)
        };
        var C = function(a, b, c, d) {
            for (var e = [], f = 0, g = d || 0, h = z(a); h > g; g++) {
                var i = a[g];
                if (A(i) && (s.isArray(i) || s.isArguments(i))) {
                    b || (i = C(i, b, c));
                    var j = 0,
                        k = i.length;
                    for (e.length += k; k > j;) e[f++] = i[j++]
                } else c || (e[f++] = i)
            }
            return e
        };
        s.flatten = function(a, b) {
            return C(a, b, !1)
        }, s.without = function(a) {
            return s.difference(a, k.call(arguments, 1))
        }, s.uniq = s.unique = function(a, b, c, d) {
            s.isBoolean(b) || (d = c, c = b, b = !1), null != c && (c = u(c, d));
            for (var e = [], f = [], g = 0, h = z(a); h > g; g++) {
                var i = a[g],
                    j = c ? c(i, g, a) : i;
                b ? (g && f === j || e.push(i), f = j) : c ? s.contains(f, j) || (f.push(j), e.push(i)) : s.contains(e, i) || e.push(i)
            }
            return e
        }, s.union = function() {
            return s.uniq(C(arguments, !0, !0))
        }, s.intersection = function(a) {
            for (var b = [], c = arguments.length, d = 0, e = z(a); e > d; d++) {
                var f = a[d];
                if (!s.contains(b, f)) {
                    for (var g = 1; c > g && s.contains(arguments[g], f); g++);
                    g === c && b.push(f)
                }
            }
            return b
        }, s.difference = function(a) {
            var b = C(arguments, !0, !0, 1);
            return s.filter(a, function(a) {
                return !s.contains(b, a)
            })
        }, s.zip = function() {
            return s.unzip(arguments)
        }, s.unzip = function(a) {
            for (var b = a && s.max(a, z).length || 0, c = Array(b), d = 0; b > d; d++) c[d] = s.pluck(a, d);
            return c
        }, s.object = function(a, b) {
            for (var c = {}, d = 0, e = z(a); e > d; d++) b ? c[a[d]] = b[d] : c[a[d][0]] = a[d][1];
            return c
        }, s.findIndex = b(1), s.findLastIndex = b(-1), s.sortedIndex = function(a, b, c, d) {
            c = u(c, d, 1);
            for (var e = c(b), f = 0, g = z(a); g > f;) {
                var h = Math.floor((f + g) / 2);
                c(a[h]) < e ? f = h + 1 : g = h
            }
            return f
        }, s.indexOf = c(1, s.findIndex, s.sortedIndex), s.lastIndexOf = c(-1, s.findLastIndex), s.range = function(a, b, c) {
            null == b && (b = a || 0, a = 0), c = c || 1;
            for (var d = Math.max(Math.ceil((b - a) / c), 0), e = Array(d), f = 0; d > f; f++, a += c) e[f] = a;
            return e
        };
        var D = function(a, b, c, d, e) {
            if (d instanceof b) {
                var f = w(a.prototype),
                    g = a.apply(f, e);
                return s.isObject(g) ? g : f
            }
            return a.apply(c, e)
        };
        s.bind = function(a, b) {
            if (p && a.bind === p) return p.apply(a, k.call(arguments, 1));
            if (!s.isFunction(a)) throw new TypeError("Bind must be called on a function");
            var c = k.call(arguments, 2),
                d = function() {
                    return D(a, d, b, this, c.concat(k.call(arguments)))
                };
            return d
        }, s.partial = function(a) {
            var b = k.call(arguments, 1),
                c = function() {
                    for (var d = 0, e = b.length, f = Array(e), g = 0; e > g; g++) f[g] = b[g] === s ? arguments[d++] : b[g];
                    for (; d < arguments.length;) f.push(arguments[d++]);
                    return D(a, c, this, this, f)
                };
            return c
        }, s.bindAll = function(a) {
            var b, c, d = arguments.length;
            if (1 >= d) throw new Error("bindAll must be passed function names");
            for (b = 1; d > b; b++) c = arguments[b], a[c] = s.bind(a[c], a);
            return a
        }, s.memoize = function(a, b) {
            var c = function(d) {
                var e = c.cache,
                    f = "" + (b ? b.apply(this, arguments) : d);
                return s.has(e, f) || (e[f] = a.apply(this, arguments)), e[f]
            };
            return c.cache = {}, c
        }, s.delay = function(a, b) {
            var c = k.call(arguments, 2);
            return setTimeout(function() {
                return a.apply(null, c)
            }, b)
        }, s.defer = s.partial(s.delay, s, 1), s.throttle = function(a, b, c) {
            var d, e, f, g = null,
                h = 0;
            c || (c = {});
            var i = function() {
                h = c.leading === !1 ? 0 : s.now(), g = null, f = a.apply(d, e), g || (d = e = null)
            };
            return function() {
                var j = s.now();
                h || c.leading !== !1 || (h = j);
                var k = b - (j - h);
                return d = this, e = arguments, 0 >= k || k > b ? (g && (clearTimeout(g), g = null), h = j, f = a.apply(d, e), g || (d = e = null)) : g || c.trailing === !1 || (g = setTimeout(i, k)), f
            }
        }, s.debounce = function(a, b, c) {
            var d, e, f, g, h, i = function() {
                var j = s.now() - g;
                b > j && j >= 0 ? d = setTimeout(i, b - j) : (d = null, c || (h = a.apply(f, e), d || (f = e = null)))
            };
            return function() {
                f = this, e = arguments, g = s.now();
                var j = c && !d;
                return d || (d = setTimeout(i, b)), j && (h = a.apply(f, e), f = e = null), h
            }
        }, s.wrap = function(a, b) {
            return s.partial(b, a)
        }, s.negate = function(a) {
            return function() {
                return !a.apply(this, arguments)
            }
        }, s.compose = function() {
            var a = arguments,
                b = a.length - 1;
            return function() {
                for (var c = b, d = a[b].apply(this, arguments); c--;) d = a[c].call(this, d);
                return d
            }
        }, s.after = function(a, b) {
            return function() {
                return --a < 1 ? b.apply(this, arguments) : void 0
            }
        }, s.before = function(a, b) {
            var c;
            return function() {
                return --a > 0 && (c = b.apply(this, arguments)), 1 >= a && (b = null), c
            }
        }, s.once = s.partial(s.before, 2);
        var E = !{
                toString: null
            }.propertyIsEnumerable("toString"),
            F = ["valueOf", "isPrototypeOf", "toString", "propertyIsEnumerable", "hasOwnProperty", "toLocaleString"];
        s.keys = function(a) {
            if (!s.isObject(a)) return [];
            if (o) return o(a);
            var b = [];
            for (var c in a) s.has(a, c) && b.push(c);
            return E && d(a, b), b
        }, s.allKeys = function(a) {
            if (!s.isObject(a)) return [];
            var b = [];
            for (var c in a) b.push(c);
            return E && d(a, b), b
        }, s.values = function(a) {
            for (var b = s.keys(a), c = b.length, d = Array(c), e = 0; c > e; e++) d[e] = a[b[e]];
            return d
        }, s.mapObject = function(a, b, c) {
            b = u(b, c);
            for (var d, e = s.keys(a), f = e.length, g = {}, h = 0; f > h; h++) d = e[h], g[d] = b(a[d], d, a);
            return g
        }, s.pairs = function(a) {
            for (var b = s.keys(a), c = b.length, d = Array(c), e = 0; c > e; e++) d[e] = [b[e], a[b[e]]];
            return d
        }, s.invert = function(a) {
            for (var b = {}, c = s.keys(a), d = 0, e = c.length; e > d; d++) b[a[c[d]]] = c[d];
            return b
        }, s.functions = s.methods = function(a) {
            var b = [];
            for (var c in a) s.isFunction(a[c]) && b.push(c);
            return b.sort()
        }, s.extend = v(s.allKeys), s.extendOwn = s.assign = v(s.keys), s.findKey = function(a, b, c) {
            b = u(b, c);
            for (var d, e = s.keys(a), f = 0, g = e.length; g > f; f++)
                if (d = e[f], b(a[d], d, a)) return d
        }, s.pick = function(a, b, c) {
            var d, e, f = {},
                g = a;
            if (null == g) return f;
            s.isFunction(b) ? (e = s.allKeys(g), d = t(b, c)) : (e = C(arguments, !1, !1, 1), d = function(a, b, c) {
                return b in c
            }, g = Object(g));
            for (var h = 0, i = e.length; i > h; h++) {
                var j = e[h],
                    k = g[j];
                d(k, j, g) && (f[j] = k)
            }
            return f
        }, s.omit = function(a, b, c) {
            if (s.isFunction(b)) b = s.negate(b);
            else {
                var d = s.map(C(arguments, !1, !1, 1), String);
                b = function(a, b) {
                    return !s.contains(d, b)
                }
            }
            return s.pick(a, b, c)
        }, s.defaults = v(s.allKeys, !0), s.create = function(a, b) {
            var c = w(a);
            return b && s.extendOwn(c, b), c
        }, s.clone = function(a) {
            return s.isObject(a) ? s.isArray(a) ? a.slice() : s.extend({}, a) : a
        }, s.tap = function(a, b) {
            return b(a), a
        }, s.isMatch = function(a, b) {
            var c = s.keys(b),
                d = c.length;
            if (null == a) return !d;
            for (var e = Object(a), f = 0; d > f; f++) {
                var g = c[f];
                if (b[g] !== e[g] || !(g in e)) return !1
            }
            return !0
        };
        var G = function(a, b, c, d) {
            if (a === b) return 0 !== a || 1 / a === 1 / b;
            if (null == a || null == b) return a === b;
            a instanceof s && (a = a._wrapped), b instanceof s && (b = b._wrapped);
            var e = l.call(a);
            if (e !== l.call(b)) return !1;
            switch (e) {
                case "[object RegExp]":
                case "[object String]":
                    return "" + a == "" + b;
                case "[object Number]":
                    return +a !== +a ? +b !== +b : 0 === +a ? 1 / +a === 1 / b : +a === +b;
                case "[object Date]":
                case "[object Boolean]":
                    return +a === +b
            }
            var f = "[object Array]" === e;
            if (!f) {
                if ("object" != typeof a || "object" != typeof b) return !1;
                var g = a.constructor,
                    h = b.constructor;
                if (g !== h && !(s.isFunction(g) && g instanceof g && s.isFunction(h) && h instanceof h) && "constructor" in a && "constructor" in b) return !1
            }
            c = c || [], d = d || [];
            for (var i = c.length; i--;)
                if (c[i] === a) return d[i] === b;
            if (c.push(a), d.push(b), f) {
                if (i = a.length, i !== b.length) return !1;
                for (; i--;)
                    if (!G(a[i], b[i], c, d)) return !1
            } else {
                var j, k = s.keys(a);
                if (i = k.length, s.keys(b).length !== i) return !1;
                for (; i--;)
                    if (j = k[i], !s.has(b, j) || !G(a[j], b[j], c, d)) return !1
            }
            return c.pop(), d.pop(), !0
        };
        s.isEqual = function(a, b) {
            return G(a, b)
        }, s.isEmpty = function(a) {
            return null == a || (A(a) && (s.isArray(a) || s.isString(a) || s.isArguments(a)) ? 0 === a.length : 0 === s.keys(a).length)
        }, s.isElement = function(a) {
            return !!a && 1 === a.nodeType
        }, s.isArray = n || function(a) {
            return "[object Array]" === l.call(a)
        }, s.isObject = function(a) {
            var b = typeof a;
            return "function" === b || "object" === b && !!a
        }, s.each(["Arguments", "Function", "String", "Number", "Date", "RegExp", "Error"], function(a) {
            s["is" + a] = function(b) {
                return l.call(b) === "[object " + a + "]"
            }
        }), s.isArguments(arguments) || (s.isArguments = function(a) {
            return s.has(a, "callee")
        }), "function" != typeof /./ && "object" != typeof Int8Array && (s.isFunction = function(a) {
            return "function" == typeof a || !1
        }), s.isFinite = function(a) {
            return isFinite(a) && !isNaN(parseFloat(a))
        }, s.isNaN = function(a) {
            return s.isNumber(a) && a !== +a
        }, s.isBoolean = function(a) {
            return a === !0 || a === !1 || "[object Boolean]" === l.call(a)
        }, s.isNull = function(a) {
            return null === a
        }, s.isUndefined = function(a) {
            return void 0 === a
        }, s.has = function(a, b) {
            return null != a && m.call(a, b)
        }, s.noConflict = function() {
            return e._ = f, this
        }, s.identity = function(a) {
            return a
        }, s.constant = function(a) {
            return function() {
                return a
            }
        }, s.noop = function() {}, s.property = x, s.propertyOf = function(a) {
            return null == a ? function() {} : function(b) {
                return a[b]
            }
        }, s.matcher = s.matches = function(a) {
            return a = s.extendOwn({}, a),
                function(b) {
                    return s.isMatch(b, a)
                }
        }, s.times = function(a, b, c) {
            var d = Array(Math.max(0, a));
            b = t(b, c, 1);
            for (var e = 0; a > e; e++) d[e] = b(e);
            return d
        }, s.random = function(a, b) {
            return null == b && (b = a, a = 0), a + Math.floor(Math.random() * (b - a + 1))
        }, s.now = Date.now || function() {
            return (new Date).getTime()
        };
        var H = {
                "&": "&amp;",
                "<": "&lt;",
                ">": "&gt;",
                '"': "&quot;",
                "'": "&#x27;",
                "`": "&#x60;"
            },
            I = s.invert(H),
            J = function(a) {
                var b = function(b) {
                        return a[b]
                    },
                    c = "(?:" + s.keys(a).join("|") + ")",
                    d = RegExp(c),
                    e = RegExp(c, "g");
                return function(a) {
                    return a = null == a ? "" : "" + a, d.test(a) ? a.replace(e, b) : a
                }
            };
        s.escape = J(H), s.unescape = J(I), s.result = function(a, b, c) {
            var d = null == a ? void 0 : a[b];
            return void 0 === d && (d = c), s.isFunction(d) ? d.call(a) : d
        };
        var K = 0;
        s.uniqueId = function(a) {
            var b = ++K + "";
            return a ? a + b : b
        }, s.templateSettings = {
            evaluate: /<%([\s\S]+?)%>/g,
            interpolate: /<%=([\s\S]+?)%>/g,
            escape: /<%-([\s\S]+?)%>/g
        };
        var L = /(.)^/,
            M = {
                "'": "'",
                "\\": "\\",
                "\r": "r",
                "\n": "n",
                "\u2028": "u2028",
                "\u2029": "u2029"
            },
            N = /\\|'|\r|\n|\u2028|\u2029/g,
            O = function(a) {
                return "\\" + M[a]
            };
        s.template = function(a, b, c) {
            !b && c && (b = c), b = s.defaults({}, b, s.templateSettings);
            var d = RegExp([(b.escape || L).source, (b.interpolate || L).source, (b.evaluate || L).source].join("|") + "|$", "g"),
                e = 0,
                f = "__p+='";
            a.replace(d, function(b, c, d, g, h) {
                return f += a.slice(e, h).replace(N, O), e = h + b.length, c ? f += "'+\n((__t=(" + c + "))==null?'':_.escape(__t))+\n'" : d ? f += "'+\n((__t=(" + d + "))==null?'':__t)+\n'" : g && (f += "';\n" + g + "\n__p+='"), b
            }), f += "';\n", b.variable || (f = "with(obj||{}){\n" + f + "}\n"), f = "var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n" + f + "return __p;\n";
            try {
                var g = new Function(b.variable || "obj", "_", f)
            } catch (a) {
                throw a.source = f, a
            }
            var h = function(a) {
                    return g.call(this, a, s)
                },
                i = b.variable || "obj";
            return h.source = "function(" + i + "){\n" + f + "}", h
        }, s.chain = function(a) {
            var b = s(a);
            return b._chain = !0, b
        };
        var P = function(a, b) {
            return a._chain ? s(b).chain() : b
        };
        s.mixin = function(a) {
            s.each(s.functions(a), function(b) {
                var c = s[b] = a[b];
                s.prototype[b] = function() {
                    var a = [this._wrapped];
                    return j.apply(a, arguments), P(this, c.apply(s, a))
                }
            })
        }, s.mixin(s), s.each(["pop", "push", "reverse", "shift", "sort", "splice", "unshift"], function(a) {
            var b = g[a];
            s.prototype[a] = function() {
                var c = this._wrapped;
                return b.apply(c, arguments), "shift" !== a && "splice" !== a || 0 !== c.length || delete c[0], P(this, c)
            }
        }), s.each(["concat", "join", "slice"], function(a) {
            var b = g[a];
            s.prototype[a] = function() {
                return P(this, b.apply(this._wrapped, arguments))
            }
        }), s.prototype.value = function() {
            return this._wrapped
        }, s.prototype.valueOf = s.prototype.toJSON = s.prototype.value, s.prototype.toString = function() {
            return "" + this._wrapped
        }, "function" == typeof define && define.amd && define("underscore", [], function() {
            return s
        })
    }.call(this), function(a) {
        var b = "object" == typeof self && self.self == self && self || "object" == typeof global && global.global == global && global;
        if ("function" == typeof define && define.amd) define("backbone", ["underscore", "jquery", "exports"], function(c, d, e) {
            b.Backbone = a(b, e, c, d)
        });
        else if ("undefined" != typeof exports) {
            var d, c = require("underscore");
            try {
                d = require("jquery")
            } catch (a) {}
            a(b, exports, c, d)
        } else b.Backbone = a(b, {}, b._, b.jQuery || b.Zepto || b.ender || b.$)
    }(function(a, b, c, d) {
        var e = a.Backbone,
            f = Array.prototype.slice;
        b.VERSION = "1.2.3", b.$ = d, b.noConflict = function() {
            return a.Backbone = e, this
        }, b.emulateHTTP = !1, b.emulateJSON = !1;
        var g = function(a, b, d) {
                switch (a) {
                    case 1:
                        return function() {
                            return c[b](this[d])
                        };
                    case 2:
                        return function(a) {
                            return c[b](this[d], a)
                        };
                    case 3:
                        return function(a, e) {
                            return c[b](this[d], i(a, this), e)
                        };
                    case 4:
                        return function(a, e, f) {
                            return c[b](this[d], i(a, this), e, f)
                        };
                    default:
                        return function() {
                            var a = f.call(arguments);
                            return a.unshift(this[d]), c[b].apply(c, a)
                        }
                }
            },
            h = function(a, b, d) {
                c.each(b, function(b, e) {
                    c[e] && (a.prototype[e] = g(b, e, d))
                })
            },
            i = function(a, b) {
                return c.isFunction(a) ? a : c.isObject(a) && !b._isModel(a) ? j(a) : c.isString(a) ? function(b) {
                    return b.get(a)
                } : a
            },
            j = function(a) {
                var b = c.matches(a);
                return function(a) {
                    return b(a.attributes)
                }
            },
            k = b.Events = {},
            l = /\s+/,
            m = function(a, b, d, e, f) {
                var h, g = 0;
                if (d && "object" == typeof d) {
                    void 0 !== e && "context" in f && void 0 === f.context && (f.context = e);
                    for (h = c.keys(d); g < h.length; g++) b = m(a, b, h[g], d[h[g]], f)
                } else if (d && l.test(d))
                    for (h = d.split(l); g < h.length; g++) b = a(b, h[g], e, f);
                else b = a(b, d, e, f);
                return b
            };
        k.on = function(a, b, c) {
            return n(this, a, b, c)
        };
        var n = function(a, b, c, d, e) {
            if (a._events = m(o, a._events || {}, b, c, {
                    context: d,
                    ctx: a,
                    listening: e
                }), e) {
                var f = a._listeners || (a._listeners = {});
                f[e.id] = e
            }
            return a
        };
        k.listenTo = function(a, b, d) {
            if (!a) return this;
            var e = a._listenId || (a._listenId = c.uniqueId("l")),
                f = this._listeningTo || (this._listeningTo = {}),
                g = f[e];
            if (!g) {
                var h = this._listenId || (this._listenId = c.uniqueId("l"));
                g = f[e] = {
                    obj: a,
                    objId: e,
                    id: h,
                    listeningTo: f,
                    count: 0
                }
            }
            return n(a, b, d, this, g), this
        };
        var o = function(a, b, c, d) {
            if (c) {
                var e = a[b] || (a[b] = []),
                    f = d.context,
                    g = d.ctx,
                    h = d.listening;
                h && h.count++, e.push({
                    callback: c,
                    context: f,
                    ctx: f || g,
                    listening: h
                })
            }
            return a
        };
        k.off = function(a, b, c) {
            return this._events ? (this._events = m(p, this._events, a, b, {
                context: c,
                listeners: this._listeners
            }), this) : this
        }, k.stopListening = function(a, b, d) {
            var e = this._listeningTo;
            if (!e) return this;
            for (var f = a ? [a._listenId] : c.keys(e), g = 0; g < f.length; g++) {
                var h = e[f[g]];
                if (!h) break;
                h.obj.off(b, d, this)
            }
            return c.isEmpty(e) && (this._listeningTo = void 0), this
        };
        var p = function(a, b, d, e) {
            if (a) {
                var g, f = 0,
                    h = e.context,
                    i = e.listeners;
                if (b || d || h) {
                    for (var k = b ? [b] : c.keys(a); f < k.length; f++) {
                        b = k[f];
                        var l = a[b];
                        if (!l) break;
                        for (var m = [], n = 0; n < l.length; n++) {
                            var o = l[n];
                            d && d !== o.callback && d !== o.callback._callback || h && h !== o.context ? m.push(o) : (g = o.listening, g && 0 === --g.count && (delete i[g.id], delete g.listeningTo[g.objId]))
                        }
                        m.length ? a[b] = m : delete a[b]
                    }
                    return c.size(a) ? a : void 0
                }
                for (var j = c.keys(i); f < j.length; f++) g = i[j[f]], delete i[g.id], delete g.listeningTo[g.objId]
            }
        };
        k.once = function(a, b, d) {
            var e = m(q, {}, a, b, c.bind(this.off, this));
            return this.on(e, void 0, d)
        }, k.listenToOnce = function(a, b, d) {
            var e = m(q, {}, b, d, c.bind(this.stopListening, this, a));
            return this.listenTo(a, e)
        };
        var q = function(a, b, d, e) {
            if (d) {
                var f = a[b] = c.once(function() {
                    e(b, f), d.apply(this, arguments)
                });
                f._callback = d
            }
            return a
        };
        k.trigger = function(a) {
            if (!this._events) return this;
            for (var b = Math.max(0, arguments.length - 1), c = Array(b), d = 0; d < b; d++) c[d] = arguments[d + 1];
            return m(r, this._events, a, void 0, c), this
        };
        var r = function(a, b, c, d) {
                if (a) {
                    var e = a[b],
                        f = a.all;
                    e && f && (f = f.slice()), e && s(e, d), f && s(f, [b].concat(d))
                }
                return a
            },
            s = function(a, b) {
                var c, d = -1,
                    e = a.length,
                    f = b[0],
                    g = b[1],
                    h = b[2];
                switch (b.length) {
                    case 0:
                        for (; ++d < e;)(c = a[d]).callback.call(c.ctx);
                        return;
                    case 1:
                        for (; ++d < e;)(c = a[d]).callback.call(c.ctx, f);
                        return;
                    case 2:
                        for (; ++d < e;)(c = a[d]).callback.call(c.ctx, f, g);
                        return;
                    case 3:
                        for (; ++d < e;)(c = a[d]).callback.call(c.ctx, f, g, h);
                        return;
                    default:
                        for (; ++d < e;)(c = a[d]).callback.apply(c.ctx, b);
                        return
                }
            };
        k.bind = k.on, k.unbind = k.off, c.extend(b, k);
        var t = b.Model = function(a, b) {
            var d = a || {};
            b || (b = {}), this.cid = c.uniqueId(this.cidPrefix), this.attributes = {}, b.collection && (this.collection = b.collection), b.parse && (d = this.parse(d, b) || {}), d = c.defaults({}, d, c.result(this, "defaults")), this.set(d, b), this.changed = {}, this.initialize.apply(this, arguments)
        };
        c.extend(t.prototype, k, {
            changed: null,
            validationError: null,
            idAttribute: "id",
            cidPrefix: "c",
            initialize: function() {},
            toJSON: function(a) {
                return c.clone(this.attributes)
            },
            sync: function() {
                return b.sync.apply(this, arguments)
            },
            get: function(a) {
                return this.attributes[a]
            },
            escape: function(a) {
                return c.escape(this.get(a))
            },
            has: function(a) {
                return null != this.get(a)
            },
            matches: function(a) {
                return !!c.iteratee(a, this)(this.attributes)
            },
            set: function(a, b, d) {
                if (null == a) return this;
                var e;
                if ("object" == typeof a ? (e = a, d = b) : (e = {})[a] = b, d || (d = {}), !this._validate(e, d)) return !1;
                var f = d.unset,
                    g = d.silent,
                    h = [],
                    i = this._changing;
                this._changing = !0, i || (this._previousAttributes = c.clone(this.attributes), this.changed = {});
                var j = this.attributes,
                    k = this.changed,
                    l = this._previousAttributes;
                for (var m in e) b = e[m], c.isEqual(j[m], b) || h.push(m), c.isEqual(l[m], b) ? delete k[m] : k[m] = b, f ? delete j[m] : j[m] = b;
                if (this.id = this.get(this.idAttribute), !g) {
                    h.length && (this._pending = d);
                    for (var n = 0; n < h.length; n++) this.trigger("change:" + h[n], this, j[h[n]], d)
                }
                if (i) return this;
                if (!g)
                    for (; this._pending;) d = this._pending, this._pending = !1, this.trigger("change", this, d);
                return this._pending = !1, this._changing = !1, this
            },
            unset: function(a, b) {
                return this.set(a, void 0, c.extend({}, b, {
                    unset: !0
                }))
            },
            clear: function(a) {
                var b = {};
                for (var d in this.attributes) b[d] = void 0;
                return this.set(b, c.extend({}, a, {
                    unset: !0
                }))
            },
            hasChanged: function(a) {
                return null == a ? !c.isEmpty(this.changed) : c.has(this.changed, a)
            },
            changedAttributes: function(a) {
                if (!a) return !!this.hasChanged() && c.clone(this.changed);
                var b = this._changing ? this._previousAttributes : this.attributes,
                    d = {};
                for (var e in a) {
                    var f = a[e];
                    c.isEqual(b[e], f) || (d[e] = f)
                }
                return !!c.size(d) && d
            },
            previous: function(a) {
                return null != a && this._previousAttributes ? this._previousAttributes[a] : null
            },
            previousAttributes: function() {
                return c.clone(this._previousAttributes)
            },
            fetch: function(a) {
                a = c.extend({
                    parse: !0
                }, a);
                var b = this,
                    d = a.success;
                return a.success = function(c) {
                    var e = a.parse ? b.parse(c, a) : c;
                    return !!b.set(e, a) && (d && d.call(a.context, b, c, a), void b.trigger("sync", b, c, a))
                }, P(this, a), this.sync("read", this, a)
            },
            save: function(a, b, d) {
                var e;
                null == a || "object" == typeof a ? (e = a, d = b) : (e = {})[a] = b, d = c.extend({
                    validate: !0,
                    parse: !0
                }, d);
                var f = d.wait;
                if (e && !f) {
                    if (!this.set(e, d)) return !1
                } else if (!this._validate(e, d)) return !1;
                var g = this,
                    h = d.success,
                    i = this.attributes;
                d.success = function(a) {
                    g.attributes = i;
                    var b = d.parse ? g.parse(a, d) : a;
                    return f && (b = c.extend({}, e, b)), !(b && !g.set(b, d)) && (h && h.call(d.context, g, a, d), void g.trigger("sync", g, a, d))
                }, P(this, d), e && f && (this.attributes = c.extend({}, i, e));
                var j = this.isNew() ? "create" : d.patch ? "patch" : "update";
                "patch" === j && !d.attrs && (d.attrs = e);
                var k = this.sync(j, this, d);
                return this.attributes = i, k
            },
            destroy: function(a) {
                a = a ? c.clone(a) : {};
                var b = this,
                    d = a.success,
                    e = a.wait,
                    f = function() {
                        b.stopListening(), b.trigger("destroy", b, b.collection, a)
                    };
                a.success = function(c) {
                    e && f(), d && d.call(a.context, b, c, a), b.isNew() || b.trigger("sync", b, c, a)
                };
                var g = !1;
                return this.isNew() ? c.defer(a.success) : (P(this, a), g = this.sync("delete", this, a)), e || f(), g
            },
            url: function() {
                var a = c.result(this, "urlRoot") || c.result(this.collection, "url") || O();
                if (this.isNew()) return a;
                var b = this.get(this.idAttribute);
                return a.replace(/[^\/]$/, "$&/") + encodeURIComponent(b)
            },
            parse: function(a, b) {
                return a
            },
            clone: function() {
                return new this.constructor(this.attributes)
            },
            isNew: function() {
                return !this.has(this.idAttribute)
            },
            isValid: function(a) {
                return this._validate({}, c.defaults({
                    validate: !0
                }, a))
            },
            _validate: function(a, b) {
                if (!b.validate || !this.validate) return !0;
                a = c.extend({}, this.attributes, a);
                var d = this.validationError = this.validate(a, b) || null;
                return !d || (this.trigger("invalid", this, d, c.extend(b, {
                    validationError: d
                })), !1)
            }
        });
        var u = {
            keys: 1,
            values: 1,
            pairs: 1,
            invert: 1,
            pick: 0,
            omit: 0,
            chain: 1,
            isEmpty: 1
        };
        h(t, u, "attributes");
        var v = b.Collection = function(a, b) {
                b || (b = {}), b.model && (this.model = b.model), void 0 !== b.comparator && (this.comparator = b.comparator), this._reset(), this.initialize.apply(this, arguments), a && this.reset(a, c.extend({
                    silent: !0
                }, b))
            },
            w = {
                add: !0,
                remove: !0,
                merge: !0
            },
            x = {
                add: !0,
                remove: !1
            },
            y = function(a, b, c) {
                c = Math.min(Math.max(c, 0), a.length);
                for (var d = Array(a.length - c), e = b.length, f = 0; f < d.length; f++) d[f] = a[f + c];
                for (f = 0; f < e; f++) a[f + c] = b[f];
                for (f = 0; f < d.length; f++) a[f + e + c] = d[f]
            };
        c.extend(v.prototype, k, {
            model: t,
            initialize: function() {},
            toJSON: function(a) {
                return this.map(function(b) {
                    return b.toJSON(a)
                })
            },
            sync: function() {
                return b.sync.apply(this, arguments)
            },
            add: function(a, b) {
                return this.set(a, c.extend({
                    merge: !1
                }, b, x))
            },
            remove: function(a, b) {
                b = c.extend({}, b);
                var d = !c.isArray(a);
                a = d ? [a] : c.clone(a);
                var e = this._removeModels(a, b);
                return !b.silent && e && this.trigger("update", this, b), d ? e[0] : e
            },
            set: function(a, b) {
                if (null != a) {
                    b = c.defaults({}, b, w), b.parse && !this._isModel(a) && (a = this.parse(a, b));
                    var d = !c.isArray(a);
                    a = d ? [a] : a.slice();
                    var e = b.at;
                    null != e && (e = +e), e < 0 && (e += this.length + 1);
                    for (var p, f = [], g = [], h = [], i = {}, j = b.add, k = b.merge, l = b.remove, m = !1, n = this.comparator && null == e && b.sort !== !1, o = c.isString(this.comparator) ? this.comparator : null, q = 0; q < a.length; q++) {
                        p = a[q];
                        var r = this.get(p);
                        if (r) {
                            if (k && p !== r) {
                                var s = this._isModel(p) ? p.attributes : p;
                                b.parse && (s = r.parse(s, b)), r.set(s, b), n && !m && (m = r.hasChanged(o))
                            }
                            i[r.cid] || (i[r.cid] = !0, f.push(r)), a[q] = r
                        } else j && (p = a[q] = this._prepareModel(p, b), p && (g.push(p), this._addReference(p, b), i[p.cid] = !0, f.push(p)))
                    }
                    if (l) {
                        for (q = 0; q < this.length; q++) p = this.models[q], i[p.cid] || h.push(p);
                        h.length && this._removeModels(h, b)
                    }
                    var t = !1,
                        u = !n && j && l;
                    if (f.length && u ? (t = this.length != f.length || c.some(this.models, function(a, b) {
                            return a !== f[b]
                        }), this.models.length = 0, y(this.models, f, 0), this.length = this.models.length) : g.length && (n && (m = !0), y(this.models, g, null == e ? this.length : e), this.length = this.models.length), m && this.sort({
                            silent: !0
                        }), !b.silent) {
                        for (q = 0; q < g.length; q++) null != e && (b.index = e + q), p = g[q], p.trigger("add", p, this, b);
                        (m || t) && this.trigger("sort", this, b), (g.length || h.length) && this.trigger("update", this, b)
                    }
                    return d ? a[0] : a
                }
            },
            reset: function(a, b) {
                b = b ? c.clone(b) : {};
                for (var d = 0; d < this.models.length; d++) this._removeReference(this.models[d], b);
                return b.previousModels = this.models, this._reset(), a = this.add(a, c.extend({
                    silent: !0
                }, b)), b.silent || this.trigger("reset", this, b), a
            },
            push: function(a, b) {
                return this.add(a, c.extend({
                    at: this.length
                }, b))
            },
            pop: function(a) {
                var b = this.at(this.length - 1);
                return this.remove(b, a)
            },
            unshift: function(a, b) {
                return this.add(a, c.extend({
                    at: 0
                }, b))
            },
            shift: function(a) {
                var b = this.at(0);
                return this.remove(b, a)
            },
            slice: function() {
                return f.apply(this.models, arguments)
            },
            get: function(a) {
                if (null != a) {
                    var b = this.modelId(this._isModel(a) ? a.attributes : a);
                    return this._byId[a] || this._byId[b] || this._byId[a.cid]
                }
            },
            at: function(a) {
                return a < 0 && (a += this.length), this.models[a]
            },
            where: function(a, b) {
                return this[b ? "find" : "filter"](a)
            },
            findWhere: function(a) {
                return this.where(a, !0)
            },
            sort: function(a) {
                var b = this.comparator;
                if (!b) throw new Error("Cannot sort a set without a comparator");
                a || (a = {});
                var d = b.length;
                return c.isFunction(b) && (b = c.bind(b, this)), 1 === d || c.isString(b) ? this.models = this.sortBy(b) : this.models.sort(b), a.silent || this.trigger("sort", this, a), this
            },
            pluck: function(a) {
                return c.invoke(this.models, "get", a)
            },
            fetch: function(a) {
                a = c.extend({
                    parse: !0
                }, a);
                var b = a.success,
                    d = this;
                return a.success = function(c) {
                    var e = a.reset ? "reset" : "set";
                    d[e](c, a), b && b.call(a.context, d, c, a), d.trigger("sync", d, c, a)
                }, P(this, a), this.sync("read", this, a)
            },
            create: function(a, b) {
                b = b ? c.clone(b) : {};
                var d = b.wait;
                if (a = this._prepareModel(a, b), !a) return !1;
                d || this.add(a, b);
                var e = this,
                    f = b.success;
                return b.success = function(a, b, c) {
                    d && e.add(a, c), f && f.call(c.context, a, b, c)
                }, a.save(null, b), a
            },
            parse: function(a, b) {
                return a
            },
            clone: function() {
                return new this.constructor(this.models, {
                    model: this.model,
                    comparator: this.comparator
                })
            },
            modelId: function(a) {
                return a[this.model.prototype.idAttribute || "id"]
            },
            _reset: function() {
                this.length = 0, this.models = [], this._byId = {}
            },
            _prepareModel: function(a, b) {
                if (this._isModel(a)) return a.collection || (a.collection = this), a;
                b = b ? c.clone(b) : {}, b.collection = this;
                var d = new this.model(a, b);
                return d.validationError ? (this.trigger("invalid", this, d.validationError, b), !1) : d
            },
            _removeModels: function(a, b) {
                for (var c = [], d = 0; d < a.length; d++) {
                    var e = this.get(a[d]);
                    if (e) {
                        var f = this.indexOf(e);
                        this.models.splice(f, 1), this.length--, b.silent || (b.index = f, e.trigger("remove", e, this, b)), c.push(e), this._removeReference(e, b)
                    }
                }
                return !!c.length && c
            },
            _isModel: function(a) {
                return a instanceof t
            },
            _addReference: function(a, b) {
                this._byId[a.cid] = a;
                var c = this.modelId(a.attributes);
                null != c && (this._byId[c] = a), a.on("all", this._onModelEvent, this)
            },
            _removeReference: function(a, b) {
                delete this._byId[a.cid];
                var c = this.modelId(a.attributes);
                null != c && delete this._byId[c], this === a.collection && delete a.collection, a.off("all", this._onModelEvent, this)
            },
            _onModelEvent: function(a, b, c, d) {
                if ("add" !== a && "remove" !== a || c === this) {
                    if ("destroy" === a && this.remove(b, d), "change" === a) {
                        var e = this.modelId(b.previousAttributes()),
                            f = this.modelId(b.attributes);
                        e !== f && (null != e && delete this._byId[e], null != f && (this._byId[f] = b))
                    }
                    this.trigger.apply(this, arguments)
                }
            }
        });
        var z = {
            forEach: 3,
            each: 3,
            map: 3,
            collect: 3,
            reduce: 4,
            foldl: 4,
            inject: 4,
            reduceRight: 4,
            foldr: 4,
            find: 3,
            detect: 3,
            filter: 3,
            select: 3,
            reject: 3,
            every: 3,
            all: 3,
            some: 3,
            any: 3,
            include: 3,
            includes: 3,
            contains: 3,
            invoke: 0,
            max: 3,
            min: 3,
            toArray: 1,
            size: 1,
            first: 3,
            head: 3,
            take: 3,
            initial: 3,
            rest: 3,
            tail: 3,
            drop: 3,
            last: 3,
            without: 0,
            difference: 0,
            indexOf: 3,
            shuffle: 1,
            lastIndexOf: 3,
            isEmpty: 1,
            chain: 1,
            sample: 3,
            partition: 3,
            groupBy: 3,
            countBy: 3,
            sortBy: 3,
            indexBy: 3
        };
        h(v, z, "models");
        var A = b.View = function(a) {
                this.cid = c.uniqueId("view"), c.extend(this, c.pick(a, C)), this._ensureElement(), this.initialize.apply(this, arguments)
            },
            B = /^(\S+)\s*(.*)$/,
            C = ["model", "collection", "el", "id", "attributes", "className", "tagName", "events"];
        c.extend(A.prototype, k, {
            tagName: "div",
            $: function(a) {
                return this.$el.find(a)
            },
            initialize: function() {},
            render: function() {
                return this
            },
            remove: function() {
                return this._removeElement(), this.stopListening(), this
            },
            _removeElement: function() {
                this.$el.remove()
            },
            setElement: function(a) {
                return this.undelegateEvents(), this._setElement(a), this.delegateEvents(), this
            },
            _setElement: function(a) {
                this.$el = a instanceof b.$ ? a : b.$(a), this.el = this.$el[0]
            },
            delegateEvents: function(a) {
                if (a || (a = c.result(this, "events")), !a) return this;
                this.undelegateEvents();
                for (var b in a) {
                    var d = a[b];
                    if (c.isFunction(d) || (d = this[d]), d) {
                        var e = b.match(B);
                        this.delegate(e[1], e[2], c.bind(d, this))
                    }
                }
                return this
            },
            delegate: function(a, b, c) {
                return this.$el.on(a + ".delegateEvents" + this.cid, b, c), this
            },
            undelegateEvents: function() {
                return this.$el && this.$el.off(".delegateEvents" + this.cid),
                    this
            },
            undelegate: function(a, b, c) {
                return this.$el.off(a + ".delegateEvents" + this.cid, b, c), this
            },
            _createElement: function(a) {
                return document.createElement(a)
            },
            _ensureElement: function() {
                if (this.el) this.setElement(c.result(this, "el"));
                else {
                    var a = c.extend({}, c.result(this, "attributes"));
                    this.id && (a.id = c.result(this, "id")), this.className && (a.class = c.result(this, "className")), this.setElement(this._createElement(c.result(this, "tagName"))), this._setAttributes(a)
                }
            },
            _setAttributes: function(a) {
                this.$el.attr(a)
            }
        }), b.sync = function(a, d, e) {
            var f = D[a];
            c.defaults(e || (e = {}), {
                emulateHTTP: b.emulateHTTP,
                emulateJSON: b.emulateJSON
            });
            var g = {
                type: f,
                dataType: "json"
            };
            if (e.url || (g.url = c.result(d, "url") || O()), null == e.data && d && ("create" === a || "update" === a || "patch" === a) && (g.contentType = "application/json", g.data = JSON.stringify(e.attrs || d.toJSON(e))), e.emulateJSON && (g.contentType = "application/x-www-form-urlencoded", g.data = g.data ? {
                    model: g.data
                } : {}), e.emulateHTTP && ("PUT" === f || "DELETE" === f || "PATCH" === f)) {
                g.type = "POST", e.emulateJSON && (g.data._method = f);
                var h = e.beforeSend;
                e.beforeSend = function(a) {
                    if (a.setRequestHeader("X-HTTP-Method-Override", f), h) return h.apply(this, arguments)
                }
            }
            "GET" !== g.type && !e.emulateJSON && (g.processData = !1);
            var i = e.error;
            e.error = function(a, b, c) {
                e.textStatus = b, e.errorThrown = c, i && i.call(e.context, a, b, c)
            };
            var j = e.xhr = b.ajax(c.extend(g, e));
            return d.trigger("request", d, j, e), j
        };
        var D = {
            create: "POST",
            update: "PUT",
            patch: "PATCH",
            delete: "DELETE",
            read: "GET"
        };
        b.ajax = function() {
            return b.$.ajax.apply(b.$, arguments)
        };
        var E = b.Router = function(a) {
                a || (a = {}), a.routes && (this.routes = a.routes), this._bindRoutes(), this.initialize.apply(this, arguments)
            },
            F = /\((.*?)\)/g,
            G = /(\(\?)?:\w+/g,
            H = /\*\w+/g,
            I = /[\-{}\[\]+?.,\\\^$|#\s]/g;
        c.extend(E.prototype, k, {
            initialize: function() {},
            route: function(a, d, e) {
                c.isRegExp(a) || (a = this._routeToRegExp(a)), c.isFunction(d) && (e = d, d = ""), e || (e = this[d]);
                var f = this;
                return b.history.route(a, function(c) {
                    var g = f._extractParameters(a, c);
                    f.execute(e, g, d) !== !1 && (f.trigger.apply(f, ["route:" + d].concat(g)), f.trigger("route", d, g), b.history.trigger("route", f, d, g))
                }), this
            },
            execute: function(a, b, c) {
                a && a.apply(this, b)
            },
            navigate: function(a, c) {
                return b.history.navigate(a, c), this
            },
            _bindRoutes: function() {
                if (this.routes) {
                    this.routes = c.result(this, "routes");
                    for (var a, b = c.keys(this.routes); null != (a = b.pop());) this.route(a, this.routes[a])
                }
            },
            _routeToRegExp: function(a) {
                return a = a.replace(I, "\\$&").replace(F, "(?:$1)?").replace(G, function(a, b) {
                    return b ? a : "([^/?]+)"
                }).replace(H, "([^?]*?)"), new RegExp("^" + a + "(?:\\?([\\s\\S]*))?$")
            },
            _extractParameters: function(a, b) {
                var d = a.exec(b).slice(1);
                return c.map(d, function(a, b) {
                    return b === d.length - 1 ? a || null : a ? decodeURIComponent(a) : null
                })
            }
        });
        var J = b.History = function() {
                this.handlers = [], this.checkUrl = c.bind(this.checkUrl, this), "undefined" != typeof window && (this.location = window.location, this.history = window.history)
            },
            K = /^[#\/]|\s+$/g,
            L = /^\/+|\/+$/g,
            M = /#.*$/;
        J.started = !1, c.extend(J.prototype, k, {
            interval: 50,
            atRoot: function() {
                var a = this.location.pathname.replace(/[^\/]$/, "$&/");
                return a === this.root && !this.getSearch()
            },
            matchRoot: function() {
                var a = this.decodeFragment(this.location.pathname),
                    b = a.slice(0, this.root.length - 1) + "/";
                return b === this.root
            },
            decodeFragment: function(a) {
                return decodeURI(a.replace(/%25/g, "%2525"))
            },
            getSearch: function() {
                var a = this.location.href.replace(/#.*/, "").match(/\?.+/);
                return a ? a[0] : ""
            },
            getHash: function(a) {
                var b = (a || this).location.href.match(/#(.*)$/);
                return b ? b[1] : ""
            },
            getPath: function() {
                var a = this.decodeFragment(this.location.pathname + this.getSearch()).slice(this.root.length - 1);
                return "/" === a.charAt(0) ? a.slice(1) : a
            },
            getFragment: function(a) {
                return null == a && (a = this._usePushState || !this._wantsHashChange ? this.getPath() : this.getHash()), a.replace(K, "")
            },
            start: function(a) {
                if (J.started) throw new Error("Backbone.history has already been started");
                if (J.started = !0, this.options = c.extend({
                        root: "/"
                    }, this.options, a), this.root = this.options.root, this._wantsHashChange = this.options.hashChange !== !1, this._hasHashChange = "onhashchange" in window && (void 0 === document.documentMode || document.documentMode > 7), this._useHashChange = this._wantsHashChange && this._hasHashChange, this._wantsPushState = !!this.options.pushState, this._hasPushState = !!this.history && !!this.history.pushState, this._usePushState = this._wantsPushState && this._hasPushState, this.fragment = this.getFragment(), this.root = ("/" + this.root + "/").replace(L, "/"), this._wantsHashChange && this._wantsPushState) {
                    if (!this._hasPushState && !this.atRoot()) {
                        var b = this.root.slice(0, -1) || "/";
                        return this.location.replace(b + "#" + this.getPath()), !0
                    }
                    this._hasPushState && this.atRoot() && this.navigate(this.getHash(), {
                        replace: !0
                    })
                }
                if (!this._hasHashChange && this._wantsHashChange && !this._usePushState) {
                    this.iframe = document.createElement("iframe"), this.iframe.src = "javascript:0", this.iframe.style.display = "none", this.iframe.tabIndex = -1;
                    var d = document.body,
                        e = d.insertBefore(this.iframe, d.firstChild).contentWindow;
                    e.document.open(), e.document.close(), e.location.hash = "#" + this.fragment
                }
                var f = window.addEventListener || function(a, b) {
                    return attachEvent("on" + a, b)
                };
                if (this._usePushState ? f("popstate", this.checkUrl, !1) : this._useHashChange && !this.iframe ? f("hashchange", this.checkUrl, !1) : this._wantsHashChange && (this._checkUrlInterval = setInterval(this.checkUrl, this.interval)), !this.options.silent) return this.loadUrl()
            },
            stop: function() {
                var a = window.removeEventListener || function(a, b) {
                    return detachEvent("on" + a, b)
                };
                this._usePushState ? a("popstate", this.checkUrl, !1) : this._useHashChange && !this.iframe && a("hashchange", this.checkUrl, !1), this.iframe && (document.body.removeChild(this.iframe), this.iframe = null), this._checkUrlInterval && clearInterval(this._checkUrlInterval), J.started = !1
            },
            route: function(a, b) {
                this.handlers.unshift({
                    route: a,
                    callback: b
                })
            },
            checkUrl: function(a) {
                var b = this.getFragment();
                return b === this.fragment && this.iframe && (b = this.getHash(this.iframe.contentWindow)), b !== this.fragment && (this.iframe && this.navigate(b), void this.loadUrl())
            },
            loadUrl: function(a) {
                return !!this.matchRoot() && (a = this.fragment = this.getFragment(a), c.some(this.handlers, function(b) {
                    if (b.route.test(a)) return b.callback(a), !0
                }))
            },
            navigate: function(a, b) {
                if (!J.started) return !1;
                b && b !== !0 || (b = {
                    trigger: !!b
                }), a = this.getFragment(a || "");
                var c = this.root;
                "" !== a && "?" !== a.charAt(0) || (c = c.slice(0, -1) || "/");
                var d = c + a;
                if (a = this.decodeFragment(a.replace(M, "")), this.fragment !== a) {
                    if (this.fragment = a, this._usePushState) this.history[b.replace ? "replaceState" : "pushState"]({}, document.title, d);
                    else {
                        if (!this._wantsHashChange) return this.location.assign(d);
                        if (this._updateHash(this.location, a, b.replace), this.iframe && a !== this.getHash(this.iframe.contentWindow)) {
                            var e = this.iframe.contentWindow;
                            b.replace || (e.document.open(), e.document.close()), this._updateHash(e.location, a, b.replace)
                        }
                    }
                    return b.trigger ? this.loadUrl(a) : void 0
                }
            },
            _updateHash: function(a, b, c) {
                if (c) {
                    var d = a.href.replace(/(javascript:|#).*$/, "");
                    a.replace(d + "#" + b)
                } else a.hash = "#" + b
            }
        }), b.history = new J;
        var N = function(a, b) {
            var e, d = this;
            e = a && c.has(a, "constructor") ? a.constructor : function() {
                return d.apply(this, arguments)
            }, c.extend(e, d, b);
            var f = function() {
                this.constructor = e
            };
            return f.prototype = d.prototype, e.prototype = new f, a && c.extend(e.prototype, a), e.__super__ = d.prototype, e
        };
        t.extend = v.extend = E.extend = A.extend = J.extend = N;
        var O = function() {
                throw new Error('A "url" property or function must be specified')
            },
            P = function(a, b) {
                var c = b.error;
                b.error = function(d) {
                    c && c.call(b.context, a, d, b), a.trigger("error", a, d, b)
                }
            };
        return b
    }), function(deparam) {
        if ("function" == typeof require && "object" == typeof exports && "object" == typeof module) {
            var jquery = require("jquery");
            module.exports = deparam(jquery)
        } else if ("function" == typeof define && define.amd) define("jquery.deparam", ["jquery"], function(a) {
            return deparam(a)
        });
        else {
            var global;
            try {
                global = eval("this")
            } catch (a) {
                global = window
            }
            global.deparam = deparam(jQuery)
        }
    }(function(a) {
        var b = function(a, b) {
            var c = {},
                d = {
                    true: !0,
                    false: !1,
                    null: null
                };
            return a.replace(/\+/g, " ").split("&").forEach(function(a) {
                var g, e = a.split("="),
                    f = decodeURIComponent(e[0]),
                    h = c,
                    i = 0,
                    j = f.split("]["),
                    k = j.length - 1;
                if (/\[/.test(j[0]) && /\]$/.test(j[k]) ? (j[k] = j[k].replace(/\]$/, ""), j = j.shift().split("[").concat(j), k = j.length - 1) : k = 0, 2 === e.length)
                    if (g = decodeURIComponent(e[1]), b && (g = g && !isNaN(g) && +g + "" === g ? +g : "undefined" === g ? void 0 : void 0 !== d[g] ? d[g] : g), k)
                        for (; i <= k; i++) f = "" === j[i] ? h.length : j[i], h = h[f] = i < k ? h[f] || (j[i + 1] && isNaN(j[i + 1]) ? {} : []) : g;
                    else "[object Array]" === Object.prototype.toString.call(c[f]) ? c[f].push(g) : {}.hasOwnProperty.call(c, f) ? c[f] = [c[f], g] : c[f] = g;
                else f && (c[f] = b ? void 0 : "")
            }), c
        };
        return a.prototype.deparam = a.deparam = b, b
    }), function(a) {
        a("jsonpack", [], function() {
            var a = -1,
                b = -2,
                c = -3,
                d = -4,
                e = -5,
                f = function(f, g) {
                    g = g || {};
                    var h = g.verbose || !1;
                    h && console.log("Normalize the JSON Object"), f = "string" == typeof f ? this.JSON.parse(f) : f, h && console.log("Creating a empty dictionary");
                    var j = {
                        strings: [],
                        integers: [],
                        floats: []
                    };
                    h && console.log("Creating the AST");
                    var l = function f(g) {
                            h && console.log("Calling recursiveAstBuilder with " + this.JSON.stringify(g));
                            var l = typeof g;
                            if (null === g) return {
                                type: "null",
                                index: c
                            };
                            if ("undefined" == typeof g) return {
                                type: "undefined",
                                index: e
                            };
                            if (g instanceof Array) {
                                var n = ["@"];
                                for (var o in g) g.hasOwnProperty(o) && n.push(f(g[o]));
                                return n
                            }
                            if ("object" === l) {
                                var n = ["$"];
                                for (var p in g) g.hasOwnProperty(p) && (n.push(f(p)), n.push(f(g[p])));
                                return n
                            }
                            if ("" === g) return {
                                type: "empty",
                                index: d
                            };
                            if ("string" === l) {
                                var q = m.call(j.strings, g);
                                return q == -1 && (j.strings.push(i(g)), q = j.strings.length - 1), {
                                    type: "strings",
                                    index: q
                                }
                            }
                            if ("number" === l && g % 1 === 0) {
                                var q = m.call(j.integers, g);
                                return q == -1 && (j.integers.push(k(g)), q = j.integers.length - 1), {
                                    type: "integers",
                                    index: q
                                }
                            }
                            if ("number" === l) {
                                var q = m.call(j.floats, g);
                                return q == -1 && (j.floats.push(g), q = j.floats.length - 1), {
                                    type: "floats",
                                    index: q
                                }
                            }
                            if ("boolean" === l) return {
                                type: "boolean",
                                index: g ? a : b
                            };
                            throw new Error("Unexpected argument of type " + typeof g)
                        }(f),
                        n = j.strings.length,
                        o = j.integers.length;
                    j.floats.length;
                    h && console.log("Parsing the dictionary");
                    var q = j.strings.join("|");
                    return q += "^" + j.integers.join("|"), q += "^" + j.floats.join("|"), h && console.log("Parsing the structure"), q += "^" + function a(b) {
                        if (h && console.log("Calling a recursiveParser with " + this.JSON.stringify(b)), b instanceof Array) {
                            var f = b.shift();
                            for (var g in b) b.hasOwnProperty(g) && (f += a(b[g]) + "|");
                            return ("|" === f[f.length - 1] ? f.slice(0, -1) : f) + "]"
                        }
                        var i = b.type,
                            j = b.index;
                        if ("strings" === i) return k(j);
                        if ("integers" === i) return k(n + j);
                        if ("floats" === i) return k(n + o + j);
                        if ("boolean" === i) return b.index;
                        if ("null" === i) return c;
                        if ("undefined" === i) return e;
                        if ("empty" === i) return d;
                        throw new TypeError("The item is alien!")
                    }(l), h && console.log("Ending parser"), g.debug ? {
                        dictionary: j,
                        ast: l,
                        packed: q
                    } : q
                },
                g = function(f, g) {
                    g = g || {};
                    var h = f.split("^");
                    g.verbose && console.log("Building dictionary");
                    var i = [],
                        k = h[0];
                    if ("" !== k) {
                        k = k.split("|"), g.verbose && console.log("Parse the strings dictionary");
                        for (var m = 0, n = k.length; m < n; m++) i.push(j(k[m]))
                    }
                    if (k = h[1], "" !== k) {
                        k = k.split("|"), g.verbose && console.log("Parse the integers dictionary");
                        for (var m = 0, n = k.length; m < n; m++) i.push(l(k[m]))
                    }
                    if (k = h[2], "" !== k) {
                        k = k.split("|"), g.verbose && console.log("Parse the floats dictionary");
                        for (var m = 0, n = k.length; m < n; m++) i.push(parseFloat(k[m]))
                    }
                    delete k, g.verbose && console.log("Tokenizing the structure");
                    for (var o = "", p = [], q = h[3].length, m = 0; m < q; m++) {
                        var r = h[3].charAt(m);
                        "|" === r || "$" === r || "@" === r || "]" === r ? (o && (p.push(l(o)), o = ""), "|" !== r && p.push(r)) : o += r
                    }
                    var s = p.length,
                        t = 0;
                    return g.verbose && console.log("Starting recursive parser"),
                        function f() {
                            var h = p[t++];
                            if (g.verbose && console.log("Reading collection type " + ("$" === h ? "object" : "Array")), "@" === h) {
                                for (var j = []; t < s; t++) {
                                    var k = p[t];
                                    if (g.verbose && console.log("Read " + k + " symbol"), "]" === k) return j;
                                    if ("@" === k || "$" === k) j.push(f());
                                    else switch (k) {
                                        case a:
                                            j.push(!0);
                                            break;
                                        case b:
                                            j.push(!1);
                                            break;
                                        case c:
                                            j.push(null);
                                            break;
                                        case e:
                                            j.push(void 0);
                                            break;
                                        case d:
                                            j.push("");
                                            break;
                                        default:
                                            j.push(i[k])
                                    }
                                }
                                return g.verbose && console.log("Parsed " + this.JSON.stringify(j)), j
                            }
                            if ("$" === h) {
                                for (var j = {}; t < s; t++) {
                                    var l = p[t];
                                    if ("]" === l) return j;
                                    l = l === d ? "" : i[l];
                                    var k = p[++t];
                                    if ("@" === k || "$" === k) j[l] = f();
                                    else switch (k) {
                                        case a:
                                            j[l] = !0;
                                            break;
                                        case b:
                                            j[l] = !1;
                                            break;
                                        case c:
                                            j[l] = null;
                                            break;
                                        case e:
                                            j[l] = void 0;
                                            break;
                                        case d:
                                            j[l] = "";
                                            break;
                                        default:
                                            j[l] = i[k]
                                    }
                                }
                                return g.verbose && console.log("Parsed " + this.JSON.stringify(j)), j
                            }
                            throw new TypeError("Bad token " + h + " isn't a type")
                        }()
                },
                i = function(a) {
                    return "string" != typeof a ? a : a.replace(/[\+ \|\^\%]/g, function(a) {
                        return {
                            " ": "+",
                            "+": "%2B",
                            "|": "%7C",
                            "^": "%5E",
                            "%": "%25"
                        }[a]
                    })
                },
                j = function(a) {
                    return "string" != typeof a ? a : a.replace(/\+|%2B|%7C|%5E|%25/g, function(a) {
                        return {
                            "+": " ",
                            "%2B": "+",
                            "%7C": "|",
                            "%5E": "^",
                            "%25": "%"
                        }[a]
                    })
                },
                k = function(a) {
                    return Number.prototype.toString.call(a, 36).toUpperCase()
                },
                l = function(a) {
                    return parseInt(a, 36)
                },
                m = Array.prototype.indexOf || function(a, b) {
                    for (var c = b || 0, d = this.length; c < d; c++)
                        if (this[c] === a) return c;
                    return -1
                };
            return {
                JSON: JSON,
                pack: f,
                unpack: g
            }
        })
    }("undefined" != typeof define && define.amd ? define : function(a, b) {
        var c = b();
        if ("undefined" != typeof exports)
            for (var d in c) exports[d] = c[d];
        else window.jsonpack = c
    }), define("domReady", [], function() {
        "use strict";

        function a(a) {
            var b;
            for (b = 0; b < a.length; b += 1) a[b](j)
        }

        function b() {
            var b = k;
            i && b.length && (k = [], a(b))
        }

        function c() {
            i || (i = !0, g && clearInterval(g), b())
        }

        function d(a) {
            return i ? a(j) : k.push(a), d
        }
        var e, f, g, h = "undefined" != typeof window && window.document,
            i = !h,
            j = h ? document : null,
            k = [];
        if (h) {
            if (document.addEventListener) document.addEventListener("DOMContentLoaded", c, !1), window.addEventListener("load", c, !1);
            else if (window.attachEvent) {
                window.attachEvent("onload", c), f = document.createElement("div");
                try {
                    e = null === window.frameElement
                } catch (a) {}
                f.doScroll && e && window.external && (g = setInterval(function() {
                    try {
                        f.doScroll(), c()
                    } catch (a) {}
                }, 30))
            }
            "complete" === document.readyState && c()
        }
        return d.version = "2.0.1", d.load = function(a, b, c, e) {
            e.isBuild ? c(null) : d(c)
        }, d
    }), "undefined" == typeof jQuery) throw new Error("Bootstrap's JavaScript requires jQuery"); + function(a) {
    "use strict";
    var b = a.fn.jquery.split(" ")[0].split(".");
    if (b[0] < 2 && b[1] < 9 || 1 == b[0] && 9 == b[1] && b[2] < 1 || b[0] > 2) throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 3")
}(jQuery), + function(a) {
    "use strict";

    function b(b) {
        return this.each(function() {
            var d = a(this),
                e = d.data("bs.carousel"),
                f = a.extend({}, c.DEFAULTS, d.data(), "object" == typeof b && b),
                g = "string" == typeof b ? b : f.slide;
            e || d.data("bs.carousel", e = new c(this, f)), "number" == typeof b ? e.to(b) : g ? e[g]() : f.interval && e.pause().cycle()
        })
    }
    var c = function(b, c) {
        this.$element = a(b), this.$indicators = this.$element.find(".carousel-indicators"), this.options = c, this.paused = null, this.sliding = null, this.interval = null, this.$active = null, this.$items = null, this.options.keyboard && this.$element.on("keydown.bs.carousel", a.proxy(this.keydown, this)), "hover" == this.options.pause && !("ontouchstart" in document.documentElement) && this.$element.on("mouseenter.bs.carousel", a.proxy(this.pause, this)).on("mouseleave.bs.carousel", a.proxy(this.cycle, this))
    };
    c.VERSION = "3.3.6", c.TRANSITION_DURATION = 600, c.DEFAULTS = {
        interval: 5e3,
        pause: "hover",
        wrap: !0,
        keyboard: !0
    }, c.prototype.keydown = function(a) {
        if (!/input|textarea/i.test(a.target.tagName)) {
            switch (a.which) {
                case 37:
                    this.prev();
                    break;
                case 39:
                    this.next();
                    break;
                default:
                    return
            }
            a.preventDefault()
        }
    }, c.prototype.cycle = function(b) {
        return b || (this.paused = !1), this.interval && clearInterval(this.interval), this.options.interval && !this.paused && (this.interval = setInterval(a.proxy(this.next, this), this.options.interval)), this
    }, c.prototype.getItemIndex = function(a) {
        return this.$items = a.parent().children(".item"), this.$items.index(a || this.$active)
    }, c.prototype.getItemForDirection = function(a, b) {
        var c = this.getItemIndex(b),
            d = "prev" == a && 0 === c || "next" == a && c == this.$items.length - 1;
        if (d && !this.options.wrap) return b;
        var e = "prev" == a ? -1 : 1,
            f = (c + e) % this.$items.length;
        return this.$items.eq(f)
    }, c.prototype.to = function(a) {
        var b = this,
            c = this.getItemIndex(this.$active = this.$element.find(".item.active"));
        if (!(a > this.$items.length - 1 || a < 0)) return this.sliding ? this.$element.one("slid.bs.carousel", function() {
            b.to(a)
        }) : c == a ? this.pause().cycle() : this.slide(a > c ? "next" : "prev", this.$items.eq(a))
    }, c.prototype.pause = function(b) {
        return b || (this.paused = !0), this.$element.find(".next, .prev").length && a.support.transition && (this.$element.trigger(a.support.transition.end), this.cycle(!0)), this.interval = clearInterval(this.interval), this
    }, c.prototype.next = function() {
        if (!this.sliding) return this.slide("next")
    }, c.prototype.prev = function() {
        if (!this.sliding) return this.slide("prev")
    }, c.prototype.slide = function(b, d) {
        var e = this.$element.find(".item.active"),
            f = d || this.getItemForDirection(b, e),
            g = this.interval,
            h = "next" == b ? "left" : "right",
            i = this;
        if (f.hasClass("active")) return this.sliding = !1;
        var j = f[0],
            k = a.Event("slide.bs.carousel", {
                relatedTarget: j,
                direction: h
            });
        if (this.$element.trigger(k), !k.isDefaultPrevented()) {
            if (this.sliding = !0, g && this.pause(), this.$indicators.length) {
                this.$indicators.find(".active").removeClass("active");
                var l = a(this.$indicators.children()[this.getItemIndex(f)]);
                l && l.addClass("active")
            }
            var m = a.Event("slid.bs.carousel", {
                relatedTarget: j,
                direction: h
            });
            return a.support.transition && this.$element.hasClass("slide") ? (f.addClass(b), f[0].offsetWidth, e.addClass(h), f.addClass(h), e.one("bsTransitionEnd", function() {
                f.removeClass([b, h].join(" ")).addClass("active"), e.removeClass(["active", h].join(" ")), i.sliding = !1, setTimeout(function() {
                    i.$element.trigger(m)
                }, 0)
            }).emulateTransitionEnd(c.TRANSITION_DURATION)) : (e.removeClass("active"), f.addClass("active"), this.sliding = !1, this.$element.trigger(m)), g && this.cycle(), this
        }
    };
    var d = a.fn.carousel;
    a.fn.carousel = b, a.fn.carousel.Constructor = c, a.fn.carousel.noConflict = function() {
        return a.fn.carousel = d, this
    };
    var e = function(c) {
        var d, e = a(this),
            f = a(e.attr("data-target") || (d = e.attr("href")) && d.replace(/.*(?=#[^\s]+$)/, ""));
        if (f.hasClass("carousel")) {
            var g = a.extend({}, f.data(), e.data()),
                h = e.attr("data-slide-to");
            h && (g.interval = !1), b.call(f, g), h && f.data("bs.carousel").to(h), c.preventDefault()
        }
    };
    a(document).on("click.bs.carousel.data-api", "[data-slide]", e).on("click.bs.carousel.data-api", "[data-slide-to]", e), a(window).on("load", function() {
        a('[data-ride="carousel"]').each(function() {
            var c = a(this);
            b.call(c, c.data())
        })
    })
}(jQuery), + function(a) {
    "use strict";

    function b(b) {
        return this.each(function() {
            var d = a(this),
                e = d.data("bs.tooltip"),
                f = "object" == typeof b && b;
            !e && /destroy|hide/.test(b) || (e || d.data("bs.tooltip", e = new c(this, f)), "string" == typeof b && e[b]())
        })
    }
    var c = function(a, b) {
        this.type = null, this.options = null, this.enabled = null, this.timeout = null, this.hoverState = null, this.$element = null, this.inState = null, this.init("tooltip", a, b)
    };
    c.VERSION = "3.3.6", c.TRANSITION_DURATION = 150, c.DEFAULTS = {
        animation: !0,
        placement: "top",
        selector: !1,
        template: '<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
        trigger: "hover focus",
        title: "",
        delay: 0,
        html: !1,
        container: !1,
        viewport: {
            selector: "body",
            padding: 0
        }
    }, c.prototype.init = function(b, c, d) {
        if (this.enabled = !0, this.type = b, this.$element = a(c), this.options = this.getOptions(d), this.$viewport = this.options.viewport && a(a.isFunction(this.options.viewport) ? this.options.viewport.call(this, this.$element) : this.options.viewport.selector || this.options.viewport), this.inState = {
                click: !1,
                hover: !1,
                focus: !1
            }, this.$element[0] instanceof document.constructor && !this.options.selector) throw new Error("`selector` option must be specified when initializing " + this.type + " on the window.document object!");
        for (var e = this.options.trigger.split(" "), f = e.length; f--;) {
            var g = e[f];
            if ("click" == g) this.$element.on("click." + this.type, this.options.selector, a.proxy(this.toggle, this));
            else if ("manual" != g) {
                var h = "hover" == g ? "mouseenter" : "focusin",
                    i = "hover" == g ? "mouseleave" : "focusout";
                this.$element.on(h + "." + this.type, this.options.selector, a.proxy(this.enter, this)), this.$element.on(i + "." + this.type, this.options.selector, a.proxy(this.leave, this))
            }
        }
        this.options.selector ? this._options = a.extend({}, this.options, {
            trigger: "manual",
            selector: ""
        }) : this.fixTitle()
    }, c.prototype.getDefaults = function() {
        return c.DEFAULTS
    }, c.prototype.getOptions = function(b) {
        return b = a.extend({}, this.getDefaults(), this.$element.data(), b), b.delay && "number" == typeof b.delay && (b.delay = {
            show: b.delay,
            hide: b.delay
        }), b
    }, c.prototype.getDelegateOptions = function() {
        var b = {},
            c = this.getDefaults();
        return this._options && a.each(this._options, function(a, d) {
            c[a] != d && (b[a] = d)
        }), b
    }, c.prototype.enter = function(b) {
        var c = b instanceof this.constructor ? b : a(b.currentTarget).data("bs." + this.type);
        return c || (c = new this.constructor(b.currentTarget, this.getDelegateOptions()), a(b.currentTarget).data("bs." + this.type, c)), b instanceof a.Event && (c.inState["focusin" == b.type ? "focus" : "hover"] = !0), c.tip().hasClass("in") || "in" == c.hoverState ? void(c.hoverState = "in") : (clearTimeout(c.timeout), c.hoverState = "in", c.options.delay && c.options.delay.show ? void(c.timeout = setTimeout(function() {
            "in" == c.hoverState && c.show()
        }, c.options.delay.show)) : c.show())
    }, c.prototype.isInStateTrue = function() {
        for (var a in this.inState)
            if (this.inState[a]) return !0;
        return !1
    }, c.prototype.leave = function(b) {
        var c = b instanceof this.constructor ? b : a(b.currentTarget).data("bs." + this.type);
        if (c || (c = new this.constructor(b.currentTarget, this.getDelegateOptions()), a(b.currentTarget).data("bs." + this.type, c)), b instanceof a.Event && (c.inState["focusout" == b.type ? "focus" : "hover"] = !1), !c.isInStateTrue()) return clearTimeout(c.timeout), c.hoverState = "out", c.options.delay && c.options.delay.hide ? void(c.timeout = setTimeout(function() {
            "out" == c.hoverState && c.hide()
        }, c.options.delay.hide)) : c.hide()
    }, c.prototype.show = function() {
        var b = a.Event("show.bs." + this.type);
        if (this.hasContent() && this.enabled) {
            this.$element.trigger(b);
            var d = a.contains(this.$element[0].ownerDocument.documentElement, this.$element[0]);
            if (b.isDefaultPrevented() || !d) return;
            var e = this,
                f = this.tip(),
                g = this.getUID(this.type);
            this.setContent(), f.attr("id", g), this.$element.attr("aria-describedby", g), this.options.animation && f.addClass("fade");
            var h = "function" == typeof this.options.placement ? this.options.placement.call(this, f[0], this.$element[0]) : this.options.placement,
                i = /\s?auto?\s?/i,
                j = i.test(h);
            j && (h = h.replace(i, "") || "top"), f.detach().css({
                top: 0,
                left: 0,
                display: "block"
            }).addClass(h).data("bs." + this.type, this), this.options.container ? f.appendTo(this.options.container) : f.insertAfter(this.$element), this.$element.trigger("inserted.bs." + this.type);
            var k = this.getPosition(),
                l = f[0].offsetWidth,
                m = f[0].offsetHeight;
            if (j) {
                var n = h,
                    o = this.getPosition(this.$viewport);
                h = "bottom" == h && k.bottom + m > o.bottom ? "top" : "top" == h && k.top - m < o.top ? "bottom" : "right" == h && k.right + l > o.width ? "left" : "left" == h && k.left - l < o.left ? "right" : h, f.removeClass(n).addClass(h)
            }
            var p = this.getCalculatedOffset(h, k, l, m);
            this.applyPlacement(p, h);
            var q = function() {
                var a = e.hoverState;
                e.$element.trigger("shown.bs." + e.type), e.hoverState = null, "out" == a && e.leave(e)
            };
            a.support.transition && this.$tip.hasClass("fade") ? f.one("bsTransitionEnd", q).emulateTransitionEnd(c.TRANSITION_DURATION) : q()
        }
    }, c.prototype.applyPlacement = function(b, c) {
        var d = this.tip(),
            e = d[0].offsetWidth,
            f = d[0].offsetHeight,
            g = parseInt(d.css("margin-top"), 10),
            h = parseInt(d.css("margin-left"), 10);
        isNaN(g) && (g = 0), isNaN(h) && (h = 0), b.top += g, b.left += h, a.offset.setOffset(d[0], a.extend({
            using: function(a) {
                d.css({
                    top: Math.round(a.top),
                    left: Math.round(a.left)
                })
            }
        }, b), 0), d.addClass("in");
        var i = d[0].offsetWidth,
            j = d[0].offsetHeight;
        "top" == c && j != f && (b.top = b.top + f - j);
        var k = this.getViewportAdjustedDelta(c, b, i, j);
        k.left ? b.left += k.left : b.top += k.top;
        var l = /top|bottom/.test(c),
            m = l ? 2 * k.left - e + i : 2 * k.top - f + j,
            n = l ? "offsetWidth" : "offsetHeight";
        d.offset(b), this.replaceArrow(m, d[0][n], l)
    }, c.prototype.replaceArrow = function(a, b, c) {
        this.arrow().css(c ? "left" : "top", 50 * (1 - a / b) + "%").css(c ? "top" : "left", "")
    }, c.prototype.setContent = function() {
        var a = this.tip(),
            b = this.getTitle();
        a.find(".tooltip-inner")[this.options.html ? "html" : "text"](b), a.removeClass("fade in top bottom left right")
    }, c.prototype.hide = function(b) {
        function d() {
            "in" != e.hoverState && f.detach(), e.$element.removeAttr("aria-describedby").trigger("hidden.bs." + e.type), b && b()
        }
        var e = this,
            f = a(this.$tip),
            g = a.Event("hide.bs." + this.type);
        if (this.$element.trigger(g), !g.isDefaultPrevented()) return f.removeClass("in"), a.support.transition && f.hasClass("fade") ? f.one("bsTransitionEnd", d).emulateTransitionEnd(c.TRANSITION_DURATION) : d(), this.hoverState = null, this
    }, c.prototype.fixTitle = function() {
        var a = this.$element;
        (a.attr("title") || "string" != typeof a.attr("data-original-title")) && a.attr("data-original-title", a.attr("title") || "").attr("title", "")
    }, c.prototype.hasContent = function() {
        return this.getTitle()
    }, c.prototype.getPosition = function(b) {
        b = b || this.$element;
        var c = b[0],
            d = "BODY" == c.tagName,
            e = c.getBoundingClientRect();
        null == e.width && (e = a.extend({}, e, {
            width: e.right - e.left,
            height: e.bottom - e.top
        }));
        var f = d ? {
                top: 0,
                left: 0
            } : b.offset(),
            g = {
                scroll: d ? document.documentElement.scrollTop || document.body.scrollTop : b.scrollTop()
            },
            h = d ? {
                width: a(window).width(),
                height: a(window).height()
            } : null;
        return a.extend({}, e, g, h, f)
    }, c.prototype.getCalculatedOffset = function(a, b, c, d) {
        return "bottom" == a ? {
            top: b.top + b.height,
            left: b.left + b.width / 2 - c / 2
        } : "top" == a ? {
            top: b.top - d,
            left: b.left + b.width / 2 - c / 2
        } : "left" == a ? {
            top: b.top + b.height / 2 - d / 2,
            left: b.left - c
        } : {
            top: b.top + b.height / 2 - d / 2,
            left: b.left + b.width
        }
    }, c.prototype.getViewportAdjustedDelta = function(a, b, c, d) {
        var e = {
            top: 0,
            left: 0
        };
        if (!this.$viewport) return e;
        var f = this.options.viewport && this.options.viewport.padding || 0,
            g = this.getPosition(this.$viewport);
        if (/right|left/.test(a)) {
            var h = b.top - f - g.scroll,
                i = b.top + f - g.scroll + d;
            h < g.top ? e.top = g.top - h : i > g.top + g.height && (e.top = g.top + g.height - i)
        } else {
            var j = b.left - f,
                k = b.left + f + c;
            j < g.left ? e.left = g.left - j : k > g.right && (e.left = g.left + g.width - k)
        }
        return e
    }, c.prototype.getTitle = function() {
        var a, b = this.$element,
            c = this.options;
        return a = b.attr("data-original-title") || ("function" == typeof c.title ? c.title.call(b[0]) : c.title)
    }, c.prototype.getUID = function(a) {
        do a += ~~(1e6 * Math.random()); while (document.getElementById(a));
        return a
    }, c.prototype.tip = function() {
        if (!this.$tip && (this.$tip = a(this.options.template), 1 != this.$tip.length)) throw new Error(this.type + " `template` option must consist of exactly 1 top-level element!");
        return this.$tip
    }, c.prototype.arrow = function() {
        return this.$arrow = this.$arrow || this.tip().find(".tooltip-arrow")
    }, c.prototype.enable = function() {
        this.enabled = !0
    }, c.prototype.disable = function() {
        this.enabled = !1
    }, c.prototype.toggleEnabled = function() {
        this.enabled = !this.enabled
    }, c.prototype.toggle = function(b) {
        var c = this;
        b && (c = a(b.currentTarget).data("bs." + this.type), c || (c = new this.constructor(b.currentTarget, this.getDelegateOptions()), a(b.currentTarget).data("bs." + this.type, c))), b ? (c.inState.click = !c.inState.click, c.isInStateTrue() ? c.enter(c) : c.leave(c)) : c.tip().hasClass("in") ? c.leave(c) : c.enter(c)
    }, c.prototype.destroy = function() {
        var a = this;
        clearTimeout(this.timeout), this.hide(function() {
            a.$element.off("." + a.type).removeData("bs." + a.type), a.$tip && a.$tip.detach(), a.$tip = null, a.$arrow = null, a.$viewport = null
        })
    };
    var d = a.fn.tooltip;
    a.fn.tooltip = b, a.fn.tooltip.Constructor = c, a.fn.tooltip.noConflict = function() {
        return a.fn.tooltip = d, this
    }
}(jQuery), + function(a) {
    "use strict";

    function b(b) {
        var c, d = b.attr("data-target") || (c = b.attr("href")) && c.replace(/.*(?=#[^\s]+$)/, "");
        return a(d)
    }

    function c(b) {
        return this.each(function() {
            var c = a(this),
                e = c.data("bs.collapse"),
                f = a.extend({}, d.DEFAULTS, c.data(), "object" == typeof b && b);
            !e && f.toggle && /show|hide/.test(b) && (f.toggle = !1), e || c.data("bs.collapse", e = new d(this, f)), "string" == typeof b && e[b]()
        })
    }
    var d = function(b, c) {
        this.$element = a(b), this.options = a.extend({}, d.DEFAULTS, c), this.$trigger = a('[data-toggle="collapse"][href="#' + b.id + '"],[data-toggle="collapse"][data-target="#' + b.id + '"]'), this.transitioning = null, this.options.parent ? this.$parent = this.getParent() : this.addAriaAndCollapsedClass(this.$element, this.$trigger), this.options.toggle && this.toggle()
    };
    d.VERSION = "3.3.6", d.TRANSITION_DURATION = 350, d.DEFAULTS = {
        toggle: !0
    }, d.prototype.dimension = function() {
        var a = this.$element.hasClass("width");
        return a ? "width" : "height"
    }, d.prototype.show = function() {
        if (!this.transitioning && !this.$element.hasClass("in")) {
            var b, e = this.$parent && this.$parent.children(".panel").children(".in, .collapsing");
            if (!(e && e.length && (b = e.data("bs.collapse"), b && b.transitioning))) {
                var f = a.Event("show.bs.collapse");
                if (this.$element.trigger(f), !f.isDefaultPrevented()) {
                    e && e.length && (c.call(e, "hide"), b || e.data("bs.collapse", null));
                    var g = this.dimension();
                    this.$element.removeClass("collapse").addClass("collapsing")[g](0).attr("aria-expanded", !0), this.$trigger.removeClass("collapsed").attr("aria-expanded", !0), this.transitioning = 1;
                    var h = function() {
                        this.$element.removeClass("collapsing").addClass("collapse in")[g](""), this.transitioning = 0, this.$element.trigger("shown.bs.collapse")
                    };
                    if (!a.support.transition) return h.call(this);
                    var i = a.camelCase(["scroll", g].join("-"));
                    this.$element.one("bsTransitionEnd", a.proxy(h, this)).emulateTransitionEnd(d.TRANSITION_DURATION)[g](this.$element[0][i])
                }
            }
        }
    }, d.prototype.hide = function() {
        if (!this.transitioning && this.$element.hasClass("in")) {
            var b = a.Event("hide.bs.collapse");
            if (this.$element.trigger(b), !b.isDefaultPrevented()) {
                var c = this.dimension();
                this.$element[c](this.$element[c]())[0].offsetHeight, this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded", !1), this.$trigger.addClass("collapsed").attr("aria-expanded", !1), this.transitioning = 1;
                var e = function() {
                    this.transitioning = 0, this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")
                };
                return a.support.transition ? void this.$element[c](0).one("bsTransitionEnd", a.proxy(e, this)).emulateTransitionEnd(d.TRANSITION_DURATION) : e.call(this)
            }
        }
    }, d.prototype.toggle = function() {
        this[this.$element.hasClass("in") ? "hide" : "show"]()
    }, d.prototype.getParent = function() {
        return a(this.options.parent).find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]').each(a.proxy(function(c, d) {
            var e = a(d);
            this.addAriaAndCollapsedClass(b(e), e)
        }, this)).end()
    }, d.prototype.addAriaAndCollapsedClass = function(a, b) {
        var c = a.hasClass("in");
        a.attr("aria-expanded", c), b.toggleClass("collapsed", !c).attr("aria-expanded", c)
    };
    var e = a.fn.collapse;
    a.fn.collapse = c, a.fn.collapse.Constructor = d, a.fn.collapse.noConflict = function() {
        return a.fn.collapse = e, this
    }, a(document).on("click.bs.collapse.data-api", '[data-toggle="collapse"]', function(d) {
        var e = a(this);
        e.attr("data-target") || d.preventDefault();
        var f = b(e),
            g = f.data("bs.collapse"),
            h = g ? "toggle" : e.data();
        c.call(f, h)
    })
}(jQuery), + function(a) {
    "use strict";

    function b() {
        var a = document.createElement("bootstrap"),
            b = {
                WebkitTransition: "webkitTransitionEnd",
                MozTransition: "transitionend",
                OTransition: "oTransitionEnd otransitionend",
                transition: "transitionend"
            };
        for (var c in b)
            if (void 0 !== a.style[c]) return {
                end: b[c]
            };
        return !1
    }
    a.fn.emulateTransitionEnd = function(b) {
        var c = !1,
            d = this;
        a(this).one("bsTransitionEnd", function() {
            c = !0
        });
        var e = function() {
            c || a(d).trigger(a.support.transition.end)
        };
        return setTimeout(e, b), this
    }, a(function() {
        a.support.transition = b(), a.support.transition && (a.event.special.bsTransitionEnd = {
            bindType: a.support.transition.end,
            delegateType: a.support.transition.end,
            handle: function(b) {
                if (a(b.target).is(this)) return b.handleObj.handler.apply(this, arguments)
            }
        })
    })
}(jQuery), define("bootstrap", function() {}), define("components/app/header/HeaderView", ["jquery", "underscore", "backbone", "bootstrap"], function(a, b, c) {
        var d = c.View.extend({
            events: {
                "click .home-link": "handleHomeLink",
                "click .modal-link": "handleModalLink",
                "click .page-link": "handlePageLink"
            },
            initialize: function() {
                this.listenTo(this.model, "change:activePage", this.handleActivePage)
            },
            render: function() {
                return this
            },
            handleHomeLink: function(b) {
                b.preventDefault(), this.$el.trigger("resetApp"), a("#navbar-collapse").collapse("hide")
            },
            handlePageLink: function(b) {
                b.preventDefault(), b.stopPropagation(), this.$el.trigger("pageLinkClick", {
                    target: b.target,
                    id: a(b.target).data("pageid")
                }), a("#navbar-collapse").collapse("hide")
            },
            handleModalLink: function(b) {
                b.preventDefault(), this.$el.trigger("modalOpen", {
                    target: b.target,
                    type: a(b.target).data("modaltype")
                }), a("#navbar-collapse").collapse("hide")
            },
            handleActivePage: function() {
                if (this.$(".page-link").removeClass("active"),
                    "undefined" != typeof this.model.getActivePage()) {
                    var a = "undefined" != typeof this.model.getActivePage().getParent() ? this.model.getActivePage().getParent() : this.model.getActivePage().id;
                    this.$('[data-pageid="' + a + '"]').addClass("active")
                }
            }
        });
        return d
    }), define("components/app/header/HeaderModel", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.Model.extend({
            initialize: function(a) {
                this.options = a || {}
            },
            setActivePath: function(a) {
                this.set("activePath", a)
            },
            setActivePage: function(a) {
                this.set("activePage", a)
            },
            getActivePage: function() {
                return this.attributes.activePage
            },
            getMode: function() {
                return this.attributes.mode
            }
        });
        return d
    }),
    function() {
        var a = ["Msxml2.XMLHTTP", "Microsoft.XMLHTTP", "Msxml2.XMLHTTP.4.0"],
            b = /^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,
            c = /<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,
            d = "undefined" != typeof location && location.href,
            e = d && location.protocol && location.protocol.replace(/\:/, ""),
            f = d && location.hostname,
            g = d && (location.port || void 0),
            h = [];
        define("text", [], function() {
            var i, j, k;
            return "undefined" != typeof window && window.navigator && window.document ? j = function(a, b) {
                var c = i.createXhr();
                c.open("GET", a, !0), c.onreadystatechange = function() {
                    4 === c.readyState && b(c.responseText)
                }, c.send(null)
            } : "undefined" != typeof process && process.versions && process.versions.node ? (k = require.nodeRequire("fs"), j = function(a, b) {
                b(k.readFileSync(a, "utf8"))
            }) : "undefined" != typeof Packages && (j = function(a, b) {
                var e, f, c = new java.io.File(a),
                    d = java.lang.System.getProperty("line.separator"),
                    c = new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(c), "utf-8")),
                    g = "";
                try {
                    for (e = new java.lang.StringBuffer, (f = c.readLine()) && f.length() && 65279 === f.charAt(0) && (f = f.substring(1)), e.append(f); null !== (f = c.readLine());) e.append(d), e.append(f);
                    g = String(e.toString())
                } finally {
                    c.close()
                }
                b(g)
            }), i = {
                version: "0.27.0",
                strip: function(a) {
                    if (a) {
                        var a = a.replace(b, ""),
                            d = a.match(c);
                        d && (a = d[1])
                    } else a = "";
                    return a
                },
                jsEscape: function(a) {
                    return a.replace(/(['\\])/g, "\\$1").replace(/[\f]/g, "\\f").replace(/[\b]/g, "\\b").replace(/[\n]/g, "\\n").replace(/[\t]/g, "\\t").replace(/[\r]/g, "\\r")
                },
                createXhr: function() {
                    var b, c, d;
                    if ("undefined" != typeof XMLHttpRequest) return new XMLHttpRequest;
                    for (c = 0; c < 3; c++) {
                        d = a[c];
                        try {
                            b = new ActiveXObject(d)
                        } catch (a) {}
                        if (b) {
                            a = [d];
                            break
                        }
                    }
                    if (!b) throw Error("createXhr(): XMLHttpRequest not available");
                    return b
                },
                get: j,
                parseName: function(a) {
                    var b = !1,
                        c = a.indexOf("."),
                        d = a.substring(0, c),
                        a = a.substring(c + 1, a.length),
                        c = a.indexOf("!");
                    return c !== -1 && (b = a.substring(c + 1, a.length), b = "strip" === b, a = a.substring(0, c)), {
                        moduleName: d,
                        ext: a,
                        strip: b
                    }
                },
                xdRegExp: /^((\w+)\:)?\/\/([^\/\\]+)/,
                useXhr: function(a, b, c, d) {
                    var f, e = i.xdRegExp.exec(a);
                    return !e || (a = e[2], e = e[3], e = e.split(":"), f = e[1], e = e[0], !(a && a !== b || e && e !== c || (f || e) && f !== d))
                },
                finishLoad: function(a, b, c, d, e) {
                    c = b ? i.strip(c) : c, e.isBuild && e.inlineText && (h[a] = c), d(c)
                },
                load: function(a, b, c, h) {
                    var j = i.parseName(a),
                        k = j.moduleName + "." + j.ext,
                        l = b.toUrl(k),
                        m = h && h.text && h.text.useXhr || i.useXhr;
                    !d || m(l, e, f, g) ? i.get(l, function(b) {
                        i.finishLoad(a, j.strip, b, c, h)
                    }) : b([k], function(a) {
                        i.finishLoad(j.moduleName + "." + j.ext, j.strip, a, c, h)
                    })
                },
                write: function(a, b, c) {
                    if (b in h) {
                        var d = i.jsEscape(h[b]);
                        c.asModule(a + "!" + b, "define(function () { return '" + d + "';});\n")
                    }
                },
                writeFile: function(a, b, c, d, e) {
                    var b = i.parseName(b),
                        f = b.moduleName + "." + b.ext,
                        g = c.toUrl(b.moduleName + "." + b.ext) + ".js";
                    i.load(f, c, function() {
                        var b = function(a) {
                            return d(g, a)
                        };
                        b.asModule = function(a, b) {
                            return d.asModule(a, g, b)
                        }, i.write(a, f, b, e)
                    }, e)
                }
            }
        })
    }(), define("text!components/app/key/mapKeyTemplate.html", [], function() {
        return '<% if (layerKeys.length > 0) {%>\r\n<div class="map-key">\r\n  <div class="map-key-label">\r\n  <%= t.ux.map.map_key %>\r\n  </div>\r\n  <div class="scroll-cover">\r\n    <a class="scroll-up reveal-on-hover" href="#">      \r\n      <span class="icon-wwf_scroll-up hide-on-hover"></span>      \r\n      <span class="icon-wwf_scroll-up-hover show-on-hover  show-on-hover-inline"></span>            \r\n    </a>\r\n    <ul class="map-key-layer-list list-unstyled scroll-scroller  <%= preventLayerToggle ? \'prevent-layer-toggle\' : \'\' %>">\r\n      <% _.each(layerKeys, function(layerKey){ %>\r\n      <li class="map-key-layer-list-item reveal-on-hover">\r\n        <%= layerKey %>\r\n      </li>  \r\n      <% }) %>\r\n    </ul>\r\n    <a class="scroll-down reveal-on-hover" href="#">      \r\n      <span class="icon-wwf_scroll-down hide-on-hover"></span>      \r\n      <span class="icon-wwf_scroll-down-hover show-on-hover show-on-hover-inline"></span>      \r\n    </a>\r\n  </div>\r\n</div>\r\n<% } %>\r\n'
    }), define("text!components/app/key/layerKeyFullTemplate.html", [], function() {
        return '<%= keyHtml %> \r\n<div class="show-on-hover layer-key-panel arrow_box_right key-layer-<%= id %> panel-white">\r\n  <table class="table-layer-select"><tbody>\r\n    <tr class="layer-key-main">\r\n      <td class="toggle">\r\n        <a href="#" class="icon-wwf_tick toggle-layer <%= isActive ? \'active\' : \'\' %>"\r\n           data-toggable="<%= toggable %>"              \r\n           data-layerid="<%= id %>">\r\n        </a>             \r\n      </td>\r\n      <td class="title">\r\n        <a href="#" class="toggle-layer <%= isActive ? \'active\' : \'\' %> " \r\n           data-toggable="<%= toggable %>"\r\n           data-layerid="<%= id %>">\r\n          <div class="title-inner"><%= title %></div>\r\n        </a>\r\n        <% if(hint !== \'\') { %>\r\n        <div class="hint">\r\n          <%= hint %>\r\n        </div>\r\n        <% } %>           \r\n      </td>\r\n     </tr>\r\n    <% if (layerGradient) { %>\r\n    <tr class="layer-color-gradient">\r\n      <td></td>\r\n      <td colspan="2">\r\n        <%= layerGradient %> \r\n      </td>      \r\n    </tr>\r\n    <% } %>\r\n    <% if (layerCategories) { %>\r\n    <tr class="layer-color-groups">\r\n      <td></td>\r\n      <td>\r\n        <ul class="list-unstyled">\r\n        <% _.each(layerCategories, function(cat){ %>\r\n          <li>\r\n            <%= cat.color %>            \r\n            <%= cat.label %>\r\n          </li>          \r\n        <% }) %>\r\n        </ul>\r\n      </td>\r\n      <td></td>\r\n    </tr>    \r\n    <% } %>    \r\n    </tbody>\r\n  </table>\r\n</div>\r\n'
    }), define("components/app/key/KeyView", ["jquery", "underscore", "backbone", "text!./mapKeyTemplate.html", "text!./layerKeyFullTemplate.html"], function(a, b, c, d, e) {
        var f = c.View.extend({
            events: {
                "click .layer-info-link": "handleLayerInfoLink",
                "click .toggle-layer": "toggleLayer",
                "click .scroll-up": "scrollUp",
                "click .scroll-down": "scrollDown",
                "click .edit-layer": "handleLayerEdit"
            },
            initialize: function() {
                this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:activeLayers", this.handleLayerUpdate), this.listenTo(this.model, "change:customLayerData", this.handleLayerUpdate), a(window).on("resize", b.debounce(b.bind(this.resize, this), 100))
            },
            render: function() {
                return this.setupScroll(), this.populateKey(), this
            },
            resize: function() {
                this.setupScroll(), this.scrollToTop()
            },
            handleLayerInfoLink: function(b) {
                b.preventDefault(), this.$el.trigger("layerInfoLinkClick", {
                    target: b.target,
                    id: a(b.target).data("layerid")
                })
            },
            toggleLayer: function(b) {
                b.preventDefault(), b.stopPropagation(), this.model.getAllowLayerToggle() && (a(b.currentTarget).data("toggable") || "true" === a(b.currentTarget).data("toggable")) && this.$el.trigger("layerToggled", {
                    id: a(b.currentTarget).data("layerid")
                })
            },
            handleLayerEdit: function(b) {
                b.preventDefault(), this.$el.trigger("editCustomLayer", {
                    id: a(b.target).data("layerid")
                })
            },
            handleActive: function() {
                this.model.isActive() ? this.$el.show() : this.$el.hide()
            },
            handleLayerUpdate: function() {
                this.model.getActiveLayers().length > 0 ? (this.$el.show(), this.render()) : this.$el.hide()
            },
            populateKey: function() {
                var a = this;
                this.$el.html(b.template(d)({
                    preventLayerToggle: !this.model.getAllowLayerToggle(),
                    layerKeys: b.map(this.model.getActiveLayers(), function(c) {
                        return b.template(e)({
                            preventLayerToggle: !a.model.getAllowLayerToggle(),
                            id: c.id,
                            title: c.getTitle(),
                            hint: c.getHint(),
                            toggable: !c.isBasemap(),
                            layerGradient: c.makeLayerGradientKey(),
                            layerCategories: c.makeLayerCategoriesKey(),
                            isActive: c.isActive() || c.isBasemap(),
                            isCustom: c.isCustom(),
                            keyHtml: c.getKeySquareIcon("lg"),
                            lang: lang,
                            t: tlang
                        })
                    }),
                    t: tlang
                })), b.each(this.model.getAddLayers(), function(a) {
                    if (!a.isBasemap()) {
                        var b = this.$(".key-layer-" + a.id);
                        b.addClass("show-hover"), setTimeout(function() {
                            b.removeClass("show-hover")
                        }, 2e3)
                    }
                }, this), this.setupScroll(), this.updateScroll()
            },
            getKeyAvailableHeight: function() {
                return a("#map").outerHeight() - this.$el.offset().top - parseInt(this.$el.css("bottom").replace("px", ""))
            },
            setupScroll: function() {
                this.scroller = {
                    cover: this.$(".scroll-cover"),
                    inner: this.$(".scroll-scroller"),
                    neededh: this.$(".scroll-scroller").outerHeight(),
                    availh: this.getKeyAvailableHeight()
                }
            },
            updateScroll: function() {
                var a = this.$(".map-key-label").outerHeight();
                this.scroller.cover.css("max-height", this.scroller.availh - a);
                var b = this.scroller.neededh - (this.scroller.availh - a);
                if (b > 0) {
                    this.scroller.cover.addClass("scrolling");
                    var c = -parseInt(this.scroller.inner.css("top"), 10);
                    c === b ? this.scroller.cover.addClass("scrolled-bottom") : this.scroller.cover.removeClass("scrolled-bottom"), c > 0 ? this.scroller.cover.addClass("scrolled") : this.scroller.cover.removeClass("scrolled")
                } else this.scroller.cover.removeClass("scrolling");
                this.offsetInfoPanel()
            },
            scrollDown: function(a) {
                a.preventDefault();
                var b = this.$(".map-key-label").outerHeight(),
                    c = this.scroller.neededh - (this.scroller.availh - b),
                    d = -parseInt(this.scroller.inner.css("top"), 10);
                if (d < c) {
                    var e = d + Math.min(.8 * this.scroller.availh, c - d),
                        f = this;
                    this.scroller.inner.animate({
                        top: -e
                    }, {
                        duration: 800,
                        step: function() {
                            f.hideOverFlow()
                        },
                        complete: function() {
                            f.updateScroll()
                        }
                    })
                }
            },
            scrollUp: function(a) {
                a.preventDefault();
                var b = this.$(".map-key-label").outerHeight(),
                    c = -parseInt(this.scroller.inner.css("top"), 10);
                if (c > 0) {
                    var d = c - Math.min(.8 * (this.scroller.availh - b), c),
                        e = this;
                    this.scroller.inner.animate({
                        top: -d
                    }, {
                        duration: 800,
                        step: function() {
                            e.hideOverFlow()
                        },
                        complete: function() {
                            e.updateScroll()
                        }
                    })
                }
            },
            scrollToTop: function(a) {
                var b = this;
                this.scroller.inner.animate({
                    top: 0
                }, {
                    duration: 100,
                    step: function() {
                        b.hideOverFlow()
                    },
                    complete: function() {
                        b.updateScroll()
                    }
                })
            },
            hideOverFlow: function() {
                var b = 10,
                    c = this.$el.offset().top,
                    d = this.$el.outerHeight() + this.$el.offset().top;
                this.$(".map-key-layer-list-item").each(function() {
                    var e = a(this).offset().top,
                        f = a(this).offset().top + a(this).outerHeight();
                    c + b > e || d - b < f ? a(this).addClass("invisible") : a(this).removeClass("invisible")
                })
            },
            offsetInfoPanel: function() {
                this.$(".map-key-layer-list-item").each(function() {
                    var b = a(this).find(".layer-key-panel").outerHeight(),
                        c = a(this).outerHeight(),
                        d = window.innerHeight - a(this).offset().top;
                    c < b && d > 0 && d < (b - c) / 2 && a(this).find(".layer-key-panel").addClass("align-bottom")
                })
            }
        });
        return f
    }), define("components/app/key/KeyModel", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.Model.extend({
            initialize: function(a) {
                this.options = a || {}, this.set("activeLayers", []), this.set("addLayers", [])
            },
            setActiveLayers: function(a) {
                this.set("addLayers", b.difference(a, this.attributes.activeLayers)), this.set("activeLayers", a)
            },
            setAllowLayerToggle: function(a) {
                this.set("allowLayerToggle", a)
            },
            setCustomLayerData: function(a) {
                this.set("customLayerData", a)
            },
            getAllowLayerToggle: function() {
                return this.attributes.allowLayerToggle
            },
            getActiveLayers: function() {
                return this.attributes.activeLayers
            },
            getAddLayers: function() {
                return this.attributes.addLayers
            },
            setActive: function(a) {
                a = "undefined" == typeof a || a, this.set("active", a)
            },
            isActive: function() {
                return this.get("active")
            }
        });
        return d
    }), define("text!components/app/print/printTemplate.html", [], function() {
        return '<div class="print-header">\r\n  <span class="print-header-note ocean-color"><%= t.ux.print.header_note_url %></span>\r\n  <span class="print-header-url ocean-color-dark"><%= custom_url %></span>\r\n</div>\r\n<div class="print-key container-fluid">PRINT KEY HERE </div>\r\n<div class="print-footer">\r\n  <span class="print-footer-note-origin ocean-color"><%= t.ux.print.footer_note_origin %></span>\r\n  <span class="print-header-url ocean-color-dark"><%= url %>. </span>\r\n  <span class="print-footer-note-usage ocean-color"><%= t.ux.print.footer_note_further_use %> </span>\r\n  <span class="print-footer-note-usage ocean-color"><%= t.ux.print.footer_note_map_creator %></span>\r\n</div>\r\n'
    }), define("text!components/app/print/printKeyTemplate.html", [], function() {
        return '<% if (layerChunks.length > 0) {%>\r\n  <% _.each(layerChunks, function(layers){ %>\r\n    <div class="print-key-layer-list row">      \r\n      <% _.each(layers, function(layer){ %>\r\n      <div class="print-key-layer-list-item col-xs-2">        \r\n        <%= layer.keyFullHtml %>\r\n      </div>  \r\n      <% }) %>\r\n    </div>\r\n  <% }) %>\r\n<% } %>'
    }), define("text!components/app/print/printLayerKeyTemplate.html", [], function() {
        return '<div class="layer-key-panel key-layer-<%= id %>">\r\n  <div class="print-key-layer-list-item-top">\r\n    <table class="table-layer-select"><tbody>\r\n      <tr class="layer-key-main">\r\n        <td class="key">\r\n          <%= keyHtml %>\r\n        </td>\r\n        <td class="title">\r\n          <div class="title-inner"><%= title %></div>\r\n          <% if(hint !== \'\') { %>\r\n          <div class="hint">\r\n            <%= hint %>\r\n          </div>\r\n          <% } %>            \r\n        </td>      \r\n      </tr>\r\n        <% if (layerGradient) { %>\r\n        <tr class="layer-color-gradient">\r\n          <td colspan="2">\r\n            <%= layerGradient %> \r\n          </td>      \r\n        </tr>\r\n        <% } %>\r\n        <% if (layerCategories) { %>\r\n        <tr class="layer-color-groups">\r\n          <td colspan="2">\r\n            <ul class="list-unstyled">\r\n            <% _.each(layerCategories, function(cat){ %>\r\n              <li>\r\n                <%= cat.color %>            \r\n                <%= cat.label %>\r\n              </li>          \r\n            <% }) %>\r\n            </ul>\r\n          </td>\r\n        </tr>\r\n        <% } %>      \r\n      </tbody>\r\n    </table>\r\n  </div>\r\n  <div class="print-key-layer-list-item-bottom">\r\n    <div class="print-key-layer-list-item-reference"><%= reference %></div>\r\n  </div>\r\n</div>'
    }), define("components/app/print/PrintView", ["jquery", "underscore", "backbone", "text!./printTemplate.html", "text!./printKeyTemplate.html", "text!./printLayerKeyTemplate.html"], function(a, b, c, d, e, f) {
        var g = c.View.extend({
            initialize: function() {
                this.render()
            },
            render: function() {
                var a, c, f = this.model.getMapId();
                return a = "en" === lang ? window.location.host : window.location.host + "/" + lang, c = {
                    t: tlang,
                    custom_url: a + "/#!/id/" + f,
                    url: a
                }, this.$el.html(b.template(d)(c)), this.populateKey(), this
            },
            populateKey: function() {
                this.$(".print-key").html(b.template(e)({
                    layerChunks: this.chunk(b.map(this.model.getActiveLayers(), function(a) {
                        return a.keyFullHtml = b.template(f)({
                            id: a.id,
                            title: a.getTitle(),
                            hint: a.getHint(),
                            layerGradient: a.makeLayerGradientKey(),
                            layerCategories: a.makeLayerCategoriesKey(),
                            keyHtml: a.getKeySquareIcon("lg"),
                            reference: a.getReference(!0),
                            lang: lang,
                            t: tlang
                        }), a
                    }), 6).reverse(),
                    t: tlang
                }))
            },
            chunk: function(a, b) {
                return a.reduce(function(a, c, d) {
                    return d % b === 0 && a.push([]), a[a.length - 1].push(c), a
                }, [])
            }
        });
        return g
    }), define("components/app/print/PrintModel", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.Model.extend({
            initialize: function(a) {
                this.options = a || {}
            },
            getActiveLayers: function() {
                return this.attributes.activeLayers
            },
            getMapId: function() {
                return this.attributes.mapid
            }
        });
        return d
    }),
    function(a, b, c) {
        var d = a.L,
            e = {};
        e.version = "0.7.7", "object" == typeof module && "object" == typeof module.exports ? module.exports = e : "function" == typeof define && define.amd && define("leaflet", e), e.noConflict = function() {
                return a.L = d, this
            }, a.L = e, e.Util = {
                extend: function(a) {
                    var c, d, e, f, b = Array.prototype.slice.call(arguments, 1);
                    for (d = 0, e = b.length; d < e; d++) {
                        f = b[d] || {};
                        for (c in f) f.hasOwnProperty(c) && (a[c] = f[c])
                    }
                    return a
                },
                bind: function(a, b) {
                    var c = arguments.length > 2 ? Array.prototype.slice.call(arguments, 2) : null;
                    return function() {
                        return a.apply(b, c || arguments)
                    }
                },
                stamp: function() {
                    var a = 0,
                        b = "_leaflet_id";
                    return function(c) {
                        return c[b] = c[b] || ++a, c[b]
                    }
                }(),
                invokeEach: function(a, b, c) {
                    var d, e;
                    if ("object" == typeof a) {
                        e = Array.prototype.slice.call(arguments, 3);
                        for (d in a) b.apply(c, [d, a[d]].concat(e));
                        return !0
                    }
                    return !1
                },
                limitExecByInterval: function(a, b, c) {
                    var d, e;
                    return function f() {
                        var g = arguments;
                        return d ? void(e = !0) : (d = !0, setTimeout(function() {
                            d = !1, e && (f.apply(c, g), e = !1)
                        }, b), a.apply(c, g), void 0)
                    }
                },
                falseFn: function() {
                    return !1
                },
                formatNum: function(a, b) {
                    var c = Math.pow(10, b || 5);
                    return Math.round(a * c) / c
                },
                trim: function(a) {
                    return a.trim ? a.trim() : a.replace(/^\s+|\s+$/g, "")
                },
                splitWords: function(a) {
                    return e.Util.trim(a).split(/\s+/)
                },
                setOptions: function(a, b) {
                    return a.options = e.extend({}, a.options, b), a.options
                },
                getParamString: function(a, b, c) {
                    var d = [];
                    for (var e in a) d.push(encodeURIComponent(c ? e.toUpperCase() : e) + "=" + encodeURIComponent(a[e]));
                    return (b && b.indexOf("?") !== -1 ? "&" : "?") + d.join("&")
                },
                template: function(a, b) {
                    return a.replace(/\{ *([\w_]+) *\}/g, function(a, d) {
                        var e = b[d];
                        if (e === c) throw new Error("No value provided for variable " + a);
                        return "function" == typeof e && (e = e(b)), e
                    })
                },
                isArray: Array.isArray || function(a) {
                    return "[object Array]" === Object.prototype.toString.call(a)
                },
                emptyImageUrl: "data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="
            },
            function() {
                function b(b) {
                    var c, d, e = ["webkit", "moz", "o", "ms"];
                    for (c = 0; c < e.length && !d; c++) d = a[e[c] + b];
                    return d
                }

                function c(b) {
                    var c = +new Date,
                        e = Math.max(0, 16 - (c - d));
                    return d = c + e, a.setTimeout(b, e)
                }
                var d = 0,
                    f = a.requestAnimationFrame || b("RequestAnimationFrame") || c,
                    g = a.cancelAnimationFrame || b("CancelAnimationFrame") || b("CancelRequestAnimationFrame") || function(b) {
                        a.clearTimeout(b)
                    };
                e.Util.requestAnimFrame = function(b, d, g, h) {
                    return b = e.bind(b, d), g && f === c ? void b() : f.call(a, b, h)
                }, e.Util.cancelAnimFrame = function(b) {
                    b && g.call(a, b)
                }
            }(), e.extend = e.Util.extend, e.bind = e.Util.bind, e.stamp = e.Util.stamp, e.setOptions = e.Util.setOptions, e.Class = function() {}, e.Class.extend = function(a) {
                var b = function() {
                        this.initialize && this.initialize.apply(this, arguments), this._initHooks && this.callInitHooks()
                    },
                    c = function() {};
                c.prototype = this.prototype;
                var d = new c;
                d.constructor = b, b.prototype = d;
                for (var f in this) this.hasOwnProperty(f) && "prototype" !== f && (b[f] = this[f]);
                a.statics && (e.extend(b, a.statics), delete a.statics), a.includes && (e.Util.extend.apply(null, [d].concat(a.includes)), delete a.includes), a.options && d.options && (a.options = e.extend({}, d.options, a.options)), e.extend(d, a), d._initHooks = [];
                var g = this;
                return b.__super__ = g.prototype, d.callInitHooks = function() {
                    if (!this._initHooksCalled) {
                        g.prototype.callInitHooks && g.prototype.callInitHooks.call(this), this._initHooksCalled = !0;
                        for (var a = 0, b = d._initHooks.length; a < b; a++) d._initHooks[a].call(this)
                    }
                }, b
            }, e.Class.include = function(a) {
                e.extend(this.prototype, a)
            }, e.Class.mergeOptions = function(a) {
                e.extend(this.prototype.options, a)
            }, e.Class.addInitHook = function(a) {
                var b = Array.prototype.slice.call(arguments, 1),
                    c = "function" == typeof a ? a : function() {
                        this[a].apply(this, b)
                    };
                this.prototype._initHooks = this.prototype._initHooks || [], this.prototype._initHooks.push(c)
            };
        var f = "_leaflet_events";
        e.Mixin = {}, e.Mixin.Events = {
                addEventListener: function(a, b, c) {
                    if (e.Util.invokeEach(a, this.addEventListener, this, b, c)) return this;
                    var h, i, j, k, l, m, n, d = this[f] = this[f] || {},
                        g = c && c !== this && e.stamp(c);
                    for (a = e.Util.splitWords(a), h = 0, i = a.length; h < i; h++) j = {
                        action: b,
                        context: c || this
                    }, k = a[h], g ? (l = k + "_idx", m = l + "_len", n = d[l] = d[l] || {}, n[g] || (n[g] = [], d[m] = (d[m] || 0) + 1), n[g].push(j)) : (d[k] = d[k] || [], d[k].push(j));
                    return this
                },
                hasEventListeners: function(a) {
                    var b = this[f];
                    return !!b && (a in b && b[a].length > 0 || a + "_idx" in b && b[a + "_idx_len"] > 0)
                },
                removeEventListener: function(a, b, c) {
                    if (!this[f]) return this;
                    if (!a) return this.clearAllEventListeners();
                    if (e.Util.invokeEach(a, this.removeEventListener, this, b, c)) return this;
                    var h, i, j, k, l, m, n, o, p, d = this[f],
                        g = c && c !== this && e.stamp(c);
                    for (a = e.Util.splitWords(a), h = 0, i = a.length; h < i; h++)
                        if (j = a[h], m = j + "_idx", n = m + "_len", o = d[m], b) {
                            if (k = g && o ? o[g] : d[j]) {
                                for (l = k.length - 1; l >= 0; l--) k[l].action === b && (!c || k[l].context === c) && (p = k.splice(l, 1), p[0].action = e.Util.falseFn);
                                c && o && 0 === k.length && (delete o[g], d[n]--)
                            }
                        } else delete d[j], delete d[m], delete d[n];
                    return this
                },
                clearAllEventListeners: function() {
                    return delete this[f], this
                },
                fireEvent: function(a, b) {
                    if (!this.hasEventListeners(a)) return this;
                    var g, h, i, j, k, c = e.Util.extend({}, b, {
                            type: a,
                            target: this
                        }),
                        d = this[f];
                    if (d[a])
                        for (g = d[a].slice(), h = 0, i = g.length; h < i; h++) g[h].action.call(g[h].context, c);
                    j = d[a + "_idx"];
                    for (k in j)
                        if (g = j[k].slice())
                            for (h = 0, i = g.length; h < i; h++) g[h].action.call(g[h].context, c);
                    return this
                },
                addOneTimeEventListener: function(a, b, c) {
                    if (e.Util.invokeEach(a, this.addOneTimeEventListener, this, b, c)) return this;
                    var d = e.bind(function() {
                        this.removeEventListener(a, b, c).removeEventListener(a, d, c)
                    }, this);
                    return this.addEventListener(a, b, c).addEventListener(a, d, c)
                }
            }, e.Mixin.Events.on = e.Mixin.Events.addEventListener, e.Mixin.Events.off = e.Mixin.Events.removeEventListener, e.Mixin.Events.once = e.Mixin.Events.addOneTimeEventListener, e.Mixin.Events.fire = e.Mixin.Events.fireEvent,
            function() {
                var d = "ActiveXObject" in a,
                    f = d && !b.addEventListener,
                    g = navigator.userAgent.toLowerCase(),
                    h = g.indexOf("webkit") !== -1,
                    i = g.indexOf("chrome") !== -1,
                    j = g.indexOf("phantom") !== -1,
                    k = g.indexOf("android") !== -1,
                    l = g.search("android [23]") !== -1,
                    m = g.indexOf("gecko") !== -1,
                    n = typeof orientation != c + "",
                    o = !a.PointerEvent && a.MSPointerEvent,
                    p = a.PointerEvent && a.navigator.pointerEnabled || o,
                    q = "devicePixelRatio" in a && a.devicePixelRatio > 1 || "matchMedia" in a && a.matchMedia("(min-resolution:144dpi)") && a.matchMedia("(min-resolution:144dpi)").matches,
                    r = b.documentElement,
                    s = d && "transition" in r.style,
                    t = "WebKitCSSMatrix" in a && "m11" in new a.WebKitCSSMatrix && !l,
                    u = "MozPerspective" in r.style,
                    v = "OTransition" in r.style,
                    w = !a.L_DISABLE_3D && (s || t || u || v) && !j,
                    x = !a.L_NO_TOUCH && !j && (p || "ontouchstart" in a || a.DocumentTouch && b instanceof a.DocumentTouch);
                e.Browser = {
                    ie: d,
                    ielt9: f,
                    webkit: h,
                    gecko: m && !h && !a.opera && !d,
                    android: k,
                    android23: l,
                    chrome: i,
                    ie3d: s,
                    webkit3d: t,
                    gecko3d: u,
                    opera3d: v,
                    any3d: w,
                    mobile: n,
                    mobileWebkit: n && h,
                    mobileWebkit3d: n && t,
                    mobileOpera: n && a.opera,
                    touch: x,
                    msPointer: o,
                    pointer: p,
                    retina: q
                }
            }(), e.Point = function(a, b, c) {
                this.x = c ? Math.round(a) : a, this.y = c ? Math.round(b) : b
            }, e.Point.prototype = {
                clone: function() {
                    return new e.Point(this.x, this.y)
                },
                add: function(a) {
                    return this.clone()._add(e.point(a))
                },
                _add: function(a) {
                    return this.x += a.x, this.y += a.y, this
                },
                subtract: function(a) {
                    return this.clone()._subtract(e.point(a))
                },
                _subtract: function(a) {
                    return this.x -= a.x, this.y -= a.y, this
                },
                divideBy: function(a) {
                    return this.clone()._divideBy(a)
                },
                _divideBy: function(a) {
                    return this.x /= a, this.y /= a, this
                },
                multiplyBy: function(a) {
                    return this.clone()._multiplyBy(a)
                },
                _multiplyBy: function(a) {
                    return this.x *= a, this.y *= a, this
                },
                round: function() {
                    return this.clone()._round()
                },
                _round: function() {
                    return this.x = Math.round(this.x), this.y = Math.round(this.y), this
                },
                floor: function() {
                    return this.clone()._floor()
                },
                _floor: function() {
                    return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this
                },
                distanceTo: function(a) {
                    a = e.point(a);
                    var b = a.x - this.x,
                        c = a.y - this.y;
                    return Math.sqrt(b * b + c * c)
                },
                equals: function(a) {
                    return a = e.point(a), a.x === this.x && a.y === this.y
                },
                contains: function(a) {
                    return a = e.point(a), Math.abs(a.x) <= Math.abs(this.x) && Math.abs(a.y) <= Math.abs(this.y)
                },
                toString: function() {
                    return "Point(" + e.Util.formatNum(this.x) + ", " + e.Util.formatNum(this.y) + ")"
                }
            }, e.point = function(a, b, d) {
                return a instanceof e.Point ? a : e.Util.isArray(a) ? new e.Point(a[0], a[1]) : a === c || null === a ? a : new e.Point(a, b, d)
            }, e.Bounds = function(a, b) {
                if (a)
                    for (var c = b ? [a, b] : a, d = 0, e = c.length; d < e; d++) this.extend(c[d])
            }, e.Bounds.prototype = {
                extend: function(a) {
                    return a = e.point(a), this.min || this.max ? (this.min.x = Math.min(a.x, this.min.x), this.max.x = Math.max(a.x, this.max.x), this.min.y = Math.min(a.y, this.min.y), this.max.y = Math.max(a.y, this.max.y)) : (this.min = a.clone(), this.max = a.clone()), this
                },
                getCenter: function(a) {
                    return new e.Point((this.min.x + this.max.x) / 2, (this.min.y + this.max.y) / 2, a)
                },
                getBottomLeft: function() {
                    return new e.Point(this.min.x, this.max.y)
                },
                getTopRight: function() {
                    return new e.Point(this.max.x, this.min.y)
                },
                getSize: function() {
                    return this.max.subtract(this.min)
                },
                contains: function(a) {
                    var b, c;
                    return a = "number" == typeof a[0] || a instanceof e.Point ? e.point(a) : e.bounds(a), a instanceof e.Bounds ? (b = a.min, c = a.max) : b = c = a, b.x >= this.min.x && c.x <= this.max.x && b.y >= this.min.y && c.y <= this.max.y
                },
                intersects: function(a) {
                    a = e.bounds(a);
                    var b = this.min,
                        c = this.max,
                        d = a.min,
                        f = a.max,
                        g = f.x >= b.x && d.x <= c.x,
                        h = f.y >= b.y && d.y <= c.y;
                    return g && h
                },
                isValid: function() {
                    return !!this.min && !!this.max
                }
            }, e.bounds = function(a, b) {
                return !a || a instanceof e.Bounds ? a : new e.Bounds(a, b)
            }, e.Transformation = function(a, b, c, d) {
                this._a = a, this._b = b, this._c = c, this._d = d
            }, e.Transformation.prototype = {
                transform: function(a, b) {
                    return this._transform(a.clone(), b)
                },
                _transform: function(a, b) {
                    return b = b || 1, a.x = b * (this._a * a.x + this._b), a.y = b * (this._c * a.y + this._d), a
                },
                untransform: function(a, b) {
                    return b = b || 1, new e.Point((a.x / b - this._b) / this._a, (a.y / b - this._d) / this._c)
                }
            }, e.DomUtil = {
                get: function(a) {
                    return "string" == typeof a ? b.getElementById(a) : a
                },
                getStyle: function(a, c) {
                    var d = a.style[c];
                    if (!d && a.currentStyle && (d = a.currentStyle[c]), (!d || "auto" === d) && b.defaultView) {
                        var e = b.defaultView.getComputedStyle(a, null);
                        d = e ? e[c] : null
                    }
                    return "auto" === d ? null : d
                },
                getViewportOffset: function(a) {
                    var i, c = 0,
                        d = 0,
                        f = a,
                        g = b.body,
                        h = b.documentElement;
                    do {
                        if (c += f.offsetTop || 0, d += f.offsetLeft || 0, c += parseInt(e.DomUtil.getStyle(f, "borderTopWidth"), 10) || 0, d += parseInt(e.DomUtil.getStyle(f, "borderLeftWidth"), 10) || 0, i = e.DomUtil.getStyle(f, "position"), f.offsetParent === g && "absolute" === i) break;
                        if ("fixed" === i) {
                            c += g.scrollTop || h.scrollTop || 0, d += g.scrollLeft || h.scrollLeft || 0;
                            break
                        }
                        if ("relative" === i && !f.offsetLeft) {
                            var j = e.DomUtil.getStyle(f, "width"),
                                k = e.DomUtil.getStyle(f, "max-width"),
                                l = f.getBoundingClientRect();
                            "none" === j && "none" === k || (d += l.left + f.clientLeft), c += l.top + (g.scrollTop || h.scrollTop || 0);
                            break
                        }
                        f = f.offsetParent
                    } while (f);
                    f = a;
                    do {
                        if (f === g) break;
                        c -= f.scrollTop || 0, d -= f.scrollLeft || 0, f = f.parentNode
                    } while (f);
                    return new e.Point(d, c)
                },
                documentIsLtr: function() {
                    return e.DomUtil._docIsLtrCached || (e.DomUtil._docIsLtrCached = !0, e.DomUtil._docIsLtr = "ltr" === e.DomUtil.getStyle(b.body, "direction")), e.DomUtil._docIsLtr
                },
                create: function(a, c, d) {
                    var e = b.createElement(a);
                    return e.className = c, d && d.appendChild(e), e
                },
                hasClass: function(a, b) {
                    if (a.classList !== c) return a.classList.contains(b);
                    var d = e.DomUtil._getClass(a);
                    return d.length > 0 && new RegExp("(^|\\s)" + b + "(\\s|$)").test(d)
                },
                addClass: function(a, b) {
                    if (a.classList !== c)
                        for (var d = e.Util.splitWords(b), f = 0, g = d.length; f < g; f++) a.classList.add(d[f]);
                    else if (!e.DomUtil.hasClass(a, b)) {
                        var h = e.DomUtil._getClass(a);
                        e.DomUtil._setClass(a, (h ? h + " " : "") + b)
                    }
                },
                removeClass: function(a, b) {
                    a.classList !== c ? a.classList.remove(b) : e.DomUtil._setClass(a, e.Util.trim((" " + e.DomUtil._getClass(a) + " ").replace(" " + b + " ", " ")))
                },
                _setClass: function(a, b) {
                    a.className.baseVal === c ? a.className = b : a.className.baseVal = b
                },
                _getClass: function(a) {
                    return a.className.baseVal === c ? a.className : a.className.baseVal
                },
                setOpacity: function(a, b) {
                    if ("opacity" in a.style) a.style.opacity = b;
                    else if ("filter" in a.style) {
                        var c = !1,
                            d = "DXImageTransform.Microsoft.Alpha";
                        try {
                            c = a.filters.item(d)
                        } catch (a) {
                            if (1 === b) return
                        }
                        b = Math.round(100 * b), c ? (c.Enabled = 100 !== b, c.Opacity = b) : a.style.filter += " progid:" + d + "(opacity=" + b + ")"
                    }
                },
                testProp: function(a) {
                    for (var c = b.documentElement.style, d = 0; d < a.length; d++)
                        if (a[d] in c) return a[d];
                    return !1
                },
                getTranslateString: function(a) {
                    var b = e.Browser.webkit3d,
                        c = "translate" + (b ? "3d" : "") + "(",
                        d = (b ? ",0" : "") + ")";
                    return c + a.x + "px," + a.y + "px" + d
                },
                getScaleString: function(a, b) {
                    var c = e.DomUtil.getTranslateString(b.add(b.multiplyBy(-1 * a))),
                        d = " scale(" + a + ") ";
                    return c + d
                },
                setPosition: function(a, b, c) {
                    a._leaflet_pos = b, !c && e.Browser.any3d ? a.style[e.DomUtil.TRANSFORM] = e.DomUtil.getTranslateString(b) : (a.style.left = b.x + "px", a.style.top = b.y + "px")
                },
                getPosition: function(a) {
                    return a._leaflet_pos
                }
            }, e.DomUtil.TRANSFORM = e.DomUtil.testProp(["transform", "WebkitTransform", "OTransform", "MozTransform", "msTransform"]), e.DomUtil.TRANSITION = e.DomUtil.testProp(["webkitTransition", "transition", "OTransition", "MozTransition", "msTransition"]), e.DomUtil.TRANSITION_END = "webkitTransition" === e.DomUtil.TRANSITION || "OTransition" === e.DomUtil.TRANSITION ? e.DomUtil.TRANSITION + "End" : "transitionend",
            function() {
                if ("onselectstart" in b) e.extend(e.DomUtil, {
                    disableTextSelection: function() {
                        e.DomEvent.on(a, "selectstart", e.DomEvent.preventDefault)
                    },
                    enableTextSelection: function() {
                        e.DomEvent.off(a, "selectstart", e.DomEvent.preventDefault)
                    }
                });
                else {
                    var c = e.DomUtil.testProp(["userSelect", "WebkitUserSelect", "OUserSelect", "MozUserSelect", "msUserSelect"]);
                    e.extend(e.DomUtil, {
                        disableTextSelection: function() {
                            if (c) {
                                var a = b.documentElement.style;
                                this._userSelect = a[c], a[c] = "none"
                            }
                        },
                        enableTextSelection: function() {
                            c && (b.documentElement.style[c] = this._userSelect, delete this._userSelect)
                        }
                    })
                }
                e.extend(e.DomUtil, {
                    disableImageDrag: function() {
                        e.DomEvent.on(a, "dragstart", e.DomEvent.preventDefault)
                    },
                    enableImageDrag: function() {
                        e.DomEvent.off(a, "dragstart", e.DomEvent.preventDefault)
                    }
                })
            }(), e.LatLng = function(a, b, d) {
                if (a = parseFloat(a), b = parseFloat(b), isNaN(a) || isNaN(b)) throw new Error("Invalid LatLng object: (" + a + ", " + b + ")");
                this.lat = a, this.lng = b, d !== c && (this.alt = parseFloat(d))
            }, e.extend(e.LatLng, {
                DEG_TO_RAD: Math.PI / 180,
                RAD_TO_DEG: 180 / Math.PI,
                MAX_MARGIN: 1e-9
            }), e.LatLng.prototype = {
                equals: function(a) {
                    if (!a) return !1;
                    a = e.latLng(a);
                    var b = Math.max(Math.abs(this.lat - a.lat), Math.abs(this.lng - a.lng));
                    return b <= e.LatLng.MAX_MARGIN
                },
                toString: function(a) {
                    return "LatLng(" + e.Util.formatNum(this.lat, a) + ", " + e.Util.formatNum(this.lng, a) + ")"
                },
                distanceTo: function(a) {
                    a = e.latLng(a);
                    var b = 6378137,
                        c = e.LatLng.DEG_TO_RAD,
                        d = (a.lat - this.lat) * c,
                        f = (a.lng - this.lng) * c,
                        g = this.lat * c,
                        h = a.lat * c,
                        i = Math.sin(d / 2),
                        j = Math.sin(f / 2),
                        k = i * i + j * j * Math.cos(g) * Math.cos(h);
                    return 2 * b * Math.atan2(Math.sqrt(k), Math.sqrt(1 - k))
                },
                wrap: function(a, b) {
                    var c = this.lng;
                    return a = a || -180, b = b || 180, c = (c + b) % (b - a) + (c < a || c === b ? b : a), new e.LatLng(this.lat, c)
                }
            }, e.latLng = function(a, b) {
                return a instanceof e.LatLng ? a : e.Util.isArray(a) ? "number" == typeof a[0] || "string" == typeof a[0] ? new e.LatLng(a[0], a[1], a[2]) : null : a === c || null === a ? a : "object" == typeof a && "lat" in a ? new e.LatLng(a.lat, "lng" in a ? a.lng : a.lon) : b === c ? null : new e.LatLng(a, b)
            }, e.LatLngBounds = function(a, b) {
                if (a)
                    for (var c = b ? [a, b] : a, d = 0, e = c.length; d < e; d++) this.extend(c[d])
            }, e.LatLngBounds.prototype = {
                extend: function(a) {
                    if (!a) return this;
                    var b = e.latLng(a);
                    return a = null !== b ? b : e.latLngBounds(a), a instanceof e.LatLng ? this._southWest || this._northEast ? (this._southWest.lat = Math.min(a.lat, this._southWest.lat), this._southWest.lng = Math.min(a.lng, this._southWest.lng), this._northEast.lat = Math.max(a.lat, this._northEast.lat), this._northEast.lng = Math.max(a.lng, this._northEast.lng)) : (this._southWest = new e.LatLng(a.lat, a.lng), this._northEast = new e.LatLng(a.lat, a.lng)) : a instanceof e.LatLngBounds && (this.extend(a._southWest), this.extend(a._northEast)), this
                },
                pad: function(a) {
                    var b = this._southWest,
                        c = this._northEast,
                        d = Math.abs(b.lat - c.lat) * a,
                        f = Math.abs(b.lng - c.lng) * a;
                    return new e.LatLngBounds(new e.LatLng(b.lat - d, b.lng - f), new e.LatLng(c.lat + d, c.lng + f))
                },
                getCenter: function() {
                    return new e.LatLng((this._southWest.lat + this._northEast.lat) / 2, (this._southWest.lng + this._northEast.lng) / 2)
                },
                getSouthWest: function() {
                    return this._southWest
                },
                getNorthEast: function() {
                    return this._northEast
                },
                getNorthWest: function() {
                    return new e.LatLng(this.getNorth(), this.getWest())
                },
                getSouthEast: function() {
                    return new e.LatLng(this.getSouth(), this.getEast())
                },
                getWest: function() {
                    return this._southWest.lng
                },
                getSouth: function() {
                    return this._southWest.lat
                },
                getEast: function() {
                    return this._northEast.lng
                },
                getNorth: function() {
                    return this._northEast.lat
                },
                contains: function(a) {
                    a = "number" == typeof a[0] || a instanceof e.LatLng ? e.latLng(a) : e.latLngBounds(a);
                    var d, f, b = this._southWest,
                        c = this._northEast;
                    return a instanceof e.LatLngBounds ? (d = a.getSouthWest(), f = a.getNorthEast()) : d = f = a, d.lat >= b.lat && f.lat <= c.lat && d.lng >= b.lng && f.lng <= c.lng;
                },
                intersects: function(a) {
                    a = e.latLngBounds(a);
                    var b = this._southWest,
                        c = this._northEast,
                        d = a.getSouthWest(),
                        f = a.getNorthEast(),
                        g = f.lat >= b.lat && d.lat <= c.lat,
                        h = f.lng >= b.lng && d.lng <= c.lng;
                    return g && h
                },
                toBBoxString: function() {
                    return [this.getWest(), this.getSouth(), this.getEast(), this.getNorth()].join(",")
                },
                equals: function(a) {
                    return !!a && (a = e.latLngBounds(a), this._southWest.equals(a.getSouthWest()) && this._northEast.equals(a.getNorthEast()))
                },
                isValid: function() {
                    return !!this._southWest && !!this._northEast
                }
            }, e.latLngBounds = function(a, b) {
                return !a || a instanceof e.LatLngBounds ? a : new e.LatLngBounds(a, b)
            }, e.Projection = {}, e.Projection.SphericalMercator = {
                MAX_LATITUDE: 85.0511287798,
                project: function(a) {
                    var b = e.LatLng.DEG_TO_RAD,
                        c = this.MAX_LATITUDE,
                        d = Math.max(Math.min(c, a.lat), -c),
                        f = a.lng * b,
                        g = d * b;
                    return g = Math.log(Math.tan(Math.PI / 4 + g / 2)), new e.Point(f, g)
                },
                unproject: function(a) {
                    var b = e.LatLng.RAD_TO_DEG,
                        c = a.x * b,
                        d = (2 * Math.atan(Math.exp(a.y)) - Math.PI / 2) * b;
                    return new e.LatLng(d, c)
                }
            }, e.Projection.LonLat = {
                project: function(a) {
                    return new e.Point(a.lng, a.lat)
                },
                unproject: function(a) {
                    return new e.LatLng(a.y, a.x)
                }
            }, e.CRS = {
                latLngToPoint: function(a, b) {
                    var c = this.projection.project(a),
                        d = this.scale(b);
                    return this.transformation._transform(c, d)
                },
                pointToLatLng: function(a, b) {
                    var c = this.scale(b),
                        d = this.transformation.untransform(a, c);
                    return this.projection.unproject(d)
                },
                project: function(a) {
                    return this.projection.project(a)
                },
                scale: function(a) {
                    return 256 * Math.pow(2, a)
                },
                getSize: function(a) {
                    var b = this.scale(a);
                    return e.point(b, b)
                }
            }, e.CRS.Simple = e.extend({}, e.CRS, {
                projection: e.Projection.LonLat,
                transformation: new e.Transformation(1, 0, -1, 0),
                scale: function(a) {
                    return Math.pow(2, a)
                }
            }), e.CRS.EPSG3857 = e.extend({}, e.CRS, {
                code: "EPSG:3857",
                projection: e.Projection.SphericalMercator,
                transformation: new e.Transformation(.5 / Math.PI, .5, -.5 / Math.PI, .5),
                project: function(a) {
                    var b = this.projection.project(a),
                        c = 6378137;
                    return b.multiplyBy(c)
                }
            }), e.CRS.EPSG900913 = e.extend({}, e.CRS.EPSG3857, {
                code: "EPSG:900913"
            }), e.CRS.EPSG4326 = e.extend({}, e.CRS, {
                code: "EPSG:4326",
                projection: e.Projection.LonLat,
                transformation: new e.Transformation(1 / 360, .5, -1 / 360, .5)
            }), e.Map = e.Class.extend({
                includes: e.Mixin.Events,
                options: {
                    crs: e.CRS.EPSG3857,
                    fadeAnimation: e.DomUtil.TRANSITION && !e.Browser.android23,
                    trackResize: !0,
                    markerZoomAnimation: e.DomUtil.TRANSITION && e.Browser.any3d
                },
                initialize: function(a, b) {
                    b = e.setOptions(this, b), this._initContainer(a), this._initLayout(), this._onResize = e.bind(this._onResize, this), this._initEvents(), b.maxBounds && this.setMaxBounds(b.maxBounds), b.center && b.zoom !== c && this.setView(e.latLng(b.center), b.zoom, {
                        reset: !0
                    }), this._handlers = [], this._layers = {}, this._zoomBoundLayers = {}, this._tileLayersNum = 0, this.callInitHooks(), this._addLayers(b.layers)
                },
                setView: function(a, b) {
                    return b = b === c ? this.getZoom() : b, this._resetView(e.latLng(a), this._limitZoom(b)), this
                },
                setZoom: function(a, b) {
                    return this._loaded ? this.setView(this.getCenter(), a, {
                        zoom: b
                    }) : (this._zoom = this._limitZoom(a), this)
                },
                zoomIn: function(a, b) {
                    return this.setZoom(this._zoom + (a || 1), b)
                },
                zoomOut: function(a, b) {
                    return this.setZoom(this._zoom - (a || 1), b)
                },
                setZoomAround: function(a, b, c) {
                    var d = this.getZoomScale(b),
                        f = this.getSize().divideBy(2),
                        g = a instanceof e.Point ? a : this.latLngToContainerPoint(a),
                        h = g.subtract(f).multiplyBy(1 - 1 / d),
                        i = this.containerPointToLatLng(f.add(h));
                    return this.setView(i, b, {
                        zoom: c
                    })
                },
                fitBounds: function(a, b) {
                    b = b || {}, a = a.getBounds ? a.getBounds() : e.latLngBounds(a);
                    var c = e.point(b.paddingTopLeft || b.padding || [0, 0]),
                        d = e.point(b.paddingBottomRight || b.padding || [0, 0]),
                        f = this.getBoundsZoom(a, !1, c.add(d));
                    f = b.maxZoom ? Math.min(b.maxZoom, f) : f;
                    var g = d.subtract(c).divideBy(2),
                        h = this.project(a.getSouthWest(), f),
                        i = this.project(a.getNorthEast(), f),
                        j = this.unproject(h.add(i).divideBy(2).add(g), f);
                    return this.setView(j, f, b)
                },
                fitWorld: function(a) {
                    return this.fitBounds([
                        [-90, -180],
                        [90, 180]
                    ], a)
                },
                panTo: function(a, b) {
                    return this.setView(a, this._zoom, {
                        pan: b
                    })
                },
                panBy: function(a) {
                    return this.fire("movestart"), this._rawPanBy(e.point(a)), this.fire("move"), this.fire("moveend")
                },
                setMaxBounds: function(a) {
                    return a = e.latLngBounds(a), this.options.maxBounds = a, a ? (this._loaded && this._panInsideMaxBounds(), this.on("moveend", this._panInsideMaxBounds, this)) : this.off("moveend", this._panInsideMaxBounds, this)
                },
                panInsideBounds: function(a, b) {
                    var c = this.getCenter(),
                        d = this._limitCenter(c, this._zoom, a);
                    return c.equals(d) ? this : this.panTo(d, b)
                },
                addLayer: function(a) {
                    var b = e.stamp(a);
                    return this._layers[b] ? this : (this._layers[b] = a, a.options && (!isNaN(a.options.maxZoom) || !isNaN(a.options.minZoom)) && (this._zoomBoundLayers[b] = a, this._updateZoomLevels()), this.options.zoomAnimation && e.TileLayer && a instanceof e.TileLayer && (this._tileLayersNum++, this._tileLayersToLoad++, a.on("load", this._onTileLayerLoad, this)), this._loaded && this._layerAdd(a), this)
                },
                removeLayer: function(a) {
                    var b = e.stamp(a);
                    return this._layers[b] ? (this._loaded && a.onRemove(this), delete this._layers[b], this._loaded && this.fire("layerremove", {
                        layer: a
                    }), this._zoomBoundLayers[b] && (delete this._zoomBoundLayers[b], this._updateZoomLevels()), this.options.zoomAnimation && e.TileLayer && a instanceof e.TileLayer && (this._tileLayersNum--, this._tileLayersToLoad--, a.off("load", this._onTileLayerLoad, this)), this) : this
                },
                hasLayer: function(a) {
                    return !!a && e.stamp(a) in this._layers
                },
                eachLayer: function(a, b) {
                    for (var c in this._layers) a.call(b, this._layers[c]);
                    return this
                },
                invalidateSize: function(a) {
                    if (!this._loaded) return this;
                    a = e.extend({
                        animate: !1,
                        pan: !0
                    }, a === !0 ? {
                        animate: !0
                    } : a);
                    var b = this.getSize();
                    this._sizeChanged = !0, this._initialCenter = null;
                    var c = this.getSize(),
                        d = b.divideBy(2).round(),
                        f = c.divideBy(2).round(),
                        g = d.subtract(f);
                    return g.x || g.y ? (a.animate && a.pan ? this.panBy(g) : (a.pan && this._rawPanBy(g), this.fire("move"), a.debounceMoveend ? (clearTimeout(this._sizeTimer), this._sizeTimer = setTimeout(e.bind(this.fire, this, "moveend"), 200)) : this.fire("moveend")), this.fire("resize", {
                        oldSize: b,
                        newSize: c
                    })) : this
                },
                addHandler: function(a, b) {
                    if (!b) return this;
                    var c = this[a] = new b(this);
                    return this._handlers.push(c), this.options[a] && c.enable(), this
                },
                remove: function() {
                    this._loaded && this.fire("unload"), this._initEvents("off");
                    try {
                        delete this._container._leaflet
                    } catch (a) {
                        this._container._leaflet = c
                    }
                    return this._clearPanes(), this._clearControlPos && this._clearControlPos(), this._clearHandlers(), this
                },
                getCenter: function() {
                    return this._checkIfLoaded(), this._initialCenter && !this._moved() ? this._initialCenter : this.layerPointToLatLng(this._getCenterLayerPoint())
                },
                getZoom: function() {
                    return this._zoom
                },
                getBounds: function() {
                    var a = this.getPixelBounds(),
                        b = this.unproject(a.getBottomLeft()),
                        c = this.unproject(a.getTopRight());
                    return new e.LatLngBounds(b, c)
                },
                getMinZoom: function() {
                    return this.options.minZoom === c ? this._layersMinZoom === c ? 0 : this._layersMinZoom : this.options.minZoom
                },
                getMaxZoom: function() {
                    return this.options.maxZoom === c ? this._layersMaxZoom === c ? 1 / 0 : this._layersMaxZoom : this.options.maxZoom
                },
                getBoundsZoom: function(a, b, c) {
                    a = e.latLngBounds(a);
                    var k, d = this.getMinZoom() - (b ? 1 : 0),
                        f = this.getMaxZoom(),
                        g = this.getSize(),
                        h = a.getNorthWest(),
                        i = a.getSouthEast(),
                        j = !0;
                    c = e.point(c || [0, 0]);
                    do d++, k = this.project(i, d).subtract(this.project(h, d)).add(c), j = b ? k.x < g.x || k.y < g.y : g.contains(k); while (j && d <= f);
                    return j && b ? null : b ? d : d - 1
                },
                getSize: function() {
                    return this._size && !this._sizeChanged || (this._size = new e.Point(this._container.clientWidth, this._container.clientHeight), this._sizeChanged = !1), this._size.clone()
                },
                getPixelBounds: function() {
                    var a = this._getTopLeftPoint();
                    return new e.Bounds(a, a.add(this.getSize()))
                },
                getPixelOrigin: function() {
                    return this._checkIfLoaded(), this._initialTopLeftPoint
                },
                getPanes: function() {
                    return this._panes
                },
                getContainer: function() {
                    return this._container
                },
                getZoomScale: function(a) {
                    var b = this.options.crs;
                    return b.scale(a) / b.scale(this._zoom)
                },
                getScaleZoom: function(a) {
                    return this._zoom + Math.log(a) / Math.LN2
                },
                project: function(a, b) {
                    return b = b === c ? this._zoom : b, this.options.crs.latLngToPoint(e.latLng(a), b)
                },
                unproject: function(a, b) {
                    return b = b === c ? this._zoom : b, this.options.crs.pointToLatLng(e.point(a), b)
                },
                layerPointToLatLng: function(a) {
                    var b = e.point(a).add(this.getPixelOrigin());
                    return this.unproject(b)
                },
                latLngToLayerPoint: function(a) {
                    var b = this.project(e.latLng(a))._round();
                    return b._subtract(this.getPixelOrigin())
                },
                containerPointToLayerPoint: function(a) {
                    return e.point(a).subtract(this._getMapPanePos())
                },
                layerPointToContainerPoint: function(a) {
                    return e.point(a).add(this._getMapPanePos())
                },
                containerPointToLatLng: function(a) {
                    var b = this.containerPointToLayerPoint(e.point(a));
                    return this.layerPointToLatLng(b)
                },
                latLngToContainerPoint: function(a) {
                    return this.layerPointToContainerPoint(this.latLngToLayerPoint(e.latLng(a)))
                },
                mouseEventToContainerPoint: function(a) {
                    return e.DomEvent.getMousePosition(a, this._container)
                },
                mouseEventToLayerPoint: function(a) {
                    return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))
                },
                mouseEventToLatLng: function(a) {
                    return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))
                },
                _initContainer: function(a) {
                    var b = this._container = e.DomUtil.get(a);
                    if (!b) throw new Error("Map container not found.");
                    if (b._leaflet) throw new Error("Map container is already initialized.");
                    b._leaflet = !0
                },
                _initLayout: function() {
                    var a = this._container;
                    e.DomUtil.addClass(a, "leaflet-container" + (e.Browser.touch ? " leaflet-touch" : "") + (e.Browser.retina ? " leaflet-retina" : "") + (e.Browser.ielt9 ? " leaflet-oldie" : "") + (this.options.fadeAnimation ? " leaflet-fade-anim" : ""));
                    var b = e.DomUtil.getStyle(a, "position");
                    "absolute" !== b && "relative" !== b && "fixed" !== b && (a.style.position = "relative"), this._initPanes(), this._initControlPos && this._initControlPos()
                },
                _initPanes: function() {
                    var a = this._panes = {};
                    this._mapPane = a.mapPane = this._createPane("leaflet-map-pane", this._container), this._tilePane = a.tilePane = this._createPane("leaflet-tile-pane", this._mapPane), a.objectsPane = this._createPane("leaflet-objects-pane", this._mapPane), a.shadowPane = this._createPane("leaflet-shadow-pane"), a.overlayPane = this._createPane("leaflet-overlay-pane"), a.markerPane = this._createPane("leaflet-marker-pane"), a.popupPane = this._createPane("leaflet-popup-pane");
                    var b = " leaflet-zoom-hide";
                    this.options.markerZoomAnimation || (e.DomUtil.addClass(a.markerPane, b), e.DomUtil.addClass(a.shadowPane, b), e.DomUtil.addClass(a.popupPane, b))
                },
                _createPane: function(a, b) {
                    return e.DomUtil.create("div", a, b || this._panes.objectsPane)
                },
                _clearPanes: function() {
                    this._container.removeChild(this._mapPane)
                },
                _addLayers: function(a) {
                    a = a ? e.Util.isArray(a) ? a : [a] : [];
                    for (var b = 0, c = a.length; b < c; b++) this.addLayer(a[b])
                },
                _resetView: function(a, b, c, d) {
                    var f = this._zoom !== b;
                    d || (this.fire("movestart"), f && this.fire("zoomstart")), this._zoom = b, this._initialCenter = a, this._initialTopLeftPoint = this._getNewTopLeftPoint(a), c ? this._initialTopLeftPoint._add(this._getMapPanePos()) : e.DomUtil.setPosition(this._mapPane, new e.Point(0, 0)), this._tileLayersToLoad = this._tileLayersNum;
                    var g = !this._loaded;
                    this._loaded = !0, this.fire("viewreset", {
                        hard: !c
                    }), g && (this.fire("load"), this.eachLayer(this._layerAdd, this)), this.fire("move"), (f || d) && this.fire("zoomend"), this.fire("moveend", {
                        hard: !c
                    })
                },
                _rawPanBy: function(a) {
                    e.DomUtil.setPosition(this._mapPane, this._getMapPanePos().subtract(a))
                },
                _getZoomSpan: function() {
                    return this.getMaxZoom() - this.getMinZoom()
                },
                _updateZoomLevels: function() {
                    var a, b = 1 / 0,
                        d = -(1 / 0),
                        e = this._getZoomSpan();
                    for (a in this._zoomBoundLayers) {
                        var f = this._zoomBoundLayers[a];
                        isNaN(f.options.minZoom) || (b = Math.min(b, f.options.minZoom)), isNaN(f.options.maxZoom) || (d = Math.max(d, f.options.maxZoom))
                    }
                    a === c ? this._layersMaxZoom = this._layersMinZoom = c : (this._layersMaxZoom = d, this._layersMinZoom = b), e !== this._getZoomSpan() && this.fire("zoomlevelschange")
                },
                _panInsideMaxBounds: function() {
                    this.panInsideBounds(this.options.maxBounds)
                },
                _checkIfLoaded: function() {
                    if (!this._loaded) throw new Error("Set map center and zoom first.")
                },
                _initEvents: function(b) {
                    if (e.DomEvent) {
                        b = b || "on", e.DomEvent[b](this._container, "click", this._onMouseClick, this);
                        var d, f, c = ["dblclick", "mousedown", "mouseup", "mouseenter", "mouseleave", "mousemove", "contextmenu"];
                        for (d = 0, f = c.length; d < f; d++) e.DomEvent[b](this._container, c[d], this._fireMouseEvent, this);
                        this.options.trackResize && e.DomEvent[b](a, "resize", this._onResize, this)
                    }
                },
                _onResize: function() {
                    e.Util.cancelAnimFrame(this._resizeRequest), this._resizeRequest = e.Util.requestAnimFrame(function() {
                        this.invalidateSize({
                            debounceMoveend: !0
                        })
                    }, this, !1, this._container)
                },
                _onMouseClick: function(a) {
                    !this._loaded || !a._simulated && (this.dragging && this.dragging.moved() || this.boxZoom && this.boxZoom.moved()) || e.DomEvent._skipped(a) || (this.fire("preclick"), this._fireMouseEvent(a))
                },
                _fireMouseEvent: function(a) {
                    if (this._loaded && !e.DomEvent._skipped(a)) {
                        var b = a.type;
                        if (b = "mouseenter" === b ? "mouseover" : "mouseleave" === b ? "mouseout" : b, this.hasEventListeners(b)) {
                            "contextmenu" === b && e.DomEvent.preventDefault(a);
                            var c = this.mouseEventToContainerPoint(a),
                                d = this.containerPointToLayerPoint(c),
                                f = this.layerPointToLatLng(d);
                            this.fire(b, {
                                latlng: f,
                                layerPoint: d,
                                containerPoint: c,
                                originalEvent: a
                            })
                        }
                    }
                },
                _onTileLayerLoad: function() {
                    this._tileLayersToLoad--, this._tileLayersNum && !this._tileLayersToLoad && this.fire("tilelayersload")
                },
                _clearHandlers: function() {
                    for (var a = 0, b = this._handlers.length; a < b; a++) this._handlers[a].disable()
                },
                whenReady: function(a, b) {
                    return this._loaded ? a.call(b || this, this) : this.on("load", a, b), this
                },
                _layerAdd: function(a) {
                    a.onAdd(this), this.fire("layeradd", {
                        layer: a
                    })
                },
                _getMapPanePos: function() {
                    return e.DomUtil.getPosition(this._mapPane)
                },
                _moved: function() {
                    var a = this._getMapPanePos();
                    return a && !a.equals([0, 0])
                },
                _getTopLeftPoint: function() {
                    return this.getPixelOrigin().subtract(this._getMapPanePos())
                },
                _getNewTopLeftPoint: function(a, b) {
                    var c = this.getSize()._divideBy(2);
                    return this.project(a, b)._subtract(c)._round()
                },
                _latLngToNewLayerPoint: function(a, b, c) {
                    var d = this._getNewTopLeftPoint(c, b).add(this._getMapPanePos());
                    return this.project(a, b)._subtract(d)
                },
                _getCenterLayerPoint: function() {
                    return this.containerPointToLayerPoint(this.getSize()._divideBy(2))
                },
                _getCenterOffset: function(a) {
                    return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())
                },
                _limitCenter: function(a, b, c) {
                    if (!c) return a;
                    var d = this.project(a, b),
                        f = this.getSize().divideBy(2),
                        g = new e.Bounds(d.subtract(f), d.add(f)),
                        h = this._getBoundsOffset(g, c, b);
                    return this.unproject(d.add(h), b)
                },
                _limitOffset: function(a, b) {
                    if (!b) return a;
                    var c = this.getPixelBounds(),
                        d = new e.Bounds(c.min.add(a), c.max.add(a));
                    return a.add(this._getBoundsOffset(d, b))
                },
                _getBoundsOffset: function(a, b, c) {
                    var d = this.project(b.getNorthWest(), c).subtract(a.min),
                        f = this.project(b.getSouthEast(), c).subtract(a.max),
                        g = this._rebound(d.x, -f.x),
                        h = this._rebound(d.y, -f.y);
                    return new e.Point(g, h)
                },
                _rebound: function(a, b) {
                    return a + b > 0 ? Math.round(a - b) / 2 : Math.max(0, Math.ceil(a)) - Math.max(0, Math.floor(b))
                },
                _limitZoom: function(a) {
                    var b = this.getMinZoom(),
                        c = this.getMaxZoom();
                    return Math.max(b, Math.min(c, a))
                }
            }), e.map = function(a, b) {
                return new e.Map(a, b)
            }, e.Projection.Mercator = {
                MAX_LATITUDE: 85.0840591556,
                R_MINOR: 6356752.314245179,
                R_MAJOR: 6378137,
                project: function(a) {
                    var b = e.LatLng.DEG_TO_RAD,
                        c = this.MAX_LATITUDE,
                        d = Math.max(Math.min(c, a.lat), -c),
                        f = this.R_MAJOR,
                        g = this.R_MINOR,
                        h = a.lng * b * f,
                        i = d * b,
                        j = g / f,
                        k = Math.sqrt(1 - j * j),
                        l = k * Math.sin(i);
                    l = Math.pow((1 - l) / (1 + l), .5 * k);
                    var m = Math.tan(.5 * (.5 * Math.PI - i)) / l;
                    return i = -f * Math.log(m), new e.Point(h, i)
                },
                unproject: function(a) {
                    for (var o, b = e.LatLng.RAD_TO_DEG, c = this.R_MAJOR, d = this.R_MINOR, f = a.x * b / c, g = d / c, h = Math.sqrt(1 - g * g), i = Math.exp(-a.y / c), j = Math.PI / 2 - 2 * Math.atan(i), k = 15, l = 1e-7, m = k, n = .1; Math.abs(n) > l && --m > 0;) o = h * Math.sin(j), n = Math.PI / 2 - 2 * Math.atan(i * Math.pow((1 - o) / (1 + o), .5 * h)) - j, j += n;
                    return new e.LatLng(j * b, f)
                }
            }, e.CRS.EPSG3395 = e.extend({}, e.CRS, {
                code: "EPSG:3395",
                projection: e.Projection.Mercator,
                transformation: function() {
                    var a = e.Projection.Mercator,
                        b = a.R_MAJOR,
                        c = .5 / (Math.PI * b);
                    return new e.Transformation(c, .5, -c, .5)
                }()
            }), e.TileLayer = e.Class.extend({
                includes: e.Mixin.Events,
                options: {
                    minZoom: 0,
                    maxZoom: 18,
                    tileSize: 256,
                    subdomains: "abc",
                    errorTileUrl: "",
                    attribution: "",
                    zoomOffset: 0,
                    opacity: 1,
                    unloadInvisibleTiles: e.Browser.mobile,
                    updateWhenIdle: e.Browser.mobile
                },
                initialize: function(a, b) {
                    b = e.setOptions(this, b), b.detectRetina && e.Browser.retina && b.maxZoom > 0 && (b.tileSize = Math.floor(b.tileSize / 2), b.zoomOffset++, b.minZoom > 0 && b.minZoom--, this.options.maxZoom--), b.bounds && (b.bounds = e.latLngBounds(b.bounds)), this._url = a;
                    var c = this.options.subdomains;
                    "string" == typeof c && (this.options.subdomains = c.split(""))
                },
                onAdd: function(a) {
                    this._map = a, this._animated = a._zoomAnimated, this._initContainer(), a.on({
                        viewreset: this._reset,
                        moveend: this._update
                    }, this), this._animated && a.on({
                        zoomanim: this._animateZoom,
                        zoomend: this._endZoomAnim
                    }, this), this.options.updateWhenIdle || (this._limitedUpdate = e.Util.limitExecByInterval(this._update, 150, this), a.on("move", this._limitedUpdate, this)), this._reset(), this._update()
                },
                addTo: function(a) {
                    return a.addLayer(this), this
                },
                onRemove: function(a) {
                    this._container.parentNode.removeChild(this._container), a.off({
                        viewreset: this._reset,
                        moveend: this._update
                    }, this), this._animated && a.off({
                        zoomanim: this._animateZoom,
                        zoomend: this._endZoomAnim
                    }, this), this.options.updateWhenIdle || a.off("move", this._limitedUpdate, this), this._container = null, this._map = null
                },
                bringToFront: function() {
                    var a = this._map._panes.tilePane;
                    return this._container && (a.appendChild(this._container), this._setAutoZIndex(a, Math.max)), this
                },
                bringToBack: function() {
                    var a = this._map._panes.tilePane;
                    return this._container && (a.insertBefore(this._container, a.firstChild), this._setAutoZIndex(a, Math.min)), this
                },
                getAttribution: function() {
                    return this.options.attribution
                },
                getContainer: function() {
                    return this._container
                },
                setOpacity: function(a) {
                    return this.options.opacity = a, this._map && this._updateOpacity(), this
                },
                setZIndex: function(a) {
                    return this.options.zIndex = a, this._updateZIndex(), this
                },
                setUrl: function(a, b) {
                    return this._url = a, b || this.redraw(), this
                },
                redraw: function() {
                    return this._map && (this._reset({
                        hard: !0
                    }), this._update()), this
                },
                _updateZIndex: function() {
                    this._container && this.options.zIndex !== c && (this._container.style.zIndex = this.options.zIndex)
                },
                _setAutoZIndex: function(a, b) {
                    var e, f, g, c = a.children,
                        d = -b(1 / 0, -(1 / 0));
                    for (f = 0, g = c.length; f < g; f++) c[f] !== this._container && (e = parseInt(c[f].style.zIndex, 10), isNaN(e) || (d = b(d, e)));
                    this.options.zIndex = this._container.style.zIndex = (isFinite(d) ? d : 0) + b(1, -1)
                },
                _updateOpacity: function() {
                    var a, b = this._tiles;
                    if (e.Browser.ielt9)
                        for (a in b) e.DomUtil.setOpacity(b[a], this.options.opacity);
                    else e.DomUtil.setOpacity(this._container, this.options.opacity)
                },
                _initContainer: function() {
                    var a = this._map._panes.tilePane;
                    if (!this._container) {
                        if (this._container = e.DomUtil.create("div", "leaflet-layer"), this._updateZIndex(), this._animated) {
                            var b = "leaflet-tile-container";
                            this._bgBuffer = e.DomUtil.create("div", b, this._container), this._tileContainer = e.DomUtil.create("div", b, this._container)
                        } else this._tileContainer = this._container;
                        a.appendChild(this._container), this.options.opacity < 1 && this._updateOpacity()
                    }
                },
                _reset: function(a) {
                    for (var b in this._tiles) this.fire("tileunload", {
                        tile: this._tiles[b]
                    });
                    this._tiles = {}, this._tilesToLoad = 0, this.options.reuseTiles && (this._unusedTiles = []), this._tileContainer.innerHTML = "", this._animated && a && a.hard && this._clearBgBuffer(), this._initContainer()
                },
                _getTileSize: function() {
                    var a = this._map,
                        b = a.getZoom() + this.options.zoomOffset,
                        c = this.options.maxNativeZoom,
                        d = this.options.tileSize;
                    return c && b > c && (d = Math.round(a.getZoomScale(b) / a.getZoomScale(c) * d)), d
                },
                _update: function() {
                    if (this._map) {
                        var a = this._map,
                            b = a.getPixelBounds(),
                            c = a.getZoom(),
                            d = this._getTileSize();
                        if (!(c > this.options.maxZoom || c < this.options.minZoom)) {
                            var f = e.bounds(b.min.divideBy(d)._floor(), b.max.divideBy(d)._floor());
                            this._addTilesFromCenterOut(f), (this.options.unloadInvisibleTiles || this.options.reuseTiles) && this._removeOtherTiles(f)
                        }
                    }
                },
                _addTilesFromCenterOut: function(a) {
                    var f, g, h, c = [],
                        d = a.getCenter();
                    for (f = a.min.y; f <= a.max.y; f++)
                        for (g = a.min.x; g <= a.max.x; g++) h = new e.Point(g, f), this._tileShouldBeLoaded(h) && c.push(h);
                    var i = c.length;
                    if (0 !== i) {
                        c.sort(function(a, b) {
                            return a.distanceTo(d) - b.distanceTo(d)
                        });
                        var j = b.createDocumentFragment();
                        for (this._tilesToLoad || this.fire("loading"), this._tilesToLoad += i, g = 0; g < i; g++) this._addTile(c[g], j);
                        this._tileContainer.appendChild(j)
                    }
                },
                _tileShouldBeLoaded: function(a) {
                    if (a.x + ":" + a.y in this._tiles) return !1;
                    var b = this.options;
                    if (!b.continuousWorld) {
                        var c = this._getWrapTileNum();
                        if (b.noWrap && (a.x < 0 || a.x >= c.x) || a.y < 0 || a.y >= c.y) return !1
                    }
                    if (b.bounds) {
                        var d = this._getTileSize(),
                            e = a.multiplyBy(d),
                            f = e.add([d, d]),
                            g = this._map.unproject(e),
                            h = this._map.unproject(f);
                        if (!b.continuousWorld && !b.noWrap && (g = g.wrap(), h = h.wrap()), !b.bounds.intersects([g, h])) return !1
                    }
                    return !0
                },
                _removeOtherTiles: function(a) {
                    var b, c, d, e;
                    for (e in this._tiles) b = e.split(":"), c = parseInt(b[0], 10), d = parseInt(b[1], 10), (c < a.min.x || c > a.max.x || d < a.min.y || d > a.max.y) && this._removeTile(e)
                },
                _removeTile: function(a) {
                    var b = this._tiles[a];
                    this.fire("tileunload", {
                        tile: b,
                        url: b.src
                    }), this.options.reuseTiles ? (e.DomUtil.removeClass(b, "leaflet-tile-loaded"), this._unusedTiles.push(b)) : b.parentNode === this._tileContainer && this._tileContainer.removeChild(b), e.Browser.android || (b.onload = null, b.src = e.Util.emptyImageUrl), delete this._tiles[a]
                },
                _addTile: function(a, b) {
                    var c = this._getTilePos(a),
                        d = this._getTile();
                    e.DomUtil.setPosition(d, c, e.Browser.chrome), this._tiles[a.x + ":" + a.y] = d, this._loadTile(d, a), d.parentNode !== this._tileContainer && b.appendChild(d)
                },
                _getZoomForUrl: function() {
                    var a = this.options,
                        b = this._map.getZoom();
                    return a.zoomReverse && (b = a.maxZoom - b), b += a.zoomOffset, a.maxNativeZoom ? Math.min(b, a.maxNativeZoom) : b
                },
                _getTilePos: function(a) {
                    var b = this._map.getPixelOrigin(),
                        c = this._getTileSize();
                    return a.multiplyBy(c).subtract(b)
                },
                getTileUrl: function(a) {
                    return e.Util.template(this._url, e.extend({
                        s: this._getSubdomain(a),
                        z: a.z,
                        x: a.x,
                        y: a.y
                    }, this.options))
                },
                _getWrapTileNum: function() {
                    var a = this._map.options.crs,
                        b = a.getSize(this._map.getZoom());
                    return b.divideBy(this._getTileSize())._floor()
                },
                _adjustTilePoint: function(a) {
                    var b = this._getWrapTileNum();
                    !this.options.continuousWorld && !this.options.noWrap && (a.x = (a.x % b.x + b.x) % b.x), this.options.tms && (a.y = b.y - a.y - 1), a.z = this._getZoomForUrl()
                },
                _getSubdomain: function(a) {
                    var b = Math.abs(a.x + a.y) % this.options.subdomains.length;
                    return this.options.subdomains[b]
                },
                _getTile: function() {
                    if (this.options.reuseTiles && this._unusedTiles.length > 0) {
                        var a = this._unusedTiles.pop();
                        return this._resetTile(a), a
                    }
                    return this._createTile()
                },
                _resetTile: function() {},
                _createTile: function() {
                    var a = e.DomUtil.create("img", "leaflet-tile");
                    return a.style.width = a.style.height = this._getTileSize() + "px", a.galleryimg = "no", a.onselectstart = a.onmousemove = e.Util.falseFn, e.Browser.ielt9 && this.options.opacity !== c && e.DomUtil.setOpacity(a, this.options.opacity), e.Browser.mobileWebkit3d && (a.style.WebkitBackfaceVisibility = "hidden"), a
                },
                _loadTile: function(a, b) {
                    a._layer = this, a.onload = this._tileOnLoad, a.onerror = this._tileOnError, this._adjustTilePoint(b), a.src = this.getTileUrl(b), this.fire("tileloadstart", {
                        tile: a,
                        url: a.src
                    })
                },
                _tileLoaded: function() {
                    this._tilesToLoad--, this._animated && e.DomUtil.addClass(this._tileContainer, "leaflet-zoom-animated"), this._tilesToLoad || (this.fire("load"), this._animated && (clearTimeout(this._clearBgBufferTimer), this._clearBgBufferTimer = setTimeout(e.bind(this._clearBgBuffer, this), 500)))
                },
                _tileOnLoad: function() {
                    var a = this._layer;
                    this.src !== e.Util.emptyImageUrl && (e.DomUtil.addClass(this, "leaflet-tile-loaded"), a.fire("tileload", {
                        tile: this,
                        url: this.src
                    })), a._tileLoaded()
                },
                _tileOnError: function() {
                    var a = this._layer;
                    a.fire("tileerror", {
                        tile: this,
                        url: this.src
                    });
                    var b = a.options.errorTileUrl;
                    b && (this.src = b), a._tileLoaded()
                }
            }), e.tileLayer = function(a, b) {
                return new e.TileLayer(a, b)
            }, e.TileLayer.WMS = e.TileLayer.extend({
                defaultWmsParams: {
                    service: "WMS",
                    request: "GetMap",
                    version: "1.1.1",
                    layers: "",
                    styles: "",
                    format: "image/jpeg",
                    transparent: !1
                },
                initialize: function(a, b) {
                    this._url = a;
                    var c = e.extend({}, this.defaultWmsParams),
                        d = b.tileSize || this.options.tileSize;
                    b.detectRetina && e.Browser.retina ? c.width = c.height = 2 * d : c.width = c.height = d;
                    for (var f in b) !this.options.hasOwnProperty(f) && "crs" !== f && (c[f] = b[f]);
                    this.wmsParams = c, e.setOptions(this, b)
                },
                onAdd: function(a) {
                    this._crs = this.options.crs || a.options.crs, this._wmsVersion = parseFloat(this.wmsParams.version);
                    var b = this._wmsVersion >= 1.3 ? "crs" : "srs";
                    this.wmsParams[b] = this._crs.code, e.TileLayer.prototype.onAdd.call(this, a)
                },
                getTileUrl: function(a) {
                    var b = this._map,
                        c = this.options.tileSize,
                        d = a.multiplyBy(c),
                        f = d.add([c, c]),
                        g = this._crs.project(b.unproject(d, a.z)),
                        h = this._crs.project(b.unproject(f, a.z)),
                        i = this._wmsVersion >= 1.3 && this._crs === e.CRS.EPSG4326 ? [h.y, g.x, g.y, h.x].join(",") : [g.x, h.y, h.x, g.y].join(","),
                        j = e.Util.template(this._url, {
                            s: this._getSubdomain(a)
                        });
                    return j + e.Util.getParamString(this.wmsParams, j, !0) + "&BBOX=" + i
                },
                setParams: function(a, b) {
                    return e.extend(this.wmsParams, a), b || this.redraw(), this
                }
            }), e.tileLayer.wms = function(a, b) {
                return new e.TileLayer.WMS(a, b)
            }, e.TileLayer.Canvas = e.TileLayer.extend({
                options: {
                    async: !1
                },
                initialize: function(a) {
                    e.setOptions(this, a)
                },
                redraw: function() {
                    this._map && (this._reset({
                        hard: !0
                    }), this._update());
                    for (var a in this._tiles) this._redrawTile(this._tiles[a]);
                    return this
                },
                _redrawTile: function(a) {
                    this.drawTile(a, a._tilePoint, this._map._zoom)
                },
                _createTile: function() {
                    var a = e.DomUtil.create("canvas", "leaflet-tile");
                    return a.width = a.height = this.options.tileSize, a.onselectstart = a.onmousemove = e.Util.falseFn, a
                },
                _loadTile: function(a, b) {
                    a._layer = this, a._tilePoint = b, this._redrawTile(a), this.options.async || this.tileDrawn(a)
                },
                drawTile: function() {},
                tileDrawn: function(a) {
                    this._tileOnLoad.call(a)
                }
            }), e.tileLayer.canvas = function(a) {
                return new e.TileLayer.Canvas(a)
            }, e.ImageOverlay = e.Class.extend({
                includes: e.Mixin.Events,
                options: {
                    opacity: 1
                },
                initialize: function(a, b, c) {
                    this._url = a, this._bounds = e.latLngBounds(b), e.setOptions(this, c)
                },
                onAdd: function(a) {
                    this._map = a, this._image || this._initImage(), a._panes.overlayPane.appendChild(this._image), a.on("viewreset", this._reset, this), a.options.zoomAnimation && e.Browser.any3d && a.on("zoomanim", this._animateZoom, this), this._reset()
                },
                onRemove: function(a) {
                    a.getPanes().overlayPane.removeChild(this._image), a.off("viewreset", this._reset, this), a.options.zoomAnimation && a.off("zoomanim", this._animateZoom, this)
                },
                addTo: function(a) {
                    return a.addLayer(this), this
                },
                setOpacity: function(a) {
                    return this.options.opacity = a, this._updateOpacity(), this
                },
                bringToFront: function() {
                    return this._image && this._map._panes.overlayPane.appendChild(this._image), this
                },
                bringToBack: function() {
                    var a = this._map._panes.overlayPane;
                    return this._image && a.insertBefore(this._image, a.firstChild), this
                },
                setUrl: function(a) {
                    this._url = a, this._image.src = this._url
                },
                getAttribution: function() {
                    return this.options.attribution
                },
                _initImage: function() {
                    this._image = e.DomUtil.create("img", "leaflet-image-layer"), this._map.options.zoomAnimation && e.Browser.any3d ? e.DomUtil.addClass(this._image, "leaflet-zoom-animated") : e.DomUtil.addClass(this._image, "leaflet-zoom-hide"), this._updateOpacity(), e.extend(this._image, {
                        galleryimg: "no",
                        onselectstart: e.Util.falseFn,
                        onmousemove: e.Util.falseFn,
                        onload: e.bind(this._onImageLoad, this),
                        src: this._url
                    })
                },
                _animateZoom: function(a) {
                    var b = this._map,
                        c = this._image,
                        d = b.getZoomScale(a.zoom),
                        f = this._bounds.getNorthWest(),
                        g = this._bounds.getSouthEast(),
                        h = b._latLngToNewLayerPoint(f, a.zoom, a.center),
                        i = b._latLngToNewLayerPoint(g, a.zoom, a.center)._subtract(h),
                        j = h._add(i._multiplyBy(.5 * (1 - 1 / d)));
                    c.style[e.DomUtil.TRANSFORM] = e.DomUtil.getTranslateString(j) + " scale(" + d + ") "
                },
                _reset: function() {
                    var a = this._image,
                        b = this._map.latLngToLayerPoint(this._bounds.getNorthWest()),
                        c = this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(b);
                    e.DomUtil.setPosition(a, b), a.style.width = c.x + "px", a.style.height = c.y + "px"
                },
                _onImageLoad: function() {
                    this.fire("load")
                },
                _updateOpacity: function() {
                    e.DomUtil.setOpacity(this._image, this.options.opacity)
                }
            }), e.imageOverlay = function(a, b, c) {
                return new e.ImageOverlay(a, b, c)
            }, e.Icon = e.Class.extend({
                options: {
                    className: ""
                },
                initialize: function(a) {
                    e.setOptions(this, a)
                },
                createIcon: function(a) {
                    return this._createIcon("icon", a)
                },
                createShadow: function(a) {
                    return this._createIcon("shadow", a)
                },
                _createIcon: function(a, b) {
                    var c = this._getIconUrl(a);
                    if (!c) {
                        if ("icon" === a) throw new Error("iconUrl not set in Icon options (see the docs).");
                        return null
                    }
                    var d;
                    return d = b && "IMG" === b.tagName ? this._createImg(c, b) : this._createImg(c), this._setIconStyles(d, a), d
                },
                _setIconStyles: function(a, b) {
                    var f, c = this.options,
                        d = e.point(c[b + "Size"]);
                    f = "shadow" === b ? e.point(c.shadowAnchor || c.iconAnchor) : e.point(c.iconAnchor), !f && d && (f = d.divideBy(2, !0)), a.className = "leaflet-marker-" + b + " " + c.className, f && (a.style.marginLeft = -f.x + "px", a.style.marginTop = -f.y + "px"), d && (a.style.width = d.x + "px", a.style.height = d.y + "px")
                },
                _createImg: function(a, c) {
                    return c = c || b.createElement("img"), c.src = a, c
                },
                _getIconUrl: function(a) {
                    return e.Browser.retina && this.options[a + "RetinaUrl"] ? this.options[a + "RetinaUrl"] : this.options[a + "Url"]
                }
            }), e.icon = function(a) {
                return new e.Icon(a)
            }, e.Icon.Default = e.Icon.extend({
                options: {
                    iconSize: [25, 41],
                    iconAnchor: [12, 41],
                    popupAnchor: [1, -34],
                    shadowSize: [41, 41]
                },
                _getIconUrl: function(a) {
                    var b = a + "Url";
                    if (this.options[b]) return this.options[b];
                    e.Browser.retina && "icon" === a && (a += "-2x");
                    var c = e.Icon.Default.imagePath;
                    if (!c) throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");
                    return c + "/marker-" + a + ".png"
                }
            }), e.Icon.Default.imagePath = function() {
                var d, e, f, g, h, a = b.getElementsByTagName("script"),
                    c = /[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;
                for (d = 0, e = a.length; d < e; d++)
                    if (f = a[d].src, g = f.match(c)) return h = f.split(c)[0], (h ? h + "/" : "") + "images"
            }(), e.Marker = e.Class.extend({
                includes: e.Mixin.Events,
                options: {
                    icon: new e.Icon.Default,
                    title: "",
                    alt: "",
                    clickable: !0,
                    draggable: !0,
                    keyboard: !0,
                    zIndexOffset: 0,
                    opacity: 1,
                    riseOnHover: !1,
                    riseOffset: 250
                },
                initialize: function(a, b) {
                    e.setOptions(this, b), this._latlng = e.latLng(a)
                },
                onAdd: function(a) {
                    this._map = a, a.on("viewreset", this.update, this), this._initIcon(), this.update(), this.fire("add"), a.options.zoomAnimation && a.options.markerZoomAnimation && a.on("zoomanim", this._animateZoom, this)
                },
                addTo: function(a) {
                    return a.addLayer(this), this
                },
                onRemove: function(a) {
                    this.dragging && this.dragging.disable(), this._removeIcon(), this._removeShadow(), this.fire("remove"), a.off({
                        viewreset: this.update,
                        zoomanim: this._animateZoom
                    }, this), this._map = null
                },
                getLatLng: function() {
                    return this._latlng
                },
                setLatLng: function(a) {
                    return this._latlng = e.latLng(a), this.update(), this.fire("move", {
                        latlng: this._latlng
                    })
                },
                setZIndexOffset: function(a) {
                    return this.options.zIndexOffset = a, this.update(), this
                },
                setIcon: function(a) {
                    return this.options.icon = a, this._map && (this._initIcon(), this.update()), this._popup && this.bindPopup(this._popup), this
                },
                update: function() {
                    return this._icon && this._setPos(this._map.latLngToLayerPoint(this._latlng).round()), this
                },
                _initIcon: function() {
                    var a = this.options,
                        b = this._map,
                        c = b.options.zoomAnimation && b.options.markerZoomAnimation,
                        d = c ? "leaflet-zoom-animated" : "leaflet-zoom-hide",
                        f = a.icon.createIcon(this._icon),
                        g = !1;
                    f !== this._icon && (this._icon && this._removeIcon(), g = !0, a.title && (f.title = a.title), a.alt && (f.alt = a.alt)), e.DomUtil.addClass(f, d), a.keyboard && (f.tabIndex = "0"), this._icon = f, this._initInteraction(), a.riseOnHover && e.DomEvent.on(f, "mouseover", this._bringToFront, this).on(f, "mouseout", this._resetZIndex, this);
                    var h = a.icon.createShadow(this._shadow),
                        i = !1;
                    h !== this._shadow && (this._removeShadow(), i = !0), h && e.DomUtil.addClass(h, d), this._shadow = h, a.opacity < 1 && this._updateOpacity();
                    var j = this._map._panes;
                    g && j.markerPane.appendChild(this._icon), h && i && j.shadowPane.appendChild(this._shadow)
                },
                _removeIcon: function() {
                    this.options.riseOnHover && e.DomEvent.off(this._icon, "mouseover", this._bringToFront).off(this._icon, "mouseout", this._resetZIndex), this._map._panes.markerPane.removeChild(this._icon), this._icon = null
                },
                _removeShadow: function() {
                    this._shadow && this._map._panes.shadowPane.removeChild(this._shadow), this._shadow = null
                },
                _setPos: function(a) {
                    e.DomUtil.setPosition(this._icon, a), this._shadow && e.DomUtil.setPosition(this._shadow, a), this._zIndex = a.y + this.options.zIndexOffset, this._resetZIndex()
                },
                _updateZIndex: function(a) {
                    this._icon.style.zIndex = this._zIndex + a
                },
                _animateZoom: function(a) {
                    var b = this._map._latLngToNewLayerPoint(this._latlng, a.zoom, a.center).round();
                    this._setPos(b)
                },
                _initInteraction: function() {
                    if (this.options.clickable) {
                        var a = this._icon,
                            b = ["dblclick", "mousedown", "mouseover", "mouseout", "contextmenu"];
                        e.DomUtil.addClass(a, "leaflet-clickable"), e.DomEvent.on(a, "click", this._onMouseClick, this), e.DomEvent.on(a, "keypress", this._onKeyPress, this);
                        for (var c = 0; c < b.length; c++) e.DomEvent.on(a, b[c], this._fireMouseEvent, this);
                        e.Handler.MarkerDrag && (this.dragging = new e.Handler.MarkerDrag(this), this.options.draggable && this.dragging.enable())
                    }
                },
                _onMouseClick: function(a) {
                    var b = this.dragging && this.dragging.moved();
                    (this.hasEventListeners(a.type) || b) && e.DomEvent.stopPropagation(a), b || (this.dragging && this.dragging._enabled || !this._map.dragging || !this._map.dragging.moved()) && this.fire(a.type, {
                        originalEvent: a,
                        latlng: this._latlng
                    })
                },
                _onKeyPress: function(a) {
                    13 === a.keyCode && this.fire("click", {
                        originalEvent: a,
                        latlng: this._latlng
                    })
                },
                _fireMouseEvent: function(a) {
                    this.fire(a.type, {
                        originalEvent: a,
                        latlng: this._latlng
                    }), "contextmenu" === a.type && this.hasEventListeners(a.type) && e.DomEvent.preventDefault(a), "mousedown" !== a.type ? e.DomEvent.stopPropagation(a) : e.DomEvent.preventDefault(a)
                },
                setOpacity: function(a) {
                    return this.options.opacity = a, this._map && this._updateOpacity(), this
                },
                _updateOpacity: function() {
                    e.DomUtil.setOpacity(this._icon, this.options.opacity), this._shadow && e.DomUtil.setOpacity(this._shadow, this.options.opacity)
                },
                _bringToFront: function() {
                    this._updateZIndex(this.options.riseOffset)
                },
                _resetZIndex: function() {
                    this._updateZIndex(0)
                }
            }), e.marker = function(a, b) {
                return new e.Marker(a, b)
            }, e.DivIcon = e.Icon.extend({
                options: {
                    iconSize: [12, 12],
                    className: "leaflet-div-icon",
                    html: !1
                },
                createIcon: function(a) {
                    var c = a && "DIV" === a.tagName ? a : b.createElement("div"),
                        d = this.options;
                    return d.html !== !1 ? c.innerHTML = d.html : c.innerHTML = "", d.bgPos && (c.style.backgroundPosition = -d.bgPos.x + "px " + -d.bgPos.y + "px"), this._setIconStyles(c, "icon"), c
                },
                createShadow: function() {
                    return null
                }
            }), e.divIcon = function(a) {
                return new e.DivIcon(a)
            }, e.Map.mergeOptions({
                closePopupOnClick: !0
            }), e.Popup = e.Class.extend({
                includes: e.Mixin.Events,
                options: {
                    minWidth: 50,
                    maxWidth: 300,
                    autoPan: !0,
                    closeButton: !0,
                    offset: [0, 7],
                    autoPanPadding: [5, 5],
                    keepInView: !1,
                    className: "",
                    zoomAnimation: !0
                },
                initialize: function(a, b) {
                    e.setOptions(this, a), this._source = b, this._animated = e.Browser.any3d && this.options.zoomAnimation, this._isOpen = !1
                },
                onAdd: function(a) {
                    this._map = a, this._container || this._initLayout();
                    var b = a.options.fadeAnimation;
                    b && e.DomUtil.setOpacity(this._container, 0), a._panes.popupPane.appendChild(this._container), a.on(this._getEvents(), this), this.update(), b && e.DomUtil.setOpacity(this._container, 1), this.fire("open"), a.fire("popupopen", {
                        popup: this
                    }), this._source && this._source.fire("popupopen", {
                        popup: this
                    })
                },
                addTo: function(a) {
                    return a.addLayer(this), this
                },
                openOn: function(a) {
                    return a.openPopup(this), this
                },
                onRemove: function(a) {
                    a._panes.popupPane.removeChild(this._container), e.Util.falseFn(this._container.offsetWidth), a.off(this._getEvents(), this), a.options.fadeAnimation && e.DomUtil.setOpacity(this._container, 0), this._map = null, this.fire("close"), a.fire("popupclose", {
                        popup: this
                    }), this._source && this._source.fire("popupclose", {
                        popup: this
                    })
                },
                getLatLng: function() {
                    return this._latlng
                },
                setLatLng: function(a) {
                    return this._latlng = e.latLng(a), this._map && (this._updatePosition(), this._adjustPan()), this
                },
                getContent: function() {
                    return this._content
                },
                setContent: function(a) {
                    return this._content = a, this.update(), this
                },
                update: function() {
                    this._map && (this._container.style.visibility = "hidden", this._updateContent(), this._updateLayout(), this._updatePosition(), this._container.style.visibility = "", this._adjustPan())
                },
                _getEvents: function() {
                    var a = {
                        viewreset: this._updatePosition
                    };
                    return this._animated && (a.zoomanim = this._zoomAnimation), ("closeOnClick" in this.options ? this.options.closeOnClick : this._map.options.closePopupOnClick) && (a.preclick = this._close), this.options.keepInView && (a.moveend = this._adjustPan), a
                },
                _close: function() {
                    this._map && this._map.closePopup(this)
                },
                _initLayout: function() {
                    var d, a = "leaflet-popup",
                        b = a + " " + this.options.className + " leaflet-zoom-" + (this._animated ? "animated" : "hide"),
                        c = this._container = e.DomUtil.create("div", b);
                    this.options.closeButton && (d = this._closeButton = e.DomUtil.create("a", a + "-close-button", c), d.href = "#close", d.innerHTML = "&#215;", e.DomEvent.disableClickPropagation(d), e.DomEvent.on(d, "click", this._onCloseButtonClick, this));
                    var f = this._wrapper = e.DomUtil.create("div", a + "-content-wrapper", c);
                    e.DomEvent.disableClickPropagation(f), this._contentNode = e.DomUtil.create("div", a + "-content", f), e.DomEvent.disableScrollPropagation(this._contentNode), e.DomEvent.on(f, "contextmenu", e.DomEvent.stopPropagation), this._tipContainer = e.DomUtil.create("div", a + "-tip-container", c), this._tip = e.DomUtil.create("div", a + "-tip", this._tipContainer)
                },
                _updateContent: function() {
                    if (this._content) {
                        if ("string" == typeof this._content) this._contentNode.innerHTML = this._content;
                        else {
                            for (; this._contentNode.hasChildNodes();) this._contentNode.removeChild(this._contentNode.firstChild);
                            this._contentNode.appendChild(this._content)
                        }
                        this.fire("contentupdate")
                    }
                },
                _updateLayout: function() {
                    var a = this._contentNode,
                        b = a.style;
                    b.width = "", b.whiteSpace = "nowrap";
                    var c = a.offsetWidth;
                    c = Math.min(c, this.options.maxWidth), c = Math.max(c, this.options.minWidth), b.width = c + 1 + "px", b.whiteSpace = "", b.height = "";
                    var d = a.offsetHeight,
                        f = this.options.maxHeight,
                        g = "leaflet-popup-scrolled";
                    f && d > f ? (b.height = f + "px", e.DomUtil.addClass(a, g)) : e.DomUtil.removeClass(a, g), this._containerWidth = this._container.offsetWidth
                },
                _updatePosition: function() {
                    if (this._map) {
                        var a = this._map.latLngToLayerPoint(this._latlng),
                            b = this._animated,
                            c = e.point(this.options.offset);
                        b && e.DomUtil.setPosition(this._container, a), this._containerBottom = -c.y - (b ? 0 : a.y), this._containerLeft = -Math.round(this._containerWidth / 2) + c.x + (b ? 0 : a.x), this._container.style.bottom = this._containerBottom + "px", this._container.style.left = this._containerLeft + "px"
                    }
                },
                _zoomAnimation: function(a) {
                    var b = this._map._latLngToNewLayerPoint(this._latlng, a.zoom, a.center);
                    e.DomUtil.setPosition(this._container, b)
                },
                _adjustPan: function() {
                    if (this.options.autoPan) {
                        var a = this._map,
                            b = this._container.offsetHeight,
                            c = this._containerWidth,
                            d = new e.Point(this._containerLeft, -b - this._containerBottom);
                        this._animated && d._add(e.DomUtil.getPosition(this._container));
                        var f = a.layerPointToContainerPoint(d),
                            g = e.point(this.options.autoPanPadding),
                            h = e.point(this.options.autoPanPaddingTopLeft || g),
                            i = e.point(this.options.autoPanPaddingBottomRight || g),
                            j = a.getSize(),
                            k = 0,
                            l = 0;
                        f.x + c + i.x > j.x && (k = f.x + c - j.x + i.x), f.x - k - h.x < 0 && (k = f.x - h.x), f.y + b + i.y > j.y && (l = f.y + b - j.y + i.y), f.y - l - h.y < 0 && (l = f.y - h.y), (k || l) && a.fire("autopanstart").panBy([k, l])
                    }
                },
                _onCloseButtonClick: function(a) {
                    this._close(), e.DomEvent.stop(a)
                }
            }), e.popup = function(a, b) {
                return new e.Popup(a, b)
            }, e.Map.include({
                openPopup: function(a, b, c) {
                    if (this.closePopup(), !(a instanceof e.Popup)) {
                        var d = a;
                        a = new e.Popup(c).setLatLng(b).setContent(d)
                    }
                    return a._isOpen = !0, this._popup = a, this.addLayer(a)
                },
                closePopup: function(a) {
                    return a && a !== this._popup || (a = this._popup, this._popup = null), a && (this.removeLayer(a), a._isOpen = !1), this
                }
            }), e.Marker.include({
                openPopup: function() {
                    return this._popup && this._map && !this._map.hasLayer(this._popup) && (this._popup.setLatLng(this._latlng), this._map.openPopup(this._popup)), this
                },
                closePopup: function() {
                    return this._popup && this._popup._close(), this
                },
                togglePopup: function() {
                    return this._popup && (this._popup._isOpen ? this.closePopup() : this.openPopup()), this
                },
                bindPopup: function(a, b) {
                    var c = e.point(this.options.icon.options.popupAnchor || [0, 0]);
                    return c = c.add(e.Popup.prototype.options.offset), b && b.offset && (c = c.add(b.offset)), b = e.extend({
                        offset: c
                    }, b), this._popupHandlersAdded || (this.on("click", this.togglePopup, this).on("remove", this.closePopup, this).on("move", this._movePopup, this), this._popupHandlersAdded = !0), a instanceof e.Popup ? (e.setOptions(a, b), this._popup = a, a._source = this) : this._popup = new e.Popup(b, this).setContent(a), this
                },
                setPopupContent: function(a) {
                    return this._popup && this._popup.setContent(a), this
                },
                unbindPopup: function() {
                    return this._popup && (this._popup = null, this.off("click", this.togglePopup, this).off("remove", this.closePopup, this).off("move", this._movePopup, this), this._popupHandlersAdded = !1), this
                },
                getPopup: function() {
                    return this._popup
                },
                _movePopup: function(a) {
                    this._popup.setLatLng(a.latlng)
                }
            }), e.LayerGroup = e.Class.extend({
                initialize: function(a) {
                    this._layers = {};
                    var b, c;
                    if (a)
                        for (b = 0, c = a.length; b < c; b++) this.addLayer(a[b])
                },
                addLayer: function(a) {
                    var b = this.getLayerId(a);
                    return this._layers[b] = a, this._map && this._map.addLayer(a), this
                },
                removeLayer: function(a) {
                    var b = a in this._layers ? a : this.getLayerId(a);
                    return this._map && this._layers[b] && this._map.removeLayer(this._layers[b]), delete this._layers[b], this
                },
                hasLayer: function(a) {
                    return !!a && (a in this._layers || this.getLayerId(a) in this._layers)
                },
                clearLayers: function() {
                    return this.eachLayer(this.removeLayer, this), this
                },
                invoke: function(a) {
                    var c, d, b = Array.prototype.slice.call(arguments, 1);
                    for (c in this._layers) d = this._layers[c], d[a] && d[a].apply(d, b);
                    return this
                },
                onAdd: function(a) {
                    this._map = a, this.eachLayer(a.addLayer, a)
                },
                onRemove: function(a) {
                    this.eachLayer(a.removeLayer, a), this._map = null
                },
                addTo: function(a) {
                    return a.addLayer(this), this
                },
                eachLayer: function(a, b) {
                    for (var c in this._layers) a.call(b, this._layers[c]);
                    return this
                },
                getLayer: function(a) {
                    return this._layers[a]
                },
                getLayers: function() {
                    var a = [];
                    for (var b in this._layers) a.push(this._layers[b]);
                    return a
                },
                setZIndex: function(a) {
                    return this.invoke("setZIndex", a)
                },
                getLayerId: function(a) {
                    return e.stamp(a)
                }
            }), e.layerGroup = function(a) {
                return new e.LayerGroup(a)
            }, e.FeatureGroup = e.LayerGroup.extend({
                includes: e.Mixin.Events,
                statics: {
                    EVENTS: "click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"
                },
                addLayer: function(a) {
                    return this.hasLayer(a) ? this : ("on" in a && a.on(e.FeatureGroup.EVENTS, this._propagateEvent, this), e.LayerGroup.prototype.addLayer.call(this, a), this._popupContent && a.bindPopup && a.bindPopup(this._popupContent, this._popupOptions), this.fire("layeradd", {
                        layer: a
                    }))
                },
                removeLayer: function(a) {
                    return this.hasLayer(a) ? (a in this._layers && (a = this._layers[a]), "off" in a && a.off(e.FeatureGroup.EVENTS, this._propagateEvent, this), e.LayerGroup.prototype.removeLayer.call(this, a), this._popupContent && this.invoke("unbindPopup"), this.fire("layerremove", {
                        layer: a
                    })) : this
                },
                bindPopup: function(a, b) {
                    return this._popupContent = a, this._popupOptions = b, this.invoke("bindPopup", a, b)
                },
                openPopup: function(a) {
                    for (var b in this._layers) {
                        this._layers[b].openPopup(a);
                        break
                    }
                    return this
                },
                setStyle: function(a) {
                    return this.invoke("setStyle", a)
                },
                bringToFront: function() {
                    return this.invoke("bringToFront")
                },
                bringToBack: function() {
                    return this.invoke("bringToBack")
                },
                getBounds: function() {
                    var a = new e.LatLngBounds;
                    return this.eachLayer(function(b) {
                        a.extend(b instanceof e.Marker ? b.getLatLng() : b.getBounds())
                    }), a
                },
                _propagateEvent: function(a) {
                    a = e.extend({
                        layer: a.target,
                        target: this
                    }, a), this.fire(a.type, a)
                }
            }), e.featureGroup = function(a) {
                return new e.FeatureGroup(a)
            }, e.Path = e.Class.extend({
                includes: [e.Mixin.Events],
                statics: {
                    CLIP_PADDING: function() {
                        var b = e.Browser.mobile ? 1280 : 2e3,
                            c = (b / Math.max(a.outerWidth, a.outerHeight) - 1) / 2;
                        return Math.max(0, Math.min(.5, c))
                    }()
                },
                options: {
                    stroke: !0,
                    color: "#0033ff",
                    dashArray: null,
                    lineCap: null,
                    lineJoin: null,
                    weight: 5,
                    opacity: .5,
                    fill: !1,
                    fillColor: null,
                    fillOpacity: .2,
                    clickable: !0
                },
                initialize: function(a) {
                    e.setOptions(this, a)
                },
                onAdd: function(a) {
                    this._map = a, this._container || (this._initElements(), this._initEvents()), this.projectLatlngs(), this._updatePath(), this._container && this._map._pathRoot.appendChild(this._container), this.fire("add"), a.on({
                        viewreset: this.projectLatlngs,
                        moveend: this._updatePath
                    }, this)
                },
                addTo: function(a) {
                    return a.addLayer(this), this
                },
                onRemove: function(a) {
                    a._pathRoot.removeChild(this._container), this.fire("remove"), this._map = null, e.Browser.vml && (this._container = null, this._stroke = null, this._fill = null), a.off({
                        viewreset: this.projectLatlngs,
                        moveend: this._updatePath
                    }, this)
                },
                projectLatlngs: function() {},
                setStyle: function(a) {
                    return e.setOptions(this, a), this._container && this._updateStyle(), this
                },
                redraw: function() {
                    return this._map && (this.projectLatlngs(), this._updatePath()), this
                }
            }), e.Map.include({
                _updatePathViewport: function() {
                    var a = e.Path.CLIP_PADDING,
                        b = this.getSize(),
                        c = e.DomUtil.getPosition(this._mapPane),
                        d = c.multiplyBy(-1)._subtract(b.multiplyBy(a)._round()),
                        f = d.add(b.multiplyBy(1 + 2 * a)._round());
                    this._pathViewport = new e.Bounds(d, f)
                }
            }), e.Path.SVG_NS = "http://www.w3.org/2000/svg", e.Browser.svg = !!b.createElementNS && !!b.createElementNS(e.Path.SVG_NS, "svg").createSVGRect, e.Path = e.Path.extend({
                statics: {
                    SVG: e.Browser.svg
                },
                bringToFront: function() {
                    var a = this._map._pathRoot,
                        b = this._container;
                    return b && a.lastChild !== b && a.appendChild(b), this
                },
                bringToBack: function() {
                    var a = this._map._pathRoot,
                        b = this._container,
                        c = a.firstChild;
                    return b && c !== b && a.insertBefore(b, c), this
                },
                getPathString: function() {},
                _createElement: function(a) {
                    return b.createElementNS(e.Path.SVG_NS, a)
                },
                _initElements: function() {
                    this._map._initPathRoot(), this._initPath(), this._initStyle()
                },
                _initPath: function() {
                    this._container = this._createElement("g"), this._path = this._createElement("path"), this.options.className && e.DomUtil.addClass(this._path, this.options.className), this._container.appendChild(this._path)
                },
                _initStyle: function() {
                    this.options.stroke && (this._path.setAttribute("stroke-linejoin", "round"), this._path.setAttribute("stroke-linecap", "round")), this.options.fill && this._path.setAttribute("fill-rule", "evenodd"), this.options.pointerEvents && this._path.setAttribute("pointer-events", this.options.pointerEvents), !this.options.clickable && !this.options.pointerEvents && this._path.setAttribute("pointer-events", "none"), this._updateStyle()
                },
                _updateStyle: function() {
                    this.options.stroke ? (this._path.setAttribute("stroke", this.options.color), this._path.setAttribute("stroke-opacity", this.options.opacity), this._path.setAttribute("stroke-width", this.options.weight), this.options.dashArray ? this._path.setAttribute("stroke-dasharray", this.options.dashArray) : this._path.removeAttribute("stroke-dasharray"), this.options.lineCap && this._path.setAttribute("stroke-linecap", this.options.lineCap), this.options.lineJoin && this._path.setAttribute("stroke-linejoin", this.options.lineJoin)) : this._path.setAttribute("stroke", "none"), this.options.fill ? (this._path.setAttribute("fill", this.options.fillColor || this.options.color), this._path.setAttribute("fill-opacity", this.options.fillOpacity)) : this._path.setAttribute("fill", "none")
                },
                _updatePath: function() {
                    var a = this.getPathString();
                    a || (a = "M0 0"), this._path.setAttribute("d", a)
                },
                _initEvents: function() {
                    if (this.options.clickable) {
                        (e.Browser.svg || !e.Browser.vml) && e.DomUtil.addClass(this._path, "leaflet-clickable"), e.DomEvent.on(this._container, "click", this._onMouseClick, this);
                        for (var a = ["dblclick", "mousedown", "mouseover", "mouseout", "mousemove", "contextmenu"], b = 0; b < a.length; b++) e.DomEvent.on(this._container, a[b], this._fireMouseEvent, this)
                    }
                },
                _onMouseClick: function(a) {
                    this._map.dragging && this._map.dragging.moved() || this._fireMouseEvent(a)
                },
                _fireMouseEvent: function(a) {
                    if (this._map && this.hasEventListeners(a.type)) {
                        var b = this._map,
                            c = b.mouseEventToContainerPoint(a),
                            d = b.containerPointToLayerPoint(c),
                            f = b.layerPointToLatLng(d);
                        this.fire(a.type, {
                            latlng: f,
                            layerPoint: d,
                            containerPoint: c,
                            originalEvent: a
                        }), "contextmenu" === a.type && e.DomEvent.preventDefault(a), "mousemove" !== a.type && e.DomEvent.stopPropagation(a)
                    }
                }
            }), e.Map.include({
                _initPathRoot: function() {
                    this._pathRoot || (this._pathRoot = e.Path.prototype._createElement("svg"), this._panes.overlayPane.appendChild(this._pathRoot), this.options.zoomAnimation && e.Browser.any3d ? (e.DomUtil.addClass(this._pathRoot, "leaflet-zoom-animated"), this.on({
                        zoomanim: this._animatePathZoom,
                        zoomend: this._endPathZoom
                    })) : e.DomUtil.addClass(this._pathRoot, "leaflet-zoom-hide"), this.on("moveend", this._updateSvgViewport), this._updateSvgViewport())
                },
                _animatePathZoom: function(a) {
                    var b = this.getZoomScale(a.zoom),
                        c = this._getCenterOffset(a.center)._multiplyBy(-b)._add(this._pathViewport.min);
                    this._pathRoot.style[e.DomUtil.TRANSFORM] = e.DomUtil.getTranslateString(c) + " scale(" + b + ") ", this._pathZooming = !0
                },
                _endPathZoom: function() {
                    this._pathZooming = !1
                },
                _updateSvgViewport: function() {
                    if (!this._pathZooming) {
                        this._updatePathViewport();
                        var a = this._pathViewport,
                            b = a.min,
                            c = a.max,
                            d = c.x - b.x,
                            f = c.y - b.y,
                            g = this._pathRoot,
                            h = this._panes.overlayPane;
                        e.Browser.mobileWebkit && h.removeChild(g), e.DomUtil.setPosition(g, b), g.setAttribute("width", d), g.setAttribute("height", f), g.setAttribute("viewBox", [b.x, b.y, d, f].join(" ")), e.Browser.mobileWebkit && h.appendChild(g)
                    }
                }
            }), e.Path.include({
                bindPopup: function(a, b) {
                    return a instanceof e.Popup ? this._popup = a : (this._popup && !b || (this._popup = new e.Popup(b, this)), this._popup.setContent(a)), this._popupHandlersAdded || (this.on("click", this._openPopup, this).on("remove", this.closePopup, this), this._popupHandlersAdded = !0), this
                },
                unbindPopup: function() {
                    return this._popup && (this._popup = null, this.off("click", this._openPopup).off("remove", this.closePopup), this._popupHandlersAdded = !1), this
                },
                openPopup: function(a) {
                    return this._popup && (a = a || this._latlng || this._latlngs[Math.floor(this._latlngs.length / 2)], this._openPopup({
                        latlng: a
                    })), this
                },
                closePopup: function() {
                    return this._popup && this._popup._close(), this
                },
                _openPopup: function(a) {
                    this._popup.setLatLng(a.latlng), this._map.openPopup(this._popup)
                }
            }), e.Browser.vml = !e.Browser.svg && function() {
                try {
                    var a = b.createElement("div");
                    a.innerHTML = '<v:shape adj="1"/>';
                    var c = a.firstChild;
                    return c.style.behavior = "url(#default#VML)", c && "object" == typeof c.adj
                } catch (a) {
                    return !1
                }
            }(), e.Path = e.Browser.svg || !e.Browser.vml ? e.Path : e.Path.extend({
                statics: {
                    VML: !0,
                    CLIP_PADDING: .02
                },
                _createElement: function() {
                    try {
                        return b.namespaces.add("lvml", "urn:schemas-microsoft-com:vml"),
                            function(a) {
                                return b.createElement("<lvml:" + a + ' class="lvml">')
                            }
                    } catch (a) {
                        return function(a) {
                            return b.createElement("<" + a + ' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')
                        }
                    }
                }(),
                _initPath: function() {
                    var a = this._container = this._createElement("shape");
                    e.DomUtil.addClass(a, "leaflet-vml-shape" + (this.options.className ? " " + this.options.className : "")), this.options.clickable && e.DomUtil.addClass(a, "leaflet-clickable"), a.coordsize = "1 1", this._path = this._createElement("path"), a.appendChild(this._path), this._map._pathRoot.appendChild(a)
                },
                _initStyle: function() {
                    this._updateStyle()
                },
                _updateStyle: function() {
                    var a = this._stroke,
                        b = this._fill,
                        c = this.options,
                        d = this._container;
                    d.stroked = c.stroke, d.filled = c.fill, c.stroke ? (a || (a = this._stroke = this._createElement("stroke"), a.endcap = "round", d.appendChild(a)), a.weight = c.weight + "px", a.color = c.color, a.opacity = c.opacity, c.dashArray ? a.dashStyle = e.Util.isArray(c.dashArray) ? c.dashArray.join(" ") : c.dashArray.replace(/( *, *)/g, " ") : a.dashStyle = "", c.lineCap && (a.endcap = c.lineCap.replace("butt", "flat")), c.lineJoin && (a.joinstyle = c.lineJoin)) : a && (d.removeChild(a), this._stroke = null), c.fill ? (b || (b = this._fill = this._createElement("fill"), d.appendChild(b)), b.color = c.fillColor || c.color, b.opacity = c.fillOpacity) : b && (d.removeChild(b), this._fill = null)
                },
                _updatePath: function() {
                    var a = this._container.style;
                    a.display = "none", this._path.v = this.getPathString() + " ", a.display = ""
                }
            }), e.Map.include(e.Browser.svg || !e.Browser.vml ? {} : {
                _initPathRoot: function() {
                    if (!this._pathRoot) {
                        var a = this._pathRoot = b.createElement("div");
                        a.className = "leaflet-vml-container", this._panes.overlayPane.appendChild(a), this.on("moveend", this._updatePathViewport), this._updatePathViewport()
                    }
                }
            }), e.Browser.canvas = function() {
                return !!b.createElement("canvas").getContext
            }(), e.Path = e.Path.SVG && !a.L_PREFER_CANVAS || !e.Browser.canvas ? e.Path : e.Path.extend({
                statics: {
                    CANVAS: !0,
                    SVG: !1
                },
                redraw: function() {
                    return this._map && (this.projectLatlngs(), this._requestUpdate()), this
                },
                setStyle: function(a) {
                    return e.setOptions(this, a), this._map && (this._updateStyle(), this._requestUpdate()), this
                },
                onRemove: function(a) {
                    a.off("viewreset", this.projectLatlngs, this).off("moveend", this._updatePath, this), this.options.clickable && (this._map.off("click", this._onClick, this), this._map.off("mousemove", this._onMouseMove, this)), this._requestUpdate(), this.fire("remove"), this._map = null
                },
                _requestUpdate: function() {
                    this._map && !e.Path._updateRequest && (e.Path._updateRequest = e.Util.requestAnimFrame(this._fireMapMoveEnd, this._map))
                },
                _fireMapMoveEnd: function() {
                    e.Path._updateRequest = null, this.fire("moveend")
                },
                _initElements: function() {
                    this._map._initPathRoot(), this._ctx = this._map._canvasCtx
                },
                _updateStyle: function() {
                    var a = this.options;
                    a.stroke && (this._ctx.lineWidth = a.weight, this._ctx.strokeStyle = a.color), a.fill && (this._ctx.fillStyle = a.fillColor || a.color), a.lineCap && (this._ctx.lineCap = a.lineCap), a.lineJoin && (this._ctx.lineJoin = a.lineJoin)
                },
                _drawPath: function() {
                    var a, b, c, d, f, g;
                    for (this._ctx.beginPath(), a = 0, c = this._parts.length; a < c; a++) {
                        for (b = 0, d = this._parts[a].length; b < d; b++) f = this._parts[a][b], g = (0 === b ? "move" : "line") + "To", this._ctx[g](f.x, f.y);
                        this instanceof e.Polygon && this._ctx.closePath()
                    }
                },
                _checkIfEmpty: function() {
                    return !this._parts.length
                },
                _updatePath: function() {
                    if (!this._checkIfEmpty()) {
                        var a = this._ctx,
                            b = this.options;
                        this._drawPath(), a.save(), this._updateStyle(), b.fill && (a.globalAlpha = b.fillOpacity, a.fill(b.fillRule || "evenodd")), b.stroke && (a.globalAlpha = b.opacity, a.stroke()), a.restore()
                    }
                },
                _initEvents: function() {
                    this.options.clickable && (this._map.on("mousemove", this._onMouseMove, this), this._map.on("click dblclick contextmenu", this._fireMouseEvent, this))
                },
                _fireMouseEvent: function(a) {
                    this._containsPoint(a.layerPoint) && this.fire(a.type, a)
                },
                _onMouseMove: function(a) {
                    this._map && !this._map._animatingZoom && (this._containsPoint(a.layerPoint) ? (this._ctx.canvas.style.cursor = "pointer", this._mouseInside = !0, this.fire("mouseover", a)) : this._mouseInside && (this._ctx.canvas.style.cursor = "", this._mouseInside = !1, this.fire("mouseout", a)))
                }
            }), e.Map.include(e.Path.SVG && !a.L_PREFER_CANVAS || !e.Browser.canvas ? {} : {
                _initPathRoot: function() {
                    var c, a = this._pathRoot;
                    a || (a = this._pathRoot = b.createElement("canvas"), a.style.position = "absolute", c = this._canvasCtx = a.getContext("2d"), c.lineCap = "round", c.lineJoin = "round", this._panes.overlayPane.appendChild(a), this.options.zoomAnimation && (this._pathRoot.className = "leaflet-zoom-animated", this.on("zoomanim", this._animatePathZoom), this.on("zoomend", this._endPathZoom)), this.on("moveend", this._updateCanvasViewport), this._updateCanvasViewport())
                },
                _updateCanvasViewport: function() {
                    if (!this._pathZooming) {
                        this._updatePathViewport();
                        var a = this._pathViewport,
                            b = a.min,
                            c = a.max.subtract(b),
                            d = this._pathRoot;
                        e.DomUtil.setPosition(d, b), d.width = c.x, d.height = c.y, d.getContext("2d").translate(-b.x, -b.y)
                    }
                }
            }), e.LineUtil = {
                simplify: function(a, b) {
                    if (!b || !a.length) return a.slice();
                    var c = b * b;
                    return a = this._reducePoints(a, c), a = this._simplifyDP(a, c)
                },
                pointToSegmentDistance: function(a, b, c) {
                    return Math.sqrt(this._sqClosestPointOnSegment(a, b, c, !0))
                },
                closestPointOnSegment: function(a, b, c) {
                    return this._sqClosestPointOnSegment(a, b, c)
                },
                _simplifyDP: function(a, b) {
                    var d = a.length,
                        e = typeof Uint8Array != c + "" ? Uint8Array : Array,
                        f = new e(d);
                    f[0] = f[d - 1] = 1, this._simplifyDPStep(a, f, b, 0, d - 1);
                    var g, h = [];
                    for (g = 0; g < d; g++) f[g] && h.push(a[g]);
                    return h
                },
                _simplifyDPStep: function(a, b, c, d, e) {
                    var g, h, i, f = 0;
                    for (h = d + 1; h <= e - 1; h++) i = this._sqClosestPointOnSegment(a[h], a[d], a[e], !0), i > f && (g = h, f = i);
                    f > c && (b[g] = 1, this._simplifyDPStep(a, b, c, d, g), this._simplifyDPStep(a, b, c, g, e))
                },
                _reducePoints: function(a, b) {
                    for (var c = [a[0]], d = 1, e = 0, f = a.length; d < f; d++) this._sqDist(a[d], a[e]) > b && (c.push(a[d]), e = d);
                    return e < f - 1 && c.push(a[f - 1]), c
                },
                clipSegment: function(a, b, c, d) {
                    var g, h, i, e = d ? this._lastCode : this._getBitCode(a, c),
                        f = this._getBitCode(b, c);
                    for (this._lastCode = f;;) {
                        if (!(e | f)) return [a, b];
                        if (e & f) return !1;
                        g = e || f, h = this._getEdgeIntersection(a, b, g, c), i = this._getBitCode(h, c), g === e ? (a = h, e = i) : (b = h, f = i)
                    }
                },
                _getEdgeIntersection: function(a, b, c, d) {
                    var f = b.x - a.x,
                        g = b.y - a.y,
                        h = d.min,
                        i = d.max;
                    return 8 & c ? new e.Point(a.x + f * (i.y - a.y) / g, i.y) : 4 & c ? new e.Point(a.x + f * (h.y - a.y) / g, h.y) : 2 & c ? new e.Point(i.x, a.y + g * (i.x - a.x) / f) : 1 & c ? new e.Point(h.x, a.y + g * (h.x - a.x) / f) : void 0
                },
                _getBitCode: function(a, b) {
                    var c = 0;
                    return a.x < b.min.x ? c |= 1 : a.x > b.max.x && (c |= 2), a.y < b.min.y ? c |= 4 : a.y > b.max.y && (c |= 8), c
                },
                _sqDist: function(a, b) {
                    var c = b.x - a.x,
                        d = b.y - a.y;
                    return c * c + d * d
                },
                _sqClosestPointOnSegment: function(a, b, c, d) {
                    var k, f = b.x,
                        g = b.y,
                        h = c.x - f,
                        i = c.y - g,
                        j = h * h + i * i;
                    return j > 0 && (k = ((a.x - f) * h + (a.y - g) * i) / j, k > 1 ? (f = c.x, g = c.y) : k > 0 && (f += h * k, g += i * k)), h = a.x - f, i = a.y - g, d ? h * h + i * i : new e.Point(f, g)
                }
            }, e.Polyline = e.Path.extend({
                initialize: function(a, b) {
                    e.Path.prototype.initialize.call(this, b), this._latlngs = this._convertLatLngs(a)
                },
                options: {
                    smoothFactor: 1,
                    noClip: !1
                },
                projectLatlngs: function() {
                    this._originalPoints = [];
                    for (var a = 0, b = this._latlngs.length; a < b; a++) this._originalPoints[a] = this._map.latLngToLayerPoint(this._latlngs[a])
                },
                getPathString: function() {
                    for (var a = 0, b = this._parts.length, c = ""; a < b; a++) c += this._getPathPartStr(this._parts[a]);
                    return c
                },
                getLatLngs: function() {
                    return this._latlngs
                },
                setLatLngs: function(a) {
                    return this._latlngs = this._convertLatLngs(a), this.redraw()
                },
                addLatLng: function(a) {
                    return this._latlngs.push(e.latLng(a)), this.redraw()
                },
                spliceLatLngs: function() {
                    var a = [].splice.apply(this._latlngs, arguments);
                    return this._convertLatLngs(this._latlngs, !0), this.redraw(), a
                },
                closestLayerPoint: function(a) {
                    for (var d, f, b = 1 / 0, c = this._parts, g = null, h = 0, i = c.length; h < i; h++)
                        for (var j = c[h], k = 1, l = j.length; k < l; k++) {
                            d = j[k - 1], f = j[k];
                            var m = e.LineUtil._sqClosestPointOnSegment(a, d, f, !0);
                            m < b && (b = m, g = e.LineUtil._sqClosestPointOnSegment(a, d, f))
                        }
                    return g && (g.distance = Math.sqrt(b)), g
                },
                getBounds: function() {
                    return new e.LatLngBounds(this.getLatLngs())
                },
                _convertLatLngs: function(a, b) {
                    var c, d, f = b ? a : [];
                    for (c = 0, d = a.length; c < d; c++) {
                        if (e.Util.isArray(a[c]) && "number" != typeof a[c][0]) return;
                        f[c] = e.latLng(a[c])
                    }
                    return f
                },
                _initEvents: function() {
                    e.Path.prototype._initEvents.call(this)
                },
                _getPathPartStr: function(a) {
                    for (var g, b = e.Path.VML, c = 0, d = a.length, f = ""; c < d; c++) g = a[c], b && g._round(), f += (c ? "L" : "M") + g.x + " " + g.y;
                    return f
                },
                _clipPoints: function() {
                    var c, d, f, a = this._originalPoints,
                        b = a.length;
                    if (this.options.noClip) return void(this._parts = [a]);
                    this._parts = [];
                    var g = this._parts,
                        h = this._map._pathViewport,
                        i = e.LineUtil;
                    for (c = 0, d = 0; c < b - 1; c++) f = i.clipSegment(a[c], a[c + 1], h, c), f && (g[d] = g[d] || [], g[d].push(f[0]), f[1] === a[c + 1] && c !== b - 2 || (g[d].push(f[1]), d++))
                },
                _simplifyPoints: function() {
                    for (var a = this._parts, b = e.LineUtil, c = 0, d = a.length; c < d; c++) a[c] = b.simplify(a[c], this.options.smoothFactor)
                },
                _updatePath: function() {
                    this._map && (this._clipPoints(), this._simplifyPoints(), e.Path.prototype._updatePath.call(this))
                }
            }), e.polyline = function(a, b) {
                return new e.Polyline(a, b)
            }, e.PolyUtil = {}, e.PolyUtil.clipPolygon = function(a, b) {
                var c, f, g, h, i, j, k, l, m, d = [1, 4, 2, 8],
                    n = e.LineUtil;
                for (f = 0, k = a.length; f < k; f++) a[f]._code = n._getBitCode(a[f], b);
                for (h = 0; h < 4; h++) {
                    for (l = d[h], c = [], f = 0, k = a.length, g = k - 1; f < k; g = f++) i = a[f], j = a[g], i._code & l ? j._code & l || (m = n._getEdgeIntersection(j, i, l, b), m._code = n._getBitCode(m, b), c.push(m)) : (j._code & l && (m = n._getEdgeIntersection(j, i, l, b), m._code = n._getBitCode(m, b), c.push(m)), c.push(i));
                    a = c
                }
                return a
            }, e.Polygon = e.Polyline.extend({
                options: {
                    fill: !0
                },
                initialize: function(a, b) {
                    e.Polyline.prototype.initialize.call(this, a, b), this._initWithHoles(a)
                },
                _initWithHoles: function(a) {
                    var b, c, d;
                    if (a && e.Util.isArray(a[0]) && "number" != typeof a[0][0])
                        for (this._latlngs = this._convertLatLngs(a[0]), this._holes = a.slice(1), b = 0, c = this._holes.length; b < c; b++) d = this._holes[b] = this._convertLatLngs(this._holes[b]), d[0].equals(d[d.length - 1]) && d.pop();
                    a = this._latlngs, a.length >= 2 && a[0].equals(a[a.length - 1]) && a.pop()
                },
                projectLatlngs: function() {
                    if (e.Polyline.prototype.projectLatlngs.call(this), this._holePoints = [], this._holes) {
                        var a, b, c, d;
                        for (a = 0, c = this._holes.length; a < c; a++)
                            for (this._holePoints[a] = [], b = 0, d = this._holes[a].length; b < d; b++) this._holePoints[a][b] = this._map.latLngToLayerPoint(this._holes[a][b])
                    }
                },
                setLatLngs: function(a) {
                    return a && e.Util.isArray(a[0]) && "number" != typeof a[0][0] ? (this._initWithHoles(a), this.redraw()) : e.Polyline.prototype.setLatLngs.call(this, a)
                },
                _clipPoints: function() {
                    var a = this._originalPoints,
                        b = [];
                    if (this._parts = [a].concat(this._holePoints), !this.options.noClip) {
                        for (var c = 0, d = this._parts.length; c < d; c++) {
                            var f = e.PolyUtil.clipPolygon(this._parts[c], this._map._pathViewport);
                            f.length && b.push(f)
                        }
                        this._parts = b
                    }
                },
                _getPathPartStr: function(a) {
                    var b = e.Polyline.prototype._getPathPartStr.call(this, a);
                    return b + (e.Browser.svg ? "z" : "x")
                }
            }), e.polygon = function(a, b) {
                return new e.Polygon(a, b)
            },
            function() {
                function a(a) {
                    return e.FeatureGroup.extend({
                        initialize: function(a, b) {
                            this._layers = {}, this._options = b, this.setLatLngs(a)
                        },
                        setLatLngs: function(b) {
                            var c = 0,
                                d = b.length;
                            for (this.eachLayer(function(a) {
                                    c < d ? a.setLatLngs(b[c++]) : this.removeLayer(a)
                                }, this); c < d;) this.addLayer(new a(b[c++], this._options));
                            return this
                        },
                        getLatLngs: function() {
                            var a = [];
                            return this.eachLayer(function(b) {
                                a.push(b.getLatLngs())
                            }), a
                        }
                    })
                }
                e.MultiPolyline = a(e.Polyline), e.MultiPolygon = a(e.Polygon), e.multiPolyline = function(a, b) {
                    return new e.MultiPolyline(a, b)
                }, e.multiPolygon = function(a, b) {
                    return new e.MultiPolygon(a, b)
                }
            }(), e.Rectangle = e.Polygon.extend({
                initialize: function(a, b) {
                    e.Polygon.prototype.initialize.call(this, this._boundsToLatLngs(a), b)
                },
                setBounds: function(a) {
                    this.setLatLngs(this._boundsToLatLngs(a))
                },
                _boundsToLatLngs: function(a) {
                    return a = e.latLngBounds(a), [a.getSouthWest(), a.getNorthWest(), a.getNorthEast(), a.getSouthEast()]
                }
            }), e.rectangle = function(a, b) {
                return new e.Rectangle(a, b)
            }, e.Circle = e.Path.extend({
                initialize: function(a, b, c) {
                    e.Path.prototype.initialize.call(this, c), this._latlng = e.latLng(a), this._mRadius = b
                },
                options: {
                    fill: !0
                },
                setLatLng: function(a) {
                    return this._latlng = e.latLng(a), this.redraw()
                },
                setRadius: function(a) {
                    return this._mRadius = a, this.redraw()
                },
                projectLatlngs: function() {
                    var a = this._getLngRadius(),
                        b = this._latlng,
                        c = this._map.latLngToLayerPoint([b.lat, b.lng - a]);
                    this._point = this._map.latLngToLayerPoint(b), this._radius = Math.max(this._point.x - c.x, 1)
                },
                getBounds: function() {
                    var a = this._getLngRadius(),
                        b = this._mRadius / 40075017 * 360,
                        c = this._latlng;
                    return new e.LatLngBounds([c.lat - b, c.lng - a], [c.lat + b, c.lng + a])
                },
                getLatLng: function() {
                    return this._latlng
                },
                getPathString: function() {
                    var a = this._point,
                        b = this._radius;
                    return this._checkIfEmpty() ? "" : e.Browser.svg ? "M" + a.x + "," + (a.y - b) + "A" + b + "," + b + ",0,1,1," + (a.x - .1) + "," + (a.y - b) + " z" : (a._round(), b = Math.round(b), "AL " + a.x + "," + a.y + " " + b + "," + b + " 0,23592600")
                },
                getRadius: function() {
                    return this._mRadius
                },
                _getLatRadius: function() {
                    return this._mRadius / 40075017 * 360
                },
                _getLngRadius: function() {
                    return this._getLatRadius() / Math.cos(e.LatLng.DEG_TO_RAD * this._latlng.lat)
                },
                _checkIfEmpty: function() {
                    if (!this._map) return !1;
                    var a = this._map._pathViewport,
                        b = this._radius,
                        c = this._point;
                    return c.x - b > a.max.x || c.y - b > a.max.y || c.x + b < a.min.x || c.y + b < a.min.y
                }
            }), e.circle = function(a, b, c) {
                return new e.Circle(a, b, c)
            }, e.CircleMarker = e.Circle.extend({
                options: {
                    radius: 10,
                    weight: 2
                },
                initialize: function(a, b) {
                    e.Circle.prototype.initialize.call(this, a, null, b), this._radius = this.options.radius
                },
                projectLatlngs: function() {
                    this._point = this._map.latLngToLayerPoint(this._latlng)
                },
                _updateStyle: function() {
                    e.Circle.prototype._updateStyle.call(this), this.setRadius(this.options.radius)
                },
                setLatLng: function(a) {
                    return e.Circle.prototype.setLatLng.call(this, a), this._popup && this._popup._isOpen && this._popup.setLatLng(a), this
                },
                setRadius: function(a) {
                    return this.options.radius = this._radius = a, this.redraw()
                },
                getRadius: function() {
                    return this._radius
                }
            }), e.circleMarker = function(a, b) {
                return new e.CircleMarker(a, b)
            }, e.Polyline.include(e.Path.CANVAS ? {
                _containsPoint: function(a, b) {
                    var c, d, f, g, h, i, j, k = this.options.weight / 2;
                    for (e.Browser.touch && (k += 10), c = 0, g = this._parts.length; c < g; c++)
                        for (j = this._parts[c], d = 0, h = j.length, f = h - 1; d < h; f = d++)
                            if ((b || 0 !== d) && (i = e.LineUtil.pointToSegmentDistance(a, j[f], j[d]), i <= k)) return !0;
                    return !1
                }
            } : {}), e.Polygon.include(e.Path.CANVAS ? {
                _containsPoint: function(a) {
                    var c, d, f, g, h, i, j, k, b = !1;
                    if (e.Polyline.prototype._containsPoint.call(this, a, !0)) return !0;
                    for (g = 0, j = this._parts.length; g < j; g++)
                        for (c = this._parts[g], h = 0, k = c.length, i = k - 1; h < k; i = h++) d = c[h], f = c[i], d.y > a.y != f.y > a.y && a.x < (f.x - d.x) * (a.y - d.y) / (f.y - d.y) + d.x && (b = !b);
                    return b
                }
            } : {}), e.Circle.include(e.Path.CANVAS ? {
                _drawPath: function() {
                    var a = this._point;
                    this._ctx.beginPath(), this._ctx.arc(a.x, a.y, this._radius, 0, 2 * Math.PI, !1);
                },
                _containsPoint: function(a) {
                    var b = this._point,
                        c = this.options.stroke ? this.options.weight / 2 : 0;
                    return a.distanceTo(b) <= this._radius + c
                }
            } : {}), e.CircleMarker.include(e.Path.CANVAS ? {
                _updateStyle: function() {
                    e.Path.prototype._updateStyle.call(this)
                }
            } : {}), e.GeoJSON = e.FeatureGroup.extend({
                initialize: function(a, b) {
                    e.setOptions(this, b), this._layers = {}, a && this.addData(a)
                },
                addData: function(a) {
                    var c, d, f, b = e.Util.isArray(a) ? a : a.features;
                    if (b) {
                        for (c = 0, d = b.length; c < d; c++) f = b[c], (f.geometries || f.geometry || f.features || f.coordinates) && this.addData(b[c]);
                        return this
                    }
                    var g = this.options;
                    if (!g.filter || g.filter(a)) {
                        var h = e.GeoJSON.geometryToLayer(a, g.pointToLayer, g.coordsToLatLng, g);
                        return h.feature = e.GeoJSON.asFeature(a), h.defaultOptions = h.options, this.resetStyle(h), g.onEachFeature && g.onEachFeature(a, h), this.addLayer(h)
                    }
                },
                resetStyle: function(a) {
                    var b = this.options.style;
                    b && (e.Util.extend(a.options, a.defaultOptions), this._setLayerStyle(a, b))
                },
                setStyle: function(a) {
                    this.eachLayer(function(b) {
                        this._setLayerStyle(b, a)
                    }, this)
                },
                _setLayerStyle: function(a, b) {
                    "function" == typeof b && (b = b(a.feature)), a.setStyle && a.setStyle(b)
                }
            }), e.extend(e.GeoJSON, {
                geometryToLayer: function(a, b, c, d) {
                    var i, j, k, l, f = "Feature" === a.type ? a.geometry : a,
                        g = f.coordinates,
                        h = [];
                    switch (c = c || this.coordsToLatLng, f.type) {
                        case "Point":
                            return i = c(g), b ? b(a, i) : new e.Marker(i);
                        case "MultiPoint":
                            for (k = 0, l = g.length; k < l; k++) i = c(g[k]), h.push(b ? b(a, i) : new e.Marker(i));
                            return new e.FeatureGroup(h);
                        case "LineString":
                            return j = this.coordsToLatLngs(g, 0, c), new e.Polyline(j, d);
                        case "Polygon":
                            if (2 === g.length && !g[1].length) throw new Error("Invalid GeoJSON object.");
                            return j = this.coordsToLatLngs(g, 1, c), new e.Polygon(j, d);
                        case "MultiLineString":
                            return j = this.coordsToLatLngs(g, 1, c), new e.MultiPolyline(j, d);
                        case "MultiPolygon":
                            return j = this.coordsToLatLngs(g, 2, c), new e.MultiPolygon(j, d);
                        case "GeometryCollection":
                            for (k = 0, l = f.geometries.length; k < l; k++) h.push(this.geometryToLayer({
                                geometry: f.geometries[k],
                                type: "Feature",
                                properties: a.properties
                            }, b, c, d));
                            return new e.FeatureGroup(h);
                        default:
                            throw new Error("Invalid GeoJSON object.")
                    }
                },
                coordsToLatLng: function(a) {
                    return new e.LatLng(a[1], a[0], a[2])
                },
                coordsToLatLngs: function(a, b, c) {
                    var d, e, f, g = [];
                    for (e = 0, f = a.length; e < f; e++) d = b ? this.coordsToLatLngs(a[e], b - 1, c) : (c || this.coordsToLatLng)(a[e]), g.push(d);
                    return g
                },
                latLngToCoords: function(a) {
                    var b = [a.lng, a.lat];
                    return a.alt !== c && b.push(a.alt), b
                },
                latLngsToCoords: function(a) {
                    for (var b = [], c = 0, d = a.length; c < d; c++) b.push(e.GeoJSON.latLngToCoords(a[c]));
                    return b
                },
                getFeature: function(a, b) {
                    return a.feature ? e.extend({}, a.feature, {
                        geometry: b
                    }) : e.GeoJSON.asFeature(b)
                },
                asFeature: function(a) {
                    return "Feature" === a.type ? a : {
                        type: "Feature",
                        properties: {},
                        geometry: a
                    }
                }
            });
        var g = {
            toGeoJSON: function() {
                return e.GeoJSON.getFeature(this, {
                    type: "Point",
                    coordinates: e.GeoJSON.latLngToCoords(this.getLatLng())
                })
            }
        };
        e.Marker.include(g), e.Circle.include(g), e.CircleMarker.include(g), e.Polyline.include({
                toGeoJSON: function() {
                    return e.GeoJSON.getFeature(this, {
                        type: "LineString",
                        coordinates: e.GeoJSON.latLngsToCoords(this.getLatLngs())
                    })
                }
            }), e.Polygon.include({
                toGeoJSON: function() {
                    var b, c, d, a = [e.GeoJSON.latLngsToCoords(this.getLatLngs())];
                    if (a[0].push(a[0][0]), this._holes)
                        for (b = 0, c = this._holes.length; b < c; b++) d = e.GeoJSON.latLngsToCoords(this._holes[b]), d.push(d[0]), a.push(d);
                    return e.GeoJSON.getFeature(this, {
                        type: "Polygon",
                        coordinates: a
                    })
                }
            }),
            function() {
                function a(a) {
                    return function() {
                        var b = [];
                        return this.eachLayer(function(a) {
                            b.push(a.toGeoJSON().geometry.coordinates)
                        }), e.GeoJSON.getFeature(this, {
                            type: a,
                            coordinates: b
                        })
                    }
                }
                e.MultiPolyline.include({
                    toGeoJSON: a("MultiLineString")
                }), e.MultiPolygon.include({
                    toGeoJSON: a("MultiPolygon")
                }), e.LayerGroup.include({
                    toGeoJSON: function() {
                        var d, b = this.feature && this.feature.geometry,
                            c = [];
                        if (b && "MultiPoint" === b.type) return a("MultiPoint").call(this);
                        var f = b && "GeometryCollection" === b.type;
                        return this.eachLayer(function(a) {
                            a.toGeoJSON && (d = a.toGeoJSON(), c.push(f ? d.geometry : e.GeoJSON.asFeature(d)))
                        }), f ? e.GeoJSON.getFeature(this, {
                            geometries: c,
                            type: "GeometryCollection"
                        }) : {
                            type: "FeatureCollection",
                            features: c
                        }
                    }
                })
            }(), e.geoJson = function(a, b) {
                return new e.GeoJSON(a, b)
            }, e.DomEvent = {
                addListener: function(a, b, c, d) {
                    var h, i, j, f = e.stamp(c),
                        g = "_leaflet_" + b + f;
                    return a[g] ? this : (h = function(b) {
                        return c.call(d || a, b || e.DomEvent._getEvent())
                    }, e.Browser.pointer && 0 === b.indexOf("touch") ? this.addPointerListener(a, b, h, f) : (e.Browser.touch && "dblclick" === b && this.addDoubleTapListener && this.addDoubleTapListener(a, h, f), "addEventListener" in a ? "mousewheel" === b ? (a.addEventListener("DOMMouseScroll", h, !1), a.addEventListener(b, h, !1)) : "mouseenter" === b || "mouseleave" === b ? (i = h, j = "mouseenter" === b ? "mouseover" : "mouseout", h = function(b) {
                        if (e.DomEvent._checkMouse(a, b)) return i(b)
                    }, a.addEventListener(j, h, !1)) : "click" === b && e.Browser.android ? (i = h, h = function(a) {
                        return e.DomEvent._filterClick(a, i)
                    }, a.addEventListener(b, h, !1)) : a.addEventListener(b, h, !1) : "attachEvent" in a && a.attachEvent("on" + b, h), a[g] = h, this))
                },
                removeListener: function(a, b, c) {
                    var d = e.stamp(c),
                        f = "_leaflet_" + b + d,
                        g = a[f];
                    return g ? (e.Browser.pointer && 0 === b.indexOf("touch") ? this.removePointerListener(a, b, d) : e.Browser.touch && "dblclick" === b && this.removeDoubleTapListener ? this.removeDoubleTapListener(a, d) : "removeEventListener" in a ? "mousewheel" === b ? (a.removeEventListener("DOMMouseScroll", g, !1), a.removeEventListener(b, g, !1)) : "mouseenter" === b || "mouseleave" === b ? a.removeEventListener("mouseenter" === b ? "mouseover" : "mouseout", g, !1) : a.removeEventListener(b, g, !1) : "detachEvent" in a && a.detachEvent("on" + b, g), a[f] = null, this) : this
                },
                stopPropagation: function(a) {
                    return a.stopPropagation ? a.stopPropagation() : a.cancelBubble = !0, e.DomEvent._skipped(a), this
                },
                disableScrollPropagation: function(a) {
                    var b = e.DomEvent.stopPropagation;
                    return e.DomEvent.on(a, "mousewheel", b).on(a, "MozMousePixelScroll", b)
                },
                disableClickPropagation: function(a) {
                    for (var b = e.DomEvent.stopPropagation, c = e.Draggable.START.length - 1; c >= 0; c--) e.DomEvent.on(a, e.Draggable.START[c], b);
                    return e.DomEvent.on(a, "click", e.DomEvent._fakeStop).on(a, "dblclick", b)
                },
                preventDefault: function(a) {
                    return a.preventDefault ? a.preventDefault() : a.returnValue = !1, this
                },
                stop: function(a) {
                    return e.DomEvent.preventDefault(a).stopPropagation(a)
                },
                getMousePosition: function(a, b) {
                    if (!b) return new e.Point(a.clientX, a.clientY);
                    var c = b.getBoundingClientRect();
                    return new e.Point(a.clientX - c.left - b.clientLeft, a.clientY - c.top - b.clientTop)
                },
                getWheelDelta: function(a) {
                    var b = 0;
                    return a.wheelDelta && (b = a.wheelDelta / 120), a.detail && (b = -a.detail / 3), b
                },
                _skipEvents: {},
                _fakeStop: function(a) {
                    e.DomEvent._skipEvents[a.type] = !0
                },
                _skipped: function(a) {
                    var b = this._skipEvents[a.type];
                    return this._skipEvents[a.type] = !1, b
                },
                _checkMouse: function(a, b) {
                    var c = b.relatedTarget;
                    if (!c) return !0;
                    try {
                        for (; c && c !== a;) c = c.parentNode
                    } catch (a) {
                        return !1
                    }
                    return c !== a
                },
                _getEvent: function() {
                    var b = a.event;
                    if (!b)
                        for (var c = arguments.callee.caller; c && (b = c.arguments[0], !b || a.Event !== b.constructor);) c = c.caller;
                    return b
                },
                _filterClick: function(a, b) {
                    var c = a.timeStamp || a.originalEvent.timeStamp,
                        d = e.DomEvent._lastClick && c - e.DomEvent._lastClick;
                    return d && d > 100 && d < 500 || a.target._simulatedClick && !a._simulated ? void e.DomEvent.stop(a) : (e.DomEvent._lastClick = c, b(a))
                }
            }, e.DomEvent.on = e.DomEvent.addListener, e.DomEvent.off = e.DomEvent.removeListener, e.Draggable = e.Class.extend({
                includes: e.Mixin.Events,
                statics: {
                    START: e.Browser.touch ? ["touchstart", "mousedown"] : ["mousedown"],
                    END: {
                        mousedown: "mouseup",
                        touchstart: "touchend",
                        pointerdown: "touchend",
                        MSPointerDown: "touchend"
                    },
                    MOVE: {
                        mousedown: "mousemove",
                        touchstart: "touchmove",
                        pointerdown: "touchmove",
                        MSPointerDown: "touchmove"
                    }
                },
                initialize: function(a, b) {
                    this._element = a, this._dragStartTarget = b || a
                },
                enable: function() {
                    if (!this._enabled) {
                        for (var a = e.Draggable.START.length - 1; a >= 0; a--) e.DomEvent.on(this._dragStartTarget, e.Draggable.START[a], this._onDown, this);
                        this._enabled = !0
                    }
                },
                disable: function() {
                    if (this._enabled) {
                        for (var a = e.Draggable.START.length - 1; a >= 0; a--) e.DomEvent.off(this._dragStartTarget, e.Draggable.START[a], this._onDown, this);
                        this._enabled = !1, this._moved = !1
                    }
                },
                _onDown: function(a) {
                    if (this._moved = !1, !a.shiftKey && (1 === a.which || 1 === a.button || a.touches) && (e.DomEvent.stopPropagation(a), !e.Draggable._disabled && (e.DomUtil.disableImageDrag(), e.DomUtil.disableTextSelection(), !this._moving))) {
                        var c = a.touches ? a.touches[0] : a;
                        this._startPoint = new e.Point(c.clientX, c.clientY), this._startPos = this._newPos = e.DomUtil.getPosition(this._element), e.DomEvent.on(b, e.Draggable.MOVE[a.type], this._onMove, this).on(b, e.Draggable.END[a.type], this._onUp, this)
                    }
                },
                _onMove: function(a) {
                    if (a.touches && a.touches.length > 1) return void(this._moved = !0);
                    var c = a.touches && 1 === a.touches.length ? a.touches[0] : a,
                        d = new e.Point(c.clientX, c.clientY),
                        f = d.subtract(this._startPoint);
                    (f.x || f.y) && (e.Browser.touch && Math.abs(f.x) + Math.abs(f.y) < 3 || (e.DomEvent.preventDefault(a), this._moved || (this.fire("dragstart"), this._moved = !0, this._startPos = e.DomUtil.getPosition(this._element).subtract(f), e.DomUtil.addClass(b.body, "leaflet-dragging"), this._lastTarget = a.target || a.srcElement, e.DomUtil.addClass(this._lastTarget, "leaflet-drag-target")), this._newPos = this._startPos.add(f), this._moving = !0, e.Util.cancelAnimFrame(this._animRequest), this._animRequest = e.Util.requestAnimFrame(this._updatePosition, this, !0, this._dragStartTarget)))
                },
                _updatePosition: function() {
                    this.fire("predrag"), e.DomUtil.setPosition(this._element, this._newPos), this.fire("drag")
                },
                _onUp: function() {
                    e.DomUtil.removeClass(b.body, "leaflet-dragging"), this._lastTarget && (e.DomUtil.removeClass(this._lastTarget, "leaflet-drag-target"), this._lastTarget = null);
                    for (var a in e.Draggable.MOVE) e.DomEvent.off(b, e.Draggable.MOVE[a], this._onMove).off(b, e.Draggable.END[a], this._onUp);
                    e.DomUtil.enableImageDrag(), e.DomUtil.enableTextSelection(), this._moved && this._moving && (e.Util.cancelAnimFrame(this._animRequest), this.fire("dragend", {
                        distance: this._newPos.distanceTo(this._startPos)
                    })), this._moving = !1
                }
            }), e.Handler = e.Class.extend({
                initialize: function(a) {
                    this._map = a
                },
                enable: function() {
                    this._enabled || (this._enabled = !0, this.addHooks())
                },
                disable: function() {
                    this._enabled && (this._enabled = !1, this.removeHooks())
                },
                enabled: function() {
                    return !!this._enabled
                }
            }), e.Map.mergeOptions({
                dragging: !0,
                inertia: !e.Browser.android23,
                inertiaDeceleration: 3400,
                inertiaMaxSpeed: 1 / 0,
                inertiaThreshold: e.Browser.touch ? 32 : 18,
                easeLinearity: .25,
                worldCopyJump: !1
            }), e.Map.Drag = e.Handler.extend({
                addHooks: function() {
                    if (!this._draggable) {
                        var a = this._map;
                        this._draggable = new e.Draggable(a._mapPane, a._container), this._draggable.on({
                            dragstart: this._onDragStart,
                            drag: this._onDrag,
                            dragend: this._onDragEnd
                        }, this), a.options.worldCopyJump && (this._draggable.on("predrag", this._onPreDrag, this), a.on("viewreset", this._onViewReset, this), a.whenReady(this._onViewReset, this))
                    }
                    this._draggable.enable()
                },
                removeHooks: function() {
                    this._draggable.disable()
                },
                moved: function() {
                    return this._draggable && this._draggable._moved
                },
                _onDragStart: function() {
                    var a = this._map;
                    a._panAnim && a._panAnim.stop(), a.fire("movestart").fire("dragstart"), a.options.inertia && (this._positions = [], this._times = [])
                },
                _onDrag: function() {
                    if (this._map.options.inertia) {
                        var a = this._lastTime = +new Date,
                            b = this._lastPos = this._draggable._newPos;
                        this._positions.push(b), this._times.push(a), a - this._times[0] > 200 && (this._positions.shift(), this._times.shift())
                    }
                    this._map.fire("move").fire("drag")
                },
                _onViewReset: function() {
                    var a = this._map.getSize()._divideBy(2),
                        b = this._map.latLngToLayerPoint([0, 0]);
                    this._initialWorldOffset = b.subtract(a).x, this._worldWidth = this._map.project([0, 180]).x
                },
                _onPreDrag: function() {
                    var a = this._worldWidth,
                        b = Math.round(a / 2),
                        c = this._initialWorldOffset,
                        d = this._draggable._newPos.x,
                        e = (d - b + c) % a + b - c,
                        f = (d + b + c) % a - b - c,
                        g = Math.abs(e + c) < Math.abs(f + c) ? e : f;
                    this._draggable._newPos.x = g
                },
                _onDragEnd: function(a) {
                    var b = this._map,
                        c = b.options,
                        d = +new Date - this._lastTime,
                        f = !c.inertia || d > c.inertiaThreshold || !this._positions[0];
                    if (b.fire("dragend", a), f) b.fire("moveend");
                    else {
                        var g = this._lastPos.subtract(this._positions[0]),
                            h = (this._lastTime + d - this._times[0]) / 1e3,
                            i = c.easeLinearity,
                            j = g.multiplyBy(i / h),
                            k = j.distanceTo([0, 0]),
                            l = Math.min(c.inertiaMaxSpeed, k),
                            m = j.multiplyBy(l / k),
                            n = l / (c.inertiaDeceleration * i),
                            o = m.multiplyBy(-n / 2).round();
                        o.x && o.y ? (o = b._limitOffset(o, b.options.maxBounds), e.Util.requestAnimFrame(function() {
                            b.panBy(o, {
                                duration: n,
                                easeLinearity: i,
                                noMoveStart: !0
                            })
                        })) : b.fire("moveend")
                    }
                }
            }), e.Map.addInitHook("addHandler", "dragging", e.Map.Drag), e.Map.mergeOptions({
                doubleClickZoom: !0
            }), e.Map.DoubleClickZoom = e.Handler.extend({
                addHooks: function() {
                    this._map.on("dblclick", this._onDoubleClick, this)
                },
                removeHooks: function() {
                    this._map.off("dblclick", this._onDoubleClick, this)
                },
                _onDoubleClick: function(a) {
                    var b = this._map,
                        c = b.getZoom() + (a.originalEvent.shiftKey ? -1 : 1);
                    "center" === b.options.doubleClickZoom ? b.setZoom(c) : b.setZoomAround(a.containerPoint, c)
                }
            }), e.Map.addInitHook("addHandler", "doubleClickZoom", e.Map.DoubleClickZoom), e.Map.mergeOptions({
                scrollWheelZoom: !0
            }), e.Map.ScrollWheelZoom = e.Handler.extend({
                addHooks: function() {
                    e.DomEvent.on(this._map._container, "mousewheel", this._onWheelScroll, this), e.DomEvent.on(this._map._container, "MozMousePixelScroll", e.DomEvent.preventDefault), this._delta = 0
                },
                removeHooks: function() {
                    e.DomEvent.off(this._map._container, "mousewheel", this._onWheelScroll), e.DomEvent.off(this._map._container, "MozMousePixelScroll", e.DomEvent.preventDefault)
                },
                _onWheelScroll: function(a) {
                    var b = e.DomEvent.getWheelDelta(a);
                    this._delta += b, this._lastMousePos = this._map.mouseEventToContainerPoint(a), this._startTime || (this._startTime = +new Date);
                    var c = Math.max(40 - (+new Date - this._startTime), 0);
                    clearTimeout(this._timer), this._timer = setTimeout(e.bind(this._performZoom, this), c), e.DomEvent.preventDefault(a), e.DomEvent.stopPropagation(a)
                },
                _performZoom: function() {
                    var a = this._map,
                        b = this._delta,
                        c = a.getZoom();
                    b = b > 0 ? Math.ceil(b) : Math.floor(b), b = Math.max(Math.min(b, 4), -4), b = a._limitZoom(c + b) - c, this._delta = 0, this._startTime = null, b && ("center" === a.options.scrollWheelZoom ? a.setZoom(c + b) : a.setZoomAround(this._lastMousePos, c + b))
                }
            }), e.Map.addInitHook("addHandler", "scrollWheelZoom", e.Map.ScrollWheelZoom), e.extend(e.DomEvent, {
                _touchstart: e.Browser.msPointer ? "MSPointerDown" : e.Browser.pointer ? "pointerdown" : "touchstart",
                _touchend: e.Browser.msPointer ? "MSPointerUp" : e.Browser.pointer ? "pointerup" : "touchend",
                addDoubleTapListener: function(a, c, d) {
                    function f(a) {
                        var b;
                        if (e.Browser.pointer ? (o.push(a.pointerId), b = o.length) : b = a.touches.length, !(b > 1)) {
                            var c = Date.now(),
                                d = c - (h || c);
                            k = a.touches ? a.touches[0] : a, i = d > 0 && d <= j, h = c
                        }
                    }

                    function g(a) {
                        if (e.Browser.pointer) {
                            var b = o.indexOf(a.pointerId);
                            if (b === -1) return;
                            o.splice(b, 1)
                        }
                        if (i) {
                            if (e.Browser.pointer) {
                                var f, d = {};
                                for (var g in k) f = k[g], "function" == typeof f ? d[g] = f.bind(k) : d[g] = f;
                                k = d
                            }
                            k.type = "dblclick", c(k), h = null
                        }
                    }
                    var h, k, i = !1,
                        j = 250,
                        l = "_leaflet_",
                        m = this._touchstart,
                        n = this._touchend,
                        o = [];
                    a[l + m + d] = f, a[l + n + d] = g;
                    var p = e.Browser.pointer ? b.documentElement : a;
                    return a.addEventListener(m, f, !1), p.addEventListener(n, g, !1), e.Browser.pointer && p.addEventListener(e.DomEvent.POINTER_CANCEL, g, !1), this
                },
                removeDoubleTapListener: function(a, c) {
                    var d = "_leaflet_";
                    return a.removeEventListener(this._touchstart, a[d + this._touchstart + c], !1), (e.Browser.pointer ? b.documentElement : a).removeEventListener(this._touchend, a[d + this._touchend + c], !1), e.Browser.pointer && b.documentElement.removeEventListener(e.DomEvent.POINTER_CANCEL, a[d + this._touchend + c], !1), this
                }
            }), e.extend(e.DomEvent, {
                POINTER_DOWN: e.Browser.msPointer ? "MSPointerDown" : "pointerdown",
                POINTER_MOVE: e.Browser.msPointer ? "MSPointerMove" : "pointermove",
                POINTER_UP: e.Browser.msPointer ? "MSPointerUp" : "pointerup",
                POINTER_CANCEL: e.Browser.msPointer ? "MSPointerCancel" : "pointercancel",
                _pointers: [],
                _pointerDocumentListener: !1,
                addPointerListener: function(a, b, c, d) {
                    switch (b) {
                        case "touchstart":
                            return this.addPointerListenerStart(a, b, c, d);
                        case "touchend":
                            return this.addPointerListenerEnd(a, b, c, d);
                        case "touchmove":
                            return this.addPointerListenerMove(a, b, c, d);
                        default:
                            throw "Unknown touch event type"
                    }
                },
                addPointerListenerStart: function(a, c, d, f) {
                    var g = "_leaflet_",
                        h = this._pointers,
                        i = function(a) {
                            "mouse" !== a.pointerType && a.pointerType !== a.MSPOINTER_TYPE_MOUSE && e.DomEvent.preventDefault(a);
                            for (var b = !1, c = 0; c < h.length; c++)
                                if (h[c].pointerId === a.pointerId) {
                                    b = !0;
                                    break
                                }
                            b || h.push(a), a.touches = h.slice(), a.changedTouches = [a], d(a)
                        };
                    if (a[g + "touchstart" + f] = i, a.addEventListener(this.POINTER_DOWN, i, !1), !this._pointerDocumentListener) {
                        var j = function(a) {
                            for (var b = 0; b < h.length; b++)
                                if (h[b].pointerId === a.pointerId) {
                                    h.splice(b, 1);
                                    break
                                }
                        };
                        b.documentElement.addEventListener(this.POINTER_UP, j, !1), b.documentElement.addEventListener(this.POINTER_CANCEL, j, !1), this._pointerDocumentListener = !0
                    }
                    return this
                },
                addPointerListenerMove: function(a, b, c, d) {
                    function e(a) {
                        if (a.pointerType !== a.MSPOINTER_TYPE_MOUSE && "mouse" !== a.pointerType || 0 !== a.buttons) {
                            for (var b = 0; b < g.length; b++)
                                if (g[b].pointerId === a.pointerId) {
                                    g[b] = a;
                                    break
                                }
                            a.touches = g.slice(), a.changedTouches = [a], c(a)
                        }
                    }
                    var f = "_leaflet_",
                        g = this._pointers;
                    return a[f + "touchmove" + d] = e, a.addEventListener(this.POINTER_MOVE, e, !1), this
                },
                addPointerListenerEnd: function(a, b, c, d) {
                    var e = "_leaflet_",
                        f = this._pointers,
                        g = function(a) {
                            for (var b = 0; b < f.length; b++)
                                if (f[b].pointerId === a.pointerId) {
                                    f.splice(b, 1);
                                    break
                                }
                            a.touches = f.slice(), a.changedTouches = [a], c(a)
                        };
                    return a[e + "touchend" + d] = g, a.addEventListener(this.POINTER_UP, g, !1), a.addEventListener(this.POINTER_CANCEL, g, !1), this
                },
                removePointerListener: function(a, b, c) {
                    var d = "_leaflet_",
                        e = a[d + b + c];
                    switch (b) {
                        case "touchstart":
                            a.removeEventListener(this.POINTER_DOWN, e, !1);
                            break;
                        case "touchmove":
                            a.removeEventListener(this.POINTER_MOVE, e, !1);
                            break;
                        case "touchend":
                            a.removeEventListener(this.POINTER_UP, e, !1), a.removeEventListener(this.POINTER_CANCEL, e, !1)
                    }
                    return this
                }
            }), e.Map.mergeOptions({
                touchZoom: e.Browser.touch && !e.Browser.android23,
                bounceAtZoomLimits: !0
            }), e.Map.TouchZoom = e.Handler.extend({
                addHooks: function() {
                    e.DomEvent.on(this._map._container, "touchstart", this._onTouchStart, this)
                },
                removeHooks: function() {
                    e.DomEvent.off(this._map._container, "touchstart", this._onTouchStart, this)
                },
                _onTouchStart: function(a) {
                    var c = this._map;
                    if (a.touches && 2 === a.touches.length && !c._animatingZoom && !this._zooming) {
                        var d = c.mouseEventToLayerPoint(a.touches[0]),
                            f = c.mouseEventToLayerPoint(a.touches[1]),
                            g = c._getCenterLayerPoint();
                        this._startCenter = d.add(f)._divideBy(2), this._startDist = d.distanceTo(f), this._moved = !1, this._zooming = !0, this._centerOffset = g.subtract(this._startCenter), c._panAnim && c._panAnim.stop(), e.DomEvent.on(b, "touchmove", this._onTouchMove, this).on(b, "touchend", this._onTouchEnd, this), e.DomEvent.preventDefault(a)
                    }
                },
                _onTouchMove: function(a) {
                    var b = this._map;
                    if (a.touches && 2 === a.touches.length && this._zooming) {
                        var c = b.mouseEventToLayerPoint(a.touches[0]),
                            d = b.mouseEventToLayerPoint(a.touches[1]);
                        this._scale = c.distanceTo(d) / this._startDist, this._delta = c._add(d)._divideBy(2)._subtract(this._startCenter), 1 !== this._scale && (!b.options.bounceAtZoomLimits && (b.getZoom() === b.getMinZoom() && this._scale < 1 || b.getZoom() === b.getMaxZoom() && this._scale > 1) || (this._moved || (e.DomUtil.addClass(b._mapPane, "leaflet-touching"), b.fire("movestart").fire("zoomstart"), this._moved = !0), e.Util.cancelAnimFrame(this._animRequest), this._animRequest = e.Util.requestAnimFrame(this._updateOnMove, this, !0, this._map._container), e.DomEvent.preventDefault(a)))
                    }
                },
                _updateOnMove: function() {
                    var a = this._map,
                        b = this._getScaleOrigin(),
                        c = a.layerPointToLatLng(b),
                        d = a.getScaleZoom(this._scale);
                    a._animateZoom(c, d, this._startCenter, this._scale, this._delta, !1, !0)
                },
                _onTouchEnd: function() {
                    if (!this._moved || !this._zooming) return void(this._zooming = !1);
                    var a = this._map;
                    this._zooming = !1, e.DomUtil.removeClass(a._mapPane, "leaflet-touching"), e.Util.cancelAnimFrame(this._animRequest), e.DomEvent.off(b, "touchmove", this._onTouchMove).off(b, "touchend", this._onTouchEnd);
                    var c = this._getScaleOrigin(),
                        d = a.layerPointToLatLng(c),
                        f = a.getZoom(),
                        g = a.getScaleZoom(this._scale) - f,
                        h = g > 0 ? Math.ceil(g) : Math.floor(g),
                        i = a._limitZoom(f + h),
                        j = a.getZoomScale(i) / this._scale;
                    a._animateZoom(d, i, c, j)
                },
                _getScaleOrigin: function() {
                    var a = this._centerOffset.subtract(this._delta).divideBy(this._scale);
                    return this._startCenter.add(a)
                }
            }), e.Map.addInitHook("addHandler", "touchZoom", e.Map.TouchZoom), e.Map.mergeOptions({
                tap: !0,
                tapTolerance: 15
            }), e.Map.Tap = e.Handler.extend({
                addHooks: function() {
                    e.DomEvent.on(this._map._container, "touchstart", this._onDown, this)
                },
                removeHooks: function() {
                    e.DomEvent.off(this._map._container, "touchstart", this._onDown, this)
                },
                _onDown: function(a) {
                    if (a.touches) {
                        if (e.DomEvent.preventDefault(a), this._fireClick = !0, a.touches.length > 1) return this._fireClick = !1, void clearTimeout(this._holdTimeout);
                        var c = a.touches[0],
                            d = c.target;
                        this._startPos = this._newPos = new e.Point(c.clientX, c.clientY), d.tagName && "a" === d.tagName.toLowerCase() && e.DomUtil.addClass(d, "leaflet-active"), this._holdTimeout = setTimeout(e.bind(function() {
                            this._isTapValid() && (this._fireClick = !1, this._onUp(), this._simulateEvent("contextmenu", c))
                        }, this), 1e3), e.DomEvent.on(b, "touchmove", this._onMove, this).on(b, "touchend", this._onUp, this)
                    }
                },
                _onUp: function(a) {
                    if (clearTimeout(this._holdTimeout), e.DomEvent.off(b, "touchmove", this._onMove, this).off(b, "touchend", this._onUp, this), this._fireClick && a && a.changedTouches) {
                        var c = a.changedTouches[0],
                            d = c.target;
                        d && d.tagName && "a" === d.tagName.toLowerCase() && e.DomUtil.removeClass(d, "leaflet-active"), this._isTapValid() && this._simulateEvent("click", c)
                    }
                },
                _isTapValid: function() {
                    return this._newPos.distanceTo(this._startPos) <= this._map.options.tapTolerance
                },
                _onMove: function(a) {
                    var b = a.touches[0];
                    this._newPos = new e.Point(b.clientX, b.clientY)
                },
                _simulateEvent: function(c, d) {
                    var e = b.createEvent("MouseEvents");
                    e._simulated = !0, d.target._simulatedClick = !0, e.initMouseEvent(c, !0, !0, a, 1, d.screenX, d.screenY, d.clientX, d.clientY, !1, !1, !1, !1, 0, null), d.target.dispatchEvent(e)
                }
            }), e.Browser.touch && !e.Browser.pointer && e.Map.addInitHook("addHandler", "tap", e.Map.Tap), e.Map.mergeOptions({
                boxZoom: !0
            }), e.Map.BoxZoom = e.Handler.extend({
                initialize: function(a) {
                    this._map = a, this._container = a._container, this._pane = a._panes.overlayPane, this._moved = !1
                },
                addHooks: function() {
                    e.DomEvent.on(this._container, "mousedown", this._onMouseDown, this)
                },
                removeHooks: function() {
                    e.DomEvent.off(this._container, "mousedown", this._onMouseDown), this._moved = !1
                },
                moved: function() {
                    return this._moved
                },
                _onMouseDown: function(a) {
                    return this._moved = !1, !(!a.shiftKey || 1 !== a.which && 1 !== a.button) && (e.DomUtil.disableTextSelection(), e.DomUtil.disableImageDrag(), this._startLayerPoint = this._map.mouseEventToLayerPoint(a), e.DomEvent.on(b, "mousemove", this._onMouseMove, this).on(b, "mouseup", this._onMouseUp, this).on(b, "keydown", this._onKeyDown, this), void 0)
                },
                _onMouseMove: function(a) {
                    this._moved || (this._box = e.DomUtil.create("div", "leaflet-zoom-box", this._pane), e.DomUtil.setPosition(this._box, this._startLayerPoint), this._container.style.cursor = "crosshair", this._map.fire("boxzoomstart"));
                    var b = this._startLayerPoint,
                        c = this._box,
                        d = this._map.mouseEventToLayerPoint(a),
                        f = d.subtract(b),
                        g = new e.Point(Math.min(d.x, b.x), Math.min(d.y, b.y));
                    e.DomUtil.setPosition(c, g), this._moved = !0, c.style.width = Math.max(0, Math.abs(f.x) - 4) + "px", c.style.height = Math.max(0, Math.abs(f.y) - 4) + "px"
                },
                _finish: function() {
                    this._moved && (this._pane.removeChild(this._box), this._container.style.cursor = ""), e.DomUtil.enableTextSelection(), e.DomUtil.enableImageDrag(), e.DomEvent.off(b, "mousemove", this._onMouseMove).off(b, "mouseup", this._onMouseUp).off(b, "keydown", this._onKeyDown)
                },
                _onMouseUp: function(a) {
                    this._finish();
                    var b = this._map,
                        c = b.mouseEventToLayerPoint(a);
                    if (!this._startLayerPoint.equals(c)) {
                        var d = new e.LatLngBounds(b.layerPointToLatLng(this._startLayerPoint), b.layerPointToLatLng(c));
                        b.fitBounds(d), b.fire("boxzoomend", {
                            boxZoomBounds: d
                        })
                    }
                },
                _onKeyDown: function(a) {
                    27 === a.keyCode && this._finish()
                }
            }), e.Map.addInitHook("addHandler", "boxZoom", e.Map.BoxZoom), e.Map.mergeOptions({
                keyboard: !0,
                keyboardPanOffset: 80,
                keyboardZoomOffset: 1
            }), e.Map.Keyboard = e.Handler.extend({
                keyCodes: {
                    left: [37],
                    right: [39],
                    down: [40],
                    up: [38],
                    zoomIn: [187, 107, 61, 171],
                    zoomOut: [189, 109, 173]
                },
                initialize: function(a) {
                    this._map = a, this._setPanOffset(a.options.keyboardPanOffset), this._setZoomOffset(a.options.keyboardZoomOffset)
                },
                addHooks: function() {
                    var a = this._map._container;
                    a.tabIndex === -1 && (a.tabIndex = "0"), e.DomEvent.on(a, "focus", this._onFocus, this).on(a, "blur", this._onBlur, this).on(a, "mousedown", this._onMouseDown, this), this._map.on("focus", this._addHooks, this).on("blur", this._removeHooks, this)
                },
                removeHooks: function() {
                    this._removeHooks();
                    var a = this._map._container;
                    e.DomEvent.off(a, "focus", this._onFocus, this).off(a, "blur", this._onBlur, this).off(a, "mousedown", this._onMouseDown, this), this._map.off("focus", this._addHooks, this).off("blur", this._removeHooks, this)
                },
                _onMouseDown: function() {
                    if (!this._focused) {
                        var c = b.body,
                            d = b.documentElement,
                            e = c.scrollTop || d.scrollTop,
                            f = c.scrollLeft || d.scrollLeft;
                        this._map._container.focus(), a.scrollTo(f, e)
                    }
                },
                _onFocus: function() {
                    this._focused = !0, this._map.fire("focus")
                },
                _onBlur: function() {
                    this._focused = !1, this._map.fire("blur")
                },
                _setPanOffset: function(a) {
                    var d, e, b = this._panKeys = {},
                        c = this.keyCodes;
                    for (d = 0, e = c.left.length; d < e; d++) b[c.left[d]] = [-1 * a, 0];
                    for (d = 0, e = c.right.length; d < e; d++) b[c.right[d]] = [a, 0];
                    for (d = 0, e = c.down.length; d < e; d++) b[c.down[d]] = [0, a];
                    for (d = 0, e = c.up.length; d < e; d++) b[c.up[d]] = [0, -1 * a]
                },
                _setZoomOffset: function(a) {
                    var d, e, b = this._zoomKeys = {},
                        c = this.keyCodes;
                    for (d = 0, e = c.zoomIn.length; d < e; d++) b[c.zoomIn[d]] = a;
                    for (d = 0, e = c.zoomOut.length; d < e; d++) b[c.zoomOut[d]] = -a
                },
                _addHooks: function() {
                    e.DomEvent.on(b, "keydown", this._onKeyDown, this)
                },
                _removeHooks: function() {
                    e.DomEvent.off(b, "keydown", this._onKeyDown, this)
                },
                _onKeyDown: function(a) {
                    var b = a.keyCode,
                        c = this._map;
                    if (b in this._panKeys) {
                        if (c._panAnim && c._panAnim._inProgress) return;
                        c.panBy(this._panKeys[b]), c.options.maxBounds && c.panInsideBounds(c.options.maxBounds)
                    } else {
                        if (!(b in this._zoomKeys)) return;
                        c.setZoom(c.getZoom() + this._zoomKeys[b])
                    }
                    e.DomEvent.stop(a)
                }
            }), e.Map.addInitHook("addHandler", "keyboard", e.Map.Keyboard), e.Handler.MarkerDrag = e.Handler.extend({
                initialize: function(a) {
                    this._marker = a
                },
                addHooks: function() {
                    var a = this._marker._icon;
                    this._draggable || (this._draggable = new e.Draggable(a, a)), this._draggable.on("dragstart", this._onDragStart, this).on("drag", this._onDrag, this).on("dragend", this._onDragEnd, this), this._draggable.enable(), e.DomUtil.addClass(this._marker._icon, "leaflet-marker-draggable")
                },
                removeHooks: function() {
                    this._draggable.off("dragstart", this._onDragStart, this).off("drag", this._onDrag, this).off("dragend", this._onDragEnd, this), this._draggable.disable(), e.DomUtil.removeClass(this._marker._icon, "leaflet-marker-draggable")
                },
                moved: function() {
                    return this._draggable && this._draggable._moved
                },
                _onDragStart: function() {
                    this._marker.closePopup().fire("movestart").fire("dragstart")
                },
                _onDrag: function() {
                    var a = this._marker,
                        b = a._shadow,
                        c = e.DomUtil.getPosition(a._icon),
                        d = a._map.layerPointToLatLng(c);
                    b && e.DomUtil.setPosition(b, c), a._latlng = d, a.fire("move", {
                        latlng: d
                    }).fire("drag")
                },
                _onDragEnd: function(a) {
                    this._marker.fire("moveend").fire("dragend", a)
                }
            }), e.Control = e.Class.extend({
                options: {
                    position: "topright"
                },
                initialize: function(a) {
                    e.setOptions(this, a)
                },
                getPosition: function() {
                    return this.options.position
                },
                setPosition: function(a) {
                    var b = this._map;
                    return b && b.removeControl(this), this.options.position = a, b && b.addControl(this), this
                },
                getContainer: function() {
                    return this._container
                },
                addTo: function(a) {
                    this._map = a;
                    var b = this._container = this.onAdd(a),
                        c = this.getPosition(),
                        d = a._controlCorners[c];
                    return e.DomUtil.addClass(b, "leaflet-control"), c.indexOf("bottom") !== -1 ? d.insertBefore(b, d.firstChild) : d.appendChild(b), this
                },
                removeFrom: function(a) {
                    var b = this.getPosition(),
                        c = a._controlCorners[b];
                    return c.removeChild(this._container), this._map = null, this.onRemove && this.onRemove(a), this
                },
                _refocusOnMap: function() {
                    this._map && this._map.getContainer().focus()
                }
            }), e.control = function(a) {
                return new e.Control(a)
            }, e.Map.include({
                addControl: function(a) {
                    return a.addTo(this), this
                },
                removeControl: function(a) {
                    return a.removeFrom(this), this
                },
                _initControlPos: function() {
                    function a(a, f) {
                        var g = c + a + " " + c + f;
                        b[a + f] = e.DomUtil.create("div", g, d)
                    }
                    var b = this._controlCorners = {},
                        c = "leaflet-",
                        d = this._controlContainer = e.DomUtil.create("div", c + "control-container", this._container);
                    a("top", "left"), a("top", "right"), a("bottom", "left"), a("bottom", "right")
                },
                _clearControlPos: function() {
                    this._container.removeChild(this._controlContainer)
                }
            }), e.Control.Zoom = e.Control.extend({
                options: {
                    position: "topleft",
                    zoomInText: "+",
                    zoomInTitle: "Zoom in",
                    zoomOutText: "-",
                    zoomOutTitle: "Zoom out"
                },
                onAdd: function(a) {
                    var b = "leaflet-control-zoom",
                        c = e.DomUtil.create("div", b + " leaflet-bar");
                    return this._map = a, this._zoomInButton = this._createButton(this.options.zoomInText, this.options.zoomInTitle, b + "-in", c, this._zoomIn, this), this._zoomOutButton = this._createButton(this.options.zoomOutText, this.options.zoomOutTitle, b + "-out", c, this._zoomOut, this), this._updateDisabled(), a.on("zoomend zoomlevelschange", this._updateDisabled, this), c
                },
                onRemove: function(a) {
                    a.off("zoomend zoomlevelschange", this._updateDisabled, this)
                },
                _zoomIn: function(a) {
                    this._map.zoomIn(a.shiftKey ? 3 : 1)
                },
                _zoomOut: function(a) {
                    this._map.zoomOut(a.shiftKey ? 3 : 1)
                },
                _createButton: function(a, b, c, d, f, g) {
                    var h = e.DomUtil.create("a", c, d);
                    h.innerHTML = a, h.href = "#", h.title = b;
                    var i = e.DomEvent.stopPropagation;
                    return e.DomEvent.on(h, "click", i).on(h, "mousedown", i).on(h, "dblclick", i).on(h, "click", e.DomEvent.preventDefault).on(h, "click", f, g).on(h, "click", this._refocusOnMap, g), h
                },
                _updateDisabled: function() {
                    var a = this._map,
                        b = "leaflet-disabled";
                    e.DomUtil.removeClass(this._zoomInButton, b), e.DomUtil.removeClass(this._zoomOutButton, b), a._zoom === a.getMinZoom() && e.DomUtil.addClass(this._zoomOutButton, b), a._zoom === a.getMaxZoom() && e.DomUtil.addClass(this._zoomInButton, b)
                }
            }), e.Map.mergeOptions({
                zoomControl: !0
            }), e.Map.addInitHook(function() {
                this.options.zoomControl && (this.zoomControl = new e.Control.Zoom, this.addControl(this.zoomControl))
            }), e.control.zoom = function(a) {
                return new e.Control.Zoom(a)
            }, e.Control.Attribution = e.Control.extend({
                options: {
                    position: "bottomright",
                    prefix: '<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'
                },
                initialize: function(a) {
                    e.setOptions(this, a), this._attributions = {}
                },
                onAdd: function(a) {
                    this._container = e.DomUtil.create("div", "leaflet-control-attribution"), e.DomEvent.disableClickPropagation(this._container);
                    for (var b in a._layers) a._layers[b].getAttribution && this.addAttribution(a._layers[b].getAttribution());
                    return a.on("layeradd", this._onLayerAdd, this).on("layerremove", this._onLayerRemove, this), this._update(), this._container
                },
                onRemove: function(a) {
                    a.off("layeradd", this._onLayerAdd).off("layerremove", this._onLayerRemove)
                },
                setPrefix: function(a) {
                    return this.options.prefix = a, this._update(), this
                },
                addAttribution: function(a) {
                    if (a) return this._attributions[a] || (this._attributions[a] = 0), this._attributions[a]++, this._update(), this
                },
                removeAttribution: function(a) {
                    if (a) return this._attributions[a] && (this._attributions[a]--, this._update()), this
                },
                _update: function() {
                    if (this._map) {
                        var a = [];
                        for (var b in this._attributions) this._attributions[b] && a.push(b);
                        var c = [];
                        this.options.prefix && c.push(this.options.prefix), a.length && c.push(a.join(", ")), this._container.innerHTML = c.join(" | ")
                    }
                },
                _onLayerAdd: function(a) {
                    a.layer.getAttribution && this.addAttribution(a.layer.getAttribution())
                },
                _onLayerRemove: function(a) {
                    a.layer.getAttribution && this.removeAttribution(a.layer.getAttribution())
                }
            }), e.Map.mergeOptions({
                attributionControl: !0
            }), e.Map.addInitHook(function() {
                this.options.attributionControl && (this.attributionControl = (new e.Control.Attribution).addTo(this))
            }), e.control.attribution = function(a) {
                return new e.Control.Attribution(a)
            }, e.Control.Scale = e.Control.extend({
                options: {
                    position: "bottomleft",
                    maxWidth: 100,
                    metric: !0,
                    imperial: !0,
                    updateWhenIdle: !1
                },
                onAdd: function(a) {
                    this._map = a;
                    var b = "leaflet-control-scale",
                        c = e.DomUtil.create("div", b),
                        d = this.options;
                    return this._addScales(d, b, c), a.on(d.updateWhenIdle ? "moveend" : "move", this._update, this), a.whenReady(this._update, this), c
                },
                onRemove: function(a) {
                    a.off(this.options.updateWhenIdle ? "moveend" : "move", this._update, this)
                },
                _addScales: function(a, b, c) {
                    a.metric && (this._mScale = e.DomUtil.create("div", b + "-line", c)), a.imperial && (this._iScale = e.DomUtil.create("div", b + "-line", c))
                },
                _update: function() {
                    var a = this._map.getBounds(),
                        b = a.getCenter().lat,
                        c = 6378137 * Math.PI * Math.cos(b * Math.PI / 180),
                        d = c * (a.getNorthEast().lng - a.getSouthWest().lng) / 180,
                        e = this._map.getSize(),
                        f = this.options,
                        g = 0;
                    e.x > 0 && (g = d * (f.maxWidth / e.x)), this._updateScales(f, g)
                },
                _updateScales: function(a, b) {
                    a.metric && b && this._updateMetric(b), a.imperial && b && this._updateImperial(b)
                },
                _updateMetric: function(a) {
                    var b = this._getRoundNum(a);
                    this._mScale.style.width = this._getScaleWidth(b / a) + "px", this._mScale.innerHTML = b < 1e3 ? b + " m" : b / 1e3 + " km"
                },
                _updateImperial: function(a) {
                    var d, e, f, b = 3.2808399 * a,
                        c = this._iScale;
                    b > 5280 ? (d = b / 5280, e = this._getRoundNum(d), c.style.width = this._getScaleWidth(e / d) + "px", c.innerHTML = e + " mi") : (f = this._getRoundNum(b), c.style.width = this._getScaleWidth(f / b) + "px", c.innerHTML = f + " ft")
                },
                _getScaleWidth: function(a) {
                    return Math.round(this.options.maxWidth * a) - 10
                },
                _getRoundNum: function(a) {
                    var b = Math.pow(10, (Math.floor(a) + "").length - 1),
                        c = a / b;
                    return c = c >= 10 ? 10 : c >= 5 ? 5 : c >= 3 ? 3 : c >= 2 ? 2 : 1, b * c
                }
            }), e.control.scale = function(a) {
                return new e.Control.Scale(a)
            }, e.Control.Layers = e.Control.extend({
                options: {
                    collapsed: !0,
                    position: "topright",
                    autoZIndex: !0
                },
                initialize: function(a, b, c) {
                    e.setOptions(this, c), this._layers = {}, this._lastZIndex = 0, this._handlingClick = !1;
                    for (var d in a) this._addLayer(a[d], d);
                    for (d in b) this._addLayer(b[d], d, !0)
                },
                onAdd: function(a) {
                    return this._initLayout(), this._update(), a.on("layeradd", this._onLayerChange, this).on("layerremove", this._onLayerChange, this), this._container
                },
                onRemove: function(a) {
                    a.off("layeradd", this._onLayerChange, this).off("layerremove", this._onLayerChange, this)
                },
                addBaseLayer: function(a, b) {
                    return this._addLayer(a, b), this._update(), this
                },
                addOverlay: function(a, b) {
                    return this._addLayer(a, b, !0), this._update(), this
                },
                removeLayer: function(a) {
                    var b = e.stamp(a);
                    return delete this._layers[b], this._update(), this
                },
                _initLayout: function() {
                    var a = "leaflet-control-layers",
                        b = this._container = e.DomUtil.create("div", a);
                    b.setAttribute("aria-haspopup", !0), e.Browser.touch ? e.DomEvent.on(b, "click", e.DomEvent.stopPropagation) : e.DomEvent.disableClickPropagation(b).disableScrollPropagation(b);
                    var c = this._form = e.DomUtil.create("form", a + "-list");
                    if (this.options.collapsed) {
                        e.Browser.android || e.DomEvent.on(b, "mouseover", this._expand, this).on(b, "mouseout", this._collapse, this);
                        var d = this._layersLink = e.DomUtil.create("a", a + "-toggle", b);
                        d.href = "#", d.title = "Layers", e.Browser.touch ? e.DomEvent.on(d, "click", e.DomEvent.stop).on(d, "click", this._expand, this) : e.DomEvent.on(d, "focus", this._expand, this), e.DomEvent.on(c, "click", function() {
                            setTimeout(e.bind(this._onInputClick, this), 0)
                        }, this), this._map.on("click", this._collapse, this)
                    } else this._expand();
                    this._baseLayersList = e.DomUtil.create("div", a + "-base", c), this._separator = e.DomUtil.create("div", a + "-separator", c), this._overlaysList = e.DomUtil.create("div", a + "-overlays", c), b.appendChild(c)
                },
                _addLayer: function(a, b, c) {
                    var d = e.stamp(a);
                    this._layers[d] = {
                        layer: a,
                        name: b,
                        overlay: c
                    }, this.options.autoZIndex && a.setZIndex && (this._lastZIndex++, a.setZIndex(this._lastZIndex))
                },
                _update: function() {
                    if (this._container) {
                        this._baseLayersList.innerHTML = "", this._overlaysList.innerHTML = "";
                        var c, d, a = !1,
                            b = !1;
                        for (c in this._layers) d = this._layers[c], this._addItem(d), b = b || d.overlay, a = a || !d.overlay;
                        this._separator.style.display = b && a ? "" : "none"
                    }
                },
                _onLayerChange: function(a) {
                    var b = this._layers[e.stamp(a.layer)];
                    if (b) {
                        this._handlingClick || this._update();
                        var c = b.overlay ? "layeradd" === a.type ? "overlayadd" : "overlayremove" : "layeradd" === a.type ? "baselayerchange" : null;
                        c && this._map.fire(c, b)
                    }
                },
                _createRadioElement: function(a, c) {
                    var d = '<input type="radio" class="leaflet-control-layers-selector" name="' + a + '"';
                    c && (d += ' checked="checked"'), d += "/>";
                    var e = b.createElement("div");
                    return e.innerHTML = d, e.firstChild
                },
                _addItem: function(a) {
                    var d, c = b.createElement("label"),
                        f = this._map.hasLayer(a.layer);
                    a.overlay ? (d = b.createElement("input"), d.type = "checkbox", d.className = "leaflet-control-layers-selector", d.defaultChecked = f) : d = this._createRadioElement("leaflet-base-layers", f), d.layerId = e.stamp(a.layer), e.DomEvent.on(d, "click", this._onInputClick, this);
                    var g = b.createElement("span");
                    g.innerHTML = " " + a.name, c.appendChild(d), c.appendChild(g);
                    var h = a.overlay ? this._overlaysList : this._baseLayersList;
                    return h.appendChild(c), c
                },
                _onInputClick: function() {
                    var a, b, c, d = this._form.getElementsByTagName("input"),
                        e = d.length;
                    for (this._handlingClick = !0, a = 0; a < e; a++) b = d[a], c = this._layers[b.layerId], b.checked && !this._map.hasLayer(c.layer) ? this._map.addLayer(c.layer) : !b.checked && this._map.hasLayer(c.layer) && this._map.removeLayer(c.layer);
                    this._handlingClick = !1, this._refocusOnMap()
                },
                _expand: function() {
                    e.DomUtil.addClass(this._container, "leaflet-control-layers-expanded")
                },
                _collapse: function() {
                    this._container.className = this._container.className.replace(" leaflet-control-layers-expanded", "")
                }
            }), e.control.layers = function(a, b, c) {
                return new e.Control.Layers(a, b, c)
            }, e.PosAnimation = e.Class.extend({
                includes: e.Mixin.Events,
                run: function(a, b, c, d) {
                    this.stop(), this._el = a, this._inProgress = !0, this._newPos = b, this.fire("start"), a.style[e.DomUtil.TRANSITION] = "all " + (c || .25) + "s cubic-bezier(0,0," + (d || .5) + ",1)", e.DomEvent.on(a, e.DomUtil.TRANSITION_END, this._onTransitionEnd, this), e.DomUtil.setPosition(a, b), e.Util.falseFn(a.offsetWidth), this._stepTimer = setInterval(e.bind(this._onStep, this), 50)
                },
                stop: function() {
                    this._inProgress && (e.DomUtil.setPosition(this._el, this._getPos()), this._onTransitionEnd(), e.Util.falseFn(this._el.offsetWidth))
                },
                _onStep: function() {
                    var a = this._getPos();
                    return a ? (this._el._leaflet_pos = a, void this.fire("step")) : void this._onTransitionEnd()
                },
                _transformRe: /([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,
                _getPos: function() {
                    var b, c, d, f = this._el,
                        g = a.getComputedStyle(f);
                    if (e.Browser.any3d) {
                        if (d = g[e.DomUtil.TRANSFORM].match(this._transformRe), !d) return;
                        b = parseFloat(d[1]), c = parseFloat(d[2])
                    } else b = parseFloat(g.left), c = parseFloat(g.top);
                    return new e.Point(b, c, !0)
                },
                _onTransitionEnd: function() {
                    e.DomEvent.off(this._el, e.DomUtil.TRANSITION_END, this._onTransitionEnd, this), this._inProgress && (this._inProgress = !1, this._el.style[e.DomUtil.TRANSITION] = "", this._el._leaflet_pos = this._newPos, clearInterval(this._stepTimer), this.fire("step").fire("end"))
                }
            }), e.Map.include({
                setView: function(a, b, d) {
                    if (b = b === c ? this._zoom : this._limitZoom(b), a = this._limitCenter(e.latLng(a), b, this.options.maxBounds), d = d || {}, this._panAnim && this._panAnim.stop(), this._loaded && !d.reset && d !== !0) {
                        d.animate !== c && (d.zoom = e.extend({
                            animate: d.animate
                        }, d.zoom), d.pan = e.extend({
                            animate: d.animate
                        }, d.pan));
                        var f = this._zoom !== b ? this._tryAnimatedZoom && this._tryAnimatedZoom(a, b, d.zoom) : this._tryAnimatedPan(a, d.pan);
                        if (f) return clearTimeout(this._sizeTimer), this
                    }
                    return this._resetView(a, b), this
                },
                panBy: function(a, b) {
                    if (a = e.point(a).round(), b = b || {}, !a.x && !a.y) return this;
                    if (this._panAnim || (this._panAnim = new e.PosAnimation, this._panAnim.on({
                            step: this._onPanTransitionStep,
                            end: this._onPanTransitionEnd
                        }, this)), b.noMoveStart || this.fire("movestart"), b.animate !== !1) {
                        e.DomUtil.addClass(this._mapPane, "leaflet-pan-anim");
                        var c = this._getMapPanePos().subtract(a);
                        this._panAnim.run(this._mapPane, c, b.duration || .25, b.easeLinearity)
                    } else this._rawPanBy(a), this.fire("move").fire("moveend");
                    return this
                },
                _onPanTransitionStep: function() {
                    this.fire("move")
                },
                _onPanTransitionEnd: function() {
                    e.DomUtil.removeClass(this._mapPane, "leaflet-pan-anim"), this.fire("moveend")
                },
                _tryAnimatedPan: function(a, b) {
                    var c = this._getCenterOffset(a)._floor();
                    return !((b && b.animate) !== !0 && !this.getSize().contains(c)) && (this.panBy(c, b), !0)
                }
            }), e.PosAnimation = e.DomUtil.TRANSITION ? e.PosAnimation : e.PosAnimation.extend({
                run: function(a, b, c, d) {
                    this.stop(), this._el = a, this._inProgress = !0, this._duration = c || .25, this._easeOutPower = 1 / Math.max(d || .5, .2), this._startPos = e.DomUtil.getPosition(a), this._offset = b.subtract(this._startPos), this._startTime = +new Date, this.fire("start"), this._animate()
                },
                stop: function() {
                    this._inProgress && (this._step(), this._complete())
                },
                _animate: function() {
                    this._animId = e.Util.requestAnimFrame(this._animate, this), this._step()
                },
                _step: function() {
                    var a = +new Date - this._startTime,
                        b = 1e3 * this._duration;
                    a < b ? this._runFrame(this._easeOut(a / b)) : (this._runFrame(1), this._complete())
                },
                _runFrame: function(a) {
                    var b = this._startPos.add(this._offset.multiplyBy(a));
                    e.DomUtil.setPosition(this._el, b), this.fire("step")
                },
                _complete: function() {
                    e.Util.cancelAnimFrame(this._animId), this._inProgress = !1, this.fire("end")
                },
                _easeOut: function(a) {
                    return 1 - Math.pow(1 - a, this._easeOutPower)
                }
            }), e.Map.mergeOptions({
                zoomAnimation: !0,
                zoomAnimationThreshold: 4
            }), e.DomUtil.TRANSITION && e.Map.addInitHook(function() {
                this._zoomAnimated = this.options.zoomAnimation && e.DomUtil.TRANSITION && e.Browser.any3d && !e.Browser.android23 && !e.Browser.mobileOpera, this._zoomAnimated && e.DomEvent.on(this._mapPane, e.DomUtil.TRANSITION_END, this._catchTransitionEnd, this)
            }), e.Map.include(e.DomUtil.TRANSITION ? {
                _catchTransitionEnd: function(a) {
                    this._animatingZoom && a.propertyName.indexOf("transform") >= 0 && this._onZoomTransitionEnd()
                },
                _nothingToAnimate: function() {
                    return !this._container.getElementsByClassName("leaflet-zoom-animated").length
                },
                _tryAnimatedZoom: function(a, b, c) {
                    if (this._animatingZoom) return !0;
                    if (c = c || {}, !this._zoomAnimated || c.animate === !1 || this._nothingToAnimate() || Math.abs(b - this._zoom) > this.options.zoomAnimationThreshold) return !1;
                    var d = this.getZoomScale(b),
                        e = this._getCenterOffset(a)._divideBy(1 - 1 / d),
                        f = this._getCenterLayerPoint()._add(e);
                    return !(c.animate !== !0 && !this.getSize().contains(e)) && (this.fire("movestart").fire("zoomstart"), this._animateZoom(a, b, f, d, null, !0), !0)
                },
                _animateZoom: function(a, b, c, d, f, g, h) {
                    h || (this._animatingZoom = !0), e.DomUtil.addClass(this._mapPane, "leaflet-zoom-anim"), this._animateToCenter = a, this._animateToZoom = b, e.Draggable && (e.Draggable._disabled = !0), e.Util.requestAnimFrame(function() {
                        this.fire("zoomanim", {
                            center: a,
                            zoom: b,
                            origin: c,
                            scale: d,
                            delta: f,
                            backwards: g
                        }), setTimeout(e.bind(this._onZoomTransitionEnd, this), 250)
                    }, this)
                },
                _onZoomTransitionEnd: function() {
                    this._animatingZoom && (this._animatingZoom = !1, e.DomUtil.removeClass(this._mapPane, "leaflet-zoom-anim"), e.Util.requestAnimFrame(function() {
                        this._resetView(this._animateToCenter, this._animateToZoom, !0, !0), e.Draggable && (e.Draggable._disabled = !1)
                    }, this))
                }
            } : {}), e.TileLayer.include({
                _animateZoom: function(a) {
                    this._animating || (this._animating = !0, this._prepareBgBuffer());
                    var b = this._bgBuffer,
                        c = e.DomUtil.TRANSFORM,
                        d = a.delta ? e.DomUtil.getTranslateString(a.delta) : b.style[c],
                        f = e.DomUtil.getScaleString(a.scale, a.origin);
                    b.style[c] = a.backwards ? f + " " + d : d + " " + f
                },
                _endZoomAnim: function() {
                    var a = this._tileContainer,
                        b = this._bgBuffer;
                    a.style.visibility = "", a.parentNode.appendChild(a), e.Util.falseFn(b.offsetWidth);
                    var c = this._map.getZoom();
                    (c > this.options.maxZoom || c < this.options.minZoom) && this._clearBgBuffer(), this._animating = !1
                },
                _clearBgBuffer: function() {
                    var a = this._map;
                    a && !a._animatingZoom && !a.touchZoom._zooming && (this._bgBuffer.innerHTML = "", this._bgBuffer.style[e.DomUtil.TRANSFORM] = "")
                },
                _prepareBgBuffer: function() {
                    var a = this._tileContainer,
                        b = this._bgBuffer,
                        c = this._getLoadedTilesPercentage(b),
                        d = this._getLoadedTilesPercentage(a);
                    return b && c > .5 && d < .5 ? (a.style.visibility = "hidden", void this._stopLoadingImages(a)) : (b.style.visibility = "hidden", b.style[e.DomUtil.TRANSFORM] = "", this._tileContainer = b, b = this._bgBuffer = a, this._stopLoadingImages(b), clearTimeout(this._clearBgBufferTimer), void 0)
                },
                _getLoadedTilesPercentage: function(a) {
                    var c, d, b = a.getElementsByTagName("img"),
                        e = 0;
                    for (c = 0, d = b.length; c < d; c++) b[c].complete && e++;
                    return e / d
                },
                _stopLoadingImages: function(a) {
                    var c, d, f, b = Array.prototype.slice.call(a.getElementsByTagName("img"));
                    for (c = 0, d = b.length; c < d; c++) f = b[c], f.complete || (f.onload = e.Util.falseFn, f.onerror = e.Util.falseFn, f.src = e.Util.emptyImageUrl, f.parentNode.removeChild(f))
                }
            }), e.Map.include({
                _defaultLocateOptions: {
                    watch: !1,
                    setView: !1,
                    maxZoom: 1 / 0,
                    timeout: 1e4,
                    maximumAge: 0,
                    enableHighAccuracy: !1
                },
                locate: function(a) {
                    if (a = this._locateOptions = e.extend(this._defaultLocateOptions, a), !navigator.geolocation) return this._handleGeolocationError({
                        code: 0,
                        message: "Geolocation not supported."
                    }), this;
                    var b = e.bind(this._handleGeolocationResponse, this),
                        c = e.bind(this._handleGeolocationError, this);
                    return a.watch ? this._locationWatchId = navigator.geolocation.watchPosition(b, c, a) : navigator.geolocation.getCurrentPosition(b, c, a), this
                },
                stopLocate: function() {
                    return navigator.geolocation && navigator.geolocation.clearWatch(this._locationWatchId), this._locateOptions && (this._locateOptions.setView = !1), this
                },
                _handleGeolocationError: function(a) {
                    var b = a.code,
                        c = a.message || (1 === b ? "permission denied" : 2 === b ? "position unavailable" : "timeout");
                    this._locateOptions.setView && !this._loaded && this.fitWorld(), this.fire("locationerror", {
                        code: b,
                        message: "Geolocation error: " + c + "."
                    })
                },
                _handleGeolocationResponse: function(a) {
                    var b = a.coords.latitude,
                        c = a.coords.longitude,
                        d = new e.LatLng(b, c),
                        f = 180 * a.coords.accuracy / 40075017,
                        g = f / Math.cos(e.LatLng.DEG_TO_RAD * b),
                        h = e.latLngBounds([b - f, c - g], [b + f, c + g]),
                        i = this._locateOptions;
                    if (i.setView) {
                        var j = Math.min(this.getBoundsZoom(h), i.maxZoom);
                        this.setView(d, j)
                    }
                    var k = {
                        latlng: d,
                        bounds: h,
                        timestamp: a.timestamp
                    };
                    for (var l in a.coords) "number" == typeof a.coords[l] && (k[l] = a.coords[l]);
                    this.fire("locationfound", k)
                }
            })
    }(window, document),
    function() {
        "use strict";

        function a(d) {
            if (!d) throw new Error("No options passed to Waypoint constructor");
            if (!d.element) throw new Error("No element option passed to Waypoint constructor");
            if (!d.handler) throw new Error("No handler option passed to Waypoint constructor");
            this.key = "waypoint-" + b, this.options = a.Adapter.extend({}, a.defaults, d), this.element = this.options.element, this.adapter = new a.Adapter(this.element), this.callback = d.handler, this.axis = this.options.horizontal ? "horizontal" : "vertical", this.enabled = this.options.enabled, this.triggerPoint = null, this.group = a.Group.findOrCreate({
                name: this.options.group,
                axis: this.axis
            }), this.context = a.Context.findOrCreateByElement(this.options.context), a.offsetAliases[this.options.offset] && (this.options.offset = a.offsetAliases[this.options.offset]), this.group.add(this), this.context.add(this), c[this.key] = this, b += 1
        }
        var b = 0,
            c = {};
        a.prototype.queueTrigger = function(a) {
            this.group.queueTrigger(this, a)
        }, a.prototype.trigger = function(a) {
            this.enabled && this.callback && this.callback.apply(this, a)
        }, a.prototype.destroy = function() {
            this.context.remove(this), this.group.remove(this), delete c[this.key]
        }, a.prototype.disable = function() {
            return this.enabled = !1, this
        }, a.prototype.enable = function() {
            return this.context.refresh(), this.enabled = !0, this
        }, a.prototype.next = function() {
            return this.group.next(this)
        }, a.prototype.previous = function() {
            return this.group.previous(this)
        }, a.invokeAll = function(a) {
            var b = [];
            for (var d in c) b.push(c[d]);
            for (var e = 0, f = b.length; e < f; e++) b[e][a]()
        }, a.destroyAll = function() {
            a.invokeAll("destroy")
        }, a.disableAll = function() {
            a.invokeAll("disable")
        }, a.enableAll = function() {
            a.invokeAll("enable")
        }, a.refreshAll = function() {
            a.Context.refreshAll()
        }, a.viewportHeight = function() {
            return window.innerHeight || document.documentElement.clientHeight
        }, a.viewportWidth = function() {
            return document.documentElement.clientWidth
        }, a.adapters = [], a.defaults = {
            context: window,
            continuous: !0,
            enabled: !0,
            group: "default",
            horizontal: !1,
            offset: 0
        }, a.offsetAliases = {
            "bottom-in-view": function() {
                return this.context.innerHeight() - this.adapter.outerHeight()
            },
            "right-in-view": function() {
                return this.context.innerWidth() - this.adapter.outerWidth()
            }
        }, window.Waypoint = a
    }(),
    function() {
        "use strict";

        function a(a) {
            window.setTimeout(a, 1e3 / 60)
        }

        function b(a) {
            this.element = a, this.Adapter = e.Adapter, this.adapter = new this.Adapter(a), this.key = "waypoint-context-" + c, this.didScroll = !1, this.didResize = !1, this.oldScroll = {
                x: this.adapter.scrollLeft(),
                y: this.adapter.scrollTop()
            }, this.waypoints = {
                vertical: {},
                horizontal: {}
            }, a.waypointContextKey = this.key, d[a.waypointContextKey] = this, c += 1, this.createThrottledScrollHandler(), this.createThrottledResizeHandler()
        }
        var c = 0,
            d = {},
            e = window.Waypoint,
            f = window.onload;
        b.prototype.add = function(a) {
            var b = a.options.horizontal ? "horizontal" : "vertical";
            this.waypoints[b][a.key] = a, this.refresh()
        }, b.prototype.checkEmpty = function() {
            var a = this.Adapter.isEmptyObject(this.waypoints.horizontal),
                b = this.Adapter.isEmptyObject(this.waypoints.vertical);
            a && b && (this.adapter.off(".waypoints"), delete d[this.key])
        }, b.prototype.createThrottledResizeHandler = function() {
            function a() {
                b.handleResize(), b.didResize = !1
            }
            var b = this;
            this.adapter.on("resize.waypoints", function() {
                b.didResize || (b.didResize = !0, e.requestAnimationFrame(a))
            })
        }, b.prototype.createThrottledScrollHandler = function() {
            function a() {
                b.handleScroll(), b.didScroll = !1
            }
            var b = this;
            this.adapter.on("scroll.waypoints", function() {
                b.didScroll && !e.isTouch || (b.didScroll = !0, e.requestAnimationFrame(a))
            })
        }, b.prototype.handleResize = function() {
            e.Context.refreshAll()
        }, b.prototype.handleScroll = function() {
            var a = {},
                b = {
                    horizontal: {
                        newScroll: this.adapter.scrollLeft(),
                        oldScroll: this.oldScroll.x,
                        forward: "right",
                        backward: "left"
                    },
                    vertical: {
                        newScroll: this.adapter.scrollTop(),
                        oldScroll: this.oldScroll.y,
                        forward: "down",
                        backward: "up"
                    }
                };
            for (var c in b) {
                var d = b[c],
                    e = d.newScroll > d.oldScroll,
                    f = e ? d.forward : d.backward;
                for (var g in this.waypoints[c]) {
                    var h = this.waypoints[c][g],
                        i = d.oldScroll < h.triggerPoint,
                        j = d.newScroll >= h.triggerPoint,
                        k = i && j,
                        l = !i && !j;
                    (k || l) && (h.queueTrigger(f), a[h.group.id] = h.group)
                }
            }
            for (var m in a) a[m].flushTriggers();
            this.oldScroll = {
                x: b.horizontal.newScroll,
                y: b.vertical.newScroll
            }
        }, b.prototype.innerHeight = function() {
            return this.element == this.element.window ? e.viewportHeight() : this.adapter.innerHeight()
        }, b.prototype.remove = function(a) {
            delete this.waypoints[a.axis][a.key], this.checkEmpty()
        }, b.prototype.innerWidth = function() {
            return this.element == this.element.window ? e.viewportWidth() : this.adapter.innerWidth()
        }, b.prototype.destroy = function() {
            var a = [];
            for (var b in this.waypoints)
                for (var c in this.waypoints[b]) a.push(this.waypoints[b][c]);
            for (var d = 0, e = a.length; d < e; d++) a[d].destroy()
        }, b.prototype.refresh = function() {
            var d, a = this.element == this.element.window,
                b = a ? void 0 : this.adapter.offset(),
                c = {};
            this.handleScroll(), d = {
                horizontal: {
                    contextOffset: a ? 0 : b.left,
                    contextScroll: a ? 0 : this.oldScroll.x,
                    contextDimension: this.innerWidth(),
                    oldScroll: this.oldScroll.x,
                    forward: "right",
                    backward: "left",
                    offsetProp: "left"
                },
                vertical: {
                    contextOffset: a ? 0 : b.top,
                    contextScroll: a ? 0 : this.oldScroll.y,
                    contextDimension: this.innerHeight(),
                    oldScroll: this.oldScroll.y,
                    forward: "down",
                    backward: "up",
                    offsetProp: "top"
                }
            };
            for (var f in d) {
                var g = d[f];
                for (var h in this.waypoints[f]) {
                    var n, o, p, q, r, i = this.waypoints[f][h],
                        j = i.options.offset,
                        k = i.triggerPoint,
                        l = 0,
                        m = null == k;
                    i.element !== i.element.window && (l = i.adapter.offset()[g.offsetProp]), "function" == typeof j ? j = j.apply(i) : "string" == typeof j && (j = parseFloat(j), i.options.offset.indexOf("%") > -1 && (j = Math.ceil(g.contextDimension * j / 100))), n = g.contextScroll - g.contextOffset, i.triggerPoint = l + n - j, o = k < g.oldScroll, p = i.triggerPoint >= g.oldScroll, q = o && p, r = !o && !p, !m && q ? (i.queueTrigger(g.backward), c[i.group.id] = i.group) : !m && r ? (i.queueTrigger(g.forward), c[i.group.id] = i.group) : m && g.oldScroll >= i.triggerPoint && (i.queueTrigger(g.forward), c[i.group.id] = i.group)
                }
            }
            return e.requestAnimationFrame(function() {
                for (var a in c) c[a].flushTriggers()
            }), this
        }, b.findOrCreateByElement = function(a) {
            return b.findByElement(a) || new b(a)
        }, b.refreshAll = function() {
            for (var a in d) d[a].refresh()
        }, b.findByElement = function(a) {
            return d[a.waypointContextKey]
        }, window.onload = function() {
            f && f(), b.refreshAll()
        }, e.requestAnimationFrame = function(b) {
            var c = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || a;
            c.call(window, b)
        }, e.Context = b
    }(),
    function() {
        "use strict";

        function a(a, b) {
            return a.triggerPoint - b.triggerPoint
        }

        function b(a, b) {
            return b.triggerPoint - a.triggerPoint
        }

        function c(a) {
            this.name = a.name, this.axis = a.axis, this.id = this.name + "-" + this.axis, this.waypoints = [], this.clearTriggerQueues(), d[this.axis][this.name] = this
        }
        var d = {
                vertical: {},
                horizontal: {}
            },
            e = window.Waypoint;
        c.prototype.add = function(a) {
            this.waypoints.push(a)
        }, c.prototype.clearTriggerQueues = function() {
            this.triggerQueues = {
                up: [],
                down: [],
                left: [],
                right: []
            }
        }, c.prototype.flushTriggers = function() {
            for (var c in this.triggerQueues) {
                var d = this.triggerQueues[c],
                    e = "up" === c || "left" === c;
                d.sort(e ? b : a);
                for (var f = 0, g = d.length; f < g; f += 1) {
                    var h = d[f];
                    (h.options.continuous || f === d.length - 1) && h.trigger([c])
                }
            }
            this.clearTriggerQueues()
        }, c.prototype.next = function(b) {
            this.waypoints.sort(a);
            var c = e.Adapter.inArray(b, this.waypoints),
                d = c === this.waypoints.length - 1;
            return d ? null : this.waypoints[c + 1]
        }, c.prototype.previous = function(b) {
            this.waypoints.sort(a);
            var c = e.Adapter.inArray(b, this.waypoints);
            return c ? this.waypoints[c - 1] : null
        }, c.prototype.queueTrigger = function(a, b) {
            this.triggerQueues[b].push(a)
        }, c.prototype.remove = function(a) {
            var b = e.Adapter.inArray(a, this.waypoints);
            b > -1 && this.waypoints.splice(b, 1)
        }, c.prototype.first = function() {
            return this.waypoints[0]
        }, c.prototype.last = function() {
            return this.waypoints[this.waypoints.length - 1]
        }, c.findOrCreate = function(a) {
            return d[a.axis][a.name] || new c(a)
        }, e.Group = c
    }(),
    function() {
        "use strict";

        function a(a) {
            this.$element = b(a)
        }
        var b = window.jQuery,
            c = window.Waypoint;
        b.each(["innerHeight", "innerWidth", "off", "offset", "on", "outerHeight", "outerWidth", "scrollLeft", "scrollTop"], function(b, c) {
            a.prototype[c] = function() {
                var a = Array.prototype.slice.call(arguments);
                return this.$element[c].apply(this.$element, a)
            }
        }), b.each(["extend", "inArray", "isEmptyObject"], function(c, d) {
            a[d] = b[d]
        }), c.adapters.push({
            name: "jquery",
            Adapter: a
        }), c.Adapter = a
    }(),
    function() {
        "use strict";

        function a(a) {
            return function() {
                var c = [],
                    d = arguments[0];
                return a.isFunction(arguments[0]) && (d = a.extend({}, arguments[1]), d.handler = arguments[0]), this.each(function() {
                    var e = a.extend({}, d, {
                        element: this
                    });
                    "string" == typeof e.context && (e.context = a(this).closest(e.context)[0]), c.push(new b(e))
                }), c
            }
        }
        var b = window.Waypoint;
        window.jQuery && (window.jQuery.fn.waypoint = a(window.jQuery)), window.Zepto && (window.Zepto.fn.waypoint = a(window.Zepto))
    }(), define("jquery.waypoints", function() {}), define("text!templates/oceanHeaderTemplate.html", [], function() {
        return "<%= t.oceans[ocean] %>\r\n"
    }), define("text!components/app/story/storyBottomHintsTemplate.html", [], function() {
        return '<div class="row">\r\n  <div class="col-xs-6">\r\n    <div class="story-bottom-hint story-region-hint hint">\r\n      <%= t.ux.story.select_story %>\r\n    </div>      \r\n  </div>\r\n  <div class="col-xs-6">\r\n    <div class="story-bottom-hint story-layer-hint hint">\r\n      <%= t.ux.story.explore_more[ocean] %>\r\n    </div>      \r\n  </div>\r\n</div>'
    }), define("text!templates/layerControlPlaceholderTemplate.html", [], function() {
        return '<div class="layer-control">\r\n  <table class="table-layer-select"><tbody>\r\n    <tr class="layer-key-main">\r\n      <td class="toggle">\r\n        <a href="#" class="icon-wwf_tick toggle-layer <%= isActive ? \'active\' : \'\' %>"\r\n           data-toggable="<%= toggable %>"                         \r\n           data-layerid="<%= id %>">\r\n        </a>     \r\n      </td>\r\n      <td class="title">\r\n        <a href="#" class="toggle-layer <%= isActive ? \'active\' : \'\' %> " \r\n           data-toggable="<%= toggable %>"           \r\n           data-layerid="<%= id %>">\r\n          <div class="title-inner"><%= title %></div>\r\n        </a>\r\n        <% if(hint !== \'\') { %>\r\n        <div class="hint">\r\n          <%= hint %>\r\n        </div>\r\n        <% } %>        \r\n      </td>\r\n         <td class="key">\r\n        <%= keyHtml %>\r\n      </td>      \r\n    </tr>\r\n    <% if (layerGradient) { %>\r\n    <tr class="layer-color-gradient">\r\n      <td></td>\r\n      <td colspan="<%= info ? 3 : 2 %>">\r\n        <%= layerGradient %> \r\n      </td>      \r\n    </tr>\r\n    <% } %>\r\n    <% if (layerCategories) { %>\r\n    <tr class="layer-color-groups">\r\n      <td></td>\r\n      <td>\r\n        <ul class="list-unstyled">\r\n        <% _.each(layerCategories, function(cat){ %>\r\n          <li>\r\n            <%= cat.color %>            \r\n            <%= cat.label %>\r\n          </li>          \r\n        <% }) %>\r\n        </ul>\r\n      </td>\r\n      <td></td>\r\n    </tr>\r\n    <% } %>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n'
    }), define("text!templates/storyNavTemplate.html", [], function() {
        return '  <ul class="list-inline story-list links-large list-module-nav nav-secondary ">\r\n    <% _.each(stories, function(story){ %>\r\n    <li class="nav-story-item">\r\n      <a href="#" data-storyid="<%= story.id %>" class="story-link <%= typeof linkClass !== \'undefined\' ? linkClass : \'\' %>">\r\n        <%= story.getTitle() %>\r\n      </a>      \r\n    </li>  \r\n    <% }) %>\r\n  </ul>'
    }), define("components/app/story/StoryView", ["jquery", "underscore", "backbone", "leaflet", "jquery.waypoints", "bootstrap", "text!templates/oceanHeaderTemplate.html", "text!./storyBottomHintsTemplate.html", "text!templates/layerControlPlaceholderTemplate.html", "text!templates/storyNavTemplate.html"], function(a, b, c, d, e, f, g, h, i, j) {
        var k = c.View.extend({
            events: {
                "click .chapter-link": "handleChapterLink",
                "click .previous-story-link": "handlePreviousStoryLink",
                "click .next-story-link": "handleNextStoryLink",
                "click .play-button": "handlePlayAudio",
                "click .toggle-layer": "toggleLayer",
                "click .layer-info-link": "handleLayerInfoLink",
                "click .story-link": "handleStoryLink"
            },
            initialize: function() {
                this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:story", this.handleStoryUpdate), a(window).on("resize", b.debounce(b.bind(this.resize, this), 200)), this.scroll_offset_chapter = 50, this.waypoints_offset_chapter = 100, this.waypoints_offset_layers = 175, this._scrolling = !1
            },
            render: function() {
                return this
            },
            resize: function() {
                "undefined" != typeof this.model && this.model.isActive() && this.refreshWaypoints()
            },
            loadStory: function() {
                var a = this.model.getStory();
                if (this.model.isActive() && null !== a) {
                    this.$el.html('<span class="loading-animation content-loading-animation"></span>');
                    var b = this;
                    a.getContent(function(a) {
                        b.$el.html(""), b.$el.append(a), b.populatePlaceholders(), b.initSlideshow(), b.initWaypoints(), b.initActives(), b.initLayers(), b.initAudio()
                    })
                }
            },
            initLayers: function() {
                this.$el.trigger("preloadLayers", {
                    layerids: b.without(b.uniq(b.flatten(b.map(a(".story-item"), function(c) {
                        return b.map(a(c).data("layers").split(","), function(a) {
                            return a.trim()
                        })
                    }))), "")
                })
            },
            initActives: function() {
                this.$('.chapter-link[data-chapterid="0"]').addClass("active");
                var b = this.model.getStory(),
                    c = this;
                waitFor(function() {
                    return b.isContentReady()
                }, function() {
                    c.itemTriggered({
                        layers: a("#chapter-0 .story-item").data("layers")
                    })
                })
            },
            populatePlaceholders: function() {
                var c = this.model.getStory(),
                    d = this;
                waitFor(function() {
                    return c.isContentReady()
                }, function() {
                    var e = c.getOceanId();
                    d.$(".placeholder-ocean").html(b.template(g)({
                        ocean: e,
                        t: tlang
                    })), d.$(".placeholder-story-layer-hint").html(b.template(h)({
                        ocean: e,
                        t: tlang
                    })), d.$(".placeholder-story-nav").html(b.template(j)({
                        stories: b.filter(d.model.getStories(), function(a) {
                            return a.id !== d.model.getStory().id
                        }),
                        linkClass: "ocean-color"
                    })), d.$(".story-item").each(function(c, e) {
                        var f = b.without(b.map(a(e).data("layers").split(","), function(a) {
                            return a.trim()
                        }), "");
                        f.length && (a(e).find(".placeholder-layercontrol").html('<h5 class=layer-control-title">' + tlang.nav.layers + '</h5>\n               <ul class="list-unstyled layer-control-list"></ul>'), b.each(f, function(c) {
                            var f = d.model.attributes.layers.findWhere({
                                id: c
                            });
                            a(e).find(".placeholder-layercontrol .layer-control-list").append('<li class="layer-control-list-item">' + b.template(i)({
                                id: c,
                                title: f.getTitle(),
                                hint: f.getHint(),
                                info: !0,
                                toggable: !1,
                                layerGradient: f.makeLayerGradientKey(),
                                layerCategories: f.makeLayerCategoriesKey(),
                                isActive: !0,
                                keyHtml: f.getKeySquareIcon("sm"),
                                t: tlang
                            }) + "</li>")
                        }))
                    })
                })
            },
            initWaypoints: function() {
                var b = this;
                this.$(".story-item").waypoint({
                    handler: function(c) {
                        if (!b._scrolling && b.model.isActive())
                            if ("down" === c) b.itemTriggered({
                                layers: a(this.element).data("layers")
                            });
                            else {
                                var d = a(0 !== a(".story-item").index(this.element) ? a(".story-item")[a(".story-item").index(this.element) - 1] : this.element);
                                b.itemTriggered({
                                    layers: d.data("layers")
                                })
                            }
                    },
                    context: this.$(".content-scroll"),
                    offset: this.waypoints_offset_layers,
                    continuous: !0
                }), this.$(".chapter-link").removeClass("active"), this.$(".chapter").waypoint({
                    handler: function(c) {
                        if (b.model.isActive())
                            if ("down" === c) b.chapterTriggered(a(this.element).data("chapterid"));
                            else {
                                var d = a(a(this.element).data("chapterid") > 0 ? "#chapter-" + (a(this.element).data("chapterid") - 1) : this.element);
                                0 !== d.length && b.chapterTriggered(d.data("chapterid"))
                            }
                    },
                    context: this.$(".content-scroll"),
                    offset: this.waypoints_offset_chapter,
                    continuous: !0
                }), this.$el.removeClass("chapter-nav-stuck"), this.$(".chapter-nav").waypoint({
                    handler: function(a) {
                        b.model.isActive() && ("down" === a ? b.$el.addClass("chapter-nav-stuck") : b.$el.removeClass("chapter-nav-stuck"))
                    },
                    context: this.$(".content-scroll")
                })
            },
            refreshWaypoints: function() {
                var a = this.model.getStory();
                waitFor(function() {
                    return a.isContentReady()
                }, function() {
                    window.Waypoint.refreshAll()
                })
            },
            initSlideshow: function() {
                this.$(".carousel").length > 0 && this.$(".carousel").carousel({
                    interval: !1
                })
            },
            initAudio: function() {
                var b = this;
                this.$(".audio").each(function() {
                    var c = a(this),
                        d = c.find("audio").get(0),
                        e = null;
                    d.addEventListener("loadedmetadata", function() {
                        d.setAttribute("data-time", d.duration), c.find(".time-total").html(b.formatTime(d.duration))
                    }, !1), d.addEventListener("play", function() {
                        e = setInterval(function() {
                            b.audioUpdateTime(d, c)
                        }, 10)
                    }), d.addEventListener("pause", function() {
                        clearInterval(e)
                    }), d.addEventListener("ended", function() {
                        clearInterval(e), c.find(".audio-slider").width("100%"), c.find(".play-button").addClass("end"), c.find(".play-button").removeClass("active")
                    }), c.find(".audio-position").on("click", function(e) {
                        c.find(".play-button").removeClass("end");
                        var f = e.offsetX / a(this).width();
                        d.currentTime = f * d.duration, a(this).find(".audio-slider").width(e.offsetX + "px"), c.find(".time-progress").html(b.formatTime(d.currentTime))
                    })
                })
            },
            formatTime: function(a) {
                var b = Math.floor(a / 60),
                    c = Math.floor(a) - 60 * b,
                    d = "";
                return d += "" + b + ":" + (c < 10 ? "0" : ""), d += "" + c
            },
            audioUpdateTime: function(a, b) {
                var c = b.find(".audio-position"),
                    d = a.currentTime / a.duration,
                    e = c.width() * d;
                c.find(".audio-slider").width(Math.round(100 * e) / 100 + "px"), b.find(".time-progress").html(this.formatTime(a.currentTime))
            },
            scrollToChapter: function(a) {
                var b = this.$(".content-scroll"),
                    c = this;
                "undefined" == typeof a || "" === a || 0 === a || "0" === a ? 0 !== b.scrollTop() && (this._scrolling = !0, b.animate({
                    scrollTop: 0
                }, "fast", "swing", function() {
                    c.onScrollAnimationEnd(0)
                })) : 0 !== this.$("#chapter-" + a).offset().top && (this._scrolling = !0, console.log("story.onScrollAnimationStart"), b.animate({
                    scrollTop: this.$("#chapter-" + a).offset().top + b.scrollTop() - this.scroll_offset_chapter
                }, "slow", "swing", function() {
                    c.onScrollAnimationEnd(a)
                }))
            },
            onScrollAnimationEnd: function(a) {
                console.log("story.onScrollAnimationEnd");
                var c = this.$("#chapter-" + a + " .story-item").first().data("layers");
                this.triggerLayers(b.map(c.split(","), function(a) {
                    return a.trim()
                })), this._scrolling = !1, this.chapterTriggered(a)
            },
            chapterTriggered: function(a) {
                this.$(".chapter-link").removeClass("active"), this.$('.chapter-link[data-chapterid="' + a + '"]').addClass("active")
            },
            itemTriggered: function(a) {
                !this._scrolling && "undefined" != typeof a.layers && this.triggerLayers(b.map(a.layers.split(","), function(a) {
                    return a.trim()
                }))
            },
            triggerLayers: function(a) {
                a = "undefined" != typeof a ? a : "", this.$el.trigger("storyItemActivated", {
                    layerIds: a
                })
            },
            handleActive: function() {
                var a = this;
                this.model.isActive() ? (this.$el.show(), a.$el.removeClass("chapter-nav-stuck")) : (this.$el.hide(), a.$el.removeClass("chapter-nav-stuck"))
            },
            handleStoryUpdate: function() {
                this.loadStory()
            },
            handleChapterLink: function(b) {
                b.preventDefault(), this.scrollToChapter(a(b.target).data("chapterid"))
            },
            handlePreviousStoryLink: function(a) {
                a.preventDefault(), this.$el.trigger("previousStoryLinkClick", {
                    target: a.target,
                    id: this.model.getStory().id
                })
            },
            handleNextStoryLink: function(a) {
                a.preventDefault(), this.$el.trigger("nextStoryLinkClick", {
                    target: a.target,
                    id: this.model.getStory().id
                })
            },
            handlePlayAudio: function(a) {
                a.preventDefault();
                var b = this.$(a.target).closest(".play-button"),
                    c = this.$(a.target).closest(".audio"),
                    d = c.find("audio").get(0);
                d.ended ? (d.play(), b.addClass("active"), b.removeClass("end")) : d.paused ? (d.play(), b.addClass("active")) : (d.pause(), b.removeClass("active"))
            },
            handleLayerInfoLink: function(b) {
                b.preventDefault(), this.$el.trigger("layerInfoLinkClick", {
                    target: b.target,
                    id: a(b.target).data("layerid")
                })
            },
            toggleLayer: function(a) {
                a.preventDefault(), a.stopPropagation()
            },
            handleStoryLink: function(b) {
                b.preventDefault(), this.$el.trigger("storyLinkClick", {
                    target: b.target,
                    id: a(b.target).data("storyid")
                })
            }
        });
        return k
    }), define("models/ViewModel", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.Model.extend({
            initialize: function(a) {
                this.options = a || {}
            },
            setActive: function(a) {
                a = "undefined" == typeof a || a, this.set("active", a)
            },
            isActive: function() {
                return this.get("active")
            }
        });
        return d
    }), define("components/app/story/StoryViewModel", ["jquery", "underscore", "backbone", "models/ViewModel"], function(a, b, c, d) {
        return d.extend({
            initialize: function(a) {
                this.options = a || {}
            },
            getLayers: function() {
                return this.attributes.layers
            },
            setLayers: function(a) {
                this.set("layers", a)
            },
            getStory: function() {
                return this.attributes.story
            },
            setStory: function(a) {
                this.set("story", a)
            },
            getStories: function() {
                return this.attributes.stories
            },
            setStories: function(a) {
                this.set("stories", a)
            }
        })
    }), define("components/app/home/HomeView", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.View.extend({
            events: {},
            initialize: function() {
                this.listenTo(this.model, "change:active", this.handleActive);
                if (Modernizr.touch) {
                    var d = this.$(".content-wrap");
                    this._scrollOffset = d.offset().top, this._scrollOffsetInitial = d.offset().top, this._maxOverflow = d[0].scrollHeight - a("#application").outerHeight(), this._scrolled = 0, d.on({
                        "touchstart mousedown": b.bind(function(a) {
                            "undefined" != typeof a.originalEvent.changedTouches && (this._touched = a.originalEvent.changedTouches[0].pageY, d.on("touchmove mousemove", b.bind(this.move, this)))
                        }, this),
                        "touchend mouseup": function(a) {
                            d.off("touchmove mousemove")
                        }
                    })
                }
            },
            move: function(a) {
                a.preventDefault();
                var b = a.originalEvent.changedTouches[0],
                    c = this.$(".content-wrap"),
                    d = this._touched - b.pageY;
                this._touched = b.pageY, c.css({
                    top: Math.min(this._scrollOffsetInitial, Math.max(-this._maxOverflow, this._scrollOffset - d)) + "px"
                }), this._scrollOffset = c.offset().top
            },
            render: function() {
                return this
            },
            handleActive: function() {
                this.model.isActive() ? this.$el.show() : this.$el.hide()
            }
        });
        return d
    }), define("components/app/ocean/OceanView", ["jquery", "underscore", "backbone", "text!templates/storyNavTemplate.html"], function(a, b, c, d) {
        var e = c.View.extend({
            events: {
                "click .previous-ocean-link": "handlePreviousOceanLink",
                "click .next-ocean-link": "handleNextOceanLink",
                "click .story-link": "handleStoryLink"
            },
            initialize: function() {
                this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:ocean", this.handleOceanChange), this.listenTo(this.model, "change:stories", this.handleStoriesChange)
            },
            initScroll: function() {
                if (Modernizr.touch) {
                    var c = this.$(".content-wrap");
                    this._scrollOffset = c.offset().top, this._scrollOffsetInitial = c.offset().top, this._maxOverflow = c[0].scrollHeight - a("#application").outerHeight(), this._scrolled = 0, c.on({
                        "touchstart mousedown": b.bind(function(a) {
                            "undefined" != typeof a.originalEvent.changedTouches && (this._touched = a.originalEvent.changedTouches[0].pageY, c.on("touchmove mousemove", b.bind(this.move, this)))
                        }, this),
                        "touchend mouseup": function(a) {
                            c.off("touchmove mousemove")
                        }
                    })
                }
            },
            move: function(a) {
                a.preventDefault();
                var b = a.originalEvent.changedTouches[0],
                    c = this.$(".content-wrap"),
                    d = this._touched - b.pageY;
                this._touched = b.pageY, c.css({
                    top: Math.min(this._scrollOffsetInitial, Math.max(-this._maxOverflow, this._scrollOffset - d)) + "px"
                }), this._scrollOffset = c.offset().top
            },
            render: function() {
                return this
            },
            loadOcean: function() {
                var a = this.model.getOcean();
                this.$el.html('<div class="content-aside content-wrap"><span class="loading-animation content-loading-animation"></span></div>');
                var b = this;
                a.getContent(function(a) {
                    b.$el.html(""), b.$el.append(a), b.populateStoryNav(), b.initScroll()
                })
            },
            populateStoryNav: function() {
                var a = this.model.getOcean(),
                    c = this;
                waitFor(function() {
                    return a.isContentReady()
                }, function() {
                    var a = {
                        stories: c.model.getStories()
                    };
                    c.$(".placeholder-story-nav").html(b.template(d)(a))
                })
            },
            handleActive: function() {
                this.model.isActive() ? this.$el.show() : this.$el.hide()
            },
            handleOceanChange: function() {
                this.loadOcean()
            },
            handleStoriesChange: function() {
                this.populateStoryNav()
            },
            handlePreviousOceanLink: function(a) {
                a.preventDefault(), this.$el.trigger("previousOceanLinkClick", {
                    target: a.target,
                    id: this.model.getOcean().id
                })
            },
            handleNextOceanLink: function(a) {
                a.preventDefault(), this.$el.trigger("nextOceanLinkClick", {
                    target: a.target,
                    id: this.model.getOcean().id
                })
            },
            handleStoryLink: function(b) {
                b.preventDefault(), this.$el.trigger("storyLinkClick", {
                    target: b.target,
                    id: a(b.target).data("storyid")
                })
            }
        });
        return e
    }), define("components/app/ocean/OceanViewModel", ["jquery", "underscore", "backbone", "models/ViewModel"], function(a, b, c, d) {
        return d.extend({
            setOcean: function(a) {
                this.set("ocean", a)
            },
            getOcean: function() {
                return this.attributes.ocean
            },
            setStories: function(a) {
                this.set("stories", a)
            },
            getStories: function() {
                return this.attributes.stories
            }
        })
    }), define("text!components/app/pages/subpageNavTemplate.html", [], function() {
        return '  <ul class="list-inline subpage-list nav-secondary">\r\n    <% _.each(pages, function(page){ %>\r\n    <li class="page-item">\r\n      <a href="#" data-pageid="<%= page.id %>" class="page-link <%= pageactive === page.id ? \'active\' : \'\'  %>">\r\n        <%= page.getTitle() %>\r\n      </a>      \r\n    </li>  \r\n    <% }) %>\r\n  </ul>'
    }), define("components/app/pages/PagesView", ["jquery", "underscore", "backbone", "bootstrap", "text!./subpageNavTemplate.html"], function(a, b, c, d, e) {
        var f = c.View.extend({
            events: {
                "click .page-link": "handlePageLink"
            },
            initialize: function() {
                this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:path", this.handlePathChange)
            },
            render: function() {
                return this
            },
            loadPage: function() {
                var a = this.model.getPageId(),
                    b = this.model.getPage(),
                    c = "page-" + a;
                if (this.$(".page").hide(), 0 === this.$("." + c).length) {
                    this.$el.append('<div class="page ' + c + '"><div class="content-full content-wrap"><span class="loading-animation page-loading-animation"></span></div></div>');
                    var d = this;
                    b.getContent(function(a) {
                        d.$("." + c).html(""), d.$("." + c).append(a), d.populatePlaceholders(), d.initBlockquotes(), d.initSlideshow()
                    })
                } else this.$("." + c).show()
            },
            initSlideshow: function() {
                this.$(".carousel").length > 0 && this.$(".carousel").carousel({
                    interval: !1
                })
            },
            initBlockquotes: function() {
                var b = this.model.getPageId(),
                    c = "page-" + b;
                this.$("." + c).find("blockquote").each(function(b) {
                    b % 2 === 1 && a(this).addClass("blockquote-offset-right")
                })
            },
            populatePlaceholders: function() {
                var a = this.model.getPageId(),
                    c = this.model.getPage(),
                    d = "page-" + a,
                    f = this;
                waitFor(function() {
                    return c.isContentReady()
                }, function() {
                    if (f.model.getPagesByCategory().length) {
                        var c = {
                            pages: f.model.getPagesByCategory(),
                            pageactive: a
                        };
                        f.$("." + d).find(".placeholder-subpage-nav").html(b.template(e)(c))
                    }
                    "undefined" != typeof f.model.getPage().getParent() && f.$("." + d).find(".placeholder-section-title").html(tlang.nav[f.model.getPage().getParent()])
                })
            },
            handlePageLink: function(b) {
                if ("undefined" != typeof a(b.target).data("pageid")) b.preventDefault(), b.stopPropagation(), this.$el.trigger("pageLinkClick", {
                    target: b.target,
                    id: a(b.target).data("pageid")
                });
                else if (a(b.target).attr("href").startsWith("#?modal=")) {
                    b.preventDefault(), b.stopPropagation();
                    var c = a(b.target).attr("href").split("modal=")[1];
                    this.$el.trigger("modalOpen", {
                        target: b.target,
                        type: c
                    })
                } else if (a(b.target).attr("href").startsWith("#?page=")) {
                    b.preventDefault(), b.stopPropagation();
                    var d = a(b.target).attr("href").split("page=")[1];
                    this.$el.trigger("pageLinkClick", {
                        target: b.target,
                        id: d
                    })
                } else b.stopPropagation()
            },
            handleActive: function() {
                this.model.isActive() ? this.$el.show() : this.$el.hide()
            },
            handlePathChange: function() {
                this.loadPage()
            }
        });
        return f
    }), define("components/app/pages/PagesModel", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.Model.extend({
            initialize: function(a) {
                this.options = a || {}
            },
            setActive: function(a) {
                a = "undefined" == typeof a || a, this.set("active", a)
            },
            isActive: function() {
                return this.get("active")
            },
            setPath: function(a) {
                this.set("path", a)
            },
            getPageId: function() {
                return this.attributes.path
            },
            getPages: function() {
                return this.attributes.pages
            },
            getPage: function() {
                return this.attributes.pages.findWhere({
                    id: this.attributes.path
                })
            },
            getPagesByCategory: function() {
                return this.attributes.pages.where({
                    parent: this.getPage().getParent()
                })
            }
        });
        return d
    }),
    function(a) {
        "function" == typeof define && define.amd ? define("esri.leaflet", ["leaflet"], function(b) {
            return a(b)
        }) : "object" == typeof module && "object" == typeof module.exports && (module.exports = a(require("leaflet"))), "undefined" != typeof window && window.L && a(window.L)
    }(function(a) {
        var b = {
            VERSION: "1.0.0",
            Layers: {},
            Services: {},
            Controls: {},
            Tasks: {},
            Util: {},
            Support: {
                CORS: !!(window.XMLHttpRequest && "withCredentials" in new XMLHttpRequest),
                pointerEvents: "" === document.documentElement.style.pointerEvents
            }
        };
        return "undefined" != typeof window && window.L && (window.L.esri = b),
            function(b) {
                function c(a) {
                    var b = {};
                    for (var c in a) a.hasOwnProperty(c) && (b[c] = a[c]);
                    return b
                }

                function d(a, b) {
                    for (var c = 0; c < a.length; c++)
                        if (a[c] !== b[c]) return !1;
                    return !0
                }

                function e(a) {
                    return d(a[0], a[a.length - 1]) || a.push(a[0]), a
                }

                function f(a) {
                    var f, b = 0,
                        c = 0,
                        d = a.length,
                        e = a[c];
                    for (c; c < d - 1; c++) f = a[c + 1], b += (f[0] - e[0]) * (f[1] + e[1]), e = f;
                    return b >= 0
                }

                function g(a, b, c, d) {
                    var e = (d[0] - c[0]) * (a[1] - c[1]) - (d[1] - c[1]) * (a[0] - c[0]),
                        f = (b[0] - a[0]) * (a[1] - c[1]) - (b[1] - a[1]) * (a[0] - c[0]),
                        g = (d[1] - c[1]) * (b[0] - a[0]) - (d[0] - c[0]) * (b[1] - a[1]);
                    if (0 !== g) {
                        var h = e / g,
                            i = f / g;
                        if (0 <= h && h <= 1 && 0 <= i && i <= 1) return !0
                    }
                    return !1
                }

                function h(a, b) {
                    for (var c = 0; c < a.length - 1; c++)
                        for (var d = 0; d < b.length - 1; d++)
                            if (g(a[c], a[c + 1], b[d], b[d + 1])) return !0;
                    return !1
                }

                function i(a, b) {
                    for (var c = !1, d = -1, e = a.length, f = e - 1; ++d < e; f = d)(a[d][1] <= b[1] && b[1] < a[f][1] || a[f][1] <= b[1] && b[1] < a[d][1]) && b[0] < (a[f][0] - a[d][0]) * (b[1] - a[d][1]) / (a[f][1] - a[d][1]) + a[d][0] && (c = !c);
                    return c
                }

                function j(a, b) {
                    var c = h(a, b),
                        d = i(a, b[0]);
                    return !(c || !d)
                }

                function k(a) {
                    for (var d, g, i, b = [], c = [], k = 0; k < a.length; k++) {
                        var l = e(a[k].slice(0));
                        if (!(l.length < 4))
                            if (f(l)) {
                                var m = [l];
                                b.push(m)
                            } else c.push(l)
                    }
                    for (var n = []; c.length;) {
                        i = c.pop();
                        var o = !1;
                        for (d = b.length - 1; d >= 0; d--)
                            if (g = b[d][0], j(g, i)) {
                                b[d].push(i), o = !0;
                                break
                            }
                        o || n.push(i)
                    }
                    for (; n.length;) {
                        i = n.pop();
                        var p = !1;
                        for (d = b.length - 1; d >= 0; d--)
                            if (g = b[d][0], h(g, i)) {
                                b[d].push(i), p = !0;
                                break
                            }
                        p || b.push([i.reverse()])
                    }
                    return 1 === b.length ? {
                        type: "Polygon",
                        coordinates: b[0]
                    } : {
                        type: "MultiPolygon",
                        coordinates: b
                    }
                }

                function l(a) {
                    var b = [],
                        c = a.slice(0),
                        d = e(c.shift().slice(0));
                    if (d.length >= 4) {
                        f(d) || d.reverse(), b.push(d);
                        for (var g = 0; g < c.length; g++) {
                            var h = e(c[g].slice(0));
                            h.length >= 4 && (f(h) && h.reverse(), b.push(h))
                        }
                    }
                    return b
                }

                function m(a) {
                    for (var b = [], c = 0; c < a.length; c++)
                        for (var d = l(a[c]), e = d.length - 1; e >= 0; e--) {
                            var f = d[e].slice(0);
                            b.push(f)
                        }
                    return b
                }
                var n = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame || function(a) {
                    return window.setTimeout(a, 1e3 / 60)
                };
                b.Util.extentToBounds = function(b) {
                    var c = new a.LatLng(b.ymin, b.xmin),
                        d = new a.LatLng(b.ymax, b.xmax);
                    return new a.LatLngBounds(c, d)
                }, b.Util.boundsToExtent = function(b) {
                    return b = a.latLngBounds(b), {
                        xmin: b.getSouthWest().lng,
                        ymin: b.getSouthWest().lat,
                        xmax: b.getNorthEast().lng,
                        ymax: b.getNorthEast().lat,
                        spatialReference: {
                            wkid: 4326
                        }
                    }
                }, b.Util.arcgisToGeojson = function(a, d) {
                    var e = {};
                    return "number" == typeof a.x && "number" == typeof a.y && (e.type = "Point", e.coordinates = [a.x, a.y]), a.points && (e.type = "MultiPoint", e.coordinates = a.points.slice(0)), a.paths && (1 === a.paths.length ? (e.type = "LineString", e.coordinates = a.paths[0].slice(0)) : (e.type = "MultiLineString", e.coordinates = a.paths.slice(0))), a.rings && (e = k(a.rings.slice(0))), (a.geometry || a.attributes) && (e.type = "Feature", e.geometry = a.geometry ? b.Util.arcgisToGeojson(a.geometry) : null, e.properties = a.attributes ? c(a.attributes) : null, a.attributes && (e.id = a.attributes[d] || a.attributes.OBJECTID || a.attributes.FID)), e
                }, b.Util.geojsonToArcGIS = function(a, d) {
                    d = d || "OBJECTID";
                    var g, e = {
                            wkid: 4326
                        },
                        f = {};
                    switch (a.type) {
                        case "Point":
                            f.x = a.coordinates[0], f.y = a.coordinates[1], f.spatialReference = e;
                            break;
                        case "MultiPoint":
                            f.points = a.coordinates.slice(0), f.spatialReference = e;
                            break;
                        case "LineString":
                            f.paths = [a.coordinates.slice(0)], f.spatialReference = e;
                            break;
                        case "MultiLineString":
                            f.paths = a.coordinates.slice(0), f.spatialReference = e;
                            break;
                        case "Polygon":
                            f.rings = l(a.coordinates.slice(0)), f.spatialReference = e;
                            break;
                        case "MultiPolygon":
                            f.rings = m(a.coordinates.slice(0)), f.spatialReference = e;
                            break;
                        case "Feature":
                            a.geometry && (f.geometry = b.Util.geojsonToArcGIS(a.geometry, d)), f.attributes = a.properties ? c(a.properties) : {}, a.id && (f.attributes[d] = a.id);
                            break;
                        case "FeatureCollection":
                            for (f = [], g = 0; g < a.features.length; g++) f.push(b.Util.geojsonToArcGIS(a.features[g], d));
                            break;
                        case "GeometryCollection":
                            for (f = [], g = 0; g < a.geometries.length; g++) f.push(b.Util.geojsonToArcGIS(a.geometries[g], d))
                    }
                    return f
                }, b.Util.responseToFeatureCollection = function(a, c) {
                    var d;
                    if (c) d = c;
                    else if (a.objectIdFieldName) d = a.objectIdFieldName;
                    else if (a.fields) {
                        for (var e = 0; e <= a.fields.length - 1; e++)
                            if ("esriFieldTypeOID" === a.fields[e].type) {
                                d = a.fields[e].name;
                                break
                            }
                    } else d = "OBJECTID";
                    var f = {
                            type: "FeatureCollection",
                            features: []
                        },
                        g = a.features || a.results;
                    if (g.length)
                        for (var h = g.length - 1; h >= 0; h--) f.features.push(b.Util.arcgisToGeojson(g[h], d));
                    return f
                }, b.Util.cleanUrl = function(a) {
                    return a = a.replace(/^\s+|\s+$|\A\s+|\s+\z/g, ""), "/" !== a[a.length - 1] && (a += "/"), a
                }, b.Util.isArcgisOnline = function(a) {
                    return /\.arcgis\.com.*?FeatureServer/g.test(a)
                }, b.Util.geojsonTypeToArcGIS = function(a) {
                    var b;
                    switch (a) {
                        case "Point":
                            b = "esriGeometryPoint";
                            break;
                        case "MultiPoint":
                            b = "esriGeometryMultipoint";
                            break;
                        case "LineString":
                            b = "esriGeometryPolyline";
                            break;
                        case "MultiLineString":
                            b = "esriGeometryPolyline";
                            break;
                        case "Polygon":
                            b = "esriGeometryPolygon";
                            break;
                        case "MultiPolygon":
                            b = "esriGeometryPolygon"
                    }
                    return b
                }, b.Util.requestAnimationFrame = a.Util.bind(n, window), b.Util.warn = function(a) {
                    console && console.warn && console.warn(a)
                }
            }(b),
            function(b) {
                function c(a) {
                    var b = "";
                    a.f = a.f || "json";
                    for (var c in a)
                        if (a.hasOwnProperty(c)) {
                            var f, d = a[c],
                                e = Object.prototype.toString.call(d);
                            b.length && (b += "&"), f = "[object Array]" === e ? "[object Object]" === Object.prototype.toString.call(d[0]) ? JSON.stringify(d) : d.join(",") : "[object Object]" === e ? JSON.stringify(d) : "[object Date]" === e ? d.valueOf() : d, b += encodeURIComponent(c) + "=" + encodeURIComponent(f)
                        }
                    return b
                }

                function d(b, c) {
                    var d = new XMLHttpRequest;
                    return d.onerror = function(e) {
                        d.onreadystatechange = a.Util.falseFn, b.call(c, {
                            error: {
                                code: 500,
                                message: "XMLHttpRequest error"
                            }
                        }, null)
                    }, d.onreadystatechange = function() {
                        var e, f;
                        if (4 === d.readyState) {
                            try {
                                e = JSON.parse(d.responseText)
                            } catch (a) {
                                e = null, f = {
                                    code: 500,
                                    message: "Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."
                                }
                            }!f && e.error && (f = e.error, e = null), d.onerror = a.Util.falseFn, b.call(c, f, e)
                        }
                    }, d
                }
                var e = 0;
                window._EsriLeafletCallbacks = {}, b.Request = {
                    request: function(e, f, g, h) {
                        var i = c(f),
                            j = d(g, h),
                            k = (e + "?" + i).length;
                        if (k <= 2e3 && a.esri.Support.CORS) j.open("GET", e + "?" + i), j.send(null);
                        else {
                            if (!(k > 2e3 && a.esri.Support.CORS)) return k <= 2e3 && !a.esri.Support.CORS ? a.esri.Request.get.JSONP(e, f, g, h) : void b.Util.warn("a request to " + e + " was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");
                            j.open("POST", e), j.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), j.send(i)
                        }
                        return j
                    },
                    post: {
                        XMLHTTP: function(a, b, e, f) {
                            var g = d(e, f);
                            return g.open("POST", a), g.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), g.send(c(b)), g
                        }
                    },
                    get: {
                        CORS: function(a, b, e, f) {
                            var g = d(e, f);
                            return g.open("GET", a + "?" + c(b), !0), g.send(null), g
                        },
                        JSONP: function(b, d, f, g) {
                            var h = "c" + e;
                            d.callback = "window._EsriLeafletCallbacks." + h;
                            var i = a.DomUtil.create("script", null, document.body);
                            return i.type = "text/javascript", i.src = b + "?" + c(d), i.id = h, window._EsriLeafletCallbacks[h] = function(a) {
                                if (window._EsriLeafletCallbacks[h] !== !0) {
                                    var b, c = Object.prototype.toString.call(a);
                                    "[object Object]" !== c && "[object Array]" !== c && (b = {
                                        error: {
                                            code: 500,
                                            message: "Expected array or object as JSONP response"
                                        }
                                    }, a = null), !b && a.error && (b = a, a = null), f.call(g, b, a), window._EsriLeafletCallbacks[h] = !0
                                }
                            }, e++, {
                                id: h,
                                url: i.src,
                                abort: function() {
                                    window._EsriLeafletCallbacks._callback[h]({
                                        code: 0,
                                        message: "Request aborted."
                                    })
                                }
                            }
                        }
                    }
                }, b.get = b.Support.CORS ? b.Request.get.CORS : b.Request.get.JSONP, b.post = b.Request.post.XMLHTTP, b.request = b.Request.request
            }(b), b.Services.Service = a.Class.extend({
                includes: a.Mixin.Events,
                options: {
                    proxy: !1,
                    useCors: b.Support.CORS
                },
                initialize: function(c) {
                    c = c || {}, this._requestQueue = [], this._authenticating = !1, a.Util.setOptions(this, c), this.options.url = b.Util.cleanUrl(this.options.url)
                },
                get: function(a, b, c, d) {
                    return this._request("get", a, b, c, d)
                },
                post: function(a, b, c, d) {
                    return this._request("post", a, b, c, d)
                },
                request: function(a, b, c, d) {
                    return this._request("request", a, b, c, d)
                },
                metadata: function(a, b) {
                    return this._request("get", "", {}, a, b)
                },
                authenticate: function(a) {
                    return this._authenticating = !1, this.options.token = a, this._runQueue(), this
                },
                _request: function(a, c, d, e, f) {
                    this.fire("requeststart", {
                        url: this.options.url + c,
                        params: d,
                        method: a
                    });
                    var g = this._createServiceCallback(a, c, d, e, f);
                    if (this.options.token && (d.token = this.options.token), this._authenticating) return void this._requestQueue.push([a, c, d, e, f]);
                    var h = this.options.proxy ? this.options.proxy + "?" + this.options.url + c : this.options.url + c;
                    return "get" !== a && "request" !== a || this.options.useCors ? b[a](h, d, g) : b.Request.get.JSONP(h, d, g)
                },
                _createServiceCallback: function(b, c, d, e, f) {
                    return a.Util.bind(function(g, h) {
                        g && (499 === g.code || 498 === g.code) && (this._authenticating = !0, this._requestQueue.push([b, c, d, e, f]), this.fire("authenticationrequired", {
                            authenticate: a.Util.bind(this.authenticate, this)
                        }), g.authenticate = a.Util.bind(this.authenticate, this)), e.call(f, g, h), g ? this.fire("requesterror", {
                            url: this.options.url + c,
                            params: d,
                            message: g.message,
                            code: g.code,
                            method: b
                        }) : this.fire("requestsuccess", {
                            url: this.options.url + c,
                            params: d,
                            response: h,
                            method: b
                        }), this.fire("requestend", {
                            url: this.options.url + c,
                            params: d,
                            method: b
                        })
                    }, this)
                },
                _runQueue: function() {
                    for (var a = this._requestQueue.length - 1; a >= 0; a--) {
                        var b = this._requestQueue[a],
                            c = b.shift();
                        this[c].apply(this, b)
                    }
                    this._requestQueue = []
                }
            }), b.Services.service = function(a) {
                return new b.Services.Service(a)
            }, b.Services.FeatureLayerService = b.Services.Service.extend({
                options: {
                    idAttribute: "OBJECTID"
                },
                query: function() {
                    return new b.Tasks.Query(this)
                },
                addFeature: function(a, c, d) {
                    return delete a.id, a = b.Util.geojsonToArcGIS(a), this.post("addFeatures", {
                        features: [a]
                    }, function(a, b) {
                        var e = b && b.addResults ? b.addResults[0] : void 0;
                        c && c.call(d, a || b.addResults[0].error, e)
                    }, d)
                },
                updateFeature: function(a, c, d) {
                    return a = b.Util.geojsonToArcGIS(a, this.options.idAttribute), this.post("updateFeatures", {
                        features: [a]
                    }, function(a, b) {
                        var e = b && b.updateResults ? b.updateResults[0] : void 0;
                        c && c.call(d, a || b.updateResults[0].error, e)
                    }, d)
                },
                deleteFeature: function(a, b, c) {
                    return this.post("deleteFeatures", {
                        objectIds: a
                    }, function(a, d) {
                        var e = d && d.deleteResults ? d.deleteResults[0] : void 0;
                        b && b.call(c, a || d.deleteResults[0].error, e)
                    }, c)
                },
                deleteFeatures: function(a, b, c) {
                    return this.post("deleteFeatures", {
                        objectIds: a
                    }, function(a, d) {
                        var e = d && d.deleteResults ? d.deleteResults : void 0;
                        b && b.call(c, a || d.deleteResults[0].error, e)
                    }, c)
                }
            }), b.Services.featureLayerService = function(a) {
                return new b.Services.FeatureLayerService(a)
            }, b.Services.MapService = b.Services.Service.extend({
                identify: function() {
                    return new b.Tasks.identifyFeatures(this)
                },
                find: function() {
                    return new b.Tasks.Find(this)
                },
                query: function() {
                    return new b.Tasks.Query(this)
                }
            }), b.Services.mapService = function(a) {
                return new b.Services.MapService(a)
            }, b.Services.ImageService = b.Services.Service.extend({
                query: function() {
                    return new b.Tasks.Query(this)
                },
                identify: function() {
                    return new b.Tasks.IdentifyImage(this)
                }
            }), b.Services.imageService = function(a) {
                return new b.Services.ImageService(a)
            }, b.Tasks.Task = a.Class.extend({
                options: {
                    proxy: !1,
                    useCors: b.Support.CORS
                },
                generateSetter: function(b, c) {
                    return a.Util.bind(function(a) {
                        return this.params[b] = a, this
                    }, c)
                },
                initialize: function(b) {
                    if (b.request && b.options ? (this._service = b, a.Util.setOptions(this, b.options)) : (a.Util.setOptions(this, b), this.options.url = a.esri.Util.cleanUrl(b.url)), this.params = a.Util.extend({}, this.params || {}), this.setters)
                        for (var c in this.setters) {
                            var d = this.setters[c];
                            this[c] = this.generateSetter(d, this)
                        }
                },
                token: function(a) {
                    return this._service ? this._service.authenticate(a) : this.params.token = a, this
                },
                request: function(a, b) {
                    return this._service ? this._service.request(this.path, this.params, a, b) : this._request("request", this.path, this.params, a, b)
                },
                _request: function(a, c, d, e, f) {
                    var g = this.options.proxy ? this.options.proxy + "?" + this.options.url + c : this.options.url + c;
                    return "get" !== a && "request" !== a || this.options.useCors ? b[a](g, d, e, f) : b.Request.get.JSONP(g, d, e, f)
                }
            }), b.Tasks.Query = b.Tasks.Task.extend({
                setters: {
                    offset: "offset",
                    limit: "limit",
                    fields: "outFields",
                    precision: "geometryPrecision",
                    featureIds: "objectIds",
                    returnGeometry: "returnGeometry",
                    token: "token"
                },
                path: "query",
                params: {
                    returnGeometry: !0,
                    where: "1=1",
                    outSr: 4326,
                    outFields: "*"
                },
                within: function(a) {
                    return this._setGeometry(a), this.params.spatialRel = "esriSpatialRelContains", this
                },
                intersects: function(a) {
                    return this._setGeometry(a), this.params.spatialRel = "esriSpatialRelIntersects", this
                },
                contains: function(a) {
                    return this._setGeometry(a), this.params.spatialRel = "esriSpatialRelWithin", this
                },
                overlaps: function(a) {
                    return this._setGeometry(a), this.params.spatialRel = "esriSpatialRelOverlaps", this
                },
                nearby: function(b, c) {
                    return b = a.latLng(b), this.params.geometry = [b.lng, b.lat], this.params.geometryType = "esriGeometryPoint", this.params.spatialRel = "esriSpatialRelIntersects", this.params.units = "esriSRUnit_Meter", this.params.distance = c, this.params.inSr = 4326, this
                },
                where: function(a) {
                    return this.params.where = a, this
                },
                between: function(a, b) {
                    return this.params.time = [a.valueOf(), b.valueOf()], this
                },
                simplify: function(a, b) {
                    var c = Math.abs(a.getBounds().getWest() - a.getBounds().getEast());
                    return this.params.maxAllowableOffset = c / a.getSize().y * b, this
                },
                orderBy: function(a, b) {
                    return b = b || "ASC", this.params.orderByFields = this.params.orderByFields ? this.params.orderByFields + "," : "", this.params.orderByFields += [a, b].join(" "), this
                },
                run: function(a, c) {
                    return this._cleanParams(), b.Util.isArcgisOnline(this.options.url) ? (this.params.f = "geojson", this.request(function(b, d) {
                        this._trapSQLerrors(b), a.call(c, b, d, d)
                    }, this)) : this.request(function(d, e) {
                        this._trapSQLerrors(d), a.call(c, d, e && b.Util.responseToFeatureCollection(e), e)
                    }, this)
                },
                count: function(a, b) {
                    return this._cleanParams(), this.params.returnCountOnly = !0, this.request(function(b, c) {
                        a.call(this, b, c && c.count, c)
                    }, b)
                },
                ids: function(a, b) {
                    return this._cleanParams(), this.params.returnIdsOnly = !0, this.request(function(b, c) {
                        a.call(this, b, c && c.objectIds, c)
                    }, b)
                },
                bounds: function(a, c) {
                    return this._cleanParams(), this.params.returnExtentOnly = !0, this.request(function(d, e) {
                        a.call(c, d, e && e.extent && b.Util.extentToBounds(e.extent), e)
                    }, c)
                },
                pixelSize: function(b) {
                    return b = a.point(b), this.params.pixelSize = [b.x, b.y], this
                },
                layer: function(a) {
                    return this.path = a + "/query", this
                },
                _trapSQLerrors: function(a) {
                    a && "400" === a.code && b.Util.warn("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")
                },
                _cleanParams: function() {
                    delete this.params.returnIdsOnly, delete this.params.returnExtentOnly, delete this.params.returnCountOnly
                },
                _setGeometry: function(c) {
                    return this.params.inSr = 4326, c instanceof a.LatLngBounds ? (this.params.geometry = b.Util.boundsToExtent(c), void(this.params.geometryType = "esriGeometryEnvelope")) : (c.getLatLng && (c = c.getLatLng()), c instanceof a.LatLng && (c = {
                        type: "Point",
                        coordinates: [c.lng, c.lat]
                    }), c instanceof a.GeoJSON && (c = c.getLayers()[0].feature.geometry, this.params.geometry = b.Util.geojsonToArcGIS(c), this.params.geometryType = b.Util.geojsonTypeToArcGIS(c.type)), c.toGeoJSON && (c = c.toGeoJSON()), "Feature" === c.type && (c = c.geometry), "Point" === c.type || "LineString" === c.type || "Polygon" === c.type ? (this.params.geometry = b.Util.geojsonToArcGIS(c), void(this.params.geometryType = b.Util.geojsonTypeToArcGIS(c.type))) : void b.Util.warn("invalid geometry passed to spatial query. Should be an L.LatLng, L.LatLngBounds or L.Marker or a GeoJSON Point Line or Polygon object"))
                }
            }), b.Tasks.query = function(a) {
                return new b.Tasks.Query(a)
            }, b.Tasks.Find = b.Tasks.Task.extend({
                setters: {
                    contains: "contains",
                    text: "searchText",
                    fields: "searchFields",
                    spatialReference: "sr",
                    sr: "sr",
                    layers: "layers",
                    returnGeometry: "returnGeometry",
                    maxAllowableOffset: "maxAllowableOffset",
                    precision: "geometryPrecision",
                    dynamicLayers: "dynamicLayers",
                    returnZ: "returnZ",
                    returnM: "returnM",
                    gdbVersion: "gdbVersion",
                    token: "token"
                },
                path: "find",
                params: {
                    sr: 4326,
                    contains: !0,
                    returnGeometry: !0,
                    returnZ: !0,
                    returnM: !1
                },
                layerDefs: function(a, b) {
                    return this.params.layerDefs = this.params.layerDefs ? this.params.layerDefs + ";" : "", this.params.layerDefs += [a, b].join(":"), this
                },
                simplify: function(a, b) {
                    var c = Math.abs(a.getBounds().getWest() - a.getBounds().getEast());
                    return this.params.maxAllowableOffset = c / a.getSize().y * b, this
                },
                run: function(a, c) {
                    return this.request(function(d, e) {
                        a.call(c, d, e && b.Util.responseToFeatureCollection(e), e)
                    }, c)
                }
            }), b.Tasks.find = function(a) {
                return new b.Tasks.Find(a)
            }, b.Tasks.Identify = b.Tasks.Task.extend({
                path: "identify",
                between: function(a, b) {
                    return this.params.time = [a.valueOf(), b.valueOf()], this
                }
            }), b.Tasks.IdentifyImage = b.Tasks.Identify.extend({
                setters: {
                    setMosaicRule: "mosaicRule",
                    setRenderingRule: "renderingRule",
                    setPixelSize: "pixelSize",
                    returnCatalogItems: "returnCatalogItems",
                    returnGeometry: "returnGeometry"
                },
                params: {
                    returnGeometry: !1
                },
                at: function(b) {
                    return b = a.latLng(b), this.params.geometry = JSON.stringify({
                        x: b.lng,
                        y: b.lat,
                        spatialReference: {
                            wkid: 4326
                        }
                    }), this.params.geometryType = "esriGeometryPoint", this
                },
                getMosaicRule: function() {
                    return this.params.mosaicRule
                },
                getRenderingRule: function() {
                    return this.params.renderingRule
                },
                getPixelSize: function() {
                    return this.params.pixelSize
                },
                run: function(a, b) {
                    return this.request(function(c, d) {
                        a.call(b, c, d && this._responseToGeoJSON(d), d)
                    }, this)
                },
                _responseToGeoJSON: function(a) {
                    var c = a.location,
                        d = a.catalogItems,
                        e = a.catalogItemVisibilities,
                        f = {
                            pixel: {
                                type: "Feature",
                                geometry: {
                                    type: "Point",
                                    coordinates: [c.x, c.y]
                                },
                                crs: {
                                    type: "EPSG",
                                    properties: {
                                        code: c.spatialReference.wkid
                                    }
                                },
                                properties: {
                                    OBJECTID: a.objectId,
                                    name: a.name,
                                    value: a.value
                                },
                                id: a.objectId
                            }
                        };
                    if (a.properties && a.properties.Values && (f.pixel.properties.values = a.properties.Values), d && d.features && (f.catalogItems = b.Util.responseToFeatureCollection(d), e && e.length === f.catalogItems.features.length))
                        for (var g = e.length - 1; g >= 0; g--) f.catalogItems.features[g].properties.catalogItemVisibility = e[g];
                    return f
                }
            }), b.Tasks.identifyImage = function(a) {
                return new b.Tasks.IdentifyImage(a)
            }, b.Tasks.IdentifyFeatures = b.Tasks.Identify.extend({
                setters: {
                    layers: "layers",
                    precision: "geometryPrecision",
                    tolerance: "tolerance",
                    returnGeometry: "returnGeometry"
                },
                params: {
                    sr: 4326,
                    layers: "all",
                    tolerance: 3,
                    returnGeometry: !0
                },
                on: function(a) {
                    var c = b.Util.boundsToExtent(a.getBounds()),
                        d = a.getSize();
                    return this.params.imageDisplay = [d.x, d.y, 96], this.params.mapExtent = [c.xmin, c.ymin, c.xmax, c.ymax], this
                },
                at: function(b) {
                    return b = a.latLng(b), this.params.geometry = [b.lng, b.lat], this.params.geometryType = "esriGeometryPoint", this
                },
                layerDef: function(a, b) {
                    return this.params.layerDefs = this.params.layerDefs ? this.params.layerDefs + ";" : "", this.params.layerDefs += [a, b].join(":"), this
                },
                simplify: function(a, b) {
                    var c = Math.abs(a.getBounds().getWest() - a.getBounds().getEast());
                    return this.params.maxAllowableOffset = c / a.getSize().y * (1 - b), this
                },
                run: function(a, c) {
                    return this.request(function(d, e) {
                        if (d) return void a.call(c, d, void 0, e);
                        var f = b.Util.responseToFeatureCollection(e);
                        e.results = e.results.reverse();
                        for (var g = 0; g < f.features.length; g++) {
                            var h = f.features[g];
                            h.layerId = e.results[g].layerId
                        }
                        a.call(c, void 0, f, e)
                    })
                }
            }), b.Tasks.identifyFeatures = function(a) {
                return new b.Tasks.IdentifyFeatures(a)
            },
            function(b) {
                var c = "https:" !== window.location.protocol ? "http:" : "https:";
                b.Layers.BasemapLayer = a.TileLayer.extend({
                    statics: {
                        TILES: {
                            Streets: {
                                urlTemplate: c + "//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",
                                attributionUrl: "https://static.arcgis.com/attribution/World_Street_Map",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri"
                                }
                            },
                            Topographic: {
                                urlTemplate: c + "//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",
                                attributionUrl: "https://static.arcgis.com/attribution/World_Topo_Map",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri"
                                }
                            },
                            Oceans: {
                                urlTemplate: c + "//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",
                                attributionUrl: "https://static.arcgis.com/attribution/Ocean_Basemap",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri"
                                }
                            },
                            OceansLabels: {
                                urlTemplate: c + "//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !0,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"]
                                }
                            },
                            NationalGeographic: {
                                urlTemplate: c + "//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri"
                                }
                            },
                            DarkGray: {
                                urlTemplate: c + "//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri, DeLorme, HERE"
                                }
                            },
                            DarkGrayLabels: {
                                urlTemplate: c + "//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !0,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"]
                                }
                            },
                            Gray: {
                                urlTemplate: c + "//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri, NAVTEQ, DeLorme"
                                }
                            },
                            GrayLabels: {
                                urlTemplate: c + "//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !0,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"]
                                }
                            },
                            Imagery: {
                                urlTemplate: c + "//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri, DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community"
                                }
                            },
                            ImageryLabels: {
                                urlTemplate: c + "//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !0,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"]
                                }
                            },
                            ImageryTransportation: {
                                urlTemplate: c + "//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !0,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"]
                                }
                            },
                            ShadedRelief: {
                                urlTemplate: c + "//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri, NAVTEQ, DeLorme"
                                }
                            },
                            ShadedReliefLabels: {
                                urlTemplate: c + "//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !0,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"]
                                }
                            },
                            Terrain: {
                                urlTemplate: c + "//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri, USGS, NOAA"
                                }
                            },
                            TerrainLabels: {
                                urlTemplate: c + "//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !0,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"]
                                }
                            }
                        }
                    },
                    initialize: function(c, d) {
                        var e;
                        if ("object" == typeof c && c.urlTemplate && c.options) e = c;
                        else {
                            if ("string" != typeof c || !b.BasemapLayer.TILES[c]) throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ShadedRelief", "ShadedReliefLabels", "Terrain" or "TerrainLabels"');
                            e = b.BasemapLayer.TILES[c]
                        }
                        var f = a.Util.extend(e.options, d);
                        a.TileLayer.prototype.initialize.call(this, e.urlTemplate, a.Util.setOptions(this, f)), e.attributionUrl && this._getAttributionData(e.attributionUrl), this._logo = new b.Controls.Logo({
                            position: this.options.logoPosition
                        })
                    },
                    onAdd: function(b) {
                        !this.options.hideLogo && !b._hasEsriLogo && (this._logo.addTo(b), b._hasEsriLogo = !0), a.TileLayer.prototype.onAdd.call(this, b), b.on("moveend", this._updateMapAttribution, this)
                    },
                    onRemove: function(b) {
                        this._logo && this._logo._container && (b.removeControl(this._logo), b._hasEsriLogo = !1), a.TileLayer.prototype.onRemove.call(this, b), b.off("moveend", this._updateMapAttribution, this)
                    },
                    getAttribution: function() {
                        var a = '<span class="esri-attributions" style="line-height:14px; vertical-align: -3px; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; display:inline-block;">' + this.options.attribution + "</span>";
                        return a
                    },
                    _getAttributionData: function(b) {
                        a.esri.Request.get.JSONP(b, {}, a.Util.bind(function(b, c) {
                            this._attributions = [];
                            for (var d = 0; d < c.contributors.length; d++)
                                for (var e = c.contributors[d], f = 0; f < e.coverageAreas.length; f++) {
                                    var g = e.coverageAreas[f],
                                        h = new a.LatLng(g.bbox[0], g.bbox[1]),
                                        i = new a.LatLng(g.bbox[2], g.bbox[3]);
                                    this._attributions.push({
                                        attribution: e.attribution,
                                        score: g.score,
                                        bounds: new a.LatLngBounds(h, i),
                                        minZoom: g.zoomMin,
                                        maxZoom: g.zoomMax
                                    })
                                }
                            this._attributions.sort(function(a, b) {
                                return b.score - a.score
                            }), this._updateMapAttribution()
                        }, this))
                    },
                    _updateMapAttribution: function() {
                        if (this._map && this._map.attributionControl && this._attributions) {
                            for (var a = "", b = this._map.getBounds(), c = this._map.getZoom(), d = 0; d < this._attributions.length; d++) {
                                var e = this._attributions[d],
                                    f = e.attribution;
                                !a.match(f) && b.intersects(e.bounds) && c >= e.minZoom && c <= e.maxZoom && (a += ", " + f)
                            }
                            a = a.substr(2);
                            var g = this._map.attributionControl._container.querySelector(".esri-attributions");
                            g.innerHTML = a, g.style.maxWidth = .65 * this._map.getSize().x + "px", this.fire("attributionupdated", {
                                attribution: a
                            })
                        }
                    }
                }), b.BasemapLayer = b.Layers.BasemapLayer, b.Layers.basemapLayer = function(a, c) {
                    return new b.Layers.BasemapLayer(a, c)
                }, b.basemapLayer = function(a, c) {
                    return new b.Layers.BasemapLayer(a, c)
                }
            }(b), b.Layers.RasterLayer = a.Class.extend({
                includes: a.Mixin.Events,
                options: {
                    opacity: 1,
                    position: "front",
                    f: "image"
                },
                onAdd: function(b) {
                    if (this._map = b, this._update = a.Util.limitExecByInterval(this._update, this.options.updateInterval, this), b.options.crs && b.options.crs.code) {
                        var c = b.options.crs.code.split(":")[1];
                        this.options.bboxSR = c, this.options.imageSR = c
                    }
                    b.on("moveend", this._update, this), this._currentImage && this._currentImage._bounds.equals(this._map.getBounds()) ? b.addLayer(this._currentImage) : this._currentImage && (this._map.removeLayer(this._currentImage), this._currentImage = null), this._update(), this._popup && (this._map.on("click", this._getPopupData, this), this._map.on("dblclick", this._resetPopupState, this))
                },
                bindPopup: function(b, c) {
                    return this._shouldRenderPopup = !1, this._lastClick = !1, this._popup = a.popup(c), this._popupFunction = b, this._map && (this._map.on("click", this._getPopupData, this), this._map.on("dblclick", this._resetPopupState, this)), this
                },
                unbindPopup: function() {
                    return this._map && (this._map.closePopup(this._popup), this._map.off("click", this._getPopupData, this), this._map.off("dblclick", this._resetPopupState, this)), this._popup = !1, this
                },
                onRemove: function(a) {
                    this._currentImage && this._map.removeLayer(this._currentImage), this._popup && (this._map.off("click", this._getPopupData, this), this._map.off("dblclick", this._resetPopupState, this)), this._map.off("moveend", this._update, this), this._map = null
                },
                addTo: function(a) {
                    return a.addLayer(this), this
                },
                removeFrom: function(a) {
                    return a.removeLayer(this), this
                },
                bringToFront: function() {
                    return this.options.position = "front", this._currentImage && this._currentImage.bringToFront(), this
                },
                bringToBack: function() {
                    return this.options.position = "back", this._currentImage && this._currentImage.bringToBack(), this
                },
                getAttribution: function() {
                    return this.options.attribution
                },
                getOpacity: function() {
                    return this.options.opacity
                },
                setOpacity: function(a) {
                    return this.options.opacity = a, this._currentImage.setOpacity(a), this
                },
                getTimeRange: function() {
                    return [this.options.from, this.options.to]
                },
                setTimeRange: function(a, b) {
                    return this.options.from = a, this.options.to = b, this._update(), this
                },
                metadata: function(a, b) {
                    return this._service.metadata(a, b), this
                },
                authenticate: function(a) {
                    return this._service.authenticate(a), this
                },
                _renderImage: function(b, c) {
                    if (this._map) {
                        var d = new a.ImageOverlay(b, c, {
                            opacity: 0
                        }).addTo(this._map);
                        d.once("load", function(a) {
                            var b = a.target,
                                d = this._currentImage;
                            b._bounds.equals(c) && b._bounds.equals(this._map.getBounds()) ? (this._currentImage = b, "front" === this.options.position ? this.bringToFront() : this.bringToBack(), this._map && this._currentImage._map ? this._currentImage.setOpacity(this.options.opacity) : this._currentImage._map.removeLayer(this._currentImage), d && this._map && this._map.removeLayer(d), d && d._map && d._map.removeLayer(d)) : this._map.removeLayer(b), this.fire("load", {
                                bounds: c
                            })
                        }, this), this.fire("loading", {
                            bounds: c
                        })
                    }
                },
                _update: function() {
                    if (this._map) {
                        var a = this._map.getZoom(),
                            b = this._map.getBounds();
                        if (!this._animatingZoom && !(this._map._panTransition && this._map._panTransition._inProgress || a > this.options.maxZoom || a < this.options.minZoom)) {
                            var c = this._buildExportParams();
                            this._requestExport(c, b)
                        }
                    }
                },
                _renderPopup: function(b, c, d, e) {
                    if (b = a.latLng(b), this._shouldRenderPopup && this._lastClick.equals(b)) {
                        var f = this._popupFunction(c, d, e);
                        f && this._popup.setLatLng(b).setContent(f).openOn(this._map)
                    }
                },
                _resetPopupState: function(a) {
                    this._shouldRenderPopup = !1, this._lastClick = a.latlng
                },
                _propagateEvent: function(b) {
                    b = a.extend({
                        layer: b.target,
                        target: this
                    }, b), this.fire(b.type, b)
                }
            }), b.Layers.DynamicMapLayer = b.Layers.RasterLayer.extend({
                options: {
                    updateInterval: 150,
                    layers: !1,
                    layerDefs: !1,
                    timeOptions: !1,
                    format: "png24",
                    transparent: !0,
                    f: "json"
                },
                initialize: function(c) {
                    c.url = b.Util.cleanUrl(c.url), this._service = new b.Services.MapService(c), this._service.on("authenticationrequired requeststart requestend requesterror requestsuccess", this._propagateEvent, this), (c.proxy || c.token) && "json" !== c.f && (c.f = "json"), a.Util.setOptions(this, c)
                },
                getDynamicLayers: function() {
                    return this.options.dynamicLayers
                },
                setDynamicLayers: function(a) {
                    return this.options.dynamicLayers = a, this._update(), this
                },
                getLayers: function() {
                    return this.options.layers
                },
                setLayers: function(a) {
                    return this.options.layers = a, this._update(), this
                },
                getLayerDefs: function() {
                    return this.options.layerDefs
                },
                setLayerDefs: function(a) {
                    return this.options.layerDefs = a, this._update(), this
                },
                getTimeOptions: function() {
                    return this.options.timeOptions
                },
                setTimeOptions: function(a) {
                    return this.options.timeOptions = a, this._update(), this
                },
                query: function() {
                    return this._service.query()
                },
                identify: function() {
                    return this._service.identify()
                },
                find: function() {
                    return this._service.find()
                },
                _getPopupData: function(b) {
                    var c = a.Util.bind(function(c, d, e) {
                            c || setTimeout(a.Util.bind(function() {
                                this._renderPopup(b.latlng, c, d, e)
                            }, this), 300)
                        }, this),
                        d = this.identify().on(this._map).at(b.latlng);
                    this.options.layers ? d.layers("visible:" + this.options.layers.join(",")) : d.layers("visible"), d.run(c), this._shouldRenderPopup = !0, this._lastClick = b.latlng
                },
                _buildExportParams: function() {
                    var a = this._map.getBounds(),
                        b = this._map.getSize(),
                        c = this._map.options.crs.project(a._northEast),
                        d = this._map.options.crs.project(a._southWest),
                        e = this._map.latLngToLayerPoint(a._northEast),
                        f = this._map.latLngToLayerPoint(a._southWest);
                    (e.y > 0 || f.y < b.y) && (b.y = f.y - e.y);
                    var g = {
                        bbox: [d.x, d.y, c.x, c.y].join(","),
                        size: b.x + "," + b.y,
                        dpi: 96,
                        format: this.options.format,
                        transparent: this.options.transparent,
                        bboxSR: this.options.bboxSR,
                        imageSR: this.options.imageSR
                    };
                    return this.options.dynamicLayers && (g.dynamicLayers = this.options.dynamicLayers), this.options.layers && (g.layers = "show:" + this.options.layers.join(",")), this.options.layerDefs && (g.layerDefs = JSON.stringify(this.options.layerDefs)), this.options.timeOptions && (g.timeOptions = JSON.stringify(this.options.timeOptions)), this.options.from && this.options.to && (g.time = this.options.from.valueOf() + "," + this.options.to.valueOf()), this._service.options.token && (g.token = this._service.options.token), g
                },
                _requestExport: function(b, c) {
                    "json" === this.options.f ? this._service.request("export", b, function(a, b) {
                        a || this._renderImage(b.href, c)
                    }, this) : (b.f = "image", this._renderImage(this.options.url + "export" + a.Util.getParamString(b), c))
                }
            }), b.DynamicMapLayer = b.Layers.DynamicMapLayer, b.Layers.dynamicMapLayer = function(a) {
                return new b.Layers.DynamicMapLayer(a)
            }, b.dynamicMapLayer = function(a) {
                return new b.Layers.DynamicMapLayer(a)
            }, b.Layers.ImageMapLayer = b.Layers.RasterLayer.extend({
                options: {
                    updateInterval: 150,
                    format: "jpgpng",
                    transparent: !0,
                    f: "json"
                },
                query: function() {
                    return this._service.query()
                },
                identify: function() {
                    return this._service.identify()
                },
                initialize: function(c) {
                    c.url = b.Util.cleanUrl(c.url), this._service = new b.Services.ImageService(c), this._service.on("authenticationrequired requeststart requestend requesterror requestsuccess", this._propagateEvent, this), a.Util.setOptions(this, c)
                },
                setPixelType: function(a) {
                    return this.options.pixelType = a, this._update(), this
                },
                getPixelType: function() {
                    return this.options.pixelType
                },
                setBandIds: function(b) {
                    return a.Util.isArray(b) ? this.options.bandIds = b.join(",") : this.options.bandIds = b.toString(), this._update(), this
                },
                getBandIds: function() {
                    return this.options.bandIds
                },
                setNoData: function(b, c) {
                    return a.Util.isArray(b) ? this.options.noData = b.join(",") : this.options.noData = b.toString(), c && (this.options.noDataInterpretation = c), this._update(), this
                },
                getNoData: function() {
                    return this.options.noData
                },
                getNoDataInterpretation: function() {
                    return this.options.noDataInterpretation
                },
                setRenderingRule: function(a) {
                    this.options.renderingRule = a, this._update()
                },
                getRenderingRule: function() {
                    return this.options.renderingRule
                },
                setMosaicRule: function(a) {
                    this.options.mosaicRule = a, this._update()
                },
                getMosaicRule: function() {
                    return this.options.mosaicRule
                },
                _getPopupData: function(b) {
                    var c = a.Util.bind(function(c, d, e) {
                            c || setTimeout(a.Util.bind(function() {
                                this._renderPopup(b.latlng, c, d, e)
                            }, this), 300)
                        }, this),
                        d = this.identify().at(b.latlng);
                    this.options.mosaicRule && d.setMosaicRule(this.options.mosaicRule), d.run(c), this._shouldRenderPopup = !0, this._lastClick = b.latlng
                },
                _buildExportParams: function() {
                    var a = this._map.getBounds(),
                        b = this._map.getSize(),
                        c = this._map.options.crs.project(a._northEast),
                        d = this._map.options.crs.project(a._southWest),
                        e = {
                            bbox: [d.x, d.y, c.x, c.y].join(","),
                            size: b.x + "," + b.y,
                            format: this.options.format,
                            transparent: this.options.transparent,
                            bboxSR: this.options.bboxSR,
                            imageSR: this.options.imageSR
                        };
                    return this.options.from && this.options.to && (e.time = this.options.from.valueOf() + "," + this.options.to.valueOf()), this.options.pixelType && (e.pixelType = this.options.pixelType), this.options.interpolation && (e.interpolation = this.options.interpolation), this.options.compressionQuality && (e.compressionQuality = this.options.compressionQuality), this.options.bandIds && (e.bandIds = this.options.bandIds), this.options.noData && (e.noData = this.options.noData), this.options.noDataInterpretation && (e.noDataInterpretation = this.options.noDataInterpretation), this._service.options.token && (e.token = this._service.options.token), this.options.renderingRule && (e.renderingRule = JSON.stringify(this.options.renderingRule)), this.options.mosaicRule && (e.mosaicRule = JSON.stringify(this.options.mosaicRule)), e
                },
                _requestExport: function(b, c) {
                    "json" === this.options.f ? this._service.request("exportImage", b, function(a, b) {
                        a || this._renderImage(b.href, c)
                    }, this) : (b.f = "image", this._renderImage(this.options.url + "exportImage" + a.Util.getParamString(b), c))
                }
            }), b.ImageMapLayer = b.Layers.ImageMapLayer, b.Layers.imageMapLayer = function(a) {
                return new b.Layers.ImageMapLayer(a)
            }, b.imageMapLayer = function(a) {
                return new b.Layers.ImageMapLayer(a)
            }, b.Layers.TiledMapLayer = a.TileLayer.extend({
                options: {
                    zoomOffsetAllowance: .1,
                    correctZoomLevels: !0
                },
                statics: {
                    MercatorZoomLevels: {
                        0: 156543.033928,
                        1: 78271.5169639999,
                        2: 39135.7584820001,
                        3: 19567.8792409999,
                        4: 9783.93962049996,
                        5: 4891.96981024998,
                        6: 2445.98490512499,
                        7: 1222.99245256249,
                        8: 611.49622628138,
                        9: 305.748113140558,
                        10: 152.874056570411,
                        11: 76.4370282850732,
                        12: 38.2185141425366,
                        13: 19.1092570712683,
                        14: 9.55462853563415,
                        15: 4.77731426794937,
                        16: 2.38865713397468,
                        17: 1.19432856685505,
                        18: .597164283559817,
                        19: .298582141647617,
                        20: .14929107082381,
                        21: .07464553541191,
                        22: .0373227677059525,
                        23: .0186613838529763
                    }
                },
                initialize: function(c) {
                    c.url = b.Util.cleanUrl(c.url), c = a.Util.setOptions(this, c), this.tileUrl = a.esri.Util.cleanUrl(c.url) + "tile/{z}/{y}/{x}", this._service = new a.esri.Services.MapService(c), this._service.on("authenticationrequired requeststart requestend requesterror requestsuccess", this._propagateEvent, this), this.tileUrl.match("://tiles.arcgisonline.com") && (this.tileUrl = this.tileUrl.replace("://tiles.arcgisonline.com", "://tiles{s}.arcgisonline.com"), c.subdomains = ["1", "2", "3", "4"]), this.options.token && (this.tileUrl += "?token=" + this.options.token), a.TileLayer.prototype.initialize.call(this, this.tileUrl, c)
                },
                getTileUrl: function(b) {
                    return a.Util.template(this.tileUrl, a.extend({
                        s: this._getSubdomain(b),
                        z: this._lodMap[b.z] || b.z,
                        x: b.x,
                        y: b.y
                    }, this.options))
                },
                onAdd: function(c) {
                    !this._lodMap && this.options.correctZoomLevels ? (this._lodMap = {}, this.metadata(function(d, e) {
                        if (!d) {
                            var f = e.spatialReference.latestWkid || e.spatialReference.wkid;
                            if (102100 === f || 3857 === f)
                                for (var g = e.tileInfo.lods, h = b.Layers.TiledMapLayer.MercatorZoomLevels, i = 0; i < g.length; i++) {
                                    var j = g[i];
                                    for (var k in h) {
                                        var l = h[k];
                                        if (this._withinPercentage(j.resolution, l, this.options.zoomOffsetAllowance)) {
                                            this._lodMap[k] = j.level;
                                            break
                                        }
                                    }
                                } else b.Util.warn("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html")
                        }
                        a.TileLayer.prototype.onAdd.call(this, c)
                    }, this)) : a.TileLayer.prototype.onAdd.call(this, c)
                },
                metadata: function(a, b) {
                    return this._service.metadata(a, b), this
                },
                identify: function() {
                    return this._service.identify()
                },
                authenticate: function(a) {
                    var b = "?token=" + a;
                    return this.tileUrl = this.options.token ? this.tileUrl.replace(/\?token=(.+)/g, b) : this.tileUrl + b, this.options.token = a, this._service.authenticate(a), this
                },
                _propagateEvent: function(b) {
                    b = a.extend({
                        layer: b.target,
                        target: this
                    }, b), this.fire(b.type, b)
                },
                _withinPercentage: function(a, b, c) {
                    var d = Math.abs(a / b - 1);
                    return d < c
                }
            }), a.esri.TiledMapLayer = a.esri.Layers.tiledMapLayer, a.esri.Layers.tiledMapLayer = function(b) {
                return new a.esri.Layers.TiledMapLayer(b)
            }, a.esri.tiledMapLayer = function(b) {
                return new a.esri.Layers.TiledMapLayer(b)
            }, b.Layers.FeatureGrid = a.Class.extend({
                includes: a.Mixin.Events,
                options: {
                    cellSize: 512,
                    updateInterval: 150
                },
                initialize: function(b) {
                    b = a.setOptions(this, b)
                },
                onAdd: function(b) {
                    this._map = b, this._update = a.Util.limitExecByInterval(this._update, this.options.updateInterval, this), this._map.addEventListener(this.getEvents(), this), this._reset(), this._update()
                },
                onRemove: function() {
                    this._map.removeEventListener(this.getEvents(), this), this._removeCells()
                },
                getEvents: function() {
                    var a = {
                        viewreset: this._reset,
                        moveend: this._update,
                        zoomend: this._onZoom
                    };
                    return a
                },
                addTo: function(a) {
                    return a.addLayer(this), this
                },
                removeFrom: function(a) {
                    return a.removeLayer(this), this
                },
                _onZoom: function() {
                    var a = this._map.getZoom();
                    a > this.options.maxZoom || a < this.options.minZoom ? (this.removeFrom(this._map), this._map.addEventListener("zoomend", this.getEvents().zoomend, this)) : this._map.hasLayer(this) || (this._map.removeEventListener("zoomend", this.getEvents().zoomend, this), this.addTo(this._map))
                },
                _reset: function() {
                    this._removeCells(), this._cells = {}, this._activeCells = {}, this._cellsToLoad = 0, this._cellsTotal = 0, this._resetWrap()
                },
                _resetWrap: function() {
                    var a = this._map,
                        b = a.options.crs;
                    if (!b.infinite) {
                        var c = this._getCellSize();
                        b.wrapLng && (this._wrapLng = [Math.floor(a.project([0, b.wrapLng[0]]).x / c), Math.ceil(a.project([0, b.wrapLng[1]]).x / c)]), b.wrapLat && (this._wrapLat = [Math.floor(a.project([b.wrapLat[0], 0]).y / c), Math.ceil(a.project([b.wrapLat[1], 0]).y / c)])
                    }
                },
                _getCellSize: function() {
                    return this.options.cellSize
                },
                _update: function() {
                    if (this._map) {
                        var b = this._map.getPixelBounds(),
                            c = this._map.getZoom(),
                            d = this._getCellSize(),
                            e = [d / 2, d / 2];
                        if (!(c > this.options.maxZoom || c < this.options.minZoom)) {
                            var f = b.min.subtract(e).divideBy(d).floor();
                            f.x = Math.max(f.x, 0), f.y = Math.max(f.y, 0);
                            var g = a.bounds(f, b.max.add(e).divideBy(d).floor());
                            this._removeOtherCells(g), this._addCells(g)
                        }
                    }
                },
                _addCells: function(b) {
                    var f, g, h, c = [],
                        d = b.getCenter(),
                        e = this._map.getZoom();
                    for (f = b.min.y; f <= b.max.y; f++)
                        for (g = b.min.x; g <= b.max.x; g++) h = new a.Point(g, f), h.z = e, c.push(h);
                    var i = c.length;
                    if (0 !== i)
                        for (this._cellsToLoad += i, this._cellsTotal += i, c.sort(function(a, b) {
                                return a.distanceTo(d) - b.distanceTo(d)
                            }), g = 0; g < i; g++) this._addCell(c[g])
                },
                _cellCoordsToBounds: function(b) {
                    var c = this._map,
                        d = this.options.cellSize,
                        e = b.multiplyBy(d),
                        f = e.add([d, d]),
                        g = c.unproject(e, b.z).wrap(),
                        h = c.unproject(f, b.z).wrap();
                    return new a.LatLngBounds(g, h)
                },
                _cellCoordsToKey: function(a) {
                    return a.x + ":" + a.y
                },
                _keyToCellCoords: function(b) {
                    var c = b.split(":"),
                        d = parseInt(c[0], 10),
                        e = parseInt(c[1], 10);
                    return new a.Point(d, e)
                },
                _removeOtherCells: function(a) {
                    for (var b in this._cells) a.contains(this._keyToCellCoords(b)) || this._removeCell(b)
                },
                _removeCell: function(a) {
                    var b = this._activeCells[a];
                    b && (delete this._activeCells[a], this.cellLeave && this.cellLeave(b.bounds, b.coords), this.fire("cellleave", {
                        bounds: b.bounds,
                        coords: b.coords
                    }))
                },
                _removeCells: function() {
                    for (var a in this._cells) {
                        var b = this._cells[a].bounds,
                            c = this._cells[a].coords;
                        this.cellLeave && this.cellLeave(b, c), this.fire("cellleave", {
                            bounds: b,
                            coords: c
                        })
                    }
                },
                _addCell: function(a) {
                    this._wrapCoords(a);
                    var b = this._cellCoordsToKey(a),
                        c = this._cells[b];
                    c && !this._activeCells[b] && (this.cellEnter && this.cellEnter(c.bounds, a), this.fire("cellenter", {
                        bounds: c.bounds,
                        coords: a
                    }), this._activeCells[b] = c), c || (c = {
                        coords: a,
                        bounds: this._cellCoordsToBounds(a)
                    }, this._cells[b] = c, this._activeCells[b] = c, this.createCell && this.createCell(c.bounds, a), this.fire("cellcreate", {
                        bounds: c.bounds,
                        coords: a
                    }))
                },
                _wrapCoords: function(b) {
                    b.x = this._wrapLng ? a.Util.wrapNum(b.x, this._wrapLng) : b.x, b.y = this._wrapLat ? a.Util.wrapNum(b.y, this._wrapLat) : b.y
                }
            }),
            function(b) {
                function c(a) {
                    this.values = a || []
                }
                b.Layers.FeatureManager = b.Layers.FeatureGrid.extend({
                    options: {
                        where: "1=1",
                        fields: ["*"],
                        from: !1,
                        to: !1,
                        timeField: !1,
                        timeFilterMode: "server",
                        simplifyFactor: 0,
                        precision: 6
                    },
                    initialize: function(d) {
                        if (b.Layers.FeatureGrid.prototype.initialize.call(this, d), d.url = b.Util.cleanUrl(d.url), d = a.setOptions(this, d), this._service = new b.Services.FeatureLayerService(d), "*" !== this.options.fields[0]) {
                            for (var e = !1, f = 0; f < this.options.fields.length; f++) this.options.fields[f].match(/^(OBJECTID|FID|OID|ID)$/i) && (e = !0);
                            e === !1 && b.Util.warn("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")
                        }
                        this._service.on("authenticationrequired requeststart requestend requesterror requestsuccess", function(b) {
                            b = a.extend({
                                target: this
                            }, b), this.fire(b.type, b)
                        }, this), this.options.timeField.start && this.options.timeField.end ? (this._startTimeIndex = new c, this._endTimeIndex = new c) : this.options.timeField && (this._timeIndex = new c), this._cache = {}, this._currentSnapshot = [], this._activeRequests = 0, this._pendingRequests = []
                    },
                    onAdd: function(a) {
                        return b.Layers.FeatureGrid.prototype.onAdd.call(this, a)
                    },
                    onRemove: function(a) {
                        return b.Layers.FeatureGrid.prototype.onRemove.call(this, a)
                    },
                    getAttribution: function() {
                        return this.options.attribution
                    },
                    createCell: function(a, b) {
                        this._requestFeatures(a, b)
                    },
                    _requestFeatures: function(c, d, e) {
                        this._activeRequests++, 1 === this._activeRequests && this.fire("loading", {
                            bounds: c
                        }), this._buildQuery(c).run(function(f, g, h) {
                            h && h.exceededTransferLimit && this.fire("drawlimitexceeded"), !f && g && g.features.length && b.Util.requestAnimationFrame(a.Util.bind(function() {
                                this._addFeatures(g.features, d), this._postProcessFeatures(c)
                            }, this)), !f && g && !g.features.length && this._postProcessFeatures(c), e && e.call(this, f, g)
                        }, this)
                    },
                    _postProcessFeatures: function(a) {
                        this._activeRequests--, this._activeRequests <= 0 && this.fire("load", {
                            bounds: a
                        })
                    },
                    _cacheKey: function(a) {
                        return a.z + ":" + a.x + ":" + a.y
                    },
                    _addFeatures: function(a, b) {
                        var c = this._cacheKey(b);
                        this._cache[c] = this._cache[c] || [];
                        for (var d = a.length - 1; d >= 0; d--) {
                            var e = a[d].id;
                            this._currentSnapshot.push(e), this._cache[c].push(e)
                        }
                        this.options.timeField && this._buildTimeIndexes(a);
                        var f = this._map.getZoom();
                        f > this.options.maxZoom || f < this.options.minZoom || this.createLayers(a)
                    },
                    _buildQuery: function(a) {
                        var b = this._service.query().intersects(a).where(this.options.where).fields(this.options.fields).precision(this.options.precision);
                        return this.options.simplifyFactor && b.simplify(this._map, this.options.simplifyFactor), "server" === this.options.timeFilterMode && this.options.from && this.options.to && b.between(this.options.from, this.options.to), b
                    },
                    setWhere: function(c, d, e) {
                        this.options.where = c && c.length ? c : "1=1";
                        for (var f = [], g = [], h = 0, i = null, j = a.Util.bind(function(c, j) {
                                if (h--, c && (i = c), j)
                                    for (var k = j.features.length - 1; k >= 0; k--) g.push(j.features[k].id);
                                h <= 0 && (this._currentSnapshot = g, b.Util.requestAnimationFrame(a.Util.bind(function() {
                                    this.removeLayers(f), this.addLayers(g), d && d.call(e, i)
                                }, this)))
                            }, this), k = this._currentSnapshot.length - 1; k >= 0; k--) f.push(this._currentSnapshot[k]);
                        for (var l in this._activeCells) {
                            h++;
                            var m = this._keyToCellCoords(l),
                                n = this._cellCoordsToBounds(m);
                            this._requestFeatures(n, l, j)
                        }
                        return this
                    },
                    getWhere: function() {
                        return this.options.where
                    },
                    getTimeRange: function() {
                        return [this.options.from, this.options.to]
                    },
                    setTimeRange: function(b, c, d, e) {
                        var f = this.options.from,
                            g = this.options.to,
                            h = 0,
                            i = null,
                            j = a.Util.bind(function(a) {
                                a && (i = a), this._filterExistingFeatures(f, g, b, c), h--, d && h <= 0 && d.call(e, i)
                            }, this);
                        if (this.options.from = b, this.options.to = c, this._filterExistingFeatures(f, g, b, c), "server" === this.options.timeFilterMode)
                            for (var k in this._activeCells) {
                                h++;
                                var l = this._keyToCellCoords(k),
                                    m = this._cellCoordsToBounds(l);
                                this._requestFeatures(m, k, j)
                            }
                    },
                    refresh: function() {
                        for (var a in this._activeCells) {
                            var b = this._keyToCellCoords(a),
                                c = this._cellCoordsToBounds(b);
                            this._requestFeatures(c, a)
                        }
                        this.redraw && this.once("load", function() {
                            this.eachFeature(function(a) {
                                this._redraw(a.feature.id)
                            }, this)
                        }, this)
                    },
                    _filterExistingFeatures: function(c, d, e, f) {
                        var g = c && d ? this._getFeaturesInTimeRange(c, d) : this._currentSnapshot,
                            h = this._getFeaturesInTimeRange(e, f);
                        if (h.indexOf)
                            for (var i = 0; i < h.length; i++) {
                                var j = g.indexOf(h[i]);
                                j >= 0 && g.splice(j, 1)
                            }
                        b.Util.requestAnimationFrame(a.Util.bind(function() {
                            this.removeLayers(g), this.addLayers(h)
                        }, this))
                    },
                    _getFeaturesInTimeRange: function(a, b) {
                        var d, c = [];
                        if (this.options.timeField.start && this.options.timeField.end) {
                            var e = this._startTimeIndex.between(a, b),
                                f = this._endTimeIndex.between(a, b);
                            d = e.concat(f)
                        } else d = this._timeIndex.between(a, b);
                        for (var g = d.length - 1; g >= 0; g--) c.push(d[g].id);
                        return c
                    },
                    _buildTimeIndexes: function(a) {
                        var b, c;
                        if (this.options.timeField.start && this.options.timeField.end) {
                            var d = [],
                                e = [];
                            for (b = a.length - 1; b >= 0; b--) c = a[b], d.push({
                                id: c.id,
                                value: new Date(c.properties[this.options.timeField.start])
                            }), e.push({
                                id: c.id,
                                value: new Date(c.properties[this.options.timeField.end])
                            });
                            this._startTimeIndex.bulkAdd(d), this._endTimeIndex.bulkAdd(e)
                        } else {
                            var f = [];
                            for (b = a.length - 1; b >= 0; b--) c = a[b], f.push({
                                id: c.id,
                                value: new Date(c.properties[this.options.timeField])
                            });
                            this._timeIndex.bulkAdd(f)
                        }
                    },
                    _featureWithinTimeRange: function(a) {
                        if (!this.options.from || !this.options.to) return !0;
                        var b = +this.options.from.valueOf(),
                            c = +this.options.to.valueOf();
                        if ("string" == typeof this.options.timeField) {
                            var d = +a.properties[this.options.timeField];
                            return d >= b && d <= c
                        }
                        if (this.options.timeField.start && this.options.timeField.end) {
                            var e = +a.properties[this.options.timeField.start],
                                f = +a.properties[this.options.timeField.end];
                            return e >= b && e <= c || f >= b && f <= c
                        }
                    },
                    authenticate: function(a) {
                        return this._service.authenticate(a), this
                    },
                    metadata: function(a, b) {
                        return this._service.metadata(a, b), this
                    },
                    query: function() {
                        return this._service.query()
                    },
                    _getMetadata: function(b) {
                        if (this._metadata) {
                            var c;
                            b(c, this._metadata)
                        } else this.metadata(a.Util.bind(function(a, c) {
                            this._metadata = c, b(a, this._metadata)
                        }, this))
                    },
                    addFeature: function(b, c, d) {
                        this._getMetadata(a.Util.bind(function(e, f) {
                            this._service.addFeature(b, a.Util.bind(function(a, e) {
                                a || (b.properties[f.objectIdField] = e.objectId, b.id = e.objectId, this.createLayers([b])), c && c.call(d, a, e)
                            }, this))
                        }, this))
                    },
                    updateFeature: function(a, b, c) {
                        this._service.updateFeature(a, function(d, e) {
                            d || (this.removeLayers([a.id], !0), this.createLayers([a])), b && b.call(c, d, e)
                        }, this)
                    },
                    deleteFeature: function(a, b, c) {
                        this._service.deleteFeature(a, function(a, d) {
                            !a && d.objectId && this.removeLayers([d.objectId], !0), b && b.call(c, a, d)
                        }, this)
                    },
                    deleteFeatures: function(a, b, c) {
                        return this._service.deleteFeatures(a, function(a, d) {
                            if (!a && d.length > 0)
                                for (var e = 0; e < d.length; e++) this.removeLayers([d[e].objectId], !0);
                            b && b.call(c, a, d)
                        }, this)
                    }
                }), c.prototype._query = function(a) {
                    for (var d, e, f, b = 0, c = this.values.length - 1; b <= c;)
                        if (f = d = (b + c) / 2 | 0, e = this.values[Math.round(d)], +e.value < +a) b = d + 1;
                        else {
                            if (!(+e.value > +a)) return d;
                            c = d - 1
                        }
                    return ~c
                }, c.prototype.sort = function() {
                    this.values.sort(function(a, b) {
                        return +b.value - +a.value
                    }).reverse(), this.dirty = !1
                }, c.prototype.between = function(a, b) {
                    this.dirty && this.sort();
                    var c = this._query(a),
                        d = this._query(b);
                    return 0 === c && 0 === d ? [] : (c = Math.abs(c), d = d < 0 ? Math.abs(d) : d + 1, this.values.slice(c, d))
                }, c.prototype.bulkAdd = function(a) {
                    this.dirty = !0, this.values = this.values.concat(a)
                }
            }(b), b.Layers.FeatureLayer = b.Layers.FeatureManager.extend({
                statics: {
                    EVENTS: "click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"
                },
                options: {
                    cacheLayers: !0
                },
                initialize: function(c) {
                    b.Layers.FeatureManager.prototype.initialize.call(this, c), c = a.setOptions(this, c), this._layers = {}, this._leafletIds = {}, this._key = "c" + (1e9 * Math.random()).toString(36).replace(".", "_")
                },
                onAdd: function(a) {
                    return a.on("zoomstart zoomend", function(a) {
                        this._zooming = "zoomstart" === a.type
                    }, this), b.Layers.FeatureManager.prototype.onAdd.call(this, a)
                },
                onRemove: function(a) {
                    for (var c in this._layers) a.removeLayer(this._layers[c]);
                    return b.Layers.FeatureManager.prototype.onRemove.call(this, a)
                },
                createNewLayer: function(b) {
                    return a.GeoJSON.geometryToLayer(b, this.options.pointToLayer, a.GeoJSON.coordsToLatLng, this.options)
                },
                _updateLayer: function(b, c) {
                    var d = [],
                        e = this.options.coordsToLatLng || a.GeoJSON.coordsToLatLng;
                    switch (c.properties && (b.feature.properties = c.properties), c.geometry.type) {
                        case "Point":
                            d = a.GeoJSON.coordsToLatLng(c.geometry.coordinates), b.setLatLng(d);
                            break;
                        case "LineString":
                            d = a.GeoJSON.coordsToLatLngs(c.geometry.coordinates, 0, e), b.setLatLngs(d);
                            break;
                        case "MultiLineString":
                            d = a.GeoJSON.coordsToLatLngs(c.geometry.coordinates, 1, e), b.setLatLngs(d);
                            break;
                        case "Polygon":
                            d = a.GeoJSON.coordsToLatLngs(c.geometry.coordinates, 1, e), b.setLatLngs(d);
                            break;
                        case "MultiPolygon":
                            d = a.GeoJSON.coordsToLatLngs(c.geometry.coordinates, 2, e), b.setLatLngs(d)
                    }
                },
                createLayers: function(a) {
                    for (var c = a.length - 1; c >= 0; c--) {
                        var f, d = a[c],
                            e = this._layers[d.id];
                        e && !this._map.hasLayer(e) && this._map.addLayer(e), e && (e.setLatLngs || e.setLatLng) && this._updateLayer(e, d), e || (f = this.createNewLayer(d), f.feature = d, this.options.style ? f._originalStyle = this.options.style : f.setStyle && (f._originalStyle = f.options), f._leaflet_id = this._key + "_" + d.id, this._leafletIds[f._leaflet_id] = d.id, f.on(b.Layers.FeatureLayer.EVENTS, this._propagateEvent, this), this._popup && f.bindPopup && f.bindPopup(this._popup(f.feature, f), this._popupOptions), this.options.onEachFeature && this.options.onEachFeature(f.feature, f), this._layers[f.feature.id] = f, this.resetStyle(f.feature.id), this.fire("createfeature", {
                            feature: f.feature
                        }), (!this.options.timeField || this.options.timeField && this._featureWithinTimeRange(d)) && this._map.addLayer(f))
                    }
                },
                addLayers: function(a) {
                    for (var b = a.length - 1; b >= 0; b--) {
                        var c = this._layers[a[b]];
                        c && (this.fire("addfeature", {
                            feature: c.feature
                        }), this._map.addLayer(c))
                    }
                },
                removeLayers: function(a, b) {
                    for (var c = a.length - 1; c >= 0; c--) {
                        var d = a[c],
                            e = this._layers[d];
                        e && (this.fire("removefeature", {
                            feature: e.feature,
                            permanent: b
                        }), this._map.removeLayer(e)), e && b && delete this._layers[d]
                    }
                },
                cellEnter: function(c, d) {
                    this._zooming || b.Util.requestAnimationFrame(a.Util.bind(function() {
                        var a = this._cacheKey(d),
                            b = this._cellCoordsToKey(d),
                            c = this._cache[a];
                        this._activeCells[b] && c && this.addLayers(c)
                    }, this))
                },
                cellLeave: function(c, d) {
                    this._zooming || b.Util.requestAnimationFrame(a.Util.bind(function() {
                        var a = this._cacheKey(d),
                            b = this._cellCoordsToKey(d),
                            c = this._cache[a],
                            e = this._map.getBounds();
                        if (!this._activeCells[b] && c) {
                            for (var f = !0, g = 0; g < c.length; g++) {
                                var h = this._layers[c[g]];
                                h && h.getBounds && e.intersects(h.getBounds()) && (f = !1)
                            }
                            f && this.removeLayers(c, !this.options.cacheLayers), !this.options.cacheLayers && f && (delete this._cache[a], delete this._cells[b], delete this._activeCells[b])
                        }
                    }, this))
                },
                resetStyle: function(a) {
                    var b = this._layers[a];
                    return b && this.setFeatureStyle(b.feature.id, b._originalStyle), this
                },
                setStyle: function(a) {
                    return this.options.style = a, this.eachFeature(function(b) {
                        this.setFeatureStyle(b.feature.id, a)
                    }, this), this
                },
                setFeatureStyle: function(b, c) {
                    var d = this._layers[b];
                    return "function" == typeof c && (c = c(d.feature)), !c && !d.defaultOptions && (c = a.Path.prototype.options, c.fill = !0), d && d.setStyle && d.setStyle(c), this
                },
                bindPopup: function(a, b) {
                    this._popup = a, this._popupOptions = b;
                    for (var c in this._layers) {
                        var d = this._layers[c],
                            e = this._popup(d.feature, d);
                        d.bindPopup(e, b)
                    }
                    return this
                },
                unbindPopup: function() {
                    this._popup = !1;
                    for (var a in this._layers) {
                        var b = this._layers[a];
                        if (b.unbindPopup) b.unbindPopup();
                        else if (b.getLayers) {
                            var c = b.getLayers();
                            for (var d in c) {
                                var e = c[d];
                                e.unbindPopup()
                            }
                        }
                    }
                    return this
                },
                eachFeature: function(a, b) {
                    for (var c in this._layers) a.call(b, this._layers[c]);
                    return this
                },
                getFeature: function(a) {
                    return this._layers[a]
                },
                bringToBack: function() {
                    this.eachFeature(function(a) {
                        a.bringToBack && a.bringToBack()
                    })
                },
                bringToFront: function() {
                    this.eachFeature(function(a) {
                        a.bringToFront && a.bringToFront()
                    })
                },
                redraw: function(a) {
                    return a && this._redraw(a), this
                },
                _redraw: function(b) {
                    var c = this._layers[b],
                        d = c.feature;
                    if (c && c.setIcon && this.options.pointToLayer && this.options.pointToLayer) {
                        var e = this.options.pointToLayer(d, a.latLng(d.geometry.coordinates[1], d.geometry.coordinates[0])),
                            f = e.options.icon;
                        c.setIcon(f)
                    }
                    if (c && c.setStyle && this.options.pointToLayer) {
                        var g = this.options.pointToLayer(d, a.latLng(d.geometry.coordinates[1], d.geometry.coordinates[0])),
                            h = g.options;
                        this.setFeatureStyle(d.id, h)
                    }
                    c && c.setStyle && this.options.style && this.resetStyle(d.id)
                },
                _propagateEvent: function(a) {
                    a.layer = this._layers[this._leafletIds[a.target._leaflet_id]], a.target = this, this.fire(a.type, a)
                }
            }), b.FeatureLayer = b.Layers.FeatureLayer, b.Layers.featureLayer = function(a) {
                return new b.Layers.FeatureLayer(a)
            }, b.featureLayer = function(a) {
                return new b.Layers.FeatureLayer(a)
            }, b.Controls.Logo = a.Control.extend({
                options: {
                    position: "bottomright",
                    marginTop: 0,
                    marginLeft: 0,
                    marginBottom: 0,
                    marginRight: 0
                },
                onAdd: function() {
                    var b = a.DomUtil.create("div", "esri-leaflet-logo");
                    return b.style.marginTop = this.options.marginTop, b.style.marginLeft = this.options.marginLeft, b.style.marginBottom = this.options.marginBottom, b.style.marginRight = this.options.marginRight, b.innerHTML = this._adjustLogo(this._map._size), this._map.on("resize", function(a) {
                        b.innerHTML = this._adjustLogo(a.newSize)
                    }, this), b
                },
                _adjustLogo: function(a) {
                    return a.x <= 600 || a.y <= 600 ? '<a href="https://developers.arcgis.com" style="border: none;"><img src="https://js.arcgis.com/3.13/esri/images/map/logo-sm.png" alt="Powered by Esri" style="border: none;"></a>' : '<a href="https://developers.arcgis.com" style="border: none;"><img src="https://js.arcgis.com/3.13/esri/images/map/logo-med.png" alt="Powered by Esri" style="border: none;"></a>';
                }
            }), b.Controls.logo = function(b) {
                return new a.esri.Controls.Logo(b)
            }, b
    }),
    function(a, b, c) {
        L.drawVersion = "0.2.4-dev", L.drawLocal = {
            draw: {
                toolbar: {
                    actions: {
                        title: "Cancel drawing",
                        text: "Cancel"
                    },
                    undo: {
                        title: "Delete last point drawn",
                        text: "Delete last point"
                    },
                    buttons: {
                        polyline: "Draw a polyline",
                        polygon: "Draw a polygon",
                        rectangle: "Draw a rectangle",
                        circle: "Draw a circle",
                        marker: "Draw a marker"
                    }
                },
                handlers: {
                    circle: {
                        tooltip: {
                            start: "Click and drag to draw circle."
                        },
                        radius: "Radius"
                    },
                    marker: {
                        tooltip: {
                            start: "Click map to place marker."
                        }
                    },
                    polygon: {
                        tooltip: {
                            start: "Click to start drawing shape.",
                            cont: "Click to continue drawing shape.",
                            end: "Click first point to close this shape."
                        }
                    },
                    polyline: {
                        error: "<strong>Error:</strong> shape edges cannot cross!",
                        tooltip: {
                            start: "Click to start drawing line.",
                            cont: "Click to continue drawing line.",
                            end: "Click last point to finish line."
                        }
                    },
                    rectangle: {
                        tooltip: {
                            start: "Click and drag to draw rectangle."
                        }
                    },
                    simpleshape: {
                        tooltip: {
                            end: "Release mouse to finish drawing."
                        }
                    }
                }
            },
            edit: {
                toolbar: {
                    actions: {
                        save: {
                            title: "Save changes.",
                            text: "Save"
                        },
                        cancel: {
                            title: "Cancel editing, discards all changes.",
                            text: "Cancel"
                        }
                    },
                    buttons: {
                        edit: "Edit layers.",
                        editDisabled: "No layers to edit.",
                        remove: "Delete layers.",
                        removeDisabled: "No layers to delete."
                    }
                },
                handlers: {
                    edit: {
                        tooltip: {
                            text: "Drag handles, or marker to edit feature.",
                            subtext: "Click cancel to undo changes."
                        }
                    },
                    remove: {
                        tooltip: {
                            text: "Click on a feature to remove"
                        }
                    }
                }
            }
        }, L.Draw = {}, L.Draw.Feature = L.Handler.extend({
            includes: L.Mixin.Events,
            initialize: function(a, b) {
                this._map = a, this._container = a._container, this._overlayPane = a._panes.overlayPane, this._popupPane = a._panes.popupPane, b && b.shapeOptions && (b.shapeOptions = L.Util.extend({}, this.options.shapeOptions, b.shapeOptions)), L.setOptions(this, b)
            },
            enable: function() {
                this._enabled || (L.Handler.prototype.enable.call(this), this.fire("enabled", {
                    handler: this.type
                }), this._map.fire("draw:drawstart", {
                    layerType: this.type
                }))
            },
            disable: function() {
                this._enabled && (L.Handler.prototype.disable.call(this), this._map.fire("draw:drawstop", {
                    layerType: this.type
                }), this.fire("disabled", {
                    handler: this.type
                }))
            },
            addHooks: function() {
                var a = this._map;
                a && (L.DomUtil.disableTextSelection(), a.getContainer().focus(), this._tooltip = new L.Tooltip(this._map), L.DomEvent.on(this._container, "keyup", this._cancelDrawing, this))
            },
            removeHooks: function() {
                this._map && (L.DomUtil.enableTextSelection(), this._tooltip.dispose(), this._tooltip = null, L.DomEvent.off(this._container, "keyup", this._cancelDrawing, this))
            },
            setOptions: function(a) {
                L.setOptions(this, a)
            },
            _fireCreatedEvent: function(a) {
                this._map.fire("draw:created", {
                    layer: a,
                    layerType: this.type
                })
            },
            _cancelDrawing: function(a) {
                27 === a.keyCode && this.disable()
            }
        }), L.Draw.Polyline = L.Draw.Feature.extend({
            statics: {
                TYPE: "polyline"
            },
            Poly: L.Polyline,
            options: {
                allowIntersection: !0,
                repeatMode: !1,
                drawError: {
                    color: "#b00b00",
                    timeout: 2500
                },
                icon: new L.DivIcon({
                    iconSize: new L.Point(8, 8),
                    className: "leaflet-div-icon leaflet-editing-icon"
                }),
                guidelineDistance: 20,
                maxGuideLineLength: 4e3,
                shapeOptions: {
                    stroke: !0,
                    color: "#f06eaa",
                    weight: 4,
                    opacity: .5,
                    fill: !1,
                    clickable: !0
                },
                metric: !0,
                showLength: !0,
                zIndexOffset: 2e3
            },
            initialize: function(a, b) {
                this.options.drawError.message = L.drawLocal.draw.handlers.polyline.error, b && b.drawError && (b.drawError = L.Util.extend({}, this.options.drawError, b.drawError)), this.type = L.Draw.Polyline.TYPE, L.Draw.Feature.prototype.initialize.call(this, a, b)
            },
            addHooks: function() {
                L.Draw.Feature.prototype.addHooks.call(this), this._map && (this._markers = [], this._markerGroup = new L.LayerGroup, this._map.addLayer(this._markerGroup), this._poly = new L.Polyline([], this.options.shapeOptions), this._tooltip.updateContent(this._getTooltipText()), this._mouseMarker || (this._mouseMarker = L.marker(this._map.getCenter(), {
                    icon: L.divIcon({
                        className: "leaflet-mouse-marker",
                        iconAnchor: [20, 20],
                        iconSize: [40, 40]
                    }),
                    opacity: 0,
                    zIndexOffset: this.options.zIndexOffset
                })), this._mouseMarker.on("mousedown", this._onMouseDown, this).addTo(this._map), this._map.on("mousemove", this._onMouseMove, this).on("mouseup", this._onMouseUp, this).on("zoomend", this._onZoomEnd, this))
            },
            removeHooks: function() {
                L.Draw.Feature.prototype.removeHooks.call(this), this._clearHideErrorTimeout(), this._cleanUpShape(), this._map.removeLayer(this._markerGroup), delete this._markerGroup, delete this._markers, this._map.removeLayer(this._poly), delete this._poly, this._mouseMarker.off("mousedown", this._onMouseDown, this).off("mouseup", this._onMouseUp, this), this._map.removeLayer(this._mouseMarker), delete this._mouseMarker, this._clearGuides(), this._map.off("mousemove", this._onMouseMove, this).off("zoomend", this._onZoomEnd, this)
            },
            deleteLastVertex: function() {
                if (!(this._markers.length <= 1)) {
                    var a = this._markers.pop(),
                        b = this._poly,
                        c = this._poly.spliceLatLngs(b.getLatLngs().length - 1, 1)[0];
                    this._markerGroup.removeLayer(a), b.getLatLngs().length < 2 && this._map.removeLayer(b), this._vertexChanged(c, !1)
                }
            },
            addVertex: function(a) {
                var b = this._markers.length;
                return b > 0 && !this.options.allowIntersection && this._poly.newLatLngIntersects(a) ? void this._showErrorTooltip() : (this._errorShown && this._hideErrorTooltip(), this._markers.push(this._createMarker(a)), this._poly.addLatLng(a), 2 === this._poly.getLatLngs().length && this._map.addLayer(this._poly), this._vertexChanged(a, !0), void 0)
            },
            _finishShape: function() {
                var a = this._poly.newLatLngIntersects(this._poly.getLatLngs()[0], !0);
                return !this.options.allowIntersection && a || !this._shapeIsValid() ? void this._showErrorTooltip() : (this._fireCreatedEvent(), this.disable(), this.options.repeatMode && this.enable(), void 0)
            },
            _shapeIsValid: function() {
                return !0
            },
            _onZoomEnd: function() {
                this._updateGuide()
            },
            _onMouseMove: function(a) {
                var b = a.layerPoint,
                    c = a.latlng;
                this._currentLatLng = c, this._updateTooltip(c), this._updateGuide(b), this._mouseMarker.setLatLng(c), L.DomEvent.preventDefault(a.originalEvent)
            },
            _vertexChanged: function(a, b) {
                this._updateFinishHandler(), this._updateRunningMeasure(a, b), this._clearGuides(), this._updateTooltip()
            },
            _onMouseDown: function(a) {
                var b = a.originalEvent;
                this._mouseDownOrigin = L.point(b.clientX, b.clientY)
            },
            _onMouseUp: function(b) {
                if (this._mouseDownOrigin) {
                    var c = L.point(b.originalEvent.clientX, b.originalEvent.clientY).distanceTo(this._mouseDownOrigin);
                    Math.abs(c) < 9 * (a.devicePixelRatio || 1) && this.addVertex(b.latlng)
                }
                this._mouseDownOrigin = null
            },
            _updateFinishHandler: function() {
                var a = this._markers.length;
                a > 1 && this._markers[a - 1].on("click", this._finishShape, this), a > 2 && this._markers[a - 2].off("click", this._finishShape, this)
            },
            _createMarker: function(a) {
                var b = new L.Marker(a, {
                    icon: this.options.icon,
                    zIndexOffset: 2 * this.options.zIndexOffset
                });
                return this._markerGroup.addLayer(b), b
            },
            _updateGuide: function(a) {
                var b = this._markers.length;
                b > 0 && (a = a || this._map.latLngToLayerPoint(this._currentLatLng), this._clearGuides(), this._drawGuide(this._map.latLngToLayerPoint(this._markers[b - 1].getLatLng()), a))
            },
            _updateTooltip: function(a) {
                var b = this._getTooltipText();
                a && this._tooltip.updatePosition(a), this._errorShown || this._tooltip.updateContent(b)
            },
            _drawGuide: function(a, b) {
                var g, h, i, c = Math.floor(Math.sqrt(Math.pow(b.x - a.x, 2) + Math.pow(b.y - a.y, 2))),
                    d = this.options.guidelineDistance,
                    e = this.options.maxGuideLineLength,
                    f = c > e ? c - e : d;
                for (this._guidesContainer || (this._guidesContainer = L.DomUtil.create("div", "leaflet-draw-guides", this._overlayPane)); f < c; f += this.options.guidelineDistance) g = f / c, h = {
                    x: Math.floor(a.x * (1 - g) + g * b.x),
                    y: Math.floor(a.y * (1 - g) + g * b.y)
                }, i = L.DomUtil.create("div", "leaflet-draw-guide-dash", this._guidesContainer), i.style.backgroundColor = this._errorShown ? this.options.drawError.color : this.options.shapeOptions.color, L.DomUtil.setPosition(i, h)
            },
            _updateGuideColor: function(a) {
                if (this._guidesContainer)
                    for (var b = 0, c = this._guidesContainer.childNodes.length; b < c; b++) this._guidesContainer.childNodes[b].style.backgroundColor = a
            },
            _clearGuides: function() {
                if (this._guidesContainer)
                    for (; this._guidesContainer.firstChild;) this._guidesContainer.removeChild(this._guidesContainer.firstChild)
            },
            _getTooltipText: function() {
                var b, c, a = this.options.showLength;
                return 0 === this._markers.length ? b = {
                    text: L.drawLocal.draw.handlers.polyline.tooltip.start
                } : (c = a ? this._getMeasurementString() : "", b = 1 === this._markers.length ? {
                    text: L.drawLocal.draw.handlers.polyline.tooltip.cont,
                    subtext: c
                } : {
                    text: L.drawLocal.draw.handlers.polyline.tooltip.end,
                    subtext: c
                }), b
            },
            _updateRunningMeasure: function(a, b) {
                var d, e, c = this._markers.length;
                1 === this._markers.length ? this._measurementRunningTotal = 0 : (d = c - (b ? 2 : 1), e = a.distanceTo(this._markers[d].getLatLng()), this._measurementRunningTotal += e * (b ? 1 : -1))
            },
            _getMeasurementString: function() {
                var c, a = this._currentLatLng,
                    b = this._markers[this._markers.length - 1].getLatLng();
                return c = this._measurementRunningTotal + a.distanceTo(b), L.GeometryUtil.readableDistance(c, this.options.metric)
            },
            _showErrorTooltip: function() {
                this._errorShown = !0, this._tooltip.showAsError().updateContent({
                    text: this.options.drawError.message
                }), this._updateGuideColor(this.options.drawError.color), this._poly.setStyle({
                    color: this.options.drawError.color
                }), this._clearHideErrorTimeout(), this._hideErrorTimeout = setTimeout(L.Util.bind(this._hideErrorTooltip, this), this.options.drawError.timeout)
            },
            _hideErrorTooltip: function() {
                this._errorShown = !1, this._clearHideErrorTimeout(), this._tooltip.removeError().updateContent(this._getTooltipText()), this._updateGuideColor(this.options.shapeOptions.color), this._poly.setStyle({
                    color: this.options.shapeOptions.color
                })
            },
            _clearHideErrorTimeout: function() {
                this._hideErrorTimeout && (clearTimeout(this._hideErrorTimeout), this._hideErrorTimeout = null)
            },
            _cleanUpShape: function() {
                this._markers.length > 1 && this._markers[this._markers.length - 1].off("click", this._finishShape, this)
            },
            _fireCreatedEvent: function() {
                var a = new this.Poly(this._poly.getLatLngs(), this.options.shapeOptions);
                L.Draw.Feature.prototype._fireCreatedEvent.call(this, a)
            }
        }), L.Draw.Polygon = L.Draw.Polyline.extend({
            statics: {
                TYPE: "polygon"
            },
            Poly: L.Polygon,
            options: {
                showArea: !1,
                shapeOptions: {
                    stroke: !0,
                    color: "#f06eaa",
                    weight: 4,
                    opacity: .5,
                    fill: !0,
                    fillColor: null,
                    fillOpacity: .2,
                    clickable: !0
                }
            },
            initialize: function(a, b) {
                L.Draw.Polyline.prototype.initialize.call(this, a, b), this.type = L.Draw.Polygon.TYPE
            },
            _updateFinishHandler: function() {
                var a = this._markers.length;
                1 === a && this._markers[0].on("click", this._finishShape, this), a > 2 && (this._markers[a - 1].on("dblclick", this._finishShape, this), a > 3 && this._markers[a - 2].off("dblclick", this._finishShape, this))
            },
            _getTooltipText: function() {
                var a, b;
                return 0 === this._markers.length ? a = L.drawLocal.draw.handlers.polygon.tooltip.start : this._markers.length < 3 ? a = L.drawLocal.draw.handlers.polygon.tooltip.cont : (a = L.drawLocal.draw.handlers.polygon.tooltip.end, b = this._getMeasurementString()), {
                    text: a,
                    subtext: b
                }
            },
            _getMeasurementString: function() {
                var a = this._area;
                return a ? L.GeometryUtil.readableArea(a, this.options.metric) : null
            },
            _shapeIsValid: function() {
                return this._markers.length >= 3
            },
            _vertexChanged: function(a, b) {
                var c;
                !this.options.allowIntersection && this.options.showArea && (c = this._poly.getLatLngs(), this._area = L.GeometryUtil.geodesicArea(c)), L.Draw.Polyline.prototype._vertexChanged.call(this, a, b)
            },
            _cleanUpShape: function() {
                var a = this._markers.length;
                a > 0 && (this._markers[0].off("click", this._finishShape, this), a > 2 && this._markers[a - 1].off("dblclick", this._finishShape, this))
            }
        }), L.SimpleShape = {}, L.Draw.SimpleShape = L.Draw.Feature.extend({
            options: {
                repeatMode: !1
            },
            initialize: function(a, b) {
                this._endLabelText = L.drawLocal.draw.handlers.simpleshape.tooltip.end, L.Draw.Feature.prototype.initialize.call(this, a, b)
            },
            addHooks: function() {
                L.Draw.Feature.prototype.addHooks.call(this), this._map && (this._mapDraggable = this._map.dragging.enabled(), this._mapDraggable && this._map.dragging.disable(), this._container.style.cursor = "crosshair", this._tooltip.updateContent({
                    text: this._initialLabelText
                }), this._map.on("mousedown", this._onMouseDown, this).on("mousemove", this._onMouseMove, this))
            },
            removeHooks: function() {
                L.Draw.Feature.prototype.removeHooks.call(this), this._map && (this._mapDraggable && this._map.dragging.enable(), this._container.style.cursor = "", this._map.off("mousedown", this._onMouseDown, this).off("mousemove", this._onMouseMove, this), L.DomEvent.off(b, "mouseup", this._onMouseUp, this), this._shape && (this._map.removeLayer(this._shape), delete this._shape)), this._isDrawing = !1
            },
            _getTooltipText: function() {
                return {
                    text: this._endLabelText
                }
            },
            _onMouseDown: function(a) {
                this._isDrawing = !0, this._startLatLng = a.latlng, L.DomEvent.on(b, "mouseup", this._onMouseUp, this).preventDefault(a.originalEvent)
            },
            _onMouseMove: function(a) {
                var b = a.latlng;
                this._tooltip.updatePosition(b), this._isDrawing && (this._tooltip.updateContent(this._getTooltipText()), this._drawShape(b))
            },
            _onMouseUp: function() {
                this._shape && this._fireCreatedEvent(), this.disable(), this.options.repeatMode && this.enable()
            }
        }), L.Draw.Rectangle = L.Draw.SimpleShape.extend({
            statics: {
                TYPE: "rectangle"
            },
            options: {
                shapeOptions: {
                    stroke: !0,
                    color: "#f06eaa",
                    weight: 4,
                    opacity: .5,
                    fill: !0,
                    fillColor: null,
                    fillOpacity: .2,
                    clickable: !0
                },
                showAres: !0,
                metric: !0
            },
            initialize: function(a, b) {
                this.type = L.Draw.Rectangle.TYPE, this._initialLabelText = L.drawLocal.draw.handlers.rectangle.tooltip.start, L.Draw.SimpleShape.prototype.initialize.call(this, a, b)
            },
            _drawShape: function(a) {
                this._shape ? this._shape.setBounds(new L.LatLngBounds(this._startLatLng, a)) : (this._shape = new L.Rectangle(new L.LatLngBounds(this._startLatLng, a), this.options.shapeOptions), this._map.addLayer(this._shape))
            },
            _fireCreatedEvent: function() {
                var a = new L.Rectangle(this._shape.getBounds(), this.options.shapeOptions);
                L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this, a)
            },
            _getTooltipText: function() {
                var c, d, e, a = L.Draw.SimpleShape.prototype._getTooltipText.call(this),
                    b = this._shape;
                return b && (c = this._shape.getLatLngs(), this.options.showArea && (d = L.GeometryUtil.geodesicArea(c), e = L.GeometryUtil.readableArea(d, this.options.metric))), {
                    text: a.text,
                    subtext: e
                }
            }
        }), L.Draw.Circle = L.Draw.SimpleShape.extend({
            statics: {
                TYPE: "circle"
            },
            options: {
                shapeOptions: {
                    stroke: !0,
                    color: "#f06eaa",
                    weight: 4,
                    opacity: .5,
                    fill: !0,
                    fillColor: null,
                    fillOpacity: .2,
                    clickable: !0
                },
                showRadius: !0,
                metric: !0
            },
            initialize: function(a, b) {
                this.type = L.Draw.Circle.TYPE, this._initialLabelText = L.drawLocal.draw.handlers.circle.tooltip.start, L.Draw.SimpleShape.prototype.initialize.call(this, a, b)
            },
            _drawShape: function(a) {
                this._shape ? this._shape.setRadius(this._startLatLng.distanceTo(a)) : (this._shape = new L.Circle(this._startLatLng, this._startLatLng.distanceTo(a), this.options.shapeOptions), this._map.addLayer(this._shape))
            },
            _fireCreatedEvent: function() {
                var a = new L.Circle(this._startLatLng, this._shape.getRadius(), this.options.shapeOptions);
                L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this, a)
            },
            _onMouseMove: function(a) {
                var e, b = a.latlng,
                    c = this.options.showRadius,
                    d = this.options.metric;
                this._tooltip.updatePosition(b), this._isDrawing && (this._drawShape(b), e = this._shape.getRadius().toFixed(1), this._tooltip.updateContent({
                    text: this._endLabelText,
                    subtext: c ? L.drawLocal.draw.handlers.circle.radius + ": " + L.GeometryUtil.readableDistance(e, d) : ""
                }))
            }
        }), L.Draw.Marker = L.Draw.Feature.extend({
            statics: {
                TYPE: "marker"
            },
            options: {
                icon: new L.Icon.Default,
                repeatMode: !1,
                zIndexOffset: 2e3
            },
            initialize: function(a, b) {
                this.type = L.Draw.Marker.TYPE, L.Draw.Feature.prototype.initialize.call(this, a, b)
            },
            addHooks: function() {
                L.Draw.Feature.prototype.addHooks.call(this), this._map && (this._tooltip.updateContent({
                    text: L.drawLocal.draw.handlers.marker.tooltip.start
                }), this._mouseMarker || (this._mouseMarker = L.marker(this._map.getCenter(), {
                    icon: L.divIcon({
                        className: "leaflet-mouse-marker",
                        iconAnchor: [20, 20],
                        iconSize: [40, 40]
                    }),
                    opacity: 0,
                    zIndexOffset: this.options.zIndexOffset
                })), this._mouseMarker.on("click", this._onClick, this).addTo(this._map), this._map.on("mousemove", this._onMouseMove, this))
            },
            removeHooks: function() {
                L.Draw.Feature.prototype.removeHooks.call(this), this._map && (this._marker && (this._marker.off("click", this._onClick, this), this._map.off("click", this._onClick, this).removeLayer(this._marker), delete this._marker), this._mouseMarker.off("click", this._onClick, this), this._map.removeLayer(this._mouseMarker), delete this._mouseMarker, this._map.off("mousemove", this._onMouseMove, this))
            },
            _onMouseMove: function(a) {
                var b = a.latlng;
                this._tooltip.updatePosition(b), this._mouseMarker.setLatLng(b), this._marker ? (b = this._mouseMarker.getLatLng(), this._marker.setLatLng(b)) : (this._marker = new L.Marker(b, {
                    icon: this.options.icon,
                    zIndexOffset: this.options.zIndexOffset
                }), this._marker.on("click", this._onClick, this), this._map.on("click", this._onClick, this).addLayer(this._marker))
            },
            _onClick: function() {
                this._fireCreatedEvent(), this.disable(), this.options.repeatMode && this.enable()
            },
            _fireCreatedEvent: function() {
                var a = new L.Marker(this._marker.getLatLng(), {
                    icon: this.options.icon
                });
                L.Draw.Feature.prototype._fireCreatedEvent.call(this, a)
            }
        }), L.Edit = L.Edit || {}, L.Edit.Marker = L.Handler.extend({
            initialize: function(a, b) {
                this._marker = a, L.setOptions(this, b)
            },
            addHooks: function() {
                var a = this._marker;
                a.dragging.enable(), a.on("dragend", this._onDragEnd, a), this._toggleMarkerHighlight()
            },
            removeHooks: function() {
                var a = this._marker;
                a.dragging.disable(), a.off("dragend", this._onDragEnd, a), this._toggleMarkerHighlight()
            },
            _onDragEnd: function(a) {
                var b = a.target;
                b.edited = !0
            },
            _toggleMarkerHighlight: function() {
                if (this._icon) {
                    var a = this._icon;
                    a.style.display = "none", L.DomUtil.hasClass(a, "leaflet-edit-marker-selected") ? (L.DomUtil.removeClass(a, "leaflet-edit-marker-selected"), this._offsetMarker(a, -4)) : (L.DomUtil.addClass(a, "leaflet-edit-marker-selected"), this._offsetMarker(a, 4)), a.style.display = ""
                }
            },
            _offsetMarker: function(a, b) {
                var c = parseInt(a.style.marginTop, 10) - b,
                    d = parseInt(a.style.marginLeft, 10) - b;
                a.style.marginTop = c + "px", a.style.marginLeft = d + "px"
            }
        }), L.Marker.addInitHook(function() {
            L.Edit.Marker && (this.editing = new L.Edit.Marker(this), this.options.editable && this.editing.enable())
        }), L.Edit = L.Edit || {}, L.Edit.Poly = L.Handler.extend({
            options: {
                icon: new L.DivIcon({
                    iconSize: new L.Point(8, 8),
                    className: "leaflet-div-icon leaflet-editing-icon"
                })
            },
            initialize: function(a, b) {
                this._poly = a, L.setOptions(this, b)
            },
            addHooks: function() {
                var a = this._poly;
                a instanceof L.Polygon || (a.options.editing.fill = !1), a.setStyle(a.options.editing), this._poly._map && (this._markerGroup || this._initMarkers(), this._poly._map.addLayer(this._markerGroup))
            },
            removeHooks: function() {
                var a = this._poly;
                a.setStyle(a.options.original), a._map && (a._map.removeLayer(this._markerGroup), delete this._markerGroup, delete this._markers)
            },
            updateMarkers: function() {
                this._markerGroup.clearLayers(), this._initMarkers()
            },
            _initMarkers: function() {
                this._markerGroup || (this._markerGroup = new L.LayerGroup), this._markers = [];
                var b, c, d, e, a = this._poly._latlngs;
                for (b = 0, d = a.length; b < d; b++) e = this._createMarker(a[b], b), e.on("click", this._onMarkerClick, this), this._markers.push(e);
                var f, g;
                for (b = 0, c = d - 1; b < d; c = b++)(0 !== b || L.Polygon && this._poly instanceof L.Polygon) && (f = this._markers[c], g = this._markers[b], this._createMiddleMarker(f, g), this._updatePrevNext(f, g))
            },
            _createMarker: function(a, b) {
                var c = new L.Marker(a, {
                    draggable: !0,
                    icon: this.options.icon
                });
                return c._origLatLng = a, c._index = b, c.on("drag", this._onMarkerDrag, this), c.on("dragend", this._fireEdit, this), this._markerGroup.addLayer(c), c
            },
            _removeMarker: function(a) {
                var b = a._index;
                this._markerGroup.removeLayer(a), this._markers.splice(b, 1), this._poly.spliceLatLngs(b, 1), this._updateIndexes(b, -1), a.off("drag", this._onMarkerDrag, this).off("dragend", this._fireEdit, this).off("click", this._onMarkerClick, this)
            },
            _fireEdit: function() {
                this._poly.edited = !0, this._poly.fire("edit")
            },
            _onMarkerDrag: function(a) {
                var b = a.target;
                L.extend(b._origLatLng, b._latlng), b._middleLeft && b._middleLeft.setLatLng(this._getMiddleLatLng(b._prev, b)), b._middleRight && b._middleRight.setLatLng(this._getMiddleLatLng(b, b._next)), this._poly.redraw()
            },
            _onMarkerClick: function(a) {
                var b = L.Polygon && this._poly instanceof L.Polygon ? 4 : 3,
                    c = a.target;
                this._poly._latlngs.length < b || (this._removeMarker(c), this._updatePrevNext(c._prev, c._next), c._middleLeft && this._markerGroup.removeLayer(c._middleLeft), c._middleRight && this._markerGroup.removeLayer(c._middleRight), c._prev && c._next ? this._createMiddleMarker(c._prev, c._next) : c._prev ? c._next || (c._prev._middleRight = null) : c._next._middleLeft = null, this._fireEdit())
            },
            _updateIndexes: function(a, b) {
                this._markerGroup.eachLayer(function(c) {
                    c._index > a && (c._index += b)
                })
            },
            _createMiddleMarker: function(a, b) {
                var e, f, g, c = this._getMiddleLatLng(a, b),
                    d = this._createMarker(c);
                d.setOpacity(.6), a._middleRight = b._middleLeft = d, f = function() {
                    var f = b._index;
                    d._index = f, d.off("click", e, this).on("click", this._onMarkerClick, this), c.lat = d.getLatLng().lat, c.lng = d.getLatLng().lng, this._poly.spliceLatLngs(f, 0, c), this._markers.splice(f, 0, d), d.setOpacity(1), this._updateIndexes(f, 1), b._index++, this._updatePrevNext(a, d), this._updatePrevNext(d, b), this._poly.fire("editstart")
                }, g = function() {
                    d.off("dragstart", f, this), d.off("dragend", g, this), this._createMiddleMarker(a, d), this._createMiddleMarker(d, b)
                }, e = function() {
                    f.call(this), g.call(this), this._fireEdit()
                }, d.on("click", e, this).on("dragstart", f, this).on("dragend", g, this), this._markerGroup.addLayer(d)
            },
            _updatePrevNext: function(a, b) {
                a && (a._next = b), b && (b._prev = a)
            },
            _getMiddleLatLng: function(a, b) {
                var c = this._poly._map,
                    d = c.project(a.getLatLng()),
                    e = c.project(b.getLatLng());
                return c.unproject(d._add(e)._divideBy(2))
            }
        }), L.Polyline.addInitHook(function() {
            this.editing || (L.Edit.Poly && (this.editing = new L.Edit.Poly(this), this.options.editable && this.editing.enable()), this.on("add", function() {
                this.editing && this.editing.enabled() && this.editing.addHooks()
            }), this.on("remove", function() {
                this.editing && this.editing.enabled() && this.editing.removeHooks()
            }))
        }), L.Edit = L.Edit || {}, L.Edit.SimpleShape = L.Handler.extend({
            options: {
                moveIcon: new L.DivIcon({
                    iconSize: new L.Point(8, 8),
                    className: "leaflet-div-icon leaflet-editing-icon leaflet-edit-move"
                }),
                resizeIcon: new L.DivIcon({
                    iconSize: new L.Point(8, 8),
                    className: "leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"
                })
            },
            initialize: function(a, b) {
                this._shape = a, L.Util.setOptions(this, b)
            },
            addHooks: function() {
                var a = this._shape;
                a.setStyle(a.options.editing), a._map && (this._map = a._map, this._markerGroup || this._initMarkers(), this._map.addLayer(this._markerGroup))
            },
            removeHooks: function() {
                var a = this._shape;
                if (a.setStyle(a.options.original), a._map) {
                    this._unbindMarker(this._moveMarker);
                    for (var b = 0, c = this._resizeMarkers.length; b < c; b++) this._unbindMarker(this._resizeMarkers[b]);
                    this._resizeMarkers = null, this._map.removeLayer(this._markerGroup), delete this._markerGroup
                }
                this._map = null
            },
            updateMarkers: function() {
                this._markerGroup.clearLayers(), this._initMarkers()
            },
            _initMarkers: function() {
                this._markerGroup || (this._markerGroup = new L.LayerGroup), this._createMoveMarker(), this._createResizeMarker()
            },
            _createMoveMarker: function() {},
            _createResizeMarker: function() {},
            _createMarker: function(a, b) {
                var c = new L.Marker(a, {
                    draggable: !0,
                    icon: b,
                    zIndexOffset: 10
                });
                return this._bindMarker(c), this._markerGroup.addLayer(c), c
            },
            _bindMarker: function(a) {
                a.on("dragstart", this._onMarkerDragStart, this).on("drag", this._onMarkerDrag, this).on("dragend", this._onMarkerDragEnd, this)
            },
            _unbindMarker: function(a) {
                a.off("dragstart", this._onMarkerDragStart, this).off("drag", this._onMarkerDrag, this).off("dragend", this._onMarkerDragEnd, this)
            },
            _onMarkerDragStart: function(a) {
                var b = a.target;
                b.setOpacity(0), this._shape.fire("editstart")
            },
            _fireEdit: function() {
                this._shape.edited = !0, this._shape.fire("edit")
            },
            _onMarkerDrag: function(a) {
                var b = a.target,
                    c = b.getLatLng();
                b === this._moveMarker ? this._move(c) : this._resize(c), this._shape.redraw()
            },
            _onMarkerDragEnd: function(a) {
                var b = a.target;
                b.setOpacity(1), this._fireEdit()
            },
            _move: function() {},
            _resize: function() {}
        }), L.Edit = L.Edit || {}, L.Edit.Rectangle = L.Edit.SimpleShape.extend({
            _createMoveMarker: function() {
                var a = this._shape.getBounds(),
                    b = a.getCenter();
                this._moveMarker = this._createMarker(b, this.options.moveIcon)
            },
            _createResizeMarker: function() {
                var a = this._getCorners();
                this._resizeMarkers = [];
                for (var b = 0, c = a.length; b < c; b++) this._resizeMarkers.push(this._createMarker(a[b], this.options.resizeIcon)), this._resizeMarkers[b]._cornerIndex = b
            },
            _onMarkerDragStart: function(a) {
                L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this, a);
                var b = this._getCorners(),
                    c = a.target,
                    d = c._cornerIndex;
                this._oppositeCorner = b[(d + 2) % 4], this._toggleCornerMarkers(0, d)
            },
            _onMarkerDragEnd: function(a) {
                var c, d, b = a.target;
                b === this._moveMarker && (c = this._shape.getBounds(), d = c.getCenter(), b.setLatLng(d)), this._toggleCornerMarkers(1), this._repositionCornerMarkers(), L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this, a)
            },
            _move: function(a) {
                for (var e, b = this._shape.getLatLngs(), c = this._shape.getBounds(), d = c.getCenter(), f = [], g = 0, h = b.length; g < h; g++) e = [b[g].lat - d.lat, b[g].lng - d.lng], f.push([a.lat + e[0], a.lng + e[1]]);
                this._shape.setLatLngs(f), this._repositionCornerMarkers()
            },
            _resize: function(a) {
                var b;
                this._shape.setBounds(L.latLngBounds(a, this._oppositeCorner)), b = this._shape.getBounds(), this._moveMarker.setLatLng(b.getCenter())
            },
            _getCorners: function() {
                var a = this._shape.getBounds(),
                    b = a.getNorthWest(),
                    c = a.getNorthEast(),
                    d = a.getSouthEast(),
                    e = a.getSouthWest();
                return [b, c, d, e]
            },
            _toggleCornerMarkers: function(a) {
                for (var b = 0, c = this._resizeMarkers.length; b < c; b++) this._resizeMarkers[b].setOpacity(a)
            },
            _repositionCornerMarkers: function() {
                for (var a = this._getCorners(), b = 0, c = this._resizeMarkers.length; b < c; b++) this._resizeMarkers[b].setLatLng(a[b])
            }
        }), L.Rectangle.addInitHook(function() {
            L.Edit.Rectangle && (this.editing = new L.Edit.Rectangle(this), this.options.editable && this.editing.enable())
        }), L.Edit = L.Edit || {}, L.Edit.Circle = L.Edit.SimpleShape.extend({
            _createMoveMarker: function() {
                var a = this._shape.getLatLng();
                this._moveMarker = this._createMarker(a, this.options.moveIcon)
            },
            _createResizeMarker: function() {
                var a = this._shape.getLatLng(),
                    b = this._getResizeMarkerPoint(a);
                this._resizeMarkers = [], this._resizeMarkers.push(this._createMarker(b, this.options.resizeIcon))
            },
            _getResizeMarkerPoint: function(a) {
                var b = this._shape._radius * Math.cos(Math.PI / 4),
                    c = this._map.project(a);
                return this._map.unproject([c.x + b, c.y - b])
            },
            _move: function(a) {
                var b = this._getResizeMarkerPoint(a);
                this._resizeMarkers[0].setLatLng(b), this._shape.setLatLng(a)
            },
            _resize: function(a) {
                var b = this._moveMarker.getLatLng(),
                    c = b.distanceTo(a);
                this._shape.setRadius(c)
            }
        }), L.Circle.addInitHook(function() {
            L.Edit.Circle && (this.editing = new L.Edit.Circle(this), this.options.editable && this.editing.enable()), this.on("add", function() {
                this.editing && this.editing.enabled() && this.editing.addHooks()
            }), this.on("remove", function() {
                this.editing && this.editing.enabled() && this.editing.removeHooks()
            })
        }), L.LatLngUtil = {
            cloneLatLngs: function(a) {
                for (var b = [], c = 0, d = a.length; c < d; c++) b.push(this.cloneLatLng(a[c]));
                return b
            },
            cloneLatLng: function(a) {
                return L.latLng(a.lat, a.lng)
            }
        }, L.GeometryUtil = L.extend(L.GeometryUtil || {}, {
            geodesicArea: function(a) {
                var e, f, b = a.length,
                    c = 0,
                    d = L.LatLng.DEG_TO_RAD;
                if (b > 2) {
                    for (var g = 0; g < b; g++) e = a[g], f = a[(g + 1) % b], c += (f.lng - e.lng) * d * (2 + Math.sin(e.lat * d) + Math.sin(f.lat * d));
                    c = 6378137 * c * 6378137 / 2
                }
                return Math.abs(c)
            },
            readableArea: function(a, b) {
                var c;
                return b ? c = a >= 1e4 ? (1e-4 * a).toFixed(2) + " ha" : a.toFixed(2) + " m&sup2;" : (a /= .836127, c = a >= 3097600 ? (a / 3097600).toFixed(2) + " mi&sup2;" : a >= 4840 ? (a / 4840).toFixed(2) + " acres" : Math.ceil(a) + " yd&sup2;"), c
            },
            readableDistance: function(a, b) {
                var c;
                return b ? c = a > 1e3 ? (a / 1e3).toFixed(2) + " km" : Math.ceil(a) + " m" : (a *= 1.09361, c = a > 1760 ? (a / 1760).toFixed(2) + " miles" : Math.ceil(a) + " yd"), c
            }
        }), L.Util.extend(L.LineUtil, {
            segmentsIntersect: function(a, b, c, d) {
                return this._checkCounterclockwise(a, c, d) !== this._checkCounterclockwise(b, c, d) && this._checkCounterclockwise(a, b, c) !== this._checkCounterclockwise(a, b, d)
            },
            _checkCounterclockwise: function(a, b, c) {
                return (c.y - a.y) * (b.x - a.x) > (b.y - a.y) * (c.x - a.x)
            }
        }), L.Polyline.include({
            intersects: function() {
                var c, d, e, a = this._originalPoints,
                    b = a ? a.length : 0;
                if (this._tooFewPointsForIntersection()) return !1;
                for (c = b - 1; c >= 3; c--)
                    if (d = a[c - 1], e = a[c], this._lineSegmentsIntersectsRange(d, e, c - 2)) return !0;
                return !1
            },
            newLatLngIntersects: function(a, b) {
                return !!this._map && this.newPointIntersects(this._map.latLngToLayerPoint(a), b)
            },
            newPointIntersects: function(a, b) {
                var c = this._originalPoints,
                    d = c ? c.length : 0,
                    e = c ? c[d - 1] : null,
                    f = d - 2;
                return !this._tooFewPointsForIntersection(1) && this._lineSegmentsIntersectsRange(e, a, f, b ? 1 : 0)
            },
            _tooFewPointsForIntersection: function(a) {
                var b = this._originalPoints,
                    c = b ? b.length : 0;
                return c += a || 0, !this._originalPoints || c <= 3
            },
            _lineSegmentsIntersectsRange: function(a, b, c, d) {
                var f, g, e = this._originalPoints;
                d = d || 0;
                for (var h = c; h > d; h--)
                    if (f = e[h - 1], g = e[h], L.LineUtil.segmentsIntersect(a, b, f, g)) return !0;
                return !1
            }
        }), L.Polygon.include({
            intersects: function() {
                var a, c, d, e, f, b = this._originalPoints;
                return !this._tooFewPointsForIntersection() && (a = L.Polyline.prototype.intersects.call(this), !!a || (c = b.length, d = b[0], e = b[c - 1], f = c - 2, this._lineSegmentsIntersectsRange(e, d, f, 1)))
            }
        }), L.Control.Draw = L.Control.extend({
            options: {
                position: "topleft",
                draw: {},
                edit: !1
            },
            initialize: function(a) {
                if (L.version < "0.7") throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");
                L.Control.prototype.initialize.call(this, a);
                var b;
                this._toolbars = {}, L.DrawToolbar && this.options.draw && (b = new L.DrawToolbar(this.options.draw), this._toolbars[L.DrawToolbar.TYPE] = b, this._toolbars[L.DrawToolbar.TYPE].on("enable", this._toolbarEnabled, this)), L.EditToolbar && this.options.edit && (b = new L.EditToolbar(this.options.edit), this._toolbars[L.EditToolbar.TYPE] = b, this._toolbars[L.EditToolbar.TYPE].on("enable", this._toolbarEnabled, this))
            },
            onAdd: function(a) {
                var e, b = L.DomUtil.create("div", "leaflet-draw"),
                    c = !1,
                    d = "leaflet-draw-toolbar-top";
                for (var f in this._toolbars) this._toolbars.hasOwnProperty(f) && (e = this._toolbars[f].addToolbar(a), e && (c || (L.DomUtil.hasClass(e, d) || L.DomUtil.addClass(e.childNodes[0], d), c = !0), b.appendChild(e)));
                return b
            },
            onRemove: function() {
                for (var a in this._toolbars) this._toolbars.hasOwnProperty(a) && this._toolbars[a].removeToolbar()
            },
            setDrawingOptions: function(a) {
                for (var b in this._toolbars) this._toolbars[b] instanceof L.DrawToolbar && this._toolbars[b].setOptions(a)
            },
            _toolbarEnabled: function(a) {
                var b = a.target;
                for (var c in this._toolbars) this._toolbars[c] !== b && this._toolbars[c].disable()
            }
        }), L.Map.mergeOptions({
            drawControlTooltips: !0,
            drawControl: !1
        }), L.Map.addInitHook(function() {
            this.options.drawControl && (this.drawControl = new L.Control.Draw, this.addControl(this.drawControl))
        }), L.Toolbar = L.Class.extend({
            includes: [L.Mixin.Events],
            initialize: function(a) {
                L.setOptions(this, a), this._modes = {}, this._actionButtons = [], this._activeMode = null
            },
            enabled: function() {
                return null !== this._activeMode
            },
            disable: function() {
                this.enabled() && this._activeMode.handler.disable()
            },
            addToolbar: function(a) {
                var f, b = L.DomUtil.create("div", "leaflet-draw-section"),
                    c = 0,
                    d = this._toolbarClass || "",
                    e = this.getModeHandlers(a);
                for (this._toolbarContainer = L.DomUtil.create("div", "leaflet-draw-toolbar leaflet-bar"), this._map = a, f = 0; f < e.length; f++) e[f].enabled && this._initModeHandler(e[f].handler, this._toolbarContainer, c++, d, e[f].title);
                if (c) return this._lastButtonIndex = --c, this._actionsContainer = L.DomUtil.create("ul", "leaflet-draw-actions"), b.appendChild(this._toolbarContainer), b.appendChild(this._actionsContainer), b
            },
            removeToolbar: function() {
                for (var a in this._modes) this._modes.hasOwnProperty(a) && (this._disposeButton(this._modes[a].button, this._modes[a].handler.enable, this._modes[a].handler), this._modes[a].handler.disable(), this._modes[a].handler.off("enabled", this._handlerActivated, this).off("disabled", this._handlerDeactivated, this));
                this._modes = {};
                for (var b = 0, c = this._actionButtons.length; b < c; b++) this._disposeButton(this._actionButtons[b].button, this._actionButtons[b].callback, this);
                this._actionButtons = [], this._actionsContainer = null
            },
            _initModeHandler: function(a, b, c, d, e) {
                var f = a.type;
                this._modes[f] = {}, this._modes[f].handler = a, this._modes[f].button = this._createButton({
                    title: e,
                    className: d + "-" + f,
                    container: b,
                    callback: this._modes[f].handler.enable,
                    context: this._modes[f].handler
                }), this._modes[f].buttonIndex = c, this._modes[f].handler.on("enabled", this._handlerActivated, this).on("disabled", this._handlerDeactivated, this)
            },
            _createButton: function(a) {
                var b = L.DomUtil.create("a", a.className || "", a.container);
                return b.href = "#", a.text && (b.innerHTML = a.text), a.title && (b.title = a.title), L.DomEvent.on(b, "click", L.DomEvent.stopPropagation).on(b, "mousedown", L.DomEvent.stopPropagation).on(b, "dblclick", L.DomEvent.stopPropagation).on(b, "click", L.DomEvent.preventDefault).on(b, "click", a.callback, a.context),
                    b
            },
            _disposeButton: function(a, b) {
                L.DomEvent.off(a, "click", L.DomEvent.stopPropagation).off(a, "mousedown", L.DomEvent.stopPropagation).off(a, "dblclick", L.DomEvent.stopPropagation).off(a, "click", L.DomEvent.preventDefault).off(a, "click", b)
            },
            _handlerActivated: function(a) {
                this.disable(), this._activeMode = this._modes[a.handler], L.DomUtil.addClass(this._activeMode.button, "leaflet-draw-toolbar-button-enabled"), this._showActionsToolbar(), this.fire("enable")
            },
            _handlerDeactivated: function() {
                this._hideActionsToolbar(), L.DomUtil.removeClass(this._activeMode.button, "leaflet-draw-toolbar-button-enabled"), this._activeMode = null, this.fire("disable")
            },
            _createActions: function(a) {
                var e, f, g, h, b = this._actionsContainer,
                    c = this.getActions(a),
                    d = c.length;
                for (f = 0, g = this._actionButtons.length; f < g; f++) this._disposeButton(this._actionButtons[f].button, this._actionButtons[f].callback);
                for (this._actionButtons = []; b.firstChild;) b.removeChild(b.firstChild);
                for (var i = 0; i < d; i++) "enabled" in c[i] && !c[i].enabled || (e = L.DomUtil.create("li", "", b), h = this._createButton({
                    title: c[i].title,
                    text: c[i].text,
                    container: e,
                    callback: c[i].callback,
                    context: c[i].context
                }), this._actionButtons.push({
                    button: h,
                    callback: c[i].callback
                }))
            },
            _showActionsToolbar: function() {
                var a = this._activeMode.buttonIndex,
                    b = this._lastButtonIndex,
                    c = this._activeMode.button.offsetTop - 1;
                this._createActions(this._activeMode.handler), this._actionsContainer.style.top = c + "px", 0 === a && (L.DomUtil.addClass(this._toolbarContainer, "leaflet-draw-toolbar-notop"), L.DomUtil.addClass(this._actionsContainer, "leaflet-draw-actions-top")), a === b && (L.DomUtil.addClass(this._toolbarContainer, "leaflet-draw-toolbar-nobottom"), L.DomUtil.addClass(this._actionsContainer, "leaflet-draw-actions-bottom")), this._actionsContainer.style.display = "block"
            },
            _hideActionsToolbar: function() {
                this._actionsContainer.style.display = "none", L.DomUtil.removeClass(this._toolbarContainer, "leaflet-draw-toolbar-notop"), L.DomUtil.removeClass(this._toolbarContainer, "leaflet-draw-toolbar-nobottom"), L.DomUtil.removeClass(this._actionsContainer, "leaflet-draw-actions-top"), L.DomUtil.removeClass(this._actionsContainer, "leaflet-draw-actions-bottom")
            }
        }), L.Tooltip = L.Class.extend({
            initialize: function(a) {
                this._map = a, this._popupPane = a._panes.popupPane, this._container = a.options.drawControlTooltips ? L.DomUtil.create("div", "leaflet-draw-tooltip", this._popupPane) : null, this._singleLineLabel = !1
            },
            dispose: function() {
                this._container && (this._popupPane.removeChild(this._container), this._container = null)
            },
            updateContent: function(a) {
                return this._container ? (a.subtext = a.subtext || "", 0 !== a.subtext.length || this._singleLineLabel ? a.subtext.length > 0 && this._singleLineLabel && (L.DomUtil.removeClass(this._container, "leaflet-draw-tooltip-single"), this._singleLineLabel = !1) : (L.DomUtil.addClass(this._container, "leaflet-draw-tooltip-single"), this._singleLineLabel = !0), this._container.innerHTML = (a.subtext.length > 0 ? '<span class="leaflet-draw-tooltip-subtext">' + a.subtext + "</span><br />" : "") + "<span>" + a.text + "</span>", this) : this
            },
            updatePosition: function(a) {
                var b = this._map.latLngToLayerPoint(a),
                    c = this._container;
                return this._container && (c.style.visibility = "inherit", L.DomUtil.setPosition(c, b)), this
            },
            showAsError: function() {
                return this._container && L.DomUtil.addClass(this._container, "leaflet-error-draw-tooltip"), this
            },
            removeError: function() {
                return this._container && L.DomUtil.removeClass(this._container, "leaflet-error-draw-tooltip"), this
            }
        }), L.DrawToolbar = L.Toolbar.extend({
            statics: {
                TYPE: "draw"
            },
            options: {
                polyline: {},
                polygon: {},
                rectangle: {},
                circle: {},
                marker: {}
            },
            initialize: function(a) {
                for (var b in this.options) this.options.hasOwnProperty(b) && a[b] && (a[b] = L.extend({}, this.options[b], a[b]));
                this._toolbarClass = "leaflet-draw-draw", L.Toolbar.prototype.initialize.call(this, a)
            },
            getModeHandlers: function(a) {
                return [{
                    enabled: this.options.polyline,
                    handler: new L.Draw.Polyline(a, this.options.polyline),
                    title: L.drawLocal.draw.toolbar.buttons.polyline
                }, {
                    enabled: this.options.polygon,
                    handler: new L.Draw.Polygon(a, this.options.polygon),
                    title: L.drawLocal.draw.toolbar.buttons.polygon
                }, {
                    enabled: this.options.rectangle,
                    handler: new L.Draw.Rectangle(a, this.options.rectangle),
                    title: L.drawLocal.draw.toolbar.buttons.rectangle
                }, {
                    enabled: this.options.circle,
                    handler: new L.Draw.Circle(a, this.options.circle),
                    title: L.drawLocal.draw.toolbar.buttons.circle
                }, {
                    enabled: this.options.marker,
                    handler: new L.Draw.Marker(a, this.options.marker),
                    title: L.drawLocal.draw.toolbar.buttons.marker
                }]
            },
            getActions: function(a) {
                return [{
                    enabled: a.deleteLastVertex,
                    title: L.drawLocal.draw.toolbar.undo.title,
                    text: L.drawLocal.draw.toolbar.undo.text,
                    callback: a.deleteLastVertex,
                    context: a
                }, {
                    title: L.drawLocal.draw.toolbar.actions.title,
                    text: L.drawLocal.draw.toolbar.actions.text,
                    callback: this.disable,
                    context: this
                }]
            },
            setOptions: function(a) {
                L.setOptions(this, a);
                for (var b in this._modes) this._modes.hasOwnProperty(b) && a.hasOwnProperty(b) && this._modes[b].handler.setOptions(a[b])
            }
        }), L.EditToolbar = L.Toolbar.extend({
            statics: {
                TYPE: "edit"
            },
            options: {
                edit: {
                    selectedPathOptions: {
                        color: "#fe57a1",
                        opacity: .6,
                        dashArray: "10, 10",
                        fill: !0,
                        fillColor: "#fe57a1",
                        fillOpacity: .1,
                        maintainColor: !1
                    }
                },
                remove: {},
                featureGroup: null
            },
            initialize: function(a) {
                a.edit && ("undefined" == typeof a.edit.selectedPathOptions && (a.edit.selectedPathOptions = this.options.edit.selectedPathOptions), a.edit.selectedPathOptions = L.extend({}, this.options.edit.selectedPathOptions, a.edit.selectedPathOptions)), a.remove && (a.remove = L.extend({}, this.options.remove, a.remove)), this._toolbarClass = "leaflet-draw-edit", L.Toolbar.prototype.initialize.call(this, a), this._selectedFeatureCount = 0
            },
            getModeHandlers: function(a) {
                var b = this.options.featureGroup;
                return [{
                    enabled: this.options.edit,
                    handler: new L.EditToolbar.Edit(a, {
                        featureGroup: b,
                        selectedPathOptions: this.options.edit.selectedPathOptions
                    }),
                    title: L.drawLocal.edit.toolbar.buttons.edit
                }, {
                    enabled: this.options.remove,
                    handler: new L.EditToolbar.Delete(a, {
                        featureGroup: b
                    }),
                    title: L.drawLocal.edit.toolbar.buttons.remove
                }]
            },
            getActions: function() {
                return [{
                    title: L.drawLocal.edit.toolbar.actions.save.title,
                    text: L.drawLocal.edit.toolbar.actions.save.text,
                    callback: this._save,
                    context: this
                }, {
                    title: L.drawLocal.edit.toolbar.actions.cancel.title,
                    text: L.drawLocal.edit.toolbar.actions.cancel.text,
                    callback: this.disable,
                    context: this
                }]
            },
            addToolbar: function(a) {
                var b = L.Toolbar.prototype.addToolbar.call(this, a);
                return this._checkDisabled(), this.options.featureGroup.on("layeradd layerremove", this._checkDisabled, this), b
            },
            removeToolbar: function() {
                this.options.featureGroup.off("layeradd layerremove", this._checkDisabled, this), L.Toolbar.prototype.removeToolbar.call(this)
            },
            disable: function() {
                this.enabled() && (this._activeMode.handler.revertLayers(), L.Toolbar.prototype.disable.call(this))
            },
            _save: function() {
                this._activeMode.handler.save(), this._activeMode.handler.disable()
            },
            _checkDisabled: function() {
                var c, a = this.options.featureGroup,
                    b = 0 !== a.getLayers().length;
                this.options.edit && (c = this._modes[L.EditToolbar.Edit.TYPE].button, b ? L.DomUtil.removeClass(c, "leaflet-disabled") : L.DomUtil.addClass(c, "leaflet-disabled"), c.setAttribute("title", b ? L.drawLocal.edit.toolbar.buttons.edit : L.drawLocal.edit.toolbar.buttons.editDisabled)), this.options.remove && (c = this._modes[L.EditToolbar.Delete.TYPE].button, b ? L.DomUtil.removeClass(c, "leaflet-disabled") : L.DomUtil.addClass(c, "leaflet-disabled"), c.setAttribute("title", b ? L.drawLocal.edit.toolbar.buttons.remove : L.drawLocal.edit.toolbar.buttons.removeDisabled))
            }
        }), L.EditToolbar.Edit = L.Handler.extend({
            statics: {
                TYPE: "edit"
            },
            includes: L.Mixin.Events,
            initialize: function(a, b) {
                if (L.Handler.prototype.initialize.call(this, a), L.setOptions(this, b), this._featureGroup = b.featureGroup, !(this._featureGroup instanceof L.FeatureGroup)) throw new Error("options.featureGroup must be a L.FeatureGroup");
                this._uneditedLayerProps = {}, this.type = L.EditToolbar.Edit.TYPE
            },
            enable: function() {
                !this._enabled && this._hasAvailableLayers() && (this.fire("enabled", {
                    handler: this.type
                }), this._map.fire("draw:editstart", {
                    handler: this.type
                }), L.Handler.prototype.enable.call(this), this._featureGroup.on("layeradd", this._enableLayerEdit, this).on("layerremove", this._disableLayerEdit, this))
            },
            disable: function() {
                this._enabled && (this._featureGroup.off("layeradd", this._enableLayerEdit, this).off("layerremove", this._disableLayerEdit, this), L.Handler.prototype.disable.call(this), this._map.fire("draw:editstop", {
                    handler: this.type
                }), this.fire("disabled", {
                    handler: this.type
                }))
            },
            addHooks: function() {
                var a = this._map;
                a && (a.getContainer().focus(), this._featureGroup.eachLayer(this._enableLayerEdit, this), this._tooltip = new L.Tooltip(this._map), this._tooltip.updateContent({
                    text: L.drawLocal.edit.handlers.edit.tooltip.text,
                    subtext: L.drawLocal.edit.handlers.edit.tooltip.subtext
                }), this._map.on("mousemove", this._onMouseMove, this))
            },
            removeHooks: function() {
                this._map && (this._featureGroup.eachLayer(this._disableLayerEdit, this), this._uneditedLayerProps = {}, this._tooltip.dispose(), this._tooltip = null, this._map.off("mousemove", this._onMouseMove, this))
            },
            revertLayers: function() {
                this._featureGroup.eachLayer(function(a) {
                    this._revertLayer(a)
                }, this)
            },
            save: function() {
                var a = new L.LayerGroup;
                this._featureGroup.eachLayer(function(b) {
                    b.edited && (a.addLayer(b), b.edited = !1)
                }), this._map.fire("draw:edited", {
                    layers: a
                })
            },
            _backupLayer: function(a) {
                var b = L.Util.stamp(a);
                this._uneditedLayerProps[b] || (a instanceof L.Polyline || a instanceof L.Polygon || a instanceof L.Rectangle ? this._uneditedLayerProps[b] = {
                    latlngs: L.LatLngUtil.cloneLatLngs(a.getLatLngs())
                } : a instanceof L.Circle ? this._uneditedLayerProps[b] = {
                    latlng: L.LatLngUtil.cloneLatLng(a.getLatLng()),
                    radius: a.getRadius()
                } : a instanceof L.Marker && (this._uneditedLayerProps[b] = {
                    latlng: L.LatLngUtil.cloneLatLng(a.getLatLng())
                }))
            },
            _revertLayer: function(a) {
                var b = L.Util.stamp(a);
                a.edited = !1, this._uneditedLayerProps.hasOwnProperty(b) && (a instanceof L.Polyline || a instanceof L.Polygon || a instanceof L.Rectangle ? a.setLatLngs(this._uneditedLayerProps[b].latlngs) : a instanceof L.Circle ? (a.setLatLng(this._uneditedLayerProps[b].latlng), a.setRadius(this._uneditedLayerProps[b].radius)) : a instanceof L.Marker && a.setLatLng(this._uneditedLayerProps[b].latlng), a.fire("revert-edited", {
                    layer: a
                }))
            },
            _enableLayerEdit: function(a) {
                var c, b = a.layer || a.target || a;
                this._backupLayer(b), this.options.selectedPathOptions && (c = L.Util.extend({}, this.options.selectedPathOptions), c.maintainColor && (c.color = b.options.color, c.fillColor = b.options.fillColor), b.options.original = L.extend({}, b.options), b.options.editing = c), b.editing.enable()
            },
            _disableLayerEdit: function(a) {
                var b = a.layer || a.target || a;
                b.edited = !1, b.editing.disable(), delete b.options.editing, delete b.options.original
            },
            _onMouseMove: function(a) {
                this._tooltip.updatePosition(a.latlng)
            },
            _hasAvailableLayers: function() {
                return 0 !== this._featureGroup.getLayers().length
            }
        }), L.EditToolbar.Delete = L.Handler.extend({
            statics: {
                TYPE: "remove"
            },
            includes: L.Mixin.Events,
            initialize: function(a, b) {
                if (L.Handler.prototype.initialize.call(this, a), L.Util.setOptions(this, b), this._deletableLayers = this.options.featureGroup, !(this._deletableLayers instanceof L.FeatureGroup)) throw new Error("options.featureGroup must be a L.FeatureGroup");
                this.type = L.EditToolbar.Delete.TYPE
            },
            enable: function() {
                !this._enabled && this._hasAvailableLayers() && (this.fire("enabled", {
                    handler: this.type
                }), this._map.fire("draw:deletestart", {
                    handler: this.type
                }), L.Handler.prototype.enable.call(this), this._deletableLayers.on("layeradd", this._enableLayerDelete, this).on("layerremove", this._disableLayerDelete, this))
            },
            disable: function() {
                this._enabled && (this._deletableLayers.off("layeradd", this._enableLayerDelete, this).off("layerremove", this._disableLayerDelete, this), L.Handler.prototype.disable.call(this), this._map.fire("draw:deletestop", {
                    handler: this.type
                }), this.fire("disabled", {
                    handler: this.type
                }))
            },
            addHooks: function() {
                var a = this._map;
                a && (a.getContainer().focus(), this._deletableLayers.eachLayer(this._enableLayerDelete, this), this._deletedLayers = new L.LayerGroup, this._tooltip = new L.Tooltip(this._map), this._tooltip.updateContent({
                    text: L.drawLocal.edit.handlers.remove.tooltip.text
                }), this._map.on("mousemove", this._onMouseMove, this))
            },
            removeHooks: function() {
                this._map && (this._deletableLayers.eachLayer(this._disableLayerDelete, this), this._deletedLayers = null, this._tooltip.dispose(), this._tooltip = null, this._map.off("mousemove", this._onMouseMove, this))
            },
            revertLayers: function() {
                this._deletedLayers.eachLayer(function(a) {
                    this._deletableLayers.addLayer(a), a.fire("revert-deleted", {
                        layer: a
                    })
                }, this)
            },
            save: function() {
                this._map.fire("draw:deleted", {
                    layers: this._deletedLayers
                })
            },
            _enableLayerDelete: function(a) {
                var b = a.layer || a.target || a;
                b.on("click", this._removeLayer, this)
            },
            _disableLayerDelete: function(a) {
                var b = a.layer || a.target || a;
                b.off("click", this._removeLayer, this), this._deletedLayers.removeLayer(b)
            },
            _removeLayer: function(a) {
                var b = a.layer || a.target || a;
                this._deletableLayers.removeLayer(b), this._deletedLayers.addLayer(b), b.fire("deleted")
            },
            _onMouseMove: function(a) {
                this._tooltip.updatePosition(a.latlng)
            },
            _hasAvailableLayers: function() {
                return 0 !== this._deletableLayers.getLayers().length
            }
        })
    }(window, document), define("leaflet.draw", function() {}),
    function(a, b, c) {
        var d = a.L;
        d.labelVersion = "0.2.2-dev", d.Label = (d.Layer ? d.Layer : d.Class).extend({
            includes: d.Mixin.Events,
            options: {
                className: "",
                clickable: !1,
                direction: "right",
                noHide: !1,
                offset: [12, -15],
                opacity: 1,
                zoomAnimation: !0
            },
            initialize: function(a, b) {
                d.setOptions(this, a), this._source = b, this._animated = d.Browser.any3d && this.options.zoomAnimation, this._isOpen = !1
            },
            onAdd: function(a) {
                this._map = a, this._pane = this.options.pane ? a._panes[this.options.pane] : this._source instanceof d.Marker ? a._panes.markerPane : a._panes.popupPane, this._container || this._initLayout(), this._pane.appendChild(this._container), this._initInteraction(), this._update(), this.setOpacity(this.options.opacity), a.on("moveend", this._onMoveEnd, this).on("viewreset", this._onViewReset, this), this._animated && a.on("zoomanim", this._zoomAnimation, this), d.Browser.touch && !this.options.noHide && (d.DomEvent.on(this._container, "click", this.close, this), a.on("click", this.close, this))
            },
            onRemove: function(a) {
                this._pane.removeChild(this._container), a.off({
                    zoomanim: this._zoomAnimation,
                    moveend: this._onMoveEnd,
                    viewreset: this._onViewReset
                }, this), this._removeInteraction(), this._map = null
            },
            setLatLng: function(a) {
                return this._latlng = d.latLng(a), this._map && this._updatePosition(), this
            },
            setContent: function(a) {
                return this._previousContent = this._content, this._content = a, this._updateContent(), this
            },
            close: function() {
                var a = this._map;
                a && (d.Browser.touch && !this.options.noHide && (d.DomEvent.off(this._container, "click", this.close), a.off("click", this.close, this)), a.removeLayer(this))
            },
            updateZIndex: function(a) {
                this._zIndex = a, this._container && this._zIndex && (this._container.style.zIndex = a)
            },
            setOpacity: function(a) {
                this.options.opacity = a, this._container && d.DomUtil.setOpacity(this._container, a)
            },
            _initLayout: function() {
                this._container = d.DomUtil.create("div", "leaflet-label " + this.options.className + " leaflet-zoom-animated"), this.updateZIndex(this._zIndex)
            },
            _update: function() {
                this._map && (this._container.style.visibility = "hidden", this._updateContent(), this._updatePosition(), this._container.style.visibility = "")
            },
            _updateContent: function() {
                this._content && this._map && this._prevContent !== this._content && "string" == typeof this._content && (this._container.innerHTML = this._content, this._prevContent = this._content, this._labelWidth = this._container.offsetWidth)
            },
            _updatePosition: function() {
                var a = this._map.latLngToLayerPoint(this._latlng);
                this._setPosition(a)
            },
            _setPosition: function(a) {
                var b = this._map,
                    c = this._container,
                    e = b.latLngToContainerPoint(b.getCenter()),
                    f = b.layerPointToContainerPoint(a),
                    g = this.options.direction,
                    h = this._labelWidth,
                    i = d.point(this.options.offset);
                "right" === g || "auto" === g && f.x < e.x ? (d.DomUtil.addClass(c, "leaflet-label-right"), d.DomUtil.removeClass(c, "leaflet-label-left"), a = a.add(i)) : (d.DomUtil.addClass(c, "leaflet-label-left"), d.DomUtil.removeClass(c, "leaflet-label-right"), a = a.add(d.point(-i.x - h, i.y))), d.DomUtil.setPosition(c, a)
            },
            _zoomAnimation: function(a) {
                var b = this._map._latLngToNewLayerPoint(this._latlng, a.zoom, a.center).round();
                this._setPosition(b)
            },
            _onMoveEnd: function() {
                (!this._animated || "auto" === this.options.direction) && this._updatePosition()
            },
            _onViewReset: function(a) {
                a && a.hard && this._update()
            },
            _initInteraction: function() {
                if (this.options.clickable) {
                    var a = this._container,
                        b = ["dblclick", "mousedown", "mouseover", "mouseout", "contextmenu"];
                    d.DomUtil.addClass(a, "leaflet-clickable"), d.DomEvent.on(a, "click", this._onMouseClick, this);
                    for (var c = 0; c < b.length; c++) d.DomEvent.on(a, b[c], this._fireMouseEvent, this)
                }
            },
            _removeInteraction: function() {
                if (this.options.clickable) {
                    var a = this._container,
                        b = ["dblclick", "mousedown", "mouseover", "mouseout", "contextmenu"];
                    d.DomUtil.removeClass(a, "leaflet-clickable"), d.DomEvent.off(a, "click", this._onMouseClick, this);
                    for (var c = 0; c < b.length; c++) d.DomEvent.off(a, b[c], this._fireMouseEvent, this)
                }
            },
            _onMouseClick: function(a) {
                this.hasEventListeners(a.type) && d.DomEvent.stopPropagation(a), this.fire(a.type, {
                    originalEvent: a
                })
            },
            _fireMouseEvent: function(a) {
                this.fire(a.type, {
                    originalEvent: a
                }), "contextmenu" === a.type && this.hasEventListeners(a.type) && d.DomEvent.preventDefault(a), "mousedown" !== a.type ? d.DomEvent.stopPropagation(a) : d.DomEvent.preventDefault(a)
            }
        }), d.BaseMarkerMethods = {
            showLabel: function() {
                return this.label && this._map && (this.label.setLatLng(this._latlng), this._map.showLabel(this.label)), this
            },
            hideLabel: function() {
                return this.label && this.label.close(), this
            },
            setLabelNoHide: function(a) {
                this._labelNoHide !== a && (this._labelNoHide = a, a ? (this._removeLabelRevealHandlers(), this.showLabel()) : (this._addLabelRevealHandlers(), this.hideLabel()))
            },
            bindLabel: function(a, b) {
                var c = this.options.icon ? this.options.icon.options.labelAnchor : this.options.labelAnchor,
                    e = d.point(c) || d.point(0, 0);
                return e = e.add(d.Label.prototype.options.offset), b && b.offset && (e = e.add(b.offset)), b = d.Util.extend({
                    offset: e
                }, b), this._labelNoHide = b.noHide, this.label || (this._labelNoHide || this._addLabelRevealHandlers(), this.on("remove", this.hideLabel, this).on("move", this._moveLabel, this).on("add", this._onMarkerAdd, this), this._hasLabelHandlers = !0), this.label = new d.Label(b, this).setContent(a), this
            },
            unbindLabel: function() {
                return this.label && (this.hideLabel(), this.label = null, this._hasLabelHandlers && (this._labelNoHide || this._removeLabelRevealHandlers(), this.off("remove", this.hideLabel, this).off("move", this._moveLabel, this).off("add", this._onMarkerAdd, this)), this._hasLabelHandlers = !1), this
            },
            updateLabelContent: function(a) {
                this.label && this.label.setContent(a)
            },
            getLabel: function() {
                return this.label
            },
            _onMarkerAdd: function() {
                this._labelNoHide && this.showLabel()
            },
            _addLabelRevealHandlers: function() {
                this.on("mouseover", this.showLabel, this).on("mouseout", this.hideLabel, this), d.Browser.touch && this.on("click", this.showLabel, this)
            },
            _removeLabelRevealHandlers: function() {
                this.off("mouseover", this.showLabel, this).off("mouseout", this.hideLabel, this), d.Browser.touch && this.off("click", this.showLabel, this)
            },
            _moveLabel: function(a) {
                this.label.setLatLng(a.latlng)
            }
        }, d.Icon.Default.mergeOptions({
            labelAnchor: new d.Point(9, -20)
        }), d.Marker.mergeOptions({
            icon: new d.Icon.Default
        }), d.Marker.include(d.BaseMarkerMethods), d.Marker.include({
            _originalUpdateZIndex: d.Marker.prototype._updateZIndex,
            _updateZIndex: function(a) {
                var b = this._zIndex + a;
                this._originalUpdateZIndex(a), this.label && this.label.updateZIndex(b)
            },
            _originalSetOpacity: d.Marker.prototype.setOpacity,
            setOpacity: function(a, b) {
                this.options.labelHasSemiTransparency = b, this._originalSetOpacity(a)
            },
            _originalUpdateOpacity: d.Marker.prototype._updateOpacity,
            _updateOpacity: function() {
                var a = 0 === this.options.opacity ? 0 : 1;
                this._originalUpdateOpacity(), this.label && this.label.setOpacity(this.options.labelHasSemiTransparency ? this.options.opacity : a)
            },
            _originalSetLatLng: d.Marker.prototype.setLatLng,
            setLatLng: function(a) {
                return this.label && !this._labelNoHide && this.hideLabel(), this._originalSetLatLng(a)
            }
        }), d.CircleMarker.mergeOptions({
            labelAnchor: new d.Point(0, 0)
        }), d.CircleMarker.include(d.BaseMarkerMethods), d.Path.include({
            bindLabel: function(a, b) {
                return this.label && this.label.options === b || (this.label = new d.Label(b, this)), this.label.setContent(a), this._showLabelAdded || (this.on("mouseover", this._showLabel, this).on("mousemove", this._moveLabel, this).on("mouseout remove", this._hideLabel, this), d.Browser.touch && this.on("click", this._showLabel, this), this._showLabelAdded = !0), this
            },
            unbindLabel: function() {
                return this.label && (this._hideLabel(), this.label = null, this._showLabelAdded = !1, this.off("mouseover", this._showLabel, this).off("mousemove", this._moveLabel, this).off("mouseout remove", this._hideLabel, this)), this
            },
            updateLabelContent: function(a) {
                this.label && this.label.setContent(a)
            },
            _showLabel: function(a) {
                this.label.setLatLng(a.latlng), this._map.showLabel(this.label)
            },
            _moveLabel: function(a) {
                this.label.setLatLng(a.latlng)
            },
            _hideLabel: function() {
                this.label.close()
            }
        }), d.Map.include({
            showLabel: function(a) {
                return this.addLayer(a)
            }
        }), d.FeatureGroup.include({
            clearLayers: function() {
                return this.unbindLabel(), this.eachLayer(this.removeLayer, this), this
            },
            bindLabel: function(a, b) {
                return this.invoke("bindLabel", a, b)
            },
            unbindLabel: function() {
                return this.invoke("unbindLabel")
            },
            updateLabelContent: function(a) {
                this.invoke("updateLabelContent", a)
            }
        })
    }(window, document), define("leaflet.label", function() {}),
    function(a, b, c) {
        L.MarkerClusterGroup = L.FeatureGroup.extend({
                options: {
                    maxClusterRadius: 80,
                    iconCreateFunction: null,
                    spiderfyOnMaxZoom: !0,
                    showCoverageOnHover: !0,
                    zoomToBoundsOnClick: !0,
                    singleMarkerMode: !1,
                    disableClusteringAtZoom: null,
                    removeOutsideVisibleBounds: !0,
                    animate: !0,
                    animateAddingMarkers: !1,
                    spiderfyDistanceMultiplier: 1,
                    spiderLegPolylineOptions: {
                        weight: 1.5,
                        color: "#222",
                        opacity: .5
                    },
                    chunkedLoading: !1,
                    chunkInterval: 200,
                    chunkDelay: 50,
                    chunkProgress: null,
                    polygonOptions: {}
                },
                initialize: function(a) {
                    L.Util.setOptions(this, a), this.options.iconCreateFunction || (this.options.iconCreateFunction = this._defaultIconCreateFunction), this._featureGroup = L.featureGroup(), this._featureGroup.on(L.FeatureGroup.EVENTS, this._propagateEvent, this), this._nonPointGroup = L.featureGroup(), this._nonPointGroup.on(L.FeatureGroup.EVENTS, this._propagateEvent, this), this._inZoomAnimation = 0, this._needsClustering = [], this._needsRemoving = [], this._currentShownBounds = null, this._queue = [];
                    var b = L.DomUtil.TRANSITION && this.options.animate;
                    L.extend(this, b ? this._withAnimation : this._noAnimation), this._markerCluster = b ? L.MarkerCluster : L.MarkerClusterNonAnimated
                },
                addLayer: function(a) {
                    if (a instanceof L.LayerGroup) {
                        var b = [];
                        for (var c in a._layers) b.push(a._layers[c]);
                        return this.addLayers(b)
                    }
                    if (!a.getLatLng) return this._nonPointGroup.addLayer(a), this;
                    if (!this._map) return this._needsClustering.push(a), this;
                    if (this.hasLayer(a)) return this;
                    this._unspiderfy && this._unspiderfy(), this._addLayer(a, this._maxZoom), this._topClusterLevel._recalculateBounds();
                    var d = a,
                        e = this._map.getZoom();
                    if (a.__parent)
                        for (; d.__parent._zoom >= e;) d = d.__parent;
                    return this._currentShownBounds.contains(d.getLatLng()) && (this.options.animateAddingMarkers ? this._animationAddLayer(a, d) : this._animationAddLayerNonAnimated(a, d)), this
                },
                removeLayer: function(a) {
                    if (a instanceof L.LayerGroup) {
                        var b = [];
                        for (var c in a._layers) b.push(a._layers[c]);
                        return this.removeLayers(b)
                    }
                    return a.getLatLng ? this._map ? a.__parent ? (this._unspiderfy && (this._unspiderfy(), this._unspiderfyLayer(a)), this._removeLayer(a, !0), this._topClusterLevel._recalculateBounds(), this._featureGroup.hasLayer(a) && (this._featureGroup.removeLayer(a), a.clusterShow && a.clusterShow()), this) : this : (!this._arraySplice(this._needsClustering, a) && this.hasLayer(a) && this._needsRemoving.push(a), this) : (this._nonPointGroup.removeLayer(a), this)
                },
                addLayers: function(a) {
                    var g, h, i, j, b = this._featureGroup,
                        c = this._nonPointGroup,
                        d = this.options.chunkedLoading,
                        e = this.options.chunkInterval,
                        f = this.options.chunkProgress;
                    if (this._map) {
                        var k = 0,
                            l = (new Date).getTime(),
                            m = L.bind(function() {
                                for (var g = (new Date).getTime(); k < a.length; k++) {
                                    if (d && k % 200 === 0) {
                                        var h = (new Date).getTime() - g;
                                        if (h > e) break
                                    }
                                    if (j = a[k], j.getLatLng) {
                                        if (!this.hasLayer(j) && (this._addLayer(j, this._maxZoom), j.__parent && 2 === j.__parent.getChildCount())) {
                                            var i = j.__parent.getAllChildMarkers(),
                                                n = i[0] === j ? i[1] : i[0];
                                            b.removeLayer(n)
                                        }
                                    } else c.addLayer(j)
                                }
                                f && f(k, a.length, (new Date).getTime() - l), k === a.length ? (this._topClusterLevel._recalculateBounds(), this._featureGroup.eachLayer(function(a) {
                                    a instanceof L.MarkerCluster && a._iconNeedsUpdate && a._updateIcon()
                                }), this._topClusterLevel._recursivelyAddChildrenToMap(null, this._zoom, this._currentShownBounds)) : setTimeout(m, this.options.chunkDelay)
                            }, this);
                        m()
                    } else {
                        for (g = [], h = 0, i = a.length; h < i; h++) j = a[h], j.getLatLng ? this.hasLayer(j) || g.push(j) : c.addLayer(j);
                        this._needsClustering = this._needsClustering.concat(g)
                    }
                    return this
                },
                removeLayers: function(a) {
                    var b, c, d, e = this._featureGroup,
                        f = this._nonPointGroup;
                    if (!this._map) {
                        for (b = 0, c = a.length; b < c; b++) d = a[b], this._arraySplice(this._needsClustering, d), f.removeLayer(d), this.hasLayer(d) && this._needsRemoving.push(d);
                        return this
                    }
                    if (this._unspiderfy)
                        for (this._unspiderfy(), b = 0, c = a.length; b < c; b++) d = a[b], this._unspiderfyLayer(d);
                    for (b = 0, c = a.length; b < c; b++) d = a[b], d.__parent ? (this._removeLayer(d, !0, !0), e.hasLayer(d) && (e.removeLayer(d), d.clusterShow && d.clusterShow())) : f.removeLayer(d);
                    return this._topClusterLevel._recalculateBounds(), this._topClusterLevel._recursivelyAddChildrenToMap(null, this._zoom, this._currentShownBounds), e.eachLayer(function(a) {
                        a instanceof L.MarkerCluster && a._updateIcon()
                    }), this
                },
                clearLayers: function() {
                    return this._map || (this._needsClustering = [], delete this._gridClusters, delete this._gridUnclustered), this._noanimationUnspiderfy && this._noanimationUnspiderfy(), this._featureGroup.clearLayers(), this._nonPointGroup.clearLayers(), this.eachLayer(function(a) {
                        delete a.__parent
                    }), this._map && this._generateInitialClusters(), this
                },
                getBounds: function() {
                    var a = new L.LatLngBounds;
                    this._topClusterLevel && a.extend(this._topClusterLevel._bounds);
                    for (var b = this._needsClustering.length - 1; b >= 0; b--) a.extend(this._needsClustering[b].getLatLng());
                    return a.extend(this._nonPointGroup.getBounds()), a
                },
                eachLayer: function(a, b) {
                    var d, c = this._needsClustering.slice();
                    for (this._topClusterLevel && this._topClusterLevel.getAllChildMarkers(c), d = c.length - 1; d >= 0; d--) a.call(b, c[d]);
                    this._nonPointGroup.eachLayer(a, b)
                },
                getLayers: function() {
                    var a = [];
                    return this.eachLayer(function(b) {
                        a.push(b)
                    }), a
                },
                getLayer: function(a) {
                    var b = null;
                    return a = parseInt(a, 10), this.eachLayer(function(c) {
                        L.stamp(c) === a && (b = c)
                    }), b
                },
                hasLayer: function(a) {
                    if (!a) return !1;
                    var b, c = this._needsClustering;
                    for (b = c.length - 1; b >= 0; b--)
                        if (c[b] === a) return !0;
                    for (c = this._needsRemoving, b = c.length - 1; b >= 0; b--)
                        if (c[b] === a) return !1;
                    return !!a.__parent && a.__parent._group === this || this._nonPointGroup.hasLayer(a)
                },
                zoomToShowLayer: function(a, b) {
                    "function" != typeof b && (b = function() {});
                    var c = function() {
                        (a._icon || a.__parent._icon) && !this._inZoomAnimation && (this._map.off("moveend", c, this), this.off("animationend", c, this), a._icon ? b() : a.__parent._icon && (this.once("spiderfied", b, this), a.__parent.spiderfy()))
                    };
                    if (a._icon && this._map.getBounds().contains(a.getLatLng())) b();
                    else if (a.__parent._zoom < this._map.getZoom()) this._map.on("moveend", c, this), this._map.panTo(a.getLatLng());
                    else {
                        var d = function() {
                            this._map.off("movestart", d, this), d = null
                        };
                        this._map.on("movestart", d, this), this._map.on("moveend", c, this), this.on("animationend", c, this), a.__parent.zoomToBounds(), d && c.call(this)
                    }
                },
                onAdd: function(a) {
                    this._map = a;
                    var b, c, d;
                    if (!isFinite(this._map.getMaxZoom())) throw "Map has no maxZoom specified";
                    for (this._featureGroup.onAdd(a), this._nonPointGroup.onAdd(a), this._gridClusters || this._generateInitialClusters(), this._maxLat = a.options.crs.projection.MAX_LATITUDE, b = 0, c = this._needsRemoving.length; b < c; b++) d = this._needsRemoving[b], this._removeLayer(d, !0);
                    this._needsRemoving = [], this._zoom = this._map.getZoom(), this._currentShownBounds = this._getExpandedVisibleBounds(), this._map.on("zoomend", this._zoomEnd, this), this._map.on("moveend", this._moveEnd, this), this._spiderfierOnAdd && this._spiderfierOnAdd(), this._bindEvents(), c = this._needsClustering, this._needsClustering = [], this.addLayers(c)
                },
                onRemove: function(a) {
                    a.off("zoomend", this._zoomEnd, this), a.off("moveend", this._moveEnd, this), this._unbindEvents(), this._map._mapPane.className = this._map._mapPane.className.replace(" leaflet-cluster-anim", ""), this._spiderfierOnRemove && this._spiderfierOnRemove(), delete this._maxLat, this._hideCoverage(), this._featureGroup.onRemove(a), this._nonPointGroup.onRemove(a), this._featureGroup.clearLayers(), this._map = null
                },
                getVisibleParent: function(a) {
                    for (var b = a; b && !b._icon;) b = b.__parent;
                    return b || null
                },
                _arraySplice: function(a, b) {
                    for (var c = a.length - 1; c >= 0; c--)
                        if (a[c] === b) return a.splice(c, 1), !0
                },
                _removeFromGridUnclustered: function(a, b) {
                    for (var c = this._map, d = this._gridUnclustered; b >= 0 && d[b].removeObject(a, c.project(a.getLatLng(), b)); b--);
                },
                _removeLayer: function(a, b, c) {
                    var d = this._gridClusters,
                        e = this._gridUnclustered,
                        f = this._featureGroup,
                        g = this._map;
                    b && this._removeFromGridUnclustered(a, this._maxZoom);
                    var j, h = a.__parent,
                        i = h._markers;
                    for (this._arraySplice(i, a); h && (h._childCount--, h._boundsNeedUpdate = !0, !(h._zoom < 0));) b && h._childCount <= 1 ? (j = h._markers[0] === a ? h._markers[1] : h._markers[0], d[h._zoom].removeObject(h, g.project(h._cLatLng, h._zoom)), e[h._zoom].addObject(j, g.project(j.getLatLng(), h._zoom)), this._arraySplice(h.__parent._childClusters, h), h.__parent._markers.push(j), j.__parent = h.__parent, h._icon && (f.removeLayer(h), c || f.addLayer(j))) : (!c || !h._icon) && h._updateIcon(), h = h.__parent;
                    delete a.__parent
                },
                _isOrIsParent: function(a, b) {
                    for (; b;) {
                        if (a === b) return !0;
                        b = b.parentNode
                    }
                    return !1
                },
                _propagateEvent: function(a) {
                    if (a.layer instanceof L.MarkerCluster) {
                        if (a.originalEvent && this._isOrIsParent(a.layer._icon, a.originalEvent.relatedTarget)) return;
                        a.type = "cluster" + a.type
                    }
                    this.fire(a.type, a)
                },
                _defaultIconCreateFunction: function(a) {
                    var b = a.getChildCount(),
                        c = " marker-cluster-";
                    return c += b < 10 ? "small" : b < 100 ? "medium" : "large", new L.DivIcon({
                        html: "<div><span>" + b + "</span></div>",
                        className: "marker-cluster" + c,
                        iconSize: new L.Point(40, 40)
                    })
                },
                _bindEvents: function() {
                    var a = this._map,
                        b = this.options.spiderfyOnMaxZoom,
                        c = this.options.showCoverageOnHover,
                        d = this.options.zoomToBoundsOnClick;
                    (b || d) && this.on("clusterclick", this._zoomOrSpiderfy, this), c && (this.on("clustermouseover", this._showCoverage, this), this.on("clustermouseout", this._hideCoverage, this), a.on("zoomend", this._hideCoverage, this))
                },
                _zoomOrSpiderfy: function(a) {
                    for (var b = a.layer, c = b; 1 === c._childClusters.length;) c = c._childClusters[0];
                    c._zoom === this._maxZoom && c._childCount === b._childCount ? this.options.spiderfyOnMaxZoom && b.spiderfy() : this.options.zoomToBoundsOnClick && b.zoomToBounds(), a.originalEvent && 13 === a.originalEvent.keyCode && this._map._container.focus()
                },
                _showCoverage: function(a) {
                    var b = this._map;
                    this._inZoomAnimation || (this._shownPolygon && b.removeLayer(this._shownPolygon), a.layer.getChildCount() > 2 && a.layer !== this._spiderfied && (this._shownPolygon = new L.Polygon(a.layer.getConvexHull(), this.options.polygonOptions), b.addLayer(this._shownPolygon)))
                },
                _hideCoverage: function() {
                    this._shownPolygon && (this._map.removeLayer(this._shownPolygon), this._shownPolygon = null)
                },
                _unbindEvents: function() {
                    var a = this.options.spiderfyOnMaxZoom,
                        b = this.options.showCoverageOnHover,
                        c = this.options.zoomToBoundsOnClick,
                        d = this._map;
                    (a || c) && this.off("clusterclick", this._zoomOrSpiderfy, this), b && (this.off("clustermouseover", this._showCoverage, this), this.off("clustermouseout", this._hideCoverage, this), d.off("zoomend", this._hideCoverage, this))
                },
                _zoomEnd: function() {
                    this._map && (this._mergeSplitClusters(), this._zoom = this._map._zoom, this._currentShownBounds = this._getExpandedVisibleBounds())
                },
                _moveEnd: function() {
                    if (!this._inZoomAnimation) {
                        var a = this._getExpandedVisibleBounds();
                        this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, this._zoom, a), this._topClusterLevel._recursivelyAddChildrenToMap(null, this._map._zoom, a), this._currentShownBounds = a
                    }
                },
                _generateInitialClusters: function() {
                    var a = this._map.getMaxZoom(),
                        b = this.options.maxClusterRadius,
                        c = b;
                    "function" != typeof b && (c = function() {
                            return b
                        }), this.options.disableClusteringAtZoom && (a = this.options.disableClusteringAtZoom - 1), this._maxZoom = a, this._gridClusters = {},
                        this._gridUnclustered = {};
                    for (var d = a; d >= 0; d--) this._gridClusters[d] = new L.DistanceGrid(c(d)), this._gridUnclustered[d] = new L.DistanceGrid(c(d));
                    this._topClusterLevel = new this._markerCluster(this, -1)
                },
                _addLayer: function(a, b) {
                    var e, f, c = this._gridClusters,
                        d = this._gridUnclustered;
                    for (this.options.singleMarkerMode && this._overrideMarkerIcon(a); b >= 0; b--) {
                        e = this._map.project(a.getLatLng(), b);
                        var g = c[b].getNearObject(e);
                        if (g) return g._addChild(a), void(a.__parent = g);
                        if (g = d[b].getNearObject(e)) {
                            var h = g.__parent;
                            h && this._removeLayer(g, !1);
                            var i = new this._markerCluster(this, b, g, a);
                            c[b].addObject(i, this._map.project(i._cLatLng, b)), g.__parent = i, a.__parent = i;
                            var j = i;
                            for (f = b - 1; f > h._zoom; f--) j = new this._markerCluster(this, f, j), c[f].addObject(j, this._map.project(g.getLatLng(), f));
                            return h._addChild(j), void this._removeFromGridUnclustered(g, b)
                        }
                        d[b].addObject(a, e)
                    }
                    this._topClusterLevel._addChild(a), a.__parent = this._topClusterLevel
                },
                _enqueue: function(a) {
                    this._queue.push(a), this._queueTimeout || (this._queueTimeout = setTimeout(L.bind(this._processQueue, this), 300))
                },
                _processQueue: function() {
                    for (var a = 0; a < this._queue.length; a++) this._queue[a].call(this);
                    this._queue.length = 0, clearTimeout(this._queueTimeout), this._queueTimeout = null
                },
                _mergeSplitClusters: function() {
                    this._processQueue(), this._zoom < this._map._zoom && this._currentShownBounds.intersects(this._getExpandedVisibleBounds()) ? (this._animationStart(), this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, this._zoom, this._getExpandedVisibleBounds()), this._animationZoomIn(this._zoom, this._map._zoom)) : this._zoom > this._map._zoom ? (this._animationStart(), this._animationZoomOut(this._zoom, this._map._zoom)) : this._moveEnd()
                },
                _getExpandedVisibleBounds: function() {
                    return this.options.removeOutsideVisibleBounds ? L.Browser.mobile ? this._checkBoundsMaxLat(this._map.getBounds()) : this._checkBoundsMaxLat(this._map.getBounds().pad(1)) : this._mapBoundsInfinite
                },
                _checkBoundsMaxLat: function(a) {
                    var b = this._maxLat;
                    return b !== c && (a.getNorth() >= b && (a._northEast.lat = 1 / 0), a.getSouth() <= -b && (a._southWest.lat = -(1 / 0))), a
                },
                _animationAddLayerNonAnimated: function(a, b) {
                    if (b === a) this._featureGroup.addLayer(a);
                    else if (2 === b._childCount) {
                        b._addToMap();
                        var c = b.getAllChildMarkers();
                        this._featureGroup.removeLayer(c[0]), this._featureGroup.removeLayer(c[1])
                    } else b._updateIcon()
                },
                _overrideMarkerIcon: function(a) {
                    var b = a.options.icon = this.options.iconCreateFunction({
                        getChildCount: function() {
                            return 1
                        },
                        getAllChildMarkers: function() {
                            return [a]
                        }
                    });
                    return b
                }
            }), L.MarkerClusterGroup.include({
                _mapBoundsInfinite: new L.LatLngBounds(new L.LatLng(-(1 / 0), -(1 / 0)), new L.LatLng(1 / 0, 1 / 0))
            }), L.MarkerClusterGroup.include({
                _noAnimation: {
                    _animationStart: function() {},
                    _animationZoomIn: function(a, b) {
                        this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, a), this._topClusterLevel._recursivelyAddChildrenToMap(null, b, this._getExpandedVisibleBounds()), this.fire("animationend")
                    },
                    _animationZoomOut: function(a, b) {
                        this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, a), this._topClusterLevel._recursivelyAddChildrenToMap(null, b, this._getExpandedVisibleBounds()), this.fire("animationend")
                    },
                    _animationAddLayer: function(a, b) {
                        this._animationAddLayerNonAnimated(a, b)
                    }
                },
                _withAnimation: {
                    _animationStart: function() {
                        this._map._mapPane.className += " leaflet-cluster-anim", this._inZoomAnimation++
                    },
                    _animationZoomIn: function(a, b) {
                        var e, c = this._getExpandedVisibleBounds(),
                            d = this._featureGroup;
                        this._topClusterLevel._recursively(c, a, 0, function(f) {
                            var i, g = f._latlng,
                                h = f._markers;
                            for (c.contains(g) || (g = null), f._isSingleParent() && a + 1 === b ? (d.removeLayer(f), f._recursivelyAddChildrenToMap(null, b, c)) : (f.clusterHide(), f._recursivelyAddChildrenToMap(g, b, c)), e = h.length - 1; e >= 0; e--) i = h[e], c.contains(i._latlng) || d.removeLayer(i)
                        }), this._forceLayout(), this._topClusterLevel._recursivelyBecomeVisible(c, b), d.eachLayer(function(a) {
                            !(a instanceof L.MarkerCluster) && a._icon && a.clusterShow()
                        }), this._topClusterLevel._recursively(c, a, b, function(a) {
                            a._recursivelyRestoreChildPositions(b)
                        }), this._enqueue(function() {
                            this._topClusterLevel._recursively(c, a, 0, function(a) {
                                d.removeLayer(a), a.clusterShow()
                            }), this._animationEnd()
                        })
                    },
                    _animationZoomOut: function(a, b) {
                        this._animationZoomOutSingle(this._topClusterLevel, a - 1, b), this._topClusterLevel._recursivelyAddChildrenToMap(null, b, this._getExpandedVisibleBounds()), this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, a, this._getExpandedVisibleBounds())
                    },
                    _animationAddLayer: function(a, b) {
                        var c = this,
                            d = this._featureGroup;
                        d.addLayer(a), b !== a && (b._childCount > 2 ? (b._updateIcon(), this._forceLayout(), this._animationStart(), a._setPos(this._map.latLngToLayerPoint(b.getLatLng())), a.clusterHide(), this._enqueue(function() {
                            d.removeLayer(a), a.clusterShow(), c._animationEnd()
                        })) : (this._forceLayout(), c._animationStart(), c._animationZoomOutSingle(b, this._map.getMaxZoom(), this._map.getZoom())))
                    }
                },
                _animationZoomOutSingle: function(a, b, c) {
                    var d = this._getExpandedVisibleBounds();
                    a._recursivelyAnimateChildrenInAndAddSelfToMap(d, b + 1, c);
                    var e = this;
                    this._forceLayout(), a._recursivelyBecomeVisible(d, c), this._enqueue(function() {
                        if (1 === a._childCount) {
                            var f = a._markers[0];
                            f.setLatLng(f.getLatLng()), f.clusterShow && f.clusterShow()
                        } else a._recursively(d, c, 0, function(a) {
                            a._recursivelyRemoveChildrenFromMap(d, b + 1)
                        });
                        e._animationEnd()
                    })
                },
                _animationEnd: function() {
                    this._map && (this._map._mapPane.className = this._map._mapPane.className.replace(" leaflet-cluster-anim", "")), this._inZoomAnimation--, this.fire("animationend")
                },
                _forceLayout: function() {
                    L.Util.falseFn(b.body.offsetWidth)
                }
            }), L.markerClusterGroup = function(a) {
                return new L.MarkerClusterGroup(a)
            }, L.MarkerCluster = L.Marker.extend({
                initialize: function(a, b, c, d) {
                    L.Marker.prototype.initialize.call(this, c ? c._cLatLng || c.getLatLng() : new L.LatLng(0, 0), {
                        icon: this
                    }), this._group = a, this._zoom = b, this._markers = [], this._childClusters = [], this._childCount = 0, this._iconNeedsUpdate = !0, this._boundsNeedUpdate = !0, this._bounds = new L.LatLngBounds, c && this._addChild(c), d && this._addChild(d)
                },
                getAllChildMarkers: function(a) {
                    a = a || [];
                    for (var b = this._childClusters.length - 1; b >= 0; b--) this._childClusters[b].getAllChildMarkers(a);
                    for (var c = this._markers.length - 1; c >= 0; c--) a.push(this._markers[c]);
                    return a
                },
                getChildCount: function() {
                    return this._childCount
                },
                zoomToBounds: function() {
                    for (var f, a = this._childClusters.slice(), b = this._group._map, c = b.getBoundsZoom(this._bounds), d = this._zoom + 1, e = b.getZoom(); a.length > 0 && c > d;) {
                        d++;
                        var g = [];
                        for (f = 0; f < a.length; f++) g = g.concat(a[f]._childClusters);
                        a = g
                    }
                    c > d ? this._group._map.setView(this._latlng, d) : c <= e ? this._group._map.setView(this._latlng, e + 1) : this._group._map.fitBounds(this._bounds)
                },
                getBounds: function() {
                    var a = new L.LatLngBounds;
                    return a.extend(this._bounds), a
                },
                _updateIcon: function() {
                    this._iconNeedsUpdate = !0, this._icon && this.setIcon(this)
                },
                createIcon: function() {
                    return this._iconNeedsUpdate && (this._iconObj = this._group.options.iconCreateFunction(this), this._iconNeedsUpdate = !1), this._iconObj.createIcon()
                },
                createShadow: function() {
                    return this._iconObj.createShadow()
                },
                _addChild: function(a, b) {
                    this._iconNeedsUpdate = !0, this._boundsNeedUpdate = !0, this._setClusterCenter(a), a instanceof L.MarkerCluster ? (b || (this._childClusters.push(a), a.__parent = this), this._childCount += a._childCount) : (b || this._markers.push(a), this._childCount++), this.__parent && this.__parent._addChild(a, !0)
                },
                _setClusterCenter: function(a) {
                    this._cLatLng || (this._cLatLng = a._cLatLng || a._latlng)
                },
                _resetBounds: function() {
                    var a = this._bounds;
                    a._southWest && (a._southWest.lat = 1 / 0, a._southWest.lng = 1 / 0), a._northEast && (a._northEast.lat = -(1 / 0), a._northEast.lng = -(1 / 0))
                },
                _recalculateBounds: function() {
                    var f, g, h, i, a = this._markers,
                        b = this._childClusters,
                        c = 0,
                        d = 0,
                        e = this._childCount;
                    if (0 !== e) {
                        for (this._resetBounds(), f = 0; f < a.length; f++) h = a[f]._latlng, this._bounds.extend(h), c += h.lat, d += h.lng;
                        for (f = 0; f < b.length; f++) g = b[f], g._boundsNeedUpdate && g._recalculateBounds(), this._bounds.extend(g._bounds), h = g._wLatLng, i = g._childCount, c += h.lat * i, d += h.lng * i;
                        this._latlng = this._wLatLng = new L.LatLng(c / e, d / e), this._boundsNeedUpdate = !1
                    }
                },
                _addToMap: function(a) {
                    a && (this._backupLatlng = this._latlng, this.setLatLng(a)), this._group._featureGroup.addLayer(this)
                },
                _recursivelyAnimateChildrenIn: function(a, b, c) {
                    this._recursively(a, 0, c - 1, function(a) {
                        var d, e, c = a._markers;
                        for (d = c.length - 1; d >= 0; d--) e = c[d], e._icon && (e._setPos(b), e.clusterHide())
                    }, function(a) {
                        var d, e, c = a._childClusters;
                        for (d = c.length - 1; d >= 0; d--) e = c[d], e._icon && (e._setPos(b), e.clusterHide())
                    })
                },
                _recursivelyAnimateChildrenInAndAddSelfToMap: function(a, b, c) {
                    this._recursively(a, c, 0, function(d) {
                        d._recursivelyAnimateChildrenIn(a, d._group._map.latLngToLayerPoint(d.getLatLng()).round(), b), d._isSingleParent() && b - 1 === c ? (d.clusterShow(), d._recursivelyRemoveChildrenFromMap(a, b)) : d.clusterHide(), d._addToMap()
                    })
                },
                _recursivelyBecomeVisible: function(a, b) {
                    this._recursively(a, 0, b, null, function(a) {
                        a.clusterShow()
                    })
                },
                _recursivelyAddChildrenToMap: function(a, b, c) {
                    this._recursively(c, -1, b, function(d) {
                        if (b !== d._zoom)
                            for (var e = d._markers.length - 1; e >= 0; e--) {
                                var f = d._markers[e];
                                c.contains(f._latlng) && (a && (f._backupLatlng = f.getLatLng(), f.setLatLng(a), f.clusterHide && f.clusterHide()), d._group._featureGroup.addLayer(f))
                            }
                    }, function(b) {
                        b._addToMap(a)
                    })
                },
                _recursivelyRestoreChildPositions: function(a) {
                    for (var b = this._markers.length - 1; b >= 0; b--) {
                        var c = this._markers[b];
                        c._backupLatlng && (c.setLatLng(c._backupLatlng), delete c._backupLatlng)
                    }
                    if (a - 1 === this._zoom)
                        for (var d = this._childClusters.length - 1; d >= 0; d--) this._childClusters[d]._restorePosition();
                    else
                        for (var e = this._childClusters.length - 1; e >= 0; e--) this._childClusters[e]._recursivelyRestoreChildPositions(a)
                },
                _restorePosition: function() {
                    this._backupLatlng && (this.setLatLng(this._backupLatlng), delete this._backupLatlng)
                },
                _recursivelyRemoveChildrenFromMap: function(a, b, c) {
                    var d, e;
                    this._recursively(a, -1, b - 1, function(a) {
                        for (e = a._markers.length - 1; e >= 0; e--) d = a._markers[e], c && c.contains(d._latlng) || (a._group._featureGroup.removeLayer(d), d.clusterShow && d.clusterShow())
                    }, function(a) {
                        for (e = a._childClusters.length - 1; e >= 0; e--) d = a._childClusters[e], c && c.contains(d._latlng) || (a._group._featureGroup.removeLayer(d), d.clusterShow && d.clusterShow())
                    })
                },
                _recursively: function(a, b, c, d, e) {
                    var h, i, f = this._childClusters,
                        g = this._zoom;
                    if (b > g)
                        for (h = f.length - 1; h >= 0; h--) i = f[h], a.intersects(i._bounds) && i._recursively(a, b, c, d, e);
                    else if (d && d(this), e && this._zoom === c && e(this), c > g)
                        for (h = f.length - 1; h >= 0; h--) i = f[h], a.intersects(i._bounds) && i._recursively(a, b, c, d, e)
                },
                _isSingleParent: function() {
                    return this._childClusters.length > 0 && this._childClusters[0]._childCount === this._childCount
                }
            }), L.Marker.include({
                clusterHide: function() {
                    return this.options.opacityWhenUnclustered = this.options.opacity || 1, this.setOpacity(0)
                },
                clusterShow: function() {
                    var a = this.setOpacity(this.options.opacity || this.options.opacityWhenUnclustered);
                    return delete this.options.opacityWhenUnclustered, a
                }
            }), L.DistanceGrid = function(a) {
                this._cellSize = a, this._sqCellSize = a * a, this._grid = {}, this._objectPoint = {}
            }, L.DistanceGrid.prototype = {
                addObject: function(a, b) {
                    var c = this._getCoord(b.x),
                        d = this._getCoord(b.y),
                        e = this._grid,
                        f = e[d] = e[d] || {},
                        g = f[c] = f[c] || [],
                        h = L.Util.stamp(a);
                    this._objectPoint[h] = b, g.push(a)
                },
                updateObject: function(a, b) {
                    this.removeObject(a), this.addObject(a, b)
                },
                removeObject: function(a, b) {
                    var h, i, c = this._getCoord(b.x),
                        d = this._getCoord(b.y),
                        e = this._grid,
                        f = e[d] = e[d] || {},
                        g = f[c] = f[c] || [];
                    for (delete this._objectPoint[L.Util.stamp(a)], h = 0, i = g.length; h < i; h++)
                        if (g[h] === a) return g.splice(h, 1), 1 === i && delete f[c], !0
                },
                eachObject: function(a, b) {
                    var c, d, e, f, g, h, i, j = this._grid;
                    for (c in j) {
                        g = j[c];
                        for (d in g)
                            for (h = g[d], e = 0, f = h.length; e < f; e++) i = a.call(b, h[e]), i && (e--, f--)
                    }
                },
                getNearObject: function(a) {
                    var d, e, f, g, h, i, j, k, b = this._getCoord(a.x),
                        c = this._getCoord(a.y),
                        l = this._objectPoint,
                        m = this._sqCellSize,
                        n = null;
                    for (d = c - 1; d <= c + 1; d++)
                        if (g = this._grid[d])
                            for (e = b - 1; e <= b + 1; e++)
                                if (h = g[e])
                                    for (f = 0, i = h.length; f < i; f++) j = h[f], k = this._sqDist(l[L.Util.stamp(j)], a), k < m && (m = k, n = j);
                    return n
                },
                _getCoord: function(a) {
                    return Math.floor(a / this._cellSize)
                },
                _sqDist: function(a, b) {
                    var c = b.x - a.x,
                        d = b.y - a.y;
                    return c * c + d * d
                }
            },
            function() {
                L.QuickHull = {
                    getDistant: function(a, b) {
                        var c = b[1].lat - b[0].lat,
                            d = b[0].lng - b[1].lng;
                        return d * (a.lat - b[0].lat) + c * (a.lng - b[0].lng)
                    },
                    findMostDistantPointFromBaseLine: function(a, b) {
                        var f, g, h, c = 0,
                            d = null,
                            e = [];
                        for (f = b.length - 1; f >= 0; f--) g = b[f], h = this.getDistant(g, a), h > 0 && (e.push(g), h > c && (c = h, d = g));
                        return {
                            maxPoint: d,
                            newPoints: e
                        }
                    },
                    buildConvexHull: function(a, b) {
                        var c = [],
                            d = this.findMostDistantPointFromBaseLine(a, b);
                        return d.maxPoint ? (c = c.concat(this.buildConvexHull([a[0], d.maxPoint], d.newPoints)), c = c.concat(this.buildConvexHull([d.maxPoint, a[1]], d.newPoints))) : [a[0]]
                    },
                    getConvexHull: function(a) {
                        var l, b = !1,
                            c = !1,
                            d = !1,
                            e = !1,
                            f = null,
                            g = null,
                            h = null,
                            i = null,
                            j = null,
                            k = null;
                        for (l = a.length - 1; l >= 0; l--) {
                            var m = a[l];
                            (b === !1 || m.lat > b) && (f = m, b = m.lat), (c === !1 || m.lat < c) && (g = m, c = m.lat), (d === !1 || m.lng > d) && (h = m, d = m.lng), (e === !1 || m.lng < e) && (i = m, e = m.lng)
                        }
                        c !== b ? (k = g, j = f) : (k = i, j = h);
                        var n = [].concat(this.buildConvexHull([k, j], a), this.buildConvexHull([j, k], a));
                        return n
                    }
                }
            }(), L.MarkerCluster.include({
                getConvexHull: function() {
                    var c, d, a = this.getAllChildMarkers(),
                        b = [];
                    for (d = a.length - 1; d >= 0; d--) c = a[d].getLatLng(), b.push(c);
                    return L.QuickHull.getConvexHull(b)
                }
            }), L.MarkerCluster.include({
                _2PI: 2 * Math.PI,
                _circleFootSeparation: 25,
                _circleStartAngle: Math.PI / 6,
                _spiralFootSeparation: 28,
                _spiralLengthStart: 11,
                _spiralLengthFactor: 5,
                _circleSpiralSwitchover: 9,
                spiderfy: function() {
                    if (this._group._spiderfied !== this && !this._group._inZoomAnimation) {
                        var e, a = this.getAllChildMarkers(),
                            b = this._group,
                            c = b._map,
                            d = c.latLngToLayerPoint(this._latlng);
                        this._group._unspiderfy(), this._group._spiderfied = this, a.length >= this._circleSpiralSwitchover ? e = this._generatePointsSpiral(a.length, d) : (d.y += 10, e = this._generatePointsCircle(a.length, d)), this._animationSpiderfy(a, e)
                    }
                },
                unspiderfy: function(a) {
                    this._group._inZoomAnimation || (this._animationUnspiderfy(a), this._group._spiderfied = null)
                },
                _generatePointsCircle: function(a, b) {
                    var g, h, c = this._group.options.spiderfyDistanceMultiplier * this._circleFootSeparation * (2 + a),
                        d = c / this._2PI,
                        e = this._2PI / a,
                        f = [];
                    for (f.length = a, g = a - 1; g >= 0; g--) h = this._circleStartAngle + g * e, f[g] = new L.Point(b.x + d * Math.cos(h), b.y + d * Math.sin(h))._round();
                    return f
                },
                _generatePointsSpiral: function(a, b) {
                    var i, c = this._group.options.spiderfyDistanceMultiplier,
                        d = c * this._spiralLengthStart,
                        e = c * this._spiralFootSeparation,
                        f = c * this._spiralLengthFactor * this._2PI,
                        g = 0,
                        h = [];
                    for (h.length = a, i = a - 1; i >= 0; i--) g += e / d + 5e-4 * i, h[i] = new L.Point(b.x + d * Math.cos(g), b.y + d * Math.sin(g))._round(), d += f / g;
                    return h
                },
                _noanimationUnspiderfy: function() {
                    var e, f, a = this._group,
                        b = a._map,
                        c = a._featureGroup,
                        d = this.getAllChildMarkers();
                    for (this.setOpacity(1), f = d.length - 1; f >= 0; f--) e = d[f], c.removeLayer(e), e._preSpiderfyLatlng && (e.setLatLng(e._preSpiderfyLatlng), delete e._preSpiderfyLatlng), e.setZIndexOffset && e.setZIndexOffset(0), e._spiderLeg && (b.removeLayer(e._spiderLeg), delete e._spiderLeg);
                    a.fire("unspiderfied", {
                        cluster: this,
                        markers: d
                    }), a._spiderfied = null
                }
            }), L.MarkerClusterNonAnimated = L.MarkerCluster.extend({
                _animationSpiderfy: function(a, b) {
                    var g, h, i, j, c = this._group,
                        d = c._map,
                        e = c._featureGroup,
                        f = this._group.options.spiderLegPolylineOptions;
                    for (g = 0; g < a.length; g++) j = d.layerPointToLatLng(b[g]), h = a[g], i = new L.Polyline([this._latlng, j], f), d.addLayer(i), h._spiderLeg = i, h._preSpiderfyLatlng = h._latlng, h.setLatLng(j), h.setZIndexOffset && h.setZIndexOffset(1e6), e.addLayer(h);
                    this.setOpacity(.3), c.fire("spiderfied", {
                        cluster: this,
                        markers: a
                    })
                },
                _animationUnspiderfy: function() {
                    this._noanimationUnspiderfy()
                }
            }), L.MarkerCluster.include({
                _animationSpiderfy: function(a, b) {
                    var m, n, o, p, q, r, d = this,
                        e = this._group,
                        f = e._map,
                        g = e._featureGroup,
                        h = this._latlng,
                        i = f.latLngToLayerPoint(h),
                        j = L.Path.SVG,
                        k = L.extend({}, this._group.options.spiderLegPolylineOptions),
                        l = k.opacity;
                    for (l === c && (l = L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity), j ? (k.opacity = 0, k.className = (k.className || "") + " leaflet-cluster-spider-leg") : k.opacity = l, m = 0; m < a.length; m++) n = a[m], r = f.layerPointToLatLng(b[m]), o = new L.Polyline([h, r], k), f.addLayer(o), n._spiderLeg = o, j && (p = o._path, q = p.getTotalLength() + .1, p.style.strokeDasharray = q, p.style.strokeDashoffset = q), n.setZIndexOffset && n.setZIndexOffset(1e6), n.clusterHide && n.clusterHide(), g.addLayer(n), n._setPos && n._setPos(i);
                    for (e._forceLayout(), e._animationStart(), m = a.length - 1; m >= 0; m--) r = f.layerPointToLatLng(b[m]), n = a[m], n._preSpiderfyLatlng = n._latlng, n.setLatLng(r), n.clusterShow && n.clusterShow(), j && (o = n._spiderLeg, p = o._path, p.style.strokeDashoffset = 0, o.setStyle({
                        opacity: l
                    }));
                    this.setOpacity(.3), setTimeout(function() {
                        e._animationEnd(), e.fire("spiderfied", {
                            cluster: d,
                            markers: a
                        })
                    }, 200)
                },
                _animationUnspiderfy: function(a) {
                    var i, j, k, l, m, n, b = this,
                        c = this._group,
                        d = c._map,
                        e = c._featureGroup,
                        f = a ? d._latLngToNewLayerPoint(this._latlng, a.zoom, a.center) : d.latLngToLayerPoint(this._latlng),
                        g = this.getAllChildMarkers(),
                        h = L.Path.SVG;
                    for (c._animationStart(), this.setOpacity(1), j = g.length - 1; j >= 0; j--) i = g[j], i._preSpiderfyLatlng && (i.setLatLng(i._preSpiderfyLatlng), delete i._preSpiderfyLatlng, n = !0, i._setPos && (i._setPos(f), n = !1), i.clusterHide && (i.clusterHide(), n = !1), n && e.removeLayer(i), h && (k = i._spiderLeg, l = k._path, m = l.getTotalLength() + .1, l.style.strokeDashoffset = m, k.setStyle({
                        opacity: 0
                    })));
                    setTimeout(function() {
                        var a = 0;
                        for (j = g.length - 1; j >= 0; j--) i = g[j], i._spiderLeg && a++;
                        for (j = g.length - 1; j >= 0; j--) i = g[j], i._spiderLeg && (i.clusterShow && i.clusterShow(), i.setZIndexOffset && i.setZIndexOffset(0), a > 1 && e.removeLayer(i), d.removeLayer(i._spiderLeg), delete i._spiderLeg);
                        c._animationEnd(), c.fire("unspiderfied", {
                            cluster: b,
                            markers: g
                        })
                    }, 200)
                }
            }), L.MarkerClusterGroup.include({
                _spiderfied: null,
                _spiderfierOnAdd: function() {
                    this._map.on("click", this._unspiderfyWrapper, this), this._map.options.zoomAnimation && this._map.on("zoomstart", this._unspiderfyZoomStart, this), this._map.on("zoomend", this._noanimationUnspiderfy, this)
                },
                _spiderfierOnRemove: function() {
                    this._map.off("click", this._unspiderfyWrapper, this), this._map.off("zoomstart", this._unspiderfyZoomStart, this), this._map.off("zoomanim", this._unspiderfyZoomAnim, this), this._map.off("zoomend", this._noanimationUnspiderfy, this), this._noanimationUnspiderfy()
                },
                _unspiderfyZoomStart: function() {
                    this._map && this._map.on("zoomanim", this._unspiderfyZoomAnim, this)
                },
                _unspiderfyZoomAnim: function(a) {
                    L.DomUtil.hasClass(this._map._mapPane, "leaflet-touching") || (this._map.off("zoomanim", this._unspiderfyZoomAnim, this), this._unspiderfy(a))
                },
                _unspiderfyWrapper: function() {
                    this._unspiderfy()
                },
                _unspiderfy: function(a) {
                    this._spiderfied && this._spiderfied.unspiderfy(a)
                },
                _noanimationUnspiderfy: function() {
                    this._spiderfied && this._spiderfied._noanimationUnspiderfy()
                },
                _unspiderfyLayer: function(a) {
                    a._spiderLeg && (this._featureGroup.removeLayer(a), a.clusterShow && a.clusterShow(), a.setZIndexOffset && a.setZIndexOffset(0), this._map.removeLayer(a._spiderLeg), delete a._spiderLeg)
                }
            }), L.MarkerClusterGroup.include({
                refreshClusters: function(a) {
                    return a ? a instanceof L.MarkerClusterGroup ? a = a._topClusterLevel.getAllChildMarkers() : a instanceof L.LayerGroup ? a = a._layers : a instanceof L.MarkerCluster ? a = a.getAllChildMarkers() : a instanceof L.Marker && (a = [a]) : a = this._topClusterLevel.getAllChildMarkers(), this._flagParentsIconsNeedUpdate(a), this._refreshClustersIcons(), this.options.singleMarkerMode && this._refreshSingleMarkerModeMarkers(a), this
                },
                _flagParentsIconsNeedUpdate: function(a) {
                    var b, c;
                    for (b in a)
                        for (c = a[b].__parent; c;) c._iconNeedsUpdate = !0, c = c.__parent
                },
                _refreshClustersIcons: function() {
                    this._featureGroup.eachLayer(function(a) {
                        a instanceof L.MarkerCluster && a._iconNeedsUpdate && a._updateIcon()
                    })
                },
                _refreshSingleMarkerModeMarkers: function(a) {
                    var b, c;
                    for (b in a) c = a[b], this.hasLayer(c) && c.setIcon(this._overrideMarkerIcon(c))
                }
            }), L.Marker.include({
                refreshIconOptions: function(a, b) {
                    var c = this.options.icon;
                    return L.setOptions(c, a), this.setIcon(c), b && this.__parent && this.__parent._group.refreshClusters(this), this
                }
            })
    }(window, document), define("leaflet.markercluster", function() {}), ! function(a) {
        if ("object" == typeof exports) module.exports = a();
        else if ("function" == typeof define && define.amd) define("proj4", a);
        else {
            var b;
            "undefined" != typeof window ? b = window : "undefined" != typeof global ? b = global : "undefined" != typeof self && (b = self), b.proj4 = a()
        }
    }(function() {
        return function a(b, c, d) {
            function e(g, h) {
                if (!c[g]) {
                    if (!b[g]) {
                        var i = "function" == typeof require && require;
                        if (!h && i) return i(g, !0);
                        if (f) return f(g, !0);
                        throw new Error("Cannot find module '" + g + "'")
                    }
                    var j = c[g] = {
                        exports: {}
                    };
                    b[g][0].call(j.exports, function(a) {
                        var c = b[g][1][a];
                        return e(c ? c : a)
                    }, j, j.exports, a, b, c, d)
                }
                return c[g].exports
            }
            for (var f = "function" == typeof require && require, g = 0; g < d.length; g++) e(d[g]);
            return e
        }({
            1: [function(a, b, c) {
                function d(a, b, c) {
                    if (!(this instanceof d)) return new d(a, b, c);
                    if (Array.isArray(a)) this.x = a[0], this.y = a[1], this.z = a[2] || 0;
                    else if ("object" == typeof a) this.x = a.x, this.y = a.y, this.z = a.z || 0;
                    else if ("string" == typeof a && "undefined" == typeof b) {
                        var e = a.split(",");
                        this.x = parseFloat(e[0], 10), this.y = parseFloat(e[1], 10), this.z = parseFloat(e[2], 10) || 0
                    } else this.x = a, this.y = b, this.z = c || 0;
                    console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")
                }
                var e = a("mgrs");
                d.fromMGRS = function(a) {
                    return new d(e.toPoint(a))
                }, d.prototype.toMGRS = function(a) {
                    return e.forward([this.x, this.y], a)
                }, b.exports = d
            }, {
                mgrs: 67
            }],
            2: [function(a, b, c) {
                function d(a, b) {
                    if (!(this instanceof d)) return new d(a);
                    b = b || function(a) {
                        if (a) throw a
                    };
                    var c = e(a);
                    if ("object" != typeof c) return void b(a);
                    var g = h(c),
                        i = d.projections.get(g.projName);
                    i ? (f(this, g), f(this, i), this.init(), b(null, this)) : b(a)
                }
                var e = a("./parseCode"),
                    f = a("./extend"),
                    g = a("./projections"),
                    h = a("./deriveConstants");
                d.projections = g, d.projections.start(), b.exports = d
            }, {
                "./deriveConstants": 33,
                "./extend": 34,
                "./parseCode": 37,
                "./projections": 39
            }],
            3: [function(a, b, c) {
                b.exports = function(a, b, c) {
                    var g, h, i, d = c.x,
                        e = c.y,
                        f = c.z || 0;
                    for (i = 0; i < 3; i++)
                        if (!b || 2 !== i || void 0 !== c.z) switch (0 === i ? (g = d, h = "x") : 1 === i ? (g = e, h = "y") : (g = f, h = "z"), a.axis[i]) {
                            case "e":
                                c[h] = g;
                                break;
                            case "w":
                                c[h] = -g;
                                break;
                            case "n":
                                c[h] = g;
                                break;
                            case "s":
                                c[h] = -g;
                                break;
                            case "u":
                                void 0 !== c[h] && (c.z = g);
                                break;
                            case "d":
                                void 0 !== c[h] && (c.z = -g);
                                break;
                            default:
                                return null
                        }
                    return c
                }
            }, {}],
            4: [function(a, b, c) {
                var d = Math.PI / 2,
                    e = a("./sign");
                b.exports = function(a) {
                    return Math.abs(a) < d ? a : a - e(a) * Math.PI
                }
            }, {
                "./sign": 21
            }],
            5: [function(a, b, c) {
                var d = 2 * Math.PI,
                    e = 3.14159265359,
                    f = a("./sign");
                b.exports = function(a) {
                    return Math.abs(a) <= e ? a : a - f(a) * d
                }
            }, {
                "./sign": 21
            }],
            6: [function(a, b, c) {
                b.exports = function(a) {
                    return Math.abs(a) > 1 && (a = a > 1 ? 1 : -1), Math.asin(a)
                }
            }, {}],
            7: [function(a, b, c) {
                b.exports = function(a) {
                    return 1 - .25 * a * (1 + a / 16 * (3 + 1.25 * a))
                }
            }, {}],
            8: [function(a, b, c) {
                b.exports = function(a) {
                    return .375 * a * (1 + .25 * a * (1 + .46875 * a))
                }
            }, {}],
            9: [function(a, b, c) {
                b.exports = function(a) {
                    return .05859375 * a * a * (1 + .75 * a)
                }
            }, {}],
            10: [function(a, b, c) {
                b.exports = function(a) {
                    return a * a * a * (35 / 3072)
                }
            }, {}],
            11: [function(a, b, c) {
                b.exports = function(a, b, c) {
                    var d = b * c;
                    return a / Math.sqrt(1 - d * d)
                }
            }, {}],
            12: [function(a, b, c) {
                b.exports = function(a, b, c, d, e) {
                    var f, g;
                    f = a / b;
                    for (var h = 0; h < 15; h++)
                        if (g = (a - (b * f - c * Math.sin(2 * f) + d * Math.sin(4 * f) - e * Math.sin(6 * f))) / (b - 2 * c * Math.cos(2 * f) + 4 * d * Math.cos(4 * f) - 6 * e * Math.cos(6 * f)), f += g, Math.abs(g) <= 1e-10) return f;
                    return NaN
                }
            }, {}],
            13: [function(a, b, c) {
                var d = Math.PI / 2;
                b.exports = function(a, b) {
                    var c = 1 - (1 - a * a) / (2 * a) * Math.log((1 - a) / (1 + a));
                    if (Math.abs(Math.abs(b) - c) < 1e-6) return b < 0 ? -1 * d : d;
                    for (var f, g, h, i, e = Math.asin(.5 * b), j = 0; j < 30; j++)
                        if (g = Math.sin(e), h = Math.cos(e), i = a * g, f = Math.pow(1 - i * i, 2) / (2 * h) * (b / (1 - a * a) - g / (1 - i * i) + .5 / a * Math.log((1 - i) / (1 + i))), e += f, Math.abs(f) <= 1e-10) return e;
                    return NaN
                }
            }, {}],
            14: [function(a, b, c) {
                b.exports = function(a, b, c, d, e) {
                    return a * e - b * Math.sin(2 * e) + c * Math.sin(4 * e) - d * Math.sin(6 * e)
                }
            }, {}],
            15: [function(a, b, c) {
                b.exports = function(a, b, c) {
                    var d = a * b;
                    return c / Math.sqrt(1 - d * d)
                }
            }, {}],
            16: [function(a, b, c) {
                var d = Math.PI / 2;
                b.exports = function(a, b) {
                    for (var e, f, c = .5 * a, g = d - 2 * Math.atan(b), h = 0; h <= 15; h++)
                        if (e = a * Math.sin(g), f = d - 2 * Math.atan(b * Math.pow((1 - e) / (1 + e), c)) - g, g += f, Math.abs(f) <= 1e-10) return g;
                    return -9999
                }
            }, {}],
            17: [function(a, b, c) {
                var d = 1,
                    e = .25,
                    f = .046875,
                    g = .01953125,
                    h = .01068115234375,
                    i = .75,
                    j = .46875,
                    k = .013020833333333334,
                    l = .007120768229166667,
                    m = .3645833333333333,
                    n = .005696614583333333,
                    o = .3076171875;
                b.exports = function(a) {
                    var b = [];
                    b[0] = d - a * (e + a * (f + a * (g + a * h))), b[1] = a * (i - a * (f + a * (g + a * h)));
                    var c = a * a;
                    return b[2] = c * (j - a * (k + a * l)), c *= a, b[3] = c * (m - a * n), b[4] = c * a * o, b
                }
            }, {}],
            18: [function(a, b, c) {
                var d = a("./pj_mlfn"),
                    e = 1e-10,
                    f = 20;
                b.exports = function(a, b, c) {
                    for (var g = 1 / (1 - b), h = a, i = f; i; --i) {
                        var j = Math.sin(h),
                            k = 1 - b * j * j;
                        if (k = (d(h, j, Math.cos(h), c) - a) * k * Math.sqrt(k) * g, h -= k, Math.abs(k) < e) return h
                    }
                    return h
                }
            }, {
                "./pj_mlfn": 19
            }],
            19: [function(a, b, c) {
                b.exports = function(a, b, c, d) {
                    return c *= b, b *= b, d[0] * a - c * (d[1] + b * (d[2] + b * (d[3] + b * d[4])))
                }
            }, {}],
            20: [function(a, b, c) {
                b.exports = function(a, b) {
                    var c;
                    return a > 1e-7 ? (c = a * b, (1 - a * a) * (b / (1 - c * c) - .5 / a * Math.log((1 - c) / (1 + c)))) : 2 * b
                }
            }, {}],
            21: [function(a, b, c) {
                b.exports = function(a) {
                    return a < 0 ? -1 : 1
                }
            }, {}],
            22: [function(a, b, c) {
                b.exports = function(a, b) {
                    return Math.pow((1 - a) / (1 + a), b)
                }
            }, {}],
            23: [function(a, b, c) {
                b.exports = function(a) {
                    var b = {
                        x: a[0],
                        y: a[1]
                    };
                    return a.length > 2 && (b.z = a[2]), a.length > 3 && (b.m = a[3]), b
                }
            }, {}],
            24: [function(a, b, c) {
                var d = Math.PI / 2;
                b.exports = function(a, b, c) {
                    var e = a * c,
                        f = .5 * a;
                    return e = Math.pow((1 - e) / (1 + e), f), Math.tan(.5 * (d - b)) / e
                }
            }, {}],
            25: [function(a, b, c) {
                c.wgs84 = {
                    towgs84: "0,0,0",
                    ellipse: "WGS84",
                    datumName: "WGS84"
                }, c.ch1903 = {
                    towgs84: "674.374,15.056,405.346",
                    ellipse: "bessel",
                    datumName: "swiss"
                }, c.ggrs87 = {
                    towgs84: "-199.87,74.79,246.62",
                    ellipse: "GRS80",
                    datumName: "Greek_Geodetic_Reference_System_1987"
                }, c.nad83 = {
                    towgs84: "0,0,0",
                    ellipse: "GRS80",
                    datumName: "North_American_Datum_1983"
                }, c.nad27 = {
                    nadgrids: "@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",
                    ellipse: "clrk66",
                    datumName: "North_American_Datum_1927"
                }, c.potsdam = {
                    towgs84: "606.0,23.0,413.0",
                    ellipse: "bessel",
                    datumName: "Potsdam Rauenberg 1950 DHDN"
                }, c.carthage = {
                    towgs84: "-263.0,6.0,431.0",
                    ellipse: "clark80",
                    datumName: "Carthage 1934 Tunisia"
                }, c.hermannskogel = {
                    towgs84: "653.0,-212.0,449.0",
                    ellipse: "bessel",
                    datumName: "Hermannskogel"
                }, c.ire65 = {
                    towgs84: "482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",
                    ellipse: "mod_airy",
                    datumName: "Ireland 1965"
                }, c.rassadiran = {
                    towgs84: "-133.63,-157.5,-158.62",
                    ellipse: "intl",
                    datumName: "Rassadiran"
                }, c.nzgd49 = {
                    towgs84: "59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",
                    ellipse: "intl",
                    datumName: "New Zealand Geodetic Datum 1949"
                }, c.osgb36 = {
                    towgs84: "446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",
                    ellipse: "airy",
                    datumName: "Airy 1830"
                }, c.s_jtsk = {
                    towgs84: "589,76,480",
                    ellipse: "bessel",
                    datumName: "S-JTSK (Ferro)"
                }, c.beduaram = {
                    towgs84: "-106,-87,188",
                    ellipse: "clrk80",
                    datumName: "Beduaram"
                }, c.gunung_segara = {
                    towgs84: "-403,684,41",
                    ellipse: "bessel",
                    datumName: "Gunung Segara Jakarta"
                }, c.rnb72 = {
                    towgs84: "106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",
                    ellipse: "intl",
                    datumName: "Reseau National Belge 1972"
                }
            }, {}],
            26: [function(a, b, c) {
                c.MERIT = {
                    a: 6378137,
                    rf: 298.257,
                    ellipseName: "MERIT 1983"
                }, c.SGS85 = {
                    a: 6378136,
                    rf: 298.257,
                    ellipseName: "Soviet Geodetic System 85"
                }, c.GRS80 = {
                    a: 6378137,
                    rf: 298.257222101,
                    ellipseName: "GRS 1980(IUGG, 1980)"
                }, c.IAU76 = {
                    a: 6378140,
                    rf: 298.257,
                    ellipseName: "IAU 1976"
                }, c.airy = {
                    a: 6377563.396,
                    b: 6356256.91,
                    ellipseName: "Airy 1830"
                }, c.APL4 = {
                    a: 6378137,
                    rf: 298.25,
                    ellipseName: "Appl. Physics. 1965"
                }, c.NWL9D = {
                    a: 6378145,
                    rf: 298.25,
                    ellipseName: "Naval Weapons Lab., 1965"
                }, c.mod_airy = {
                    a: 6377340.189,
                    b: 6356034.446,
                    ellipseName: "Modified Airy"
                }, c.andrae = {
                    a: 6377104.43,
                    rf: 300,
                    ellipseName: "Andrae 1876 (Den., Iclnd.)"
                }, c.aust_SA = {
                    a: 6378160,
                    rf: 298.25,
                    ellipseName: "Australian Natl & S. Amer. 1969"
                }, c.GRS67 = {
                    a: 6378160,
                    rf: 298.247167427,
                    ellipseName: "GRS 67(IUGG 1967)"
                }, c.bessel = {
                    a: 6377397.155,
                    rf: 299.1528128,
                    ellipseName: "Bessel 1841"
                }, c.bess_nam = {
                    a: 6377483.865,
                    rf: 299.1528128,
                    ellipseName: "Bessel 1841 (Namibia)"
                }, c.clrk66 = {
                    a: 6378206.4,
                    b: 6356583.8,
                    ellipseName: "Clarke 1866"
                }, c.clrk80 = {
                    a: 6378249.145,
                    rf: 293.4663,
                    ellipseName: "Clarke 1880 mod."
                }, c.clrk58 = {
                    a: 6378293.645208759,
                    rf: 294.2606763692654,
                    ellipseName: "Clarke 1858"
                }, c.CPM = {
                    a: 6375738.7,
                    rf: 334.29,
                    ellipseName: "Comm. des Poids et Mesures 1799"
                }, c.delmbr = {
                    a: 6376428,
                    rf: 311.5,
                    ellipseName: "Delambre 1810 (Belgium)"
                }, c.engelis = {
                    a: 6378136.05,
                    rf: 298.2566,
                    ellipseName: "Engelis 1985"
                }, c.evrst30 = {
                    a: 6377276.345,
                    rf: 300.8017,
                    ellipseName: "Everest 1830"
                }, c.evrst48 = {
                    a: 6377304.063,
                    rf: 300.8017,
                    ellipseName: "Everest 1948"
                }, c.evrst56 = {
                    a: 6377301.243,
                    rf: 300.8017,
                    ellipseName: "Everest 1956"
                }, c.evrst69 = {
                    a: 6377295.664,
                    rf: 300.8017,
                    ellipseName: "Everest 1969"
                }, c.evrstSS = {
                    a: 6377298.556,
                    rf: 300.8017,
                    ellipseName: "Everest (Sabah & Sarawak)"
                }, c.fschr60 = {
                    a: 6378166,
                    rf: 298.3,
                    ellipseName: "Fischer (Mercury Datum) 1960"
                }, c.fschr60m = {
                    a: 6378155,
                    rf: 298.3,
                    ellipseName: "Fischer 1960"
                }, c.fschr68 = {
                    a: 6378150,
                    rf: 298.3,
                    ellipseName: "Fischer 1968"
                }, c.helmert = {
                    a: 6378200,
                    rf: 298.3,
                    ellipseName: "Helmert 1906"
                }, c.hough = {
                    a: 6378270,
                    rf: 297,
                    ellipseName: "Hough"
                }, c.intl = {
                    a: 6378388,
                    rf: 297,
                    ellipseName: "International 1909 (Hayford)"
                }, c.kaula = {
                    a: 6378163,
                    rf: 298.24,
                    ellipseName: "Kaula 1961"
                }, c.lerch = {
                    a: 6378139,
                    rf: 298.257,
                    ellipseName: "Lerch 1979"
                }, c.mprts = {
                    a: 6397300,
                    rf: 191,
                    ellipseName: "Maupertius 1738"
                }, c.new_intl = {
                    a: 6378157.5,
                    b: 6356772.2,
                    ellipseName: "New International 1967"
                }, c.plessis = {
                    a: 6376523,
                    rf: 6355863,
                    ellipseName: "Plessis 1817 (France)"
                }, c.krass = {
                    a: 6378245,
                    rf: 298.3,
                    ellipseName: "Krassovsky, 1942"
                }, c.SEasia = {
                    a: 6378155,
                    b: 6356773.3205,
                    ellipseName: "Southeast Asia"
                }, c.walbeck = {
                    a: 6376896,
                    b: 6355834.8467,
                    ellipseName: "Walbeck"
                }, c.WGS60 = {
                    a: 6378165,
                    rf: 298.3,
                    ellipseName: "WGS 60"
                }, c.WGS66 = {
                    a: 6378145,
                    rf: 298.25,
                    ellipseName: "WGS 66"
                }, c.WGS7 = {
                    a: 6378135,
                    rf: 298.26,
                    ellipseName: "WGS 72"
                }, c.WGS84 = {
                    a: 6378137,
                    rf: 298.257223563,
                    ellipseName: "WGS 84"
                }, c.sphere = {
                    a: 6370997,
                    b: 6370997,
                    ellipseName: "Normal Sphere (r=6370997)"
                }
            }, {}],
            27: [function(a, b, c) {
                c.greenwich = 0, c.lisbon = -9.131906111111, c.paris = 2.337229166667, c.bogota = -74.080916666667, c.madrid = -3.687938888889, c.rome = 12.452333333333, c.bern = 7.439583333333, c.jakarta = 106.807719444444, c.ferro = -17.666666666667, c.brussels = 4.367975, c.stockholm = 18.058277777778, c.athens = 23.7163375, c.oslo = 10.722916666667
            }, {}],
            28: [function(a, b, c) {
                c.ft = {
                    to_meter: .3048
                }, c["us-ft"] = {
                    to_meter: 1200 / 3937
                }
            }, {}],
            29: [function(a, b, c) {
                function d(a, b, c) {
                    var d;
                    return Array.isArray(c) ? (d = h(a, b, c), 3 === c.length ? [d.x, d.y, d.z] : [d.x, d.y]) : h(a, b, c)
                }

                function e(a) {
                    return a instanceof g ? a : a.oProj ? a.oProj : g(a)
                }

                function f(a, b, c) {
                    a = e(a);
                    var g, f = !1;
                    return "undefined" == typeof b ? (b = a, a = i, f = !0) : ("undefined" != typeof b.x || Array.isArray(b)) && (c = b, b = a, a = i, f = !0), b = e(b), c ? d(a, b, c) : (g = {
                        forward: function(c) {
                            return d(a, b, c)
                        },
                        inverse: function(c) {
                            return d(b, a, c)
                        }
                    }, f && (g.oProj = b), g)
                }
                var g = a("./Proj"),
                    h = a("./transform"),
                    i = g("WGS84");
                b.exports = f
            }, {
                "./Proj": 2,
                "./transform": 65
            }],
            30: [function(a, b, c) {
                var d = Math.PI / 2,
                    e = 1,
                    f = 2,
                    g = 3,
                    h = 4,
                    i = 5,
                    j = 484813681109536e-20,
                    k = 1.0026,
                    l = .3826834323650898,
                    m = function(a) {
                        return this instanceof m ? (this.datum_type = h, void(a && (a.datumCode && "none" === a.datumCode && (this.datum_type = i), a.datum_params && (this.datum_params = a.datum_params.map(parseFloat), 0 === this.datum_params[0] && 0 === this.datum_params[1] && 0 === this.datum_params[2] || (this.datum_type = e), this.datum_params.length > 3 && (0 !== this.datum_params[3] || 0 !== this.datum_params[4] || 0 !== this.datum_params[5] || 0 !== this.datum_params[6]) && (this.datum_type = f, this.datum_params[3] *= j, this.datum_params[4] *= j, this.datum_params[5] *= j, this.datum_params[6] = this.datum_params[6] / 1e6 + 1)), this.datum_type = a.grids ? g : this.datum_type, this.a = a.a, this.b = a.b, this.es = a.es, this.ep2 = a.ep2, this.datum_type === g && (this.grids = a.grids)))) : new m(a)
                    };
                m.prototype = {
                    compare_datums: function(a) {
                        return this.datum_type === a.datum_type && (!(this.a !== a.a || Math.abs(this.es - a.es) > 5e-11) && (this.datum_type === e ? this.datum_params[0] === a.datum_params[0] && this.datum_params[1] === a.datum_params[1] && this.datum_params[2] === a.datum_params[2] : this.datum_type === f ? this.datum_params[0] === a.datum_params[0] && this.datum_params[1] === a.datum_params[1] && this.datum_params[2] === a.datum_params[2] && this.datum_params[3] === a.datum_params[3] && this.datum_params[4] === a.datum_params[4] && this.datum_params[5] === a.datum_params[5] && this.datum_params[6] === a.datum_params[6] : this.datum_type !== g && a.datum_type !== g || this.nadgrids === a.nadgrids))
                    },
                    geodetic_to_geocentric: function(a) {
                        var f, g, h, j, k, l, m, b = a.x,
                            c = a.y,
                            e = a.z ? a.z : 0,
                            i = 0;
                        if (c < -d && c > -1.001 * d) c = -d;
                        else if (c > d && c < 1.001 * d) c = d;
                        else if (c < -d || c > d) return null;
                        return b > Math.PI && (b -= 2 * Math.PI),
                            k = Math.sin(c), m = Math.cos(c), l = k * k, j = this.a / Math.sqrt(1 - this.es * l), f = (j + e) * m * Math.cos(b), g = (j + e) * m * Math.sin(b), h = (j * (1 - this.es) + e) * k, a.x = f, a.y = g, a.z = h, i
                    },
                    geocentric_to_geodetic: function(a) {
                        var f, g, h, i, j, k, l, m, n, o, p, q, r, s, w, x, y, b = 1e-12,
                            c = b * b,
                            e = 30,
                            t = a.x,
                            u = a.y,
                            v = a.z ? a.z : 0;
                        if (r = !1, f = Math.sqrt(t * t + u * u), g = Math.sqrt(t * t + u * u + v * v), f / this.a < b) {
                            if (r = !0, w = 0, g / this.a < b) return x = d, void(y = -this.b)
                        } else w = Math.atan2(u, t);
                        h = v / g, i = f / g, j = 1 / Math.sqrt(1 - this.es * (2 - this.es) * i * i), m = i * (1 - this.es) * j, n = h * j, s = 0;
                        do s++, l = this.a / Math.sqrt(1 - this.es * n * n), y = f * m + v * n - l * (1 - this.es * n * n), k = this.es * l / (l + y), j = 1 / Math.sqrt(1 - k * (2 - k) * i * i), o = i * (1 - k) * j, p = h * j, q = p * m - o * n, m = o, n = p; while (q * q > c && s < e);
                        return x = Math.atan(p / Math.abs(o)), a.x = w, a.y = x, a.z = y, a
                    },
                    geocentric_to_geodetic_noniter: function(a) {
                        var f, g, h, i, j, m, n, o, p, q, r, s, t, u, v, w, x, b = a.x,
                            c = a.y,
                            e = a.z ? a.z : 0;
                        if (b = parseFloat(b), c = parseFloat(c), e = parseFloat(e), x = !1, 0 !== b) f = Math.atan2(c, b);
                        else if (c > 0) f = d;
                        else if (c < 0) f = -d;
                        else if (x = !0, f = 0, e > 0) g = d;
                        else {
                            if (!(e < 0)) return g = d, void(h = -this.b);
                            g = -d
                        }
                        return j = b * b + c * c, i = Math.sqrt(j), m = e * k, o = Math.sqrt(m * m + j), q = m / o, s = i / o, r = q * q * q, n = e + this.b * this.ep2 * r, w = i - this.a * this.es * s * s * s, p = Math.sqrt(n * n + w * w), t = n / p, u = w / p, v = this.a / Math.sqrt(1 - this.es * t * t), h = u >= l ? i / u - v : u <= -l ? i / -u - v : e / t + v * (this.es - 1), x === !1 && (g = Math.atan(t / u)), a.x = f, a.y = g, a.z = h, a
                    },
                    geocentric_to_wgs84: function(a) {
                        if (this.datum_type === e) a.x += this.datum_params[0], a.y += this.datum_params[1], a.z += this.datum_params[2];
                        else if (this.datum_type === f) {
                            var b = this.datum_params[0],
                                c = this.datum_params[1],
                                d = this.datum_params[2],
                                g = this.datum_params[3],
                                h = this.datum_params[4],
                                i = this.datum_params[5],
                                j = this.datum_params[6],
                                k = j * (a.x - i * a.y + h * a.z) + b,
                                l = j * (i * a.x + a.y - g * a.z) + c,
                                m = j * (-h * a.x + g * a.y + a.z) + d;
                            a.x = k, a.y = l, a.z = m
                        }
                    },
                    geocentric_from_wgs84: function(a) {
                        if (this.datum_type === e) a.x -= this.datum_params[0], a.y -= this.datum_params[1], a.z -= this.datum_params[2];
                        else if (this.datum_type === f) {
                            var b = this.datum_params[0],
                                c = this.datum_params[1],
                                d = this.datum_params[2],
                                g = this.datum_params[3],
                                h = this.datum_params[4],
                                i = this.datum_params[5],
                                j = this.datum_params[6],
                                k = (a.x - b) / j,
                                l = (a.y - c) / j,
                                m = (a.z - d) / j;
                            a.x = k + i * l - h * m, a.y = -i * k + l + g * m, a.z = h * k - g * l + m
                        }
                    }
                }, b.exports = m
            }, {}],
            31: [function(a, b, c) {
                var d = 1,
                    e = 2,
                    f = 3,
                    g = 5,
                    h = 6378137,
                    i = .006694379990141316;
                b.exports = function(a, b, c) {
                    function j(a) {
                        return a === d || a === e
                    }
                    var k, l, m;
                    if (a.compare_datums(b)) return c;
                    if (a.datum_type === g || b.datum_type === g) return c;
                    var n = a.a,
                        o = a.es,
                        p = b.a,
                        q = b.es,
                        r = a.datum_type;
                    if (r === f)
                        if (0 === this.apply_gridshift(a, 0, c)) a.a = h, a.es = i;
                        else {
                            if (!a.datum_params) return a.a = n, a.es = a.es, c;
                            for (k = 1, l = 0, m = a.datum_params.length; l < m; l++) k *= a.datum_params[l];
                            if (0 === k) return a.a = n, a.es = a.es, c;
                            r = a.datum_params.length > 3 ? e : d
                        }
                    return b.datum_type === f && (b.a = h, b.es = i), (a.es !== b.es || a.a !== b.a || j(r) || j(b.datum_type)) && (a.geodetic_to_geocentric(c), j(a.datum_type) && a.geocentric_to_wgs84(c), j(b.datum_type) && b.geocentric_from_wgs84(c), b.geocentric_to_geodetic(c)), b.datum_type === f && this.apply_gridshift(b, 1, c), a.a = n, a.es = o, b.a = p, b.es = q, c
                }
            }, {}],
            32: [function(a, b, c) {
                function d(a) {
                    var b = this;
                    if (2 === arguments.length) {
                        var c = arguments[1];
                        "string" == typeof c ? "+" === c.charAt(0) ? d[a] = f(arguments[1]) : d[a] = g(arguments[1]) : d[a] = c
                    } else if (1 === arguments.length) {
                        if (Array.isArray(a)) return a.map(function(a) {
                            Array.isArray(a) ? d.apply(b, a) : d(a)
                        });
                        if ("string" == typeof a) {
                            if (a in d) return d[a]
                        } else "EPSG" in a ? d["EPSG:" + a.EPSG] = a : "ESRI" in a ? d["ESRI:" + a.ESRI] = a : "IAU2000" in a ? d["IAU2000:" + a.IAU2000] = a : console.log(a);
                        return
                    }
                }
                var e = a("./global"),
                    f = a("./projString"),
                    g = a("./wkt");
                e(d), b.exports = d
            }, {
                "./global": 35,
                "./projString": 38,
                "./wkt": 66
            }],
            33: [function(a, b, c) {
                var d = a("./constants/Datum"),
                    e = a("./constants/Ellipsoid"),
                    f = a("./extend"),
                    g = a("./datum"),
                    h = 1e-10,
                    i = .16666666666666666,
                    j = .04722222222222222,
                    k = .022156084656084655;
                b.exports = function(a) {
                    if (a.datumCode && "none" !== a.datumCode) {
                        var b = d[a.datumCode];
                        b && (a.datum_params = b.towgs84 ? b.towgs84.split(",") : null, a.ellps = b.ellipse, a.datumName = b.datumName ? b.datumName : a.datumCode)
                    }
                    if (!a.a) {
                        var c = e[a.ellps] ? e[a.ellps] : e.WGS84;
                        f(a, c)
                    }
                    return a.rf && !a.b && (a.b = (1 - 1 / a.rf) * a.a), (0 === a.rf || Math.abs(a.a - a.b) < h) && (a.sphere = !0, a.b = a.a), a.a2 = a.a * a.a, a.b2 = a.b * a.b, a.es = (a.a2 - a.b2) / a.a2, a.e = Math.sqrt(a.es), a.R_A && (a.a *= 1 - a.es * (i + a.es * (j + a.es * k)), a.a2 = a.a * a.a, a.b2 = a.b * a.b, a.es = 0), a.ep2 = (a.a2 - a.b2) / a.b2, a.k0 || (a.k0 = 1), a.axis || (a.axis = "enu"), a.datum || (a.datum = g(a)), a
                }
            }, {
                "./constants/Datum": 25,
                "./constants/Ellipsoid": 26,
                "./datum": 30,
                "./extend": 34
            }],
            34: [function(a, b, c) {
                b.exports = function(a, b) {
                    a = a || {};
                    var c, d;
                    if (!b) return a;
                    for (d in b) c = b[d], void 0 !== c && (a[d] = c);
                    return a
                }
            }, {}],
            35: [function(a, b, c) {
                b.exports = function(a) {
                    a("EPSG:4326", "+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"), a("EPSG:4269", "+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"), a("EPSG:3857", "+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"), a.WGS84 = a["EPSG:4326"], a["EPSG:3785"] = a["EPSG:3857"], a.GOOGLE = a["EPSG:3857"], a["EPSG:900913"] = a["EPSG:3857"], a["EPSG:102113"] = a["EPSG:3857"]
                }
            }, {}],
            36: [function(a, b, c) {
                var d = a("./core");
                d.defaultDatum = "WGS84", d.Proj = a("./Proj"), d.WGS84 = new d.Proj("WGS84"), d.Point = a("./Point"), d.toPoint = a("./common/toPoint"), d.defs = a("./defs"), d.transform = a("./transform"), d.mgrs = a("mgrs"), d.version = a("../package.json").version, a("./includedProjections")(d), b.exports = d
            }, {
                "../package.json": 68,
                "./Point": 1,
                "./Proj": 2,
                "./common/toPoint": 23,
                "./core": 29,
                "./defs": 32,
                "./includedProjections": "hTEDpn",
                "./transform": 65,
                mgrs: 67
            }],
            37: [function(a, b, c) {
                function d(a) {
                    return "string" == typeof a
                }

                function e(a) {
                    return a in i
                }

                function f(a) {
                    var b = ["GEOGCS", "GEOCCS", "PROJCS", "LOCAL_CS"];
                    return b.reduce(function(b, c) {
                        return b + 1 + a.indexOf(c)
                    }, 0)
                }

                function g(a) {
                    return "+" === a[0]
                }

                function h(a) {
                    return d(a) ? e(a) ? i[a] : f(a) ? j(a) : g(a) ? k(a) : void 0 : a
                }
                var i = a("./defs"),
                    j = a("./wkt"),
                    k = a("./projString");
                b.exports = h
            }, {
                "./defs": 32,
                "./projString": 38,
                "./wkt": 66
            }],
            38: [function(a, b, c) {
                var d = .017453292519943295,
                    e = a("./constants/PrimeMeridian"),
                    f = a("./constants/units");
                b.exports = function(a) {
                    var b = {},
                        c = {};
                    a.split("+").map(function(a) {
                        return a.trim()
                    }).filter(function(a) {
                        return a
                    }).forEach(function(a) {
                        var b = a.split("=");
                        b.push(!0), c[b[0].toLowerCase()] = b[1]
                    });
                    var g, h, i, j = {
                        proj: "projName",
                        datum: "datumCode",
                        rf: function(a) {
                            b.rf = parseFloat(a)
                        },
                        lat_0: function(a) {
                            b.lat0 = a * d
                        },
                        lat_1: function(a) {
                            b.lat1 = a * d
                        },
                        lat_2: function(a) {
                            b.lat2 = a * d
                        },
                        lat_ts: function(a) {
                            b.lat_ts = a * d
                        },
                        lon_0: function(a) {
                            b.long0 = a * d
                        },
                        lon_1: function(a) {
                            b.long1 = a * d
                        },
                        lon_2: function(a) {
                            b.long2 = a * d
                        },
                        alpha: function(a) {
                            b.alpha = parseFloat(a) * d
                        },
                        lonc: function(a) {
                            b.longc = a * d
                        },
                        x_0: function(a) {
                            b.x0 = parseFloat(a)
                        },
                        y_0: function(a) {
                            b.y0 = parseFloat(a)
                        },
                        k_0: function(a) {
                            b.k0 = parseFloat(a)
                        },
                        k: function(a) {
                            b.k0 = parseFloat(a)
                        },
                        a: function(a) {
                            b.a = parseFloat(a)
                        },
                        b: function(a) {
                            b.b = parseFloat(a)
                        },
                        r_a: function() {
                            b.R_A = !0
                        },
                        zone: function(a) {
                            b.zone = parseInt(a, 10)
                        },
                        south: function() {
                            b.utmSouth = !0
                        },
                        towgs84: function(a) {
                            b.datum_params = a.split(",").map(function(a) {
                                return parseFloat(a)
                            })
                        },
                        to_meter: function(a) {
                            b.to_meter = parseFloat(a)
                        },
                        units: function(a) {
                            b.units = a, f[a] && (b.to_meter = f[a].to_meter)
                        },
                        from_greenwich: function(a) {
                            b.from_greenwich = a * d
                        },
                        pm: function(a) {
                            b.from_greenwich = (e[a] ? e[a] : parseFloat(a)) * d
                        },
                        nadgrids: function(a) {
                            "@null" === a ? b.datumCode = "none" : b.nadgrids = a
                        },
                        axis: function(a) {
                            var c = "ewnsud";
                            3 === a.length && c.indexOf(a.substr(0, 1)) !== -1 && c.indexOf(a.substr(1, 1)) !== -1 && c.indexOf(a.substr(2, 1)) !== -1 && (b.axis = a)
                        }
                    };
                    for (g in c) h = c[g], g in j ? (i = j[g], "function" == typeof i ? i(h) : b[i] = h) : b[g] = h;
                    return "string" == typeof b.datumCode && "WGS84" !== b.datumCode && (b.datumCode = b.datumCode.toLowerCase()), b
                }
            }, {
                "./constants/PrimeMeridian": 27,
                "./constants/units": 28
            }],
            39: [function(a, b, c) {
                function d(a, b) {
                    var c = g.length;
                    return a.names ? (g[c] = a, a.names.forEach(function(a) {
                        f[a.toLowerCase()] = c
                    }), this) : (console.log(b), !0)
                }
                var e = [a("./projections/merc"), a("./projections/longlat")],
                    f = {},
                    g = [];
                c.add = d, c.get = function(a) {
                    if (!a) return !1;
                    var b = a.toLowerCase();
                    return "undefined" != typeof f[b] && g[f[b]] ? g[f[b]] : void 0
                }, c.start = function() {
                    e.forEach(d)
                }
            }, {
                "./projections/longlat": 51,
                "./projections/merc": 52
            }],
            40: [function(a, b, c) {
                var d = 1e-10,
                    e = a("../common/msfnz"),
                    f = a("../common/qsfnz"),
                    g = a("../common/adjust_lon"),
                    h = a("../common/asinz");
                c.init = function() {
                    Math.abs(this.lat1 + this.lat2) < d || (this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e3 = Math.sqrt(this.es), this.sin_po = Math.sin(this.lat1), this.cos_po = Math.cos(this.lat1), this.t1 = this.sin_po, this.con = this.sin_po, this.ms1 = e(this.e3, this.sin_po, this.cos_po), this.qs1 = f(this.e3, this.sin_po, this.cos_po), this.sin_po = Math.sin(this.lat2), this.cos_po = Math.cos(this.lat2), this.t2 = this.sin_po, this.ms2 = e(this.e3, this.sin_po, this.cos_po), this.qs2 = f(this.e3, this.sin_po, this.cos_po), this.sin_po = Math.sin(this.lat0), this.cos_po = Math.cos(this.lat0), this.t3 = this.sin_po, this.qs0 = f(this.e3, this.sin_po, this.cos_po), Math.abs(this.lat1 - this.lat2) > d ? this.ns0 = (this.ms1 * this.ms1 - this.ms2 * this.ms2) / (this.qs2 - this.qs1) : this.ns0 = this.con, this.c = this.ms1 * this.ms1 + this.ns0 * this.qs1, this.rh = this.a * Math.sqrt(this.c - this.ns0 * this.qs0) / this.ns0)
                }, c.forward = function(a) {
                    var b = a.x,
                        c = a.y;
                    this.sin_phi = Math.sin(c), this.cos_phi = Math.cos(c);
                    var d = f(this.e3, this.sin_phi, this.cos_phi),
                        e = this.a * Math.sqrt(this.c - this.ns0 * d) / this.ns0,
                        h = this.ns0 * g(b - this.long0),
                        i = e * Math.sin(h) + this.x0,
                        j = this.rh - e * Math.cos(h) + this.y0;
                    return a.x = i, a.y = j, a
                }, c.inverse = function(a) {
                    var b, c, d, e, f, h;
                    return a.x -= this.x0, a.y = this.rh - a.y + this.y0, this.ns0 >= 0 ? (b = Math.sqrt(a.x * a.x + a.y * a.y), d = 1) : (b = -Math.sqrt(a.x * a.x + a.y * a.y), d = -1), e = 0, 0 !== b && (e = Math.atan2(d * a.x, d * a.y)), d = b * this.ns0 / this.a, this.sphere ? h = Math.asin((this.c - d * d) / (2 * this.ns0)) : (c = (this.c - d * d) / this.ns0, h = this.phi1z(this.e3, c)), f = g(e / this.ns0 + this.long0), a.x = f, a.y = h, a
                }, c.phi1z = function(a, b) {
                    var c, e, f, g, i, j = h(.5 * b);
                    if (a < d) return j;
                    for (var k = a * a, l = 1; l <= 25; l++)
                        if (c = Math.sin(j), e = Math.cos(j), f = a * c, g = 1 - f * f, i = .5 * g * g / e * (b / (1 - k) - c / g + .5 / a * Math.log((1 - f) / (1 + f))), j += i, Math.abs(i) <= 1e-7) return j;
                    return null
                }, c.names = ["Albers_Conic_Equal_Area", "Albers", "aea"]
            }, {
                "../common/adjust_lon": 5,
                "../common/asinz": 6,
                "../common/msfnz": 15,
                "../common/qsfnz": 20
            }],
            41: [function(a, b, c) {
                var d = a("../common/adjust_lon"),
                    e = Math.PI / 2,
                    f = 1e-10,
                    g = a("../common/mlfn"),
                    h = a("../common/e0fn"),
                    i = a("../common/e1fn"),
                    j = a("../common/e2fn"),
                    k = a("../common/e3fn"),
                    l = a("../common/gN"),
                    m = a("../common/asinz"),
                    n = a("../common/imlfn");
                c.init = function() {
                    this.sin_p12 = Math.sin(this.lat0), this.cos_p12 = Math.cos(this.lat0)
                }, c.forward = function(a) {
                    var p, q, r, s, t, u, v, w, x, y, z, A, B, C, D, E, F, G, H, I, J, K, L, b = a.x,
                        c = a.y,
                        m = Math.sin(a.y),
                        n = Math.cos(a.y),
                        o = d(b - this.long0);
                    return this.sphere ? Math.abs(this.sin_p12 - 1) <= f ? (a.x = this.x0 + this.a * (e - c) * Math.sin(o), a.y = this.y0 - this.a * (e - c) * Math.cos(o), a) : Math.abs(this.sin_p12 + 1) <= f ? (a.x = this.x0 + this.a * (e + c) * Math.sin(o), a.y = this.y0 + this.a * (e + c) * Math.cos(o), a) : (G = this.sin_p12 * m + this.cos_p12 * n * Math.cos(o), E = Math.acos(G), F = E / Math.sin(E), a.x = this.x0 + this.a * F * n * Math.sin(o), a.y = this.y0 + this.a * F * (this.cos_p12 * m - this.sin_p12 * n * Math.cos(o)), a) : (p = h(this.es), q = i(this.es), r = j(this.es), s = k(this.es), Math.abs(this.sin_p12 - 1) <= f ? (t = this.a * g(p, q, r, s, e), u = this.a * g(p, q, r, s, c), a.x = this.x0 + (t - u) * Math.sin(o), a.y = this.y0 - (t - u) * Math.cos(o), a) : Math.abs(this.sin_p12 + 1) <= f ? (t = this.a * g(p, q, r, s, e), u = this.a * g(p, q, r, s, c), a.x = this.x0 + (t + u) * Math.sin(o), a.y = this.y0 + (t + u) * Math.cos(o), a) : (v = m / n, w = l(this.a, this.e, this.sin_p12), x = l(this.a, this.e, m), y = Math.atan((1 - this.es) * v + this.es * w * this.sin_p12 / (x * n)), z = Math.atan2(Math.sin(o), this.cos_p12 * Math.tan(y) - this.sin_p12 * Math.cos(o)), H = 0 === z ? Math.asin(this.cos_p12 * Math.sin(y) - this.sin_p12 * Math.cos(y)) : Math.abs(Math.abs(z) - Math.PI) <= f ? -Math.asin(this.cos_p12 * Math.sin(y) - this.sin_p12 * Math.cos(y)) : Math.asin(Math.sin(o) * Math.cos(y) / Math.sin(z)), A = this.e * this.sin_p12 / Math.sqrt(1 - this.es), B = this.e * this.cos_p12 * Math.cos(z) / Math.sqrt(1 - this.es), C = A * B, D = B * B, I = H * H, J = I * H, K = J * H, L = K * H, E = w * H * (1 - I * D * (1 - D) / 6 + J / 8 * C * (1 - 2 * D) + K / 120 * (D * (4 - 7 * D) - 3 * A * A * (1 - 7 * D)) - L / 48 * C), a.x = this.x0 + E * Math.sin(z), a.y = this.y0 + E * Math.cos(z), a))
                }, c.inverse = function(a) {
                    a.x -= this.x0, a.y -= this.y0;
                    var b, c, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C, D, E, F, G, H, I;
                    if (this.sphere) {
                        if (b = Math.sqrt(a.x * a.x + a.y * a.y), b > 2 * e * this.a) return;
                        return c = b / this.a, o = Math.sin(c), p = Math.cos(c), q = this.long0, Math.abs(b) <= f ? r = this.lat0 : (r = m(p * this.sin_p12 + a.y * o * this.cos_p12 / b), s = Math.abs(this.lat0) - e, q = d(Math.abs(s) <= f ? this.lat0 >= 0 ? this.long0 + Math.atan2(a.x, -a.y) : this.long0 - Math.atan2(-a.x, a.y) : this.long0 + Math.atan2(a.x * o, b * this.cos_p12 * p - a.y * this.sin_p12 * o))), a.x = q, a.y = r, a
                    }
                    return t = h(this.es), u = i(this.es), v = j(this.es), w = k(this.es), Math.abs(this.sin_p12 - 1) <= f ? (x = this.a * g(t, u, v, w, e), b = Math.sqrt(a.x * a.x + a.y * a.y), y = x - b, r = n(y / this.a, t, u, v, w), q = d(this.long0 + Math.atan2(a.x, -1 * a.y)), a.x = q, a.y = r, a) : Math.abs(this.sin_p12 + 1) <= f ? (x = this.a * g(t, u, v, w, e), b = Math.sqrt(a.x * a.x + a.y * a.y), y = b - x, r = n(y / this.a, t, u, v, w), q = d(this.long0 + Math.atan2(a.x, a.y)), a.x = q, a.y = r, a) : (b = Math.sqrt(a.x * a.x + a.y * a.y), B = Math.atan2(a.x, a.y), z = l(this.a, this.e, this.sin_p12), C = Math.cos(B), D = this.e * this.cos_p12 * C, E = -D * D / (1 - this.es), F = 3 * this.es * (1 - E) * this.sin_p12 * this.cos_p12 * C / (1 - this.es), G = b / z, H = G - E * (1 + E) * Math.pow(G, 3) / 6 - F * (1 + 3 * E) * Math.pow(G, 4) / 24, I = 1 - E * H * H / 2 - G * H * H * H / 6, A = Math.asin(this.sin_p12 * Math.cos(H) + this.cos_p12 * Math.sin(H) * C), q = d(this.long0 + Math.asin(Math.sin(B) * Math.sin(H) / Math.cos(A))), r = Math.atan((1 - this.es * I * this.sin_p12 / Math.sin(A)) * Math.tan(A) / (1 - this.es)), a.x = q, a.y = r, a)
                }, c.names = ["Azimuthal_Equidistant", "aeqd"]
            }, {
                "../common/adjust_lon": 5,
                "../common/asinz": 6,
                "../common/e0fn": 7,
                "../common/e1fn": 8,
                "../common/e2fn": 9,
                "../common/e3fn": 10,
                "../common/gN": 11,
                "../common/imlfn": 12,
                "../common/mlfn": 14
            }],
            42: [function(a, b, c) {
                var d = a("../common/mlfn"),
                    e = a("../common/e0fn"),
                    f = a("../common/e1fn"),
                    g = a("../common/e2fn"),
                    h = a("../common/e3fn"),
                    i = a("../common/gN"),
                    j = a("../common/adjust_lon"),
                    k = a("../common/adjust_lat"),
                    l = a("../common/imlfn"),
                    m = Math.PI / 2,
                    n = 1e-10;
                c.init = function() {
                    this.sphere || (this.e0 = e(this.es), this.e1 = f(this.es), this.e2 = g(this.es), this.e3 = h(this.es), this.ml0 = this.a * d(this.e0, this.e1, this.e2, this.e3, this.lat0))
                }, c.forward = function(a) {
                    var b, c, e = a.x,
                        f = a.y;
                    if (e = j(e - this.long0), this.sphere) b = this.a * Math.asin(Math.cos(f) * Math.sin(e)), c = this.a * (Math.atan2(Math.tan(f), Math.cos(e)) - this.lat0);
                    else {
                        var g = Math.sin(f),
                            h = Math.cos(f),
                            k = i(this.a, this.e, g),
                            l = Math.tan(f) * Math.tan(f),
                            m = e * Math.cos(f),
                            n = m * m,
                            o = this.es * h * h / (1 - this.es),
                            p = this.a * d(this.e0, this.e1, this.e2, this.e3, f);
                        b = k * m * (1 - n * l * (1 / 6 - (8 - l + 8 * o) * n / 120)), c = p - this.ml0 + k * g / h * n * (.5 + (5 - l + 6 * o) * n / 24)
                    }
                    return a.x = b + this.x0, a.y = c + this.y0, a
                }, c.inverse = function(a) {
                    a.x -= this.x0, a.y -= this.y0;
                    var d, e, b = a.x / this.a,
                        c = a.y / this.a;
                    if (this.sphere) {
                        var f = c + this.lat0;
                        d = Math.asin(Math.sin(f) * Math.cos(b)), e = Math.atan2(Math.tan(b), Math.cos(f))
                    } else {
                        var g = this.ml0 / this.a + c,
                            h = l(g, this.e0, this.e1, this.e2, this.e3);
                        if (Math.abs(Math.abs(h) - m) <= n) return a.x = this.long0, a.y = m, c < 0 && (a.y *= -1), a;
                        var o = i(this.a, this.e, Math.sin(h)),
                            p = o * o * o / this.a / this.a * (1 - this.es),
                            q = Math.pow(Math.tan(h), 2),
                            r = b * this.a / o,
                            s = r * r;
                        d = h - o * Math.tan(h) / p * r * r * (.5 - (1 + 3 * q) * r * r / 24), e = r * (1 - s * (q / 3 + (1 + 3 * q) * q * s / 15)) / Math.cos(h)
                    }
                    return a.x = j(e + this.long0), a.y = k(d), a
                }, c.names = ["Cassini", "Cassini_Soldner", "cass"]
            }, {
                "../common/adjust_lat": 4,
                "../common/adjust_lon": 5,
                "../common/e0fn": 7,
                "../common/e1fn": 8,
                "../common/e2fn": 9,
                "../common/e3fn": 10,
                "../common/gN": 11,
                "../common/imlfn": 12,
                "../common/mlfn": 14
            }],
            43: [function(a, b, c) {
                var d = a("../common/adjust_lon"),
                    e = a("../common/qsfnz"),
                    f = a("../common/msfnz"),
                    g = a("../common/iqsfnz");
                c.init = function() {
                    this.sphere || (this.k0 = f(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)))
                }, c.forward = function(a) {
                    var f, g, b = a.x,
                        c = a.y,
                        h = d(b - this.long0);
                    if (this.sphere) f = this.x0 + this.a * h * Math.cos(this.lat_ts), g = this.y0 + this.a * Math.sin(c) / Math.cos(this.lat_ts);
                    else {
                        var i = e(this.e, Math.sin(c));
                        f = this.x0 + this.a * this.k0 * h, g = this.y0 + this.a * i * .5 / this.k0
                    }
                    return a.x = f, a.y = g, a
                }, c.inverse = function(a) {
                    a.x -= this.x0, a.y -= this.y0;
                    var b, c;
                    return this.sphere ? (b = d(this.long0 + a.x / this.a / Math.cos(this.lat_ts)), c = Math.asin(a.y / this.a * Math.cos(this.lat_ts))) : (c = g(this.e, 2 * a.y * this.k0 / this.a), b = d(this.long0 + a.x / (this.a * this.k0))), a.x = b, a.y = c, a
                }, c.names = ["cea"]
            }, {
                "../common/adjust_lon": 5,
                "../common/iqsfnz": 13,
                "../common/msfnz": 15,
                "../common/qsfnz": 20
            }],
            44: [function(a, b, c) {
                var d = a("../common/adjust_lon"),
                    e = a("../common/adjust_lat");
                c.init = function() {
                    this.x0 = this.x0 || 0, this.y0 = this.y0 || 0, this.lat0 = this.lat0 || 0, this.long0 = this.long0 || 0, this.lat_ts = this.lat_ts || 0, this.title = this.title || "Equidistant Cylindrical (Plate Carre)", this.rc = Math.cos(this.lat_ts)
                }, c.forward = function(a) {
                    var b = a.x,
                        c = a.y,
                        f = d(b - this.long0),
                        g = e(c - this.lat0);
                    return a.x = this.x0 + this.a * f * this.rc, a.y = this.y0 + this.a * g, a
                }, c.inverse = function(a) {
                    var b = a.x,
                        c = a.y;
                    return a.x = d(this.long0 + (b - this.x0) / (this.a * this.rc)), a.y = e(this.lat0 + (c - this.y0) / this.a), a
                }, c.names = ["Equirectangular", "Equidistant_Cylindrical", "eqc"]
            }, {
                "../common/adjust_lat": 4,
                "../common/adjust_lon": 5
            }],
            45: [function(a, b, c) {
                var d = a("../common/e0fn"),
                    e = a("../common/e1fn"),
                    f = a("../common/e2fn"),
                    g = a("../common/e3fn"),
                    h = a("../common/msfnz"),
                    i = a("../common/mlfn"),
                    j = a("../common/adjust_lon"),
                    k = a("../common/adjust_lat"),
                    l = a("../common/imlfn"),
                    m = 1e-10;
                c.init = function() {
                    Math.abs(this.lat1 + this.lat2) < m || (this.lat2 = this.lat2 || this.lat1, this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e = Math.sqrt(this.es), this.e0 = d(this.es), this.e1 = e(this.es), this.e2 = f(this.es), this.e3 = g(this.es), this.sinphi = Math.sin(this.lat1), this.cosphi = Math.cos(this.lat1), this.ms1 = h(this.e, this.sinphi, this.cosphi), this.ml1 = i(this.e0, this.e1, this.e2, this.e3, this.lat1), Math.abs(this.lat1 - this.lat2) < m ? this.ns = this.sinphi : (this.sinphi = Math.sin(this.lat2), this.cosphi = Math.cos(this.lat2), this.ms2 = h(this.e, this.sinphi, this.cosphi), this.ml2 = i(this.e0, this.e1, this.e2, this.e3, this.lat2), this.ns = (this.ms1 - this.ms2) / (this.ml2 - this.ml1)), this.g = this.ml1 + this.ms1 / this.ns, this.ml0 = i(this.e0, this.e1, this.e2, this.e3, this.lat0), this.rh = this.a * (this.g - this.ml0))
                }, c.forward = function(a) {
                    var d, b = a.x,
                        c = a.y;
                    if (this.sphere) d = this.a * (this.g - c);
                    else {
                        var e = i(this.e0, this.e1, this.e2, this.e3, c);
                        d = this.a * (this.g - e)
                    }
                    var f = this.ns * j(b - this.long0),
                        g = this.x0 + d * Math.sin(f),
                        h = this.y0 + this.rh - d * Math.cos(f);
                    return a.x = g, a.y = h, a
                }, c.inverse = function(a) {
                    a.x -= this.x0, a.y = this.rh - a.y + this.y0;
                    var b, c, d, e;
                    this.ns >= 0 ? (c = Math.sqrt(a.x * a.x + a.y * a.y), b = 1) : (c = -Math.sqrt(a.x * a.x + a.y * a.y), b = -1);
                    var f = 0;
                    if (0 !== c && (f = Math.atan2(b * a.x, b * a.y)), this.sphere) return e = j(this.long0 + f / this.ns), d = k(this.g - c / this.a), a.x = e, a.y = d, a;
                    var g = this.g - c / this.a;
                    return d = l(g, this.e0, this.e1, this.e2, this.e3), e = j(this.long0 + f / this.ns), a.x = e, a.y = d, a
                }, c.names = ["Equidistant_Conic", "eqdc"]
            }, {
                "../common/adjust_lat": 4,
                "../common/adjust_lon": 5,
                "../common/e0fn": 7,
                "../common/e1fn": 8,
                "../common/e2fn": 9,
                "../common/e3fn": 10,
                "../common/imlfn": 12,
                "../common/mlfn": 14,
                "../common/msfnz": 15
            }],
            46: [function(a, b, c) {
                var d = Math.PI / 4,
                    e = a("../common/srat"),
                    f = Math.PI / 2,
                    g = 20;
                c.init = function() {
                    var a = Math.sin(this.lat0),
                        b = Math.cos(this.lat0);
                    b *= b, this.rc = Math.sqrt(1 - this.es) / (1 - this.es * a * a), this.C = Math.sqrt(1 + this.es * b * b / (1 - this.es)), this.phic0 = Math.asin(a / this.C), this.ratexp = .5 * this.C * this.e;
                    var c = Math.tan(.5 * this.phic0 + d),
                        f = Math.tan(.5 * this.lat0 + d);
                    c = c !== Number.POSITIVE_INFINITY ? c : Number.MAX_VALUE, f = f !== Number.POSITIVE_INFINITY ? f : Number.MAX_VALUE, this.K = c / (Math.pow(f, this.C) * e(this.e * a, this.ratexp))
                }, c.forward = function(a) {
                    var b = a.x,
                        c = a.y,
                        g = Math.tan(.5 * c + d);
                    return g = g !== Number.POSITIVE_INFINITY ? g : Number.MAX_VALUE, a.y = 2 * Math.atan(this.K * Math.pow(g, this.C) * e(this.e * Math.sin(c), this.ratexp)) - f, a.x = this.C * b, a
                }, c.inverse = function(a) {
                    var b = 1e-14,
                        c = a.x / this.C,
                        h = a.y,
                        i = Math.tan(.5 * h + d);
                    i = i !== Number.POSITIVE_INFINITY ? i : Number.MAX_VALUE;
                    for (var j = Math.pow(i / this.K, 1 / this.C), k = g; k > 0 && (h = 2 * Math.atan(j * e(this.e * Math.sin(a.y), -.5 * this.e)) - f, !(Math.abs(h - a.y) < b)); --k) a.y = h;
                    return k ? (a.x = c, a.y = h, a) : null
                }, c.names = ["gauss"]
            }, {
                "../common/srat": 22
            }],
            47: [function(a, b, c) {
                var d = a("../common/adjust_lon"),
                    e = 1e-10,
                    f = a("../common/asinz");
                c.init = function() {
                    this.sin_p14 = Math.sin(this.lat0), this.cos_p14 = Math.cos(this.lat0), this.infinity_dist = 1e3 * this.a, this.rc = 1
                }, c.forward = function(a) {
                    var b, c, f, g, h, i, j, k, l = a.x,
                        m = a.y;
                    return f = d(l - this.long0), b = Math.sin(m), c = Math.cos(m), g = Math.cos(f), i = this.sin_p14 * b + this.cos_p14 * c * g, h = 1, i > 0 || Math.abs(i) <= e ? (j = this.x0 + this.a * h * c * Math.sin(f) / i, k = this.y0 + this.a * h * (this.cos_p14 * b - this.sin_p14 * c * g) / i) : (j = this.x0 + this.infinity_dist * c * Math.sin(f), k = this.y0 + this.infinity_dist * (this.cos_p14 * b - this.sin_p14 * c * g)), a.x = j, a.y = k, a
                }, c.inverse = function(a) {
                    var b, c, e, g, h, i;
                    return a.x = (a.x - this.x0) / this.a, a.y = (a.y - this.y0) / this.a, a.x /= this.k0, a.y /= this.k0, (b = Math.sqrt(a.x * a.x + a.y * a.y)) ? (g = Math.atan2(b, this.rc), c = Math.sin(g), e = Math.cos(g), i = f(e * this.sin_p14 + a.y * c * this.cos_p14 / b), h = Math.atan2(a.x * c, b * this.cos_p14 * e - a.y * this.sin_p14 * c), h = d(this.long0 + h)) : (i = this.phic0, h = 0), a.x = h, a.y = i, a
                }, c.names = ["gnom"]
            }, {
                "../common/adjust_lon": 5,
                "../common/asinz": 6
            }],
            48: [function(a, b, c) {
                var d = a("../common/adjust_lon");
                c.init = function() {
                    this.a = 6377397.155, this.es = .006674372230614, this.e = Math.sqrt(this.es), this.lat0 || (this.lat0 = .863937979737193), this.long0 || (this.long0 = .4334234309119251), this.k0 || (this.k0 = .9999), this.s45 = .785398163397448, this.s90 = 2 * this.s45, this.fi0 = this.lat0, this.e2 = this.es, this.e = Math.sqrt(this.e2), this.alfa = Math.sqrt(1 + this.e2 * Math.pow(Math.cos(this.fi0), 4) / (1 - this.e2)), this.uq = 1.04216856380474, this.u0 = Math.asin(Math.sin(this.fi0) / this.alfa), this.g = Math.pow((1 + this.e * Math.sin(this.fi0)) / (1 - this.e * Math.sin(this.fi0)), this.alfa * this.e / 2), this.k = Math.tan(this.u0 / 2 + this.s45) / Math.pow(Math.tan(this.fi0 / 2 + this.s45), this.alfa) * this.g, this.k1 = this.k0, this.n0 = this.a * Math.sqrt(1 - this.e2) / (1 - this.e2 * Math.pow(Math.sin(this.fi0), 2)), this.s0 = 1.37008346281555, this.n = Math.sin(this.s0), this.ro0 = this.k1 * this.n0 / Math.tan(this.s0), this.ad = this.s90 - this.uq
                }, c.forward = function(a) {
                    var b, c, e, f, g, h, i, j = a.x,
                        k = a.y,
                        l = d(j - this.long0);
                    return b = Math.pow((1 + this.e * Math.sin(k)) / (1 - this.e * Math.sin(k)), this.alfa * this.e / 2), c = 2 * (Math.atan(this.k * Math.pow(Math.tan(k / 2 + this.s45), this.alfa) / b) - this.s45), e = -l * this.alfa, f = Math.asin(Math.cos(this.ad) * Math.sin(c) + Math.sin(this.ad) * Math.cos(c) * Math.cos(e)), g = Math.asin(Math.cos(c) * Math.sin(e) / Math.cos(f)), h = this.n * g, i = this.ro0 * Math.pow(Math.tan(this.s0 / 2 + this.s45), this.n) / Math.pow(Math.tan(f / 2 + this.s45), this.n), a.y = i * Math.cos(h) / 1, a.x = i * Math.sin(h) / 1, this.czech || (a.y *= -1, a.x *= -1), a
                }, c.inverse = function(a) {
                    var b, c, d, e, f, g, h, i, j = a.x;
                    a.x = a.y, a.y = j, this.czech || (a.y *= -1, a.x *= -1), g = Math.sqrt(a.x * a.x + a.y * a.y), f = Math.atan2(a.y, a.x), e = f / Math.sin(this.s0), d = 2 * (Math.atan(Math.pow(this.ro0 / g, 1 / this.n) * Math.tan(this.s0 / 2 + this.s45)) - this.s45), b = Math.asin(Math.cos(this.ad) * Math.sin(d) - Math.sin(this.ad) * Math.cos(d) * Math.cos(e)), c = Math.asin(Math.cos(d) * Math.sin(e) / Math.cos(b)), a.x = this.long0 - c / this.alfa, h = b, i = 0;
                    var k = 0;
                    do a.y = 2 * (Math.atan(Math.pow(this.k, -1 / this.alfa) * Math.pow(Math.tan(b / 2 + this.s45), 1 / this.alfa) * Math.pow((1 + this.e * Math.sin(h)) / (1 - this.e * Math.sin(h)), this.e / 2)) - this.s45), Math.abs(h - a.y) < 1e-10 && (i = 1), h = a.y, k += 1; while (0 === i && k < 15);
                    return k >= 15 ? null : a
                }, c.names = ["Krovak", "krovak"]
            }, {
                "../common/adjust_lon": 5
            }],
            49: [function(a, b, c) {
                var d = Math.PI / 2,
                    e = Math.PI / 4,
                    f = 1e-10,
                    g = a("../common/qsfnz"),
                    h = a("../common/adjust_lon");
                c.S_POLE = 1, c.N_POLE = 2, c.EQUIT = 3, c.OBLIQ = 4, c.init = function() {
                    var a = Math.abs(this.lat0);
                    if (Math.abs(a - d) < f ? this.mode = this.lat0 < 0 ? this.S_POLE : this.N_POLE : Math.abs(a) < f ? this.mode = this.EQUIT : this.mode = this.OBLIQ, this.es > 0) {
                        var b;
                        switch (this.qp = g(this.e, 1), this.mmf = .5 / (1 - this.es), this.apa = this.authset(this.es), this.mode) {
                            case this.N_POLE:
                                this.dd = 1;
                                break;
                            case this.S_POLE:
                                this.dd = 1;
                                break;
                            case this.EQUIT:
                                this.rq = Math.sqrt(.5 * this.qp), this.dd = 1 / this.rq, this.xmf = 1, this.ymf = .5 * this.qp;
                                break;
                            case this.OBLIQ:
                                this.rq = Math.sqrt(.5 * this.qp), b = Math.sin(this.lat0), this.sinb1 = g(this.e, b) / this.qp, this.cosb1 = Math.sqrt(1 - this.sinb1 * this.sinb1), this.dd = Math.cos(this.lat0) / (Math.sqrt(1 - this.es * b * b) * this.rq * this.cosb1), this.ymf = (this.xmf = this.rq) / this.dd, this.xmf *= this.dd
                        }
                    } else this.mode === this.OBLIQ && (this.sinph0 = Math.sin(this.lat0), this.cosph0 = Math.cos(this.lat0))
                }, c.forward = function(a) {
                    var b, c, i, j, k, l, m, n, o, p, q = a.x,
                        r = a.y;
                    if (q = h(q - this.long0), this.sphere) {
                        if (k = Math.sin(r), p = Math.cos(r), i = Math.cos(q), this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                            if (c = this.mode === this.EQUIT ? 1 + p * i : 1 + this.sinph0 * k + this.cosph0 * p * i, c <= f) return null;
                            c = Math.sqrt(2 / c), b = c * p * Math.sin(q), c *= this.mode === this.EQUIT ? k : this.cosph0 * k - this.sinph0 * p * i
                        } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
                            if (this.mode === this.N_POLE && (i = -i), Math.abs(r + this.phi0) < f) return null;
                            c = e - .5 * r, c = 2 * (this.mode === this.S_POLE ? Math.cos(c) : Math.sin(c)), b = c * Math.sin(q), c *= i
                        }
                    } else {
                        switch (m = 0, n = 0, o = 0, i = Math.cos(q), j = Math.sin(q), k = Math.sin(r), l = g(this.e, k), this.mode !== this.OBLIQ && this.mode !== this.EQUIT || (m = l / this.qp, n = Math.sqrt(1 - m * m)), this.mode) {
                            case this.OBLIQ:
                                o = 1 + this.sinb1 * m + this.cosb1 * n * i;
                                break;
                            case this.EQUIT:
                                o = 1 + n * i;
                                break;
                            case this.N_POLE:
                                o = d + r, l = this.qp - l;
                                break;
                            case this.S_POLE:
                                o = r - d, l = this.qp + l
                        }
                        if (Math.abs(o) < f) return null;
                        switch (this.mode) {
                            case this.OBLIQ:
                            case this.EQUIT:
                                o = Math.sqrt(2 / o), c = this.mode === this.OBLIQ ? this.ymf * o * (this.cosb1 * m - this.sinb1 * n * i) : (o = Math.sqrt(2 / (1 + n * i))) * m * this.ymf, b = this.xmf * o * n * j;
                                break;
                            case this.N_POLE:
                            case this.S_POLE:
                                l >= 0 ? (b = (o = Math.sqrt(l)) * j, c = i * (this.mode === this.S_POLE ? o : -o)) : b = c = 0
                        }
                    }
                    return a.x = this.a * b + this.x0, a.y = this.a * c + this.y0, a
                }, c.inverse = function(a) {
                    a.x -= this.x0, a.y -= this.y0;
                    var e, g, i, j, k, l, m, b = a.x / this.a,
                        c = a.y / this.a;
                    if (this.sphere) {
                        var o, n = 0,
                            p = 0;
                        if (o = Math.sqrt(b * b + c * c), g = .5 * o, g > 1) return null;
                        switch (g = 2 * Math.asin(g), this.mode !== this.OBLIQ && this.mode !== this.EQUIT || (p = Math.sin(g), n = Math.cos(g)), this.mode) {
                            case this.EQUIT:
                                g = Math.abs(o) <= f ? 0 : Math.asin(c * p / o), b *= p, c = n * o;
                                break;
                            case this.OBLIQ:
                                g = Math.abs(o) <= f ? this.phi0 : Math.asin(n * this.sinph0 + c * p * this.cosph0 / o), b *= p * this.cosph0, c = (n - Math.sin(g) * this.sinph0) * o;
                                break;
                            case this.N_POLE:
                                c = -c, g = d - g;
                                break;
                            case this.S_POLE:
                                g -= d
                        }
                        e = 0 !== c || this.mode !== this.EQUIT && this.mode !== this.OBLIQ ? Math.atan2(b, c) : 0
                    } else {
                        if (m = 0, this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                            if (b /= this.dd, c *= this.dd, l = Math.sqrt(b * b + c * c), l < f) return a.x = 0, a.y = this.phi0, a;
                            j = 2 * Math.asin(.5 * l / this.rq), i = Math.cos(j), b *= j = Math.sin(j), this.mode === this.OBLIQ ? (m = i * this.sinb1 + c * j * this.cosb1 / l, k = this.qp * m, c = l * this.cosb1 * i - c * this.sinb1 * j) : (m = c * j / l, k = this.qp * m, c = l * i)
                        } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
                            if (this.mode === this.N_POLE && (c = -c), k = b * b + c * c, !k) return a.x = 0, a.y = this.phi0, a;
                            m = 1 - k / this.qp, this.mode === this.S_POLE && (m = -m)
                        }
                        e = Math.atan2(b, c), g = this.authlat(Math.asin(m), this.apa)
                    }
                    return a.x = h(this.long0 + e), a.y = g, a
                }, c.P00 = .3333333333333333, c.P01 = .17222222222222222, c.P02 = .10257936507936508, c.P10 = .06388888888888888, c.P11 = .0664021164021164, c.P20 = .016415012942191543, c.authset = function(a) {
                    var b, c = [];
                    return c[0] = a * this.P00, b = a * a, c[0] += b * this.P01, c[1] = b * this.P10, b *= a, c[0] += b * this.P02, c[1] += b * this.P11, c[2] = b * this.P20, c
                }, c.authlat = function(a, b) {
                    var c = a + a;
                    return a + b[0] * Math.sin(c) + b[1] * Math.sin(c + c) + b[2] * Math.sin(c + c + c)
                }, c.names = ["Lambert Azimuthal Equal Area", "Lambert_Azimuthal_Equal_Area", "laea"]
            }, {
                "../common/adjust_lon": 5,
                "../common/qsfnz": 20
            }],
            50: [function(a, b, c) {
                var d = 1e-10,
                    e = a("../common/msfnz"),
                    f = a("../common/tsfnz"),
                    g = Math.PI / 2,
                    h = a("../common/sign"),
                    i = a("../common/adjust_lon"),
                    j = a("../common/phi2z");
                c.init = function() {
                    if (this.lat2 || (this.lat2 = this.lat1), this.k0 || (this.k0 = 1), this.x0 = this.x0 || 0, this.y0 = this.y0 || 0, !(Math.abs(this.lat1 + this.lat2) < d)) {
                        var a = this.b / this.a;
                        this.e = Math.sqrt(1 - a * a);
                        var b = Math.sin(this.lat1),
                            c = Math.cos(this.lat1),
                            g = e(this.e, b, c),
                            h = f(this.e, this.lat1, b),
                            i = Math.sin(this.lat2),
                            j = Math.cos(this.lat2),
                            k = e(this.e, i, j),
                            l = f(this.e, this.lat2, i),
                            m = f(this.e, this.lat0, Math.sin(this.lat0));
                        Math.abs(this.lat1 - this.lat2) > d ? this.ns = Math.log(g / k) / Math.log(h / l) : this.ns = b, isNaN(this.ns) && (this.ns = b), this.f0 = g / (this.ns * Math.pow(h, this.ns)), this.rh = this.a * this.f0 * Math.pow(m, this.ns), this.title || (this.title = "Lambert Conformal Conic")
                    }
                }, c.forward = function(a) {
                    var b = a.x,
                        c = a.y;
                    Math.abs(2 * Math.abs(c) - Math.PI) <= d && (c = h(c) * (g - 2 * d));
                    var j, k, e = Math.abs(Math.abs(c) - g);
                    if (e > d) j = f(this.e, c, Math.sin(c)), k = this.a * this.f0 * Math.pow(j, this.ns);
                    else {
                        if (e = c * this.ns, e <= 0) return null;
                        k = 0
                    }
                    var l = this.ns * i(b - this.long0);
                    return a.x = this.k0 * k * Math.sin(l) + this.x0, a.y = this.k0 * (this.rh - k * Math.cos(l)) + this.y0, a
                }, c.inverse = function(a) {
                    var b, c, d, e, f, h = (a.x - this.x0) / this.k0,
                        k = this.rh - (a.y - this.y0) / this.k0;
                    this.ns > 0 ? (b = Math.sqrt(h * h + k * k), c = 1) : (b = -Math.sqrt(h * h + k * k), c = -1);
                    var l = 0;
                    if (0 !== b && (l = Math.atan2(c * h, c * k)), 0 !== b || this.ns > 0) {
                        if (c = 1 / this.ns, d = Math.pow(b / (this.a * this.f0), c), e = j(this.e, d), e === -9999) return null
                    } else e = -g;
                    return f = i(l / this.ns + this.long0), a.x = f, a.y = e, a
                }, c.names = ["Lambert Tangential Conformal Conic Projection", "Lambert_Conformal_Conic", "Lambert_Conformal_Conic_2SP", "lcc"]
            }, {
                "../common/adjust_lon": 5,
                "../common/msfnz": 15,
                "../common/phi2z": 16,
                "../common/sign": 21,
                "../common/tsfnz": 24
            }],
            51: [function(a, b, c) {
                function d(a) {
                    return a
                }
                c.init = function() {}, c.forward = d, c.inverse = d, c.names = ["longlat", "identity"]
            }, {}],
            52: [function(a, b, c) {
                var d = a("../common/msfnz"),
                    e = Math.PI / 2,
                    f = 1e-10,
                    g = 57.29577951308232,
                    h = a("../common/adjust_lon"),
                    i = Math.PI / 4,
                    j = a("../common/tsfnz"),
                    k = a("../common/phi2z");
                c.init = function() {
                    var a = this.b / this.a;
                    this.es = 1 - a * a, "x0" in this || (this.x0 = 0), "y0" in this || (this.y0 = 0), this.e = Math.sqrt(this.es), this.lat_ts ? this.sphere ? this.k0 = Math.cos(this.lat_ts) : this.k0 = d(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) : this.k0 || (this.k ? this.k0 = this.k : this.k0 = 1)
                }, c.forward = function(a) {
                    var b = a.x,
                        c = a.y;
                    if (c * g > 90 && c * g < -90 && b * g > 180 && b * g < -180) return null;
                    var d, k;
                    if (Math.abs(Math.abs(c) - e) <= f) return null;
                    if (this.sphere) d = this.x0 + this.a * this.k0 * h(b - this.long0), k = this.y0 + this.a * this.k0 * Math.log(Math.tan(i + .5 * c));
                    else {
                        var l = Math.sin(c),
                            m = j(this.e, c, l);
                        d = this.x0 + this.a * this.k0 * h(b - this.long0), k = this.y0 - this.a * this.k0 * Math.log(m)
                    }
                    return a.x = d, a.y = k, a
                }, c.inverse = function(a) {
                    var d, f, b = a.x - this.x0,
                        c = a.y - this.y0;
                    if (this.sphere) f = e - 2 * Math.atan(Math.exp(-c / (this.a * this.k0)));
                    else {
                        var g = Math.exp(-c / (this.a * this.k0));
                        if (f = k(this.e, g), f === -9999) return null
                    }
                    return d = h(this.long0 + b / (this.a * this.k0)), a.x = d, a.y = f, a
                }, c.names = ["Mercator", "Popular Visualisation Pseudo Mercator", "Mercator_1SP", "Mercator_Auxiliary_Sphere", "merc"]
            }, {
                "../common/adjust_lon": 5,
                "../common/msfnz": 15,
                "../common/phi2z": 16,
                "../common/tsfnz": 24
            }],
            53: [function(a, b, c) {
                var d = a("../common/adjust_lon");
                c.init = function() {}, c.forward = function(a) {
                    var b = a.x,
                        c = a.y,
                        e = d(b - this.long0),
                        f = this.x0 + this.a * e,
                        g = this.y0 + this.a * Math.log(Math.tan(Math.PI / 4 + c / 2.5)) * 1.25;
                    return a.x = f, a.y = g, a
                }, c.inverse = function(a) {
                    a.x -= this.x0, a.y -= this.y0;
                    var b = d(this.long0 + a.x / this.a),
                        c = 2.5 * (Math.atan(Math.exp(.8 * a.y / this.a)) - Math.PI / 4);
                    return a.x = b, a.y = c, a
                }, c.names = ["Miller_Cylindrical", "mill"]
            }, {
                "../common/adjust_lon": 5
            }],
            54: [function(a, b, c) {
                var d = a("../common/adjust_lon"),
                    e = 1e-10;
                c.init = function() {}, c.forward = function(a) {
                    for (var b = a.x, c = a.y, f = d(b - this.long0), g = c, h = Math.PI * Math.sin(c), i = 0; !0; i++) {
                        var j = -(g + Math.sin(g) - h) / (1 + Math.cos(g));
                        if (g += j, Math.abs(j) < e) break
                    }
                    g /= 2, Math.PI / 2 - Math.abs(c) < e && (f = 0);
                    var k = .900316316158 * this.a * f * Math.cos(g) + this.x0,
                        l = 1.4142135623731 * this.a * Math.sin(g) + this.y0;
                    return a.x = k, a.y = l, a
                }, c.inverse = function(a) {
                    var b, c;
                    a.x -= this.x0, a.y -= this.y0, c = a.y / (1.4142135623731 * this.a), Math.abs(c) > .999999999999 && (c = .999999999999), b = Math.asin(c);
                    var e = d(this.long0 + a.x / (.900316316158 * this.a * Math.cos(b)));
                    e < -Math.PI && (e = -Math.PI), e > Math.PI && (e = Math.PI), c = (2 * b + Math.sin(2 * b)) / Math.PI, Math.abs(c) > 1 && (c = 1);
                    var f = Math.asin(c);
                    return a.x = e, a.y = f, a
                }, c.names = ["Mollweide", "moll"]
            }, {
                "../common/adjust_lon": 5
            }],
            55: [function(a, b, c) {
                var d = 484813681109536e-20;
                c.iterations = 1, c.init = function() {
                    this.A = [], this.A[1] = .6399175073, this.A[2] = -.1358797613, this.A[3] = .063294409, this.A[4] = -.02526853, this.A[5] = .0117879, this.A[6] = -.0055161, this.A[7] = .0026906, this.A[8] = -.001333, this.A[9] = 67e-5, this.A[10] = -34e-5, this.B_re = [], this.B_im = [], this.B_re[1] = .7557853228, this.B_im[1] = 0, this.B_re[2] = .249204646, this.B_im[2] = .003371507, this.B_re[3] = -.001541739, this.B_im[3] = .04105856, this.B_re[4] = -.10162907, this.B_im[4] = .01727609, this.B_re[5] = -.26623489, this.B_im[5] = -.36249218, this.B_re[6] = -.6870983,
                        this.B_im[6] = -1.1651967, this.C_re = [], this.C_im = [], this.C_re[1] = 1.3231270439, this.C_im[1] = 0, this.C_re[2] = -.577245789, this.C_im[2] = -.007809598, this.C_re[3] = .508307513, this.C_im[3] = -.112208952, this.C_re[4] = -.15094762, this.C_im[4] = .18200602, this.C_re[5] = 1.01418179, this.C_im[5] = 1.64497696, this.C_re[6] = 1.9660549, this.C_im[6] = 2.5127645, this.D = [], this.D[1] = 1.5627014243, this.D[2] = .5185406398, this.D[3] = -.03333098, this.D[4] = -.1052906, this.D[5] = -.0368594, this.D[6] = .007317, this.D[7] = .0122, this.D[8] = .00394, this.D[9] = -.0013
                }, c.forward = function(a) {
                    var b, c = a.x,
                        e = a.y,
                        f = e - this.lat0,
                        g = c - this.long0,
                        h = f / d * 1e-5,
                        i = g,
                        j = 1,
                        k = 0;
                    for (b = 1; b <= 10; b++) j *= h, k += this.A[b] * j;
                    var p, q, l = k,
                        m = i,
                        n = 1,
                        o = 0,
                        r = 0,
                        s = 0;
                    for (b = 1; b <= 6; b++) p = n * l - o * m, q = o * l + n * m, n = p, o = q, r = r + this.B_re[b] * n - this.B_im[b] * o, s = s + this.B_im[b] * n + this.B_re[b] * o;
                    return a.x = s * this.a + this.x0, a.y = r * this.a + this.y0, a
                }, c.inverse = function(a) {
                    var b, l, m, c = a.x,
                        e = a.y,
                        f = c - this.x0,
                        g = e - this.y0,
                        h = g / this.a,
                        i = f / this.a,
                        j = 1,
                        k = 0,
                        n = 0,
                        o = 0;
                    for (b = 1; b <= 6; b++) l = j * h - k * i, m = k * h + j * i, j = l, k = m, n = n + this.C_re[b] * j - this.C_im[b] * k, o = o + this.C_im[b] * j + this.C_re[b] * k;
                    for (var p = 0; p < this.iterations; p++) {
                        var s, t, q = n,
                            r = o,
                            u = h,
                            v = i;
                        for (b = 2; b <= 6; b++) s = q * n - r * o, t = r * n + q * o, q = s, r = t, u += (b - 1) * (this.B_re[b] * q - this.B_im[b] * r), v += (b - 1) * (this.B_im[b] * q + this.B_re[b] * r);
                        q = 1, r = 0;
                        var w = this.B_re[1],
                            x = this.B_im[1];
                        for (b = 2; b <= 6; b++) s = q * n - r * o, t = r * n + q * o, q = s, r = t, w += b * (this.B_re[b] * q - this.B_im[b] * r), x += b * (this.B_im[b] * q + this.B_re[b] * r);
                        var y = w * w + x * x;
                        n = (u * w + v * x) / y, o = (v * w - u * x) / y
                    }
                    var z = n,
                        A = o,
                        B = 1,
                        C = 0;
                    for (b = 1; b <= 9; b++) B *= z, C += this.D[b] * B;
                    var D = this.lat0 + C * d * 1e5,
                        E = this.long0 + A;
                    return a.x = E, a.y = D, a
                }, c.names = ["New_Zealand_Map_Grid", "nzmg"]
            }, {}],
            56: [function(a, b, c) {
                var d = a("../common/tsfnz"),
                    e = a("../common/adjust_lon"),
                    f = a("../common/phi2z"),
                    g = Math.PI / 2,
                    h = Math.PI / 4,
                    i = 1e-10;
                c.init = function() {
                    this.no_off = this.no_off || !1, this.no_rot = this.no_rot || !1, isNaN(this.k0) && (this.k0 = 1);
                    var a = Math.sin(this.lat0),
                        b = Math.cos(this.lat0),
                        c = this.e * a;
                    this.bl = Math.sqrt(1 + this.es / (1 - this.es) * Math.pow(b, 4)), this.al = this.a * this.bl * this.k0 * Math.sqrt(1 - this.es) / (1 - c * c);
                    var f = d(this.e, this.lat0, a),
                        g = this.bl / b * Math.sqrt((1 - this.es) / (1 - c * c));
                    g * g < 1 && (g = 1);
                    var h, i;
                    if (isNaN(this.longc)) {
                        var j = d(this.e, this.lat1, Math.sin(this.lat1)),
                            k = d(this.e, this.lat2, Math.sin(this.lat2));
                        this.lat0 >= 0 ? this.el = (g + Math.sqrt(g * g - 1)) * Math.pow(f, this.bl) : this.el = (g - Math.sqrt(g * g - 1)) * Math.pow(f, this.bl);
                        var l = Math.pow(j, this.bl),
                            m = Math.pow(k, this.bl);
                        h = this.el / l, i = .5 * (h - 1 / h);
                        var n = (this.el * this.el - m * l) / (this.el * this.el + m * l),
                            o = (m - l) / (m + l),
                            p = e(this.long1 - this.long2);
                        this.long0 = .5 * (this.long1 + this.long2) - Math.atan(n * Math.tan(.5 * this.bl * p) / o) / this.bl, this.long0 = e(this.long0);
                        var q = e(this.long1 - this.long0);
                        this.gamma0 = Math.atan(Math.sin(this.bl * q) / i), this.alpha = Math.asin(g * Math.sin(this.gamma0))
                    } else h = this.lat0 >= 0 ? g + Math.sqrt(g * g - 1) : g - Math.sqrt(g * g - 1), this.el = h * Math.pow(f, this.bl), i = .5 * (h - 1 / h), this.gamma0 = Math.asin(Math.sin(this.alpha) / g), this.long0 = this.longc - Math.asin(i * Math.tan(this.gamma0)) / this.bl;
                    this.no_off ? this.uc = 0 : this.lat0 >= 0 ? this.uc = this.al / this.bl * Math.atan2(Math.sqrt(g * g - 1), Math.cos(this.alpha)) : this.uc = -1 * this.al / this.bl * Math.atan2(Math.sqrt(g * g - 1), Math.cos(this.alpha))
                }, c.forward = function(a) {
                    var j, k, l, b = a.x,
                        c = a.y,
                        f = e(b - this.long0);
                    if (Math.abs(Math.abs(c) - g) <= i) l = c > 0 ? -1 : 1, k = this.al / this.bl * Math.log(Math.tan(h + l * this.gamma0 * .5)), j = -1 * l * g * this.al / this.bl;
                    else {
                        var m = d(this.e, c, Math.sin(c)),
                            n = this.el / Math.pow(m, this.bl),
                            o = .5 * (n - 1 / n),
                            p = .5 * (n + 1 / n),
                            q = Math.sin(this.bl * f),
                            r = (o * Math.sin(this.gamma0) - q * Math.cos(this.gamma0)) / p;
                        k = Math.abs(Math.abs(r) - 1) <= i ? Number.POSITIVE_INFINITY : .5 * this.al * Math.log((1 - r) / (1 + r)) / this.bl, j = Math.abs(Math.cos(this.bl * f)) <= i ? this.al * this.bl * f : this.al * Math.atan2(o * Math.cos(this.gamma0) + q * Math.sin(this.gamma0), Math.cos(this.bl * f)) / this.bl
                    }
                    return this.no_rot ? (a.x = this.x0 + j, a.y = this.y0 + k) : (j -= this.uc, a.x = this.x0 + k * Math.cos(this.alpha) + j * Math.sin(this.alpha), a.y = this.y0 + j * Math.cos(this.alpha) - k * Math.sin(this.alpha)), a
                }, c.inverse = function(a) {
                    var b, c;
                    this.no_rot ? (c = a.y - this.y0, b = a.x - this.x0) : (c = (a.x - this.x0) * Math.cos(this.alpha) - (a.y - this.y0) * Math.sin(this.alpha), b = (a.y - this.y0) * Math.cos(this.alpha) + (a.x - this.x0) * Math.sin(this.alpha), b += this.uc);
                    var d = Math.exp(-1 * this.bl * c / this.al),
                        h = .5 * (d - 1 / d),
                        j = .5 * (d + 1 / d),
                        k = Math.sin(this.bl * b / this.al),
                        l = (k * Math.cos(this.gamma0) + h * Math.sin(this.gamma0)) / j,
                        m = Math.pow(this.el / Math.sqrt((1 + l) / (1 - l)), 1 / this.bl);
                    return Math.abs(l - 1) < i ? (a.x = this.long0, a.y = g) : Math.abs(l + 1) < i ? (a.x = this.long0, a.y = -1 * g) : (a.y = f(this.e, m), a.x = e(this.long0 - Math.atan2(h * Math.cos(this.gamma0) - k * Math.sin(this.gamma0), Math.cos(this.bl * b / this.al)) / this.bl)), a
                }, c.names = ["Hotine_Oblique_Mercator", "Hotine Oblique Mercator", "Hotine_Oblique_Mercator_Azimuth_Natural_Origin", "Hotine_Oblique_Mercator_Azimuth_Center", "omerc"]
            }, {
                "../common/adjust_lon": 5,
                "../common/phi2z": 16,
                "../common/tsfnz": 24
            }],
            57: [function(a, b, c) {
                var d = a("../common/e0fn"),
                    e = a("../common/e1fn"),
                    f = a("../common/e2fn"),
                    g = a("../common/e3fn"),
                    h = a("../common/adjust_lon"),
                    i = a("../common/adjust_lat"),
                    j = a("../common/mlfn"),
                    k = 1e-10,
                    l = a("../common/gN"),
                    m = 20;
                c.init = function() {
                    this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e = Math.sqrt(this.es), this.e0 = d(this.es), this.e1 = e(this.es), this.e2 = f(this.es), this.e3 = g(this.es), this.ml0 = this.a * j(this.e0, this.e1, this.e2, this.e3, this.lat0)
                }, c.forward = function(a) {
                    var d, e, f, b = a.x,
                        c = a.y,
                        g = h(b - this.long0);
                    if (f = g * Math.sin(c), this.sphere) Math.abs(c) <= k ? (d = this.a * g, e = -1 * this.a * this.lat0) : (d = this.a * Math.sin(f) / Math.tan(c), e = this.a * (i(c - this.lat0) + (1 - Math.cos(f)) / Math.tan(c)));
                    else if (Math.abs(c) <= k) d = this.a * g, e = -1 * this.ml0;
                    else {
                        var m = l(this.a, this.e, Math.sin(c)) / Math.tan(c);
                        d = m * Math.sin(f), e = this.a * j(this.e0, this.e1, this.e2, this.e3, c) - this.ml0 + m * (1 - Math.cos(f))
                    }
                    return a.x = d + this.x0, a.y = e + this.y0, a
                }, c.inverse = function(a) {
                    var b, c, d, e, f, g, i, l, n;
                    if (d = a.x - this.x0, e = a.y - this.y0, this.sphere)
                        if (Math.abs(e + this.a * this.lat0) <= k) b = h(d / this.a + this.long0), c = 0;
                        else {
                            g = this.lat0 + e / this.a, i = d * d / this.a / this.a + g * g, l = g;
                            var o;
                            for (f = m; f; --f)
                                if (o = Math.tan(l), n = -1 * (g * (l * o + 1) - l - .5 * (l * l + i) * o) / ((l - g) / o - 1), l += n, Math.abs(n) <= k) {
                                    c = l;
                                    break
                                }
                            b = h(this.long0 + Math.asin(d * Math.tan(l) / this.a) / Math.sin(c))
                        }
                    else if (Math.abs(e + this.ml0) <= k) c = 0, b = h(this.long0 + d / this.a);
                    else {
                        g = (this.ml0 + e) / this.a, i = d * d / this.a / this.a + g * g, l = g;
                        var p, q, r, s, t;
                        for (f = m; f; --f)
                            if (t = this.e * Math.sin(l), p = Math.sqrt(1 - t * t) * Math.tan(l), q = this.a * j(this.e0, this.e1, this.e2, this.e3, l), r = this.e0 - 2 * this.e1 * Math.cos(2 * l) + 4 * this.e2 * Math.cos(4 * l) - 6 * this.e3 * Math.cos(6 * l), s = q / this.a, n = (g * (p * s + 1) - s - .5 * p * (s * s + i)) / (this.es * Math.sin(2 * l) * (s * s + i - 2 * g * s) / (4 * p) + (g - s) * (p * r - 2 / Math.sin(2 * l)) - r), l -= n, Math.abs(n) <= k) {
                                c = l;
                                break
                            }
                        p = Math.sqrt(1 - this.es * Math.pow(Math.sin(c), 2)) * Math.tan(c), b = h(this.long0 + Math.asin(d * p / this.a) / Math.sin(c))
                    }
                    return a.x = b, a.y = c, a
                }, c.names = ["Polyconic", "poly"]
            }, {
                "../common/adjust_lat": 4,
                "../common/adjust_lon": 5,
                "../common/e0fn": 7,
                "../common/e1fn": 8,
                "../common/e2fn": 9,
                "../common/e3fn": 10,
                "../common/gN": 11,
                "../common/mlfn": 14
            }],
            58: [function(a, b, c) {
                var d = a("../common/adjust_lon"),
                    e = a("../common/adjust_lat"),
                    f = a("../common/pj_enfn"),
                    g = 20,
                    h = a("../common/pj_mlfn"),
                    i = a("../common/pj_inv_mlfn"),
                    j = Math.PI / 2,
                    k = 1e-10,
                    l = a("../common/asinz");
                c.init = function() {
                    this.sphere ? (this.n = 1, this.m = 0, this.es = 0, this.C_y = Math.sqrt((this.m + 1) / this.n), this.C_x = this.C_y / (this.m + 1)) : this.en = f(this.es)
                }, c.forward = function(a) {
                    var b, c, e = a.x,
                        f = a.y;
                    if (e = d(e - this.long0), this.sphere) {
                        if (this.m)
                            for (var i = this.n * Math.sin(f), j = g; j; --j) {
                                var l = (this.m * f + Math.sin(f) - i) / (this.m + Math.cos(f));
                                if (f -= l, Math.abs(l) < k) break
                            } else f = 1 !== this.n ? Math.asin(this.n * Math.sin(f)) : f;
                        b = this.a * this.C_x * e * (this.m + Math.cos(f)), c = this.a * this.C_y * f
                    } else {
                        var m = Math.sin(f),
                            n = Math.cos(f);
                        c = this.a * h(f, m, n, this.en), b = this.a * e * n / Math.sqrt(1 - this.es * m * m)
                    }
                    return a.x = b, a.y = c, a
                }, c.inverse = function(a) {
                    var b, c, f, g;
                    return a.x -= this.x0, f = a.x / this.a, a.y -= this.y0, b = a.y / this.a, this.sphere ? (b /= this.C_y, f /= this.C_x * (this.m + Math.cos(b)), this.m ? b = l((this.m * b + Math.sin(b)) / this.n) : 1 !== this.n && (b = l(Math.sin(b) / this.n)), f = d(f + this.long0), b = e(b)) : (b = i(a.y / this.a, this.es, this.en), g = Math.abs(b), g < j ? (g = Math.sin(b), c = this.long0 + a.x * Math.sqrt(1 - this.es * g * g) / (this.a * Math.cos(b)), f = d(c)) : g - k < j && (f = this.long0)), a.x = f, a.y = b, a
                }, c.names = ["Sinusoidal", "sinu"]
            }, {
                "../common/adjust_lat": 4,
                "../common/adjust_lon": 5,
                "../common/asinz": 6,
                "../common/pj_enfn": 17,
                "../common/pj_inv_mlfn": 18,
                "../common/pj_mlfn": 19
            }],
            59: [function(a, b, c) {
                c.init = function() {
                    var a = this.lat0;
                    this.lambda0 = this.long0;
                    var b = Math.sin(a),
                        c = this.a,
                        d = this.rf,
                        e = 1 / d,
                        f = 2 * e - Math.pow(e, 2),
                        g = this.e = Math.sqrt(f);
                    this.R = this.k0 * c * Math.sqrt(1 - f) / (1 - f * Math.pow(b, 2)), this.alpha = Math.sqrt(1 + f / (1 - f) * Math.pow(Math.cos(a), 4)), this.b0 = Math.asin(b / this.alpha);
                    var h = Math.log(Math.tan(Math.PI / 4 + this.b0 / 2)),
                        i = Math.log(Math.tan(Math.PI / 4 + a / 2)),
                        j = Math.log((1 + g * b) / (1 - g * b));
                    this.K = h - this.alpha * i + this.alpha * g / 2 * j
                }, c.forward = function(a) {
                    var b = Math.log(Math.tan(Math.PI / 4 - a.y / 2)),
                        c = this.e / 2 * Math.log((1 + this.e * Math.sin(a.y)) / (1 - this.e * Math.sin(a.y))),
                        d = -this.alpha * (b + c) + this.K,
                        e = 2 * (Math.atan(Math.exp(d)) - Math.PI / 4),
                        f = this.alpha * (a.x - this.lambda0),
                        g = Math.atan(Math.sin(f) / (Math.sin(this.b0) * Math.tan(e) + Math.cos(this.b0) * Math.cos(f))),
                        h = Math.asin(Math.cos(this.b0) * Math.sin(e) - Math.sin(this.b0) * Math.cos(e) * Math.cos(f));
                    return a.y = this.R / 2 * Math.log((1 + Math.sin(h)) / (1 - Math.sin(h))) + this.y0, a.x = this.R * g + this.x0, a
                }, c.inverse = function(a) {
                    for (var b = a.x - this.x0, c = a.y - this.y0, d = b / this.R, e = 2 * (Math.atan(Math.exp(c / this.R)) - Math.PI / 4), f = Math.asin(Math.cos(this.b0) * Math.sin(e) + Math.sin(this.b0) * Math.cos(e) * Math.cos(d)), g = Math.atan(Math.sin(d) / (Math.cos(this.b0) * Math.cos(d) - Math.sin(this.b0) * Math.tan(e))), h = this.lambda0 + g / this.alpha, i = 0, j = f, k = -1e3, l = 0; Math.abs(j - k) > 1e-7;) {
                        if (++l > 20) return;
                        i = 1 / this.alpha * (Math.log(Math.tan(Math.PI / 4 + f / 2)) - this.K) + this.e * Math.log(Math.tan(Math.PI / 4 + Math.asin(this.e * Math.sin(j)) / 2)), k = j, j = 2 * Math.atan(Math.exp(i)) - Math.PI / 2
                    }
                    return a.x = h, a.y = j, a
                }, c.names = ["somerc"]
            }, {}],
            60: [function(a, b, c) {
                var d = Math.PI / 2,
                    e = 1e-10,
                    f = a("../common/sign"),
                    g = a("../common/msfnz"),
                    h = a("../common/tsfnz"),
                    i = a("../common/phi2z"),
                    j = a("../common/adjust_lon");
                c.ssfn_ = function(a, b, c) {
                    return b *= c, Math.tan(.5 * (d + a)) * Math.pow((1 - b) / (1 + b), .5 * c)
                }, c.init = function() {
                    this.coslat0 = Math.cos(this.lat0), this.sinlat0 = Math.sin(this.lat0), this.sphere ? 1 === this.k0 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= e && (this.k0 = .5 * (1 + f(this.lat0) * Math.sin(this.lat_ts))) : (Math.abs(this.coslat0) <= e && (this.lat0 > 0 ? this.con = 1 : this.con = -1), this.cons = Math.sqrt(Math.pow(1 + this.e, 1 + this.e) * Math.pow(1 - this.e, 1 - this.e)), 1 === this.k0 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= e && (this.k0 = .5 * this.cons * g(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) / h(this.e, this.con * this.lat_ts, this.con * Math.sin(this.lat_ts))), this.ms1 = g(this.e, this.sinlat0, this.coslat0), this.X0 = 2 * Math.atan(this.ssfn_(this.lat0, this.sinlat0, this.e)) - d, this.cosX0 = Math.cos(this.X0), this.sinX0 = Math.sin(this.X0))
                }, c.forward = function(a) {
                    var i, k, l, m, n, o, b = a.x,
                        c = a.y,
                        f = Math.sin(c),
                        g = Math.cos(c),
                        p = j(b - this.long0);
                    return Math.abs(Math.abs(b - this.long0) - Math.PI) <= e && Math.abs(c + this.lat0) <= e ? (a.x = NaN, a.y = NaN, a) : this.sphere ? (i = 2 * this.k0 / (1 + this.sinlat0 * f + this.coslat0 * g * Math.cos(p)), a.x = this.a * i * g * Math.sin(p) + this.x0, a.y = this.a * i * (this.coslat0 * f - this.sinlat0 * g * Math.cos(p)) + this.y0, a) : (k = 2 * Math.atan(this.ssfn_(c, f, this.e)) - d, m = Math.cos(k), l = Math.sin(k), Math.abs(this.coslat0) <= e ? (n = h(this.e, c * this.con, this.con * f), o = 2 * this.a * this.k0 * n / this.cons, a.x = this.x0 + o * Math.sin(b - this.long0), a.y = this.y0 - this.con * o * Math.cos(b - this.long0), a) : (Math.abs(this.sinlat0) < e ? (i = 2 * this.a * this.k0 / (1 + m * Math.cos(p)), a.y = i * l) : (i = 2 * this.a * this.k0 * this.ms1 / (this.cosX0 * (1 + this.sinX0 * l + this.cosX0 * m * Math.cos(p))), a.y = i * (this.cosX0 * l - this.sinX0 * m * Math.cos(p)) + this.y0), a.x = i * m * Math.sin(p) + this.x0, a))
                }, c.inverse = function(a) {
                    a.x -= this.x0, a.y -= this.y0;
                    var b, c, f, g, h, k = Math.sqrt(a.x * a.x + a.y * a.y);
                    if (this.sphere) {
                        var l = 2 * Math.atan(k / (.5 * this.a * this.k0));
                        return b = this.long0, c = this.lat0, k <= e ? (a.x = b, a.y = c, a) : (c = Math.asin(Math.cos(l) * this.sinlat0 + a.y * Math.sin(l) * this.coslat0 / k), b = j(Math.abs(this.coslat0) < e ? this.lat0 > 0 ? this.long0 + Math.atan2(a.x, -1 * a.y) : this.long0 + Math.atan2(a.x, a.y) : this.long0 + Math.atan2(a.x * Math.sin(l), k * this.coslat0 * Math.cos(l) - a.y * this.sinlat0 * Math.sin(l))), a.x = b, a.y = c, a)
                    }
                    if (Math.abs(this.coslat0) <= e) {
                        if (k <= e) return c = this.lat0, b = this.long0, a.x = b, a.y = c, a;
                        a.x *= this.con, a.y *= this.con, f = k * this.cons / (2 * this.a * this.k0), c = this.con * i(this.e, f), b = this.con * j(this.con * this.long0 + Math.atan2(a.x, -1 * a.y))
                    } else g = 2 * Math.atan(k * this.cosX0 / (2 * this.a * this.k0 * this.ms1)), b = this.long0, k <= e ? h = this.X0 : (h = Math.asin(Math.cos(g) * this.sinX0 + a.y * Math.sin(g) * this.cosX0 / k), b = j(this.long0 + Math.atan2(a.x * Math.sin(g), k * this.cosX0 * Math.cos(g) - a.y * this.sinX0 * Math.sin(g)))), c = -1 * i(this.e, Math.tan(.5 * (d + h)));
                    return a.x = b, a.y = c, a
                }, c.names = ["stere", "Stereographic_South_Pole", "Polar Stereographic (variant B)"]
            }, {
                "../common/adjust_lon": 5,
                "../common/msfnz": 15,
                "../common/phi2z": 16,
                "../common/sign": 21,
                "../common/tsfnz": 24
            }],
            61: [function(a, b, c) {
                var d = a("./gauss"),
                    e = a("../common/adjust_lon");
                c.init = function() {
                    d.init.apply(this), this.rc && (this.sinc0 = Math.sin(this.phic0), this.cosc0 = Math.cos(this.phic0), this.R2 = 2 * this.rc, this.title || (this.title = "Oblique Stereographic Alternative"))
                }, c.forward = function(a) {
                    var b, c, f, g;
                    return a.x = e(a.x - this.long0), d.forward.apply(this, [a]), b = Math.sin(a.y), c = Math.cos(a.y), f = Math.cos(a.x), g = this.k0 * this.R2 / (1 + this.sinc0 * b + this.cosc0 * c * f), a.x = g * c * Math.sin(a.x), a.y = g * (this.cosc0 * b - this.sinc0 * c * f), a.x = this.a * a.x + this.x0, a.y = this.a * a.y + this.y0, a
                }, c.inverse = function(a) {
                    var b, c, f, g, h;
                    if (a.x = (a.x - this.x0) / this.a, a.y = (a.y - this.y0) / this.a, a.x /= this.k0, a.y /= this.k0, h = Math.sqrt(a.x * a.x + a.y * a.y)) {
                        var i = 2 * Math.atan2(h, this.R2);
                        b = Math.sin(i), c = Math.cos(i), g = Math.asin(c * this.sinc0 + a.y * b * this.cosc0 / h), f = Math.atan2(a.x * b, h * this.cosc0 * c - a.y * this.sinc0 * b)
                    } else g = this.phic0, f = 0;
                    return a.x = f, a.y = g, d.inverse.apply(this, [a]), a.x = e(a.x + this.long0), a
                }, c.names = ["Stereographic_North_Pole", "Oblique_Stereographic", "Polar_Stereographic", "sterea", "Oblique Stereographic Alternative"]
            }, {
                "../common/adjust_lon": 5,
                "./gauss": 46
            }],
            62: [function(a, b, c) {
                var d = a("../common/e0fn"),
                    e = a("../common/e1fn"),
                    f = a("../common/e2fn"),
                    g = a("../common/e3fn"),
                    h = a("../common/mlfn"),
                    i = a("../common/adjust_lon"),
                    j = Math.PI / 2,
                    k = 1e-10,
                    l = a("../common/sign"),
                    m = a("../common/asinz");
                c.init = function() {
                    this.e0 = d(this.es), this.e1 = e(this.es), this.e2 = f(this.es), this.e3 = g(this.es), this.ml0 = this.a * h(this.e0, this.e1, this.e2, this.e3, this.lat0)
                }, c.forward = function(a) {
                    var e, f, g, b = a.x,
                        c = a.y,
                        d = i(b - this.long0),
                        j = Math.sin(c),
                        k = Math.cos(c);
                    if (this.sphere) {
                        var l = k * Math.sin(d);
                        if (Math.abs(Math.abs(l) - 1) < 1e-10) return 93;
                        f = .5 * this.a * this.k0 * Math.log((1 + l) / (1 - l)), e = Math.acos(k * Math.cos(d) / Math.sqrt(1 - l * l)), c < 0 && (e = -e), g = this.a * this.k0 * (e - this.lat0)
                    } else {
                        var m = k * d,
                            n = Math.pow(m, 2),
                            o = this.ep2 * Math.pow(k, 2),
                            p = Math.tan(c),
                            q = Math.pow(p, 2);
                        e = 1 - this.es * Math.pow(j, 2);
                        var r = this.a / Math.sqrt(e),
                            s = this.a * h(this.e0, this.e1, this.e2, this.e3, c);
                        f = this.k0 * r * m * (1 + n / 6 * (1 - q + o + n / 20 * (5 - 18 * q + Math.pow(q, 2) + 72 * o - 58 * this.ep2))) + this.x0, g = this.k0 * (s - this.ml0 + r * p * n * (.5 + n / 24 * (5 - q + 9 * o + 4 * Math.pow(o, 2) + n / 30 * (61 - 58 * q + Math.pow(q, 2) + 600 * o - 330 * this.ep2)))) + this.y0
                    }
                    return a.x = f, a.y = g, a
                }, c.inverse = function(a) {
                    var b, c, d, e, g, h, f = 6;
                    if (this.sphere) {
                        var n = Math.exp(a.x / (this.a * this.k0)),
                            o = .5 * (n - 1 / n),
                            p = this.lat0 + a.y / (this.a * this.k0),
                            q = Math.cos(p);
                        b = Math.sqrt((1 - q * q) / (1 + o * o)), g = m(b), p < 0 && (g = -g), h = 0 === o && 0 === q ? this.long0 : i(Math.atan2(o, q) + this.long0)
                    } else {
                        var r = a.x - this.x0,
                            s = a.y - this.y0;
                        for (b = (this.ml0 + s / this.k0) / this.a, c = b, e = 0; !0 && (d = (b + this.e1 * Math.sin(2 * c) - this.e2 * Math.sin(4 * c) + this.e3 * Math.sin(6 * c)) / this.e0 - c, c += d, !(Math.abs(d) <= k)); e++)
                            if (e >= f) return 95;
                        if (Math.abs(c) < j) {
                            var t = Math.sin(c),
                                u = Math.cos(c),
                                v = Math.tan(c),
                                w = this.ep2 * Math.pow(u, 2),
                                x = Math.pow(w, 2),
                                y = Math.pow(v, 2),
                                z = Math.pow(y, 2);
                            b = 1 - this.es * Math.pow(t, 2);
                            var A = this.a / Math.sqrt(b),
                                B = A * (1 - this.es) / b,
                                C = r / (A * this.k0),
                                D = Math.pow(C, 2);
                            g = c - A * v * D / B * (.5 - D / 24 * (5 + 3 * y + 10 * w - 4 * x - 9 * this.ep2 - D / 30 * (61 + 90 * y + 298 * w + 45 * z - 252 * this.ep2 - 3 * x))), h = i(this.long0 + C * (1 - D / 6 * (1 + 2 * y + w - D / 20 * (5 - 2 * w + 28 * y - 3 * x + 8 * this.ep2 + 24 * z))) / u)
                        } else g = j * l(s), h = this.long0
                    }
                    return a.x = h, a.y = g, a
                }, c.names = ["Transverse_Mercator", "Transverse Mercator", "tmerc"]
            }, {
                "../common/adjust_lon": 5,
                "../common/asinz": 6,
                "../common/e0fn": 7,
                "../common/e1fn": 8,
                "../common/e2fn": 9,
                "../common/e3fn": 10,
                "../common/mlfn": 14,
                "../common/sign": 21
            }],
            63: [function(a, b, c) {
                var d = .017453292519943295,
                    e = a("./tmerc");
                c.dependsOn = "tmerc", c.init = function() {
                    this.zone && (this.lat0 = 0, this.long0 = (6 * Math.abs(this.zone) - 183) * d, this.x0 = 5e5, this.y0 = this.utmSouth ? 1e7 : 0, this.k0 = .9996, e.init.apply(this), this.forward = e.forward, this.inverse = e.inverse)
                }, c.names = ["Universal Transverse Mercator System", "utm"]
            }, {
                "./tmerc": 62
            }],
            64: [function(a, b, c) {
                var d = a("../common/adjust_lon"),
                    e = Math.PI / 2,
                    f = 1e-10,
                    g = a("../common/asinz");
                c.init = function() {
                    this.R = this.a
                }, c.forward = function(a) {
                    var i, j, b = a.x,
                        c = a.y,
                        h = d(b - this.long0);
                    Math.abs(c) <= f && (i = this.x0 + this.R * h, j = this.y0);
                    var k = g(2 * Math.abs(c / Math.PI));
                    (Math.abs(h) <= f || Math.abs(Math.abs(c) - e) <= f) && (i = this.x0, j = c >= 0 ? this.y0 + Math.PI * this.R * Math.tan(.5 * k) : this.y0 + Math.PI * this.R * -Math.tan(.5 * k));
                    var l = .5 * Math.abs(Math.PI / h - h / Math.PI),
                        m = l * l,
                        n = Math.sin(k),
                        o = Math.cos(k),
                        p = o / (n + o - 1),
                        q = p * p,
                        r = p * (2 / n - 1),
                        s = r * r,
                        t = Math.PI * this.R * (l * (p - s) + Math.sqrt(m * (p - s) * (p - s) - (s + m) * (q - s))) / (s + m);
                    h < 0 && (t = -t), i = this.x0 + t;
                    var u = m + p;
                    return t = Math.PI * this.R * (r * u - l * Math.sqrt((s + m) * (m + 1) - u * u)) / (s + m), j = c >= 0 ? this.y0 + t : this.y0 - t, a.x = i, a.y = j, a
                }, c.inverse = function(a) {
                    var b, c, e, g, h, i, j, k, l, m, n, o, p;
                    return a.x -= this.x0, a.y -= this.y0, n = Math.PI * this.R, e = a.x / n, g = a.y / n, h = e * e + g * g, i = -Math.abs(g) * (1 + h), j = i - 2 * g * g + e * e, k = -2 * i + 1 + 2 * g * g + h * h, p = g * g / k + (2 * j * j * j / k / k / k - 9 * i * j / k / k) / 27, l = (i - j * j / 3 / k) / k, m = 2 * Math.sqrt(-l / 3), n = 3 * p / l / m, Math.abs(n) > 1 && (n = n >= 0 ? 1 : -1), o = Math.acos(n) / 3, c = a.y >= 0 ? (-m * Math.cos(o + Math.PI / 3) - j / 3 / k) * Math.PI : -(-m * Math.cos(o + Math.PI / 3) - j / 3 / k) * Math.PI, b = Math.abs(e) < f ? this.long0 : d(this.long0 + Math.PI * (h - 1 + Math.sqrt(1 + 2 * (e * e - g * g) + h * h)) / 2 / e), a.x = b, a.y = c, a
                }, c.names = ["Van_der_Grinten_I", "VanDerGrinten", "vandg"]
            }, {
                "../common/adjust_lon": 5,
                "../common/asinz": 6
            }],
            65: [function(a, b, c) {
                var d = .017453292519943295,
                    e = 57.29577951308232,
                    f = 1,
                    g = 2,
                    h = a("./datum_transform"),
                    i = a("./adjust_axis"),
                    j = a("./Proj"),
                    k = a("./common/toPoint");
                b.exports = function a(b, c, l) {
                    function m(a, b) {
                        return (a.datum.datum_type === f || a.datum.datum_type === g) && "WGS84" !== b.datumCode
                    }
                    var n;
                    return Array.isArray(l) && (l = k(l)), b.datum && c.datum && (m(b, c) || m(c, b)) && (n = new j("WGS84"), a(b, n, l), b = n), "enu" !== b.axis && i(b, !1, l), "longlat" === b.projName ? (l.x *= d, l.y *= d) : (b.to_meter && (l.x *= b.to_meter, l.y *= b.to_meter), b.inverse(l)), b.from_greenwich && (l.x += b.from_greenwich), l = h(b.datum, c.datum, l), c.from_greenwich && (l.x -= c.from_greenwich), "longlat" === c.projName ? (l.x *= e, l.y *= e) : (c.forward(l), c.to_meter && (l.x /= c.to_meter, l.y /= c.to_meter)), "enu" !== c.axis && i(c, !0, l), l
                }
            }, {
                "./Proj": 2,
                "./adjust_axis": 3,
                "./common/toPoint": 23,
                "./datum_transform": 31
            }],
            66: [function(a, b, c) {
                function d(a, b, c) {
                    a[b] = c.map(function(a) {
                        var b = {};
                        return e(a, b), b
                    }).reduce(function(a, b) {
                        return j(a, b)
                    }, {})
                }

                function e(a, b) {
                    var c;
                    return Array.isArray(a) ? (c = a.shift(), "PARAMETER" === c && (c = a.shift()), 1 === a.length ? Array.isArray(a[0]) ? (b[c] = {}, e(a[0], b[c])) : b[c] = a[0] : a.length ? "TOWGS84" === c ? b[c] = a : (b[c] = {}, ["UNIT", "PRIMEM", "VERT_DATUM"].indexOf(c) > -1 ? (b[c] = {
                        name: a[0].toLowerCase(),
                        convert: a[1]
                    }, 3 === a.length && (b[c].auth = a[2])) : "SPHEROID" === c ? (b[c] = {
                        name: a[0],
                        a: a[1],
                        rf: a[2]
                    }, 4 === a.length && (b[c].auth = a[3])) : ["GEOGCS", "GEOCCS", "DATUM", "VERT_CS", "COMPD_CS", "LOCAL_CS", "FITTED_CS", "LOCAL_DATUM"].indexOf(c) > -1 ? (a[0] = ["name", a[0]], d(b, c, a)) : a.every(function(a) {
                        return Array.isArray(a)
                    }) ? d(b, c, a) : e(a, b[c])) : b[c] = !0, void 0) : void(b[a] = !0)
                }

                function f(a, b) {
                    var c = b[0],
                        d = b[1];
                    !(c in a) && d in a && (a[c] = a[d], 3 === b.length && (a[c] = b[2](a[c])))
                }

                function g(a) {
                    return a * i
                }

                function h(a) {
                    function b(b) {
                        var c = a.to_meter || 1;
                        return parseFloat(b, 10) * c
                    }
                    "GEOGCS" === a.type ? a.projName = "longlat" : "LOCAL_CS" === a.type ? (a.projName = "identity", a.local = !0) : "object" == typeof a.PROJECTION ? a.projName = Object.keys(a.PROJECTION)[0] : a.projName = a.PROJECTION, a.UNIT && (a.units = a.UNIT.name.toLowerCase(), "metre" === a.units && (a.units = "meter"), a.UNIT.convert && ("GEOGCS" === a.type ? a.DATUM && a.DATUM.SPHEROID && (a.to_meter = parseFloat(a.UNIT.convert, 10) * a.DATUM.SPHEROID.a) : a.to_meter = parseFloat(a.UNIT.convert, 10))), a.GEOGCS && (a.GEOGCS.DATUM ? a.datumCode = a.GEOGCS.DATUM.name.toLowerCase() : a.datumCode = a.GEOGCS.name.toLowerCase(), "d_" === a.datumCode.slice(0, 2) && (a.datumCode = a.datumCode.slice(2)), "new_zealand_geodetic_datum_1949" !== a.datumCode && "new_zealand_1949" !== a.datumCode || (a.datumCode = "nzgd49"), "wgs_1984" === a.datumCode && ("Mercator_Auxiliary_Sphere" === a.PROJECTION && (a.sphere = !0), a.datumCode = "wgs84"), "_ferro" === a.datumCode.slice(-6) && (a.datumCode = a.datumCode.slice(0, -6)), "_jakarta" === a.datumCode.slice(-8) && (a.datumCode = a.datumCode.slice(0, -8)), ~a.datumCode.indexOf("belge") && (a.datumCode = "rnb72"), a.GEOGCS.DATUM && a.GEOGCS.DATUM.SPHEROID && (a.ellps = a.GEOGCS.DATUM.SPHEROID.name.replace("_19", "").replace(/[Cc]larke\_18/, "clrk"), "international" === a.ellps.toLowerCase().slice(0, 13) && (a.ellps = "intl"), a.a = a.GEOGCS.DATUM.SPHEROID.a, a.rf = parseFloat(a.GEOGCS.DATUM.SPHEROID.rf, 10)), ~a.datumCode.indexOf("osgb_1936") && (a.datumCode = "osgb36")), a.b && !isFinite(a.b) && (a.b = a.a);
                    var c = function(b) {
                            return f(a, b)
                        },
                        d = [
                            ["standard_parallel_1", "Standard_Parallel_1"],
                            ["standard_parallel_2", "Standard_Parallel_2"],
                            ["false_easting", "False_Easting"],
                            ["false_northing", "False_Northing"],
                            ["central_meridian", "Central_Meridian"],
                            ["latitude_of_origin", "Latitude_Of_Origin"],
                            ["latitude_of_origin", "Central_Parallel"],
                            ["scale_factor", "Scale_Factor"],
                            ["k0", "scale_factor"],
                            ["latitude_of_center", "Latitude_of_center"],
                            ["lat0", "latitude_of_center", g],
                            ["longitude_of_center", "Longitude_Of_Center"],
                            ["longc", "longitude_of_center", g],
                            ["x0", "false_easting", b],
                            ["y0", "false_northing", b],
                            ["long0", "central_meridian", g],
                            ["lat0", "latitude_of_origin", g],
                            ["lat0", "standard_parallel_1", g],
                            ["lat1", "standard_parallel_1", g],
                            ["lat2", "standard_parallel_2", g],
                            ["alpha", "azimuth", g],
                            ["srsCode", "name"]
                        ];
                    d.forEach(c), !a.long0 && a.longc && ("Albers_Conic_Equal_Area" === a.projName || "Lambert_Azimuthal_Equal_Area" === a.projName) && (a.long0 = a.longc), !a.lat_ts && a.lat1 && ("Stereographic_South_Pole" === a.projName || "Polar Stereographic (variant B)" === a.projName) && (a.lat0 = g(a.lat1 > 0 ? 90 : -90), a.lat_ts = a.lat1)
                }
                var i = .017453292519943295,
                    j = a("./extend");
                b.exports = function(a, b) {
                    var c = JSON.parse(("," + a).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g, ',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g, ',"$1"]').replace(/,\["VERTCS".+/, "")),
                        d = c.shift(),
                        f = c.shift();
                    c.unshift(["name", f]), c.unshift(["type", d]), c.unshift("output");
                    var g = {};
                    return e(c, g), h(g.output), j(b, g.output)
                }
            }, {
                "./extend": 34
            }],
            67: [function(a, b, c) {
                function d(a) {
                    return a * (Math.PI / 180)
                }

                function e(a) {
                    return 180 * (a / Math.PI)
                }

                function f(a) {
                    var i, j, k, l, m, n, o, r, s, b = a.lat,
                        c = a.lon,
                        e = 6378137,
                        f = .00669438,
                        g = .9996,
                        p = d(b),
                        q = d(c);
                    s = Math.floor((c + 180) / 6) + 1, 180 === c && (s = 60), b >= 56 && b < 64 && c >= 3 && c < 12 && (s = 32), b >= 72 && b < 84 && (c >= 0 && c < 9 ? s = 31 : c >= 9 && c < 21 ? s = 33 : c >= 21 && c < 33 ? s = 35 : c >= 33 && c < 42 && (s = 37)), i = 6 * (s - 1) - 180 + 3, r = d(i), j = f / (1 - f), k = e / Math.sqrt(1 - f * Math.sin(p) * Math.sin(p)), l = Math.tan(p) * Math.tan(p), m = j * Math.cos(p) * Math.cos(p), n = Math.cos(p) * (q - r), o = e * ((1 - f / 4 - 3 * f * f / 64 - 5 * f * f * f / 256) * p - (3 * f / 8 + 3 * f * f / 32 + 45 * f * f * f / 1024) * Math.sin(2 * p) + (15 * f * f / 256 + 45 * f * f * f / 1024) * Math.sin(4 * p) - 35 * f * f * f / 3072 * Math.sin(6 * p));
                    var t = g * k * (n + (1 - l + m) * n * n * n / 6 + (5 - 18 * l + l * l + 72 * m - 58 * j) * n * n * n * n * n / 120) + 5e5,
                        u = g * (o + k * Math.tan(p) * (n * n / 2 + (5 - l + 9 * m + 4 * m * m) * n * n * n * n / 24 + (61 - 58 * l + l * l + 600 * m - 330 * j) * n * n * n * n * n * n / 720));
                    return b < 0 && (u += 1e7), {
                        northing: Math.round(u),
                        easting: Math.round(t),
                        zoneNumber: s,
                        zoneLetter: h(b)
                    }
                }

                function g(a) {
                    var b = a.northing,
                        c = a.easting,
                        d = a.zoneLetter,
                        f = a.zoneNumber;
                    if (f < 0 || f > 60) return null;
                    var k, m, n, o, p, q, r, s, t, u, h = .9996,
                        i = 6378137,
                        j = .00669438,
                        l = (1 - Math.sqrt(1 - j)) / (1 + Math.sqrt(1 - j)),
                        v = c - 5e5,
                        w = b;
                    d < "N" && (w -= 1e7), s = 6 * (f - 1) - 180 + 3, k = j / (1 - j), r = w / h, t = r / (i * (1 - j / 4 - 3 * j * j / 64 - 5 * j * j * j / 256)), u = t + (3 * l / 2 - 27 * l * l * l / 32) * Math.sin(2 * t) + (21 * l * l / 16 - 55 * l * l * l * l / 32) * Math.sin(4 * t) + 151 * l * l * l / 96 * Math.sin(6 * t), m = i / Math.sqrt(1 - j * Math.sin(u) * Math.sin(u)), n = Math.tan(u) * Math.tan(u), o = k * Math.cos(u) * Math.cos(u), p = i * (1 - j) / Math.pow(1 - j * Math.sin(u) * Math.sin(u), 1.5), q = v / (m * h);
                    var x = u - m * Math.tan(u) / p * (q * q / 2 - (5 + 3 * n + 10 * o - 4 * o * o - 9 * k) * q * q * q * q / 24 + (61 + 90 * n + 298 * o + 45 * n * n - 252 * k - 3 * o * o) * q * q * q * q * q * q / 720);
                    x = e(x);
                    var y = (q - (1 + 2 * n + o) * q * q * q / 6 + (5 - 2 * o + 28 * n - 3 * o * o + 8 * k + 24 * n * n) * q * q * q * q * q / 120) / Math.cos(u);
                    y = s + e(y);
                    var z;
                    if (a.accuracy) {
                        var A = g({
                            northing: a.northing + a.accuracy,
                            easting: a.easting + a.accuracy,
                            zoneLetter: a.zoneLetter,
                            zoneNumber: a.zoneNumber
                        });
                        z = {
                            top: A.lat,
                            right: A.lon,
                            bottom: x,
                            left: y
                        }
                    } else z = {
                        lat: x,
                        lon: y
                    };
                    return z
                }

                function h(a) {
                    var b = "Z";
                    return 84 >= a && a >= 72 ? b = "X" : 72 > a && a >= 64 ? b = "W" : 64 > a && a >= 56 ? b = "V" : 56 > a && a >= 48 ? b = "U" : 48 > a && a >= 40 ? b = "T" : 40 > a && a >= 32 ? b = "S" : 32 > a && a >= 24 ? b = "R" : 24 > a && a >= 16 ? b = "Q" : 16 > a && a >= 8 ? b = "P" : 8 > a && a >= 0 ? b = "N" : 0 > a && a >= -8 ? b = "M" : -8 > a && a >= -16 ? b = "L" : -16 > a && a >= -24 ? b = "K" : -24 > a && a >= -32 ? b = "J" : -32 > a && a >= -40 ? b = "H" : -40 > a && a >= -48 ? b = "G" : -48 > a && a >= -56 ? b = "F" : -56 > a && a >= -64 ? b = "E" : -64 > a && a >= -72 ? b = "D" : -72 > a && a >= -80 && (b = "C"), b
                }

                function i(a, b) {
                    var c = "00000" + a.easting,
                        d = "00000" + a.northing;
                    return a.zoneNumber + a.zoneLetter + j(a.easting, a.northing, a.zoneNumber) + c.substr(c.length - 5, b) + d.substr(d.length - 5, b)
                }

                function j(a, b, c) {
                    var d = k(c),
                        e = Math.floor(a / 1e5),
                        f = Math.floor(b / 1e5) % 20;
                    return l(e, f, d)
                }

                function k(a) {
                    var b = a % q;
                    return 0 === b && (b = q), b
                }

                function l(a, b, c) {
                    var d = c - 1,
                        e = r.charCodeAt(d),
                        f = s.charCodeAt(d),
                        g = e + a - 1,
                        h = f + b,
                        i = !1;
                    g > x && (g = g - x + t - 1, i = !0), (g === u || e < u && g > u || (g > u || e < u) && i) && g++, (g === v || e < v && g > v || (g > v || e < v) && i) && (g++, g === u && g++), g > x && (g = g - x + t - 1), h > w ? (h = h - w + t - 1, i = !0) : i = !1, (h === u || f < u && h > u || (h > u || f < u) && i) && h++, (h === v || f < v && h > v || (h > v || f < v) && i) && (h++, h === u && h++), h > w && (h = h - w + t - 1);
                    var j = String.fromCharCode(g) + String.fromCharCode(h);
                    return j
                }

                function m(a) {
                    if (a && 0 === a.length) throw "MGRSPoint coverting from nothing";
                    for (var e, b = a.length, c = null, d = "", f = 0; !/[A-Z]/.test(e = a.charAt(f));) {
                        if (f >= 2) throw "MGRSPoint bad conversion from: " + a;
                        d += e, f++
                    }
                    var g = parseInt(d, 10);
                    if (0 === f || f + 3 > b) throw "MGRSPoint bad conversion from: " + a;
                    var h = a.charAt(f++);
                    if (h <= "A" || "B" === h || "Y" === h || h >= "Z" || "I" === h || "O" === h) throw "MGRSPoint zone letter " + h + " not handled: " + a;
                    c = a.substring(f, f += 2);
                    for (var i = k(g), j = n(c.charAt(0), i), l = o(c.charAt(1), i); l < p(h);) l += 2e6;
                    var m = b - f;
                    if (m % 2 !== 0) throw "MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters" + a;
                    var t, u, v, w, x, q = m / 2,
                        r = 0,
                        s = 0;
                    return q > 0 && (t = 1e5 / Math.pow(10, q), u = a.substring(f, f + q), r = parseFloat(u) * t, v = a.substring(f + q), s = parseFloat(v) * t), w = r + j, x = s + l, {
                        easting: w,
                        northing: x,
                        zoneLetter: h,
                        zoneNumber: g,
                        accuracy: t
                    }
                }

                function n(a, b) {
                    for (var c = r.charCodeAt(b - 1), d = 1e5, e = !1; c !== a.charCodeAt(0);) {
                        if (c++, c === u && c++, c === v && c++, c > x) {
                            if (e) throw "Bad character: " + a;
                            c = t, e = !0
                        }
                        d += 1e5
                    }
                    return d
                }

                function o(a, b) {
                    if (a > "V") throw "MGRSPoint given invalid Northing " + a;
                    for (var c = s.charCodeAt(b - 1), d = 0, e = !1; c !== a.charCodeAt(0);) {
                        if (c++, c === u && c++, c === v && c++, c > w) {
                            if (e) throw "Bad character: " + a;
                            c = t, e = !0
                        }
                        d += 1e5
                    }
                    return d
                }

                function p(a) {
                    var b;
                    switch (a) {
                        case "C":
                            b = 11e5;
                            break;
                        case "D":
                            b = 2e6;
                            break;
                        case "E":
                            b = 28e5;
                            break;
                        case "F":
                            b = 37e5;
                            break;
                        case "G":
                            b = 46e5;
                            break;
                        case "H":
                            b = 55e5;
                            break;
                        case "J":
                            b = 64e5;
                            break;
                        case "K":
                            b = 73e5;
                            break;
                        case "L":
                            b = 82e5;
                            break;
                        case "M":
                            b = 91e5;
                            break;
                        case "N":
                            b = 0;
                            break;
                        case "P":
                            b = 8e5;
                            break;
                        case "Q":
                            b = 17e5;
                            break;
                        case "R":
                            b = 26e5;
                            break;
                        case "S":
                            b = 35e5;
                            break;
                        case "T":
                            b = 44e5;
                            break;
                        case "U":
                            b = 53e5;
                            break;
                        case "V":
                            b = 62e5;
                            break;
                        case "W":
                            b = 7e6;
                            break;
                        case "X":
                            b = 79e5;
                            break;
                        default:
                            b = -1
                    }
                    if (b >= 0) return b;
                    throw "Invalid zone letter: " + a
                }
                var q = 6,
                    r = "AJSAJS",
                    s = "AFAFAF",
                    t = 65,
                    u = 73,
                    v = 79,
                    w = 86,
                    x = 90;
                c.forward = function(a, b) {
                    return b = b || 5, i(f({
                        lat: a[1],
                        lon: a[0]
                    }), b)
                }, c.inverse = function(a) {
                    var b = g(m(a.toUpperCase()));
                    return b.lat && b.lon ? [b.lon, b.lat, b.lon, b.lat] : [b.left, b.bottom, b.right, b.top]
                }, c.toPoint = function(a) {
                    var b = g(m(a.toUpperCase()));
                    return b.lat && b.lon ? [b.lon, b.lat] : [(b.left + b.right) / 2, (b.top + b.bottom) / 2]
                }
            }, {}],
            68: [function(a, b, c) {
                b.exports = {
                    name: "proj4",
                    version: "2.3.14",
                    description: "Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",
                    main: "lib/index.js",
                    directories: {
                        test: "test",
                        doc: "docs"
                    },
                    scripts: {
                        test: "./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"
                    },
                    repository: {
                        type: "git",
                        url: "git://github.com/proj4js/proj4js.git"
                    },
                    author: "",
                    license: "MIT",
                    jam: {
                        main: "dist/proj4.js",
                        include: ["dist/proj4.js", "README.md", "AUTHORS", "LICENSE.md"]
                    },
                    devDependencies: {
                        "grunt-cli": "~0.1.13",
                        grunt: "~0.4.2",
                        "grunt-contrib-connect": "~0.6.0",
                        "grunt-contrib-jshint": "~0.8.0",
                        chai: "~1.8.1",
                        mocha: "~1.17.1",
                        "grunt-mocha-phantomjs": "~0.4.0",
                        browserify: "~12.0.1",
                        "grunt-browserify": "~4.0.1",
                        "grunt-contrib-uglify": "~0.11.1",
                        curl: "git://github.com/cujojs/curl.git",
                        istanbul: "~0.2.4",
                        tin: "~0.4.0"
                    },
                    dependencies: {
                        mgrs: "~0.0.2"
                    }
                }
            }, {}],
            "./includedProjections": [function(a, b, c) {
                b.exports = a("hTEDpn")
            }, {}],
            hTEDpn: [function(a, b, c) {
                var d = [a("./lib/projections/tmerc"), a("./lib/projections/utm"), a("./lib/projections/sterea"), a("./lib/projections/stere"), a("./lib/projections/somerc"), a("./lib/projections/omerc"), a("./lib/projections/lcc"), a("./lib/projections/krovak"), a("./lib/projections/cass"), a("./lib/projections/laea"), a("./lib/projections/aea"), a("./lib/projections/gnom"), a("./lib/projections/cea"), a("./lib/projections/eqc"), a("./lib/projections/poly"), a("./lib/projections/nzmg"), a("./lib/projections/mill"), a("./lib/projections/sinu"), a("./lib/projections/moll"), a("./lib/projections/eqdc"), a("./lib/projections/vandg"), a("./lib/projections/aeqd")];
                b.exports = function(a) {
                    d.forEach(function(b) {
                        a.Proj.projections.add(b)
                    })
                }
            }, {
                "./lib/projections/aea": 40,
                "./lib/projections/aeqd": 41,
                "./lib/projections/cass": 42,
                "./lib/projections/cea": 43,
                "./lib/projections/eqc": 44,
                "./lib/projections/eqdc": 45,
                "./lib/projections/gnom": 47,
                "./lib/projections/krovak": 48,
                "./lib/projections/laea": 49,
                "./lib/projections/lcc": 50,
                "./lib/projections/mill": 53,
                "./lib/projections/moll": 54,
                "./lib/projections/nzmg": 55,
                "./lib/projections/omerc": 56,
                "./lib/projections/poly": 57,
                "./lib/projections/sinu": 58,
                "./lib/projections/somerc": 59,
                "./lib/projections/stere": 60,
                "./lib/projections/sterea": 61,
                "./lib/projections/tmerc": 62,
                "./lib/projections/utm": 63,
                "./lib/projections/vandg": 64
            }]
        }, {}, [36])(36)
    }),
    function(a) {
        var b, c;
        if ("function" == typeof define && define.amd) define("proj4.leaflet", ["leaflet", "proj4"], a);
        else if ("undefined" != typeof module) b = require("leaflet"), c = require("proj4"), module.exports = a(b, c);
        else {
            if ("undefined" == typeof window.L || "undefined" == typeof window.proj4) throw "Leaflet and proj4 must be loaded first";
            a(window.L, window.proj4)
        }
    }(function(a, b) {
        return a.Proj = {}, a.Proj._isProj4Obj = function(a) {
            return "undefined" != typeof a.inverse && "undefined" != typeof a.forward
        }, a.Proj.ScaleDependantTransformation = function(a) {
            this.scaleTransforms = a
        }, a.Proj.ScaleDependantTransformation.prototype.transform = function(a, b) {
            return this.scaleTransforms[b].transform(a, b)
        }, a.Proj.ScaleDependantTransformation.prototype.untransform = function(a, b) {
            return this.scaleTransforms[b].untransform(a, b)
        }, a.Proj.Projection = a.Class.extend({
            initialize: function(c, d) {
                if (a.Proj._isProj4Obj(c)) this._proj = c;
                else {
                    var e = c;
                    if (d) b.defs(e, d);
                    else if (void 0 === b.defs[e]) {
                        var f = e.split(":");
                        if (f.length > 3 && (e = f[f.length - 3] + ":" + f[f.length - 1]), void 0 === b.defs[e]) throw "No projection definition for code " + e
                    }
                    this._proj = b(e)
                }
            },
            project: function(b) {
                var c = this._proj.forward([b.lng, b.lat]);
                return new a.Point(c[0], c[1])
            },
            unproject: function(b, c) {
                var d = this._proj.inverse([b.x, b.y]);
                return new a.LatLng(d[1], d[0], c)
            }
        }), a.Proj.CRS = a.Class.extend({
            includes: a.CRS,
            options: {
                transformation: new a.Transformation(1, 0, -1, 0)
            },
            initialize: function(b, c, d) {
                var e, f, g, h;
                if (a.Proj._isProj4Obj(b) ? (f = b, e = f.srsCode, h = c || {}, this.projection = new a.Proj.Projection(f)) : (e = b, g = c, h = d || {}, this.projection = new a.Proj.Projection(e, g)), a.Util.setOptions(this, h), this.code = e, this.transformation = this.options.transformation, this.options.origin && (this.transformation = new a.Transformation(1, -this.options.origin[0], -1, this.options.origin[1])), this.options.scales) this._scales = this.options.scales;
                else if (this.options.resolutions) {
                    this._scales = [];
                    for (var i = this.options.resolutions.length - 1; i >= 0; i--) this.options.resolutions[i] && (this._scales[i] = 1 / this.options.resolutions[i]);
                }
            },
            scale: function(a) {
                var c, d, e, f, b = Math.floor(a);
                return a === b ? this._scales[a] : (c = this._scales[b], d = this._scales[b + 1], e = d - c, f = a - b, c + e * f)
            },
            getSize: function(b) {
                var d, e, f, c = this.options.bounds;
                return c ? (d = this.scale(b), e = this.transformation.transform(c.min, d), f = this.transformation.transform(c.max, d), a.point(Math.abs(f.x - e.x), Math.abs(f.y - e.y))) : (d = 256 * Math.pow(2, b), a.point(d, d))
            }
        }), a.Proj.CRS.TMS = a.Proj.CRS.extend({
            options: {
                tileSize: 256
            },
            initialize: function(b, c, d, e) {
                var f, g, h, i, j;
                a.Proj._isProj4Obj(b) ? (h = b, i = c, j = d || {}, j.origin = [i[0], i[3]], a.Proj.CRS.prototype.initialize.call(this, h, j)) : (f = b, g = c, i = d, j = e || {}, j.origin = [i[0], i[3]], a.Proj.CRS.prototype.initialize.call(this, f, g, j)), this.projectedBounds = i, this._sizes = this._calculateSizes()
            },
            _calculateSizes: function() {
                var d, e, f, g, b = [],
                    c = this.projectedBounds;
                for (e = this._scales.length - 1; e >= 0; e--) this._scales[e] && (d = this.options.tileSize / this._scales[e], f = Math.ceil(parseFloat((c[2] - c[0]) / d).toPrecision(3)) * d * this._scales[e], g = Math.ceil(parseFloat((c[3] - c[1]) / d).toPrecision(3)) * d * this._scales[e], b[e] = a.point(f, g));
                return b
            },
            getSize: function(a) {
                return this._sizes[a]
            }
        }), a.Proj.TileLayer = {}, a.Proj.TileLayer.TMS = a.TileLayer.extend({
            options: {
                continuousWorld: !0
            },
            initialize: function(b, c, d) {
                var f, g, h, i, e = !0;
                if (!(c instanceof a.Proj.CRS.TMS)) throw "CRS is not L.Proj.CRS.TMS.";
                for (a.TileLayer.prototype.initialize.call(this, b, d), this.options.tms = !1, this.crs = c, h = this.crs.projectedBounds, i = this.options.minZoom; i < this.options.maxZoom && e; i++) {
                    var j = (h[3] - h[1]) / this._projectedTileSize(i);
                    e = Math.abs(j - Math.round(j)) > .001
                }
                if (!e) {
                    for (f = {}, i = this.options.minZoom; i < this.options.maxZoom; i++) g = h[1] + Math.ceil((h[3] - h[1]) / this._projectedTileSize(i)) * this._projectedTileSize(i), f[this.crs.scale(i)] = new a.Transformation(1, -h[0], -1, g);
                    this.crs = new a.Proj.CRS.TMS(this.crs.projection._proj, h, this.crs.options), this.crs.transformation = new a.Proj.ScaleDependantTransformation(f)
                }
            },
            getTileUrl: function(b) {
                var c = this._map.getZoom(),
                    d = Math.ceil((this.crs.projectedBounds[3] - this.crs.projectedBounds[1]) / this._projectedTileSize(c));
                return a.Util.template(this._url, a.Util.extend({
                    s: this._getSubdomain(b),
                    z: this._getZoomForUrl(),
                    x: b.x,
                    y: d - b.y - 1
                }, this.options))
            },
            _projectedTileSize: function(a) {
                return this.options.tileSize / this.crs.scale(a)
            }
        }), a.Proj.GeoJSON = a.GeoJSON.extend({
            initialize: function(b, c) {
                this._callLevel = 0, a.GeoJSON.prototype.initialize.call(this, null, c), b && this.addData(b)
            },
            addData: function(b) {
                var c;
                b && (b.crs && "name" === b.crs.type ? c = new a.Proj.CRS(b.crs.properties.name) : b.crs && b.crs.type && (c = new a.Proj.CRS(b.crs.type + ":" + b.crs.properties.code)), void 0 !== c && (this.options.coordsToLatLng = function(b) {
                    var d = a.point(b[0], b[1]);
                    return c.projection.unproject(d)
                })), this._callLevel++;
                try {
                    a.GeoJSON.prototype.addData.call(this, b)
                } finally {
                    this._callLevel--, 0 === this._callLevel && delete this.options.coordsToLatLng
                }
            }
        }), a.Proj.geoJson = function(b, c) {
            return new a.Proj.GeoJSON(b, c)
        }, a.Proj.ImageOverlay = a.ImageOverlay.extend({
            initialize: function(b, c, d) {
                a.ImageOverlay.prototype.initialize.call(this, b, null, d), this._projBounds = c
            },
            _animateZoom: function(b) {
                var c = a.point(this._projBounds.min.x, this._projBounds.max.y),
                    d = a.point(this._projBounds.max.x, this._projBounds.min.y),
                    e = this._projectedToNewLayerPoint(c, b.zoom, b.center),
                    f = this._projectedToNewLayerPoint(d, b.zoom, b.center).subtract(e),
                    g = e.add(f._multiplyBy((1 - 1 / b.scale) / 2));
                this._image.style[a.DomUtil.TRANSFORM] = a.DomUtil.getTranslateString(g) + " scale(" + this._map.getZoomScale(b.zoom) + ") "
            },
            _reset: function() {
                var b = this._map.getZoom(),
                    c = this._map.getPixelOrigin(),
                    d = a.bounds(this._transform(this._projBounds.min, b)._subtract(c), this._transform(this._projBounds.max, b)._subtract(c)),
                    e = d.getSize(),
                    f = this._image;
                a.DomUtil.setPosition(f, d.min), f.style.width = e.x + "px", f.style.height = e.y + "px"
            },
            _projectedToNewLayerPoint: function(a, b, c) {
                var d = this._map._getNewTopLeftPoint(c, b).add(this._map._getMapPanePos());
                return this._transform(a, b)._subtract(d)
            },
            _transform: function(a, b) {
                var c = this._map.options.crs,
                    d = c.transformation,
                    e = c.scale(b);
                return d.transform(a, e)
            }
        }), a.Proj.imageOverlay = function(b, c, d) {
            return new a.Proj.ImageOverlay(b, c, d)
        }, "undefined" != typeof a.CRS && (a.CRS.proj4js = function() {
            return function(b, c, d, e) {
                return e = e || {}, d && (e.transformation = d), new a.Proj.CRS(b, c, e)
            }
        }()), a.Proj
    }), define("text!components/app/map/mapTemplate.html", [], function() {
        return '<span class="loading-animation hide-on-app-loaded map-loading-animation"></span>    \r\n<div id="basemap"></div>\r\n'
    }), define("components/app/map/MapView", ["jquery", "underscore", "backbone", "leaflet", "esri.leaflet", "leaflet.draw", "leaflet.label", "leaflet.markercluster", "proj4.leaflet", "proj4", "text!./mapTemplate.html"], function(a, b, c, d, e, f, g, h, i, j, k) {
        var l = c.View.extend({
            initialize: function() {
                this._layerGroup = new L.layerGroup, this._baseLayerGroup = new L.layerGroup, this.viewUpdating = !1, this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:view", this.handleViewUpdate), this.listenTo(this.model, "change:baseLayers", this.handleBaseLayersUpdate), this.listenTo(this.model, "change:addLayers", this.handleAddLayersUpdate), this.listenTo(this.model, "change:removeLayers", this.handleRemoveLayersUpdate), this.listenTo(this.model, "change:activeLocation", this.handleLayersUpdate), this.listenTo(this.model, "change:filteredLocations", this.handleLocationsUpdate), this.listenTo(this.model, "change:customLayerEdit", this.handleCustomsUpdate), this.listenTo(this.model, "change:customLayerData", this.handleCustomsUpdate), this.listenTo(this.model, "change:mapControl", this.mapControl), this.listenTo(this.model, "change:invalidateSize", this.invalidateSize), this.render();
                var a = this;
                waitFor(function() {
                    return a.model.mapConfigLoaded()
                }, function() {
                    a.configureMap()
                })
            },
            render: function() {
                this.$el.html(b.template(k)({
                    t: tlang
                }));
                var a = this;
                return waitFor(function() {
                    return a.model.mapConfigured()
                }, function() {
                    a.updateBaseLayers()
                }), this
            },
            configureMap: function() {
                var a = this.model.getConfig();
                this.model.setMapOptions(a.mapOptions), this.initProjections(), this._map = L.map(a.mapID, this.model.getMapOptions()).on("zoomstart", b.bind(this.onZoomStart, this)).on("movestart", b.bind(this.onMoveStart, this)).on("zoomend", b.bind(this.onZoomEnd, this)).on("moveend", b.bind(this.onMoveEnd, this)).on("resize", b.debounce(b.bind(this.resize, this), 500)), this.initDraw(), this.updateMapView(), this._zoomControl = L.control.zoom({
                    zoomInText: '<span class="icon-wwf_plus"></span>',
                    zoomOutText: '<span class="icon-wwf_minus"></span>'
                });
                var c = L.control.attribution({
                    position: "bottomleft"
                }).setPrefix("").addAttribution(this.model.getConfig().attribution);
                this._map.addControl(c), this._layerGroup.addTo(this._map), this._baseLayerGroup.addTo(this._map), this.model.setMap(this._map), this.model.mapConfigured(!0)
            },
            initProjections: function() {
                "undefined" != typeof this.model.getConfig().proj4defs && j.defs(this.model.getConfig().proj4defs);
                var a = this.model.getConfig().projection;
                "undefined" != typeof a && (this.model.setCrs(new L.Proj.CRS(a.crs, a.proj4def, {
                    resolutions: a.resolutions,
                    origin: a.origin
                })), this.model.setMapOptions(b.extend(this.model.get("mapOptions"), {
                    crs: this.model.getCrs()
                })))
            },
            initDraw: function() {
                this._map.on("draw:created", b.bind(this.onDrawCreated, this)), this._map.on("draw:edited", b.bind(this.onDrawEdited, this)), this._map.on("draw:deleted", b.bind(this.onDrawDeleted, this)), this.updateCustomLayers()
            },
            updateMapView: function() {
                var a = this.model.getView();
                if (null !== a && "string" == typeof a && (a = this.model.getConfigView(a)), null !== a && "undefined" != typeof a && "undefined" != typeof a.center && "undefined" != typeof a.zoom && "undefined" != typeof a.dimensions)
                    if (this.model.mapConfigured()) {
                        var b = this.getZoomForDimensions(a);
                        (this._map.getZoom() !== b || this.roundDegrees(this._map.getCenter().lat) !== a.center.lat || this.roundDegrees(this._map.getCenter().lng) !== a.center.lng) && this._map.setView(a.center, b, {
                            animate: !0
                        })
                    } else {
                        var c = this.model.getDefaultView();
                        this._map.setView(c.center, this.getZoomForDimensions(c), {
                            animate: !0
                        })
                    }
                else {
                    var c = this.model.getDefaultView();
                    this._map.setView(c.center, this.getZoomForDimensions(c), {
                        animate: !0
                    })
                }
                this.triggerMapViewUpdated()
            },
            updateBaseLayers: function() {
                this._baseLayerGroup.clearLayers();
                var a = this;
                this.model.getBaseLayers().each(function(b) {
                    b.getMapLayer(function(b) {
                        a._baseLayerGroup.addLayer(b)
                    }, {
                        map: a._map
                    })
                })
            },
            refreshLayers: function() {},
            addLayers: function() {
                var a = this.model.getAddLayers(),
                    c = this;
                a.length && (b.each(a, function(a) {
                    a.getMapLayer(function(a, b) {
                        "raster" === b.getType() && c._layerGroup.addLayer(a)
                    }, {
                        map: c._map
                    })
                }), waitFor(function() {
                    return !c.model.activeLayersLoading()
                }, function() {
                    b.each(a, function(a) {
                        "raster" !== a.getType() && a.getMapLayer(function(a, b) {
                            waitFor(function() {
                                return !c.zooming && !c.moving
                            }, function() {
                                c._layerGroup.addLayer(a), b.fadeEnabled() && c.$(".leaflet-overlay-pane .wwf-layer-" + b.id).animate({
                                    opacity: 1
                                }, "fast", "linear")
                            })
                        }, {
                            map: c._map
                        })
                    }), c.model.setAddLayers([])
                }))
            },
            removeLayers: function() {
                var a = this.model.getRemoveLayers(),
                    c = this;
                a.length && b.each(a, function(a) {
                    a.getMapLayer(function(a, b) {
                        b.fadeEnabled() ? c.$(".leaflet-overlay-pane .wwf-layer-" + b.id).animate({
                            opacity: 0
                        }, "fast", "linear").promise().done(function() {
                            c._layerGroup.removeLayer(a)
                        }) : c._layerGroup.removeLayer(a)
                    }, {
                        map: c._map
                    }), a.isCustom() && a.getDrawControl()._map && this._map.removeControl(a.getDrawControl())
                }, this)
            },
            updateCustomLayers: function() {
                b.each(this.model.getActiveLayers(), function(a) {
                    a.isCustom() && (a.isEdit() ? a.getDrawControl()._map || (this._map.addControl(a.getDrawControl()), this.$(".leaflet-draw-draw-polyline").html("<span class='icon-wwf_line'></span>"), this.$(".leaflet-draw-draw-polygon").html("<span class='icon-wwf_polygon'></span>"), this.$(".leaflet-draw-draw-rectangle").html("<span class='icon-wwf_square'></span>"), this.$(".leaflet-draw-draw-circle").html("<span class='icon-wwf_circle'></span>"), this.$(".leaflet-draw-draw-marker").html("<span class='icon-wwf_marker'></span>"), this.$(".leaflet-draw-draw-note").html("<span class='icon-wwf_type'></span>"), this.$(".leaflet-draw-edit-edit").html("<span class='icon-wwf_edit'></span>"), this.$(".leaflet-draw-edit-remove").html("<span class='icon-wwf_remove'></span>")) : a.getDrawControl()._map && this._map.removeControl(a.getDrawControl()))
                }, this)
            },
            handleActive: function() {
                if (this.model.isActive()) {
                    this.$el.show();
                    var a = this;
                    waitFor(function() {
                        return a.model.mapConfigured()
                    }, function() {
                        a.invalidateSize(!1)
                    })
                } else this.$el.hide()
            },
            handleViewUpdate: function() {
                var a = this;
                waitFor(function() {
                    return a.model.mapConfigured()
                }, function() {
                    a.updateMapView()
                })
            },
            handleLocationsUpdate: function() {
                var a = this;
                waitFor(function() {
                    return a.model.mapConfigured()
                }, function() {
                    a.refreshLayers()
                })
            },
            handleLayersUpdate: function() {
                var a = this;
                waitFor(function() {
                    return a.model.mapConfigured()
                }, function() {
                    a.refreshLayers()
                })
            },
            handleAddLayersUpdate: function() {
                var a = this;
                waitFor(function() {
                    return a.model.mapConfigured()
                }, function() {
                    a.addLayers()
                })
            },
            handleRemoveLayersUpdate: function() {
                var a = this;
                waitFor(function() {
                    return a.model.mapConfigured()
                }, function() {
                    a.removeLayers()
                })
            },
            handleBaseLayersUpdate: function() {
                var a = this;
                waitFor(function() {
                    return a.model.mapConfigured()
                }, function() {
                    a.updateBaseLayers()
                })
            },
            handleCustomsUpdate: function() {
                var a = this;
                waitFor(function() {
                    return a.model.mapConfigured()
                }, function() {
                    a.updateCustomLayers()
                })
            },
            mapControl: function() {
                var a = this;
                waitFor(function() {
                    return a.model.mapConfigured()
                }, function() {
                    a.model.getMapControl() ? (a.$el.removeClass("control-disabled"), a._zoomControl._map || a._zoomControl.addTo(a._map), a.enableInteractions()) : (a.$el.addClass("control-disabled"), a._zoomControl._map && a._zoomControl.removeFrom(a._map), a.disableInteractions())
                })
            },
            enableInteractions: function() {
                this._map.dragging.enable(), this._map.touchZoom.enable(), this._map.doubleClickZoom.enable(), this._map.scrollWheelZoom.enable(), this._map.boxZoom.enable(), "undefined" != typeof this._map.tap && this._map.tap.enable()
            },
            disableInteractions: function() {
                this._map.dragging.disable(), this._map.touchZoom.disable(), this._map.doubleClickZoom.disable(), this._map.scrollWheelZoom.disable(), this._map.boxZoom.disable(), "undefined" != typeof this._map.tap && this._map.tap.disable()
            },
            resize: function() {
                this.updateMapView()
            },
            invalidateSize: function(a) {
                a = "undefined" != typeof a && a, "undefined" != typeof this._map && this._map.invalidateSize(a)
            },
            onZoomStart: function(a) {
                this.zooming = !0
            },
            onMoveStart: function(a) {
                this.moving = !0
            },
            onZoomEnd: function(a) {
                this.zooming = !1, this.triggerMapViewUpdated()
            },
            onMoveEnd: function(a) {
                this.moving = !1, this.triggerMapViewUpdated()
            },
            onDrawCreated: function(a) {
                var c = a.layer.toGeoJSON();
                c.properties.featureid = Math.random().toString(36).slice(-5), c.properties.type = a.layerType;
                "Polygon" === c.geometry.type && (c.geometry.coordinates[0] = b.map(c.geometry.coordinates[0], function(a) {
                    return [this.roundDegrees(a[0]), this.roundDegrees(a[1])]
                }, this)), "Point" === c.geometry.type && (c.geometry.coordinates = [this.roundDegrees(c.geometry.coordinates[0]), this.roundDegrees(c.geometry.coordinates[1])]), "circle" === a.layerType && (c.properties.radius = Math.round(a.layer._mRadius)), this.$el.trigger("customUpdated", {
                    layer: {
                        id: this.model.get("customLayerEdit"),
                        shapes: [c]
                    }
                })
            },
            onDrawEdited: function(a) {
                var c = [],
                    d = this;
                a.layers.eachLayer(function(e) {
                    var f = e.toGeoJSON();
                    "Polygon" === f.geometry.type && (f.geometry.coordinates[0] = b.map(f.geometry.coordinates[0], function(a) {
                        return [d.roundDegrees(a[0]), d.roundDegrees(a[1])]
                    })), "Point" === f.geometry.type && (f.geometry.coordinates = [d.roundDegrees(f.geometry.coordinates[0]), d.roundDegrees(f.geometry.coordinates[1])]), "circle" === e.feature.properties.type && (f.properties.radius = Math.round(b.values(a.layers._layers)[0]._mRadius)), c.push(f)
                }), this.$el.trigger("customUpdated", {
                    layer: {
                        id: this.model.get("customLayerEdit"),
                        shapes: c
                    }
                })
            },
            onDrawDeleted: function(a) {
                var b = [];
                a.layers.eachLayer(function(a) {
                    b.push(a.feature.properties.featureid)
                }), this.$el.trigger("customDeleted", {
                    layer: {
                        id: this.model.get("customLayerEdit"),
                        shapes: b
                    }
                })
            },
            triggerMapViewUpdated: function() {
                if (!this.viewUpdating) {
                    var a = this;
                    this.viewUpdating = !0, waitFor(function() {
                        return a.model.mapConfigured() && null !== a.model.getView()
                    }, function() {
                        a.viewUpdating = !1;
                        var c = a.model.getView();
                        "undefined" != typeof c && (c.zoom !== a._map.getZoom() || c.center.lat !== a.roundDegrees(a._map.getCenter().lat) || c.center.lng !== a.roundDegrees(a._map.getCenter().lng) || !b.isEqual(c.dimensions, a.getDimensions())) && a.$el.trigger("mapViewUpdated", {
                            zoom: a._map.getZoom(),
                            center: {
                                lat: a.roundDegrees(a._map.getCenter().lat),
                                lng: a.roundDegrees(a._map.getCenter().lng)
                            },
                            dimensions: a.getDimensions()
                        })
                    })
                }
            },
            getDimensions: function() {
                return [this.$el.innerWidth(), this.$el.innerHeight()]
            },
            getZoomOffset: function(a) {
                var b = this.getDimensions(),
                    c = "print" === this.model.getMode() ? 2 * this.model.attributes.config.printMargin : 0,
                    d = [a.dimensions[0] - c, a.dimensions[1] - c],
                    e = 1,
                    f = 0,
                    g = 1;
                if (e = b[0] / b[1] > d[0] / d[1] ? b[1] / d[1] : b[0] / d[0], 1 === e) return f;
                if (e > 1)
                    for (; 1.9 * g < e;) g *= 2, f++;
                else
                    for (var f = 0, g = 1; g > e;) g /= 2, f--;
                return f
            },
            getZoomForDimensions: function(a) {
                return Math.max(Math.min(a.zoom + this.getZoomOffset(a), this._map.getMaxZoom()), this._map.getMinZoom())
            },
            setZoomClass: function() {
                this.$el.removeClass(function(a, b) {
                    return (b.match(/\bzoom-level-\S+/g) || []).join(" ")
                }), this.$el.addClass("zoom-level-" + this.model.getZoom())
            },
            roundDegrees: function(a) {
                return Math.round(1e4 * a) / 1e4
            }
        });
        return l
    }), define("components/app/map/MapModel", ["jquery", "underscore", "backbone", "leaflet"], function(a, b, c, d) {
        var e = c.Model.extend({
            initialize: function(a) {
                this.options = a || {}, this.set("activeLayers", []), this.set("removeLayers", []), this.set("addLayers", []), this.set("keepLayers", []), this.set("mapConfigured", !1), this.set("mapControl", null), this.processMapConfig()
            },
            processMapConfig: function() {
                this.setConfigViews(this.attributes.config.views)
            },
            preloadLayer: function(a) {
                "point" !== a.get("type") && "raster" !== a.get("type") && a.getMapLayer(function() {}, {
                    map: this.attributes.map
                })
            },
            getConfig: function() {
                return this.attributes.config
            },
            getMapOptions: function() {
                var a = b.clone(this.attributes.mapOptions);
                return "print" === this.getMode() && (a.maxZoom = a.maxZoom + 2), a
            },
            mapConfigLoaded: function() {
                return "undefined" != typeof this.attributes.config
            },
            mapConfigured: function(a) {
                return "undefined" != typeof a ? this.set("mapConfigured", a) : this.attributes.mapConfigured
            },
            setView: function(a) {
                this.set("view", a)
            },
            getView: function() {
                return this.attributes.view
            },
            setConfigViews: function(a) {
                this.set("configViews", a)
            },
            getConfigView: function(a) {
                return this.attributes.configViews[a]
            },
            getDefaultView: function() {
                return this.getConfigView("default")
            },
            setBaseLayers: function(a) {
                this.set("baseLayers", a)
            },
            getBaseLayers: function() {
                return this.attributes.baseLayers
            },
            setActiveLayers: function(a) {
                this.set("removeLayers", b.difference(this.attributes.activeLayers, a)), this.set("addLayers", b.difference(a, this.attributes.activeLayers)), this.set("keepLayers", b.intersection(this.attributes.activeLayers, a));
                var c = this;
                waitFor(function() {
                    return c.mapConfigured() && !c.activeLayersLoading()
                }, function() {
                    c.set("activeLayers", a)
                })
            },
            activeLayersLoading: function() {
                var a = b.where(b.pluck(this.attributes.addLayers, "attributes"), {
                    loading: !1
                }).length;
                return a.length === this.attributes.addLayers.length
            },
            getActiveLayers: function() {
                return this.attributes.activeLayers
            },
            getRemoveLayers: function() {
                return this.attributes.removeLayers
            },
            getAddLayers: function() {
                return this.attributes.addLayers
            },
            setAddLayers: function(a) {
                this.set("addLayers", a)
            },
            getKeepLayers: function() {
                return this.attributes.keepLayers
            },
            setCustomShapes: function(a) {
                this.set("customs", a)
            },
            getCustomShapes: function() {
                return this.attributes.customs
            },
            getCrs: function() {
                return this.attributes.crs
            },
            setCrs: function(a) {
                this.set("crs", a)
            },
            setInvalidateSize: function(a) {
                this.set("invalidateSize", a)
            },
            getZoom: function() {
                return this.attributes.zoom
            },
            getMapControl: function() {
                return this.attributes.mapControl
            },
            setMapControl: function(a) {
                this.set("mapControl", a)
            },
            setMap: function(a) {
                this.set("map", a)
            },
            setMapOptions: function(a) {
                this.set("mapOptions", a)
            },
            setActive: function(a) {
                a = "undefined" == typeof a || a, this.set("active", a)
            },
            isActive: function() {
                return this.get("active")
            },
            getMode: function() {
                return this.attributes.mode
            },
            getType: function() {
                return this.attributes.type
            }
        });
        return e
    }), define("text!components/app/modal/modalTemplate.html", [], function() {
        return '<div class="modal content-scroll panel-light"></div>'
    }), define("text!components/app/modal/modalShareTemplate.html", [], function() {
        return '<div class="modal content-scroll panel-dark">\r\n  <div class="share-modal-header panel-header">\r\n    <a href="#" class="icon-wwf_close close-item ocean-bgcolor"></a>\r\n    <h3 class="modal-subtitle ocean-color"><%= t.app.title %></h3>\r\n    <h1 class="modal-title"><%= t.ux.share.share_title %></h1>\r\n  </div>\r\n  <div class="waves"></div>        \r\n  <div class="modal-content">\r\n    <div class="content-container">\r\n      <ul class="share-links list-unstyled list-inline">\r\n        <li>\r\n          <a href="//twitter.com/intent/tweet?text=<%= encodeURI(t.ux.share.share_tweet) %>&url=<%= url_enc %>&hashtags=<%= t.ux.share.share_twitter_hashtag %>&via=<%= t.ux.share.share_twitter_via %>"\r\n           class="btn btn-small btn-default btn-share ocean-bgcolor" target="_blank" >\r\n          <span class="btn-icon icon-wwf_twitter"></span>\r\n          <span class="btn-icon-text"><%= t.ux.share.twitter %></span>\r\n        </a>\r\n        </li><li>\r\n        <a href="//www.facebook.com/sharer/sharer.php?u=<%= url_enc %>"\r\n           class="btn btn-small btn-default btn-share ocean-bgcolor" target="_blank" >\r\n          <span class="btn-icon icon-wwf_facebook"></span>\r\n          <span class="btn-icon-text"><%= t.ux.share.facebook %></span>\r\n        </a>\r\n        </li>\r\n      </ul>\r\n      <div class="share-copy-link">\r\n        <h4><%= t.ux.share.share_link_current_view %></h4>\r\n        <input class="form-control select-on-click share-link ocean-color" type="text" value="<%= url_current %>">\r\n      </div>        \r\n    </div>\r\n    <div class="content-container container-fluid">\r\n      <div class="share-accounts">\r\n        <h4><%= t.ux.share.share_visit %></h4>\r\n        <div class="row">\r\n          <ul class="account-links list-unstyled col-xs-6 col-sm-4 col-sm-offset-2">\r\n            <li>\r\n              <a href="<%= t.ux.share.twitter_url %>" target="_blank" class="">\r\n              <span class="account-icon icon-wwf_twitter"></span>\r\n              <span class="account-text"><%= t.ux.share.twitter %></span>\r\n            </a>\r\n            </li>\r\n            <li>\r\n              <a href="<%= t.ux.share.facebook_url %>" target="_blank" class="">\r\n                <span class="account-icon icon-wwf_facebook"></span>\r\n                <span class="account-text"><%= t.ux.share.facebook %></span>\r\n              </a>\r\n            </li>\r\n            <li>\r\n              <a href="<%= t.ux.share.google_url %>" target="_blank" class="">\r\n                <span class="account-icon icon-wwf_googleplus"></span>\r\n                <span class="account-text"><%= t.ux.share.google %></span>\r\n              </a>\r\n            </li>\r\n            <li>\r\n              <a href="<%= t.ux.share.instagram_url %>" target="_blank" class="">\r\n                <span class="account-icon icon-wwf_instagram"></span>\r\n                <span class="account-text"><%= t.ux.share.instagram %></span>\r\n              </a>\r\n            </li>\r\n          </ul>\r\n          <ul class="account-links list-unstyled col-xs-6 col-sm-4">              \r\n            <li>\r\n              <a href="<%= t.ux.share.pinterest_url %>" target="_blank" class="">\r\n                <span class="account-icon icon-wwf_pinterest"></span>\r\n                <span class="account-text"><%= t.ux.share.pinterest %></span>\r\n              </a>\r\n            </li>\r\n            <li>\r\n              <a href="<%= t.ux.share.youtube_url %>" target="_blank" class="">\r\n                <span class="account-icon icon-wwf_youtube"></span>\r\n                <span class="account-text"><%= t.ux.share.youtube %></span>\r\n              </a>\r\n            </li>\r\n            <li>\r\n              <a href="<%= t.ux.share.blog_url %>" target="_blank" class="">\r\n                <span class="account-icon icon-wwf_wwf"></span>\r\n                <span class="account-text"><%= t.ux.share.blog %></span>\r\n              </a>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n        <a href="<%= t.app.wwfurl %>" target="_blank" class="hero ocean-color"><%= t.app.wwfanchor %></a>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</div>  '
    }), define("text!components/app/modal/modalPrintTemplate.html", [], function() {
        return '<div class="modal content-scroll panel-dark">\r\n  <div class="share-modal-header panel-header">\r\n    <a href="#" class="icon-wwf_close close-item ocean-bgcolor"></a>\r\n    <h3 class="modal-suptitle ocean-color"><%= t.app.title %></h3>\r\n    <h1 class="modal-title"><%= t.ux.print.print_title %></h1>\r\n  </div>\r\n  <div class="waves"></div>          \r\n  <div class="modal-content">\r\n    <div class="content-container">\r\n      <% if (print_url === \'\' || print_url === \'loading\'){ %>\r\n      <p> <%= t.ux.print.wait  %> </p>\r\n      <span class="loading-animation print-loading-animation"></span>\r\n\r\n      <% } else { %>\r\n\r\n      <ul class="share-links print-links list-unstyled list-inline">\r\n        <li>\r\n          <a href=\'<%= print_url %>\' target=\'_blank\'\r\n           class="btn btn-small btn-default btn-share ocean-bgcolor" >\r\n          <span class="btn-icon-text"><%= t.ux.print.download %></span>\r\n        </a>\r\n        </li>\r\n        <li>\r\n          <a href="#"\r\n           class="btn btn-small btn-default btn-share print-share ocean-bgcolor" target="_blank" >\r\n          <span class="btn-icon-text"><%= t.ux.print.share %></span>\r\n        </a>\r\n        </li>\r\n      </ul>\r\n      <% } %>\r\n      <div class="share-copy-link">\r\n        <h4><%= t.ux.print.link %></h4>\r\n        <input class="form-control select-on-click share-link ocean-color" type="text" value="<%= url_id %>">\r\n      </div>\r\n    </div>\r\n  </div> \r\n</div>'
    }), define("text!templates/categoryPlaceholderTemplate.html", [], function() {
        return '<div class="category category-<%= catId %>">  \r\n  <table><tbody>\r\n  <tr>\r\n    <td class="category-icon icon-wwf_<%= catId %>-grey"></td>\r\n    <td class="category-text">\r\n      <div class="category-title"><%= catTitle %></div>\r\n      <div class="subcategory-title"><%= subcatTitle %></div>\r\n    </td>\r\n  </tr>\r\n  </tbody></table>\r\n</div>\r\n'
    }), define("text!templates/layerReferencePlaceholderTemplate.html", [], function() {
        return '<span class="layer-reference">  \r\n  <%= text %>\r\n</span>\r\n'
    }), define("components/app/modal/ModalView", ["jquery", "underscore", "backbone", "jquery.deparam", "text!./modalTemplate.html", "text!./modalShareTemplate.html", "text!./modalPrintTemplate.html", "text!templates/categoryPlaceholderTemplate.html", "text!templates/layerControlPlaceholderTemplate.html", "text!templates/layerReferencePlaceholderTemplate.html", "text!templates/oceanHeaderTemplate.html"], function(a, b, c, d, e, f, g, h, i, j, k) {
        var l = c.View.extend({
            events: {
                "click #modal-wrap": "closeModal",
                "click .close-item": "closeModal",
                "click .print-share": "shareMap",
                "click .select-in-click": "selectOnClick",
                "click .toggle-layer": "toggleLayer"
            },
            initialize: function() {
                this.listenTo(this.model, "change:modal", this.handleModalChange), this.listenTo(this.model, "change:modalid", this.handleModalChange), this.listenTo(this.model, "change:printURL", this.handleModalChange), this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:path", this.handlePathChange)
            },
            render: function() {
                return this
            },
            loadShareContent: function() {
                var a, c, d;
                a = "en" === lang ? window.location.protocol + "//" + window.location.host + "/" : window.location.protocol + "//" + window.location.host + "/" + lang + "/", d = window.location.href, d = this.removeURLParam(d, "modal"), d = this.removeURLParam(d, "modalid"), c = {
                    t: tlang,
                    url: a,
                    url_enc: encodeURIComponent(a),
                    url_current: d
                }, this.$("#modal-wrap").html(b.template(f)(c)), this.$(".select-on-click").on("click", this.selectOnClick)
            },
            loadPrintContent: function() {
                var a, c, e = this.model.getModalId();
                a = "en" === lang ? window.location.protocol + "//" + window.location.host + "/" : window.location.protocol + "//" + window.location.host + "/" + lang + "/", c = {
                    t: tlang,
                    url_id: a + "#!/id/" + e,
                    print_url: this.model.getPrintURL()
                }, this.$("#modal-wrap").html(b.template(g)(c)), this.$(".select-on-click").on("click", this.selectOnClick)
            },
            loadLayerContent: function(a) {
                if ("undefined" != typeof a && "" !== a && b.contains(this.model.getLayers().getIds(), a)) {
                    this.$("#modal-wrap").html(e);
                    var c = this.model.getLayers().get(a),
                        d = this;
                    this.$(".modal").html('<div class="content-aside content-wrap"><span class="loading-animation panel-loading-animation"></span></div>'), c.getContent(function(a) {
                        d.$(".modal").html(a[0]), d.populatePlaceholders(c)
                    })
                } else this.$el.trigger("modalClose")
            },
            populatePlaceholders: function(a) {
                "undefined" !== a.getCategory() && this.$(".placeholder-category").html(b.template(h)({
                    catId: a.getCategory(),
                    catTitle: tlang.categories[a.getCategory()],
                    subcatTitle: "undefined" !== a.getSubcategory() ? tlang.subcategories[a.getSubcategory()].title : ""
                })), "" !== this.model.getOcean() ? this.$(".placeholder-ocean").html(b.template(k)({
                    ocean: this.model.getOcean(),
                    t: tlang
                })) : this.$(".placeholder-ocean").html(tlang.app.title), this.$(".placeholder-layercontrol").html(b.template(i)({
                    id: a.id,
                    title: a.getTitle(),
                    hint: a.getHint(),
                    info: !1,
                    toggable: !1,
                    layerGradient: a.makeLayerGradientKey(),
                    layerCategories: a.makeLayerCategoriesKey(),
                    isActive: a.isActive() || a.isBasemap(),
                    keyHtml: a.getKeySquareIcon("sm"),
                    t: tlang
                })), this.$(".placeholder-layer-reference").html(b.template(j)({
                    text: a.getReference()
                }))
            },
            removeURLParam: function(a, b) {
                var c = a.split("?");
                if (c.length >= 2) {
                    for (var d = encodeURIComponent(b) + "=", e = c[1].split(/[&;]/g), f = e.length; f-- > 0;) 0 == e[f].indexOf(d, 0) && e.splice(f, 1);
                    return e.length > 0 ? c[0] + "?" + e.join("&") : c[0]
                }
                return a
            },
            selectOnClick: function(a) {
                a.preventDefault(), a.target.focus(), a.target.select(), setTimeout(function() {
                    a.target.setSelectionRange(0, 9999)
                }, 1)
            },
            handleModalChange: function() {
                switch (this.model.getModal()) {
                    case "layer":
                        this.loadLayerContent(this.model.getModalId());
                        break;
                    case "share":
                        this.loadShareContent();
                        break;
                    case "print":
                        this.loadPrintContent();
                        break;
                    default:
                        this.$el.trigger("modalClose")
                }
            },
            loadPage: function() {
                var a = this.model.getPath(),
                    b = "page-" + a;
                if (this.$(".page").hide(), 0 === this.$("." + b).length) {
                    this.$el.append('<div class="page ' + b + '"></div>');
                    var c = this;
                    this.model.getPages().findWhere({
                        id: a
                    }).getContent(function(a) {
                        c.$("." + b).append(a)
                    })
                } else this.$("." + b).show()
            },
            handleActive: function() {
                this.model.isActive() ? (this.$el.show(), this.render()) : this.$el.hide()
            },
            handlePathChange: function() {
                this.loadPage()
            },
            shareMap: function(b) {
                function c(a) {}
                b.preventDefault();
                var d;
                d = "en" === lang ? window.location.protocol + "//" + window.location.host + "/" : window.location.protocol + "//" + window.location.host + "/" + lang + "/";
                var e = {
                    method: "feed",
                    name: a(document).find("title").text(),
                    caption: "",
                    description: a(document).find("meta[name=description]").attr("content"),
                    link: d + "#!/id/" + this.model.getModalId(),
                    display: "popup",
                    picture: this.model.getPrintURL(),
                    actions: [{
                        name: a(document).find("title").text(),
                        link: d
                    }]
                };
                FB.ui(e, c)
            },
            closeModal: function(a) {
                a.target === a.currentTarget && (a.preventDefault(), a.stopPropagation(), this.$el.trigger("modalClose"))
            },
            toggleLayer: function(a) {
                a.preventDefault(), a.stopPropagation()
            }
        });
        return l
    }), define("components/app/modal/ModalModel", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.Model.extend({
            initialize: function(a) {
                this.options = a || {}
            },
            getLayers: function() {
                return this.attributes.layers
            },
            getModal: function() {
                return this.attributes.modal
            },
            getOcean: function() {
                return this.attributes.ocean
            },
            getModalId: function() {
                return this.attributes.modalid
            },
            setPrintURL: function(a) {
                this.set("printURL", a)
            },
            getPrintURL: function() {
                return this.attributes.printURL
            },
            getPath: function() {
                return this.attributes.path
            },
            getPages: function() {
                return this.attributes.pages
            },
            setActive: function(a) {
                a = "undefined" == typeof a || a, this.set("active", a)
            },
            isActive: function() {
                return this.get("active")
            }
        });
        return d
    }), define("text!components/app/layers/layerCategory/layerCategoryTemplate.html", [], function() {
        return '<div class="content-wrap">\r\n  <div class="panel-header content-container text-center">\r\n    <a href="#" class="icon-wwf_close close-item visible-xs ocean-bgcolor"></a>\r\n     </div>\r\n   \r\n  <div class="layer-container content-container">\r\n    \r\n    <%= catNav %>\r\n\r\n    \r\n    <ul class="list-unstyled">\r\n  <% _.each(grouped, function(groups,subcategory){ %>\r\n    <% if (subcategory !== \'undefined\') { %>\r\n      <li class="layer-subcategory">\r\n        <h3><%= typeof t.subcategories[subcategory] !== \'undefined\' ? t.subcategories[subcategory].title : subcategory %></h3>\r\n        <div class="subcategory-disclaimer">\r\n          <%= typeof t.subcategories[subcategory] !== \'undefined\' ? t.subcategories[subcategory].disclaimer : \'\' %>\r\n        </div>\r\n        <ul class="layer-select-list list-unstyled">\r\n    <% } %>\r\n    <% _.each(groups, function(layers,group){ %>\r\n      <% if (group === \'undefined\'){ %>\r\n        <% _.each(layers, function(layer){ %>\r\n          <li class="layer-group layer-group-undefined">\r\n            <table class="table-layer-select <%= layer.isModuleDefault() ? \'module-default\' : \'\' %>"><tbody>\r\n              <tr class="layer-key-main">\r\n                <td class="toggle">\r\n                  <a href="#" class="toggle-layer <%= layer.isActive() ? \'active\' : \'\' %>"\r\n                     data-layerid="<%= layer.id %>">\r\n                    <span class="icon-wwf_tick show-on-active"></span>\r\n                  </a>\r\n                </td>\r\n                <td class="title">\r\n                  <a href="#" class="toggle-layer <%= layer.isActive() ? \'active\' : \'\' %>" \r\n                     data-layerid="<%= layer.id %>">\r\n                    <div class="title-inner"><%= layer.getTitle() %></div>\r\n                  </a>\r\n                  <% if(layer.getHint() !== \'\') { %>\r\n                  <div class="hint">\r\n                    <%= layer.getHint() %>\r\n                  </div>\r\n                  <% } %>\r\n                </td>\r\n                <td class="key">\r\n                  <%= layer.getKeySquareIcon(\'sm\') %>\r\n                </td>\r\n              </tr></tbody>\r\n            </table>\r\n          </li>\r\n        <% }) %>\r\n      <% }  %>\r\n    <% }) %>      \r\n    <% _.each(groups, function(layers,group){ %>\r\n      <% if (group !== \'undefined\'){ %>      \r\n        <% var groupActive = _.reduce(layers, function(memo, layer){return memo && layer.isActive()}, true) %>\r\n          <li class="layer-group">\r\n            <h4><%= t.groups[group]%></h4>\r\n            <ul class="layer-select-list list-unstyled">\r\n        <% _.each(layers, function(layer){ %>\r\n              <li class="layer-select-list-item">\r\n                <table class="table-layer-select <%= layer.isModuleDefault() ? \'module-default\' : \'\' %>"><tbody>\r\n                  <tr class="layer-key-main">\r\n                    <td class="toggle">\r\n                      <a href="#" class="toggle-layer <%= layer.isActive() ? \'active\' : \'\' %>"\r\n                        data-layerid="<%= layer.id %>">\r\n                        <span class="icon-wwf_tick show-on-active"></span>\r\n                      </a>\r\n                    </td>\r\n                    <td class="title">\r\n                      <a href="#"\r\n                        class="toggle-layer <% if (layer.isActive()) { %> active<% }%>"\r\n                        data-layerid="<%= layer.id %>">\r\n                        <div class="title-inner"><%= layer.getTitle() %></div>\r\n                      </a>\r\n                      <% if(layer.getHint() !== \'\') { %>\r\n                      <div class="hint">\r\n                        <%= layer.getHint() %>\r\n                      </div>\r\n                      <% } %>\r\n                    </td>\r\n                      <td class="key">\r\n                      <%= layer.getKeySquareIcon(\'sm\') %>\r\n                    </td>\r\n                  </tr></tbody>\r\n                </table>\r\n              </li>\r\n        <% }) %>\r\n            </ul>\r\n          </li>\r\n      <% } %>\r\n    <% }) %>\r\n    <% if (subcategory !== \'undefined\') { %>\r\n        </ul>\r\n      </li>\r\n    <% } %>\r\n  <% }) %>\r\n    </ul>\r\n  </div>\r\n</div>\r\n';
    }), define("components/app/layers/layerCategory/LayerCategoryView", ["jquery", "underscore", "backbone", "text!./layerCategoryTemplate.html", "text!templates/categoryNavigationTemplate.html"], function(a, b, c, d, e) {
        var f = c.View.extend({
            events: {
                "click .toggle-layer": "toggleLayer",
                "click .layer-info-link": "handleLayerInfoLink",
                "click .print-map": "handlePrintMap",
                "click .close-item": "closeCategory"
            },
            initialize: function() {
                this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:activeLayerIds", this.handleActiveLayersUpdate), this.listenTo(this.model, "change:categories", this.handleActiveLayersUpdate)
            },
            render: function() {
                var c = b.groupBy(this.model.getLayers().models, function(a) {
                        return a.getSubcategory()
                    }),
                    f = {};
                b.each(c, function(a, c) {
                    f[c] = b.groupBy(a, function(a) {
                        return a.getGroup()
                    })
                }), this.$el.html(b.template(d)({
                    category: this.model.getCategory(),
                    catNav: b.template(e)({
                        categories: this.model.getCategories(),
                        t: tlang,
                        category: this.model.getCategory()
                    }),
                    ocean: this.model.getOcean(),
                    grouped: f,
                    lang: lang,
                    t: tlang
                }));
                var g = this;
                return a(function() {
                    g.$('[data-toggle="tooltip"]').tooltip()
                }), this
            },
            handleActive: function() {
                this.model.isActive() ? (this.render(), this.$el.show()) : this.$el.hide()
            },
            handleActiveLayersUpdate: function() {
                this.render()
            },
            closeCategory: function(a) {
                a.preventDefault(), a.stopPropagation(), this.$el.trigger("layerCategoryClose")
            },
            toggleLayer: function(b) {
                b.preventDefault(), b.stopPropagation(), this.$el.trigger("layerToggled", {
                    id: a(b.currentTarget).data("layerid")
                })
            },
            toggleLayerGroup: function(b) {
                b.preventDefault(), this.$el.trigger("layerGroupToggled", {
                    group: a(b.currentTarget).data("groupid"),
                    active: !a(b.currentTarget).data("active")
                })
            },
            handleLayerInfoLink: function(b) {
                b.preventDefault(), this.$el.trigger("layerInfoLinkClick", {
                    target: b.target,
                    id: a(b.target).data("layerid")
                })
            },
            handlePrintMap: function(a) {
                a.preventDefault(), this.$el.trigger("printMapModal")
            }
        });
        return f
    }), define("components/app/layers/layerCategory/LayerCategoryModel", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.Model.extend({
            initialize: function(a) {
                this.options = a || {}
            },
            setActive: function(a) {
                a = "undefined" == typeof a || a, this.set("active", a)
            },
            isActive: function() {
                return this.get("active")
            },
            getCategory: function() {
                return this.attributes.category
            },
            getCategories: function() {
                return this.attributes.categories
            },
            setCategories: function(a) {
                this.set("categories", a)
            },
            getLayers: function() {
                return this.attributes.layers
            },
            setLayers: function(a) {
                this.set("layers", a)
            },
            setActiveLayerIds: function(a) {
                this.set("activeLayerIds", a)
            },
            getOcean: function() {
                return this.attributes.ocean
            }
        });
        return d
    }),
    function(a) {
        "use strict";
        "function" == typeof define && define.amd ? define("jquery.spectrum", ["jquery"], a) : "object" == typeof exports && "object" == typeof module ? module.exports = a(require("jquery")) : a(jQuery)
    }(function(a, b) {
        "use strict";

        function c(b, c, d, e) {
            for (var f = [], g = 0; g < b.length; g++) {
                var h = b[g];
                if (h) {
                    var i = tinycolor(h),
                        j = i.toHsl().l < .5 ? "sp-thumb-el sp-thumb-dark" : "sp-thumb-el sp-thumb-light";
                    j += tinycolor.equals(c, h) ? " sp-thumb-active" : "";
                    var k = i.toString(e.preferredFormat || "rgb"),
                        l = q ? "background-color:" + i.toRgbString() : "filter:" + i.toFilter();
                    f.push('<span title="' + k + '" data-color="' + i.toRgbString() + '" class="' + j + '"><span class="sp-thumb-inner" style="' + l + ';" /></span>')
                } else {
                    var m = "sp-clear-display";
                    f.push(a("<div />").append(a('<span data-color="" style="background-color:transparent;" class="' + m + '"></span>').attr("title", e.noColorSelectedText)).html())
                }
            }
            return "<div class='sp-cf " + d + "'>" + f.join("") + "</div>"
        }

        function d() {
            for (var a = 0; a < o.length; a++) o[a] && o[a].hide()
        }

        function e(b, c) {
            var d = a.extend({}, n, b);
            return d.callbacks = {
                move: j(d.move, c),
                change: j(d.change, c),
                show: j(d.show, c),
                hide: j(d.hide, c),
                beforeShow: j(d.beforeShow, c)
            }, d
        }

        function f(f, h) {
            function j() {
                if (U.showPaletteOnly && (U.showPalette = !0), Na.text(U.showPaletteOnly ? U.togglePaletteMoreText : U.togglePaletteLessText), U.palette) {
                    na = U.palette.slice(0), oa = a.isArray(na[0]) ? na : [na], pa = {};
                    for (var b = 0; b < oa.length; b++)
                        for (var c = 0; c < oa[b].length; c++) {
                            var d = tinycolor(oa[b][c]).toRgbString();
                            pa[d] = !0
                        }
                }
                ya.toggleClass("sp-flat", V), ya.toggleClass("sp-input-disabled", !U.showInput), ya.toggleClass("sp-alpha-enabled", U.showAlpha), ya.toggleClass("sp-clear-enabled", Za), ya.toggleClass("sp-buttons-disabled", !U.showButtons), ya.toggleClass("sp-palette-buttons-disabled", !U.togglePaletteOnly), ya.toggleClass("sp-palette-disabled", !U.showPalette), ya.toggleClass("sp-palette-only", U.showPaletteOnly), ya.toggleClass("sp-initial-disabled", !U.showInitial), ya.addClass(U.className).addClass(U.containerClassName), O()
            }

            function n() {
                function b(b) {
                    return b.data && b.data.ignore ? (H(a(b.target).closest(".sp-thumb-el").data("color")), K()) : (H(a(b.target).closest(".sp-thumb-el").data("color")), K(), N(!0), U.hideAfterPaletteSelect && F()), !1
                }
                if (p && ya.find("*:not(input)").attr("unselectable", "on"), j(), Qa && wa.after(Ra).hide(), Za || La.hide(), V) wa.after(ya).hide();
                else {
                    var c = "parent" === U.appendTo ? wa.parent() : a(U.appendTo);
                    1 !== c.length && (c = a("body")), c.append(ya)
                }
                t(), Sa.bind("click.spectrum touchstart.spectrum", function(b) {
                    xa || B(), b.stopPropagation(), a(b.target).is("input") || b.preventDefault()
                }), (wa.is(":disabled") || U.disabled === !0) && S(), ya.click(i), Ha.change(A), Ha.bind("paste", function() {
                    setTimeout(A, 1)
                }), Ha.keydown(function(a) {
                    13 == a.keyCode && A()
                }), Ka.text(U.cancelText), Ka.bind("click.spectrum", function(a) {
                    a.stopPropagation(), a.preventDefault(), G(), F()
                }), La.attr("title", U.clearText), La.bind("click.spectrum", function(a) {
                    a.stopPropagation(), a.preventDefault(), Ya = !0, K(), V && N(!0)
                }), Ma.text(U.chooseText), Ma.bind("click.spectrum", function(a) {
                    a.stopPropagation(), a.preventDefault(), p && Ha.is(":focus") && Ha.trigger("change"), J() && (N(!0), F())
                }), Na.text(U.showPaletteOnly ? U.togglePaletteMoreText : U.togglePaletteLessText), Na.bind("click.spectrum", function(a) {
                    a.stopPropagation(), a.preventDefault(), U.showPaletteOnly = !U.showPaletteOnly, !U.showPaletteOnly && !V && ya.css("left", "-=" + (za.outerWidth(!0) + 5)), j()
                }), k(Fa, function(a, b, c) {
                    ma = a / ga, Ya = !1, c.shiftKey && (ma = Math.round(10 * ma) / 10), K()
                }, y, z), k(Ca, function(a, b) {
                    ja = parseFloat(b / ea), Ya = !1, U.showAlpha || (ma = 1), K()
                }, y, z), k(Aa, function(a, b, c) {
                    if (c.shiftKey) {
                        if (!ta) {
                            var d = ka * ba,
                                e = ca - la * ca,
                                f = Math.abs(a - d) > Math.abs(b - e);
                            ta = f ? "x" : "y"
                        }
                    } else ta = null;
                    var g = !ta || "x" === ta,
                        h = !ta || "y" === ta;
                    g && (ka = parseFloat(a / ba)), h && (la = parseFloat((ca - b) / ca)), Ya = !1, U.showAlpha || (ma = 1), K()
                }, y, z), Ua ? (H(Ua), L(), Wa = U.preferredFormat || tinycolor(Ua).format, u(Ua)) : L(), V && C();
                var d = p ? "mousedown.spectrum" : "click.spectrum touchstart.spectrum";
                Ia.delegate(".sp-thumb-el", d, b), Ja.delegate(".sp-thumb-el:nth-child(1)", d, {
                    ignore: !0
                }, b)
            }

            function t() {
                if (X && window.localStorage) {
                    try {
                        var b = window.localStorage[X].split(",#");
                        b.length > 1 && (delete window.localStorage[X], a.each(b, function(a, b) {
                            u(b)
                        }))
                    } catch (a) {}
                    try {
                        qa = window.localStorage[X].split(";")
                    } catch (a) {}
                }
            }

            function u(b) {
                if (W) {
                    var c = tinycolor(b).toRgbString();
                    if (!pa[c] && a.inArray(c, qa) === -1)
                        for (qa.push(c); qa.length > ra;) qa.shift();
                    if (X && window.localStorage) try {
                        window.localStorage[X] = qa.join(";")
                    } catch (a) {}
                }
            }

            function v() {
                var a = [];
                if (U.showPalette)
                    for (var b = 0; b < qa.length; b++) {
                        var c = tinycolor(qa[b]).toRgbString();
                        pa[c] || a.push(qa[b])
                    }
                return a.reverse().slice(0, U.maxSelectionSize)
            }

            function w() {
                var b = I(),
                    d = a.map(oa, function(a, d) {
                        return c(a, b, "sp-palette-row sp-palette-row-" + d, U)
                    });
                t(), qa && d.push(c(v(), b, "sp-palette-row sp-palette-row-selection", U)), Ia.html(d.join(""))
            }

            function x() {
                if (U.showInitial) {
                    var a = Va,
                        b = I();
                    Ja.html(c([a, b], b, "sp-palette-row-initial", U))
                }
            }

            function y() {
                (ca <= 0 || ba <= 0 || ea <= 0) && O(), aa = !0, ya.addClass(sa), ta = null, wa.trigger("dragstart.spectrum", [I()])
            }

            function z() {
                aa = !1, ya.removeClass(sa), wa.trigger("dragstop.spectrum", [I()])
            }

            function A() {
                var a = Ha.val();
                if (null !== a && "" !== a || !Za) {
                    var b = tinycolor(a);
                    b.isValid() ? (H(b), N(!0)) : Ha.addClass("sp-validation-error")
                } else H(null), N(!0)
            }

            function B() {
                _ ? F() : C()
            }

            function C() {
                var b = a.Event("beforeShow.spectrum");
                return _ ? void O() : (wa.trigger(b, [I()]), void(Z.beforeShow(I()) === !1 || b.isDefaultPrevented() || (d(), _ = !0, a(ua).bind("keydown.spectrum", D), a(ua).bind("click.spectrum", E), a(window).bind("resize.spectrum", $), Ra.addClass("sp-active"), ya.removeClass("sp-hidden"), O(), L(), Va = I(), x(), Z.show(Va), wa.trigger("show.spectrum", [Va]))))
            }

            function D(a) {
                27 === a.keyCode && F()
            }

            function E(a) {
                2 != a.button && (aa || (Xa ? N(!0) : G(), F()))
            }

            function F() {
                _ && !V && (_ = !1, a(ua).unbind("keydown.spectrum", D), a(ua).unbind("click.spectrum", E), a(window).unbind("resize.spectrum", $), Ra.removeClass("sp-active"), ya.addClass("sp-hidden"), Z.hide(I()), wa.trigger("hide.spectrum", [I()]))
            }

            function G() {
                H(Va, !0)
            }

            function H(a, b) {
                if (tinycolor.equals(a, I())) return void L();
                var c, d;
                !a && Za ? Ya = !0 : (Ya = !1, c = tinycolor(a), d = c.toHsv(), ja = d.h % 360 / 360, ka = d.s, la = d.v, ma = d.a), L(), c && c.isValid() && !b && (Wa = U.preferredFormat || c.getFormat())
            }

            function I(a) {
                return a = a || {}, Za && Ya ? null : tinycolor.fromRatio({
                    h: ja,
                    s: ka,
                    v: la,
                    a: Math.round(100 * ma) / 100
                }, {
                    format: a.format || Wa
                })
            }

            function J() {
                return !Ha.hasClass("sp-validation-error")
            }

            function K() {
                L(), Z.move(I()), wa.trigger("move.spectrum", [I()])
            }

            function L() {
                Ha.removeClass("sp-validation-error"), M();
                var a = tinycolor.fromRatio({
                    h: ja,
                    s: 1,
                    v: 1
                });
                Aa.css("background-color", a.toHexString());
                var b = Wa;
                ma < 1 && (0 !== ma || "name" !== b) && ("hex" === b || "hex3" === b || "hex6" === b || "name" === b) && (b = "rgb");
                var c = I({
                        format: b
                    }),
                    d = "";
                if (Ta.removeClass("sp-clear-display"), Ta.css("background-color", "transparent"), !c && Za) Ta.addClass("sp-clear-display");
                else {
                    var e = c.toHexString(),
                        f = c.toRgbString();
                    if (q || 1 === c.alpha ? Ta.css("background-color", f) : (Ta.css("background-color", "transparent"), Ta.css("filter", c.toFilter())), U.showAlpha) {
                        var g = c.toRgb();
                        g.a = 0;
                        var h = tinycolor(g).toRgbString(),
                            i = "linear-gradient(left, " + h + ", " + e + ")";
                        p ? Ea.css("filter", tinycolor(h).toFilter({
                            gradientType: 1
                        }, e)) : (Ea.css("background", "-webkit-" + i), Ea.css("background", "-moz-" + i), Ea.css("background", "-ms-" + i), Ea.css("background", "linear-gradient(to right, " + h + ", " + e + ")"))
                    }
                    d = c.toString(b)
                }
                U.showInput && Ha.val(d), U.showPalette && w(), x()
            }

            function M() {
                var a = ka,
                    b = la;
                if (Za && Ya) Ga.hide(), Da.hide(), Ba.hide();
                else {
                    Ga.show(), Da.show(), Ba.show();
                    var c = a * ba,
                        d = ca - b * ca;
                    c = Math.max(-da, Math.min(ba - da, c - da)), d = Math.max(-da, Math.min(ca - da, d - da)), Ba.css({
                        top: d + "px",
                        left: c + "px"
                    });
                    var e = ma * ga;
                    Ga.css({
                        left: e - ha / 2 + "px"
                    });
                    var f = ja * ea;
                    Da.css({
                        top: f - ia + "px"
                    })
                }
            }

            function N(a) {
                var b = I(),
                    c = "",
                    d = !tinycolor.equals(b, Va);
                b && (c = b.toString(Wa), u(b)), Oa && wa.val(c), a && d && (Z.change(b), wa.trigger("change", [b]))
            }

            function O() {
                _ && (ba = Aa.width(), ca = Aa.height(), da = Ba.height(), fa = Ca.width(), ea = Ca.height(), ia = Da.height(), ga = Fa.width(), ha = Ga.width(), V || (ya.css("position", "absolute"), U.offset ? ya.offset(U.offset) : ya.offset(g(ya, Sa))), M(), U.showPalette && w(), wa.trigger("reflow.spectrum"))
            }

            function P() {
                wa.show(), Sa.unbind("click.spectrum touchstart.spectrum"), ya.remove(), Ra.remove(), o[$a.id] = null
            }

            function Q(c, d) {
                return c === b ? a.extend({}, U) : d === b ? U[c] : (U[c] = d, "preferredFormat" === c && (Wa = U.preferredFormat), j(), void 0)
            }

            function R() {
                xa = !1, wa.attr("disabled", !1), Sa.removeClass("sp-disabled")
            }

            function S() {
                F(), xa = !0, wa.attr("disabled", !0), Sa.addClass("sp-disabled")
            }

            function T(a) {
                U.offset = a, O()
            }
            var U = e(h, f),
                V = U.flat,
                W = U.showSelectionPalette,
                X = U.localStorageKey,
                Y = U.theme,
                Z = U.callbacks,
                $ = l(O, 10),
                _ = !1,
                aa = !1,
                ba = 0,
                ca = 0,
                da = 0,
                ea = 0,
                fa = 0,
                ga = 0,
                ha = 0,
                ia = 0,
                ja = 0,
                ka = 0,
                la = 0,
                ma = 1,
                na = [],
                oa = [],
                pa = {},
                qa = U.selectionPalette.slice(0),
                ra = U.maxSelectionSize,
                sa = "sp-dragging",
                ta = null,
                ua = f.ownerDocument,
                wa = (ua.body, a(f)),
                xa = !1,
                ya = a(s, ua).addClass(Y),
                za = ya.find(".sp-picker-container"),
                Aa = ya.find(".sp-color"),
                Ba = ya.find(".sp-dragger"),
                Ca = ya.find(".sp-hue"),
                Da = ya.find(".sp-slider"),
                Ea = ya.find(".sp-alpha-inner"),
                Fa = ya.find(".sp-alpha"),
                Ga = ya.find(".sp-alpha-handle"),
                Ha = ya.find(".sp-input"),
                Ia = ya.find(".sp-palette"),
                Ja = ya.find(".sp-initial"),
                Ka = ya.find(".sp-cancel"),
                La = ya.find(".sp-clear"),
                Ma = ya.find(".sp-choose"),
                Na = ya.find(".sp-palette-toggle"),
                Oa = wa.is("input"),
                Pa = Oa && "color" === wa.attr("type") && m(),
                Qa = Oa && !V,
                Ra = Qa ? a(r).addClass(Y).addClass(U.className).addClass(U.replacerClassName) : a([]),
                Sa = Qa ? Ra : wa,
                Ta = Ra.find(".sp-preview-inner"),
                Ua = U.color || Oa && wa.val(),
                Va = !1,
                Wa = U.preferredFormat,
                Xa = !U.showButtons || U.clickoutFiresChange,
                Ya = !Ua,
                Za = U.allowEmpty && !Pa;
            n();
            var $a = {
                show: C,
                hide: F,
                toggle: B,
                reflow: O,
                option: Q,
                enable: R,
                disable: S,
                offset: T,
                set: function(a) {
                    H(a), N()
                },
                get: I,
                destroy: P,
                container: ya
            };
            return $a.id = o.push($a) - 1, $a
        }

        function g(b, c) {
            var d = 0,
                e = b.outerWidth(),
                f = b.outerHeight(),
                g = c.outerHeight(),
                h = b[0].ownerDocument,
                i = h.documentElement,
                j = i.clientWidth + a(h).scrollLeft(),
                k = i.clientHeight + a(h).scrollTop(),
                l = c.offset();
            return l.top += g, l.left -= Math.min(l.left, l.left + e > j && j > e ? Math.abs(l.left + e - j) : 0), l.top -= Math.min(l.top, l.top + f > k && k > f ? Math.abs(f + g - d) : d), l
        }

        function h() {}

        function i(a) {
            a.stopPropagation()
        }

        function j(a, b) {
            var c = Array.prototype.slice,
                d = c.call(arguments, 2);
            return function() {
                return a.apply(b, d.concat(c.call(arguments)))
            }
        }

        function k(b, c, d, e) {
            function f(a) {
                a.stopPropagation && a.stopPropagation(), a.preventDefault && a.preventDefault(), a.returnValue = !1
            }

            function g(a) {
                if (k) {
                    if (p && j.documentMode < 9 && !a.button) return i();
                    var d = a.originalEvent && a.originalEvent.touches && a.originalEvent.touches[0],
                        e = d && d.pageX || a.pageX,
                        g = d && d.pageY || a.pageY,
                        h = Math.max(0, Math.min(e - l.left, n)),
                        q = Math.max(0, Math.min(g - l.top, m));
                    o && f(a), c.apply(b, [h, q, a])
                }
            }

            function h(c) {
                var e = c.which ? 3 == c.which : 2 == c.button;
                !e && !k && d.apply(b, arguments) !== !1 && (k = !0, m = a(b).height(), n = a(b).width(), l = a(b).offset(), a(j).bind(q), a(j.body).addClass("sp-dragging"), g(c), f(c))
            }

            function i() {
                k && (a(j).unbind(q), a(j.body).removeClass("sp-dragging"), setTimeout(function() {
                    e.apply(b, arguments)
                }, 0)), k = !1
            }
            c = c || function() {}, d = d || function() {}, e = e || function() {};
            var j = document,
                k = !1,
                l = {},
                m = 0,
                n = 0,
                o = "ontouchstart" in window,
                q = {};
            q.selectstart = f, q.dragstart = f, q["touchmove mousemove"] = g, q["touchend mouseup"] = i, a(b).bind("touchstart mousedown", h)
        }

        function l(a, b, c) {
            var d;
            return function() {
                var e = this,
                    f = arguments,
                    g = function() {
                        d = null, a.apply(e, f)
                    };
                c && clearTimeout(d), !c && d || (d = setTimeout(g, b))
            }
        }

        function m() {
            return a.fn.spectrum.inputTypeColorSupport()
        }
        var n = {
                beforeShow: h,
                move: h,
                change: h,
                show: h,
                hide: h,
                color: !1,
                flat: !1,
                showInput: !1,
                allowEmpty: !1,
                showButtons: !0,
                clickoutFiresChange: !0,
                showInitial: !1,
                showPalette: !1,
                showPaletteOnly: !1,
                hideAfterPaletteSelect: !1,
                togglePaletteOnly: !1,
                showSelectionPalette: !0,
                localStorageKey: !1,
                appendTo: "body",
                maxSelectionSize: 7,
                cancelText: "cancel",
                chooseText: "choose",
                togglePaletteMoreText: "more",
                togglePaletteLessText: "less",
                clearText: "Clear Color Selection",
                noColorSelectedText: "No Color Selected",
                preferredFormat: !1,
                className: "",
                containerClassName: "",
                replacerClassName: "",
                showAlpha: !1,
                theme: "sp-light",
                palette: [
                    ["#ffffff", "#000000", "#ff0000", "#ff8000", "#ffff00", "#008000", "#0000ff", "#4b0082", "#9400d3"]
                ],
                selectionPalette: [],
                disabled: !1,
                offset: null
            },
            o = [],
            p = !!/msie/i.exec(window.navigator.userAgent),
            q = function() {
                function a(a, b) {
                    return !!~("" + a).indexOf(b)
                }
                var b = document.createElement("div"),
                    c = b.style;
                return c.cssText = "background-color:rgba(0,0,0,.5)", a(c.backgroundColor, "rgba") || a(c.backgroundColor, "hsla")
            }(),
            r = ["<div class='sp-replacer'>", "<div class='sp-preview'><div class='sp-preview-inner'></div></div>", "<div class='sp-dd'>&#9660;</div>", "</div>"].join(""),
            s = function() {
                var a = "";
                if (p)
                    for (var b = 1; b <= 6; b++) a += "<div class='sp-" + b + "'></div>";
                return ["<div class='sp-container sp-hidden'>", "<div class='sp-palette-container'>", "<div class='sp-palette sp-thumb sp-cf'></div>", "<div class='sp-palette-button-container sp-cf'>", "<button type='button' class='sp-palette-toggle'></button>", "</div>", "</div>", "<div class='sp-picker-container'>", "<div class='sp-top sp-cf'>", "<div class='sp-fill'></div>", "<div class='sp-top-inner'>", "<div class='sp-color'>", "<div class='sp-sat'>", "<div class='sp-val'>", "<div class='sp-dragger'></div>", "</div>", "</div>", "</div>", "<div class='sp-clear sp-clear-display'>", "</div>", "<div class='sp-hue'>", "<div class='sp-slider'></div>", a, "</div>", "</div>", "<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>", "</div>", "<div class='sp-input-container sp-cf'>", "<input class='sp-input' type='text' spellcheck='false'  />", "</div>", "<div class='sp-initial sp-thumb sp-cf'></div>", "<div class='sp-button-container sp-cf'>", "<a class='sp-cancel' href='#'></a>", "<button type='button' class='sp-choose'></button>", "</div>", "</div>", "</div>"].join("")
            }(),
            t = "spectrum.id";
        a.fn.spectrum = function(b, c) {
                if ("string" == typeof b) {
                    var d = this,
                        e = Array.prototype.slice.call(arguments, 1);
                    return this.each(function() {
                        var c = o[a(this).data(t)];
                        if (c) {
                            var f = c[b];
                            if (!f) throw new Error("Spectrum: no such method: '" + b + "'");
                            "get" == b ? d = c.get() : "container" == b ? d = c.container : "option" == b ? d = c.option.apply(c, e) : "destroy" == b ? (c.destroy(), a(this).removeData(t)) : f.apply(c, e)
                        }
                    }), d
                }
                return this.spectrum("destroy").each(function() {
                    var c = a.extend({}, b, a(this).data()),
                        d = f(this, c);
                    a(this).data(t, d.id)
                })
            }, a.fn.spectrum.load = !0, a.fn.spectrum.loadOpts = {}, a.fn.spectrum.draggable = k, a.fn.spectrum.defaults = n, a.fn.spectrum.inputTypeColorSupport = function b() {
                if ("undefined" == typeof b._cachedResult) {
                    var c = a("<input type='color'/>")[0];
                    b._cachedResult = "color" === c.type && "" !== c.value
                }
                return b._cachedResult
            }, a.spectrum = {}, a.spectrum.localization = {}, a.spectrum.palettes = {}, a.fn.spectrum.processNativeColorInputs = function() {
                var b = a("input[type=color]");
                b.length && !m() && b.spectrum({
                    preferredFormat: "hex6"
                })
            },
            function() {
                function a(a) {
                    var c = {
                            r: 0,
                            g: 0,
                            b: 0
                        },
                        e = 1,
                        g = !1,
                        h = !1;
                    return "string" == typeof a && (a = G(a)), "object" == typeof a && (a.hasOwnProperty("r") && a.hasOwnProperty("g") && a.hasOwnProperty("b") ? (c = b(a.r, a.g, a.b), g = !0, h = "%" === String(a.r).substr(-1) ? "prgb" : "rgb") : a.hasOwnProperty("h") && a.hasOwnProperty("s") && a.hasOwnProperty("v") ? (a.s = D(a.s), a.v = D(a.v), c = f(a.h, a.s, a.v), g = !0, h = "hsv") : a.hasOwnProperty("h") && a.hasOwnProperty("s") && a.hasOwnProperty("l") && (a.s = D(a.s), a.l = D(a.l), c = d(a.h, a.s, a.l), g = !0, h = "hsl"), a.hasOwnProperty("a") && (e = a.a)), e = w(e), {
                        ok: g,
                        format: a.format || h,
                        r: M(255, N(c.r, 0)),
                        g: M(255, N(c.g, 0)),
                        b: M(255, N(c.b, 0)),
                        a: e
                    }
                }

                function b(a, b, c) {
                    return {
                        r: 255 * x(a, 255),
                        g: 255 * x(b, 255),
                        b: 255 * x(c, 255)
                    }
                }

                function c(a, b, c) {
                    a = x(a, 255), b = x(b, 255), c = x(c, 255);
                    var f, g, d = N(a, b, c),
                        e = M(a, b, c),
                        h = (d + e) / 2;
                    if (d == e) f = g = 0;
                    else {
                        var i = d - e;
                        switch (g = h > .5 ? i / (2 - d - e) : i / (d + e), d) {
                            case a:
                                f = (b - c) / i + (b < c ? 6 : 0);
                                break;
                            case b:
                                f = (c - a) / i + 2;
                                break;
                            case c:
                                f = (a - b) / i + 4
                        }
                        f /= 6
                    }
                    return {
                        h: f,
                        s: g,
                        l: h
                    }
                }

                function d(a, b, c) {
                    function d(a, b, c) {
                        return c < 0 && (c += 1), c > 1 && (c -= 1), c < 1 / 6 ? a + 6 * (b - a) * c : c < .5 ? b : c < 2 / 3 ? a + (b - a) * (2 / 3 - c) * 6 : a
                    }
                    var e, f, g;
                    if (a = x(a, 360), b = x(b, 100), c = x(c, 100), 0 === b) e = f = g = c;
                    else {
                        var h = c < .5 ? c * (1 + b) : c + b - c * b,
                            i = 2 * c - h;
                        e = d(i, h, a + 1 / 3), f = d(i, h, a), g = d(i, h, a - 1 / 3)
                    }
                    return {
                        r: 255 * e,
                        g: 255 * f,
                        b: 255 * g
                    }
                }

                function e(a, b, c) {
                    a = x(a, 255), b = x(b, 255), c = x(c, 255);
                    var f, g, d = N(a, b, c),
                        e = M(a, b, c),
                        h = d,
                        i = d - e;
                    if (g = 0 === d ? 0 : i / d, d == e) f = 0;
                    else {
                        switch (d) {
                            case a:
                                f = (b - c) / i + (b < c ? 6 : 0);
                                break;
                            case b:
                                f = (c - a) / i + 2;
                                break;
                            case c:
                                f = (a - b) / i + 4
                        }
                        f /= 6
                    }
                    return {
                        h: f,
                        s: g,
                        v: h
                    }
                }

                function f(a, b, c) {
                    a = 6 * x(a, 360), b = x(b, 100), c = x(c, 100);
                    var d = K.floor(a),
                        e = a - d,
                        f = c * (1 - b),
                        g = c * (1 - e * b),
                        h = c * (1 - (1 - e) * b),
                        i = d % 6,
                        j = [c, g, f, f, h, c][i],
                        k = [h, c, c, g, f, f][i],
                        l = [f, f, h, c, c, g][i];
                    return {
                        r: 255 * j,
                        g: 255 * k,
                        b: 255 * l
                    }
                }

                function g(a, b, c, d) {
                    var e = [C(L(a).toString(16)), C(L(b).toString(16)), C(L(c).toString(16))];
                    return d && e[0].charAt(0) == e[0].charAt(1) && e[1].charAt(0) == e[1].charAt(1) && e[2].charAt(0) == e[2].charAt(1) ? e[0].charAt(0) + e[1].charAt(0) + e[2].charAt(0) : e.join("")
                }

                function h(a, b, c, d) {
                    var e = [C(E(d)), C(L(a).toString(16)), C(L(b).toString(16)), C(L(c).toString(16))];
                    return e.join("")
                }

                function i(a, b) {
                    b = 0 === b ? 0 : b || 10;
                    var c = P(a).toHsl();
                    return c.s -= b / 100, c.s = y(c.s), P(c)
                }

                function j(a, b) {
                    b = 0 === b ? 0 : b || 10;
                    var c = P(a).toHsl();
                    return c.s += b / 100, c.s = y(c.s), P(c)
                }

                function k(a) {
                    return P(a).desaturate(100)
                }

                function l(a, b) {
                    b = 0 === b ? 0 : b || 10;
                    var c = P(a).toHsl();
                    return c.l += b / 100, c.l = y(c.l), P(c)
                }

                function m(a, b) {
                    b = 0 === b ? 0 : b || 10;
                    var c = P(a).toRgb();
                    return c.r = N(0, M(255, c.r - L(255 * -(b / 100)))), c.g = N(0, M(255, c.g - L(255 * -(b / 100)))), c.b = N(0, M(255, c.b - L(255 * -(b / 100)))), P(c)
                }

                function n(a, b) {
                    b = 0 === b ? 0 : b || 10;
                    var c = P(a).toHsl();
                    return c.l -= b / 100, c.l = y(c.l), P(c)
                }

                function o(a, b) {
                    var c = P(a).toHsl(),
                        d = (L(c.h) + b) % 360;
                    return c.h = d < 0 ? 360 + d : d, P(c)
                }

                function p(a) {
                    var b = P(a).toHsl();
                    return b.h = (b.h + 180) % 360, P(b)
                }

                function q(a) {
                    var b = P(a).toHsl(),
                        c = b.h;
                    return [P(a), P({
                        h: (c + 120) % 360,
                        s: b.s,
                        l: b.l
                    }), P({
                        h: (c + 240) % 360,
                        s: b.s,
                        l: b.l
                    })]
                }

                function r(a) {
                    var b = P(a).toHsl(),
                        c = b.h;
                    return [P(a), P({
                        h: (c + 90) % 360,
                        s: b.s,
                        l: b.l
                    }), P({
                        h: (c + 180) % 360,
                        s: b.s,
                        l: b.l
                    }), P({
                        h: (c + 270) % 360,
                        s: b.s,
                        l: b.l
                    })]
                }

                function s(a) {
                    var b = P(a).toHsl(),
                        c = b.h;
                    return [P(a), P({
                        h: (c + 72) % 360,
                        s: b.s,
                        l: b.l
                    }), P({
                        h: (c + 216) % 360,
                        s: b.s,
                        l: b.l
                    })]
                }

                function t(a, b, c) {
                    b = b || 6, c = c || 30;
                    var d = P(a).toHsl(),
                        e = 360 / c,
                        f = [P(a)];
                    for (d.h = (d.h - (e * b >> 1) + 720) % 360; --b;) d.h = (d.h + e) % 360, f.push(P(d));
                    return f
                }

                function u(a, b) {
                    b = b || 6;
                    for (var c = P(a).toHsv(), d = c.h, e = c.s, f = c.v, g = [], h = 1 / b; b--;) g.push(P({
                        h: d,
                        s: e,
                        v: f
                    })), f = (f + h) % 1;
                    return g
                }

                function v(a) {
                    var b = {};
                    for (var c in a) a.hasOwnProperty(c) && (b[a[c]] = c);
                    return b
                }

                function w(a) {
                    return a = parseFloat(a), (isNaN(a) || a < 0 || a > 1) && (a = 1), a
                }

                function x(a, b) {
                    A(a) && (a = "100%");
                    var c = B(a);
                    return a = M(b, N(0, parseFloat(a))), c && (a = parseInt(a * b, 10) / 100), K.abs(a - b) < 1e-6 ? 1 : a % b / parseFloat(b)
                }

                function y(a) {
                    return M(1, N(0, a))
                }

                function z(a) {
                    return parseInt(a, 16)
                }

                function A(a) {
                    return "string" == typeof a && a.indexOf(".") != -1 && 1 === parseFloat(a)
                }

                function B(a) {
                    return "string" == typeof a && a.indexOf("%") != -1
                }

                function C(a) {
                    return 1 == a.length ? "0" + a : "" + a
                }

                function D(a) {
                    return a <= 1 && (a = 100 * a + "%"), a
                }

                function E(a) {
                    return Math.round(255 * parseFloat(a)).toString(16)
                }

                function F(a) {
                    return z(a) / 255
                }

                function G(a) {
                    a = a.replace(H, "").replace(I, "").toLowerCase();
                    var b = !1;
                    if (Q[a]) a = Q[a], b = !0;
                    else if ("transparent" == a) return {
                        r: 0,
                        g: 0,
                        b: 0,
                        a: 0,
                        format: "name"
                    };
                    var c;
                    return (c = S.rgb.exec(a)) ? {
                        r: c[1],
                        g: c[2],
                        b: c[3]
                    } : (c = S.rgba.exec(a)) ? {
                        r: c[1],
                        g: c[2],
                        b: c[3],
                        a: c[4]
                    } : (c = S.hsl.exec(a)) ? {
                        h: c[1],
                        s: c[2],
                        l: c[3]
                    } : (c = S.hsla.exec(a)) ? {
                        h: c[1],
                        s: c[2],
                        l: c[3],
                        a: c[4]
                    } : (c = S.hsv.exec(a)) ? {
                        h: c[1],
                        s: c[2],
                        v: c[3]
                    } : (c = S.hsva.exec(a)) ? {
                        h: c[1],
                        s: c[2],
                        v: c[3],
                        a: c[4]
                    } : (c = S.hex8.exec(a)) ? {
                        a: F(c[1]),
                        r: z(c[2]),
                        g: z(c[3]),
                        b: z(c[4]),
                        format: b ? "name" : "hex8"
                    } : (c = S.hex6.exec(a)) ? {
                        r: z(c[1]),
                        g: z(c[2]),
                        b: z(c[3]),
                        format: b ? "name" : "hex"
                    } : !!(c = S.hex3.exec(a)) && {
                        r: z(c[1] + "" + c[1]),
                        g: z(c[2] + "" + c[2]),
                        b: z(c[3] + "" + c[3]),
                        format: b ? "name" : "hex"
                    }
                }
                var H = /^[\s,#]+/,
                    I = /\s+$/,
                    J = 0,
                    K = Math,
                    L = K.round,
                    M = K.min,
                    N = K.max,
                    O = K.random,
                    P = function(b, c) {
                        if (b = b ? b : "", c = c || {}, b instanceof P) return b;
                        if (!(this instanceof P)) return new P(b, c);
                        var d = a(b);
                        this._originalInput = b, this._r = d.r, this._g = d.g, this._b = d.b, this._a = d.a, this._roundA = L(100 * this._a) / 100, this._format = c.format || d.format, this._gradientType = c.gradientType, this._r < 1 && (this._r = L(this._r)), this._g < 1 && (this._g = L(this._g)), this._b < 1 && (this._b = L(this._b)), this._ok = d.ok, this._tc_id = J++
                    };
                P.prototype = {
                    isDark: function() {
                        return this.getBrightness() < 128
                    },
                    isLight: function() {
                        return !this.isDark()
                    },
                    isValid: function() {
                        return this._ok
                    },
                    getOriginalInput: function() {
                        return this._originalInput
                    },
                    getFormat: function() {
                        return this._format
                    },
                    getAlpha: function() {
                        return this._a
                    },
                    getBrightness: function() {
                        var a = this.toRgb();
                        return (299 * a.r + 587 * a.g + 114 * a.b) / 1e3
                    },
                    setAlpha: function(a) {
                        return this._a = w(a), this._roundA = L(100 * this._a) / 100, this
                    },
                    toHsv: function() {
                        var a = e(this._r, this._g, this._b);
                        return {
                            h: 360 * a.h,
                            s: a.s,
                            v: a.v,
                            a: this._a
                        }
                    },
                    toHsvString: function() {
                        var a = e(this._r, this._g, this._b),
                            b = L(360 * a.h),
                            c = L(100 * a.s),
                            d = L(100 * a.v);
                        return 1 == this._a ? "hsv(" + b + ", " + c + "%, " + d + "%)" : "hsva(" + b + ", " + c + "%, " + d + "%, " + this._roundA + ")"
                    },
                    toHsl: function() {
                        var a = c(this._r, this._g, this._b);
                        return {
                            h: 360 * a.h,
                            s: a.s,
                            l: a.l,
                            a: this._a
                        }
                    },
                    toHslString: function() {
                        var a = c(this._r, this._g, this._b),
                            b = L(360 * a.h),
                            d = L(100 * a.s),
                            e = L(100 * a.l);
                        return 1 == this._a ? "hsl(" + b + ", " + d + "%, " + e + "%)" : "hsla(" + b + ", " + d + "%, " + e + "%, " + this._roundA + ")"
                    },
                    toHex: function(a) {
                        return g(this._r, this._g, this._b, a)
                    },
                    toHexString: function(a) {
                        return "#" + this.toHex(a)
                    },
                    toHex8: function() {
                        return h(this._r, this._g, this._b, this._a)
                    },
                    toHex8String: function() {
                        return "#" + this.toHex8()
                    },
                    toRgb: function() {
                        return {
                            r: L(this._r),
                            g: L(this._g),
                            b: L(this._b),
                            a: this._a
                        }
                    },
                    toRgbString: function() {
                        return 1 == this._a ? "rgb(" + L(this._r) + ", " + L(this._g) + ", " + L(this._b) + ")" : "rgba(" + L(this._r) + ", " + L(this._g) + ", " + L(this._b) + ", " + this._roundA + ")"
                    },
                    toPercentageRgb: function() {
                        return {
                            r: L(100 * x(this._r, 255)) + "%",
                            g: L(100 * x(this._g, 255)) + "%",
                            b: L(100 * x(this._b, 255)) + "%",
                            a: this._a
                        }
                    },
                    toPercentageRgbString: function() {
                        return 1 == this._a ? "rgb(" + L(100 * x(this._r, 255)) + "%, " + L(100 * x(this._g, 255)) + "%, " + L(100 * x(this._b, 255)) + "%)" : "rgba(" + L(100 * x(this._r, 255)) + "%, " + L(100 * x(this._g, 255)) + "%, " + L(100 * x(this._b, 255)) + "%, " + this._roundA + ")"
                    },
                    toName: function() {
                        return 0 === this._a ? "transparent" : !(this._a < 1) && (R[g(this._r, this._g, this._b, !0)] || !1)
                    },
                    toFilter: function(a) {
                        var b = "#" + h(this._r, this._g, this._b, this._a),
                            c = b,
                            d = this._gradientType ? "GradientType = 1, " : "";
                        if (a) {
                            var e = P(a);
                            c = e.toHex8String()
                        }
                        return "progid:DXImageTransform.Microsoft.gradient(" + d + "startColorstr=" + b + ",endColorstr=" + c + ")"
                    },
                    toString: function(a) {
                        var b = !!a;
                        a = a || this._format;
                        var c = !1,
                            d = this._a < 1 && this._a >= 0,
                            e = !b && d && ("hex" === a || "hex6" === a || "hex3" === a || "name" === a);
                        return e ? "name" === a && 0 === this._a ? this.toName() : this.toRgbString() : ("rgb" === a && (c = this.toRgbString()), "prgb" === a && (c = this.toPercentageRgbString()), "hex" !== a && "hex6" !== a || (c = this.toHexString()), "hex3" === a && (c = this.toHexString(!0)), "hex8" === a && (c = this.toHex8String()), "name" === a && (c = this.toName()), "hsl" === a && (c = this.toHslString()), "hsv" === a && (c = this.toHsvString()), c || this.toHexString())
                    },
                    _applyModification: function(a, b) {
                        var c = a.apply(null, [this].concat([].slice.call(b)));
                        return this._r = c._r, this._g = c._g, this._b = c._b, this.setAlpha(c._a), this
                    },
                    lighten: function() {
                        return this._applyModification(l, arguments)
                    },
                    brighten: function() {
                        return this._applyModification(m, arguments)
                    },
                    darken: function() {
                        return this._applyModification(n, arguments)
                    },
                    desaturate: function() {
                        return this._applyModification(i, arguments)
                    },
                    saturate: function() {
                        return this._applyModification(j, arguments)
                    },
                    greyscale: function() {
                        return this._applyModification(k, arguments)
                    },
                    spin: function() {
                        return this._applyModification(o, arguments)
                    },
                    _applyCombination: function(a, b) {
                        return a.apply(null, [this].concat([].slice.call(b)))
                    },
                    analogous: function() {
                        return this._applyCombination(t, arguments)
                    },
                    complement: function() {
                        return this._applyCombination(p, arguments)
                    },
                    monochromatic: function() {
                        return this._applyCombination(u, arguments)
                    },
                    splitcomplement: function() {
                        return this._applyCombination(s, arguments)
                    },
                    triad: function() {
                        return this._applyCombination(q, arguments)
                    },
                    tetrad: function() {
                        return this._applyCombination(r, arguments)
                    }
                }, P.fromRatio = function(a, b) {
                    if ("object" == typeof a) {
                        var c = {};
                        for (var d in a) a.hasOwnProperty(d) && ("a" === d ? c[d] = a[d] : c[d] = D(a[d]));
                        a = c
                    }
                    return P(a, b)
                }, P.equals = function(a, b) {
                    return !(!a || !b) && P(a).toRgbString() == P(b).toRgbString()
                }, P.random = function() {
                    return P.fromRatio({
                        r: O(),
                        g: O(),
                        b: O()
                    })
                }, P.mix = function(a, b, c) {
                    c = 0 === c ? 0 : c || 50;
                    var i, d = P(a).toRgb(),
                        e = P(b).toRgb(),
                        f = c / 100,
                        g = 2 * f - 1,
                        h = e.a - d.a;
                    i = g * h == -1 ? g : (g + h) / (1 + g * h), i = (i + 1) / 2;
                    var j = 1 - i,
                        k = {
                            r: e.r * i + d.r * j,
                            g: e.g * i + d.g * j,
                            b: e.b * i + d.b * j,
                            a: e.a * f + d.a * (1 - f)
                        };
                    return P(k)
                }, P.readability = function(a, b) {
                    var c = P(a),
                        d = P(b),
                        e = c.toRgb(),
                        f = d.toRgb(),
                        g = c.getBrightness(),
                        h = d.getBrightness(),
                        i = Math.max(e.r, f.r) - Math.min(e.r, f.r) + Math.max(e.g, f.g) - Math.min(e.g, f.g) + Math.max(e.b, f.b) - Math.min(e.b, f.b);
                    return {
                        brightness: Math.abs(g - h),
                        color: i
                    }
                }, P.isReadable = function(a, b) {
                    var c = P.readability(a, b);
                    return c.brightness > 125 && c.color > 500
                }, P.mostReadable = function(a, b) {
                    for (var c = null, d = 0, e = !1, f = 0; f < b.length; f++) {
                        var g = P.readability(a, b[f]),
                            h = g.brightness > 125 && g.color > 500,
                            i = 3 * (g.brightness / 125) + g.color / 500;
                        (h && !e || h && e && i > d || !h && !e && i > d) && (e = h, d = i, c = P(b[f]))
                    }
                    return c
                };
                var Q = P.names = {
                        aliceblue: "f0f8ff",
                        antiquewhite: "faebd7",
                        aqua: "0ff",
                        aquamarine: "7fffd4",
                        azure: "f0ffff",
                        beige: "f5f5dc",
                        bisque: "ffe4c4",
                        black: "000",
                        blanchedalmond: "ffebcd",
                        blue: "00f",
                        blueviolet: "8a2be2",
                        brown: "a52a2a",
                        burlywood: "deb887",
                        burntsienna: "ea7e5d",
                        cadetblue: "5f9ea0",
                        chartreuse: "7fff00",
                        chocolate: "d2691e",
                        coral: "ff7f50",
                        cornflowerblue: "6495ed",
                        cornsilk: "fff8dc",
                        crimson: "dc143c",
                        cyan: "0ff",
                        darkblue: "00008b",
                        darkcyan: "008b8b",
                        darkgoldenrod: "b8860b",
                        darkgray: "a9a9a9",
                        darkgreen: "006400",
                        darkgrey: "a9a9a9",
                        darkkhaki: "bdb76b",
                        darkmagenta: "8b008b",
                        darkolivegreen: "556b2f",
                        darkorange: "ff8c00",
                        darkorchid: "9932cc",
                        darkred: "8b0000",
                        darksalmon: "e9967a",
                        darkseagreen: "8fbc8f",
                        darkslateblue: "483d8b",
                        darkslategray: "2f4f4f",
                        darkslategrey: "2f4f4f",
                        darkturquoise: "00ced1",
                        darkviolet: "9400d3",
                        deeppink: "ff1493",
                        deepskyblue: "00bfff",
                        dimgray: "696969",
                        dimgrey: "696969",
                        dodgerblue: "1e90ff",
                        firebrick: "b22222",
                        floralwhite: "fffaf0",
                        forestgreen: "228b22",
                        fuchsia: "f0f",
                        gainsboro: "dcdcdc",
                        ghostwhite: "f8f8ff",
                        gold: "ffd700",
                        goldenrod: "daa520",
                        gray: "808080",
                        green: "008000",
                        greenyellow: "adff2f",
                        grey: "808080",
                        honeydew: "f0fff0",
                        hotpink: "ff69b4",
                        indianred: "cd5c5c",
                        indigo: "4b0082",
                        ivory: "fffff0",
                        khaki: "f0e68c",
                        lavender: "e6e6fa",
                        lavenderblush: "fff0f5",
                        lawngreen: "7cfc00",
                        lemonchiffon: "fffacd",
                        lightblue: "add8e6",
                        lightcoral: "f08080",
                        lightcyan: "e0ffff",
                        lightgoldenrodyellow: "fafad2",
                        lightgray: "d3d3d3",
                        lightgreen: "90ee90",
                        lightgrey: "d3d3d3",
                        lightpink: "ffb6c1",
                        lightsalmon: "ffa07a",
                        lightseagreen: "20b2aa",
                        lightskyblue: "87cefa",
                        lightslategray: "789",
                        lightslategrey: "789",
                        lightsteelblue: "b0c4de",
                        lightyellow: "ffffe0",
                        lime: "0f0",
                        limegreen: "32cd32",
                        linen: "faf0e6",
                        magenta: "f0f",
                        maroon: "800000",
                        mediumaquamarine: "66cdaa",
                        mediumblue: "0000cd",
                        mediumorchid: "ba55d3",
                        mediumpurple: "9370db",
                        mediumseagreen: "3cb371",
                        mediumslateblue: "7b68ee",
                        mediumspringgreen: "00fa9a",
                        mediumturquoise: "48d1cc",
                        mediumvioletred: "c71585",
                        midnightblue: "191970",
                        mintcream: "f5fffa",
                        mistyrose: "ffe4e1",
                        moccasin: "ffe4b5",
                        navajowhite: "ffdead",
                        navy: "000080",
                        oldlace: "fdf5e6",
                        olive: "808000",
                        olivedrab: "6b8e23",
                        orange: "ffa500",
                        orangered: "ff4500",
                        orchid: "da70d6",
                        palegoldenrod: "eee8aa",
                        palegreen: "98fb98",
                        paleturquoise: "afeeee",
                        palevioletred: "db7093",
                        papayawhip: "ffefd5",
                        peachpuff: "ffdab9",
                        peru: "cd853f",
                        pink: "ffc0cb",
                        plum: "dda0dd",
                        powderblue: "b0e0e6",
                        purple: "800080",
                        rebeccapurple: "663399",
                        red: "f00",
                        rosybrown: "bc8f8f",
                        royalblue: "4169e1",
                        saddlebrown: "8b4513",
                        salmon: "fa8072",
                        sandybrown: "f4a460",
                        seagreen: "2e8b57",
                        seashell: "fff5ee",
                        sienna: "a0522d",
                        silver: "c0c0c0",
                        skyblue: "87ceeb",
                        slateblue: "6a5acd",
                        slategray: "708090",
                        slategrey: "708090",
                        snow: "fffafa",
                        springgreen: "00ff7f",
                        steelblue: "4682b4",
                        tan: "d2b48c",
                        teal: "008080",
                        thistle: "d8bfd8",
                        tomato: "ff6347",
                        turquoise: "40e0d0",
                        violet: "ee82ee",
                        wheat: "f5deb3",
                        white: "fff",
                        whitesmoke: "f5f5f5",
                        yellow: "ff0",
                        yellowgreen: "9acd32"
                    },
                    R = P.hexNames = v(Q),
                    S = function() {
                        var a = "[-\\+]?\\d+%?",
                            b = "[-\\+]?\\d*\\.\\d+%?",
                            c = "(?:" + b + ")|(?:" + a + ")",
                            d = "[\\s|\\(]+(" + c + ")[,|\\s]+(" + c + ")[,|\\s]+(" + c + ")\\s*\\)?",
                            e = "[\\s|\\(]+(" + c + ")[,|\\s]+(" + c + ")[,|\\s]+(" + c + ")[,|\\s]+(" + c + ")\\s*\\)?";
                        return {
                            rgb: new RegExp("rgb" + d),
                            rgba: new RegExp("rgba" + e),
                            hsl: new RegExp("hsl" + d),
                            hsla: new RegExp("hsla" + e),
                            hsv: new RegExp("hsv" + d),
                            hsva: new RegExp("hsva" + e),
                            hex3: /^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,
                            hex6: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,
                            hex8: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/
                        }
                    }();
                window.tinycolor = P
            }(), a(function() {
                a.fn.spectrum.load && a.fn.spectrum.processNativeColorInputs()
            })
    }), define("text!components/app/layers/layerCustomCategory/layerCustomCategoryTemplate.html", [], function() {
        return '<div class="content-wrap">\r\n  <div class="panel-header content-container text-center">\r\n    <a href="#" class="icon-wwf_close close-item visible-xs ocean-bgcolor"></a>\r\n    <h3>\r\n      <a href="#" class="ocean-link ocean-color-<%= ocean %> link-large" data-oceanid="<%= ocean %>">\r\n        <%= t.oceans[ocean] %>\r\n      </a>\r\n    </h3>\r\n    <h2><%= t.categories[category] %></h2>\r\n  </div>\r\n  <div class="waves"></div>   \r\n  <div class="layer-container content-container">    \r\n    <%= catNav %>\r\n    <h3><%= t.ux.layers.your_layers %></h3>\r\n    <% if (layers.length > 0) { %>\r\n    <ul class="layer-select-list list-unstyled">\r\n      <% _.each(layers, function(layer){ %>\r\n        <li class="layer-group layer-group-undefined">\r\n          <table class="table-layer-select"><tbody>\r\n            <tr class="layer-key-main">\r\n              <td class="toggle">\r\n                <a href="#" class="toggle-layer <%= layer.isActive() ? \'active\' : \'\' %>"\r\n                   data-layerid="<%= layer.id %>">\r\n                  <span class="icon-wwf_tick show-on-active"></span>\r\n                </a>\r\n              </td>\r\n              <td class="title">\r\n                <% if (layer.isEdit() && editTitle === layer.id) { %>\r\n                <input class="form-control select-on-click ocean-color input-layer-title" \r\n                       type="text" \r\n                       data-layerid="<%= layer.id %>"\r\n                       value="<%= layer.getTitle() %>">\r\n                <% } else { %>\r\n                <a href="#" class="toggle-layer <%= layer.isActive() ? \'active\' : \'\' %>" \r\n                   data-layerid="<%= layer.id %>">\r\n                  <div class="title-inner"><%= layer.getTitle() %></div>\r\n                </a>\r\n                <% } %>\r\n              </td>\r\n             <td class="key">\r\n                <% if (layer.isEdit()) { %>\r\n                <a href="" class="edit-layer-color" data-layerid="<%= layer.id %>">\r\n                <% } %>\r\n                <%= layer.getKeySquareIcon(\'sm\') %>\r\n                <% if (layer.isEdit()) { %></a><% } %>\r\n              </td>\r\n            </tr>                \r\n          <% if (layer.isEdit()) { %>        \r\n            <% if (editTitle === layer.id) { %>   \r\n            <tr class="layer-key-edits">\r\n              <td></td>\r\n              <td>\r\n                <a href="#" class="save-layer-title ocean-bgcolor" data-layerid="<%= layer.id %>">\r\n                  <%= t.ux.layers.confirm %>\r\n                </a>\r\n              </td>\r\n              <td></td>\r\n              <td></td>\r\n              <td></td>\r\n            </tr>\r\n            <% } else if (editColor === layer.id) { %>  \r\n            <tr class="layer-key-edits">\r\n              <td></td>\r\n              <td colspan="4">\r\n                <div class="input-layer-color-wrap">\r\n                  <input type=\'text\' \r\n                     class="input-layer-color" \r\n                     data-layerid="<%= layer.id %>"                   \r\n                     value="<%= layer.getColor() %>"/>\r\n                </div>\r\n                <div class="input-layer-color-cancel-wrap">\r\n                  <a href="#" class="cancel-layer-color ocean-color pull-right " >\r\n                    <%= t.ux.layers.cancel %>\r\n                  </a>\r\n                </div>\r\n              </td>\r\n            </tr>              \r\n            <% } else { %>   \r\n            <tr class="layer-key-edits">\r\n              <td></td>\r\n              <td>\r\n                <a href="#" class="reveal-on-hover pull-left edit-layer-title" data-layerid="<%= layer.id %>">\r\n                  <span class="hide-on-hover hint">\r\n                    <span class="icon-wwf_edit-light"></span>\r\n                    <%= t.ux.layers.edit_title %>\r\n                  </span>\r\n                  <span class="show-on-hover ocean-color">\r\n                    <span class="icon-wwf_edit-<%= ocean %>"></span>\r\n                    <%= t.ux.layers.edit_title %>\r\n                  </span>\r\n                </a>\r\n              </td>\r\n              <td colspan="3">\r\n                <a href="#" class="reveal-on-hover pull-right edit-layer-color ocean-color" data-layerid="<%= layer.id %>">\r\n                  <span class="hide-on-hover hint">\r\n                    <span class="icon-wwf_edit-light"></span>\r\n                    <%= t.ux.layers.edit_color %>\r\n                  </span>\r\n                  <span class="show-on-hover ocean-color">\r\n                    <span class="icon-wwf_edit-<%= ocean %>"></span>\r\n                    <%= t.ux.layers.edit_color %>\r\n                  </span>\r\n                </a>\r\n              </td>\r\n            </tr>            \r\n            <tr class="layer-key-instructions">\r\n              <td></td>\r\n              <td colspan="4">\r\n                <div class="custom-layer-edit-hint hint">\r\n                  <%= t.ux.layers.edit_instructions %>\r\n                </div>\r\n              </td>\r\n            </tr>\r\n            <% } %>                        \r\n          <% } %>            \r\n          </tbody></table>\r\n        </li>\r\n      <% }) %>\r\n    </ul>\r\n    <% } %>\r\n    <a class="add-layer link-large ocean-color" href="#">+ <%= t.ux.layers.add_layer %></a>\r\n    \r\n  </div>\r\n</div>\r\n';
    }), define("components/app/layers/layerCustomCategory/LayerCustomCategoryView", ["jquery", "underscore", "backbone", "jquery.spectrum", "text!./layerCustomCategoryTemplate.html"], function(a, b, c, d, e, f) {
        var g = c.View.extend({
            events: {
                "click .toggle-layer": "toggleLayer",
                "click .edit-layer": "handleLayerEdit",
                "click .edit-layer-title": "handleLayerTitleEdit",
                "click .save-layer-title": "handleLayerTitleSave",
                "click .edit-layer-color": "handleLayerColorEdit",
                "click .cancel-layer-color": "handleLayerColorCancel",
                "click .save-layer-color": "handleLayerColorSave",
                "click .add-layer": "handleLayerAdd",
                "click .remove-layer": "handleLayerRemove",
                "click .print-map": "handlePrintMap",
                "click .close-item": "closeCategory"
            },
            initialize: function() {
                this.listenTo(this.model, "change:layers", this.handleLayersUpdate), this.listenTo(this.model, "change:customData", this.handleLayersUpdate), this.listenTo(this.model, "change:edit", this.handleLayersUpdate), this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:activeLayerIds", this.handleActiveLayersUpdate), this.listenTo(this.model, "change:categories", this.handleActiveLayersUpdate)
            },
            render: function() {
                if (this.$el.html(b.template(e)({
                        category: this.model.getCategory(),
                        catNav: b.template(f)({
                            categories: this.model.getCategories(),
                            t: tlang,
                            category: this.model.getCategory()
                        }),
                        ocean: this.model.getOcean(),
                        layers: this.model.getLayers().models,
                        editTitle: this.model.getEditTitleId(),
                        editColor: this.model.getEditColorId(),
                        lang: lang,
                        t: tlang
                    })), "" !== this.model.getEditTitleId()) {
                    var c = this;
                    this.$(".input-layer-title").on("click", this.selectOnClick).keyup(function(b) {
                        13 == b.keyCode && a(this).trigger("enterKey")
                    }).bind("enterKey", function(a) {
                        c.handleLayerTitleSave(a)
                    })
                }
                if ("" !== this.model.getEditColorId()) {
                    var c = this;
                    this.$(".input-layer-color").spectrum({
                        flat: !0,
                        showInitial: !0,
                        chooseText: tlang.ux.layers.confirm,
                        cancelText: "",
                        clickoutFiresChange: !1
                    }).on("change.spectrum", b.bind(c.handleLayerColorSave, this))
                }
                return this
            },
            selectOnClick: function(a) {
                a.preventDefault(), a.target.focus(), a.target.select(), setTimeout(function() {
                    a.target.setSelectionRange(0, 9999)
                }, 1)
            },
            handleActive: function() {
                this.model.isActive() ? (this.render(), this.$el.show()) : this.$el.hide()
            },
            handleLayersUpdate: function() {
                this.model.setEditTitleId(""), this.model.setEditColorId(""), this.render()
            },
            handleActiveLayersUpdate: function() {
                this.render()
            },
            closeCategory: function(a) {
                a.preventDefault(), a.stopPropagation(), this.$el.trigger("layerCategoryClose")
            },
            toggleLayer: function(b) {
                b.preventDefault(), b.stopPropagation(), this.$el.trigger("layerToggled", {
                    id: a(b.currentTarget).data("layerid")
                })
            },
            handlePrintMap: function(a) {
                a.preventDefault(), this.$el.trigger("printMapModal")
            },
            handleLayerAdd: function(a) {
                a.preventDefault(), this.$el.trigger("addCustomLayer", {
                    ocean: this.model.getOcean()
                })
            },
            handleLayerRemove: function(b) {
                b.preventDefault(), this.$el.trigger("removeCustomLayer", {
                    id: a(b.target).data("layerid")
                })
            },
            handleLayerEdit: function(b) {
                b.preventDefault(), this.$el.trigger("editCustomLayer", {
                    id: a(b.target).data("layerid")
                })
            },
            handleLayerTitleEdit: function(b) {
                b.preventDefault(), this.model.setEditTitleId(a(b.target).closest("a").data("layerid")), this.render()
            },
            handleLayerColorEdit: function(b) {
                b.preventDefault(), this.model.setEditColorId(a(b.target).closest("a").data("layerid")), this.render()
            },
            handleLayerTitleSave: function(b) {
                b.preventDefault();
                var c = a(b.target).data("layerid"),
                    d = this.$(".title input[data-layerid=" + c + "]").val();
                d !== this.model.getLayers().findWhere({
                    id: c
                }).getTitle() ? this.$el.trigger("customUpdated", {
                    layer: {
                        id: c,
                        title: d
                    }
                }) : (this.model.setEditTitleId(""), this.render())
            },
            handleLayerColorSave: function(b, c) {
                b.preventDefault();
                var d = a(b.target).data("layerid"),
                    e = c.toHexString();
                this.$el.trigger("customUpdated", {
                    layer: {
                        id: d,
                        color: e
                    }
                })
            },
            handleLayerColorCancel: function(a, b) {
                a.preventDefault(), this.model.setEditColorId(""), this.render()
            }
        });
        return g
    }), define("components/app/layers/layerCustomCategory/LayerCustomCategoryModel", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.Model.extend({
            initialize: function(a) {
                this.options = a || {}, this.set("editTitleId", ""), this.set("editColorId", "")
            },
            setActive: function(a) {
                a = "undefined" == typeof a || a, this.set("active", a)
            },
            isActive: function() {
                return this.attributes.active
            },
            getCategory: function() {
                return this.attributes.category
            },
            setCategories: function(a) {
                this.set("categories", a)
            },
            getCategories: function() {
                return this.attributes.categories
            },
            setLayers: function(a) {
                return this.set("layers", a)
            },
            getLayers: function() {
                return this.attributes.layers
            },
            setEdit: function(a) {
                this.set("edit", a)
            },
            setCustomData: function(a) {
                this.set("customData", a)
            },
            getCustomData: function() {
                return this.attributes.customData
            },
            setEditTitleId: function(a) {
                this.set("editTitleId", a)
            },
            getEditTitleId: function() {
                return this.attributes.editTitleId
            },
            setEditColorId: function(a) {
                this.set("editColorId", a)
            },
            getEditColorId: function() {
                return this.attributes.editColorId
            },
            setActiveLayerIds: function(a) {
                this.set("activeLayerIds", a)
            },
            getOcean: function() {
                return this.attributes.ocean
            }
        });
        return d
    }), define("text!templates/categoryCountTemplate.html", [], function() {
        return '<a href="#"\r\n   data-catid=\'<%= cat.value %>\' \r\n   class="cat-layers-remove reveal-on-hover">\r\n  <span class="hide-on-hover"><%= cat.activeCount %></span>\r\n  <span class="show-on-hover icon-wwf_close-menu"></span>\r\n</a>'
    }), define("components/app/layers/layerHome/LayerHomeView", ["jquery", "underscore", "backbone", "text!templates/oceanHeaderTemplate.html", "text!templates/categoryCountTemplate.html"], function(a, b, c, d, e) {
        var f = c.View.extend({
            events: {
                "click .close-item": "closeHome"
            },
            initialize: function() {
                this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:ocean", this.handleOceanChange), this.listenTo(this.model, "change:categories", this.handleCategoriesChange), this.render()
            },
            render: function() {
                var a = this;
                return this.$(".content").html('<span class="loading-animation panel-loading-animation"></span>'), this.model.getContent().getContent(function(b) {
                    a.$(".content").html(""), a.$(".content").append(b), a.$(".content").addClass("layers-home"), a.populatePlaceholders(), a.updateCategoryCounts()
                }), this
            },
            updateCategoryCounts: function() {
                var c = this;
                this.$(".layer-links td a").each(function() {
                    var d = a(this).data("catid"),
                        f = b.findWhere(c.model.getCategories(), {
                            value: d
                        });
                    a(this).find(".cat-layers-remove").remove(), f.activeCount > 0 && a(this).append(b.template(e)({
                        cat: f
                    }))
                })
            },
            populatePlaceholders: function() {
                var a = this.model.getOcean(),
                    c = this;
                waitFor(function() {
                    return c.model.getContent().isContentReady()
                }, function() {
                    c.$(".placeholder-ocean").html(b.template(d)({
                        ocean: a,
                        t: tlang
                    }))
                })
            },
            handleOceanChange: function() {
                this.populatePlaceholders()
            },
            handleCategoriesChange: function() {
                this.updateCategoryCounts()
            },
            handleActive: function() {
                this.model.isActive() ? (this.$el.show(), this.updateCategoryCounts()) : this.$el.hide()
            },
            closeHome: function(a) {
                a.target === a.currentTarget && (a.preventDefault(), a.stopPropagation(), this.$el.addClass("hidden-xs"), this.$el.addClass("hidden-sm"))
            },
            handlePageLink: function(b) {
                b.preventDefault(), b.stopPropagation(), this.$el.trigger("pageLinkClick", {
                    target: b.target,
                    id: a(b.target).data("pageid")
                }), a("#navbar-collapse").collapse("hide")
            }
        });
        return f
    }), define("components/app/layers/layerHome/LayerHomeModel", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.Model.extend({
            initialize: function(a) {
                this.options = a || {}
            },
            getContent: function() {
                return this.attributes.content
            },
            getOcean: function() {
                return this.attributes.ocean
            },
            setOcean: function(a) {
                this.set("ocean", a)
            },
            getCategories: function() {
                return this.attributes.categories
            },
            setCategories: function(a) {
                this.set("categories", a)
            },
            setActive: function(a) {
                a = "undefined" == typeof a || a, this.set("active", a)
            },
            isActive: function() {
                return this.get("active")
            }
        });
        return d
    }), define("components/app/layers/layerItem/LayerItemView", ["jquery", "underscore", "backbone", "text!templates/categoryPlaceholderTemplate.html", "text!templates/layerControlPlaceholderTemplate.html", "text!templates/layerReferencePlaceholderTemplate.html", "text!templates/oceanHeaderTemplate.html"], function(a, b, c, d, e, f, g) {
        var h = c.View.extend({
            events: {
                "click .toggle-layer": "toggleLayer",
                "click .close-item": "closeItem"
            },
            initialize: function() {
                this.listenTo(this.model, "change:activeLayerIds", this.render), this.listenTo(this.model, "change:active", this.handleActive), this.render()
            },
            render: function() {
                var a = this;
                return this.$el.html('<span class="loading-animation panel-loading-animation"></span>'), this.model.getLayer().getContent(function(b) {
                    a.$el.html(""), a.$el.append(b), a.populatePlaceholders()
                }), this
            },
            populatePlaceholders: function() {
                var a = this.model.getLayer();
                "undefined" !== a.getCategory() && this.$(".placeholder-category").html(b.template(d)({
                    catId: a.getCategory(),
                    catTitle: tlang.categories[a.getCategory()],
                    subcatTitle: "undefined" !== a.getSubcategory() ? tlang.subcategories[a.getSubcategory()].title : ""
                })), this.$(".placeholder-ocean").html(b.template(g)({
                    ocean: this.model.getOcean(),
                    t: tlang
                })), this.$(".placeholder-layercontrol").html(b.template(e)({
                    id: a.id,
                    title: a.getTitle(),
                    hint: a.getHint(),
                    info: !1,
                    toggable: !a.isBasemap(),
                    layerGradient: a.makeLayerGradientKey(),
                    layerCategories: a.makeLayerCategoriesKey(),
                    isActive: a.isActive() || a.isBasemap(),
                    keyHtml: a.getKeySquareIcon("sm"),
                    t: tlang
                })), this.$(".placeholder-layer-reference").html(b.template(f)({
                    text: a.getReference().linkify()
                })), this.$(".placeholder-layer-reference").find('a[href^="http"]').attr("target", "_blank")
            },
            handleActive: function() {
                this.model.isActive() ? this.$el.show() : this.$el.hide()
            },
            toggleLayer: function(b) {
                b.preventDefault(), b.stopPropagation(), (a(b.currentTarget).data("toggable") || "true" === a(b.currentTarget).data("toggable")) && this.$el.trigger("layerToggled", {
                    id: a(b.currentTarget).data("layerid")
                })
            },
            closeItem: function(a) {
                a.preventDefault(), a.stopPropagation(), this.$el.trigger("closeLayerInfo", {
                    target: a.target,
                    id: this.model.get("layer").id
                })
            }
        });
        return h
    }), define("components/app/layers/layerItem/LayerItemModel", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.Model.extend({
            initialize: function(a) {
                this.options = a || {}
            },
            getLayer: function() {
                return this.attributes.layer
            },
            getOcean: function() {
                return this.attributes.ocean
            },
            setActiveLayerIds: function(a) {
                return this.set("activeLayerIds", a)
            },
            setActive: function(a) {
                a = "undefined" == typeof a || a, this.set("active", a)
            },
            isActive: function() {
                return this.get("active")
            }
        });
        return d
    }),
    function() {
        function a(a) {
            "use strict";
            var b = {
                omitExtraWLInCodeBlocks: {
                    default: !1,
                    describe: "Omit the default extra whiteline added to code blocks",
                    type: "boolean"
                },
                noHeaderId: {
                    default: !1,
                    describe: "Turn on/off generated header id",
                    type: "boolean"
                },
                prefixHeaderId: {
                    default: !1,
                    describe: "Specify a prefix to generated header ids",
                    type: "string"
                },
                headerLevelStart: {
                    default: !1,
                    describe: "The header blocks level start",
                    type: "integer"
                },
                parseImgDimensions: {
                    default: !1,
                    describe: "Turn on/off image dimension parsing",
                    type: "boolean"
                },
                simplifiedAutoLink: {
                    default: !1,
                    describe: "Turn on/off GFM autolink style",
                    type: "boolean"
                },
                literalMidWordUnderscores: {
                    default: !1,
                    describe: "Parse midword underscores as literal underscores",
                    type: "boolean"
                },
                strikethrough: {
                    default: !1,
                    describe: "Turn on/off strikethrough support",
                    type: "boolean"
                },
                tables: {
                    default: !1,
                    describe: "Turn on/off tables support",
                    type: "boolean"
                },
                tablesHeaderId: {
                    default: !1,
                    describe: "Add an id to table headers",
                    type: "boolean"
                },
                ghCodeBlocks: {
                    default: !0,
                    describe: "Turn on/off GFM fenced code blocks support",
                    type: "boolean"
                },
                tasklists: {
                    default: !1,
                    describe: "Turn on/off GFM tasklist support",
                    type: "boolean"
                },
                smoothLivePreview: {
                    default: !1,
                    describe: "Prevents weird effects in live previews due to incomplete input",
                    type: "boolean"
                }
            };
            if (a === !1) return JSON.parse(JSON.stringify(b));
            var c = {};
            for (var d in b) b.hasOwnProperty(d) && (c[d] = b[d].default);
            return c
        }

        function b(a, b) {
            "use strict";
            var c = b ? "Error in " + b + " extension->" : "Error in unnamed extension",
                e = {
                    valid: !0,
                    error: ""
                };
            d.helper.isArray(a) || (a = [a]);
            for (var f = 0; f < a.length; ++f) {
                var g = c + " sub-extension " + f + ": ",
                    h = a[f];
                if ("object" != typeof h) return e.valid = !1, e.error = g + "must be an object, but " + typeof h + " given", e;
                if (!d.helper.isString(h.type)) return e.valid = !1, e.error = g + 'property "type" must be a string, but ' + typeof h.type + " given", e;
                var i = h.type = h.type.toLowerCase();
                if ("language" === i && (i = h.type = "lang"), "html" === i && (i = h.type = "output"), "lang" !== i && "output" !== i && "listener" !== i) return e.valid = !1, e.error = g + "type " + i + ' is not recognized. Valid values: "lang/language", "output/html" or "listener"', e;
                if ("listener" === i) {
                    if (d.helper.isUndefined(h.listeners)) return e.valid = !1, e.error = g + '. Extensions of type "listener" must have a property called "listeners"', e
                } else if (d.helper.isUndefined(h.filter) && d.helper.isUndefined(h.regex)) return e.valid = !1, e.error = g + i + ' extensions must define either a "regex" property or a "filter" method', e;
                if (h.listeners) {
                    if ("object" != typeof h.listeners) return e.valid = !1, e.error = g + '"listeners" property must be an object but ' + typeof h.listeners + " given", e;
                    for (var j in h.listeners)
                        if (h.listeners.hasOwnProperty(j) && "function" != typeof h.listeners[j]) return e.valid = !1, e.error = g + '"listeners" property must be an hash of [event name]: [callback]. listeners.' + j + " must be a function but " + typeof h.listeners[j] + " given", e
                }
                if (h.filter) {
                    if ("function" != typeof h.filter) return e.valid = !1, e.error = g + '"filter" must be a function, but ' + typeof h.filter + " given", e
                } else if (h.regex) {
                    if (d.helper.isString(h.regex) && (h.regex = new RegExp(h.regex, "g")), !h.regex instanceof RegExp) return e.valid = !1, e.error = g + '"regex" property must either be a string or a RegExp object, but ' + typeof h.regex + " given", e;
                    if (d.helper.isUndefined(h.replace)) return e.valid = !1, e.error = g + '"regex" extensions must implement a replace string or function', e
                }
            }
            return e
        }

        function c(a, b) {
            "use strict";
            var c = b.charCodeAt(0);
            return "~E" + c + "E"
        }
        var d = {},
            e = {},
            f = {},
            g = a(!0),
            h = {
                github: {
                    omitExtraWLInCodeBlocks: !0,
                    prefixHeaderId: "user-content-",
                    simplifiedAutoLink: !0,
                    literalMidWordUnderscores: !0,
                    strikethrough: !0,
                    tables: !0,
                    tablesHeaderId: !0,
                    ghCodeBlocks: !0,
                    tasklists: !0
                },
                vanilla: a(!0)
            };
        d.helper = {}, d.extensions = {}, d.setOption = function(a, b) {
            "use strict";
            return g[a] = b, this
        }, d.getOption = function(a) {
            "use strict";
            return g[a]
        }, d.getOptions = function() {
            "use strict";
            return g
        }, d.resetOptions = function() {
            "use strict";
            g = a(!0)
        }, d.setFlavor = function(a) {
            "use strict";
            if (h.hasOwnProperty(a)) {
                var b = h[a];
                for (var c in b) b.hasOwnProperty(c) && (g[c] = b[c])
            }
        }, d.getDefaultOptions = function(b) {
            "use strict";
            return a(b)
        }, d.subParser = function(a, b) {
            "use strict";
            if (d.helper.isString(a)) {
                if ("undefined" == typeof b) {
                    if (e.hasOwnProperty(a)) return e[a];
                    throw Error("SubParser named " + a + " not registered!")
                }
                e[a] = b
            }
        }, d.extension = function(a, c) {
            "use strict";
            if (!d.helper.isString(a)) throw Error("Extension 'name' must be a string");
            if (a = d.helper.stdExtName(a), d.helper.isUndefined(c)) {
                if (!f.hasOwnProperty(a)) throw Error("Extension named " + a + " is not registered!");
                return f[a]
            }
            "function" == typeof c && (c = c()), d.helper.isArray(c) || (c = [c]);
            var e = b(c, a);
            if (!e.valid) throw Error(e.error);
            f[a] = c
        }, d.getAllExtensions = function() {
            "use strict";
            return f
        }, d.removeExtension = function(a) {
            "use strict";
            delete f[a]
        }, d.resetExtensions = function() {
            "use strict";
            f = {}
        }, d.validateExtension = function(a) {
            "use strict";
            var c = b(a, null);
            return !!c.valid || (console.warn(c.error), !1)
        }, d.hasOwnProperty("helper") || (d.helper = {}), d.helper.isString = function(a) {
            "use strict";
            return "string" == typeof a || a instanceof String
        }, d.helper.isFunction = function(a) {
            "use strict";
            var b = {};
            return a && "[object Function]" === b.toString.call(a)
        }, d.helper.forEach = function(a, b) {
            "use strict";
            if ("function" == typeof a.forEach) a.forEach(b);
            else
                for (var c = 0; c < a.length; c++) b(a[c], c, a)
        }, d.helper.isArray = function(a) {
            "use strict";
            return a.constructor === Array
        }, d.helper.isUndefined = function(a) {
            "use strict";
            return "undefined" == typeof a
        }, d.helper.stdExtName = function(a) {
            "use strict";
            return a.replace(/[_-]||\s/g, "").toLowerCase()
        }, d.helper.escapeCharactersCallback = c, d.helper.escapeCharacters = function(a, b, d) {
            "use strict";
            var e = "([" + b.replace(/([\[\]\\])/g, "\\$1") + "])";
            d && (e = "\\\\" + e);
            var f = new RegExp(e, "g");
            return a = a.replace(f, c)
        };
        var i = function(a, b, c, d) {
            "use strict";
            var j, k, l, m, n, e = d || "",
                f = e.indexOf("g") > -1,
                g = new RegExp(b + "|" + c, "g" + e.replace(/g/g, "")),
                h = new RegExp(b, e.replace(/g/g, "")),
                i = [];
            do
                for (j = 0; l = g.exec(a);)
                    if (h.test(l[0])) j++ || (k = g.lastIndex, m = k - l[0].length);
                    else if (j && !--j) {
                n = l.index + l[0].length;
                var o = {
                    left: {
                        start: m,
                        end: k
                    },
                    match: {
                        start: k,
                        end: l.index
                    },
                    right: {
                        start: l.index,
                        end: n
                    },
                    wholeMatch: {
                        start: m,
                        end: n
                    }
                };
                if (i.push(o), !f) return i
            } while (j && (g.lastIndex = k));
            return i
        };
        d.helper.matchRecursiveRegExp = function(a, b, c, d) {
            "use strict";
            for (var e = i(a, b, c, d), f = [], g = 0; g < e.length; ++g) f.push([a.slice(e[g].wholeMatch.start, e[g].wholeMatch.end), a.slice(e[g].match.start, e[g].match.end), a.slice(e[g].left.start, e[g].left.end), a.slice(e[g].right.start, e[g].right.end)]);
            return f
        }, d.helper.replaceRecursiveRegExp = function(a, b, c, e, f) {
            "use strict";
            if (!d.helper.isFunction(b)) {
                var g = b;
                b = function() {
                    return g
                }
            }
            var h = i(a, c, e, f),
                j = a,
                k = h.length;
            if (k > 0) {
                var l = [];
                0 !== h[0].wholeMatch.start && l.push(a.slice(0, h[0].wholeMatch.start));
                for (var m = 0; m < k; ++m) l.push(b(a.slice(h[m].wholeMatch.start, h[m].wholeMatch.end), a.slice(h[m].match.start, h[m].match.end), a.slice(h[m].left.start, h[m].left.end), a.slice(h[m].right.start, h[m].right.end))), m < k - 1 && l.push(a.slice(h[m].wholeMatch.end, h[m + 1].wholeMatch.start));
                h[k - 1].wholeMatch.end < a.length && l.push(a.slice(h[k - 1].wholeMatch.end)), j = l.join("")
            }
            return j
        }, d.helper.isUndefined(console) && (console = {
            warn: function(a) {
                "use strict";
                alert(a)
            },
            log: function(a) {
                "use strict";
                alert(a)
            },
            error: function(a) {
                "use strict";
                throw a
            }
        }), d.Converter = function(a) {
            "use strict";

            function c() {
                a = a || {};
                for (var b in g) g.hasOwnProperty(b) && (k[b] = g[b]);
                if ("object" != typeof a) throw Error("Converter expects the passed parameter to be an object, but " + typeof a + " was passed instead.");
                for (var c in a) a.hasOwnProperty(c) && (k[c] = a[c]);
                k.extensions && d.helper.forEach(k.extensions, e)
            }

            function e(a, c) {
                if (c = c || null, d.helper.isString(a)) {
                    if (a = d.helper.stdExtName(a), c = a, d.extensions[a]) return console.warn("DEPRECATION WARNING: " + a + " is an old extension that uses a deprecated loading method.Please inform the developer that the extension should be updated!"), void i(d.extensions[a], a);
                    if (d.helper.isUndefined(f[a])) throw Error('Extension "' + a + '" could not be loaded. It was either not found or is not a valid extension.');
                    a = f[a]
                }
                "function" == typeof a && (a = a()), d.helper.isArray(a) || (a = [a]);
                var e = b(a, c);
                if (!e.valid) throw Error(e.error);
                for (var g = 0; g < a.length; ++g) {
                    switch (a[g].type) {
                        case "lang":
                            l.push(a[g]);
                            break;
                        case "output":
                            m.push(a[g])
                    }
                    if (a[g].hasOwnProperty(n))
                        for (var h in a[g].listeners) a[g].listeners.hasOwnProperty(h) && j(h, a[g].listeners[h])
                }
            }

            function i(a, c) {
                "function" == typeof a && (a = a(new d.Converter)), d.helper.isArray(a) || (a = [a]);
                var e = b(a, c);
                if (!e.valid) throw Error(e.error);
                for (var f = 0; f < a.length; ++f) switch (a[f].type) {
                    case "lang":
                        l.push(a[f]);
                        break;
                    case "output":
                        m.push(a[f]);
                        break;
                    default:
                        throw Error("Extension loader error: Type unrecognized!!!")
                }
            }

            function j(a, b) {
                if (!d.helper.isString(a)) throw Error("Invalid argument in converter.listen() method: name must be a string, but " + typeof a + " given");
                if ("function" != typeof b) throw Error("Invalid argument in converter.listen() method: callback must be a function, but " + typeof b + " given");
                n.hasOwnProperty(a) || (n[a] = []), n[a].push(b)
            }
            var k = {},
                l = [],
                m = [],
                n = {};
            c(), this._dispatch = function(a, b, c, d) {
                if (n.hasOwnProperty(a))
                    for (var e = 0; e < n[a].length; ++e) {
                        var f = n[a][e](a, b, this, c, d);
                        f && "undefined" != typeof f && (b = f)
                    }
                return b
            }, this.listen = function(a, b) {
                return j(a, b), this
            }, this.makeHtml = function(a) {
                if (!a) return a;
                var b = {
                    gHtmlBlocks: [],
                    gHtmlMdBlocks: [],
                    gHtmlSpans: [],
                    gUrls: {},
                    gTitles: {},
                    gDimensions: {},
                    gListLevel: 0,
                    hashLinkCounts: {},
                    langExtensions: l,
                    outputModifiers: m,
                    converter: this,
                    ghCodeBlocks: []
                };
                return a = a.replace(/~/g, "~T"), a = a.replace(/\$/g, "~D"), a = a.replace(/\r\n/g, "\n"), a = a.replace(/\r/g, "\n"), a = "\n\n" + a + "\n\n", a = d.subParser("detab")(a, k, b), a = d.subParser("stripBlankLines")(a, k, b), d.helper.forEach(l, function(c) {
                    a = d.subParser("runExtension")(c, a, k, b)
                }), a = d.subParser("hashPreCodeTags")(a, k, b), a = d.subParser("githubCodeBlocks")(a, k, b), a = d.subParser("hashHTMLBlocks")(a, k, b), a = d.subParser("hashHTMLSpans")(a, k, b), a = d.subParser("stripLinkDefinitions")(a, k, b), a = d.subParser("blockGamut")(a, k, b), a = d.subParser("unhashHTMLSpans")(a, k, b), a = d.subParser("unescapeSpecialChars")(a, k, b), a = a.replace(/~D/g, "$$"), a = a.replace(/~T/g, "~"), d.helper.forEach(m, function(c) {
                    a = d.subParser("runExtension")(c, a, k, b)
                }), a
            }, this.setOption = function(a, b) {
                k[a] = b
            }, this.getOption = function(a) {
                return k[a]
            }, this.getOptions = function() {
                return k
            }, this.addExtension = function(a, b) {
                b = b || null, e(a, b)
            }, this.useExtension = function(a) {
                e(a)
            }, this.setFlavor = function(a) {
                if (h.hasOwnProperty(a)) {
                    var b = h[a];
                    for (var c in b) b.hasOwnProperty(c) && (k[c] = b[c])
                }
            }, this.removeExtension = function(a) {
                d.helper.isArray(a) || (a = [a]);
                for (var b = 0; b < a.length; ++b) {
                    for (var c = a[b], e = 0; e < l.length; ++e) l[e] === c && l[e].splice(e, 1);
                    for (var f = 0; f < m.length; ++e) m[f] === c && m[f].splice(e, 1)
                }
            }, this.getAllExtensions = function() {
                return {
                    language: l,
                    output: m
                }
            }
        }, d.subParser("anchors", function(a, b, c) {
            "use strict";
            a = c.converter._dispatch("anchors.before", a, b, c);
            var e = function(a, b, e, f, g, h, i, j) {
                d.helper.isUndefined(j) && (j = ""), a = b;
                var k = e,
                    l = f.toLowerCase(),
                    m = g,
                    n = j;
                if (!m)
                    if (l || (l = k.toLowerCase().replace(/ ?\n/g, " ")), m = "#" + l, d.helper.isUndefined(c.gUrls[l])) {
                        if (!(a.search(/\(\s*\)$/m) > -1)) return a;
                        m = ""
                    } else m = c.gUrls[l], d.helper.isUndefined(c.gTitles[l]) || (n = c.gTitles[l]);
                m = d.helper.escapeCharacters(m, "*_", !1);
                var o = '<a href="' + m + '"';
                return "" !== n && null !== n && (n = n.replace(/"/g, "&quot;"), n = d.helper.escapeCharacters(n, "*_", !1), o += ' title="' + n + '"'), o += ">" + k + "</a>"
            };
            return a = a.replace(/(\[((?:\[[^\]]*]|[^\[\]])*)][ ]?(?:\n[ ]*)?\[(.*?)])()()()()/g, e), a = a.replace(/(\[((?:\[[^\]]*]|[^\[\]])*)]\([ \t]*()<?(.*?(?:\(.*?\).*?)?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g, e), a = a.replace(/(\[([^\[\]]+)])()()()()()/g, e), a = c.converter._dispatch("anchors.after", a, b, c)
        }), d.subParser("autoLinks", function(a, b, c) {
            "use strict";

            function e(a, b) {
                var c = d.subParser("unescapeSpecialChars")(b);
                return d.subParser("encodeEmailAddress")(c)
            }
            a = c.converter._dispatch("autoLinks.before", a, b, c);
            var f = /\b(((https?|ftp|dict):\/\/|www\.)[^'">\s]+\.[^'">\s]+)(?=\s|$)(?!["<>])/gi,
                g = /<(((https?|ftp|dict):\/\/|www\.)[^'">\s]+)>/gi,
                h = /(?:^|[ \n\t])([A-Za-z0-9!#$%&'*+-\/=?^_`\{|}~\.]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)(?:$|[ \n\t])/gi,
                i = /<(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi;
            return a = a.replace(g, '<a href="$1">$1</a>'), a = a.replace(i, e), b.simplifiedAutoLink && (a = a.replace(f, '<a href="$1">$1</a>'), a = a.replace(h, e)), a = c.converter._dispatch("autoLinks.after", a, b, c)
        }), d.subParser("blockGamut", function(a, b, c) {
            "use strict";
            a = c.converter._dispatch("blockGamut.before", a, b, c), a = d.subParser("blockQuotes")(a, b, c), a = d.subParser("headers")(a, b, c);
            var e = d.subParser("hashBlock")("<hr />", b, c);
            return a = a.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm, e), a = a.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm, e), a = a.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm, e), a = d.subParser("lists")(a, b, c), a = d.subParser("codeBlocks")(a, b, c), a = d.subParser("tables")(a, b, c), a = d.subParser("hashHTMLBlocks")(a, b, c), a = d.subParser("paragraphs")(a, b, c), a = c.converter._dispatch("blockGamut.after", a, b, c)
        }), d.subParser("blockQuotes", function(a, b, c) {
            "use strict";
            return a = c.converter._dispatch("blockQuotes.before", a, b, c), a = a.replace(/((^[ \t]{0,3}>[ \t]?.+\n(.+\n)*\n*)+)/gm, function(a, e) {
                var f = e;
                return f = f.replace(/^[ \t]*>[ \t]?/gm, "~0"), f = f.replace(/~0/g, ""), f = f.replace(/^[ \t]+$/gm, ""), f = d.subParser("githubCodeBlocks")(f, b, c), f = d.subParser("blockGamut")(f, b, c), f = f.replace(/(^|\n)/g, "$1  "), f = f.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm, function(a, b) {
                    var c = b;
                    return c = c.replace(/^  /gm, "~0"), c = c.replace(/~0/g, "")
                }), d.subParser("hashBlock")("<blockquote>\n" + f + "\n</blockquote>", b, c)
            }), a = c.converter._dispatch("blockQuotes.after", a, b, c)
        }), d.subParser("codeBlocks", function(a, b, c) {
            "use strict";
            a = c.converter._dispatch("codeBlocks.before", a, b, c), a += "~0";
            var e = /(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g;
            return a = a.replace(e, function(a, e, f) {
                var g = e,
                    h = f,
                    i = "\n";
                return g = d.subParser("outdent")(g), g = d.subParser("encodeCode")(g), g = d.subParser("detab")(g), g = g.replace(/^\n+/g, ""), g = g.replace(/\n+$/g, ""), b.omitExtraWLInCodeBlocks && (i = ""), g = "<pre><code>" + g + i + "</code></pre>", d.subParser("hashBlock")(g, b, c) + h
            }), a = a.replace(/~0/, ""), a = c.converter._dispatch("codeBlocks.after", a, b, c)
        }), d.subParser("codeSpans", function(a, b, c) {
            "use strict";
            return a = c.converter._dispatch("codeSpans.before", a, b, c), a = a.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm, function(a, b, c, e) {
                var f = e;
                return f = f.replace(/^([ \t]*)/g, ""), f = f.replace(/[ \t]*$/g, ""), f = d.subParser("encodeCode")(f), b + "<code>" + f + "</code>"
            }), a = c.converter._dispatch("codeSpans.after", a, b, c)
        }), d.subParser("detab", function(a) {
            "use strict";
            return a = a.replace(/\t(?=\t)/g, "    "), a = a.replace(/\t/g, "~A~B"), a = a.replace(/~B(.+?)~A/g, function(a, b) {
                for (var c = b, d = 4 - c.length % 4, e = 0; e < d; e++) c += " ";
                return c
            }), a = a.replace(/~A/g, "    "), a = a.replace(/~B/g, "")
        }), d.subParser("encodeAmpsAndAngles", function(a) {
            "use strict";
            return a = a.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g, "&amp;"), a = a.replace(/<(?![a-z\/?\$!])/gi, "&lt;")
        }), d.subParser("encodeBackslashEscapes", function(a) {
            "use strict";
            return a = a.replace(/\\(\\)/g, d.helper.escapeCharactersCallback), a = a.replace(/\\([`*_{}\[\]()>#+-.!])/g, d.helper.escapeCharactersCallback)
        }), d.subParser("encodeCode", function(a) {
            "use strict";
            return a = a.replace(/&/g, "&amp;"), a = a.replace(/</g, "&lt;"), a = a.replace(/>/g, "&gt;"), a = d.helper.escapeCharacters(a, "*_{}[]\\", !1)
        }), d.subParser("encodeEmailAddress", function(a) {
            "use strict";
            var b = [function(a) {
                return "&#" + a.charCodeAt(0) + ";"
            }, function(a) {
                return "&#x" + a.charCodeAt(0).toString(16) + ";"
            }, function(a) {
                return a
            }];
            return a = "mailto:" + a, a = a.replace(/./g, function(a) {
                if ("@" === a) a = b[Math.floor(2 * Math.random())](a);
                else if (":" !== a) {
                    var c = Math.random();
                    a = c > .9 ? b[2](a) : c > .45 ? b[1](a) : b[0](a)
                }
                return a
            }), a = '<a href="' + a + '">' + a + "</a>", a = a.replace(/">.+:/g, '">')
        }), d.subParser("escapeSpecialCharsWithinTagAttributes", function(a) {
            "use strict";
            var b = /(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi;
            return a = a.replace(b, function(a) {
                var b = a.replace(/(.)<\/?code>(?=.)/g, "$1`");
                return b = d.helper.escapeCharacters(b, "\\`*_", !1)
            })
        }), d.subParser("githubCodeBlocks", function(a, b, c) {
            "use strict";
            return b.ghCodeBlocks ? (a = c.converter._dispatch("githubCodeBlocks.before", a, b, c), a += "~0", a = a.replace(/(?:^|\n)```(.*)\n([\s\S]*?)\n```/g, function(a, e, f) {
                var g = b.omitExtraWLInCodeBlocks ? "" : "\n";
                return f = d.subParser("encodeCode")(f), f = d.subParser("detab")(f), f = f.replace(/^\n+/g, ""), f = f.replace(/\n+$/g, ""), f = "<pre><code" + (e ? ' class="' + e + " language-" + e + '"' : "") + ">" + f + g + "</code></pre>", f = d.subParser("hashBlock")(f, b, c), "\n\n~G" + (c.ghCodeBlocks.push({
                    text: a,
                    codeblock: f
                }) - 1) + "G\n\n"
            }), a = a.replace(/~0/, ""), c.converter._dispatch("githubCodeBlocks.after", a, b, c)) : a
        }), d.subParser("hashBlock", function(a, b, c) {
            "use strict";
            return a = a.replace(/(^\n+|\n+$)/g, ""), "\n\n~K" + (c.gHtmlBlocks.push(a) - 1) + "K\n\n"
        }), d.subParser("hashElement", function(a, b, c) {
            "use strict";
            return function(a, b) {
                var d = b;
                return d = d.replace(/\n\n/g, "\n"), d = d.replace(/^\n/, ""), d = d.replace(/\n+$/g, ""), d = "\n\n~K" + (c.gHtmlBlocks.push(d) - 1) + "K\n\n"
            }
        }), d.subParser("hashHTMLBlocks", function(a, b, c) {
            "use strict";
            for (var e = ["pre", "div", "h1", "h2", "h3", "h4", "h5", "h6", "blockquote", "table", "dl", "ol", "ul", "script", "noscript", "form", "fieldset", "iframe", "math", "style", "section", "header", "footer", "nav", "article", "aside", "address", "audio", "canvas", "figure", "hgroup", "output", "video", "p"], f = function(a, b, d, e) {
                    var f = a;
                    return d.search(/\bmarkdown\b/) !== -1 && (f = d + c.converter.makeHtml(b) + e), "\n\n~K" + (c.gHtmlBlocks.push(f) - 1) + "K\n\n"
                }, g = 0; g < e.length; ++g) a = d.helper.replaceRecursiveRegExp(a, f, "^(?: |\\t){0,3}<" + e[g] + "\\b[^>]*>", "</" + e[g] + ">", "gim");
            return a = a.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g, d.subParser("hashElement")(a, b, c)), a = a.replace(/(<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g, d.subParser("hashElement")(a, b, c)), a = a.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g, d.subParser("hashElement")(a, b, c))
        }), d.subParser("hashHTMLSpans", function(a, b, c) {
            "use strict";
            for (var e = d.helper.matchRecursiveRegExp(a, "<code\\b[^>]*>", "</code>", "gi"), f = 0; f < e.length; ++f) a = a.replace(e[f][0], "~L" + (c.gHtmlSpans.push(e[f][0]) - 1) + "L");
            return a
        }), d.subParser("unhashHTMLSpans", function(a, b, c) {
            "use strict";
            for (var d = 0; d < c.gHtmlSpans.length; ++d) a = a.replace("~L" + d + "L", c.gHtmlSpans[d]);
            return a
        }), d.subParser("hashPreCodeTags", function(a, b, c) {
            "use strict";
            var e = function(a, b, e, f) {
                var g = e + d.subParser("encodeCode")(b) + f;
                return "\n\n~G" + (c.ghCodeBlocks.push({
                    text: a,
                    codeblock: g
                }) - 1) + "G\n\n"
            };
            return a = d.helper.replaceRecursiveRegExp(a, e, "^(?: |\\t){0,3}<pre\\b[^>]*>\\s*<code\\b[^>]*>", "^(?: |\\t){0,3}</code>\\s*</pre>", "gim")
        }), d.subParser("headers", function(a, b, c) {
            "use strict";

            function e(a) {
                var b, e = a.replace(/[^\w]/g, "").toLowerCase();
                return c.hashLinkCounts[e] ? b = e + "-" + c.hashLinkCounts[e]++ : (b = e, c.hashLinkCounts[e] = 1), f === !0 && (f = "section"), d.helper.isString(f) ? f + b : b
            }
            a = c.converter._dispatch("headers.before", a, b, c);
            var f = b.prefixHeaderId,
                g = isNaN(parseInt(b.headerLevelStart)) ? 1 : parseInt(b.headerLevelStart),
                h = b.smoothLivePreview ? /^(.+)[ \t]*\n={2,}[ \t]*\n+/gm : /^(.+)[ \t]*\n=+[ \t]*\n+/gm,
                i = b.smoothLivePreview ? /^(.+)[ \t]*\n-{2,}[ \t]*\n+/gm : /^(.+)[ \t]*\n-+[ \t]*\n+/gm;
            return a = a.replace(h, function(a, f) {
                var h = d.subParser("spanGamut")(f, b, c),
                    i = b.noHeaderId ? "" : ' id="' + e(f) + '"',
                    j = g,
                    k = "<h" + j + i + ">" + h + "</h" + j + ">";
                return d.subParser("hashBlock")(k, b, c)
            }), a = a.replace(i, function(a, f) {
                var h = d.subParser("spanGamut")(f, b, c),
                    i = b.noHeaderId ? "" : ' id="' + e(f) + '"',
                    j = g + 1,
                    k = "<h" + j + i + ">" + h + "</h" + j + ">";
                return d.subParser("hashBlock")(k, b, c)
            }), a = a.replace(/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm, function(a, f, h) {
                var i = d.subParser("spanGamut")(h, b, c),
                    j = b.noHeaderId ? "" : ' id="' + e(h) + '"',
                    k = g - 1 + f.length,
                    l = "<h" + k + j + ">" + i + "</h" + k + ">";
                return d.subParser("hashBlock")(l, b, c)
            }), a = c.converter._dispatch("headers.after", a, b, c)
        }), d.subParser("images", function(a, b, c) {
            "use strict";

            function e(a, b, e, f, g, h, i, j) {
                var k = c.gUrls,
                    l = c.gTitles,
                    m = c.gDimensions;
                if (e = e.toLowerCase(), j || (j = ""), "" === f || null === f) {
                    if ("" !== e && null !== e || (e = b.toLowerCase().replace(/ ?\n/g, " ")), f = "#" + e, d.helper.isUndefined(k[e])) return a;
                    f = k[e], d.helper.isUndefined(l[e]) || (j = l[e]), d.helper.isUndefined(m[e]) || (g = m[e].width, h = m[e].height)
                }
                b = b.replace(/"/g, "&quot;"), b = d.helper.escapeCharacters(b, "*_", !1), f = d.helper.escapeCharacters(f, "*_", !1);
                var n = '<img src="' + f + '" alt="' + b + '"';
                return j && (j = j.replace(/"/g, "&quot;"), j = d.helper.escapeCharacters(j, "*_", !1), n += ' title="' + j + '"'), g && h && (g = "*" === g ? "auto" : g, h = "*" === h ? "auto" : h, n += ' width="' + g + '"', n += ' height="' + h + '"'), n += " />"
            }
            a = c.converter._dispatch("images.before", a, b, c);
            var f = /!\[(.*?)]\s?\([ \t]*()<?(\S+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(['"])(.*?)\6[ \t]*)?\)/g,
                g = /!\[(.*?)][ ]?(?:\n[ ]*)?\[(.*?)]()()()()()/g;
            return a = a.replace(g, e), a = a.replace(f, e), a = c.converter._dispatch("images.after", a, b, c)
        }), d.subParser("italicsAndBold", function(a, b, c) {
            "use strict";
            return a = c.converter._dispatch("italicsAndBold.before", a, b, c), b.literalMidWordUnderscores ? (a = a.replace(/(^|\s|>|\b)__(?=\S)([^]+?)__(?=\b|<|\s|$)/gm, "$1<strong>$2</strong>"), a = a.replace(/(^|\s|>|\b)_(?=\S)([^]+?)_(?=\b|<|\s|$)/gm, "$1<em>$2</em>"), a = a.replace(/(\*\*)(?=\S)([^\r]*?\S[*]*)\1/g, "<strong>$2</strong>"), a = a.replace(/(\*)(?=\S)([^\r]*?\S)\1/g, "<em>$2</em>")) : (a = a.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g, "<strong>$2</strong>"), a = a.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g, "<em>$2</em>")), a = c.converter._dispatch("italicsAndBold.after", a, b, c)
        }), d.subParser("lists", function(a, b, c) {
            "use strict";

            function e(a, e) {
                c.gListLevel++, a = a.replace(/\n{2,}$/, "\n"), a += "~0";
                var f = /(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,
                    g = /\n[ \t]*\n(?!~0)/.test(a);
                return a = a.replace(f, function(a, e, f, h, i, j, k) {
                    k = k && "" !== k.trim();
                    var l = d.subParser("outdent")(i, b, c),
                        m = "";
                    return j && b.tasklists && (m = ' class="task-list-item" style="list-style-type: none;"', l = l.replace(/^[ \t]*\[(x|X| )?]/m, function() {
                        var a = '<input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"';
                        return k && (a += " checked"), a += ">"
                    })), e || l.search(/\n{2,}/) > -1 ? (l = d.subParser("githubCodeBlocks")(l, b, c), l = d.subParser("blockGamut")(l, b, c)) : (l = d.subParser("lists")(l, b, c), l = l.replace(/\n$/, ""), l = g ? d.subParser("paragraphs")(l, b, c) : d.subParser("spanGamut")(l, b, c)), l = "\n<li" + m + ">" + l + "</li>\n"
                }), a = a.replace(/~0/g, ""), c.gListLevel--, e && (a = a.replace(/\s+$/, "")), a
            }

            function f(a, b, c) {
                var d = "ul" === b ? /^ {0,2}\d+\.[ \t]/gm : /^ {0,2}[*+-][ \t]/gm,
                    f = [],
                    g = "";
                if (a.search(d) !== -1) {
                    ! function a(f) {
                        var h = f.search(d);
                        h !== -1 ? (g += "\n\n<" + b + ">" + e(f.slice(0, h), !!c) + "</" + b + ">\n\n", b = "ul" === b ? "ol" : "ul", d = "ul" === b ? /^ {0,2}\d+\.[ \t]/gm : /^ {0,2}[*+-][ \t]/gm, a(f.slice(h))) : g += "\n\n<" + b + ">" + e(f, !!c) + "</" + b + ">\n\n"
                    }(a);
                    for (var h = 0; h < f.length; ++h);
                } else g = "\n\n<" + b + ">" + e(a, !!c) + "</" + b + ">\n\n";
                return g
            }
            a = c.converter._dispatch("lists.before", a, b, c), a += "~0";
            var g = /^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;
            return c.gListLevel ? a = a.replace(g, function(a, b, c) {
                var d = c.search(/[*+-]/g) > -1 ? "ul" : "ol";
                return f(b, d, !0)
            }) : (g = /(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm, a = a.replace(g, function(a, b, c, d) {
                var e = d.search(/[*+-]/g) > -1 ? "ul" : "ol";
                return f(c, e)
            })), a = a.replace(/~0/, ""), a = c.converter._dispatch("lists.after", a, b, c)
        }), d.subParser("outdent", function(a) {
            "use strict";
            return a = a.replace(/^(\t|[ ]{1,4})/gm, "~0"), a = a.replace(/~0/g, "")
        }), d.subParser("paragraphs", function(a, b, c) {
            "use strict";
            a = c.converter._dispatch("paragraphs.before", a, b, c), a = a.replace(/^\n+/g, ""), a = a.replace(/\n+$/g, "");
            for (var e = a.split(/\n{2,}/g), f = [], g = e.length, h = 0; h < g; h++) {
                var i = e[h];
                i.search(/~(K|G)(\d+)\1/g) >= 0 ? f.push(i) : (i = d.subParser("spanGamut")(i, b, c), i = i.replace(/^([ \t]*)/g, "<p>"), i += "</p>", f.push(i))
            }
            for (g = f.length, h = 0; h < g; h++) {
                for (var j = "", k = f[h], l = !1; k.search(/~(K|G)(\d+)\1/) >= 0;) {
                    var m = RegExp.$1,
                        n = RegExp.$2;
                    j = "K" === m ? c.gHtmlBlocks[n] : l ? d.subParser("encodeCode")(c.ghCodeBlocks[n].text) : c.ghCodeBlocks[n].codeblock, j = j.replace(/\$/g, "$$$$"), k = k.replace(/(\n\n)?~(K|G)\d+\2(\n\n)?/, j), /^<pre\b[^>]*>\s*<code\b[^>]*>/.test(k) && (l = !0)
                }
                f[h] = k
            }
            return a = f.join("\n\n"), a = a.replace(/^\n+/g, ""), a = a.replace(/\n+$/g, ""), c.converter._dispatch("paragraphs.after", a, b, c)
        }), d.subParser("runExtension", function(a, b, c, d) {
            "use strict";
            if (a.filter) b = a.filter(b, d.converter, c);
            else if (a.regex) {
                var e = a.regex;
                !e instanceof RegExp && (e = new RegExp(e, "g")), b = b.replace(e, a.replace)
            }
            return b
        }), d.subParser("spanGamut", function(a, b, c) {
            "use strict";
            return a = c.converter._dispatch("spanGamut.before", a, b, c), a = d.subParser("codeSpans")(a, b, c), a = d.subParser("escapeSpecialCharsWithinTagAttributes")(a, b, c), a = d.subParser("encodeBackslashEscapes")(a, b, c), a = d.subParser("images")(a, b, c), a = d.subParser("anchors")(a, b, c), a = d.subParser("autoLinks")(a, b, c), a = d.subParser("encodeAmpsAndAngles")(a, b, c), a = d.subParser("italicsAndBold")(a, b, c), a = d.subParser("strikethrough")(a, b, c), a = a.replace(/  +\n/g, " <br />\n"), a = c.converter._dispatch("spanGamut.after", a, b, c)
        }), d.subParser("strikethrough", function(a, b, c) {
            "use strict";
            return b.strikethrough && (a = c.converter._dispatch("strikethrough.before", a, b, c), a = a.replace(/(?:~T){2}([\s\S]+?)(?:~T){2}/g, "<del>$1</del>"), a = c.converter._dispatch("strikethrough.after", a, b, c)), a
        }), d.subParser("stripBlankLines", function(a) {
            "use strict";
            return a.replace(/^[ \t]+$/gm, "")
        }), d.subParser("stripLinkDefinitions", function(a, b, c) {
            "use strict";
            var e = /^ {0,3}\[(.+)]:[ \t]*\n?[ \t]*<?(\S+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n+|(?=~0))/gm;
            return a += "~0", a = a.replace(e, function(a, e, f, g, h, i, j) {
                return e = e.toLowerCase(), c.gUrls[e] = d.subParser("encodeAmpsAndAngles")(f), i ? i + j : (j && (c.gTitles[e] = j.replace(/"|'/g, "&quot;")), b.parseImgDimensions && g && h && (c.gDimensions[e] = {
                    width: g,
                    height: h
                }), "")
            }), a = a.replace(/~0/, "")
        }), d.subParser("tables", function(a, b, c) {
            "use strict";

            function e(a) {
                return /^:[ \t]*--*$/.test(a) ? ' style="text-align:left;"' : /^--*[ \t]*:[ \t]*$/.test(a) ? ' style="text-align:right;"' : /^:[ \t]*--*[ \t]*:$/.test(a) ? ' style="text-align:center;"' : ""
            }

            function f(a, e) {
                var f = "";
                return a = a.trim(), b.tableHeaderId && (f = ' id="' + a.replace(/ /g, "_").toLowerCase() + '"'), a = d.subParser("spanGamut")(a, b, c), "<th" + f + e + ">" + a + "</th>\n"
            }

            function g(a, e) {
                var f = d.subParser("spanGamut")(a, b, c);
                return "<td" + e + ">" + f + "</td>\n"
            }

            function h(a, b) {
                for (var c = "<table>\n<thead>\n<tr>\n", d = a.length, e = 0; e < d; ++e) c += a[e];
                for (c += "</tr>\n</thead>\n<tbody>\n", e = 0; e < b.length; ++e) {
                    c += "<tr>\n";
                    for (var f = 0; f < d; ++f) c += b[e][f];
                    c += "</tr>\n"
                }
                return c += "</tbody>\n</table>\n"
            }
            if (!b.tables) return a;
            var i = /^[ \t]{0,3}\|?.+\|.+\n[ \t]{0,3}\|?[ \t]*:?[ \t]*(?:-|=){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:-|=){2,}[^]+?(?:\n\n|~0)/gm;
            return a = c.converter._dispatch("tables.before", a, b, c), a = a.replace(i, function(a) {
                var b, c = a.split("\n");
                for (b = 0; b < c.length; ++b) /^[ \t]{0,3}\|/.test(c[b]) && (c[b] = c[b].replace(/^[ \t]{0,3}\|/, "")), /\|[ \t]*$/.test(c[b]) && (c[b] = c[b].replace(/\|[ \t]*$/, ""));
                var i = c[0].split("|").map(function(a) {
                        return a.trim()
                    }),
                    j = c[1].split("|").map(function(a) {
                        return a.trim()
                    }),
                    k = [],
                    l = [],
                    m = [],
                    n = [];
                for (c.shift(), c.shift(), b = 0; b < c.length; ++b) "" !== c[b].trim() && k.push(c[b].split("|").map(function(a) {
                    return a.trim()
                }));
                if (i.length < j.length) return a;
                for (b = 0; b < j.length; ++b) m.push(e(j[b]));
                for (b = 0; b < i.length; ++b) d.helper.isUndefined(m[b]) && (m[b] = ""), l.push(f(i[b], m[b]));
                for (b = 0; b < k.length; ++b) {
                    for (var o = [], p = 0; p < l.length; ++p) d.helper.isUndefined(k[b][p]), o.push(g(k[b][p], m[p]));
                    n.push(o)
                }
                return h(l, n)
            }), a = c.converter._dispatch("tables.after", a, b, c)
        }), d.subParser("unescapeSpecialChars", function(a) {
            "use strict";
            return a = a.replace(/~E(\d+)E/g, function(a, b) {
                var c = parseInt(b);
                return String.fromCharCode(c)
            })
        });
        var j = this;
        "undefined" != typeof module && module.exports ? module.exports = d : "function" == typeof define && define.amd ? define("showdown", [], function() {
            "use strict";
            return d
        }) : j.showdown = d
    }.call(this), define("models/ContentModel", ["jquery", "underscore", "backbone", "showdown", "leaflet"], function(a, b, c, d, e) {
        var f = c.Model.extend({
            initialize: function(a) {
                this.options = a || {}, this.isContentLoading = !1, this.isContentLoaded = !1
            },
            loadContent: function(b, c) {
                var d = this;
                a.get(this.getUrl(), function(e) {
                    var f = a(e).find(c);
                    f = d.setupContent(f), b(f.children())
                })
            },
            setupContent: function(b) {
                var c = new d.Converter({
                    ghCodeBlocks: !1
                });
                return b.find(".convert-markdown").each(function() {
                    a(this).html(c.makeHtml(a(this).text().trim().split("_ ").join("<br/>")))
                }), b.find('a[href^="http"], .link-download').attr("target", "_blank"), b.find(".link-download").prepend('<span class="icon-wwf_download"></span>'), L.Browser.retina && b.find("img.img-retina, .item-media-type-graphic img").each(function(b, c) {
                    var d = a(c);
                    d.attr("src", d.attr("src").replace(".png", "@2.png")), d.attr("src", d.attr("src").replace(".jpg", "@2.jpg")), d.attr("src", d.attr("src").replace(".gif", "@2.gif"))
                }), b
            },
            isContentReady: function() {
                return !this.isContentLoading && this.isContentLoaded
            },
            getUrl: function() {
                if ("undefined" != typeof this.attributes.url) {
                    var b = a("#application").data("baseurl");
                    return "en" !== lang ? b + "/" + lang + this.attributes.url : b + this.attributes.url
                }
            },
            getContent: function(a, b) {
                if (b = "undefined" != typeof b ? b : ".content", this.isContentLoaded && "undefined" != typeof this.attributes.content && "" !== this.attributes.content[0].innerHTML) a(this.attributes.content);
                else {
                    var c = this;
                    this.isContentLoading ? waitFor(function() {
                        return c.isContentLoaded
                    }, function() {
                        a(c.attributes.content, c)
                    }) : (this.isContentLoading = !0, this.loadContent(function(b) {
                        c.set("content", b), c.isContentLoading = !1, c.isContentLoaded = !0, a(c.attributes.content)
                    }, b))
                }
            }
        });
        return f
    }), define("components/app/layers/LayersView", ["jquery", "underscore", "backbone", "./layerCategory/LayerCategoryView", "./layerCategory/LayerCategoryModel", "./layerCustomCategory/LayerCustomCategoryView", "./layerCustomCategory/LayerCustomCategoryModel", "./layerHome/LayerHomeView", "./layerHome/LayerHomeModel", "./layerItem/LayerItemView", "./layerItem/LayerItemModel", "models/ContentModel"], function(a, b, c, d, e, f, g, h, i, j, k, l) {
        var m = c.View.extend({
            events: {
                "click .cat-link": "handleCategoryLink",
                "click .cat-layers-remove": "handleCategoryRemove"
            },
            initialize: function() {
                this.views = {}, this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:layerId", this.render), this.listenTo(this.model, "change:category", this.render), this.listenTo(this.model, "change:ocean", this.render), this.listenTo(this.model, "change:customLayerEdit", this.handleCustomEditUpdate), this.listenTo(this.model, "change:customLayerData", this.handleCustomDataUpdate), this.listenTo(this.model, "change:customLayerIds", this.handleCustomLayersUpdate), this.listenTo(this.model, "change:activeLayerIds", this.handleActiveLayersUpdate)
            },
            render: function() {
                var a, c;
                c = this.model.getOcean(), b.each(this.views, function(a) {
                    a.model.setActive(!1)
                }), this.$("#layer-item").hide(), this.$("#layers-home").hide(), this.$("#layers-control").hide();
                var m = this.model.getLayerId();
                if ("" !== m)
                    if (b.contains(this.model.getLayers().getIds(), m)) {
                        this.$("#layer-item").show();
                        var n = this.model.getLayers().get(m);
                        "" !== c ? (0 === this.$("#layer-item-" + m).length && this.$("#layer-item").append('<div id="layer-item-' + m + '"></div>'), n.get("contentid") !== m && this.$("#layer-item-" + n.get("contentid")).length > 0 && this.$("#layer-item-" + n.get("contentid")).remove(), this.views["item-" + m] = this.views["item-" + m] || new j({
                            el: this.$("#layer-item-" + m),
                            model: new k({
                                id: m,
                                layer: n,
                                ocean: c,
                                activeLayerIds: this.model.getActiveLayerIds()
                            })
                        }), this.views["item-" + m].model.setActive(!0), a = n.get("category")) : (this.$("#layer-item-" + m).remove(), "undefined" != typeof n && this.$el.trigger("layerInfoSubpage", {
                            id: n.id
                        }))
                    } else {
                        this.$("#layer-item-" + m).remove();
                        var n = this.model.getLayers().findWhere({
                            contentid: m
                        });
                        "undefined" != typeof n && this.$el.trigger("layerInfoSubpage", {
                            id: n.id
                        })
                    }
                else {
                    var o = b.map(categoriesGlobal.layers, function(a) {
                        return a.activeCount = this.model.getLayers().byActive().byOcean(c).byCategory(a.value).length, a
                    }, this);
                    if (a = this.model.getCategory(), "custom" === a || "" !== a && b.contains(this.model.getLayers().getCategories(), a)) {
                        var p = c + "-" + a;
                        this.$("#layers-control").show(), 0 === this.$("#layers-control-" + p).length && this.$("#layers-control").prepend('<div id="layers-control-' + p + '" class="layers-control-category"></div>'), "custom" === a ? (this.views[p] = this.views[p] || new f({
                            el: this.$("#layers-control-" + p),
                            model: new g({
                                id: p,
                                category: a,
                                categories: o
                            })
                        }), this.views[p].model.set({
                            ocean: c,
                            layers: this.model.getLayers().byOcean(c).byCategory(a),
                            activeLayerIds: this.model.getActiveLayerIds(),
                            customData: this.model.get("customLayerData"),
                            edit: this.model.get("customLayerEdit")
                        })) : (this.views[p] = this.views[p] || new d({
                            el: this.$("#layers-control-" + p),
                            model: new e({
                                id: p,
                                category: a,
                                categories: o
                            })
                        }), this.views[p].model.set({
                            ocean: c,
                            layers: this.model.getLayers().byOptional(!0).byOcean(c).byCategory(a),
                            activeLayerIds: this.model.getActiveLayerIds()
                        })), this.views[p].model.setActive(!0)
                    } else {
                        this.$("#layers-home").show();
                        var q = "/layers/home/";
                        this.views.home = this.views.home || new h({
                            el: this.$("#layers-home"),
                            model: new i({
                                content: new l({
                                    url: q
                                })
                            })
                        }), this.views.home.model.setOcean(c), this.views.home.model.setCategories(o), this.views.home.model.setActive(!0), a = !1
                    }
                }
                return this.checkActiveCategory(a), this
            },
            checkActiveCategory: function(a) {
                this.$(".layer-links-bar .cat-link-layers").removeClass("active"), a && this.$(".layer-links-bar .cat-link-layers-" + a).addClass("active")
            },
            handleActive: function() {
                this.model.isActive() ? this.$el.show() : this.$el.hide()
            },
            handleCustomDataUpdate: function(a) {
                var b = this.model.getOcean(),
                    c = this.model.getCategory(),
                    d = b + "-" + c;
                this.model.isActive() && "custom" === c && "undefined" != typeof this.views[d] && this.views[d].model.setCustomData(this.model.get("customLayerData"))
            },
            handleCustomEditUpdate: function(a) {
                var b = this.model.getOcean(),
                    c = this.model.getCategory(),
                    d = b + "-" + c;
                this.model.isActive() && "custom" === c && "undefined" != typeof this.views[d] && this.views[d].model.setEdit(this.model.get("customLayerEdit"))
            },
            handleCustomLayersUpdate: function(a) {
                var b = this.model.getOcean(),
                    c = this.model.getCategory(),
                    d = b + "-" + c;
                this.model.isActive() && "custom" === c && "undefined" != typeof this.views[d] && this.views[d].model.setLayers(this.model.getLayers().byOcean(b).byCategory(c))
            },
            handleActiveLayersUpdate: function(a) {
                var c = this.model.getOcean(),
                    d = this.model.getCategory(),
                    e = this.model.getOcean() + "-" + d,
                    f = b.map(categoriesGlobal.layers, function(a) {
                        return a.activeCount = this.model.getLayers().byActive().byOcean(c).byCategory(a.value).length, a
                    }, this);
                this.model.isActive() && ("custom" === d || "" !== d) && "undefined" != typeof this.views[e] && this.views[e].model.set({
                    activeLayerIds: this.model.getActiveLayerIds(),
                    categories: f
                }), this.model.isActive() && "undefined" != typeof this.views["item-" + this.model.getLayerId()] && this.views["item-" + this.model.getLayerId()].model.setActiveLayerIds(this.model.getActiveLayerIds())
            },
            handleCategoryLink: function(b) {
                b.preventDefault(), this.$el.trigger("layerCategoryLinkClick", {
                    target: b.target,
                    id: a(b.target).closest("a").data("catid")
                })
            },
            handleCategoryRemove: function(b) {
                b.preventDefault(), b.stopPropagation(), this.$el.trigger("layerCategoryRemove", {
                    target: b.target,
                    id: a(b.target).closest("a").data("catid")
                })
            }
        });
        return m
    }), define("components/app/layers/LayersModel", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.Model.extend({
            initialize: function(a) {
                this.options = a || {}
            },
            getCategory: function() {
                return this.attributes.category
            },
            getOcean: function() {
                return this.attributes.ocean
            },
            getLayerId: function() {
                return this.attributes.layerId
            },
            getLayers: function() {
                return this.attributes.layers
            },
            setActiveLayerIds: function(a) {
                return this.set("activeLayerIds", a)
            },
            getActiveLayerIds: function() {
                return this.attributes.activeLayerIds
            },
            setActive: function(a) {
                a = "undefined" == typeof a || a, this.set("active", a)
            },
            isActive: function() {
                return this.get("active")
            }
        });
        return d
    }), define("text!templates/labelTemplate.html", [], function() {
        return "<div class=\"label\">\r\n<% if (typeof supTitle !== 'undefined' && supTitle !== '') { %>\r\n<div class=\"label-sup-title\"><small><%= supTitle %></small></div>  \r\n<% } %>\r\n<% if (typeof title !== 'undefined' && title !== '') { %>\r\n<div class=\"label-title\"><strong><%= title %></strong></div>  \r\n<% } %>\r\n<% if (typeof description !== 'undefined' && description !== '') { %>\r\n  <div class=\"label-description\"><%= description %></div>  \r\n<% } %>\r\n\r\n</div>\r\n"
    }), define("text!templates/textIconTemplate.html", [], function() {
        return '<% var sizeInner = (size - (paddingOuter*2)) %>\r\n<div class="text-icon-outer" \r\n     style="background-color:<%= fillColorOuter %>;width:<%= size %>px;height:<%= size %>px;padding:<%= paddingOuter %>px">\r\n  <div class="text-icon-inner" \r\n       style="background-color:<%= fillColor %>;color:<%= color %>;width:<%= sizeInner %>px;height:<%= sizeInner %>px;"\r\n  >\r\n    <%= title %>\r\n    <div class="<%= iconClass %>"></div>\r\n  </div>\r\n</div>'
    }), define("text!templates/divIconTemplate.html", [], function() {
        return '<div style="<%= cssStyle %>"></div>'
    }), define("text!templates/divSvgIconTemplate.html", [], function() {
        return "<% pin = typeof pin !== \"undefined\" \r\n    ? pin \r\n    : \"M7.56,24.23c0-.05-2.82-5.31-5.07-10.13a18.28,18.28,0,0,1-2-6.29C0.5,2,5.21.5,8,.5S15.5,2,15.5,7.81a18.3,18.3,0,0,1-2,6.29c-2.26,4.83-5,10.08-5.07,10.13L8,25.07Z\" \r\n%>\r\n<svg xmlns='http://www.w3.org/2000/svg' \r\n     version='1.1' \r\n     width='62%' \r\n     height='100%' \r\n     viewBox='0 0 16 26'\r\n     preserveAspectRatio=\"xMaxYMax\">\r\n  <path stroke='<%= color %>' stroke-width='<%= weight %>' fill='<%= fillColor %>' d='<%= pin %>'/>\r\n</svg>"
    }), define("models/LocationModel", ["jquery", "underscore", "backbone", "leaflet", "./ContentModel", "text!templates/labelTemplate.html", "text!templates/textIconTemplate.html", "text!templates/divIconTemplate.html", "text!templates/divSvgIconTemplate.html"], function(a, b, c, d, e, f, g, h, i) {
        var j = e.extend({
            initialize: function(a) {
                this.options = a || {}, this.isContentLoading = !1, this.isContentLoaded = !1, this.set("active", !1), this.attributes.markerLayer.options.parent = this, "undefined" != typeof this.attributes.featureAttributeMap && b.each(this.attributes.featureAttributeMap, function(a, c) {
                    if ("object" == typeof a) {
                        var d = {};
                        b.each(a, function(a, c) {
                            b.contains(a, "[") ? d[c] = this.getAttributeValue(a) : d[c] = this.attributes[a]
                        }, this), this.set(c, d)
                    } else b.contains(a, "[") ? this.set(c, this.getAttributeValue(a)) : this.set(c, this.attributes[a])
                }, this), this.makeIcon(), ("undefined" == typeof this.attributes.parentLayer.get("tooltip") || this.attributes.parentLayer.get("tooltip")) && this.makeLocationLabel(), this.initInteractions()
            },
            getAttributeValue: function(a) {
                var b = a.split("["),
                    c = b[0],
                    d = b[1].split("]"),
                    e = d.length > 1 ? d[1] : "",
                    a = d[0];
                return c + this.attributes[a] + e
            },
            initInteractions: function() {
                var a = this.attributes.parentLayer,
                    b = this;
                this.attributes.markerLayer.off("click").on("click", function(c) {
                    "undefined" != typeof b.collection.options.eventContext && b.collection.options.eventContext.trigger("mapMarkerClick", {
                        target: c.target,
                        layerId: a.get("id"),
                        locationId: b.get("id")
                    })
                })
            },
            makeIcon: function() {
                var d, c = this.attributes.parentLayer;
                switch (c.get("icon").type) {
                    case "image":
                        var e = b.clone(c.get("icon").style);
                        e.className = "image-icon " + this.attributes.className, "object" == typeof e.iconUrl && (e.iconUrl = e.iconUrl[this.attributes[e.iconUrl.attribute]], "object" == typeof e.iconUrl && (e.iconUrl = e.iconUrl[this.attributes[e.iconUrl.attribute]])), this.get("active") && (e.iconUrl = e.iconUrl.replace(".png", "-active.png")), e.iconUrl = a("#application").data("baseurl") + "/" + e.iconUrl, this.collection.options.print ? (e.iconSize = [e.iconSize[0] * this.collection.options.printScale, e.iconSize[1] * this.collection.options.printScale], e.iconAnchor = [e.iconAnchor[0] * this.collection.options.printScale, e.iconAnchor[1] * this.collection.options.printScale], e.iconUrl = e.iconUrl.replace(".png", "@2.png")) : e.iconRetinaUrl = e.iconUrl.replace(".png", "@2.png"), d = L.icon(e);
                        break;
                    case "circle":
                        d = L.divIcon({
                            html: b.template(h)({
                                cssStyle: c.getCssStyle("circle")
                            }),
                            className: "circle-icon " + this.attributes.className,
                            iconSize: new L.Point(c.get("icon").size, c.get("icon").size)
                        });
                        break;
                    case "text-icon-circle":
                        var f = this.attributes[c.get("icon").title.attribute],
                            j = this.attributes[c.get("icon").style.attribute],
                            k = c.get("icon").style[j],
                            l = k.icon,
                            m = k.color,
                            n = k.fillColor.colorToRgb(),
                            o = "rgba(" + n[0] + "," + n[1] + "," + n[2] + ",0.5)",
                            n = "rgb(" + n[0] + "," + n[1] + "," + n[2] + ")",
                            p = k.size,
                            q = k.paddingOuter;
                        d = L.divIcon({
                            html: b.template(g)({
                                title: f,
                                iconClass: l,
                                size: p,
                                paddingOuter: q,
                                color: m,
                                fillColor: n,
                                fillColorOuter: o
                            }),
                            className: "text-icon",
                            iconSize: new L.Point(p, p)
                        });
                        break;
                    case "marker":
                    default:
                        var m, r = c.get("icon").width,
                            s = c.get("icon").height,
                            t = c.attributes.style.fillColor.colorToRgb(),
                            u = "rgba(" + t[0] + "," + t[1] + "," + t[2] + "," + c.attributes.style.fillOpacity + ")";
                        t = c.attributes.style.color.colorToRgb();
                        var m = "rgba(" + t[0] + "," + t[1] + "," + t[2] + "," + c.attributes.style.opacity + ")",
                            v = b.template(i)({
                                color: m,
                                weight: c.attributes.style.weight,
                                fillColor: u
                            });
                        d = L.icon({
                            iconUrl: "data:image/svg+xml;base64," + btoa(v),
                            iconSize: [r, s],
                            iconAnchor: [r / 2, s]
                        })
                }
                this.attributes.markerLayer.setIcon(d)
            },
            makeLocationLabel: function() {
                var a = this.getFeatureTitle();
                a = "undefined" != typeof a && "<Null>" !== a ? a : "";
                var c = this.getCategoryText();
                c = "undefined" != typeof c && "<Null>" !== c ? c : "";
                var d = this.attributes.parentLayer.getTitle(),
                    e = ("" !== c ? c : "") + ("" !== a && "" !== c ? ": " : "") + ("" !== a ? a : "");
                "undefined" != typeof e && "" !== e || (e = d, d = "");
                var g = {
                    supTitle: d,
                    title: e,
                    description: this.getDescription(lang)
                };
                this.attributes.markerLayer.bindLabel(b.template(f)(g), this.attributes.labelOptions.options)
            },
            getCategoryText: function() {
                var a = this.get("category");
                return a && "object" == typeof a ? a[lang] : "undefined" != typeof tlang.categories[a] ? tlang.categories[a] : a
            },
            getCategory: function() {
                return this.get("category")
            },
            getFeatureTitle: function() {
                return "undefined" !== this.getAttribute("title", lang) ? this.getAttribute("title", lang) : this.getAttribute("featureTitle", lang)
            },
            getDescription: function() {
                return this.getAttribute("description", lang)
            },
            getAttribute: function(a, b) {
                var c = this.get(a);
                return "undefined" != typeof b && "object" == typeof c ? c[b] : "undefined" != typeof c ? c : ""
            }
        });
        return j
    }), define("models/LocationCollection", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.Collection.extend({
            initialize: function(a, b) {
                this.options = b || {}
            },
            getIds: function() {
                return b.map(this.models, function(a) {
                    return a.id
                })
            }
        });
        return d
    }), define("models/FeatureModel", ["jquery", "underscore", "backbone", "leaflet", "leaflet.label", "text!templates/labelTemplate.html", "text!templates/divIconTemplate.html"], function(a, b, c, d, e, f) {
        var g = c.Model.extend({
            initialize: function(a) {
                this.options = a || {}, "undefined" != typeof this.attributes.featureAttributeMap && b.each(this.attributes.featureAttributeMap, function(a, c) {
                    if ("object" == typeof a) {
                        var d = {};
                        b.each(a, function(a, c) {
                            b.contains(a, "[") ? d[c] = this.getAttributeValue(a) : d[c] = this.attributes[a]
                        }, this), this.set(c, d)
                    } else b.contains(a, "[") ? this.set(c, this.getAttributeValue(a)) : this.set(c, this.attributes[a])
                }, this), this.makeFeatureLabel(), this.initStyles()
            },
            initStyles: function() {
                var a = this.attributes.parentLayer.attributes.featureStyle;
                if ("undefined" != typeof a) {
                    var b = this.attributes[a.attribute].split(" ").join("-");
                    "undefined" != typeof a[b] && this.attributes.featureLayer.setStyle(a[b].style)
                }
            },
            getAttributeValue: function(a) {
                var b = a.split("["),
                    c = b[0],
                    d = b[1].split("]"),
                    e = d.length > 1 ? d[1] : "",
                    a = d[0];
                return c + this.attributes[a] + e
            },
            makeFeatureLabel: function() {
                var a = this.getTitle();
                a = "undefined" != typeof a && "<Null>" !== a ? a : "";
                var c = this.getCategoryText();
                c = "undefined" != typeof c && "<Null>" !== c ? c : "";
                var d = this.attributes.parentLayer.getTitle(),
                    e = ("" !== c ? c : "") + ("" !== a && "" !== c ? ": " : "") + ("" !== a ? a : "");
                "undefined" != typeof e && "" !== e || (e = d, d = "");
                var g = {
                    supTitle: d,
                    title: e,
                    description: this.getDescription(lang)
                };
                this.attributes.featureLayer.bindLabel(b.template(f)(g), this.attributes.labelOptions.options)
            },
            getCategoryText: function() {
                var a = this.getCategory();
                return a && "object" == typeof a ? a[lang] : "undefined" != typeof tlang.categories[a] ? tlang.categories[a] : a
            },
            getCategory: function() {
                return this.get("featureCategory")
            },
            getTitle: function() {
                return this.getAttribute("featureTitle", lang)
            },
            getDescription: function() {
                return this.getAttribute("featureDescription", lang)
            },
            getAttribute: function(a, b) {
                var c = this.get(a);
                return "undefined" != typeof b && "object" == typeof c ? c[b] : "undefined" != typeof c ? c : ""
            }
        });
        return g
    }), define("models/FeatureCollection", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.Collection.extend({
            initialize: function(a, b) {
                this.options = b || {}
            },
            getIds: function() {
                return b.map(this.models, function(a) {
                    return a.id
                })
            }
        });
        return d
    }), define("text!templates/clusterIconTemplate.html", [], function() {
        return '<div class="cluster-icon-outer" style="<%= css_outer %>">\r\n  <div class="cluster-icon-inner" style="<%= css_inner %>">\r\n    <span><%= childCount %></span>\r\n  </div>\r\n</div>'
    }), define("text!templates/layerKeyGradientTemplate.html", [], function() {
        return '<div class="<%= classes %>">\r\n  <svg viewBox="0 0 100 100">\r\n    <defs>\r\n      <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%">\r\n        <stop offset="0%" style="stop-color:<%= min %>;stop-opacity:1" />\r\n        <stop offset="100%" style="stop-color:<%= max %>;stop-opacity:1" />\r\n      </linearGradient>\r\n    </defs>\r\n    <rect width="100" height="100" fill="url(#grad1)" />\r\n  </svg>\r\n</div>'
    }), define("text!templates/layerKeyFullGradientTemplate.html", [], function() {
        return '<div class="color-gradient-key">\r\n  <div class="color-gradient-key-svg-wrap">\r\n    <svg viewBox="0 0 100 100">\r\n      <defs>\r\n        <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%">\r\n          <stop offset="0%" style="stop-color:<%= min %>;stop-opacity:1" />\r\n          <stop offset="100%" style="stop-color:<%= max %>;stop-opacity:1" />\r\n        </linearGradient>\r\n      </defs>\r\n      <rect width="100" height="100" fill="url(#grad1)" />\r\n    </svg>\r\n  </div>\r\n  <div class="hint color-gradient-key-min"><%= minLabel %></div>\r\n  <div class="hint color-gradient-key-max"><%= maxLabel %></div>\r\n</div>'
    }), define("text!templates/layerKeyCategoricalTemplate.html", [], function() {
        return '<div class="<%= classes %>">\r\n  <ul class="list-inline">\r\n    <% _.each(colors,function(color,i,list){ %>  \r\n      <li style="background-color:<%= color %>;width:<%= 100/list.length %>%"></li>\r\n    <% }) %>  \r\n  </ul>\r\n</div>'
    }), define("text!templates/layerKeyIconTemplate.html", [], function() {
        return '<div class="key-wrap key-<%= size %>-wrap key-type-<%= styleType %> ">   \r\n  <%= keySquare %>  \r\n</div>'
    }), define("models/LayerModel", ["jquery", "underscore", "backbone", "./ContentModel", "./LocationModel", "./LocationCollection", "./FeatureModel", "./FeatureCollection", "leaflet", "leaflet.markercluster", "esri.leaflet", "text!templates/labelTemplate.html", "text!templates/clusterIconTemplate.html", "text!templates/layerKeyGradientTemplate.html", "text!templates/layerKeyFullGradientTemplate.html", "text!templates/layerKeyCategoricalTemplate.html", "text!templates/layerKeyIconTemplate.html", "text!templates/divSvgIconTemplate.html"], function(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r) {
        var s = d.extend({
            initialize: function(a) {
                this.options = a || {}, this.isContentLoading = !1, this.isContentLoaded = !1, this.id = this.attributes.id, this.setBasemap("undefined" != typeof this.attributes.basemap && this.attributes.basemap), this.setShowInKey("undefined" == typeof this.attributes.key || this.attributes.key !== !1), this.set("print", this.collection.options.print), this.set("mapConfig", this.collection.options.mapConfig), this.set("crs", "undefined" != typeof this.attributes.crs ? this.attributes.crs : this.attributes.mapConfig.crsDefault), "undefined" == typeof this.attributes.category && this.setCategory("undefined"), "undefined" == typeof this.attributes.subcategory && this.setSubcategory("undefined"), "undefined" == typeof this.attributes.group && this.setGroup("undefined"), "undefined" == typeof this.attributes.optional && this.setOptional(!0), "undefined" == typeof this.attributes.attribution && this.set("attribution", ""), "point" === this.attributes.type && this.set("featureAttributeMap", "undefined" != typeof this.attributes.featureAttributeMap ? this.attributes.featureAttributeMap : {}), this.initializeSource(), this.initContentURL(), this.initStyles(), this.initPrintScale(), this.initCssStyles(), this.setModuleDefault(!1), this.setActive(!1)
            },
            initializeSource: function() {},
            loadData: function() {},
            fadeEnabled: function() {
                return "point" !== this.get("type") && "raster" !== this.get("type")
            },
            setModuleDefault: function(a) {
                this.set("isModuleDefault", a)
            },
            isModuleDefault: function() {
                return this.attributes.isModuleDefault
            },
            setActive: function(a) {
                a = "undefined" == typeof a || a, this.isActive() || this.set("activeTime", !!a && Date.now() + this.attributes.order), this.set("active", a)
            },
            isActive: function() {
                return this.attributes.active
            },
            setOptional: function(a) {
                a = "undefined" == typeof a || a, this.set("optional", a)
            },
            isOptional: function() {
                return this.attributes.optional
            },
            setBasemap: function(a) {
                a = "undefined" == typeof a || a, this.set("basemap", a)
            },
            isBasemap: function() {
                return this.attributes.basemap
            },
            setLoading: function(a) {
                a = "undefined" == typeof a || a, this.set("loading", a)
            },
            isLoading: function() {
                return this.attributes.loading
            },
            isLoaded: function() {
                return "undefined" != typeof this.attributes.mapLayer && !this.isLoading()
            },
            isCustom: function() {
                return "custom" === this.attributes.source
            },
            setShowInKey: function(a) {
                this.set("showInKey", a)
            },
            showInKey: function() {
                return this.attributes.showInKey
            },
            getHint: function() {
                return this.getAttribute("hint", lang)
            },
            getTitle: function() {
                return this.getAttribute("title", lang)
            },
            getDescription: function() {
                return this.getAttribute("description", lang)
            },
            getAttribute: function(a, b) {
                var c = this.get(a);
                return "undefined" != typeof b && "object" == typeof c ? c[b] : "undefined" != typeof c ? c : ""
            },
            getType: function() {
                return this.attributes.type
            },
            setCategory: function(a) {
                this.set("category", a)
            },
            getCategory: function() {
                return this.attributes.category
            },
            setSubcategory: function(a) {
                this.set("subcategory", a)
            },
            getSubcategory: function() {
                return this.attributes.subcategory
            },
            setGroup: function(a) {
                this.set("group", a)
            },
            getGroup: function() {
                return this.attributes.group
            },
            getOcean: function() {
                return this.attributes.ocean
            },
            getReference: function() {
                return this.attributes.attribution
            },
            getCrs: function() {
                return this.attributes.crs
            },
            initStyles: function() {
                "point" === this.attributes.type && ("undefined" == typeof this.attributes.icon ? this.attributes.icon = {
                    type: "marker"
                } : "undefined" == typeof this.attributes.icon.type && (this.attributes.icon.type = "marker"));
                var a = b.clone(this.collection.options.mapConfig.layerStyles);
                "undefined" != typeof a[this.getStyleType()] && ("undefined" != typeof this.attributes.style ? ("undefined" != typeof this.attributes.style.color && (this.attributes.style.fillColor = "undefined" != typeof this.attributes.style.fillColor ? this.attributes.style.fillColor : this.attributes.style.color), "undefined" != typeof this.attributes.style.opacity && (this.attributes.style.fillOpacity = "undefined" != typeof this.attributes.style.fillOpacity ? this.attributes.style.fillOpacity : this.attributes.style.opacity), this.attributes.style = b.extend({}, a[this.getStyleType()], b.clone(this.attributes.style))) : this.attributes.style = a[this.getStyleType()], this.attributes.style.weight = parseFloat(this.attributes.style.weight)), "raster" === this.attributes.type && (this.attributes.style = b.extend({}, a.raster, b.clone(this.attributes.style))), "point" === this.attributes.type && ("undefined" == typeof this.attributes.icon ? this.attributes.icon = {
                    type: "marker"
                } : "undefined" == typeof this.attributes.icon.type && (this.attributes.icon.type = "marker"), "marker" === this.attributes.icon.type && (this.attributes.icon.width = 15, this.attributes.icon.height = 25), "undefined" == typeof this.attributes.clusterOptions ? this.attributes.clusterOptions = {
                    cluster: !1
                } : "undefined" == typeof this.attributes.clusterOptions.cluster && (this.attributes.clusterOptions.cluster = !0), this.attributes.clusterOptions.cluster && (this.attributes.clusterOptions.options = b.extend({}, "undefined" != typeof this.collection.options.mapConfig.clusterOptions ? this.collection.options.mapConfig.clusterOptions : {}, this.attributes.clusterOptions.options), "undefined" == typeof this.attributes.clusterOptions.iconStyle && (this.attributes.clusterOptions.iconStyle = {
                    size: 30,
                    default: {
                        backgroundColor: this.attributes.style.fillColor,
                        color: this.attributes.style.color
                    }
                }), b.extend(this.attributes.clusterOptions.options, {
                    iconCreateFunction: b.bind(this.clusterIconCreateFunction, this)
                })))
            },
            initPrintScale: function() {
                this.scaleFactor = 1, this.scaleFactorCircle = 1, this.scaleFactorMarker = 1, this.collection.options.print && 1 === this.scaleFactorCircle && (this.scaleFactor = this.collection.options.mapConfig.printScales.default, this.scaleFactorCircle = this.collection.options.mapConfig.printScales.circle, this.scaleFactorMarker = this.collection.options.mapConfig.printScales.marker, "undefined" != typeof this.attributes.style.weight && ("point" !== this.attributes.type || "marker" !== this.attributes.icon.type) && (this.attributes.style.weight = Math.min(this.attributes.style.weight * this.scaleFactor, 5)), "undefined" != typeof this.attributes.icon && "circle" === this.attributes.icon.type && (this.attributes.icon.size = this.attributes.icon.size * this.scaleFactorCircle), "point" === this.attributes.type && (this.attributes.clusterOptions.cluster && (this.attributes.clusterOptions.options.maxClusterRadius = this.attributes.clusterOptions.options.maxClusterRadius * this.scaleFactor), "marker" === this.attributes.icon.type && (this.attributes.icon.width = this.attributes.icon.width * this.scaleFactorMarker, this.attributes.icon.height = this.attributes.icon.height * this.scaleFactorMarker)))
            },
            initCssStyles: function() {
                if (this.attributes.cssStyle = b.clone(this.collection.options.mapConfig.cssStyle), "undefined" != typeof this.attributes.style) {
                    if ((this.attributes.style.weight > 0 || "line" === this.getStyleType()) && (this.attributes.cssStyle.borderColor = this.attributes.style.color,
                            this.attributes.cssStyle.borderWidth = Math.max(this.attributes.style.weight, "circle" === this.getStyleType() ? 1 : 2), this.attributes.cssStyle.borderRadius = "undefined" != typeof this.attributes.icon && "circle" === this.attributes.icon.type ? this.attributes.icon.size / 2 : 0), "categorical" !== this.getKeyType() && "gradient" !== this.getKeyType() || (this.attributes.layerCategories = [], b.each(this.attributes.key.categories, function(a) {
                            var b = a.fillColor.colorToRgb(),
                                c = "rgba(" + b[0] + "," + b[1] + "," + b[2] + "," + Math.min(1, Math.max(.5, 1.5 * this.attributes.style.opacity)) + ")",
                                d = "undefined" != typeof a.title ? "object" == typeof a.title ? a.title[lang] : a.title : this.getTitle();
                            this.attributes.layerCategories.push({
                                color: c,
                                label: d
                            })
                        }, this)), "multiPolygon" === this.getKeyType()) {
                        this.attributes.cssStyle.borderColor = "", this.attributes.layerCategories = [];
                        var c = [];
                        switch (b.each(this.attributes.featureStyle, function(a, d) {
                            "attribute" !== d && (a.style.fillColor = "undefined" != typeof a.style.fillColor ? a.style.fillColor : "undefined" != typeof a.style.color ? a.style.color : this.attributes.style.fillColor, a.style.fillOpacity = "undefined" != typeof a.style.fillOpacity ? a.style.fillOpacity : "undefined" != typeof a.style.opacity ? a.style.opacity : this.attributes.style.fillOpacity);
                            var e = b.extend({}, this.attributes.style, a.style);
                            if ("attribute" !== d && "undefined" != typeof e.fillColor) {
                                var f = e.fillColor.colorToRgb(),
                                    g = "rgba(" + f[0] + "," + f[1] + "," + f[2] + "," + Math.min(1, Math.max(.5, 1.5 * e.fillOpacity)) + ")";
                                c.push(g);
                                var h = "undefined" != typeof a.title ? "object" == typeof a.title ? a.title[lang] : a.title : this.getTitle();
                                this.attributes.layerCategories.push({
                                    color: g,
                                    label: h
                                })
                            }
                        }, this), c.length) {
                            case 0:
                                var d = this.attributes.style.fillColor.colorToRgb(),
                                    e = "rgba(" + d[0] + "," + d[1] + "," + d[2] + "," + Math.min(1, Math.max(.5, 1.5 * this.attributes.style.fillOpacity)) + ")";
                                c.push(e), c.push(e), c.push(e), c.push(e);
                                break;
                            case 1:
                                c.push(c[0]), c.push(c[0]), c.push(c[0]);
                                break;
                            case 2:
                                c.push(c[1]), c.push(c[0]);
                                break;
                            case 3:
                                c.push(c[0])
                        }
                        b.each(c, function(a, b) {
                            b < 4 && (this.attributes.cssStyle.borderColor += a + " ")
                        }, this)
                    }
                    if ("undefined" != typeof this.attributes.style.fillColor) {
                        var f = this.attributes.style.fillColor.colorToRgb();
                        this.attributes.cssStyle.backgroundColor = "rgba(" + f[0] + "," + f[1] + "," + f[2] + "," + Math.min(1, Math.max(.4, 1.85 * this.attributes.style.fillOpacity)) + ")"
                    }
                    if ("image" === this.getStyleType()) {
                        var g;
                        "undefined" != typeof this.attributes.key ? "undefined" != typeof this.attributes.key.iconRetinaUrl && L.Browser.retina ? g = this.attributes.key.iconRetinaUrl : "undefined" != typeof this.attributes.key.iconUrl && (g = this.attributes.key.iconUrl) : g = "object" == typeof this.attributes.icon.style.iconUrl ? this.attributes.icon.style.iconUrl.key : this.attributes.icon.style.iconUrl, this.attributes.cssStyle.backgroundImage = "url('" + a("#application").data("baseurl") + "/" + g + "')"
                    }
                }
            },
            initContentURL: function() {
                var a = "/";
                "undefined" != typeof this.attributes.pageid ? (a += "page/", a += "undefined" != typeof this.attributes.pageid ? this.attributes.pageid : this.id) : (a += "layers/", a += "undefined" != typeof this.attributes.contentid ? this.attributes.contentid : this.id), a += "/", this.set("url", a)
            },
            getKeyType: function() {
                var a;
                return a = "undefined" != typeof this.attributes.key && "undefined" != typeof this.attributes.key.type ? this.attributes.key.type : "polygon" === this.attributes.type && "undefined" != typeof this.attributes.featureStyle ? "multiPolygon" : this.getStyleType()
            },
            getStyleType: function() {
                var a = "default";
                return a = "undefined" != typeof this.attributes.key && "undefined" != typeof this.attributes.key.type ? this.attributes.key.type : "point" === this.attributes.type ? this.attributes.icon.type : "mixed" === this.attributes.type ? "polygon" : this.attributes.type
            },
            getKeySquareIcon: function(a) {
                return b.template(q)({
                    keySquare: this.getKeySquare("key-" + a + " key-inner"),
                    styleType: this.getStyleType(),
                    size: a
                })
            },
            getKeySquare: function(a) {
                switch (this.getKeyType()) {
                    case "multiPolygon":
                        return a += " multiple-areas", '<span class="' + a + '" style="' + this.getCssStyle() + '"></span>';
                    case "marker":
                        var c, d = this.attributes.style.fillColor.colorToRgb(),
                            e = "rgba(" + d[0] + "," + d[1] + "," + d[2] + "," + this.attributes.style.fillOpacity + ")";
                        d = this.attributes.style.color.colorToRgb();
                        var c = "rgba(" + d[0] + "," + d[1] + "," + d[2] + "," + this.attributes.style.opacity + ")",
                            f = b.template(r)({
                                color: c,
                                weight: this.attributes.style.weight,
                                fillColor: e
                            });
                        return f;
                    case "categorical":
                        return a += " categorical", b.template(p)({
                            colors: b.pluck(this.attributes.layerCategories, "color"),
                            classes: a
                        });
                    case "gradient":
                        a += " key-gradient";
                        var g = this.attributes.key.minmax.min.fillColor.colorToRgb();
                        g = "rgb(" + g[0] + "," + g[1] + "," + g[2] + ")";
                        var h = this.attributes.key.minmax.max.fillColor.colorToRgb();
                        return h = "rgb(" + h[0] + "," + h[1] + "," + h[2] + ")", b.template(n)({
                            min: g,
                            max: h,
                            classes: a
                        });
                    default:
                        return '<span class="' + a + '" style="' + this.getCssStyle() + '"></span>'
                }
            },
            makeLayerGradientKey: function() {
                if ("gradient" === this.getKeyType()) {
                    var a = this.attributes.key.minmax.min.fillColor.colorToRgb();
                    a = "rgb(" + a[0] + "," + a[1] + "," + a[2] + ")";
                    var c = this.attributes.key.minmax.max.fillColor.colorToRgb();
                    return c = "rgb(" + c[0] + "," + c[1] + "," + c[2] + ")", b.template(o)({
                        minLabel: "object" == typeof this.attributes.key.minmax.min.title ? this.attributes.key.minmax.min.title[lang] : this.attributes.key.minmax.min.title,
                        maxLabel: "object" == typeof this.attributes.key.minmax.max.title ? this.attributes.key.minmax.max.title[lang] : this.attributes.key.minmax.max.title,
                        min: a,
                        max: c
                    })
                }
                return !1
            },
            makeLayerCategoriesKey: function() {
                if ("multiPolygon" === this.getKeyType() || "categorical" === this.getKeyType() || "gradient" === this.getKeyType()) {
                    var a = [];
                    return b.each(this.attributes.layerCategories, function(b) {
                        a.push({
                            color: '<span class="feature-group-color" style="background-color:' + b.color + ';"></span>',
                            label: '<span class="feature-group-label hint">' + b.label + "</span>"
                        })
                    }, this), a
                }
                return !1
            },
            getCssStyle: function(a) {
                a = "undefined" != typeof a ? a : this.getKeyType();
                var b = "";
                switch (a) {
                    case "line":
                        b = "border-color:" + this.attributes.cssStyle.borderColor + ";";
                        break;
                    case "marker":
                    case "polygon":
                        b = "background-color:" + this.attributes.cssStyle.backgroundColor + ";", this.attributes.style.weight > 0 && (b += "border-color:" + this.attributes.cssStyle.borderColor + ";", b += "border-width:" + this.attributes.cssStyle.borderWidth + "px;");
                        break;
                    case "multiPolygon":
                        b = "border-color:" + this.attributes.cssStyle.borderColor + ";";
                        break;
                    case "circle":
                        b = "background-color:" + this.attributes.cssStyle.backgroundColor + ";", this.attributes.style.weight > 0 && (b += "border-color:" + this.attributes.cssStyle.borderColor + ";", b += "border-width:" + this.attributes.cssStyle.borderWidth + "px;");
                        break;
                    case "image":
                        b = "background-image:" + this.attributes.cssStyle.backgroundImage + ";"
                }
                return b
            },
            getMapLayer: function(a, b, c) {
                if (c = "undefined" != typeof c && c, this.isLoaded() && !c) "undefined" != typeof a && a(this.attributes.mapLayer, this);
                else {
                    var d = this;
                    this.attributes.loading && !c ? waitFor(function() {
                        return d.isLoaded()
                    }, function() {
                        "undefined" != typeof a && a(d.attributes.mapLayer, d)
                    }) : this.loadData(function(b) {
                        switch (d.attributes.type) {
                            case "point":
                                d.set("mapLayer", d.handleResultForPointLayer(b));
                                break;
                            case "polygon":
                                d.set("mapLayer", d.handleResultForPolygonLayer(b));
                            default:
                                d.set("mapLayer", b)
                        }
                        "undefined" != typeof a && a(d.attributes.mapLayer, d)
                    }, b)
                }
            },
            handleResultForPolygonLayer: function(a) {
                var c = this.collection.options.mapConfig,
                    d = "undefined" != typeof c.labelOptions ? c.labelOptions : {};
                this.set("features", new h(b.map(a.getLayers(), function(c) {
                    return b.extend({}, c.feature.properties, {
                        featureAttributeMap: this.attributes.featureAttributeMap,
                        featureLayer: c,
                        parentLayer: this,
                        labelOptions: d,
                        className: a.options.className
                    })
                }, this), {
                    model: g,
                    print: this.collection.options.print,
                    printScale: this.scaleFactor
                }));
                var e = new L.layerGroup;
                return b.each(this.get("features").models, function(a) {
                    e.addLayer(a.get("featureLayer"))
                }, this), e
            },
            handleResultForPointLayer: function(c) {
                var d = this.collection.options.mapConfig,
                    g = {};
                "undefined" != typeof d && "undefined" != typeof d.labelOptions && (g = a.extend(!0, {}, d.labelOptions)), g.options.className = "undefined" != typeof g.options.className ? g.options.className : "pointLabel", this.set("locations", new f(b.map(c.getLayers(), function(a) {
                    return b.extend({}, a.feature.properties, {
                        featureAttributeMap: this.attributes.featureAttributeMap,
                        markerLayer: a,
                        parentLayer: this,
                        labelOptions: g,
                        className: c.options.className
                    })
                }, this), {
                    model: e,
                    print: this.collection.options.print,
                    printScale: this.scaleFactorMarker
                }));
                var h = this.attributes.clusterOptions.cluster ? new L.markerClusterGroup(this.attributes.clusterOptions.options) : new L.layerGroup;
                return b.each(this.get("locations").models, function(a) {
                    h.addLayer(a.get("markerLayer"))
                }, this), h
            },
            clusterIconCreateFunction: function(a) {
                var c = this.attributes.clusterOptions.iconStyle,
                    d = "undefined" != typeof c.attribute ? b.uniq(b.map(a.getAllChildMarkers(), function(a) {
                        return a.options.parent.attributes[c.attribute]
                    })) : [],
                    e = 1 === d.length ? c[d[0]] : c.default,
                    f = "undefined" != typeof e.backgroundColor ? e.backgroundColor.colorToRgb() : [255, 255, 255],
                    g = "background-color:rgba(" + f[0] + "," + f[1] + "," + f[2] + ",0.5);",
                    h = "undefined" != typeof e.backgroundColor ? "background-color:" + e.backgroundColor + ";" : "";
                return h += "undefined" != typeof e.color ? "color:" + e.color + ";" : "", new L.DivIcon({
                    html: b.template(m)({
                        css_outer: g,
                        css_inner: h,
                        childCount: a.getChildCount()
                    }),
                    className: "marker-cluster",
                    iconSize: new L.Point(c.size * this.scaleFactor, c.size * this.scaleFactor)
                })
            }
        });
        return s
    }), define("models/LayerCollection", ["jquery", "underscore", "backbone", "./LayerModel"], function(a, b, c, d) {
        var e = c.Collection.extend({
            model: d,
            initialize: function(a, b) {
                this.options = b || {}, this.on("add", function(a) {
                    a.set("baseurl", this.options.baseurl), a.set("print", this.options.print)
                })
            },
            byIds: function(a) {
                var b = this.filter(function(b) {
                    return a.indexOf(b.id) > -1
                });
                return new e(b)
            },
            bySource: function(a) {
                return new e(this.where({
                    source: a
                }))
            },
            setActive: function(a) {
                this.each(function(b) {
                    b.setActive(a.indexOf(b.id) > -1)
                })
            },
            byActive: function(a) {
                a = "undefined" == typeof a || a;
                var c = this.where({
                    active: a
                });
                return new e(b.sortBy(c, function(a) {
                    return a.get("activeTime")
                }).reverse())
            },
            byOptional: function(a) {
                return a = "undefined" == typeof a || a, new e(this.where({
                    optional: a,
                    basemap: !1
                }))
            },
            byActiveKey: function() {
                var a = this.byActive().byKey();
                return a.add(this.where({
                    basemap: !0
                })), a
            },
            byKey: function() {
                return new e(this.where({
                    showInKey: !0
                }))
            },
            byBasemap: function(a) {
                return a = "undefined" == typeof a || a, new e(this.where({
                    basemap: a
                }))
            },
            byLoading: function(a) {
                return a = "undefined" == typeof a || a, new e(this.where({
                    loading: a
                }))
            },
            isLoading: function() {
                return this.byLoading().length > 0
            },
            byOcean: function(a) {
                return new e(this.filter(function(b) {
                    return b.getOcean() === a
                }))
            },
            byCategory: function(a) {
                return new e(this.where({
                    category: a
                }))
            },
            bySubcategory: function(a) {
                return new e(this.where({
                    subcategory: a
                }))
            },
            byGroup: function(a) {
                return new e(this.where({
                    group: a
                }))
            },
            getCategories: function() {
                return b.unique(b.map(this.models, function(a) {
                    return a.attributes.category
                }))
            },
            getSubcategories: function() {
                return b.unique(b.map(this.models.where(function(a) {
                    return "undefined" != typeof a.attributes.subcategory
                }), function(a) {
                    return a.attributes.subcategory
                }))
            },
            getGroups: function() {
                return b.unique(b.map(this.models.where(function(a) {
                    return "undefined" != typeof a.attributes.subcategory
                }), function(a) {
                    return a.attributes.group
                }))
            },
            getIds: function() {
                return b.map(this.models, function(a) {
                    return a.id
                })
            }
        });
        return e
    }), define("models/LayerModelArcGis", ["jquery", "underscore", "backbone", "./LayerModel", "leaflet", "esri.leaflet", "proj4.leaflet"], function(a, b, c, d, e, f, g) {
        var h = d.extend({
            propSort: function(a) {
                return !a instanceof Array && (a = a.split(",")),
                    function(b, c) {
                        var d;
                        b = b.attributes, c = c.attributes;
                        for (var e = 0; e < a.length; e++) {
                            if (d = a[e], "undefined" == typeof b[d]) return -1;
                            if (b[d] < c[d]) return -1;
                            if (b[d] > c[d]) return 1
                        }
                        return 0
                    }
            },
            loadData: function(c) {
                this.setLoading(!0);
                var d = a.param(b.extend({}, this.attributes.mapConfig.arcgisOptions.queryArgs, this.attributes.queryArgs)),
                    e = this;
                a.ajax({
                    dataType: "json",
                    url: e.getURL() + "query?" + d,
                    success: function(a) {
                        e.setLoading(!1), a.error ? console.log("error loading arcgis layer " + this.id + ". message: " + a.error.message + " - code: " + a.error.code) : a.error || a.features.length < 1 ? console.log("error loading arcgis layer " + this.id + " - no features") : ("undefined" != typeof e.attributes.sortBy && a.features.sort(e.propSort(e.attributes.sortBy)).reverse(), c(L.Proj.geoJson(b.extend({}, L.esri.Util.responseToFeatureCollection(a), {
                            crs: e.getCrs()
                        }), {
                            style: e.attributes.style,
                            className: "wwf-layer wwf-layer-" + e.id + " wwf-layer-type-" + e.attributes.type
                        })))
                    },
                    error: function() {
                        e.setLoading(!1), console.log("error loading arcgis layer")
                    }
                })
            },
            getURL: function() {
                return "//" + this.attributes.mapConfig.arcgisOptions.ip + "/" + this.attributes.mapConfig.arcgisOptions.path + "/" + this.attributes.path
            }
        });
        return h
    }), define("models/LayerModelArcGisRaster", ["jquery", "underscore", "backbone", "./LayerModel", "leaflet", "esri.leaflet", "proj4.leaflet"], function(a, b, c, d, e, f, g) {
        var h = d.extend({
            loadData: function(c, d) {
                this.setLoading(!0);
                var e = this.attributes.options.bbox,
                    f = 0;
                if ("undefined" != typeof this.attributes.options.imageSize) f = this.attributes.options.imageSize;
                else {
                    var g = d.map.project([e.XMin, e.YMin], this.attributes.mapConfig.mapOptions.maxZoom),
                        h = d.map.project([e.XMax, e.YMax], this.attributes.mapConfig.mapOptions.maxZoom);
                    f = Math.max(Math.abs(g.x - h.x), Math.abs(g.y - h.y))
                }
                var i = a.param(b.extend({}, this.attributes.mapConfig.arcgisOptions.queryArgsRaster, {
                        bbox: e.XMin + "," + e.YMin + "," + e.XMax + "," + e.YMax,
                        bboxSR: this.attributes.options.bboxSR,
                        imageSR: this.attributes.options.imageSR,
                        size: f + "," + f
                    })),
                    j = this;
                c(L.Proj.imageOverlay(j.getURL() + "export?" + i, L.bounds([e.XMin, e.YMin], [e.XMax, e.YMax]), j.attributes.style).on("load", function() {
                    j.setLoading(!1)
                }))
            },
            getURL: function() {
                return "//" + this.attributes.mapConfig.arcgisOptions.ip + "/" + this.attributes.mapConfig.arcgisOptions.path + "/" + this.attributes.path
            }
        });
        return h
    }), ! function() {
        function a(a, b) {
            function c(b) {
                var e, c = a.arcs[b < 0 ? ~b : b],
                    d = c[0];
                return a.transform ? (e = [0, 0], c.forEach(function(a) {
                    e[0] += a[0], e[1] += a[1]
                })) : e = c[c.length - 1], b < 0 ? [e, d] : [d, e]
            }

            function d(a, b) {
                for (var c in a) {
                    var d = a[c];
                    delete b[d.start], delete d.start, delete d.end, d.forEach(function(a) {
                        e[a < 0 ? ~a : a] = 1
                    }), h.push(d)
                }
            }
            var e = {},
                f = {},
                g = {},
                h = [],
                i = -1;
            return b.forEach(function(c, d) {
                var f, e = a.arcs[c < 0 ? ~c : c];
                e.length < 3 && !e[1][0] && !e[1][1] && (f = b[++i], b[i] = c, b[d] = f)
            }), b.forEach(function(a) {
                var h, i, b = c(a),
                    d = b[0],
                    e = b[1];
                if (h = g[d])
                    if (delete g[h.end], h.push(a), h.end = e, i = f[e]) {
                        delete f[i.start];
                        var j = i === h ? h : h.concat(i);
                        f[j.start = h.start] = g[j.end = i.end] = j
                    } else f[h.start] = g[h.end] = h;
                else if (h = f[e])
                    if (delete f[h.start], h.unshift(a), h.start = d, i = g[d]) {
                        delete g[i.end];
                        var k = i === h ? h : i.concat(h);
                        f[k.start = i.start] = g[k.end = h.end] = k
                    } else f[h.start] = g[h.end] = h;
                else h = [a], f[h.start = d] = g[h.end = e] = h
            }), d(g, f), d(f, g), b.forEach(function(a) {
                e[a < 0 ? ~a : a] || h.push([a])
            }), h
        }

        function b(b, c, d) {
            function h(a) {
                var b = a < 0 ? ~a : a;
                (f[b] || (f[b] = [])).push({
                    i: a,
                    g: g
                })
            }

            function i(a) {
                a.forEach(h)
            }

            function j(a) {
                a.forEach(i)
            }

            function k(a) {
                "GeometryCollection" === a.type ? a.geometries.forEach(k) : a.type in l && (g = a, l[a.type](a.arcs))
            }
            var e = [];
            if (arguments.length > 1) {
                var g, f = [],
                    l = {
                        LineString: i,
                        MultiLineString: j,
                        Polygon: j,
                        MultiPolygon: function(a) {
                            a.forEach(j)
                        }
                    };
                k(c), f.forEach(arguments.length < 3 ? function(a) {
                    e.push(a[0].i)
                } : function(a) {
                    d(a[0].g, a[a.length - 1].g) && e.push(a[0].i)
                })
            } else
                for (var m = 0, n = b.arcs.length; m < n; ++m) e.push(m);
            return {
                type: "MultiLineString",
                arcs: a(b, e)
            }
        }

        function c(b, c) {
            function d(a) {
                a.forEach(function(b) {
                    b.forEach(function(b) {
                        (g[b = b < 0 ? ~b : b] || (g[b] = [])).push(a)
                    })
                }), h.push(a)
            }

            function e(a) {
                return k(f(b, {
                    type: "Polygon",
                    arcs: [a]
                }).coordinates[0]) > 0
            }
            var g = {},
                h = [],
                i = [];
            return c.forEach(function(a) {
                "Polygon" === a.type ? d(a.arcs) : "MultiPolygon" === a.type && a.arcs.forEach(d)
            }), h.forEach(function(a) {
                if (!a._) {
                    var b = [],
                        c = [a];
                    for (a._ = 1, i.push(b); a = c.pop();) b.push(a), a.forEach(function(a) {
                        a.forEach(function(a) {
                            g[a < 0 ? ~a : a].forEach(function(a) {
                                a._ || (a._ = 1, c.push(a))
                            })
                        })
                    })
                }
            }), h.forEach(function(a) {
                delete a._
            }), {
                type: "MultiPolygon",
                arcs: i.map(function(c) {
                    var f, d = [];
                    if (c.forEach(function(a) {
                            a.forEach(function(a) {
                                a.forEach(function(a) {
                                    g[a < 0 ? ~a : a].length < 2 && d.push(a)
                                })
                            })
                        }), d = a(b, d), (f = d.length) > 1)
                        for (var j, h = e(c[0][0]), i = 0; i < f; ++i)
                            if (h === e(d[i])) {
                                j = d[0], d[0] = d[i], d[i] = j;
                                break
                            }
                    return d
                })
            }
        }

        function d(a, b) {
            return "GeometryCollection" === b.type ? {
                type: "FeatureCollection",
                features: b.geometries.map(function(b) {
                    return e(a, b)
                })
            } : e(a, b)
        }

        function e(a, b) {
            var c = {
                type: "Feature",
                id: b.id,
                properties: b.properties || {},
                geometry: f(a, b)
            };
            return null == b.id && delete c.id, c
        }

        function f(a, b) {
            function c(a, b) {
                b.length && b.pop();
                for (var f, c = k[a < 0 ? ~a : a], d = 0, e = c.length; d < e; ++d) b.push(f = c[d].slice()), j(f, d);
                a < 0 && g(b, e)
            }

            function d(a) {
                return a = a.slice(), j(a, 0), a
            }

            function e(a) {
                for (var b = [], d = 0, e = a.length; d < e; ++d) c(a[d], b);
                return b.length < 2 && b.push(b[0].slice()), b
            }

            function f(a) {
                for (var b = e(a); b.length < 4;) b.push(b[0].slice());
                return b
            }

            function h(a) {
                return a.map(f)
            }

            function i(a) {
                var b = a.type;
                return "GeometryCollection" === b ? {
                    type: b,
                    geometries: a.geometries.map(i)
                } : b in l ? {
                    type: b,
                    coordinates: l[b](a)
                } : null
            }
            var j = o(a.transform),
                k = a.arcs,
                l = {
                    Point: function(a) {
                        return d(a.coordinates)
                    },
                    MultiPoint: function(a) {
                        return a.coordinates.map(d)
                    },
                    LineString: function(a) {
                        return e(a.arcs)
                    },
                    MultiLineString: function(a) {
                        return a.arcs.map(e)
                    },
                    Polygon: function(a) {
                        return h(a.arcs)
                    },
                    MultiPolygon: function(a) {
                        return a.arcs.map(h)
                    }
                };
            return i(b)
        }

        function g(a, b) {
            for (var c, d = a.length, e = d - b; e < --d;) c = a[e], a[e++] = a[d], a[d] = c
        }

        function h(a, b) {
            for (var c = 0, d = a.length; c < d;) {
                var e = c + d >>> 1;
                a[e] < b ? c = e + 1 : d = e
            }
            return c
        }

        function i(a) {
            function b(a, b) {
                a.forEach(function(a) {
                    a < 0 && (a = ~a);
                    var c = e[a];
                    c ? c.push(b) : e[a] = [b]
                })
            }

            function c(a, c) {
                a.forEach(function(a) {
                    b(a, c)
                })
            }

            function d(a, b) {
                "GeometryCollection" === a.type ? a.geometries.forEach(function(a) {
                    d(a, b)
                }) : a.type in g && g[a.type](a.arcs, b)
            }
            var e = {},
                f = a.map(function() {
                    return []
                }),
                g = {
                    LineString: b,
                    MultiLineString: c,
                    Polygon: c,
                    MultiPolygon: function(a, b) {
                        a.forEach(function(a) {
                            c(a, b)
                        })
                    }
                };
            a.forEach(d);
            for (var i in e)
                for (var j = e[i], k = j.length, l = 0; l < k; ++l)
                    for (var m = l + 1; m < k; ++m) {
                        var p, n = j[l],
                            o = j[m];
                        (p = f[n])[i = h(p, o)] !== o && p.splice(i, 0, o), (p = f[o])[i = h(p, n)] !== n && p.splice(i, 0, n)
                    }
            return f
        }

        function j(a, b) {
            function c(a) {
                f.remove(a), a[1][2] = b(a), f.push(a)
            }
            var d = o(a.transform),
                e = p(a.transform),
                f = n();
            return b || (b = l), a.arcs.forEach(function(a) {
                for (var i, l, g = [], h = 0, j = 0, k = a.length; j < k; ++j) l = a[j], d(a[j] = [l[0], l[1], 1 / 0], j);
                for (var j = 1, k = a.length - 1; j < k; ++j) i = a.slice(j - 1, j + 2), i[1][2] = b(i), g.push(i), f.push(i);
                for (var j = 0, k = g.length; j < k; ++j) i = g[j], i.previous = g[j - 1], i.next = g[j + 1];
                for (; i = f.pop();) {
                    var m = i.previous,
                        n = i.next;
                    i[1][2] < h ? i[1][2] = h : h = i[1][2], m && (m.next = n, m[2] = i[2], c(m)), n && (n.previous = m, n[0] = i[0], c(n))
                }
                a.forEach(e)
            }), a
        }

        function k(a) {
            for (var d, b = -1, c = a.length, e = a[c - 1], f = 0; ++b < c;) d = e, e = a[b], f += d[0] * e[1] - d[1] * e[0];
            return f / 2
        }

        function l(a) {
            var b = a[0],
                c = a[1],
                d = a[2];
            return Math.abs((b[0] - d[0]) * (c[1] - b[1]) - (b[0] - c[0]) * (d[1] - b[1]))
        }

        function m(a, b) {
            return a[1][2] - b[1][2]
        }

        function n() {
            function a(a, b) {
                for (; b > 0;) {
                    var c = (b + 1 >> 1) - 1,
                        e = d[c];
                    if (m(a, e) >= 0) break;
                    d[e._ = b] = e, d[a._ = b = c] = a
                }
            }

            function b(a, b) {
                for (;;) {
                    var c = b + 1 << 1,
                        f = c - 1,
                        g = b,
                        h = d[g];
                    if (f < e && m(d[f], h) < 0 && (h = d[g = f]), c < e && m(d[c], h) < 0 && (h = d[g = c]), g === b) break;
                    d[h._ = b] = h, d[a._ = b = g] = a
                }
            }
            var c = {},
                d = [],
                e = 0;
            return c.push = function(b) {
                return a(d[b._ = e] = b, e++), e
            }, c.pop = function() {
                if (!(e <= 0)) {
                    var c, a = d[0];
                    return --e > 0 && (c = d[e], b(d[c._ = 0] = c, 0)), a
                }
            }, c.remove = function(c) {
                var g, f = c._;
                if (d[f] === c) return f !== --e && (g = d[e], (m(g, c) < 0 ? a : b)(d[g._ = f] = g, f)), f
            }, c
        }

        function o(a) {
            if (!a) return q;
            var b, c, d = a.scale[0],
                e = a.scale[1],
                f = a.translate[0],
                g = a.translate[1];
            return function(a, h) {
                h || (b = c = 0), a[0] = (b += a[0]) * d + f, a[1] = (c += a[1]) * e + g
            }
        }

        function p(a) {
            if (!a) return q;
            var b, c, d = a.scale[0],
                e = a.scale[1],
                f = a.translate[0],
                g = a.translate[1];
            return function(a, h) {
                h || (b = c = 0);
                var i = (a[0] - f) / d | 0,
                    j = (a[1] - g) / e | 0;
                a[0] = i - b, a[1] = j - c, b = i, c = j
            }
        }

        function q() {}
        var r = {
            version: "1.6.20",
            mesh: function(a) {
                return f(a, b.apply(this, arguments))
            },
            meshArcs: b,
            merge: function(a) {
                return f(a, c.apply(this, arguments))
            },
            mergeArcs: c,
            feature: d,
            neighbors: i,
            presimplify: j
        };
        "function" == typeof define && define.amd ? define("topojson", r) : "object" == typeof module && module.exports ? module.exports = r : this.topojson = r
    }(), define("models/LayerModelTopo", ["jquery", "underscore", "backbone", "./LayerModel", "topojson"], function(a, b, c, d, e) {
        var f = d.extend({
            loadData: function(c) {
                this.setLoading(!0);
                var d = this;
                a.ajax({
                    dataType: "json",
                    url: this.attributes.baseurl + "/" + this.attributes.path,
                    success: function(a) {
                        var f = e.feature(a, a.objects[Object.keys(a.objects)[0]]);
                        d.setLoading(!1), c(L.Proj.geoJson(b.extend({}, f, {
                            crs: d.getCrs()
                        }), {
                            style: d.attributes.style,
                            filter: function(a) {
                                return "undefined" == typeof d.attributes.filters || b.reduce(d.attributes.filters, function(b, c, d) {
                                    return b || a.properties[d] === c
                                }, !1)
                            },
                            className: "wwf-layer wwf-layer-" + d.id + " wwf-layer-type-" + d.attributes.type
                        }))
                    },
                    error: function() {
                        d.setLoading(!1)
                    }
                })
            }
        });
        return f
    }), define("models/LayerModelGeoJson", ["jquery", "underscore", "backbone", "./LayerModel", "proj4.leaflet"], function(a, b, c, d, e) {
        var f = d.extend({
            loadData: function(c) {
                this.setLoading(!0);
                var d = this;
                a.ajax({
                    dataType: "json",
                    url: this.attributes.baseurl + "/" + this.attributes.path,
                    success: function(a) {
                        d.setLoading(!1), c(L.Proj.geoJson(b.extend({}, a, {
                            crs: d.getCrs()
                        }), {
                            style: d.attributes.style,
                            filter: function(a) {
                                return "undefined" == typeof d.attributes.filters || b.reduce(d.attributes.filters, function(b, c, d) {
                                    return b || a.properties[d] === c
                                }, !1)
                            },
                            className: "wwf-layer wwf-layer-" + d.id + " wwf-layer-type-" + d.attributes.type
                        }))
                    },
                    error: function() {
                        console.log("error loading geojson layer"), d.setLoading(!1)
                    }
                })
            }
        });
        return f
    }), define("models/LayerModelMapboxTiles", ["jquery", "underscore", "backbone", "./LayerModel", "leaflet"], function(a, b, c, d, e) {
        var f = d.extend({
            loadData: function(a) {
                this.setLoading(!0);
                var b = this.attributes.options.id;
                this.collection.options.print && "undefined" != typeof this.attributes.options.printId ? b = this.attributes.options.printId : L.Browser.retina && "undefined" != typeof this.attributes.options.retinaId && (b = this.attributes.options.retinaId);
                var c = this;
                a(L.tileLayer("http://{s}.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={token}", {
                    detectRetina: !0,
                    id: b,
                    subdomains: ["a", "b", "c", "d"],
                    token: this.attributes.options.accessToken,
                    zIndex: this.isBasemap() ? 0 : 1,
                    opacity: this.isBasemap() ? 1 : "undefined" != typeof this.attributes.options.opacity ? this.attributes.options.opacity : this.attributes.style.opacity
                }).on("loading", function() {}).on("load", function() {
                    c.setLoading(!1)
                }))
            }
        });
        return f
    }), define("models/LayerModelCustom", ["jquery", "underscore", "backbone", "./LayerModel", "leaflet", "leaflet.draw", "text!templates/divSvgIconTemplate.html"], function(a, b, c, d, e, f, g) {
        var h = d.extend({
            initializeSource: function() {
                var a = parseInt(this.id.split("_c")[1]),
                    b = tlang.ux.layers.custom_default_title + (a > 0 ? " " + (a + 1) : "");
                this.set("mapLayer", new L.FeatureGroup), this.set("ocean", this.id.split("_c")[0]), this.setTitle(b);
                var c = this.getRandomColor();
                this.set("style", {
                    fillColor: c,
                    color: c,
                    weight: 3
                }), this.attributes.icon = {
                    type: "marker",
                    width: 15,
                    height: 25
                }, this.set("control", new L.Control.Draw({
                    draw: {
                        rectangle: {
                            showArea: !1
                        },
                        polygon: {
                            showArea: !1
                        },
                        circle: {
                            showRadius: !1
                        },
                        polyline: {
                            showLength: !1
                        },
                        marker: {
                            icon: this.getMarkerIcon()
                        }
                    },
                    edit: {
                        featureGroup: this.attributes.mapLayer,
                        edit: {
                            selectedPathOptions: {
                                maintainColor: !0
                            }
                        }
                    },
                    position: "topright"
                })), L.drawLocal = {
                    draw: {
                        toolbar: {
                            actions: {
                                title: tlang.ux.layers.cancel,
                                text: tlang.ux.layers.cancel
                            },
                            finish: {
                                title: tlang.ux.layers.draw.finish,
                                text: tlang.ux.layers.draw.finish
                            },
                            undo: {
                                title: tlang.ux.layers.draw.undo,
                                text: tlang.ux.layers.draw.undo
                            },
                            buttons: {
                                polyline: tlang.ux.layers.draw.add_line,
                                polygon: tlang.ux.layers.draw.add_area,
                                rectangle: tlang.ux.layers.draw.add_rectangle,
                                circle: tlang.ux.layers.draw.add_circle,
                                marker: tlang.ux.layers.draw.add_marker
                            }
                        },
                        handlers: {
                            circle: {
                                tooltip: {
                                    start: tlang.ux.layers.draw.circle_tooltip
                                }
                            },
                            marker: {
                                tooltip: {
                                    start: tlang.ux.layers.draw.marker_tooltip
                                }
                            },
                            polygon: {
                                tooltip: {
                                    start: tlang.ux.layers.draw.polygon_tooltip_start,
                                    cont: tlang.ux.layers.draw.polygon_tooltip_continue,
                                    end: tlang.ux.layers.draw.polygon_tooltip_end
                                }
                            },
                            polyline: {
                                tooltip: {
                                    start: tlang.ux.layers.draw.line_tooltip_start,
                                    cont: tlang.ux.layers.draw.line_tooltip_continue,
                                    end: tlang.ux.layers.draw.line_tooltip_end
                                }
                            },
                            rectangle: {
                                tooltip: {
                                    start: tlang.ux.layers.draw.rectangle_tooltip
                                }
                            },
                            simpleshape: {
                                tooltip: {
                                    end: tlang.ux.layers.draw.tooltip_end
                                }
                            }
                        }
                    },
                    edit: {
                        toolbar: {
                            actions: {
                                save: {
                                    title: tlang.ux.layers.confirm,
                                    text: tlang.ux.layers.confirm
                                },
                                cancel: {
                                    title: tlang.ux.layers.cancel,
                                    text: tlang.ux.layers.cancel
                                }
                            },
                            buttons: {
                                edit: tlang.ux.layers.draw.edit,
                                editDisabled: tlang.ux.layers.draw.edit,
                                remove: tlang.ux.layers.draw.remove,
                                removeDisabled: tlang.ux.layers.draw.remove
                            }
                        },
                        handlers: {
                            edit: {
                                tooltip: {
                                    text: tlang.ux.layers.draw.edit_tooltip,
                                    subtext: tlang.ux.layers.draw.edit_tooltip_hint
                                }
                            },
                            remove: {
                                tooltip: {
                                    text: tlang.ux.layers.draw.remove_tooltip
                                }
                            }
                        }
                    }
                }
            },
            getMarkerIcon: function() {
                var a = this.attributes.icon.width,
                    c = this.attributes.icon.height,
                    d = b.template(g)({
                        color: "rgba(0,0,0,0.5)",
                        weight: 2,
                        fillColor: this.attributes.style.fillColor
                    });
                return L.icon({
                    iconUrl: "data:image/svg+xml;base64," + btoa(d),
                    iconSize: [a, c],
                    iconAnchor: [a / 2, c]
                })
            },
            getDrawControl: function() {
                return this.attributes.control
            },
            getColor: function() {
                return this.attributes.style.color
            },
            setColor: function(a) {
                this.set("style", b.extend(this.attributes.style, {
                    fillColor: a,
                    color: a
                })), this.initStyles(), this.initCssStyles()
            },
            getRandomColor: function() {
                return "#" + Math.random().toString(16).slice(2, 8).toUpperCase()
            },
            getMapLayer: function(a) {
                a(this.attributes.mapLayer, this)
            },
            setEdit: function(a) {
                this.set("edit", a)
            },
            isEdit: function() {
                return this.attributes.edit
            },
            setTitle: function(a) {
                this.set("title", a)
            },
            getTitle: function() {
                return this.attributes.title
            },
            setCustomData: function(a) {
                if ("undefined" != typeof a && a.id === this.id && ("undefined" != typeof a.title && this.setTitle(a.title), "undefined" != typeof a.color && this.setColor(a.color), "undefined" != typeof a.shapes && (this.attributes.mapLayer.clearLayers(), a.shapes.length > 0))) {
                    var c = this;
                    b.each(a.shapes, function(a) {
                        L.geoJson(a, {
                            onEachFeature: function(b, d) {
                                switch (a.properties.type) {
                                    case "rectangle":
                                        var e = new L.Rectangle(d.getBounds(), c.attributes.style);
                                        e.feature = d.feature, d = e;
                                        break;
                                    case "circle":
                                        var f = new L.Circle(d.getLatLng(), a.properties.radius, c.attributes.style);
                                        f.feature = d.feature, d = f;
                                        break;
                                    case "polyline":
                                        var g = new L.Polyline(d.getLatLngs(), c.attributes.style);
                                        g.feature = d.feature, d = g;
                                        break;
                                    case "polygon":
                                        var g = new L.Polygon(d.getLatLngs(), c.attributes.style);
                                        g.feature = d.feature, d = g;
                                        break;
                                    case "marker":
                                        var h = new L.marker(d.getLatLng(), {
                                            icon: c.getMarkerIcon()
                                        });
                                        h.feature = d.feature, d = h
                                }
                                c.attributes.mapLayer.addLayer(d)
                            }
                        })
                    })
                }
            },
            getReference: function(a) {
                return a = "undefined" != typeof a && a, a ? tlang.ux.print.custom_attribution : ""
            }
        });
        return h
    }), define("models/LayerModelNav", ["jquery", "underscore", "backbone", "./LayerModel", "leaflet", "proj4.leaflet", "./LocationModel", "./LocationCollection"], function(a, b, c, d, e, f, g, h) {
        var i = d.extend({
            makeLayer: function(a, c) {
                this.set("title", "");
                var d = this.makeGeoJsonLayer(a);
                c = "undefined" != typeof c ? c : {};
                var e = "undefined" != typeof c.labelOptions ? c.labelOptions : {},
                    f = this;
                this.set("locations", new h(b.map(d.getLayers(), function(a) {
                    return b.extend({}, a.feature.properties, {
                        markerLayer: a,
                        parentLayer: f,
                        labelOptions: e,
                        className: d.options.className
                    })
                }), {
                    model: g,
                    eventContext: this.collection.options.eventContext
                }));
                var i = new L.layerGroup;
                b.each(this.get("locations").models, function(a) {
                    i.addLayer(a.get("markerLayer"))
                }, this), this.set("mapLayer", i)
            },
            makeGeoJsonLayer: function(a) {
                return L.Proj.geoJson({
                    type: "FeatureCollection",
                    crs: {
                        type: "name",
                        properties: {
                            name: "urn:ogc:def:crs:EPSG::4326"
                        }
                    },
                    features: b.map(a, function(a) {
                        return {
                            type: "Feature",
                            properties: {
                                id: a.id,
                                title: a.title
                            },
                            geometry: {
                                type: "Point",
                                coordinates: a.location
                            }
                        }
                    })
                })
            },
            getMapLayer: function(a) {
                a(this.attributes.mapLayer, this)
            }
        });
        return i
    }), define("components/app/AppView", ["jquery", "underscore", "backbone", "jsonpack", "domReady!", "./header/HeaderView", "./header/HeaderModel", "./key/KeyView", "./key/KeyModel", "./print/PrintView", "./print/PrintModel", "./story/StoryView", "./story/StoryViewModel", "./home/HomeView", "./ocean/OceanView", "./ocean/OceanViewModel", "./pages/PagesView", "./pages/PagesModel", "./map/MapView", "./map/MapModel", "./modal/ModalView", "./modal/ModalModel", "./layers/LayersView", "./layers/LayersModel", "models/ViewModel", "models/LayerCollection", "models/LayerModelArcGis", "models/LayerModelArcGisRaster", "models/LayerModelTopo", "models/LayerModelGeoJson", "models/LayerModelMapboxTiles", "models/LayerModelCustom", "models/LayerModelNav"], function(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C, D, E, F, G) {
        var H = c.View.extend({
            el: a("#application"),
            events: {
                "click .close-item": function(a, b) {
                    a.preventDefault();
                    var c = this.model.getHistoryWithoutPages();
                    0 === c.length ? this.model.getRouter().resetApp() : this.model.getRouter().goToFragment(c[c.length - 1].fragment)
                },
                "click .module-link": function(b) {
                    b.preventDefault();
                    var c = a(b.target).closest("[data-module]").data("module");
                    this.$el.trigger("moduleLinkClick", {
                        target: b.target,
                        id: c
                    })
                },
                "click .ocean-link": function(b) {
                    b.preventDefault();
                    var c = a(b.target).closest("[data-oceanid]").data("oceanid");
                    this.$el.trigger("oceanLinkClick", {
                        target: b.target,
                        id: c
                    })
                },
                "click .page-link": function(b) {
                    b.preventDefault();
                    var c = a(b.target).closest("[data-pageid]").data("pageid");
                    this.$el.trigger("pageLinkClick", {
                        target: b.target,
                        id: c
                    })
                },
                moduleLinkClick: function(a, b) {
                    var c = b.id;
                    switch (c) {
                        case "story":
                            this.model.getRouter().update({
                                link: !0,
                                route: "ocean",
                                path: this.model.getActiveOceanId(),
                                query: {
                                    view: this.model.getActiveOcean().getMapview(),
                                    clayers: this.model.getCustomLayerIds(),
                                    cdata: this.model.getCustomData()
                                }
                            });
                            break;
                        case "layers":
                            this.model.getRouter().update({
                                link: !0,
                                route: "layers",
                                path: "home",
                                query: {
                                    view: this.model.getActiveOcean().getMapview(),
                                    ocean: this.model.getActiveOceanId(),
                                    clayers: this.model.getCustomLayerIds(),
                                    cdata: this.model.getCustomData()
                                }
                            })
                    }
                },
                resetApp: function(a, b) {
                    this.model.getRouter().resetApp()
                },
                pageLinkClick: function(a, b) {
                    this.model.getRouter().update({
                        link: !0,
                        route: "page",
                        path: b.id,
                        query: {
                            view: this.model.getActiveMapview(!0),
                            clayers: this.model.getCustomLayerIds(),
                            cdata: this.model.getCustomData()
                        }
                    })
                },
                storyLinkClick: function(a, b) {
                    this.model.getRouter().update({
                        link: !0,
                        route: "story",
                        path: b.id,
                        query: {
                            view: this.model.getStory(b.id).getMapview(),
                            clayers: this.model.getCustomLayerIds(),
                            cdata: this.model.getCustomData()
                        }
                    })
                },
                nextStoryLinkClick: function(a, b) {
                    this.$el.trigger("storyLinkClick", {
                        target: a.target,
                        id: this.model.getNextStoryId()
                    })
                },
                previousStoryLinkClick: function(a, b) {
                    this.$el.trigger("storyLinkClick", {
                        target: a.target,
                        id: this.model.getPreviousStoryId()
                    })
                },
                oceanLinkClick: function(a, b) {
                    this.model.getRouter().update({
                        link: !0,
                        route: "ocean",
                        path: b.id,
                        query: {
                            view: this.model.getOcean(b.id).getMapview(),
                            clayers: this.model.getCustomLayerIds(),
                            cdata: this.model.getCustomData()
                        }
                    })
                },
                nextOceanLinkClick: function(a, b) {
                    this.$el.trigger("oceanLinkClick", {
                        target: a.target,
                        id: this.model.getNextOceanId()
                    })
                },
                previousOceanLinkClick: function(a, b) {
                    this.$el.trigger("oceanLinkClick", {
                        target: a.target,
                        id: this.model.getPreviousOceanId()
                    })
                },
                storeMap: function(a) {
                    this.model.storeMapStateOnServer()
                },
                printMap: function(a, b) {
                    this.model.storeMapStateOnServer(!0)
                },
                shareOnFacebook: function(a, b) {
                    this.model.storeMapStateOnServer(!0)
                },
                printMapModal: function(a) {
                    this.model.getRouter().queryUpdate({
                        modal: "print",
                        modalid: this.model.storeMapStateOnServer(!0)
                    })
                },
                mapViewUpdated: function(a, b) {
                    var c = b.center.lat + "|" + b.center.lng + "|" + b.zoom + "||" + b.dimensions[0] + "|" + b.dimensions[1];
                    c !== this.model.getActiveMapview(!0) && this.model.getRouter().queryUpdate({
                        view: c
                    })
                },
                addCustomLayer: function(a, c) {
                    var d = this.model.getCustomLayerIds(),
                        e = d.length ? parseInt(b.last(d).split("_c")[1]) + 1 : 0,
                        f = c.ocean + "_c" + e;
                    this.model.getRouter().queryUpdate({
                        layers: b.uniq(this.model.getActiveLayerIds().concat(f)),
                        clayers: d.concat(f),
                        cedit: f
                    })
                },
                removeCustomLayer: function(a, c) {
                    var e = c.id,
                        f = b.reject(this.model.getCustomData(!0), function(a) {
                            return a.id = e
                        });
                    this.model.getRouter().queryUpdate({
                        layers: b.without(this.model.getActiveLayerIds(), e),
                        clayers: b.without(this.model.getCustomLayerIds(), e),
                        cedit: this.model.getCustomEdit() === e ? "" : this.model.getCustomEdit(),
                        cdata: f.length > 0 ? d.pack(f) : ""
                    })
                },
                editCustomLayer: function(a, c) {
                    this.model.getRouter().update({
                        link: !0,
                        extendQuery: !0,
                        route: "layers",
                        path: "home",
                        query: {
                            layers: b.uniq(this.model.getActiveLayerIds().concat(c.id)),
                            cat: "custom",
                            cedit: this.model.getCustomEdit() === c.id ? "" : c.id
                        }
                    })
                },
                customDeleted: function(a, c) {
                    var e = this.model.getCustomData(!0),
                        f = b.findWhere(e, {
                            id: c.layer.id
                        });
                    if ("undefined" != typeof f) {
                        if ("undefined" != typeof c.layer.shapes) {
                            var g = [];
                            b.each(f.shapes, function(a) {
                                c.layer.shapes.indexOf(a.properties.featureid) < 0 && g.push(a)
                            }), f.shapes = g
                        }
                        this.model.getRouter().queryUpdate({
                            cdata: d.pack(e)
                        })
                    }
                },
                customUpdated: function(a, c) {
                    var e = this.model.getCustomData(!0),
                        f = b.findWhere(e, {
                            id: c.layer.id
                        });
                    if ("undefined" != typeof f) {
                        if ("undefined" != typeof c.layer.shapes) {
                            var g = b.pluck(b.pluck(c.layer.shapes, "properties"), "featureid");
                            b.each(f.shapes, function(a) {
                                g.indexOf(a.properties.featureid) < 0 && c.layer.shapes.push(a)
                            })
                        }
                        b.extend(f, c.layer)
                    } else {
                        var h = c.layer;
                        h.color = this.model.getLayer(c.layer.id).getColor(), e.push(h)
                    }
                    this.model.getRouter().queryUpdate({
                        cdata: d.pack(e)
                    })
                },
                mapMarkerClick: function(a, c) {
                    b.pluck(this.model.getOceans().models, "id").indexOf(c.locationId) >= 0 && this.$el.trigger("oceanLinkClick", {
                        target: a.target,
                        id: c.locationId
                    }), b.pluck(this.model.getStories().models, "id").indexOf(c.locationId) >= 0 && this.$el.trigger("storyLinkClick", {
                        target: a.target,
                        id: c.locationId
                    })
                },
                storyItemActivated: function(a, b) {
                    this.model.getRouter().queryUpdate({
                        layers: b.layerIds
                    })
                },
                layerToggled: function(a, c) {
                    var d = "undefined" != typeof c.toggle ? c.toggle : this.model.getActiveLayerIds().indexOf(c.id) === -1,
                        e = "string" == typeof c.id ? [c.id] : c.id;
                    this.model.getRouter().queryUpdate({
                        cedit: "",
                        layers: d ? b.uniq(this.model.getActiveLayerIds().concat(e)) : b.difference(this.model.getActiveLayerIds(), e)
                    })
                },
                preloadLayers: function(a, b) {
                    var c = this;
                    waitFor(function() {
                        return c.model.layersConfigured() && c.model.mapConfigured()
                    }, function() {
                        c.model.preloadLayers(b.layerids)
                    })
                },
                layerCategoryClose: function(a, b) {
                    this.model.getRouter().queryDelete("cat")
                },
                layerCategoryOpen: function(a, b) {
                    this.model.getRouter().update({
                        link: !0,
                        extendQuery: !0,
                        path: "home",
                        query: {
                            cat: b.id,
                            cedit: ""
                        }
                    })
                },
                layerCategoryRemove: function(a, c) {
                    var d = b.pluck(this.model.getActiveLayers().byCategory(c.id).models, "id");
                    this.model.getRouter().queryUpdate({
                        cedit: "",
                        layers: b.difference(this.model.getActiveLayerIds(), d)
                    })
                },
                layerCategoryLinkClick: function(a, b) {
                    var c = this.model.getRouter().queryToggle({
                        cat: b.id,
                        cedit: ""
                    }, !1);
                    this.model.getRouter().update({
                        link: !0,
                        path: "home",
                        query: c
                    })
                },
                layerInfoLinkClick: function(a, b) {
                    this.model.isViewActive("layers") ? this.model.getRouter().update({
                        route: "layers",
                        path: b.id
                    }) : this.model.getRouter().queryUpdate({
                        modal: "layer",
                        modalid: b.id
                    })
                },
                layerInfoSubpage: function(a, b) {
                    var c = this.model.getLayers().get(b.id);
                    this.model.getRouter().update({
                        route: "layers",
                        path: b.id,
                        query: {
                            view: this.model.getOcean(c.getOcean()).getMapview(),
                            ocean: c.getOcean(),
                            layers: [b.id]
                        }
                    })
                },
                closeLayerInfo: function(a, b) {
                    var c = this.model.getLayers().get(b.id);
                    this.model.isViewActive("layers") ? "undefined" != typeof c.getOcean() ? this.model.getRouter().update({
                        link: !0,
                        extendQuery: !0,
                        path: "home",
                        query: {
                            cat: c.getCategory(),
                            cedit: "",
                            ocean: c.getOcean()
                        }
                    }) : "" !== this.model.getActiveOceanId() ? this.model.getRouter().update({
                        link: !0,
                        extendQuery: !0,
                        path: "home",
                        query: {
                            cat: "",
                            cedit: "",
                            ocean: this.model.getActiveOceanId()
                        }
                    }) : this.model.getRouter().resetApp() : this.model.isViewActive("modal") && this.model.getRouter().queryDelete(["modal", "modalid"])
                },
                modalOpen: function(a, b) {
                    this.model.getRouter().queryUpdate({
                        modal: b.type
                    })
                },
                modalClose: function(a, b) {
                    this.model.getRouter().queryDelete(["modal", "modalid"])
                }
            },
            initialize: function() {
                this.layerModels = {
                    arcgis: A,
                    arcgisraster: B,
                    topo: C,
                    geojson: D,
                    mapbox: E,
                    custom: F,
                    appconfig: G
                }, this.views = this.model.getViews();
                var a = this;
                waitFor(function() {
                    return a.model.appConfigured()
                }, function() {
                    a.checkMode(), a.render(), a.model.loadMapConfig(), a.model.loadLayersConfig(), waitFor(function() {
                        return a.model.layersConfigLoaded() && a.model.mapConfigLoaded()
                    }, function() {
                        a.configureLayers()
                    })
                }), waitFor(function() {
                    return a.model.mapReady()
                }, function() {
                    a.$el.addClass("app-loaded")
                }), this.listenTo(this.model, "change:route", this.routeChanged), this.listenTo(this.model, "change:serverStateId", this.serverStateIdChanged), this.listenTo(this.model, "change:printURL", this.printUrlChanged)
            },
            render: function() {
                this.setClass(), this.setNavBottomOceanActiveClass(), this.setNavBottomModuleActiveClass();
                var a = this;
                return this.model.validateRouter(function(b) {
                    b && (waitFor(function() {
                        return a.model.layersConfigured()
                    }, function() {
                        a.updateCustomLayers(), a.model.setActiveLayersFromQuery()
                    }), a.renderHeader(), a.renderHome(), a.renderOcean(), a.renderStory(), a.renderPages(), a.renderLayers(), a.renderMap(), a.renderModal(), a.renderKey(), "print" === a.model.getMode() && a.renderPrint())
                }), this
            },
            setClass: function() {
                this.$el.removeClass(function(a, b) {
                    return (b.match(/\bmodule-\S+/g) || []).join(" ")
                }), this.$el.removeClass(function(a, b) {
                    return (b.match(/\bocean-\S+/g) || []).join(" ")
                }), this.$el.removeClass("layer-item"), this.$el.removeClass("layer-category"), this.$el.addClass(this.model.getActiveModule().class), "" !== this.model.getActiveLayerId() ? this.$el.addClass("layer-item") : this.model.isViewActive("layers") && "" !== this.model.getActiveCategory() && this.$el.addClass("layer-category"), "" !== this.model.getActiveOceanId() && this.$el.addClass("ocean-" + this.model.getActiveOceanId())
            },
            setNavBottomOceanActiveClass: function() {
                this.$("#nav-bottom-oceans .ocean-link").removeClass("active"), "" !== this.model.getActiveOceanId() && this.$("#nav-bottom-oceans .ocean-link-" + this.model.getActiveOceanId()).addClass("active")
            },
            setNavBottomModuleActiveClass: function() {
                this.$("#nav-bottom-modules .module-link").removeClass("active");
                var a = "layers" === this.model.getActiveModule().id ? "layers" : "story";
                this.$('#nav-bottom-modules .module-link[data-module="' + a + '"]').addClass("active")
            },
            renderHeader: function() {
                this.views.header = this.views.header || new f({
                    el: this.$("header"),
                    model: new g({
                        mode: this.model.getMode()
                    })
                }), this.views.header.model.setActivePath(this.model.getPath()), this.views.header.model.setActivePage(this.model.getActivePage())
            },
            renderKey: function() {
                if (this.views.key = this.views.key || new h({
                        el: this.$("#key"),
                        model: new i({})
                    }), this.model.isViewActive("key")) {
                    var a = this;
                    waitFor(function() {
                        return a.model.layersConfigured()
                    }, function() {
                        a.views.key.model.setActive(!0), a.views.key.model.setActiveLayers(a.model.getKeyLayers().models), a.views.key.model.setCustomLayerData(a.model.getCustomData())
                    })
                } else this.views.key.model.setActive(!1);
                this.views.key.model.setAllowLayerToggle("layers" === this.model.getActiveModule().id)
            },
            renderPrint: function() {
                if (this.$("#print").length > 0) {
                    var a = this;
                    waitFor(function() {
                        return a.model.layersConfigured()
                    }, function() {
                        a.views.print = new j({
                            el: a.$("#print"),
                            model: new k({
                                mapid: a.model.getQuery().modalid,
                                activeLayers: a.model.getKeyLayers().models
                            })
                        })
                    })
                }
            },
            renderHome: function() {
                this.$("#home").length > 0 && !this.model.isSubpage() && (this.views.home = this.views.home || new n({
                    el: this.$("#home"),
                    model: new y({})
                }), this.model.isViewActive("home") ? this.views.home.model.setActive(!0) : this.views.home.model.setActive(!1))
            },
            renderOcean: function() {
                this.$("#ocean").length > 0 && (this.views.ocean = this.views.ocean || new o({
                    el: this.$("#ocean"),
                    model: new p({})
                }), this.model.isViewActive("ocean") ? (this.views.ocean.model.setActive(!0), this.views.ocean.model.setOcean(this.model.getActiveOcean()), this.views.ocean.model.setStories(this.model.getStoriesByOcean())) : this.views.ocean.model.setActive(!1))
            },
            renderStory: function() {
                if (this.$("#story").length > 0) {
                    var a = this;
                    waitFor(function() {
                        return a.model.layersConfigured()
                    }, function() {
                        a.views.story = a.views.story || new l({
                            el: a.$("#story"),
                            model: new m({
                                layers: a.model.getLayers()
                            })
                        }), a.model.isViewActive("story") ? (a.views.story.model.setActive(!0), a.views.story.model.setStories(a.model.getStoriesByOcean()), a.views.story.model.setStory(a.model.getActiveStory())) : (a.views.story.model.setActive(!1), a.views.story.model.setStory(null))
                    })
                }
            },
            renderPages: function() {
                this.$("#pages").length > 0 && (this.views.pages = this.views.pages || new q({
                    el: this.$("#pages"),
                    model: new r({
                        pages: this.model.getPages()
                    })
                }), this.model.isViewActive("pages") ? (this.views.pages.model.set("isSubpage", this.model.isSubpage()), this.views.pages.model.setActive(!0), this.views.pages.model.setPath(this.model.getPath())) : this.views.pages.model.setActive(!1))
            },
            renderModal: function() {
                if (this.$("#modal").length > 0) {
                    var a = this;
                    waitFor(function() {
                        return a.model.layersConfigured()
                    }, function() {
                        a.views.modal = a.views.modal || new u({
                            el: a.$("#modal"),
                            model: new v({
                                layers: a.model.getLayers(),
                                printURL: "",
                                modalid: ""
                            })
                        }), a.model.isViewActive("modal") ? (a.views.modal.model.setActive(!0), a.views.modal.model.set({
                            modal: a.model.getQuery().modal,
                            modalid: a.model.getQuery().modalid,
                            ocean: a.model.getActiveOceanId()
                        })) : (a.views.modal.model.setActive(!1), a.views.modal.model.set({
                            modal: "",
                            modalid: ""
                        }))
                    })
                }
            },
            renderMap: function() {
                if (this.$("#map").length > 0) {
                    var a = this;
                    waitFor(function() {
                        return a.model.layersConfigured() && a.model.mapConfigLoaded()
                    }, function() {
                        a.views.map = a.views.map || new s({
                            el: a.$("#map"),
                            model: new t({
                                baseLayers: a.model.getLayers().byBasemap(!0),
                                config: a.model.getMapConfig(),
                                mode: a.model.getMode()
                            })
                        }), a.model.isViewActive("map") ? (a.views.map.model.setActive(!0), a.views.map.model.setMapControl(a.model.getActiveModule().mapControl && "print" !== a.model.getMode()), a.views.map.model.setView(a.model.getActiveMapview()), a.views.map.model.setActiveLayers(a.model.getActiveLayers().models), a.views.map.model.set({
                            customLayerEdit: a.model.getCustomEdit(),
                            customLayerData: a.model.getCustomData()
                        }), a.views.map.model.setInvalidateSize(Date.now()), a.$el.removeClass("app-loaded"), waitFor(function() {
                            return a.model.mapReady()
                        }, function() {
                            a.$el.addClass("app-loaded")
                        })) : a.views.map.model.setActive(!1)
                    })
                }
            },
            renderLayers: function() {
                if (this.$("#layers").length > 0) {
                    var a = this;
                    waitFor(function() {
                        return a.model.layersConfigured()
                    }, function() {
                        a.views.layers = a.views.layers || new w({
                            el: a.$("#layers"),
                            model: new x({
                                layers: a.model.getLayers(),
                                activeLayerIds: a.model.getActiveLayerIds()
                            })
                        }), a.model.isViewActive("layers") ? a.views.layers.model.set({
                            active: !0,
                            layerId: a.model.getActiveLayerId(),
                            category: a.model.getActiveCategory(),
                            ocean: a.model.getActiveOceanId(),
                            customLayerIds: a.model.getCustomLayerIds(),
                            customLayerEdit: a.model.getCustomEdit(),
                            customLayerData: a.model.getCustomData(),
                            activeLayerIds: a.model.getActiveLayerIds()
                        }) : a.views.layers.model.setActive(!1)
                    })
                }
            },
            checkMode: function() {
                var a = this.model.getRoute(),
                    b = this.model.getQuery();
                "layers" === a && "undefined" != typeof b.mode && "print" === b.mode && (this.model.setMode("print"), this.$el.addClass("mode-print"))
            },
            configureLayers: function() {
                var a = b.map(this.model.getLayersConfig(), function(a, b) {
                        return a.order = b, a
                    }),
                    c = {
                        baseurl: this.model.getBaseURL(),
                        comparator: "order",
                        print: "print" === this.model.getMode(),
                        mapConfig: this.model.getMapConfig(),
                        eventContext: this.$el
                    },
                    d = new z(null, c),
                    e = b.chain(a).pluck("source").uniq().value();
                b.each(e, function(e) {
                    d.add(new z(b.filter(a, function(a) {
                        return a.source === e
                    }), b.extend({}, c, {
                        model: this.layerModels[e]
                    })).models)
                }, this), this.model.setLayers(d), this.initNavLayers(), this.model.layersConfigured(!0)
            },
            initNavLayers: function() {
                this.model.getLayer("oceans").makeLayer(b.map(this.model.getOceans().models, function(a) {
                    return {
                        location: a.getMarker(),
                        title: a.getTitle(),
                        id: a.id
                    }
                })), b.each(this.model.getOceans().models, function(a) {
                    this.model.getLayer(a.id).makeLayer(b.map(this.model.getStoriesByOcean(a.id), function(a) {
                        return {
                            location: a.getMarker(),
                            title: a.getTitle(),
                            id: a.id
                        }
                    }), {
                        labelOptions: {
                            options: {
                                offset: [0, 0],
                                direction: "right",
                                pane: "popupPane",
                                className: "storyLabel"
                            },
                            timeout: 3e3
                        }
                    })
                }, this)
            },
            updateCustomLayers: function() {
                var a = this;
                waitFor(function() {
                    return a.model.layersConfigured()
                }, function() {
                    var c = a.model.getCustomLayerIds();
                    a.model.getLayers().remove(b.difference(b.pluck(a.model.getLayers().bySource("custom").models, "id"), c)), b.each(c, function(c) {
                        "undefined" == typeof a.model.getLayer(c) && a.model.getLayers().add(new a.layerModels.custom({
                            id: c,
                            title: "",
                            category: "custom",
                            source: "custom",
                            type: "mixed"
                        }, {
                            collection: a.model.getLayers()
                        })), a.model.getLayer(c).setEdit(c === a.model.getCustomEdit());
                        var d = b.findWhere(a.model.getCustomData(!0), {
                            id: c
                        });
                        a.model.getLayer(c).setCustomData(d)
                    })
                })
            },
            routeChanged: function() {
                this.model.pushHistory({
                    fragment: c.history.fragment
                }), this.render()
            },
            serverStateIdChanged: function() {
                this.model.getRouter().queryUpdate({
                    modal: "print",
                    modalid: this.model.getServerStateId()
                })
            },
            printUrlChanged: function() {
                this.views.modal.model.setPrintURL(this.model.getPrintURL())
            }
        });
        return H
    }), define("models/ContentCollection", ["jquery", "underscore", "backbone"], function(a, b, c) {
        var d = c.Collection.extend({});
        return d
    }), define("models/OceanModel", ["jquery", "underscore", "backbone", "./ContentModel"], function(a, b, c, d) {
        var e = d.extend({
            initialize: function(a) {
                this.options = a || {}, this.isContentLoading = !1, this.isContentLoaded = !1;
                var b = "/ocean/" + this.id + "/";
                this.set("url", b)
            },
            getTitle: function() {
                return tlang.oceans[this.id]
            },
            getMapview: function() {
                return this.attributes.mapview
            },
            getMarker: function() {
                return this.attributes.marker.split("|").reverse()
            }
        });
        return e
    }), define("models/StoryModel", ["jquery", "underscore", "backbone", "./ContentModel"], function(a, b, c, d) {
        var e = d.extend({
            initialize: function(a) {
                this.options = a || {}, this.isContentLoading = !1, this.isContentLoaded = !1;
                var b = "/story/" + this.id + "/";
                this.set("url", b)
            },
            getTitle: function() {
                return this.attributes.title[lang]
            },
            getOceanId: function() {
                return this.attributes.ocean
            },
            getMapview: function() {
                return this.attributes.mapview
            },
            getMarker: function() {
                return this.attributes.marker.split("|").reverse()
            }
        });
        return e
    }), define("models/PageModel", ["jquery", "underscore", "backbone", "./ContentModel"], function(a, b, c, d) {
        var e = d.extend({
            initialize: function(a) {
                this.options = a || {}, this.isContentLoading = !1, this.isContentLoaded = !1, "undefined" === this.attributes.parent && (this.attributes.parent = this.id);
                var b = "/page/" + this.id + "/";
                this.set("url", b)
            },
            getTitle: function() {
                return this.attributes.title[lang]
            },
            getParent: function() {
                return this.attributes.parent
            }
        });
        return e
    }), define("components/app/AppModel", ["jquery", "underscore", "backbone", "jsonpack", "models/ContentCollection", "models/OceanModel", "models/StoryModel", "models/PageModel"], function(a, b, c, d, e, f, g, h) {
        var i = c.Model.extend({
            initialize: function(b) {
                this.options = b || {}, this.set("appConfigLoaded", !1), this.set("layersConfigLoaded", !1), this.set("mapConfigLoaded", !1), this.set("layersConfigured", !1);
                var c = this;
                a.ajax({
                    dataType: "json",
                    url: this.attributes.baseurl + "/" + this.attributes.configPath,
                    success: function(a) {
                        c.setConfig(a[0]), c.initModels()
                    },
                    error: function() {
                        console.log("error loading app config")
                    }
                }), window.systemapic = {
                    ready: function() {
                        return c.mapReady()
                    },
                    version: "0.4",
                    app: this,
                    style: "color: blue; font-weight: bold"
                }
            },
            setConfig: function(a) {
                return this.set("config", a)
            },
            getConfig: function() {
                return this.attributes.config
            },
            initModels: function() {
                this.setPages(new e(this.getConfig().pages, {
                    model: h
                })), this.setOceans(new e(this.getConfig().oceans, {
                    model: f
                })), this.setStories(new e(this.getConfig().stories, {
                    model: g
                }))
            },
            storeMapStateOnServer: function(a) {
                a = "undefined" != typeof a && a, a && this.set("printURL", "loading");
                var c = Math.random().toString(36).slice(-8);
                this.set("serverStateId", c);
                var d = "http://www.rom.on.ca/wwf/#!" + window.location.href.split("#!")[1] + "&mode=print",
                    e = b.clone(this.attributes.route);
                "undefined" != typeof e.query && (e.query = b.clone(e.query), delete e.query.print, delete e.query.modal, delete e.query.modalid);
                var f = JSON.stringify({
                        map: c,
                        state: {
                            map_state: e,
                            snapshot: a,
                            print_url: d
                        }
                    }),
                    g = {
                        json: f,
                        url: this.attributes.serverURL + "set"
                    };
                return this.request(g, function(b, d) {
                    return b || !d ? console.error("Something went wrong: ", b || "No response data.") : (console.log("%cSaved state to server, got this response: ", systemapic.style, d), this.set("serverStateId", c), a && this.getScreenshotFromServer(c, function(a, b) {
                        return a ? console.error("Something went wrong: ", a) : void this.set("printURL", b)
                    }.bind(this)), void 0)
                }.bind(this)), c
            },
            getPrintURL: function() {
                return this.attributes.printURL
            },
            setPrintURL: function(a) {
                this.set("printURL", a)
            },
            getMapStateFromServer: function(a, b) {
                var c = JSON.stringify({
                        map: a
                    }),
                    d = {
                        url: this.attributes.serverURL + "get",
                        json: c
                    };
                return this.request(d, function(a, c) {
                    return a ? console.error("Something went wrong:", a) : (console.log("%cGot saved state from server: ", systemapic.style, c), c = this.parse(c), b && b(c.err, c.data), void 0)
                }.bind(this)), this
            },
            getScreenshotFromServer: function(a, b) {
                var c = JSON.stringify({
                        map: a,
                        width: 3300,
                        height: 2550,
                        quality: 100
                    }),
                    d = {
                        url: this.attributes.serverURL + "print",
                        json: c
                    };
                return this.request(d, function(a, c) {
                    if (a) return console.error("Something went wrong: ", a);
                    var d = this.parse(c);
                    if (console.log("%cReceived data: ", systemapic.style, d), !d) return console.error("Something went wrong: no data.");
                    if (d.err) return console.error("Something went wrong: ", d.err);
                    var e = this.attributes.serverURL + "print/" + d.print_id + ".jpeg";
                    console.log("%cGET screenshot at this url:", systemapic.style, e), b && b(null, e)
                }.bind(this)), this
            },
            request: function(a, b) {
                var c = a.url,
                    d = a.json;
                if (!c || !d) return console.error("Missing parameters!");
                var e = new XMLHttpRequest;
                e.open("POST", c, !0), e.setRequestHeader("Content-type", "application/json"), e.onreadystatechange = function() {
                    4 == e.readyState && (200 == e.status ? b && b(null, e.responseText) : b && b(e.status))
                }, e.send(d)
            },
            getServerStateId: function() {
                return this.attributes.serverStateId
            },
            parse: function(a) {
                try {
                    var b = JSON.parse(a)
                } catch (b) {
                    console.error("error parsing: ", b, a);
                    var b = !1
                }
                return b
            },
            validateRouter: function(a) {
                var c = this.getActiveModule(),
                    d = this.get("router");
                if ("" === c) d.update({
                    route: "home"
                }), a(!1);
                else if ("undefined" == typeof this.getQuery().view) d.queryUpdate({
                    view: this.getMapviewForModule(!0)
                }), a(!1);
                else {
                    var e = this.getActiveLayerIds(),
                        f = this.getLayerIdsByModule(c.id),
                        g = b.intersection(e, f);
                    if (g.length !== f.length) d.queryUpdate({
                        layers: b.union(e, f)
                    }), a(!1);
                    else {
                        var h = !0;
                        if ("ocean" === c.id) {
                            var i = this.getActiveOcean(),
                                e = this.getActiveLayerIds(),
                                j = this.getLayerIdsByOcean(i.id),
                                k = b.intersection(e, j);
                            k.length !== j.length && (d.queryUpdate({
                                layers: b.union(e, j)
                            }), h = !1)
                        }
                        if (h) {
                            var l = b.difference(b.keys(this.getQuery()), c.query_allow);
                            l.length > 0 ? (d.queryAllow(c.query_allow, !0), a(!1)) : a(!0)
                        } else a(!1)
                    }
                }
            },
            getViews: function() {
                return this.attributes.views
            },
            getRouter: function() {
                return this.attributes.router
            },
            getBaseURL: function() {
                return this.attributes.baseurl
            },
            setRoute: function(a) {
                return this.set("route", {
                    route: a.route,
                    path: a.path,
                    query: a.query
                }), this
            },
            getDeFactoRoute: function() {
                return this.attributes.subpage ? this.attributes.sourcePath.route : this.attributes.route.route
            },
            isSubpage: function(a) {
                return "undefined" == typeof a ? this.attributes.subpage : void this.set("subpage", a)
            },
            getHistory: function() {
                return this.attributes.history
            },
            getHistoryWithoutPages: function() {
                return b.filter(this.attributes.history, function(a) {
                    return !a.fragment.startsWith("!/page")
                })
            },
            pushHistory: function(a) {
                this.attributes.history.push(a)
            },
            getRoute: function() {
                return this.attributes.route.route
            },
            getPath: function() {
                return this.attributes.route.path
            },
            getQuery: function() {
                return this.attributes.route.query
            },
            getSourcePath: function() {
                return this.attributes.sourcePath
            },
            setSourceQuery: function(a) {
                this.attributes.sourcePath.query = a
            },
            getActiveCategory: function() {
                return "undefined" != typeof this.attributes.route.query.cat ? this.attributes.route.query.cat : ""
            },
            setMode: function(a) {
                this.set("mode", a)
            },
            getMode: function() {
                return this.attributes.mode
            },
            appConfigured: function() {
                return "undefined" != typeof this.attributes.config
            },
            isViewActive: function(a) {
                var b = {
                        home: ["home", "map"],
                        ocean: ["ocean", "map"],
                        story: ["story", "map", "key"],
                        layers: ["layers", "map", "key"],
                        page: ["pages"]
                    },
                    c = {
                        modal: "undefined" != typeof this.getQuery().modal
                    };
                return b[this.getDeFactoRoute()].indexOf(a) >= 0 || "undefined" != typeof c[a] && c[a]
            },
            getModule: function(a) {
                return "undefined" != typeof a ? b.findWhere(this.attributes.config.modules, {
                    id: a
                }) : this.getActiveModule()
            },
            getActiveModule: function() {
                var a = this.getRoute();
                return b.contains(b.pluck(this.attributes.config.modules, "id"), a) ? b.findWhere(this.attributes.config.modules, {
                    id: a
                }) : ""
            },
            setPages: function(a) {
                this.set("pages", a)
            },
            getPages: function() {
                return this.attributes.pages
            },
            getActivePage: function() {
                return this.attributes.pages.findWhere({
                    id: this.getPath()
                })
            },
            layersLoading: function() {
                return "undefined" == typeof this.attributes.layerCollection || this.attributes.layerCollection.isLoading()
            },
            layerLoaded: function(a) {
                return this.getLayers().get(a).isLoaded()
            },
            layersConfigLoaded: function() {
                return "undefined" != typeof this.attributes.layersConfig
            },
            layersConfigured: function(a) {
                return "undefined" == typeof a ? this.attributes.layersConfigured : void this.set("layersConfigured", a)
            },
            loadLayersConfig: function() {
                var b = this;
                a.ajax({
                    dataType: "json",
                    url: this.attributes.baseurl + "/" + this.attributes.config.layersConfig,
                    success: function(a) {
                        b.set("layersConfig", a)
                    },
                    error: function() {
                        console.log("error loading layer config")
                    }
                })
            },
            getLayersConfig: function() {
                return this.attributes.layersConfig
            },
            getLayer: function(a) {
                return this.getLayers().get(a)
            },
            getLayers: function() {
                return this.attributes.layerCollection
            },
            setLayers: function(a) {
                return this.set("layerCollection", a), this
            },
            setActiveLayersFromQuery: function() {
                return this.attributes.layerCollection.setActive(this.getActiveLayerIds()), this
            },
            getActiveLayers: function() {
                return this.attributes.layerCollection.byActive()
            },
            getActiveLayerIds: function() {
                var a = this.attributes.route.query;
                return "undefined" != typeof a.layers ? a.layers : []
            },
            getActiveLayerId: function() {
                return this.isLayerItemActive() ? this.getPath() : ""
            },
            isLayerItemActive: function() {
                return this.isViewActive("layers") && "home" !== this.getPath()
            },
            getLayerIdsByModule: function(a) {
                var c = "undefined" != typeof a ? this.getModule(a) : this.getActiveModule();
                return "undefined" != typeof c.layers || "" === c.layers ? b.map(c.layers.split(","), function(a) {
                    return a.trim()
                }) : []
            },
            getLayerIdsByOcean: function(a) {
                var c = "undefined" != typeof a ? this.getOcean(a) : this.getActiveOcean();
                return "undefined" != typeof c.get("layers") || "" === c.get("layers") ? b.map(c.get("layers").split(","), function(a) {
                    return a.trim()
                }) : []
            },
            getLayerIdsByGroup: function(a) {
                return b.pluck(this.getLayers().byGroup(a).models, "id")
            },
            preloadLayers: function(a) {
                b.each(a, function(a) {
                    var b = this.attributes.layerCollection.get(a);
                    this.attributes.views.map.model.preloadLayer(b)
                }, this)
            },
            getKeyLayers: function() {
                return this.attributes.layerCollection.byActiveKey()
            },
            getCustomData: function(a) {
                a = "undefined" != typeof a && a;
                var b = this.attributes.route.query,
                    c = "undefined" != typeof b.cdata ? b.cdata : d.pack([]);
                return a ? d.unpack(c) : c
            },
            getCustomLayerIds: function() {
                var a = this.attributes.route.query;
                return "undefined" != typeof a.clayers ? a.clayers : []
            },
            getCustomEdit: function() {
                var a = this.attributes.route.query;
                return "undefined" != typeof a.cedit ? a.cedit : ""
            },
            loadMapConfig: function() {
                var b = this;
                a.ajax({
                    dataType: "json",
                    url: this.attributes.baseurl + "/" + this.attributes.config.mapConfig,
                    success: function(a) {
                        b.set("mapConfig", a[0]), b.set("mapConfigLoaded", !0)
                    },
                    error: function() {
                        console.log("error loading map config")
                    }
                })
            },
            mapConfigLoaded: function() {
                return this.attributes.mapConfigLoaded
            },
            getMapConfig: function() {
                return this.attributes.mapConfig
            },
            mapReady: function() {
                return this.appConfigured() && this.layersConfigured() && this.mapConfigured() && !this.layersLoading()
            },
            mapConfigured: function() {
                return "undefined" != typeof this.attributes.views.map && this.attributes.views.map.model.mapConfigured()
            },
            getActiveMapview: function(a) {
                a = "undefined" != typeof a && a;
                var b = "undefined" != typeof this.attributes.route.query.view ? this.attributes.route.query.view : "default";
                return a ? b : this.toMapviewObject(b)
            },
            toMapviewObject: function(a) {
                if ("undefined" != typeof a) {
                    var b = a.split("||");
                    if (2 === b.length) {
                        var a = b[0].split("|"),
                            c = b[1].split("|");
                        return 3 === a.length && 2 === c.length ? {
                            center: {
                                lat: parseFloat(a[0]),
                                lng: parseFloat(a[1])
                            },
                            zoom: parseFloat(a[2]),
                            dimensions: [parseFloat(c[0]), parseFloat(c[1])]
                        } : null
                    }
                    return a
                }
                return null
            },
            getMapviewForModule: function(a) {
                a = "undefined" != typeof a && a;
                var c, b = this.getActiveModule();
                switch (b.id) {
                    case "home":
                        c = b.mapview;
                        break;
                    case "story":
                        c = this.getActiveStory().getMapview();
                        break;
                    case "ocean":
                        c = this.getActiveOcean().getMapview();
                        break;
                    default:
                        c = this.getActiveMapview(!0)
                }
                return a ? c : this.toMapviewObject(c)
            },
            getOcean: function(a) {
                return this.attributes.oceans.findWhere({
                    id: a
                })
            },
            setOceans: function(a) {
                this.set("oceans", a)
            },
            getOceans: function() {
                return this.attributes.oceans
            },
            getActiveOcean: function() {
                return this.getOcean(this.getActiveOceanId())
            },
            getActiveOceanId: function() {
                return "home" === this.attributes.route.route ? "" : "ocean" === this.attributes.route.route ? this.attributes.route.path : "story" === this.attributes.route.route ? this.getActiveStory().getOceanId() : "undefined" != typeof this.attributes.route.query.ocean ? this.attributes.route.query.ocean : ""
            },
            getNextOceanId: function() {
                var a = this.getActiveOceanId(),
                    c = b.pluck(this.attributes.oceans.models, "id"),
                    d = c.indexOf(a),
                    e = d === c.length - 1 ? 0 : d + 1;
                return c[e]
            },
            getPreviousOceanId: function() {
                var a = this.getActiveOceanId(),
                    c = b.pluck(this.attributes.oceans.models, "id"),
                    d = c.indexOf(a),
                    e = 0 === d ? c.length - 1 : d - 1;
                return c[e]
            },
            getStory: function(a) {
                return this.attributes.stories.findWhere({
                    id: a
                })
            },
            setStories: function(a) {
                this.set("stories", a)
            },
            getStories: function() {
                return this.attributes.stories
            },
            getStoriesByOcean: function(a) {
                return a = "undefined" != typeof a ? a : this.getActiveOceanId(), this.attributes.stories.where({
                    ocean: a
                })
            },
            getActiveStory: function() {
                return this.getStory(this.getActiveStoryId())
            },
            getActiveStoryId: function() {
                return "story" === this.attributes.route.route ? this.attributes.route.path : ""
            },
            getNextStoryId: function() {
                var a = this.getActiveStoryId(),
                    c = b.pluck(this.attributes.stories.where({
                        ocean: this.getActiveOceanId()
                    }), "id"),
                    d = c.indexOf(a),
                    e = d === c.length - 1 ? 0 : d + 1;
                return c[e]
            },
            getPreviousStoryId: function() {
                var a = this.getActiveStoryId(),
                    c = b.pluck(this.attributes.stories.where({
                        ocean: this.getActiveOceanId()
                    }), "id"),
                    d = c.indexOf(a),
                    e = 0 === d ? c.length - 1 : d - 1;
                return c[e]
            }
        });
        return i
    }), define("router", ["jquery", "underscore", "backbone", "jquery.deparam", "components/app/AppView", "components/app/AppModel"], function(a, b, c, d, e, f) {
        var g = {},
            h = c.Router.extend({
                routes: {
                    "": "root",
                    "/": "root",
                    "!": "root",
                    "!/": "root",
                    "!/home": "home",
                    "!/home/": "home",
                    "!/ocean/*path": "ocean",
                    "!/story/*path": "story",
                    "!/id/:id": "id",
                    "!/layers": "layers",
                    "!/layers/": "layers",
                    "!/layers/*path": "layers",
                    "!/page/:page": "page"
                },
                resetApp: function(a) {
                    g.model.isSubpage() ? window.location.href = "http://" + window.location.host + g.model.getBaseURL() + ("en" === lang ? "" : "/" + lang) + "/" : this.navigate("", {
                        trigger: !0
                    })
                },
                goToFragment: function(a) {
                    this.navigate(a, {
                        trigger: !0
                    })
                },
                queryAllow: function(a) {
                    this.queryDelete(b.difference(b.keys(g.model.getQuery()), a))
                },
                queryDelete: function(a) {
                    var c = b.clone(g.model.getQuery());
                    "string" == typeof a ? delete c[a] : b.each(a, function(a) {
                        delete c[a]
                    }), this.update({
                        query: c,
                        replace: !0
                    })
                },
                queryUpdate: function(a, c) {
                    var c = "undefined" == typeof c || c,
                        a = b.extend({}, g.model.getQuery(), a);
                    return this.update({
                        query: a,
                        trigger: c,
                        replace: !0
                    }), a
                },
                queryToggle: function(a, c, d) {
                    var c = "undefined" == typeof c || c,
                        d = "undefined" != typeof d && d,
                        e = b.clone(g.model.getQuery());
                    return "object" == typeof a ? b.each(a, function(a, c) {
                        b.contains(b.keys(e), c) && e[c] === a ? delete e[c] : e[c] = a
                    }, this) : b.contains(b.keys(e), a) ? delete e[a] : e[a] = "true", c && this.update({
                        query: e,
                        link: d
                    }), e
                },
                update: function(c) {
                    var d = "undefined" != typeof c.link && c.link,
                        e = "undefined" == typeof c.trigger || c.trigger,
                        f = "undefined" != typeof c.replace && c.replace,
                        h = "undefined" != typeof c.extendQuery && c.extendQuery,
                        i = "undefined" != typeof c.route ? c.route : g.model.getRoute();
                    i = "" !== i ? "/" + i : "";
                    var j = "undefined" != typeof c.path ? c.path : "" !== g.model.getPath() ? g.model.getPath() : "";
                    j = "" !== j ? "/" + j : "";
                    var k = "undefined" != typeof c.query ? h ? b.extend({}, g.model.getQuery(), c.query) : c.query : g.model.getQuery();
                    b.each(b.clone(k), function(a, b) {
                        (!a.length || 1 === a.length && "" === a[0] || "^^^@]" === a) && delete k[b]
                    }), k = a.param(k), k = "" !== k ? "?" + k : "", d && g.model.isSubpage() ? window.location.href = "http://" + window.location.host + g.model.getBaseURL() + ("en" === lang ? "" : "/" + lang) + "/#!" + i + j + k : this.navigate("!" + i + j + k, {
                        trigger: e,
                        replace: f
                    })
                },
                goBack: function() {
                    window.history.back()
                }
            }),
            i = function(b) {
                g.Router = new h;
                var l, m, d = url.replace(/\/$/, "").replace(/^\//, "").split("/"),
                    i = document.URL.match(/conf=([^&;]+?)(&|#|;|$)/),
                    j = i ? i[1] : "appConfig",
                    k = "app/config/" + j + ".json.js";
                d[0] === lang ? (l = d.length > 1 ? d[1] : "", m = d.length > 2 ? d[2] : "") : (l = d[0], m = d.length > 1 ? d[1] : ""), g.model = g.model || new f({
                    sourcePath: {
                        route: l,
                        path: m,
                        query: {}
                    },
                    views: {},
                    history: [],
                    baseurl: baseurl,
                    configPath: k,
                    router: g.Router,
                    route: {
                        route: "",
                        path: "",
                        query: {}
                    },
                    serverURL: "https://printserver.wwf.ca/map/"
                }), "" === g.model.getSourcePath().route || g.model.getSourcePath().route === lang && "" === g.model.getSourcePath().path ? g.model.isSubpage(!1) : g.model.isSubpage(!0), g.Router.on("route:root", function() {
                    if (g.model.isSubpage()) {
                        var b = g.model.getSourcePath();
                        g.model.setRoute({
                            route: b.route,
                            path: b.path,
                            query: b.query
                        }), this.navigate("!/" + b.route + "/" + b.path + "?" + a.param(b.query), {
                            trigger: !0,
                            replace: !0
                        })
                    } else this.navigate("!/home", {
                        trigger: !0,
                        replace: !0
                    })
                }), g.Router.on("route:home", function(b) {
                    g.model.setRoute({
                        route: "home",
                        path: "",
                        query: null !== b && "undefined" != typeof b ? a.deparam(b) : {}
                    }), "undefined" == typeof g.view && (g.view = new e({
                        model: g.model
                    }))
                }), g.Router.on("route:id", function(b) {
                    var c = this;
                    g.model.getMapStateFromServer(b, function(b, d) {
                        if (b) return console.error("Something went wrong: ", b);
                        var e = d.state.map_state;
                        c.navigate("!/" + e.route + "/" + e.path + "?" + a.param(e.query), {
                            trigger: !0,
                            replace: !0
                        })
                    })
                }), g.Router.on("route:ocean", function(b, c) {
                    b = null !== b && "undefined" != typeof b ? b : "", c = null !== c && "undefined" != typeof c ? a.deparam(c) : {}, g.model.setRoute({
                        route: "ocean",
                        path: b,
                        query: c
                    }), "undefined" == typeof g.view && (g.view = new e({
                        model: g.model
                    }))
                }), g.Router.on("route:story", function(b, c) {
                    b = null !== b && "undefined" != typeof b ? b : "", c = null !== c && "undefined" != typeof c ? a.deparam(c) : {}, g.model.setRoute({
                        route: "story",
                        path: b,
                        query: c
                    }), "undefined" == typeof g.view && (g.view = new e({
                        model: g.model
                    }))
                }), g.Router.on("route:layers", function(b, c) {
                    b = null !== b && "undefined" != typeof b ? b : "home", c = null !== c && "undefined" != typeof c ? a.deparam(c) : {}, g.model.setRoute({
                        route: "layers",
                        path: b,
                        query: c
                    }), "undefined" == typeof g.view && (g.view = new e({
                        model: g.model
                    }))
                }), g.Router.on("route:page", function(b, c) {
                    g.model.setRoute({
                        route: "page",
                        path: null !== b && "undefined" != typeof b ? b : "about",
                        query: null !== c && "undefined" != typeof c ? a.deparam(c) : {}
                    }), "undefined" == typeof g.view && (g.view = new e({
                        model: g.model
                    }))
                }), c.history.start(), g.model.pushHistory({
                    fragment: c.history.fragment
                })
            };
        return {
            initialize: i
        }
    }), define("app", ["jquery", "underscore", "backbone", "router"], function(a, b, c, d) {
        var e = function() {
            d.initialize()
        };
        return {
            initialize: e
        }
    }),
    function() {
        for (var a, b = function() {}, c = ["assert", "clear", "count", "debug", "dir", "dirxml", "error", "exception", "group", "groupCollapsed", "groupEnd", "info", "log", "markTimeline", "profile", "profileEnd", "table", "time", "timeEnd", "timeStamp", "trace", "warn"], d = c.length, e = window.console = window.console || {}; d--;) a = c[d], e[a] || (e[a] = b)
    }(), hexToRgb = function(a) {
        return a = a.replace("#", ""), 3 === a.length && (a = a.split(""), a = a[0] + a[0] + a[1] + a[1] + a[2] + a[2]), [parseInt(a.substr(0, 2), 16), parseInt(a.substr(2, 2), 16), parseInt(a.substr(4, 2), 16), 255]
    }, String.prototype.colorToRgb = function() {
        var a = this.toString();
        return "#" === a.charAt(0) ? hexToRgb(a) : colorToRGBA(a)
    }, Array.prototype.filter || (Array.prototype.filter = function(a) {
        var b = this.length >>> 0;
        if ("function" != typeof a) throw new TypeError;
        for (var c = [], d = arguments[1], e = 0; e < b; e++)
            if (e in this) {
                var f = this[e];
                a.call(d, f, e, this) && c.push(f)
            }
        return c
    }), String.prototype.startsWith || (String.prototype.startsWith = function(a, b) {
        return b = b || 0, this.lastIndexOf(a, b) === b
    }), String.linkify || (String.prototype.linkify = function() {
        var a = /\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim,
            b = /(^|[^\/])(www\.[\S]+(\b|$))/gim,
            c = /[\w.]+@[a-zA-Z_-]+?(?:\.[a-zA-Z]{2,6})+/gim;
        return this.replace(a, '<a href="$&">$&</a>').replace(b, '$1<a href="http://$2">$2</a>').replace(c, '<a href="mailto:$&">$&</a>')
    }), require.config({
        paths: {
            domReady: "libs/domReady",
            jquery: "libs/jquery",
            "jquery.deparam": "libs/jquery.deparam",
            "jquery.waypoints": "libs/jquery.waypoints",
            showdown: "libs/showdown",
            jsonpack: "libs/jsonpack",
            "jquery.spectrum": "libs/spectrum",
            underscore: "libs/underscore",
            backbone: "libs/backbone",
            bootstrap: "libs/bootstrap",
            leaflet: "libs/leaflet-src",
            "esri.leaflet": "libs/esri-leaflet-src",
            "leaflet.draw": "libs/leaflet.draw-custom",
            "leaflet.label": "libs/leaflet.label",
            "leaflet.markercluster": "libs/leaflet.markercluster",
            "proj4.leaflet": "libs/proj4-leaflet",
            proj4: "libs/proj4-src_infinity",
            topojson: "libs/topojson",
            templates: "templates"
        },
        shim: {
            "jquery.waypoints": {
                deps: ["jquery"]
            },
            "jquery.spectrum": {
                deps: ["jquery"]
            },
            "jquery.deparam": {
                deps: ["jquery"]
            },
            "esri.leaflet": {
                deps: ["leaflet"]
            },
            "leaflet.draw": {
                deps: ["leaflet"]
            },
            "leaflet.label": {
                deps: ["leaflet"]
            },
            "leaflet.markercluster": {
                deps: ["leaflet"]
            },
            "proj4.leaflet": {
                deps: ["leaflet", "proj4"]
            },
            leaflet: {
                exports: "L"
            },
            proj4: {
                exports: "proj4"
            }
        }
    }), require(["app"], function(a) {
        googletagmanager(), a.initialize()
    }), define("main", function() {}), $(document).on("click", "#key .reveal-on-hover", function() {
        $(this).toggleClass("popup-key")
    }), $(document).ready(function() {
        $("#application").click(function() {
            $("#key .reveal-on-hover.popup-key").length && $("#key .reveal-on-hover.popup-key")[0].click()
        });
    });

window.onload = function() {
	resetTimer();
	resizeHack();
};
document.onmousedown = function(e) {
	e.preventDefault();
	resetTimer();
};
document.onkeypress = function(e) {
	e.preventDefault();
	resetTimer();
};
document.ontouchstart = function(e) {
	e.preventDefault();
	resetTimer();
};
document.ontouchmove = function(e) {
	e.preventDefault();
	resetTimer();
};
document.ontouchend = function(e) {
	e.preventDefault();
	resetTimer();
};
document.ondragstart = function(e) {
	e.preventDefault();
	resetTimer();
};
document.ondragend = function(e) {
	e.preventDefault();
	resetTimer();
};

function refresh() {
location.href = 'https://romtoronto-map.github.io/#!/layers/home?view=50.3765|-59.6899|6||1312|974&ocean=atlantic&cat=wildlife'
}

function resetTimer() {
	var t;
	clearTimeout(t);
	t = setTimeout(refresh, 60000)
}

function resizeHack() {
var htmlWidth = document.documentElement.clientWidth;
var screenWidth = 1920;
var appElement = document.getElementById("application");
appElement.style.zoom = htmlWidth / screenWidth;
}

$(window).resize(function() {
	resizeHack();
});