/*! jQuery v1.11.3 | (c) 2005, 2015 jQuery Foundation, Inc. | jquery.org/license */

//     (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors

//     Underscore may be freely distributed under the MIT license.

/*
 Copyright (c) 2013, Rodrigo González, Sapienlab All Rights Reserved.
 Available via MIT LICENSE. See https://github.com/roro89/jsonpack/blob/master/LICENSE.md for details.
 */

/**
 * @license RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/*!
 * Bootstrap v3.3.5 (http://getbootstrap.com)
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */

/*!
 * Generated using the Bootstrap Customizer (http://getbootstrap.com/customize/?id=e3cc0d8ed953b11a7c091153294b2c25)
 * Config saved to config.json and https://gist.github.com/e3cc0d8ed953b11a7c091153294b2c25
 */

/* ========================================================================
 * Bootstrap: carousel.js v3.3.6
 * http://getbootstrap.com/javascript/#carousel
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: tooltip.js v3.3.6
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: collapse.js v3.3.6
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: transition.js v3.3.6
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/*
 RequireJS text 0.27.0 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/

/*
 Leaflet, a JavaScript library for mobile-friendly interactive maps. http://leafletjs.com
 (c) 2010-2013, Vladimir Agafonkin
 (c) 2010-2011, CloudMade
*/

/*!
Waypoints - 4.0.0
Copyright © 2011-2015 Caleb Troughton
Licensed under the MIT license.
https://github.com/imakewebthings/waypoints/blog/master/licenses.txt
*/

/*! esri-leaflet - v1.0.0 - 2015-07-10
 *   Copyright (c) 2015 Environmental Systems Research Institute, Inc.
 *   Apache License*/

/*
	Leaflet.draw, a plugin that adds drawing and editing tools to Leaflet powered maps.
	(c) 2012-2013, Jacob Toye, Smartrak

	https://github.com/Leaflet/Leaflet.draw
	http://leafletjs.com
	https://github.com/jacobtoye
*/

/*
	Leaflet.label, a plugin that adds labels to markers and vectors for Leaflet powered maps.
	(c) 2012-2013, Jacob Toye, Smartrak

	https://github.com/Leaflet/Leaflet.label
	http://leafletjs.com
	https://github.com/jacobtoye
*/

/*
 Leaflet.markercluster, Provides Beautiful Animated Marker Clustering functionality for Leaflet, a JS library for interactive maps.
 https://github.com/Leaflet/Leaflet.markercluster
 (c) 2012-2013, Dave Leaver, smartrak
*/

/* Copyright (c) 2012 the authors listed at the following URL, and/or
the authors of referenced articles or incorporated external code:
http://en.literateprograms.org/Quickhull_(Javascript)?action=history&offset=20120410175256

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

Retrieved from: http://en.literateprograms.org/Quickhull_(Javascript)?oldid=18434
*/

/*! showdown 17-05-2016 */

/**
 * matchRecursiveRegExp
 *
 * (c) 2007 Steven Levithan <stevenlevithan.com>
 * MIT License
 *
 * Accepts a string to search, a left and right format delimiter
 * as regex patterns, and optional regex flags. Returns an array
 * of matches, allowing nested instances of left/right delimiters.
 * Use the "g" flag to return all matches, otherwise only the
 * first is returned. Be careful to ensure that the left and
 * right format delimiters produce mutually exclusive matches.
 * Backreferences are not supported within the right delimiter
 * due to how it is internally combined with the left delimiter.
 * When matching strings whose format delimiters are unbalanced
 * to the left or right, the output is intentionally as a
 * conventional regex library with recursion support would
 * produce, e.g. "<<x>" and "<x>>" both produce ["x"] when using
 * "<" and ">" as the delimiters (both strings contain a single,
 * balanced instance of "<x>").
 *
 * examples:
 * matchRecursiveRegExp("test", "\\(", "\\)")
 * returns: []
 * matchRecursiveRegExp("<t<<e>><s>>t<>", "<", ">", "g")
 * returns: ["t<<e>><s>", ""]
 * matchRecursiveRegExp("<div id=\"x\">test</div>", "<div\\b[^>]*>", "</div>", "gi")
 * returns: ["test"]
 */

/**
 * Copyright (c) Mozilla Foundation http://www.mozilla.org/
 * This code is available under the terms of the MIT License
 */

function colorToRGBA(e) {
    var t, n;
    return t = document.createElement("canvas"), t.height = 1, t.width = 1, n = t.getContext("2d"), n.fillStyle = e, n.fillRect(0, 0, 1, 1), n.getImageData(0, 0, 1, 1).data
}

function numberWithCommas(e) {
    return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")
}

function isNumber(e) {
    return !isNaN(parseFloat(e)) && isFinite(e)
}

function convertToSlug(e) {
    return e.toLowerCase().replace(/ /g, "-").replace(/[^\w-]+/g, "")
}

function waitFor(e, t, n) {
    n = typeof n != "undefined" ? n : 100, e() ? t() : setTimeout(function() {
        waitFor(e, t)
    }, n)
}! function(e, t) {
    "object" == typeof module && "object" == typeof module.exports ? module.exports = e.document ? t(e, !0) : function(e) {
        if (!e.document) throw new Error("jQuery requires a window with a document");
        return t(e)
    } : t(e)
}("undefined" != typeof window ? window : this, function(e, t) {
    function g(e) {
        var t = "length" in e && e.length,
            n = h.type(e);
        return "function" === n || h.isWindow(e) ? !1 : 1 === e.nodeType && t ? !0 : "array" === n || 0 === t || "number" == typeof t && t > 0 && t - 1 in e
    }

    function S(e, t, n) {
        if (h.isFunction(t)) return h.grep(e, function(e, r) {
            return !!t.call(e, r, e) !== n
        });
        if (t.nodeType) return h.grep(e, function(e) {
            return e === t !== n
        });
        if ("string" == typeof t) {
            if (E.test(t)) return h.filter(t, e, n);
            t = h.filter(t, e)
        }
        return h.grep(e, function(e) {
            return h.inArray(e, t) >= 0 !== n
        })
    }

    function A(e, t) {
        do e = e[t]; while (e && 1 !== e.nodeType);
        return e
    }

    function _(e) {
        var t = M[e] = {};
        return h.each(e.match(O) || [], function(e, n) {
            t[n] = !0
        }), t
    }

    function P() {
        T.addEventListener ? (T.removeEventListener("DOMContentLoaded", H, !1), e.removeEventListener("load", H, !1)) : (T.detachEvent("onreadystatechange", H), e.detachEvent("onload", H))
    }

    function H() {
        (T.addEventListener || "load" === event.type || "complete" === T.readyState) && (P(), h.ready())
    }

    function q(e, t, n) {
        if (void 0 === n && 1 === e.nodeType) {
            var r = "data-" + t.replace(I, "-$1").toLowerCase();
            if (n = e.getAttribute(r), "string" == typeof n) {
                try {
                    n = "true" === n ? !0 : "false" === n ? !1 : "null" === n ? null : +n + "" === n ? +n : F.test(n) ? h.parseJSON(n) : n
                } catch (i) {}
                h.data(e, t, n)
            } else n = void 0
        }
        return n
    }

    function R(e) {
        var t;
        for (t in e)
            if (("data" !== t || !h.isEmptyObject(e[t])) && "toJSON" !== t) return !1;
        return !0
    }

    function U(e, t, r, i) {
        if (h.acceptData(e)) {
            var s, o, u = h.expando,
                a = e.nodeType,
                f = a ? h.cache : e,
                l = a ? e[u] : e[u] && u;
            if (l && f[l] && (i || f[l].data) || void 0 !== r || "string" != typeof t) return l || (l = a ? e[u] = n.pop() || h.guid++ : u), f[l] || (f[l] = a ? {} : {
                toJSON: h.noop
            }), ("object" == typeof t || "function" == typeof t) && (i ? f[l] = h.extend(f[l], t) : f[l].data = h.extend(f[l].data, t)), o = f[l], i || (o.data || (o.data = {}), o = o.data), void 0 !== r && (o[h.camelCase(t)] = r), "string" == typeof t ? (s = o[t], null == s && (s = o[h.camelCase(t)])) : s = o, s
        }
    }

    function z(e, t, n) {
        if (h.acceptData(e)) {
            var r, i, s = e.nodeType,
                o = s ? h.cache : e,
                u = s ? e[h.expando] : h.expando;
            if (o[u]) {
                if (t && (r = n ? o[u] : o[u].data)) {
                    h.isArray(t) ? t = t.concat(h.map(t, h.camelCase)) : t in r ? t = [t] : (t = h.camelCase(t), t = t in r ? [t] : t.split(" ")), i = t.length;
                    while (i--) delete r[t[i]];
                    if (n ? !R(r) : !h.isEmptyObject(r)) return
                }(n || (delete o[u].data, R(o[u]))) && (s ? h.cleanData([e], !0) : l.deleteExpando || o != o.window ? delete o[u] : o[u] = null)
            }
        }
    }

    function et() {
        return !0
    }

    function tt() {
        return !1
    }

    function nt() {
        try {
            return T.activeElement
        } catch (e) {}
    }

    function rt(e) {
        var t = it.split("|"),
            n = e.createDocumentFragment();
        if (n.createElement)
            while (t.length) n.createElement(t.pop());
        return n
    }

    function wt(e, t) {
        var n, r, i = 0,
            s = typeof e.getElementsByTagName !== B ? e.getElementsByTagName(t || "*") : typeof e.querySelectorAll !== B ? e.querySelectorAll(t || "*") : void 0;
        if (!s)
            for (s = [], n = e.childNodes || e; null != (r = n[i]); i++) !t || h.nodeName(r, t) ? s.push(r) : h.merge(s, wt(r, t));
        return void 0 === t || t && h.nodeName(e, t) ? h.merge([e], s) : s
    }

    function Et(e) {
        J.test(e.type) && (e.defaultChecked = e.checked)
    }

    function St(e, t) {
        return h.nodeName(e, "table") && h.nodeName(11 !== t.nodeType ? t : t.firstChild, "tr") ? e.getElementsByTagName("tbody")[0] || e.appendChild(e.ownerDocument.createElement("tbody")) : e
    }

    function xt(e) {
        return e.type = (null !== h.find.attr(e, "type")) + "/" + e.type, e
    }

    function Tt(e) {
        var t = vt.exec(e.type);
        return t ? e.type = t[1] : e.removeAttribute("type"), e
    }

    function Nt(e, t) {
        for (var n, r = 0; null != (n = e[r]); r++) h._data(n, "globalEval", !t || h._data(t[r], "globalEval"))
    }

    function Ct(e, t) {
        if (1 === t.nodeType && h.hasData(e)) {
            var n, r, i, s = h._data(e),
                o = h._data(t, s),
                u = s.events;
            if (u) {
                delete o.handle, o.events = {};
                for (n in u)
                    for (r = 0, i = u[n].length; i > r; r++) h.event.add(t, n, u[n][r])
            }
            o.data && (o.data = h.extend({}, o.data))
        }
    }

    function kt(e, t) {
        var n, r, i;
        if (1 === t.nodeType) {
            if (n = t.nodeName.toLowerCase(), !l.noCloneEvent && t[h.expando]) {
                i = h._data(t);
                for (r in i.events) h.removeEvent(t, r, i.handle);
                t.removeAttribute(h.expando)
            }
            "script" === n && t.text !== e.text ? (xt(t).text = e.text, Tt(t)) : "object" === n ? (t.parentNode && (t.outerHTML = e.outerHTML), l.html5Clone && e.innerHTML && !h.trim(t.innerHTML) && (t.innerHTML = e.innerHTML)) : "input" === n && J.test(e.type) ? (t.defaultChecked = t.checked = e.checked, t.value !== e.value && (t.value = e.value)) : "option" === n ? t.defaultSelected = t.selected = e.defaultSelected : ("input" === n || "textarea" === n) && (t.defaultValue = e.defaultValue)
        }
    }

    function Ot(t, n) {
        var r, i = h(n.createElement(t)).appendTo(n.body),
            s = e.getDefaultComputedStyle && (r = e.getDefaultComputedStyle(i[0])) ? r.display : h.css(i[0], "display");
        return i.detach(), s
    }

    function Mt(e) {
        var t = T,
            n = At[e];
        return n || (n = Ot(e, t), "none" !== n && n || (Lt = (Lt || h("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement), t = (Lt[0].contentWindow || Lt[0].contentDocument).document, t.write(), t.close(), n = Ot(e, t), Lt.detach()), At[e] = n), n
    }

    function jt(e, t) {
        return {
            get: function() {
                var n = e();
                if (null != n) return n ? void delete this.get : (this.get = t).apply(this, arguments)
            }
        }
    }

    function Vt(e, t) {
        if (t in e) return t;
        var n = t.charAt(0).toUpperCase() + t.slice(1),
            r = t,
            i = Xt.length;
        while (i--)
            if (t = Xt[i] + n, t in e) return t;
        return r
    }

    function $t(e, t) {
        for (var n, r, i, s = [], o = 0, u = e.length; u > o; o++) r = e[o], r.style && (s[o] = h._data(r, "olddisplay"), n = r.style.display, t ? (s[o] || "none" !== n || (r.style.display = ""), "" === r.style.display && V(r) && (s[o] = h._data(r, "olddisplay", Mt(r.nodeName)))) : (i = V(r), (n && "none" !== n || !i) && h._data(r, "olddisplay", i ? n : h.css(r, "display"))));
        for (o = 0; u > o; o++) r = e[o], r.style && (t && "none" !== r.style.display && "" !== r.style.display || (r.style.display = t ? s[o] || "" : "none"));
        return e
    }

    function Jt(e, t, n) {
        var r = Rt.exec(t);
        return r ? Math.max(0, r[1] - (n || 0)) + (r[2] || "px") : t
    }

    function Kt(e, t, n, r, i) {
        for (var s = n === (r ? "border" : "content") ? 4 : "width" === t ? 1 : 0, o = 0; 4 > s; s += 2) "margin" === n && (o += h.css(e, n + X[s], !0, i)), r ? ("content" === n && (o -= h.css(e, "padding" + X[s], !0, i)), "margin" !== n && (o -= h.css(e, "border" + X[s] + "Width", !0, i))) : (o += h.css(e, "padding" + X[s], !0, i), "padding" !== n && (o += h.css(e, "border" + X[s] + "Width", !0, i)));
        return o
    }

    function Qt(e, t, n) {
        var r = !0,
            i = "width" === t ? e.offsetWidth : e.offsetHeight,
            s = Pt(e),
            o = l.boxSizing && "border-box" === h.css(e, "boxSizing", !1, s);
        if (0 >= i || null == i) {
            if (i = Ht(e, t, s), (0 > i || null == i) && (i = e.style[t]), Dt.test(i)) return i;
            r = o && (l.boxSizingReliable() || i === e.style[t]), i = parseFloat(i) || 0
        }
        return i + Kt(e, t, n || (o ? "border" : "content"), r, s) + "px"
    }

    function Gt(e, t, n, r, i) {
        return new Gt.prototype.init(e, t, n, r, i)
    }

    function on() {
        return setTimeout(function() {
            Yt = void 0
        }), Yt = h.now()
    }

    function un(e, t) {
        var n, r = {
                height: e
            },
            i = 0;
        for (t = t ? 1 : 0; 4 > i; i += 2 - t) n = X[i], r["margin" + n] = r["padding" + n] = e;
        return t && (r.opacity = r.width = e), r
    }

    function an(e, t, n) {
        for (var r, i = (sn[t] || []).concat(sn["*"]), s = 0, o = i.length; o > s; s++)
            if (r = i[s].call(n, t, e)) return r
    }

    function fn(e, t, n) {
        var r, i, s, o, u, a, f, c, p = this,
            d = {},
            v = e.style,
            m = e.nodeType && V(e),
            g = h._data(e, "fxshow");
        n.queue || (u = h._queueHooks(e, "fx"), null == u.unqueued && (u.unqueued = 0, a = u.empty.fire, u.empty.fire = function() {
            u.unqueued || a()
        }), u.unqueued++, p.always(function() {
            p.always(function() {
                u.unqueued--, h.queue(e, "fx").length || u.empty.fire()
            })
        })), 1 === e.nodeType && ("height" in t || "width" in t) && (n.overflow = [v.overflow, v.overflowX, v.overflowY], f = h.css(e, "display"), c = "none" === f ? h._data(e, "olddisplay") || Mt(e.nodeName) : f, "inline" === c && "none" === h.css(e, "float") && (l.inlineBlockNeedsLayout && "inline" !== Mt(e.nodeName) ? v.zoom = 1 : v.display = "inline-block")), n.overflow && (v.overflow = "hidden", l.shrinkWrapBlocks() || p.always(function() {
            v.overflow = n.overflow[0], v.overflowX = n.overflow[1], v.overflowY = n.overflow[2]
        }));
        for (r in t)
            if (i = t[r], en.exec(i)) {
                if (delete t[r], s = s || "toggle" === i, i === (m ? "hide" : "show")) {
                    if ("show" !== i || !g || void 0 === g[r]) continue;
                    m = !0
                }
                d[r] = g && g[r] || h.style(e, r)
            } else f = void 0;
        if (h.isEmptyObject(d)) "inline" === ("none" === f ? Mt(e.nodeName) : f) && (v.display = f);
        else {
            g ? "hidden" in g && (m = g.hidden) : g = h._data(e, "fxshow", {}), s && (g.hidden = !m), m ? h(e).show() : p.done(function() {
                h(e).hide()
            }), p.done(function() {
                var t;
                h._removeData(e, "fxshow");
                for (t in d) h.style(e, t, d[t])
            });
            for (r in d) o = an(m ? g[r] : 0, r, p), r in g || (g[r] = o.start, m && (o.end = o.start, o.start = "width" === r || "height" === r ? 1 : 0))
        }
    }

    function ln(e, t) {
        var n, r, i, s, o;
        for (n in e)
            if (r = h.camelCase(n), i = t[r], s = e[n], h.isArray(s) && (i = s[1], s = e[n] = s[0]), n !== r && (e[r] = s, delete e[n]), o = h.cssHooks[r], o && "expand" in o) {
                s = o.expand(s), delete e[r];
                for (n in s) n in e || (e[n] = s[n], t[n] = i)
            } else t[r] = i
    }

    function cn(e, t, n) {
        var r, i, s = 0,
            o = rn.length,
            u = h.Deferred().always(function() {
                delete a.elem
            }),
            a = function() {
                if (i) return !1;
                for (var t = Yt || on(), n = Math.max(0, f.startTime + f.duration - t), r = n / f.duration || 0, s = 1 - r, o = 0, a = f.tweens.length; a > o; o++) f.tweens[o].run(s);
                return u.notifyWith(e, [f, s, n]), 1 > s && a ? n : (u.resolveWith(e, [f]), !1)
            },
            f = u.promise({
                elem: e,
                props: h.extend({}, t),
                opts: h.extend(!0, {
                    specialEasing: {}
                }, n),
                originalProperties: t,
                originalOptions: n,
                startTime: Yt || on(),
                duration: n.duration,
                tweens: [],
                createTween: function(t, n) {
                    var r = h.Tween(e, f.opts, t, n, f.opts.specialEasing[t] || f.opts.easing);
                    return f.tweens.push(r), r
                },
                stop: function(t) {
                    var n = 0,
                        r = t ? f.tweens.length : 0;
                    if (i) return this;
                    for (i = !0; r > n; n++) f.tweens[n].run(1);
                    return t ? u.resolveWith(e, [f, t]) : u.rejectWith(e, [f, t]), this
                }
            }),
            l = f.props;
        for (ln(l, f.opts.specialEasing); o > s; s++)
            if (r = rn[s].call(f, e, l, f.opts)) return r;
        return h.map(l, an, f), h.isFunction(f.opts.start) && f.opts.start.call(e, f), h.fx.timer(h.extend(a, {
            elem: e,
            anim: f,
            queue: f.opts.queue
        })), f.progress(f.opts.progress).done(f.opts.done, f.opts.complete).fail(f.opts.fail).always(f.opts.always)
    }

    function Fn(e) {
        return function(t, n) {
            "string" != typeof t && (n = t, t = "*");
            var r, i = 0,
                s = t.toLowerCase().match(O) || [];
            if (h.isFunction(n))
                while (r = s[i++]) "+" === r.charAt(0) ? (r = r.slice(1) || "*", (e[r] = e[r] || []).unshift(n)) : (e[r] = e[r] || []).push(n)
        }
    }

    function In(e, t, n, r) {
        function o(u) {
            var a;
            return i[u] = !0, h.each(e[u] || [], function(e, u) {
                var f = u(t, n, r);
                return "string" != typeof f || s || i[f] ? s ? !(a = f) : void 0 : (t.dataTypes.unshift(f), o(f), !1)
            }), a
        }
        var i = {},
            s = e === Hn;
        return o(t.dataTypes[0]) || !i["*"] && o("*")
    }

    function qn(e, t) {
        var n, r, i = h.ajaxSettings.flatOptions || {};
        for (r in t) void 0 !== t[r] && ((i[r] ? e : n || (n = {}))[r] = t[r]);
        return n && h.extend(!0, e, n), e
    }

    function Rn(e, t, n) {
        var r, i, s, o, u = e.contents,
            a = e.dataTypes;
        while ("*" === a[0]) a.shift(), void 0 === i && (i = e.mimeType || t.getResponseHeader("Content-Type"));
        if (i)
            for (o in u)
                if (u[o] && u[o].test(i)) {
                    a.unshift(o);
                    break
                }
        if (a[0] in n) s = a[0];
        else {
            for (o in n) {
                if (!a[0] || e.converters[o + " " + a[0]]) {
                    s = o;
                    break
                }
                r || (r = o)
            }
            s = s || r
        }
        return s ? (s !== a[0] && a.unshift(s), n[s]) : void 0
    }

    function Un(e, t, n, r) {
        var i, s, o, u, a, f = {},
            l = e.dataTypes.slice();
        if (l[1])
            for (o in e.converters) f[o.toLowerCase()] = e.converters[o];
        s = l.shift();
        while (s)
            if (e.responseFields[s] && (n[e.responseFields[s]] = t), !a && r && e.dataFilter && (t = e.dataFilter(t, e.dataType)), a = s, s = l.shift())
                if ("*" === s) s = a;
                else if ("*" !== a && a !== s) {
            if (o = f[a + " " + s] || f["* " + s], !o)
                for (i in f)
                    if (u = i.split(" "), u[1] === s && (o = f[a + " " + u[0]] || f["* " + u[0]])) {
                        o === !0 ? o = f[i] : f[i] !== !0 && (s = u[0], l.unshift(u[1]));
                        break
                    }
            if (o !== !0)
                if (o && e["throws"]) t = o(t);
                else try {
                    t = o(t)
                } catch (c) {
                    return {
                        state: "parsererror",
                        error: o ? c : "No conversion from " + a + " to " + s
                    }
                }
        }
        return {
            state: "success",
            data: t
        }
    }

    function Jn(e, t, n, r) {
        var i;
        if (h.isArray(t)) h.each(t, function(t, i) {
            n || Wn.test(e) ? r(e, i) : Jn(e + "[" + ("object" == typeof i ? t : "") + "]", i, n, r)
        });
        else if (n || "object" !== h.type(t)) r(e, t);
        else
            for (i in t) Jn(e + "[" + i + "]", t[i], n, r)
    }

    function Yn() {
        try {
            return new e.XMLHttpRequest
        } catch (t) {}
    }

    function Zn() {
        try {
            return new e.ActiveXObject("Microsoft.XMLHTTP")
        } catch (t) {}
    }

    function ir(e) {
        return h.isWindow(e) ? e : 9 === e.nodeType ? e.defaultView || e.parentWindow : !1
    }
    var n = [],
        r = n.slice,
        i = n.concat,
        s = n.push,
        o = n.indexOf,
        u = {},
        a = u.toString,
        f = u.hasOwnProperty,
        l = {},
        c = "1.11.3",
        h = function(e, t) {
            return new h.fn.init(e, t)
        },
        p = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
        d = /^-ms-/,
        v = /-([\da-z])/gi,
        m = function(e, t) {
            return t.toUpperCase()
        };
    h.fn = h.prototype = {
        jquery: c,
        constructor: h,
        selector: "",
        length: 0,
        toArray: function() {
            return r.call(this)
        },
        get: function(e) {
            return null != e ? 0 > e ? this[e + this.length] : this[e] : r.call(this)
        },
        pushStack: function(e) {
            var t = h.merge(this.constructor(), e);
            return t.prevObject = this, t.context = this.context, t
        },
        each: function(e, t) {
            return h.each(this, e, t)
        },
        map: function(e) {
            return this.pushStack(h.map(this, function(t, n) {
                return e.call(t, n, t)
            }))
        },
        slice: function() {
            return this.pushStack(r.apply(this, arguments))
        },
        first: function() {
            return this.eq(0)
        },
        last: function() {
            return this.eq(-1)
        },
        eq: function(e) {
            var t = this.length,
                n = +e + (0 > e ? t : 0);
            return this.pushStack(n >= 0 && t > n ? [this[n]] : [])
        },
        end: function() {
            return this.prevObject || this.constructor(null)
        },
        push: s,
        sort: n.sort,
        splice: n.splice
    }, h.extend = h.fn.extend = function() {
        var e, t, n, r, i, s, o = arguments[0] || {},
            u = 1,
            a = arguments.length,
            f = !1;
        for ("boolean" == typeof o && (f = o, o = arguments[u] || {}, u++), "object" == typeof o || h.isFunction(o) || (o = {}), u === a && (o = this, u--); a > u; u++)
            if (null != (i = arguments[u]))
                for (r in i) e = o[r], n = i[r], o !== n && (f && n && (h.isPlainObject(n) || (t = h.isArray(n))) ? (t ? (t = !1, s = e && h.isArray(e) ? e : []) : s = e && h.isPlainObject(e) ? e : {}, o[r] = h.extend(f, s, n)) : void 0 !== n && (o[r] = n));
        return o
    }, h.extend({
        expando: "jQuery" + (c + Math.random()).replace(/\D/g, ""),
        isReady: !0,
        error: function(e) {
            throw new Error(e)
        },
        noop: function() {},
        isFunction: function(e) {
            return "function" === h.type(e)
        },
        isArray: Array.isArray || function(e) {
            return "array" === h.type(e)
        },
        isWindow: function(e) {
            return null != e && e == e.window
        },
        isNumeric: function(e) {
            return !h.isArray(e) && e - parseFloat(e) + 1 >= 0
        },
        isEmptyObject: function(e) {
            var t;
            for (t in e) return !1;
            return !0
        },
        isPlainObject: function(e) {
            var t;
            if (!e || "object" !== h.type(e) || e.nodeType || h.isWindow(e)) return !1;
            try {
                if (e.constructor && !f.call(e, "constructor") && !f.call(e.constructor.prototype, "isPrototypeOf")) return !1
            } catch (n) {
                return !1
            }
            if (l.ownLast)
                for (t in e) return f.call(e, t);
            for (t in e);
            return void 0 === t || f.call(e, t)
        },
        type: function(e) {
            return null == e ? e + "" : "object" == typeof e || "function" == typeof e ? u[a.call(e)] || "object" : typeof e
        },
        globalEval: function(t) {
            t && h.trim(t) && (e.execScript || function(t) {
                e.eval.call(e, t)
            })(t)
        },
        camelCase: function(e) {
            return e.replace(d, "ms-").replace(v, m)
        },
        nodeName: function(e, t) {
            return e.nodeName && e.nodeName.toLowerCase() === t.toLowerCase()
        },
        each: function(e, t, n) {
            var r, i = 0,
                s = e.length,
                o = g(e);
            if (n) {
                if (o) {
                    for (; s > i; i++)
                        if (r = t.apply(e[i], n), r === !1) break
                } else
                    for (i in e)
                        if (r = t.apply(e[i], n), r === !1) break
            } else if (o) {
                for (; s > i; i++)
                    if (r = t.call(e[i], i, e[i]), r === !1) break
            } else
                for (i in e)
                    if (r = t.call(e[i], i, e[i]), r === !1) break; return e
        },
        trim: function(e) {
            return null == e ? "" : (e + "").replace(p, "")
        },
        makeArray: function(e, t) {
            var n = t || [];
            return null != e && (g(Object(e)) ? h.merge(n, "string" == typeof e ? [e] : e) : s.call(n, e)), n
        },
        inArray: function(e, t, n) {
            var r;
            if (t) {
                if (o) return o.call(t, e, n);
                for (r = t.length, n = n ? 0 > n ? Math.max(0, r + n) : n : 0; r > n; n++)
                    if (n in t && t[n] === e) return n
            }
            return -1
        },
        merge: function(e, t) {
            var n = +t.length,
                r = 0,
                i = e.length;
            while (n > r) e[i++] = t[r++];
            if (n !== n)
                while (void 0 !== t[r]) e[i++] = t[r++];
            return e.length = i, e
        },
        grep: function(e, t, n) {
            for (var r, i = [], s = 0, o = e.length, u = !n; o > s; s++) r = !t(e[s], s), r !== u && i.push(e[s]);
            return i
        },
        map: function(e, t, n) {
            var r, s = 0,
                o = e.length,
                u = g(e),
                a = [];
            if (u)
                for (; o > s; s++) r = t(e[s], s, n), null != r && a.push(r);
            else
                for (s in e) r = t(e[s], s, n), null != r && a.push(r);
            return i.apply([], a)
        },
        guid: 1,
        proxy: function(e, t) {
            var n, i, s;
            return "string" == typeof t && (s = e[t], t = e, e = s), h.isFunction(e) ? (n = r.call(arguments, 2), i = function() {
                return e.apply(t || this, n.concat(r.call(arguments)))
            }, i.guid = e.guid = e.guid || h.guid++, i) : void 0
        },
        now: function() {
            return +(new Date)
        },
        support: l
    }), h.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(e, t) {
        u["[object " + t + "]"] = t.toLowerCase()
    });
    var y = function(e) {
        function ot(e, t, r, i) {
            var s, u, f, l, c, d, g, y, S, x;
            if ((t ? t.ownerDocument || t : E) !== p && h(t), t = t || p, r = r || [], l = t.nodeType, "string" != typeof e || !e || 1 !== l && 9 !== l && 11 !== l) return r;
            if (!i && v) {
                if (11 !== l && (s = Z.exec(e)))
                    if (f = s[1]) {
                        if (9 === l) {
                            if (u = t.getElementById(f), !u || !u.parentNode) return r;
                            if (u.id === f) return r.push(u), r
                        } else if (t.ownerDocument && (u = t.ownerDocument.getElementById(f)) && b(t, u) && u.id === f) return r.push(u), r
                    } else {
                        if (s[2]) return D.apply(r, t.getElementsByTagName(e)), r;
                        if ((f = s[3]) && n.getElementsByClassName) return D.apply(r, t.getElementsByClassName(f)), r
                    }
                if (n.qsa && (!m || !m.test(e))) {
                    if (y = g = w, S = t, x = 1 !== l && e, 1 === l && "object" !== t.nodeName.toLowerCase()) {
                        d = o(e), (g = t.getAttribute("id")) ? y = g.replace(tt, "\\$&") : t.setAttribute("id", y), y = "[id='" + y + "'] ", c = d.length;
                        while (c--) d[c] = y + gt(d[c]);
                        S = et.test(e) && vt(t.parentNode) || t, x = d.join(",")
                    }
                    if (x) try {
                        return D.apply(r, S.querySelectorAll(x)), r
                    } catch (T) {} finally {
                        g || t.removeAttribute("id")
                    }
                }
            }
            return a(e.replace(z, "$1"), t, r, i)
        }

        function ut() {
            function t(n, i) {
                return e.push(n + " ") > r.cacheLength && delete t[e.shift()], t[n + " "] = i
            }
            var e = [];
            return t
        }

        function at(e) {
            return e[w] = !0, e
        }

        function ft(e) {
            var t = p.createElement("div");
            try {
                return !!e(t)
            } catch (n) {
                return !1
            } finally {
                t.parentNode && t.parentNode.removeChild(t), t = null
            }
        }

        function lt(e, t) {
            var n = e.split("|"),
                i = e.length;
            while (i--) r.attrHandle[n[i]] = t
        }

        function ct(e, t) {
            var n = t && e,
                r = n && 1 === e.nodeType && 1 === t.nodeType && (~t.sourceIndex || L) - (~e.sourceIndex || L);
            if (r) return r;
            if (n)
                while (n = n.nextSibling)
                    if (n === t) return -1;
            return e ? 1 : -1
        }

        function ht(e) {
            return function(t) {
                var n = t.nodeName.toLowerCase();
                return "input" === n && t.type === e
            }
        }

        function pt(e) {
            return function(t) {
                var n = t.nodeName.toLowerCase();
                return ("input" === n || "button" === n) && t.type === e
            }
        }

        function dt(e) {
            return at(function(t) {
                return t = +t, at(function(n, r) {
                    var i, s = e([], n.length, t),
                        o = s.length;
                    while (o--) n[i = s[o]] && (n[i] = !(r[i] = n[i]))
                })
            })
        }

        function vt(e) {
            return e && "undefined" != typeof e.getElementsByTagName && e
        }

        function mt() {}

        function gt(e) {
            for (var t = 0, n = e.length, r = ""; n > t; t++) r += e[t].value;
            return r
        }

        function yt(e, t, n) {
            var r = t.dir,
                i = n && "parentNode" === r,
                s = x++;
            return t.first ? function(t, n, s) {
                while (t = t[r])
                    if (1 === t.nodeType || i) return e(t, n, s)
            } : function(t, n, o) {
                var u, a, f = [S, s];
                if (o) {
                    while (t = t[r])
                        if ((1 === t.nodeType || i) && e(t, n, o)) return !0
                } else
                    while (t = t[r])
                        if (1 === t.nodeType || i) {
                            if (a = t[w] || (t[w] = {}), (u = a[r]) && u[0] === S && u[1] === s) return f[2] = u[2];
                            if (a[r] = f, f[2] = e(t, n, o)) return !0
                        }
            }
        }

        function bt(e) {
            return e.length > 1 ? function(t, n, r) {
                var i = e.length;
                while (i--)
                    if (!e[i](t, n, r)) return !1;
                return !0
            } : e[0]
        }

        function wt(e, t, n) {
            for (var r = 0, i = t.length; i > r; r++) ot(e, t[r], n);
            return n
        }

        function Et(e, t, n, r, i) {
            for (var s, o = [], u = 0, a = e.length, f = null != t; a > u; u++)(s = e[u]) && (!n || n(s, r, i)) && (o.push(s), f && t.push(u));
            return o
        }

        function St(e, t, n, r, i, s) {
            return r && !r[w] && (r = St(r)), i && !i[w] && (i = St(i, s)), at(function(s, o, u, a) {
                var f, l, c, h = [],
                    p = [],
                    d = o.length,
                    v = s || wt(t || "*", u.nodeType ? [u] : u, []),
                    m = !e || !s && t ? v : Et(v, h, e, u, a),
                    g = n ? i || (s ? e : d || r) ? [] : o : m;
                if (n && n(m, g, u, a), r) {
                    f = Et(g, p), r(f, [], u, a), l = f.length;
                    while (l--)(c = f[l]) && (g[p[l]] = !(m[p[l]] = c))
                }
                if (s) {
                    if (i || e) {
                        if (i) {
                            f = [], l = g.length;
                            while (l--)(c = g[l]) && f.push(m[l] = c);
                            i(null, g = [], f, a)
                        }
                        l = g.length;
                        while (l--)(c = g[l]) && (f = i ? H(s, c) : h[l]) > -1 && (s[f] = !(o[f] = c))
                    }
                } else g = Et(g === o ? g.splice(d, g.length) : g), i ? i(null, o, g, a) : D.apply(o, g)
            })
        }

        function xt(e) {
            for (var t, n, i, s = e.length, o = r.relative[e[0].type], u = o || r.relative[" "], a = o ? 1 : 0, l = yt(function(e) {
                    return e === t
                }, u, !0), c = yt(function(e) {
                    return H(t, e) > -1
                }, u, !0), h = [function(e, n, r) {
                    var i = !o && (r || n !== f) || ((t = n).nodeType ? l(e, n, r) : c(e, n, r));
                    return t = null, i
                }]; s > a; a++)
                if (n = r.relative[e[a].type]) h = [yt(bt(h), n)];
                else {
                    if (n = r.filter[e[a].type].apply(null, e[a].matches), n[w]) {
                        for (i = ++a; s > i; i++)
                            if (r.relative[e[i].type]) break;
                        return St(a > 1 && bt(h), a > 1 && gt(e.slice(0, a - 1).concat({
                            value: " " === e[a - 2].type ? "*" : ""
                        })).replace(z, "$1"), n, i > a && xt(e.slice(a, i)), s > i && xt(e = e.slice(i)), s > i && gt(e))
                    }
                    h.push(n)
                }
            return bt(h)
        }

        function Tt(e, t) {
            var n = t.length > 0,
                i = e.length > 0,
                s = function(s, o, u, a, l) {
                    var c, h, d, v = 0,
                        m = "0",
                        g = s && [],
                        y = [],
                        b = f,
                        w = s || i && r.find.TAG("*", l),
                        E = S += null == b ? 1 : Math.random() || .1,
                        x = w.length;
                    for (l && (f = o !== p && o); m !== x && null != (c = w[m]); m++) {
                        if (i && c) {
                            h = 0;
                            while (d = e[h++])
                                if (d(c, o, u)) {
                                    a.push(c);
                                    break
                                }
                            l && (S = E)
                        }
                        n && ((c = !d && c) && v--, s && g.push(c))
                    }
                    if (v += m, n && m !== v) {
                        h = 0;
                        while (d = t[h++]) d(g, y, o, u);
                        if (s) {
                            if (v > 0)
                                while (m--) g[m] || y[m] || (y[m] = M.call(a));
                            y = Et(y)
                        }
                        D.apply(a, y), l && !s && y.length > 0 && v + t.length > 1 && ot.uniqueSort(a)
                    }
                    return l && (S = E, f = b), g
                };
            return n ? at(s) : s
        }
        var t, n, r, i, s, o, u, a, f, l, c, h, p, d, v, m, g, y, b, w = "sizzle" + 1 * new Date,
            E = e.document,
            S = 0,
            x = 0,
            T = ut(),
            N = ut(),
            C = ut(),
            k = function(e, t) {
                return e === t && (c = !0), 0
            },
            L = 1 << 31,
            A = {}.hasOwnProperty,
            O = [],
            M = O.pop,
            _ = O.push,
            D = O.push,
            P = O.slice,
            H = function(e, t) {
                for (var n = 0, r = e.length; r > n; n++)
                    if (e[n] === t) return n;
                return -1
            },
            B = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
            j = "[\\x20\\t\\r\\n\\f]",
            F = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",
            I = F.replace("w", "w#"),
            q = "\\[" + j + "*(" + F + ")(?:" + j + "*([*^$|!~]?=)" + j + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + I + "))|)" + j + "*\\]",
            R = ":(" + F + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + q + ")*)|.*)\\)|)",
            U = new RegExp(j + "+", "g"),
            z = new RegExp("^" + j + "+|((?:^|[^\\\\])(?:\\\\.)*)" + j + "+$", "g"),
            W = new RegExp("^" + j + "*," + j + "*"),
            X = new RegExp("^" + j + "*([>+~]|" + j + ")" + j + "*"),
            V = new RegExp("=" + j + "*([^\\]'\"]*?)" + j + "*\\]", "g"),
            $ = new RegExp(R),
            J = new RegExp("^" + I + "$"),
            K = {
                ID: new RegExp("^#(" + F + ")"),
                CLASS: new RegExp("^\\.(" + F + ")"),
                TAG: new RegExp("^(" + F.replace("w", "w*") + ")"),
                ATTR: new RegExp("^" + q),
                PSEUDO: new RegExp("^" + R),
                CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + j + "*(even|odd|(([+-]|)(\\d*)n|)" + j + "*(?:([+-]|)" + j + "*(\\d+)|))" + j + "*\\)|)", "i"),
                bool: new RegExp("^(?:" + B + ")$", "i"),
                needsContext: new RegExp("^" + j + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + j + "*((?:-\\d)?\\d*)" + j + "*\\)|)(?=[^-]|$)", "i")
            },
            Q = /^(?:input|select|textarea|button)$/i,
            G = /^h\d$/i,
            Y = /^[^{]+\{\s*\[native \w/,
            Z = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
            et = /[+~]/,
            tt = /'|\\/g,
            nt = new RegExp("\\\\([\\da-f]{1,6}" + j + "?|(" + j + ")|.)", "ig"),
            rt = function(e, t, n) {
                var r = "0x" + t - 65536;
                return r !== r || n ? t : 0 > r ? String.fromCharCode(r + 65536) : String.fromCharCode(r >> 10 | 55296, 1023 & r | 56320)
            },
            it = function() {
                h()
            };
        try {
            D.apply(O = P.call(E.childNodes), E.childNodes), O[E.childNodes.length].nodeType
        } catch (st) {
            D = {
                apply: O.length ? function(e, t) {
                    _.apply(e, P.call(t))
                } : function(e, t) {
                    var n = e.length,
                        r = 0;
                    while (e[n++] = t[r++]);
                    e.length = n - 1
                }
            }
        }
        n = ot.support = {}, s = ot.isXML = function(e) {
            var t = e && (e.ownerDocument || e).documentElement;
            return t ? "HTML" !== t.nodeName : !1
        }, h = ot.setDocument = function(e) {
            var t, i, o = e ? e.ownerDocument || e : E;
            return o !== p && 9 === o.nodeType && o.documentElement ? (p = o, d = o.documentElement, i = o.defaultView, i && i !== i.top && (i.addEventListener ? i.addEventListener("unload", it, !1) : i.attachEvent && i.attachEvent("onunload", it)), v = !s(o), n.attributes = ft(function(e) {
                return e.className = "i", !e.getAttribute("className")
            }), n.getElementsByTagName = ft(function(e) {
                return e.appendChild(o.createComment("")), !e.getElementsByTagName("*").length
            }), n.getElementsByClassName = Y.test(o.getElementsByClassName), n.getById = ft(function(e) {
                return d.appendChild(e).id = w, !o.getElementsByName || !o.getElementsByName(w).length
            }), n.getById ? (r.find.ID = function(e, t) {
                if ("undefined" != typeof t.getElementById && v) {
                    var n = t.getElementById(e);
                    return n && n.parentNode ? [n] : []
                }
            }, r.filter.ID = function(e) {
                var t = e.replace(nt, rt);
                return function(e) {
                    return e.getAttribute("id") === t
                }
            }) : (delete r.find.ID, r.filter.ID = function(e) {
                var t = e.replace(nt, rt);
                return function(e) {
                    var n = "undefined" != typeof e.getAttributeNode && e.getAttributeNode("id");
                    return n && n.value === t
                }
            }), r.find.TAG = n.getElementsByTagName ? function(e, t) {
                return "undefined" != typeof t.getElementsByTagName ? t.getElementsByTagName(e) : n.qsa ? t.querySelectorAll(e) : void 0
            } : function(e, t) {
                var n, r = [],
                    i = 0,
                    s = t.getElementsByTagName(e);
                if ("*" === e) {
                    while (n = s[i++]) 1 === n.nodeType && r.push(n);
                    return r
                }
                return s
            }, r.find.CLASS = n.getElementsByClassName && function(e, t) {
                return v ? t.getElementsByClassName(e) : void 0
            }, g = [], m = [], (n.qsa = Y.test(o.querySelectorAll)) && (ft(function(e) {
                d.appendChild(e).innerHTML = "<a id='" + w + "'></a><select id='" + w + "-\f]' msallowcapture=''><option selected=''></option></select>", e.querySelectorAll("[msallowcapture^='']").length && m.push("[*^$]=" + j + "*(?:''|\"\")"), e.querySelectorAll("[selected]").length || m.push("\\[" + j + "*(?:value|" + B + ")"), e.querySelectorAll("[id~=" + w + "-]").length || m.push("~="), e.querySelectorAll(":checked").length || m.push(":checked"), e.querySelectorAll("a#" + w + "+*").length || m.push(".#.+[+~]")
            }), ft(function(e) {
                var t = o.createElement("input");
                t.setAttribute("type", "hidden"), e.appendChild(t).setAttribute("name", "D"), e.querySelectorAll("[name=d]").length && m.push("name" + j + "*[*^$|!~]?="), e.querySelectorAll(":enabled").length || m.push(":enabled", ":disabled"), e.querySelectorAll("*,:x"), m.push(",.*:")
            })), (n.matchesSelector = Y.test(y = d.matches || d.webkitMatchesSelector || d.mozMatchesSelector || d.oMatchesSelector || d.msMatchesSelector)) && ft(function(e) {
                n.disconnectedMatch = y.call(e, "div"), y.call(e, "[s!='']:x"), g.push("!=", R)
            }), m = m.length && new RegExp(m.join("|")), g = g.length && new RegExp(g.join("|")), t = Y.test(d.compareDocumentPosition), b = t || Y.test(d.contains) ? function(e, t) {
                var n = 9 === e.nodeType ? e.documentElement : e,
                    r = t && t.parentNode;
                return e === r || !!r && 1 === r.nodeType && !!(n.contains ? n.contains(r) : e.compareDocumentPosition && 16 & e.compareDocumentPosition(r))
            } : function(e, t) {
                if (t)
                    while (t = t.parentNode)
                        if (t === e) return !0;
                return !1
            }, k = t ? function(e, t) {
                if (e === t) return c = !0, 0;
                var r = !e.compareDocumentPosition - !t.compareDocumentPosition;
                return r ? r : (r = (e.ownerDocument || e) === (t.ownerDocument || t) ? e.compareDocumentPosition(t) : 1, 1 & r || !n.sortDetached && t.compareDocumentPosition(e) === r ? e === o || e.ownerDocument === E && b(E, e) ? -1 : t === o || t.ownerDocument === E && b(E, t) ? 1 : l ? H(l, e) - H(l, t) : 0 : 4 & r ? -1 : 1)
            } : function(e, t) {
                if (e === t) return c = !0, 0;
                var n, r = 0,
                    i = e.parentNode,
                    s = t.parentNode,
                    u = [e],
                    a = [t];
                if (!i || !s) return e === o ? -1 : t === o ? 1 : i ? -1 : s ? 1 : l ? H(l, e) - H(l, t) : 0;
                if (i === s) return ct(e, t);
                n = e;
                while (n = n.parentNode) u.unshift(n);
                n = t;
                while (n = n.parentNode) a.unshift(n);
                while (u[r] === a[r]) r++;
                return r ? ct(u[r], a[r]) : u[r] === E ? -1 : a[r] === E ? 1 : 0
            }, o) : p
        }, ot.matches = function(e, t) {
            return ot(e, null, null, t)
        }, ot.matchesSelector = function(e, t) {
            if ((e.ownerDocument || e) !== p && h(e), t = t.replace(V, "='$1']"), !(!n.matchesSelector || !v || g && g.test(t) || m && m.test(t))) try {
                var r = y.call(e, t);
                if (r || n.disconnectedMatch || e.document && 11 !== e.document.nodeType) return r
            } catch (i) {}
            return ot(t, p, null, [e]).length > 0
        }, ot.contains = function(e, t) {
            return (e.ownerDocument || e) !== p && h(e), b(e, t)
        }, ot.attr = function(e, t) {
            (e.ownerDocument || e) !== p && h(e);
            var i = r.attrHandle[t.toLowerCase()],
                s = i && A.call(r.attrHandle, t.toLowerCase()) ? i(e, t, !v) : void 0;
            return void 0 !== s ? s : n.attributes || !v ? e.getAttribute(t) : (s = e.getAttributeNode(t)) && s.specified ? s.value : null
        }, ot.error = function(e) {
            throw new Error("Syntax error, unrecognized expression: " + e)
        }, ot.uniqueSort = function(e) {
            var t, r = [],
                i = 0,
                s = 0;
            if (c = !n.detectDuplicates, l = !n.sortStable && e.slice(0), e.sort(k), c) {
                while (t = e[s++]) t === e[s] && (i = r.push(s));
                while (i--) e.splice(r[i], 1)
            }
            return l = null, e
        }, i = ot.getText = function(e) {
            var t, n = "",
                r = 0,
                s = e.nodeType;
            if (s) {
                if (1 === s || 9 === s || 11 === s) {
                    if ("string" == typeof e.textContent) return e.textContent;
                    for (e = e.firstChild; e; e = e.nextSibling) n += i(e)
                } else if (3 === s || 4 === s) return e.nodeValue
            } else
                while (t = e[r++]) n += i(t);
            return n
        }, r = ot.selectors = {
            cacheLength: 50,
            createPseudo: at,
            match: K,
            attrHandle: {},
            find: {},
            relative: {
                ">": {
                    dir: "parentNode",
                    first: !0
                },
                " ": {
                    dir: "parentNode"
                },
                "+": {
                    dir: "previousSibling",
                    first: !0
                },
                "~": {
                    dir: "previousSibling"
                }
            },
            preFilter: {
                ATTR: function(e) {
                    return e[1] = e[1].replace(nt, rt), e[3] = (e[3] || e[4] || e[5] || "").replace(nt, rt), "~=" === e[2] && (e[3] = " " + e[3] + " "), e.slice(0, 4)
                },
                CHILD: function(e) {
                    return e[1] = e[1].toLowerCase(), "nth" === e[1].slice(0, 3) ? (e[3] || ot.error(e[0]), e[4] = +(e[4] ? e[5] + (e[6] || 1) : 2 * ("even" === e[3] || "odd" === e[3])), e[5] = +(e[7] + e[8] || "odd" === e[3])) : e[3] && ot.error(e[0]), e
                },
                PSEUDO: function(e) {
                    var t, n = !e[6] && e[2];
                    return K.CHILD.test(e[0]) ? null : (e[3] ? e[2] = e[4] || e[5] || "" : n && $.test(n) && (t = o(n, !0)) && (t = n.indexOf(")", n.length - t) - n.length) && (e[0] = e[0].slice(0, t), e[2] = n.slice(0, t)), e.slice(0, 3))
                }
            },
            filter: {
                TAG: function(e) {
                    var t = e.replace(nt, rt).toLowerCase();
                    return "*" === e ? function() {
                        return !0
                    } : function(e) {
                        return e.nodeName && e.nodeName.toLowerCase() === t
                    }
                },
                CLASS: function(e) {
                    var t = T[e + " "];
                    return t || (t = new RegExp("(^|" + j + ")" + e + "(" + j + "|$)")) && T(e, function(e) {
                        return t.test("string" == typeof e.className && e.className || "undefined" != typeof e.getAttribute && e.getAttribute("class") || "")
                    })
                },
                ATTR: function(e, t, n) {
                    return function(r) {
                        var i = ot.attr(r, e);
                        return null == i ? "!=" === t : t ? (i += "", "=" === t ? i === n : "!=" === t ? i !== n : "^=" === t ? n && 0 === i.indexOf(n) : "*=" === t ? n && i.indexOf(n) > -1 : "$=" === t ? n && i.slice(-n.length) === n : "~=" === t ? (" " + i.replace(U, " ") + " ").indexOf(n) > -1 : "|=" === t ? i === n || i.slice(0, n.length + 1) === n + "-" : !1) : !0
                    }
                },
                CHILD: function(e, t, n, r, i) {
                    var s = "nth" !== e.slice(0, 3),
                        o = "last" !== e.slice(-4),
                        u = "of-type" === t;
                    return 1 === r && 0 === i ? function(e) {
                        return !!e.parentNode
                    } : function(t, n, a) {
                        var f, l, c, h, p, d, v = s !== o ? "nextSibling" : "previousSibling",
                            m = t.parentNode,
                            g = u && t.nodeName.toLowerCase(),
                            y = !a && !u;
                        if (m) {
                            if (s) {
                                while (v) {
                                    c = t;
                                    while (c = c[v])
                                        if (u ? c.nodeName.toLowerCase() === g : 1 === c.nodeType) return !1;
                                    d = v = "only" === e && !d && "nextSibling"
                                }
                                return !0
                            }
                            if (d = [o ? m.firstChild : m.lastChild], o && y) {
                                l = m[w] || (m[w] = {}), f = l[e] || [], p = f[0] === S && f[1], h = f[0] === S && f[2], c = p && m.childNodes[p];
                                while (c = ++p && c && c[v] || (h = p = 0) || d.pop())
                                    if (1 === c.nodeType && ++h && c === t) {
                                        l[e] = [S, p, h];
                                        break
                                    }
                            } else if (y && (f = (t[w] || (t[w] = {}))[e]) && f[0] === S) h = f[1];
                            else
                                while (c = ++p && c && c[v] || (h = p = 0) || d.pop())
                                    if ((u ? c.nodeName.toLowerCase() === g : 1 === c.nodeType) && ++h && (y && ((c[w] || (c[w] = {}))[e] = [S, h]), c === t)) break; return h -= i, h === r || h % r === 0 && h / r >= 0
                        }
                    }
                },
                PSEUDO: function(e, t) {
                    var n, i = r.pseudos[e] || r.setFilters[e.toLowerCase()] || ot.error("unsupported pseudo: " + e);
                    return i[w] ? i(t) : i.length > 1 ? (n = [e, e, "", t], r.setFilters.hasOwnProperty(e.toLowerCase()) ? at(function(e, n) {
                        var r, s = i(e, t),
                            o = s.length;
                        while (o--) r = H(e, s[o]), e[r] = !(n[r] = s[o])
                    }) : function(e) {
                        return i(e, 0, n)
                    }) : i
                }
            },
            pseudos: {
                not: at(function(e) {
                    var t = [],
                        n = [],
                        r = u(e.replace(z, "$1"));
                    return r[w] ? at(function(e, t, n, i) {
                        var s, o = r(e, null, i, []),
                            u = e.length;
                        while (u--)(s = o[u]) && (e[u] = !(t[u] = s))
                    }) : function(e, i, s) {
                        return t[0] = e, r(t, null, s, n), t[0] = null, !n.pop()
                    }
                }),
                has: at(function(e) {
                    return function(t) {
                        return ot(e, t).length > 0
                    }
                }),
                contains: at(function(e) {
                    return e = e.replace(nt, rt),
                        function(t) {
                            return (t.textContent || t.innerText || i(t)).indexOf(e) > -1
                        }
                }),
                lang: at(function(e) {
                    return J.test(e || "") || ot.error("unsupported lang: " + e), e = e.replace(nt, rt).toLowerCase(),
                        function(t) {
                            var n;
                            do
                                if (n = v ? t.lang : t.getAttribute("xml:lang") || t.getAttribute("lang")) return n = n.toLowerCase(), n === e || 0 === n.indexOf(e + "-");
                            while ((t = t.parentNode) && 1 === t.nodeType);
                            return !1
                        }
                }),
                target: function(t) {
                    var n = e.location && e.location.hash;
                    return n && n.slice(1) === t.id
                },
                root: function(e) {
                    return e === d
                },
                focus: function(e) {
                    return e === p.activeElement && (!p.hasFocus || p.hasFocus()) && !!(e.type || e.href || ~e.tabIndex)
                },
                enabled: function(e) {
                    return e.disabled === !1
                },
                disabled: function(e) {
                    return e.disabled === !0
                },
                checked: function(e) {
                    var t = e.nodeName.toLowerCase();
                    return "input" === t && !!e.checked || "option" === t && !!e.selected
                },
                selected: function(e) {
                    return e.parentNode && e.parentNode.selectedIndex, e.selected === !0
                },
                empty: function(e) {
                    for (e = e.firstChild; e; e = e.nextSibling)
                        if (e.nodeType < 6) return !1;
                    return !0
                },
                parent: function(e) {
                    return !r.pseudos.empty(e)
                },
                header: function(e) {
                    return G.test(e.nodeName)
                },
                input: function(e) {
                    return Q.test(e.nodeName)
                },
                button: function(e) {
                    var t = e.nodeName.toLowerCase();
                    return "input" === t && "button" === e.type || "button" === t
                },
                text: function(e) {
                    var t;
                    return "input" === e.nodeName.toLowerCase() && "text" === e.type && (null == (t = e.getAttribute("type")) || "text" === t.toLowerCase())
                },
                first: dt(function() {
                    return [0]
                }),
                last: dt(function(e, t) {
                    return [t - 1]
                }),
                eq: dt(function(e, t, n) {
                    return [0 > n ? n + t : n]
                }),
                even: dt(function(e, t) {
                    for (var n = 0; t > n; n += 2) e.push(n);
                    return e
                }),
                odd: dt(function(e, t) {
                    for (var n = 1; t > n; n += 2) e.push(n);
                    return e
                }),
                lt: dt(function(e, t, n) {
                    for (var r = 0 > n ? n + t : n; --r >= 0;) e.push(r);
                    return e
                }),
                gt: dt(function(e, t, n) {
                    for (var r = 0 > n ? n + t : n; ++r < t;) e.push(r);
                    return e
                })
            }
        }, r.pseudos.nth = r.pseudos.eq;
        for (t in {
                radio: !0,
                checkbox: !0,
                file: !0,
                password: !0,
                image: !0
            }) r.pseudos[t] = ht(t);
        for (t in {
                submit: !0,
                reset: !0
            }) r.pseudos[t] = pt(t);
        return mt.prototype = r.filters = r.pseudos, r.setFilters = new mt, o = ot.tokenize = function(e, t) {
            var n, i, s, o, u, a, f, l = N[e + " "];
            if (l) return t ? 0 : l.slice(0);
            u = e, a = [], f = r.preFilter;
            while (u) {
                (!n || (i = W.exec(u))) && (i && (u = u.slice(i[0].length) || u), a.push(s = [])), n = !1, (i = X.exec(u)) && (n = i.shift(), s.push({
                    value: n,
                    type: i[0].replace(z, " ")
                }), u = u.slice(n.length));
                for (o in r.filter) !(i = K[o].exec(u)) || f[o] && !(i = f[o](i)) || (n = i.shift(), s.push({
                    value: n,
                    type: o,
                    matches: i
                }), u = u.slice(n.length));
                if (!n) break
            }
            return t ? u.length : u ? ot.error(e) : N(e, a).slice(0)
        }, u = ot.compile = function(e, t) {
            var n, r = [],
                i = [],
                s = C[e + " "];
            if (!s) {
                t || (t = o(e)), n = t.length;
                while (n--) s = xt(t[n]), s[w] ? r.push(s) : i.push(s);
                s = C(e, Tt(i, r)), s.selector = e
            }
            return s
        }, a = ot.select = function(e, t, i, s) {
            var a, f, l, c, h, p = "function" == typeof e && e,
                d = !s && o(e = p.selector || e);
            if (i = i || [], 1 === d.length) {
                if (f = d[0] = d[0].slice(0), f.length > 2 && "ID" === (l = f[0]).type && n.getById && 9 === t.nodeType && v && r.relative[f[1].type]) {
                    if (t = (r.find.ID(l.matches[0].replace(nt, rt), t) || [])[0], !t) return i;
                    p && (t = t.parentNode), e = e.slice(f.shift().value.length)
                }
                a = K.needsContext.test(e) ? 0 : f.length;
                while (a--) {
                    if (l = f[a], r.relative[c = l.type]) break;
                    if ((h = r.find[c]) && (s = h(l.matches[0].replace(nt, rt), et.test(f[0].type) && vt(t.parentNode) || t))) {
                        if (f.splice(a, 1), e = s.length && gt(f), !e) return D.apply(i, s), i;
                        break
                    }
                }
            }
            return (p || u(e, d))(s, t, !v, i, et.test(e) && vt(t.parentNode) || t), i
        }, n.sortStable = w.split("").sort(k).join("") === w, n.detectDuplicates = !!c, h(), n.sortDetached = ft(function(e) {
            return 1 & e.compareDocumentPosition(p.createElement("div"))
        }), ft(function(e) {
            return e.innerHTML = "<a href='#'></a>", "#" === e.firstChild.getAttribute("href")
        }) || lt("type|href|height|width", function(e, t, n) {
            return n ? void 0 : e.getAttribute(t, "type" === t.toLowerCase() ? 1 : 2)
        }), n.attributes && ft(function(e) {
            return e.innerHTML = "<input/>", e.firstChild.setAttribute("value", ""), "" === e.firstChild.getAttribute("value")
        }) || lt("value", function(e, t, n) {
            return n || "input" !== e.nodeName.toLowerCase() ? void 0 : e.defaultValue
        }), ft(function(e) {
            return null == e.getAttribute("disabled")
        }) || lt(B, function(e, t, n) {
            var r;
            return n ? void 0 : e[t] === !0 ? t.toLowerCase() : (r = e.getAttributeNode(t)) && r.specified ? r.value : null
        }), ot
    }(e);
    h.find = y, h.expr = y.selectors, h.expr[":"] = h.expr.pseudos, h.unique = y.uniqueSort, h.text = y.getText, h.isXMLDoc = y.isXML, h.contains = y.contains;
    var b = h.expr.match.needsContext,
        w = /^<(\w+)\s*\/?>(?:<\/\1>|)$/,
        E = /^.[^:#\[\.,]*$/;
    h.filter = function(e, t, n) {
        var r = t[0];
        return n && (e = ":not(" + e + ")"), 1 === t.length && 1 === r.nodeType ? h.find.matchesSelector(r, e) ? [r] : [] : h.find.matches(e, h.grep(t, function(e) {
            return 1 === e.nodeType
        }))
    }, h.fn.extend({
        find: function(e) {
            var t, n = [],
                r = this,
                i = r.length;
            if ("string" != typeof e) return this.pushStack(h(e).filter(function() {
                for (t = 0; i > t; t++)
                    if (h.contains(r[t], this)) return !0
            }));
            for (t = 0; i > t; t++) h.find(e, r[t], n);
            return n = this.pushStack(i > 1 ? h.unique(n) : n), n.selector = this.selector ? this.selector + " " + e : e, n
        },
        filter: function(e) {
            return this.pushStack(S(this, e || [], !1))
        },
        not: function(e) {
            return this.pushStack(S(this, e || [], !0))
        },
        is: function(e) {
            return !!S(this, "string" == typeof e && b.test(e) ? h(e) : e || [], !1).length
        }
    });
    var x, T = e.document,
        N = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,
        C = h.fn.init = function(e, t) {
            var n, r;
            if (!e) return this;
            if ("string" == typeof e) {
                if (n = "<" === e.charAt(0) && ">" === e.charAt(e.length - 1) && e.length >= 3 ? [null, e, null] : N.exec(e), !n || !n[1] && t) return !t || t.jquery ? (t || x).find(e) : this.constructor(t).find(e);
                if (n[1]) {
                    if (t = t instanceof h ? t[0] : t, h.merge(this, h.parseHTML(n[1], t && t.nodeType ? t.ownerDocument || t : T, !0)), w.test(n[1]) && h.isPlainObject(t))
                        for (n in t) h.isFunction(this[n]) ? this[n](t[n]) : this.attr(n, t[n]);
                    return this
                }
                if (r = T.getElementById(n[2]), r && r.parentNode) {
                    if (r.id !== n[2]) return x.find(e);
                    this.length = 1, this[0] = r
                }
                return this.context = T, this.selector = e, this
            }
            return e.nodeType ? (this.context = this[0] = e, this.length = 1, this) : h.isFunction(e) ? "undefined" != typeof x.ready ? x.ready(e) : e(h) : (void 0 !== e.selector && (this.selector = e.selector, this.context = e.context), h.makeArray(e, this))
        };
    C.prototype = h.fn, x = h(T);
    var k = /^(?:parents|prev(?:Until|All))/,
        L = {
            children: !0,
            contents: !0,
            next: !0,
            prev: !0
        };
    h.extend({
        dir: function(e, t, n) {
            var r = [],
                i = e[t];
            while (i && 9 !== i.nodeType && (void 0 === n || 1 !== i.nodeType || !h(i).is(n))) 1 === i.nodeType && r.push(i), i = i[t];
            return r
        },
        sibling: function(e, t) {
            for (var n = []; e; e = e.nextSibling) 1 === e.nodeType && e !== t && n.push(e);
            return n
        }
    }), h.fn.extend({
        has: function(e) {
            var t, n = h(e, this),
                r = n.length;
            return this.filter(function() {
                for (t = 0; r > t; t++)
                    if (h.contains(this, n[t])) return !0
            })
        },
        closest: function(e, t) {
            for (var n, r = 0, i = this.length, s = [], o = b.test(e) || "string" != typeof e ? h(e, t || this.context) : 0; i > r; r++)
                for (n = this[r]; n && n !== t; n = n.parentNode)
                    if (n.nodeType < 11 && (o ? o.index(n) > -1 : 1 === n.nodeType && h.find.matchesSelector(n, e))) {
                        s.push(n);
                        break
                    }
            return this.pushStack(s.length > 1 ? h.unique(s) : s)
        },
        index: function(e) {
            return e ? "string" == typeof e ? h.inArray(this[0], h(e)) : h.inArray(e.jquery ? e[0] : e, this) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1
        },
        add: function(e, t) {
            return this.pushStack(h.unique(h.merge(this.get(), h(e, t))))
        },
        addBack: function(e) {
            return this.add(null == e ? this.prevObject : this.prevObject.filter(e))
        }
    }), h.each({
        parent: function(e) {
            var t = e.parentNode;
            return t && 11 !== t.nodeType ? t : null
        },
        parents: function(e) {
            return h.dir(e, "parentNode")
        },
        parentsUntil: function(e, t, n) {
            return h.dir(e, "parentNode", n)
        },
        next: function(e) {
            return A(e, "nextSibling")
        },
        prev: function(e) {
            return A(e, "previousSibling")
        },
        nextAll: function(e) {
            return h.dir(e, "nextSibling")
        },
        prevAll: function(e) {
            return h.dir(e, "previousSibling")
        },
        nextUntil: function(e, t, n) {
            return h.dir(e, "nextSibling", n)
        },
        prevUntil: function(e, t, n) {
            return h.dir(e, "previousSibling", n)
        },
        siblings: function(e) {
            return h.sibling((e.parentNode || {}).firstChild, e)
        },
        children: function(e) {
            return h.sibling(e.firstChild)
        },
        contents: function(e) {
            return h.nodeName(e, "iframe") ? e.contentDocument || e.contentWindow.document : h.merge([], e.childNodes)
        }
    }, function(e, t) {
        h.fn[e] = function(n, r) {
            var i = h.map(this, t, n);
            return "Until" !== e.slice(-5) && (r = n), r && "string" == typeof r && (i = h.filter(r, i)), this.length > 1 && (L[e] || (i = h.unique(i)), k.test(e) && (i = i.reverse())), this.pushStack(i)
        }
    });
    var O = /\S+/g,
        M = {};
    h.Callbacks = function(e) {
        e = "string" == typeof e ? M[e] || _(e) : h.extend({}, e);
        var t, n, r, i, s, o, u = [],
            a = !e.once && [],
            f = function(c) {
                for (n = e.memory && c, r = !0, s = o || 0, o = 0, i = u.length, t = !0; u && i > s; s++)
                    if (u[s].apply(c[0], c[1]) === !1 && e.stopOnFalse) {
                        n = !1;
                        break
                    }
                t = !1, u && (a ? a.length && f(a.shift()) : n ? u = [] : l.disable())
            },
            l = {
                add: function() {
                    if (u) {
                        var r = u.length;
                        ! function s(t) {
                            h.each(t, function(t, n) {
                                var r = h.type(n);
                                "function" === r ? e.unique && l.has(n) || u.push(n) : n && n.length && "string" !== r && s(n)
                            })
                        }(arguments), t ? i = u.length : n && (o = r, f(n))
                    }
                    return this
                },
                remove: function() {
                    return u && h.each(arguments, function(e, n) {
                        var r;
                        while ((r = h.inArray(n, u, r)) > -1) u.splice(r, 1), t && (i >= r && i--, s >= r && s--)
                    }), this
                },
                has: function(e) {
                    return e ? h.inArray(e, u) > -1 : !!u && !!u.length
                },
                empty: function() {
                    return u = [], i = 0, this
                },
                disable: function() {
                    return u = a = n = void 0, this
                },
                disabled: function() {
                    return !u
                },
                lock: function() {
                    return a = void 0, n || l.disable(), this
                },
                locked: function() {
                    return !a
                },
                fireWith: function(e, n) {
                    return !u || r && !a || (n = n || [], n = [e, n.slice ? n.slice() : n], t ? a.push(n) : f(n)), this
                },
                fire: function() {
                    return l.fireWith(this, arguments), this
                },
                fired: function() {
                    return !!r
                }
            };
        return l
    }, h.extend({
        Deferred: function(e) {
            var t = [
                    ["resolve", "done", h.Callbacks("once memory"), "resolved"],
                    ["reject", "fail", h.Callbacks("once memory"), "rejected"],
                    ["notify", "progress", h.Callbacks("memory")]
                ],
                n = "pending",
                r = {
                    state: function() {
                        return n
                    },
                    always: function() {
                        return i.done(arguments).fail(arguments), this
                    },
                    then: function() {
                        var e = arguments;
                        return h.Deferred(function(n) {
                            h.each(t, function(t, s) {
                                var o = h.isFunction(e[t]) && e[t];
                                i[s[1]](function() {
                                    var e = o && o.apply(this, arguments);
                                    e && h.isFunction(e.promise) ? e.promise().done(n.resolve).fail(n.reject).progress(n.notify) : n[s[0] + "With"](this === r ? n.promise() : this, o ? [e] : arguments)
                                })
                            }), e = null
                        }).promise()
                    },
                    promise: function(e) {
                        return null != e ? h.extend(e, r) : r
                    }
                },
                i = {};
            return r.pipe = r.then, h.each(t, function(e, s) {
                var o = s[2],
                    u = s[3];
                r[s[1]] = o.add, u && o.add(function() {
                    n = u
                }, t[1 ^ e][2].disable, t[2][2].lock), i[s[0]] = function() {
                    return i[s[0] + "With"](this === i ? r : this, arguments), this
                }, i[s[0] + "With"] = o.fireWith
            }), r.promise(i), e && e.call(i, i), i
        },
        when: function(e) {
            var t = 0,
                n = r.call(arguments),
                i = n.length,
                s = 1 !== i || e && h.isFunction(e.promise) ? i : 0,
                o = 1 === s ? e : h.Deferred(),
                u = function(e, t, n) {
                    return function(i) {
                        t[e] = this, n[e] = arguments.length > 1 ? r.call(arguments) : i, n === a ? o.notifyWith(t, n) : --s || o.resolveWith(t, n)
                    }
                },
                a, f, l;
            if (i > 1)
                for (a = new Array(i), f = new Array(i), l = new Array(i); i > t; t++) n[t] && h.isFunction(n[t].promise) ? n[t].promise().done(u(t, l, n)).fail(o.reject).progress(u(t, f, a)) : --s;
            return s || o.resolveWith(l, n), o.promise()
        }
    });
    var D;
    h.fn.ready = function(e) {
        return h.ready.promise().done(e), this
    }, h.extend({
        isReady: !1,
        readyWait: 1,
        holdReady: function(e) {
            e ? h.readyWait++ : h.ready(!0)
        },
        ready: function(e) {
            if (e === !0 ? !--h.readyWait : !h.isReady) {
                if (!T.body) return setTimeout(h.ready);
                h.isReady = !0, e !== !0 && --h.readyWait > 0 || (D.resolveWith(T, [h]), h.fn.triggerHandler && (h(T).triggerHandler("ready"), h(T).off("ready")))
            }
        }
    }), h.ready.promise = function(t) {
        if (!D)
            if (D = h.Deferred(), "complete" === T.readyState) setTimeout(h.ready);
            else if (T.addEventListener) T.addEventListener("DOMContentLoaded", H, !1), e.addEventListener("load", H, !1);
        else {
            T.attachEvent("onreadystatechange", H), e.attachEvent("onload", H);
            var n = !1;
            try {
                n = null == e.frameElement && T.documentElement
            } catch (r) {}
            n && n.doScroll && ! function i() {
                if (!h.isReady) {
                    try {
                        n.doScroll("left")
                    } catch (e) {
                        return setTimeout(i, 50)
                    }
                    P(), h.ready()
                }
            }()
        }
        return D.promise(t)
    };
    var B = "undefined",
        j;
    for (j in h(l)) break;
    l.ownLast = "0" !== j, l.inlineBlockNeedsLayout = !1, h(function() {
            var e, t, n, r;
            n = T.getElementsByTagName("body")[0], n && n.style && (t = T.createElement("div"), r = T.createElement("div"), r.style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px", n.appendChild(r).appendChild(t), typeof t.style.zoom !== B && (t.style.cssText = "display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1", l.inlineBlockNeedsLayout = e = 3 === t.offsetWidth, e && (n.style.zoom = 1)), n.removeChild(r))
        }),
        function() {
            var e = T.createElement("div");
            if (null == l.deleteExpando) {
                l.deleteExpando = !0;
                try {
                    delete e.test
                } catch (t) {
                    l.deleteExpando = !1
                }
            }
            e = null
        }(), h.acceptData = function(e) {
            var t = h.noData[(e.nodeName + " ").toLowerCase()],
                n = +e.nodeType || 1;
            return 1 !== n && 9 !== n ? !1 : !t || t !== !0 && e.getAttribute("classid") === t
        };
    var F = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
        I = /([A-Z])/g;
    h.extend({
        cache: {},
        noData: {
            "applet ": !0,
            "embed ": !0,
            "object ": "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
        },
        hasData: function(e) {
            return e = e.nodeType ? h.cache[e[h.expando]] : e[h.expando], !!e && !R(e)
        },
        data: function(e, t, n) {
            return U(e, t, n)
        },
        removeData: function(e, t) {
            return z(e, t)
        },
        _data: function(e, t, n) {
            return U(e, t, n, !0)
        },
        _removeData: function(e, t) {
            return z(e, t, !0)
        }
    }), h.fn.extend({
        data: function(e, t) {
            var n, r, i, s = this[0],
                o = s && s.attributes;
            if (void 0 === e) {
                if (this.length && (i = h.data(s), 1 === s.nodeType && !h._data(s, "parsedAttrs"))) {
                    n = o.length;
                    while (n--) o[n] && (r = o[n].name, 0 === r.indexOf("data-") && (r = h.camelCase(r.slice(5)), q(s, r, i[r])));
                    h._data(s, "parsedAttrs", !0)
                }
                return i
            }
            return "object" == typeof e ? this.each(function() {
                h.data(this, e)
            }) : arguments.length > 1 ? this.each(function() {
                h.data(this, e, t)
            }) : s ? q(s, e, h.data(s, e)) : void 0
        },
        removeData: function(e) {
            return this.each(function() {
                h.removeData(this, e)
            })
        }
    }), h.extend({
        queue: function(e, t, n) {
            var r;
            return e ? (t = (t || "fx") + "queue", r = h._data(e, t), n && (!r || h.isArray(n) ? r = h._data(e, t, h.makeArray(n)) : r.push(n)), r || []) : void 0
        },
        dequeue: function(e, t) {
            t = t || "fx";
            var n = h.queue(e, t),
                r = n.length,
                i = n.shift(),
                s = h._queueHooks(e, t),
                o = function() {
                    h.dequeue(e, t)
                };
            "inprogress" === i && (i = n.shift(), r--), i && ("fx" === t && n.unshift("inprogress"), delete s.stop, i.call(e, o, s)), !r && s && s.empty.fire()
        },
        _queueHooks: function(e, t) {
            var n = t + "queueHooks";
            return h._data(e, n) || h._data(e, n, {
                empty: h.Callbacks("once memory").add(function() {
                    h._removeData(e, t + "queue"), h._removeData(e, n)
                })
            })
        }
    }), h.fn.extend({
        queue: function(e, t) {
            var n = 2;
            return "string" != typeof e && (t = e, e = "fx", n--), arguments.length < n ? h.queue(this[0], e) : void 0 === t ? this : this.each(function() {
                var n = h.queue(this, e, t);
                h._queueHooks(this, e), "fx" === e && "inprogress" !== n[0] && h.dequeue(this, e)
            })
        },
        dequeue: function(e) {
            return this.each(function() {
                h.dequeue(this, e)
            })
        },
        clearQueue: function(e) {
            return this.queue(e || "fx", [])
        },
        promise: function(e, t) {
            var n, r = 1,
                i = h.Deferred(),
                s = this,
                o = this.length,
                u = function() {
                    --r || i.resolveWith(s, [s])
                };
            "string" != typeof e && (t = e, e = void 0), e = e || "fx";
            while (o--) n = h._data(s[o], e + "queueHooks"), n && n.empty && (r++, n.empty.add(u));
            return u(), i.promise(t)
        }
    });
    var W = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
        X = ["Top", "Right", "Bottom", "Left"],
        V = function(e, t) {
            return e = t || e, "none" === h.css(e, "display") || !h.contains(e.ownerDocument, e)
        },
        $ = h.access = function(e, t, n, r, i, s, o) {
            var u = 0,
                a = e.length,
                f = null == n;
            if ("object" === h.type(n)) {
                i = !0;
                for (u in n) h.access(e, t, u, n[u], !0, s, o)
            } else if (void 0 !== r && (i = !0, h.isFunction(r) || (o = !0), f && (o ? (t.call(e, r), t = null) : (f = t, t = function(e, t, n) {
                    return f.call(h(e), n)
                })), t))
                for (; a > u; u++) t(e[u], n, o ? r : r.call(e[u], u, t(e[u], n)));
            return i ? e : f ? t.call(e) : a ? t(e[0], n) : s
        },
        J = /^(?:checkbox|radio)$/i;
    ! function() {
        var e = T.createElement("input"),
            t = T.createElement("div"),
            n = T.createDocumentFragment();
        if (t.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", l.leadingWhitespace = 3 === t.firstChild.nodeType, l.tbody = !t.getElementsByTagName("tbody").length, l.htmlSerialize = !!t.getElementsByTagName("link").length, l.html5Clone = "<:nav></:nav>" !== T.createElement("nav").cloneNode(!0).outerHTML, e.type = "checkbox", e.checked = !0, n.appendChild(e), l.appendChecked = e.checked, t.innerHTML = "<textarea>x</textarea>", l.noCloneChecked = !!t.cloneNode(!0).lastChild.defaultValue, n.appendChild(t), t.innerHTML = "<input type='radio' checked='checked' name='t'/>", l.checkClone = t.cloneNode(!0).cloneNode(!0).lastChild.checked, l.noCloneEvent = !0, t.attachEvent && (t.attachEvent("onclick", function() {
                l.noCloneEvent = !1
            }), t.cloneNode(!0).click()), null == l.deleteExpando) {
            l.deleteExpando = !0;
            try {
                delete t.test
            } catch (r) {
                l.deleteExpando = !1
            }
        }
    }(),
    function() {
        var t, n, r = T.createElement("div");
        for (t in {
                submit: !0,
                change: !0,
                focusin: !0
            }) n = "on" + t, (l[t + "Bubbles"] = n in e) || (r.setAttribute(n, "t"), l[t + "Bubbles"] = r.attributes[n].expando === !1);
        r = null
    }();
    var K = /^(?:input|select|textarea)$/i,
        Q = /^key/,
        G = /^(?:mouse|pointer|contextmenu)|click/,
        Y = /^(?:focusinfocus|focusoutblur)$/,
        Z = /^([^.]*)(?:\.(.+)|)$/;
    h.event = {
        global: {},
        add: function(e, t, n, r, i) {
            var s, o, u, a, f, l, c, p, d, v, m, g = h._data(e);
            if (g) {
                n.handler && (a = n, n = a.handler, i = a.selector), n.guid || (n.guid = h.guid++), (o = g.events) || (o = g.events = {}), (l = g.handle) || (l = g.handle = function(e) {
                    return typeof h === B || e && h.event.triggered === e.type ? void 0 : h.event.dispatch.apply(l.elem, arguments)
                }, l.elem = e), t = (t || "").match(O) || [""], u = t.length;
                while (u--) s = Z.exec(t[u]) || [], d = m = s[1], v = (s[2] || "").split(".").sort(), d && (f = h.event.special[d] || {}, d = (i ? f.delegateType : f.bindType) || d, f = h.event.special[d] || {}, c = h.extend({
                    type: d,
                    origType: m,
                    data: r,
                    handler: n,
                    guid: n.guid,
                    selector: i,
                    needsContext: i && h.expr.match.needsContext.test(i),
                    namespace: v.join(".")
                }, a), (p = o[d]) || (p = o[d] = [], p.delegateCount = 0, f.setup && f.setup.call(e, r, v, l) !== !1 || (e.addEventListener ? e.addEventListener(d, l, !1) : e.attachEvent && e.attachEvent("on" + d, l))), f.add && (f.add.call(e, c), c.handler.guid || (c.handler.guid = n.guid)), i ? p.splice(p.delegateCount++, 0, c) : p.push(c), h.event.global[d] = !0);
                e = null
            }
        },
        remove: function(e, t, n, r, i) {
            var s, o, u, a, f, l, c, p, d, v, m, g = h.hasData(e) && h._data(e);
            if (g && (l = g.events)) {
                t = (t || "").match(O) || [""], f = t.length;
                while (f--)
                    if (u = Z.exec(t[f]) || [], d = m = u[1], v = (u[2] || "").split(".").sort(), d) {
                        c = h.event.special[d] || {}, d = (r ? c.delegateType : c.bindType) || d, p = l[d] || [], u = u[2] && new RegExp("(^|\\.)" + v.join("\\.(?:.*\\.|)") + "(\\.|$)"), a = s = p.length;
                        while (s--) o = p[s], !i && m !== o.origType || n && n.guid !== o.guid || u && !u.test(o.namespace) || r && r !== o.selector && ("**" !== r || !o.selector) || (p.splice(s, 1), o.selector && p.delegateCount--, c.remove && c.remove.call(e, o));
                        a && !p.length && (c.teardown && c.teardown.call(e, v, g.handle) !== !1 || h.removeEvent(e, d, g.handle), delete l[d])
                    } else
                        for (d in l) h.event.remove(e, d + t[f], n, r, !0);
                h.isEmptyObject(l) && (delete g.handle, h._removeData(e, "events"))
            }
        },
        trigger: function(t, n, r, i) {
            var s, o, u, a, l, c, p, d = [r || T],
                v = f.call(t, "type") ? t.type : t,
                m = f.call(t, "namespace") ? t.namespace.split(".") : [];
            if (u = c = r = r || T, 3 !== r.nodeType && 8 !== r.nodeType && !Y.test(v + h.event.triggered) && (v.indexOf(".") >= 0 && (m = v.split("."), v = m.shift(), m.sort()), o = v.indexOf(":") < 0 && "on" + v, t = t[h.expando] ? t : new h.Event(v, "object" == typeof t && t), t.isTrigger = i ? 2 : 3, t.namespace = m.join("."), t.namespace_re = t.namespace ? new RegExp("(^|\\.)" + m.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, t.result = void 0, t.target || (t.target = r), n = null == n ? [t] : h.makeArray(n, [t]), l = h.event.special[v] || {}, i || !l.trigger || l.trigger.apply(r, n) !== !1)) {
                if (!i && !l.noBubble && !h.isWindow(r)) {
                    for (a = l.delegateType || v, Y.test(a + v) || (u = u.parentNode); u; u = u.parentNode) d.push(u), c = u;
                    c === (r.ownerDocument || T) && d.push(c.defaultView || c.parentWindow || e)
                }
                p = 0;
                while ((u = d[p++]) && !t.isPropagationStopped()) t.type = p > 1 ? a : l.bindType || v, s = (h._data(u, "events") || {})[t.type] && h._data(u, "handle"), s && s.apply(u, n), s = o && u[o], s && s.apply && h.acceptData(u) && (t.result = s.apply(u, n), t.result === !1 && t.preventDefault());
                if (t.type = v, !i && !t.isDefaultPrevented() && (!l._default || l._default.apply(d.pop(), n) === !1) && h.acceptData(r) && o && r[v] && !h.isWindow(r)) {
                    c = r[o], c && (r[o] = null), h.event.triggered = v;
                    try {
                        r[v]()
                    } catch (g) {}
                    h.event.triggered = void 0, c && (r[o] = c)
                }
                return t.result
            }
        },
        dispatch: function(e) {
            e = h.event.fix(e);
            var t, n, i, s, o, u = [],
                a = r.call(arguments),
                f = (h._data(this, "events") || {})[e.type] || [],
                l = h.event.special[e.type] || {};
            if (a[0] = e, e.delegateTarget = this, !l.preDispatch || l.preDispatch.call(this, e) !== !1) {
                u = h.event.handlers.call(this, e, f), t = 0;
                while ((s = u[t++]) && !e.isPropagationStopped()) {
                    e.currentTarget = s.elem, o = 0;
                    while ((i = s.handlers[o++]) && !e.isImmediatePropagationStopped())(!e.namespace_re || e.namespace_re.test(i.namespace)) && (e.handleObj = i, e.data = i.data, n = ((h.event.special[i.origType] || {}).handle || i.handler).apply(s.elem, a), void 0 !== n && (e.result = n) === !1 && (e.preventDefault(), e.stopPropagation()))
                }
                return l.postDispatch && l.postDispatch.call(this, e), e.result
            }
        },
        handlers: function(e, t) {
            var n, r, i, s, o = [],
                u = t.delegateCount,
                a = e.target;
            if (u && a.nodeType && (!e.button || "click" !== e.type))
                for (; a != this; a = a.parentNode || this)
                    if (1 === a.nodeType && (a.disabled !== !0 || "click" !== e.type)) {
                        for (i = [], s = 0; u > s; s++) r = t[s], n = r.selector + " ", void 0 === i[n] && (i[n] = r.needsContext ? h(n, this).index(a) >= 0 : h.find(n, this, null, [a]).length), i[n] && i.push(r);
                        i.length && o.push({
                            elem: a,
                            handlers: i
                        })
                    }
            return u < t.length && o.push({
                elem: this,
                handlers: t.slice(u)
            }), o
        },
        fix: function(e) {
            if (e[h.expando]) return e;
            var t, n, r, i = e.type,
                s = e,
                o = this.fixHooks[i];
            o || (this.fixHooks[i] = o = G.test(i) ? this.mouseHooks : Q.test(i) ? this.keyHooks : {}), r = o.props ? this.props.concat(o.props) : this.props, e = new h.Event(s), t = r.length;
            while (t--) n = r[t], e[n] = s[n];
            return e.target || (e.target = s.srcElement || T), 3 === e.target.nodeType && (e.target = e.target.parentNode), e.metaKey = !!e.metaKey, o.filter ? o.filter(e, s) : e
        },
        props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
        fixHooks: {},
        keyHooks: {
            props: "char charCode key keyCode".split(" "),
            filter: function(e, t) {
                return null == e.which && (e.which = null != t.charCode ? t.charCode : t.keyCode), e
            }
        },
        mouseHooks: {
            props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
            filter: function(e, t) {
                var n, r, i, s = t.button,
                    o = t.fromElement;
                return null == e.pageX && null != t.clientX && (r = e.target.ownerDocument || T, i = r.documentElement, n = r.body, e.pageX = t.clientX + (i && i.scrollLeft || n && n.scrollLeft || 0) - (i && i.clientLeft || n && n.clientLeft || 0), e.pageY = t.clientY + (i && i.scrollTop || n && n.scrollTop || 0) - (i && i.clientTop || n && n.clientTop || 0)), !e.relatedTarget && o && (e.relatedTarget = o === e.target ? t.toElement : o), e.which || void 0 === s || (e.which = 1 & s ? 1 : 2 & s ? 3 : 4 & s ? 2 : 0), e
            }
        },
        special: {
            load: {
                noBubble: !0
            },
            focus: {
                trigger: function() {
                    if (this !== nt() && this.focus) try {
                        return this.focus(), !1
                    } catch (e) {}
                },
                delegateType: "focusin"
            },
            blur: {
                trigger: function() {
                    return this === nt() && this.blur ? (this.blur(), !1) : void 0
                },
                delegateType: "focusout"
            },
            click: {
                trigger: function() {
                    return h.nodeName(this, "input") && "checkbox" === this.type && this.click ? (this.click(), !1) : void 0
                },
                _default: function(e) {
                    return h.nodeName(e.target, "a")
                }
            },
            beforeunload: {
                postDispatch: function(e) {
                    void 0 !== e.result && e.originalEvent && (e.originalEvent.returnValue = e.result)
                }
            }
        },
        simulate: function(e, t, n, r) {
            var i = h.extend(new h.Event, n, {
                type: e,
                isSimulated: !0,
                originalEvent: {}
            });
            r ? h.event.trigger(i, null, t) : h.event.dispatch.call(t, i), i.isDefaultPrevented() && n.preventDefault()
        }
    }, h.removeEvent = T.removeEventListener ? function(e, t, n) {
        e.removeEventListener && e.removeEventListener(t, n, !1)
    } : function(e, t, n) {
        var r = "on" + t;
        e.detachEvent && (typeof e[r] === B && (e[r] = null), e.detachEvent(r, n))
    }, h.Event = function(e, t) {
        return this instanceof h.Event ? (e && e.type ? (this.originalEvent = e, this.type = e.type, this.isDefaultPrevented = e.defaultPrevented || void 0 === e.defaultPrevented && e.returnValue === !1 ? et : tt) : this.type = e, t && h.extend(this, t), this.timeStamp = e && e.timeStamp || h.now(), void(this[h.expando] = !0)) : new h.Event(e, t)
    }, h.Event.prototype = {
        isDefaultPrevented: tt,
        isPropagationStopped: tt,
        isImmediatePropagationStopped: tt,
        preventDefault: function() {
            var e = this.originalEvent;
            this.isDefaultPrevented = et, e && (e.preventDefault ? e.preventDefault() : e.returnValue = !1)
        },
        stopPropagation: function() {
            var e = this.originalEvent;
            this.isPropagationStopped = et, e && (e.stopPropagation && e.stopPropagation(), e.cancelBubble = !0)
        },
        stopImmediatePropagation: function() {
            var e = this.originalEvent;
            this.isImmediatePropagationStopped = et, e && e.stopImmediatePropagation && e.stopImmediatePropagation(), this.stopPropagation()
        }
    }, h.each({
        mouseenter: "mouseover",
        mouseleave: "mouseout",
        pointerenter: "pointerover",
        pointerleave: "pointerout"
    }, function(e, t) {
        h.event.special[e] = {
            delegateType: t,
            bindType: t,
            handle: function(e) {
                var n, r = this,
                    i = e.relatedTarget,
                    s = e.handleObj;
                return (!i || i !== r && !h.contains(r, i)) && (e.type = s.origType, n = s.handler.apply(this, arguments), e.type = t), n
            }
        }
    }), l.submitBubbles || (h.event.special.submit = {
        setup: function() {
            return h.nodeName(this, "form") ? !1 : void h.event.add(this, "click._submit keypress._submit", function(e) {
                var t = e.target,
                    n = h.nodeName(t, "input") || h.nodeName(t, "button") ? t.form : void 0;
                n && !h._data(n, "submitBubbles") && (h.event.add(n, "submit._submit", function(e) {
                    e._submit_bubble = !0
                }), h._data(n, "submitBubbles", !0))
            })
        },
        postDispatch: function(e) {
            e._submit_bubble && (delete e._submit_bubble, this.parentNode && !e.isTrigger && h.event.simulate("submit", this.parentNode, e, !0))
        },
        teardown: function() {
            return h.nodeName(this, "form") ? !1 : void h.event.remove(this, "._submit")
        }
    }), l.changeBubbles || (h.event.special.change = {
        setup: function() {
            return K.test(this.nodeName) ? (("checkbox" === this.type || "radio" === this.type) && (h.event.add(this, "propertychange._change", function(e) {
                "checked" === e.originalEvent.propertyName && (this._just_changed = !0)
            }), h.event.add(this, "click._change", function(e) {
                this._just_changed && !e.isTrigger && (this._just_changed = !1), h.event.simulate("change", this, e, !0)
            })), !1) : void h.event.add(this, "beforeactivate._change", function(e) {
                var t = e.target;
                K.test(t.nodeName) && !h._data(t, "changeBubbles") && (h.event.add(t, "change._change", function(e) {
                    !this.parentNode || e.isSimulated || e.isTrigger || h.event.simulate("change", this.parentNode, e, !0)
                }), h._data(t, "changeBubbles", !0))
            })
        },
        handle: function(e) {
            var t = e.target;
            return this !== t || e.isSimulated || e.isTrigger || "radio" !== t.type && "checkbox" !== t.type ? e.handleObj.handler.apply(this, arguments) : void 0
        },
        teardown: function() {
            return h.event.remove(this, "._change"), !K.test(this.nodeName)
        }
    }), l.focusinBubbles || h.each({
        focus: "focusin",
        blur: "focusout"
    }, function(e, t) {
        var n = function(e) {
            h.event.simulate(t, e.target, h.event.fix(e), !0)
        };
        h.event.special[t] = {
            setup: function() {
                var r = this.ownerDocument || this,
                    i = h._data(r, t);
                i || r.addEventListener(e, n, !0), h._data(r, t, (i || 0) + 1)
            },
            teardown: function() {
                var r = this.ownerDocument || this,
                    i = h._data(r, t) - 1;
                i ? h._data(r, t, i) : (r.removeEventListener(e, n, !0), h._removeData(r, t))
            }
        }
    }), h.fn.extend({
        on: function(e, t, n, r, i) {
            var s, o;
            if ("object" == typeof e) {
                "string" != typeof t && (n = n || t, t = void 0);
                for (s in e) this.on(s, t, n, e[s], i);
                return this
            }
            if (null == n && null == r ? (r = t, n = t = void 0) : null == r && ("string" == typeof t ? (r = n, n = void 0) : (r = n, n = t, t = void 0)), r === !1) r = tt;
            else if (!r) return this;
            return 1 === i && (o = r, r = function(e) {
                return h().off(e), o.apply(this, arguments)
            }, r.guid = o.guid || (o.guid = h.guid++)), this.each(function() {
                h.event.add(this, e, r, n, t)
            })
        },
        one: function(e, t, n, r) {
            return this.on(e, t, n, r, 1)
        },
        off: function(e, t, n) {
            var r, i;
            if (e && e.preventDefault && e.handleObj) return r = e.handleObj, h(e.delegateTarget).off(r.namespace ? r.origType + "." + r.namespace : r.origType, r.selector, r.handler), this;
            if ("object" == typeof e) {
                for (i in e) this.off(i, t, e[i]);
                return this
            }
            return (t === !1 || "function" == typeof t) && (n = t, t = void 0), n === !1 && (n = tt), this.each(function() {
                h.event.remove(this, e, n, t)
            })
        },
        trigger: function(e, t) {
            return this.each(function() {
                h.event.trigger(e, t, this)
            })
        },
        triggerHandler: function(e, t) {
            var n = this[0];
            return n ? h.event.trigger(e, t, n, !0) : void 0
        }
    });
    var it = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",
        st = / jQuery\d+="(?:null|\d+)"/g,
        ot = new RegExp("<(?:" + it + ")[\\s/>]", "i"),
        ut = /^\s+/,
        at = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
        ft = /<([\w:]+)/,
        lt = /<tbody/i,
        ct = /<|&#?\w+;/,
        ht = /<(?:script|style|link)/i,
        pt = /checked\s*(?:[^=]|=\s*.checked.)/i,
        dt = /^$|\/(?:java|ecma)script/i,
        vt = /^true\/(.*)/,
        mt = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
        gt = {
            option: [1, "<select multiple='multiple'>", "</select>"],
            legend: [1, "<fieldset>", "</fieldset>"],
            area: [1, "<map>", "</map>"],
            param: [1, "<object>", "</object>"],
            thead: [1, "<table>", "</table>"],
            tr: [2, "<table><tbody>", "</tbody></table>"],
            col: [2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"],
            td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
            _default: l.htmlSerialize ? [0, "", ""] : [1, "X<div>", "</div>"]
        },
        yt = rt(T),
        bt = yt.appendChild(T.createElement("div"));
    gt.optgroup = gt.option, gt.tbody = gt.tfoot = gt.colgroup = gt.caption = gt.thead, gt.th = gt.td, h.extend({
        clone: function(e, t, n) {
            var r, i, s, o, u, a = h.contains(e.ownerDocument, e);
            if (l.html5Clone || h.isXMLDoc(e) || !ot.test("<" + e.nodeName + ">") ? s = e.cloneNode(!0) : (bt.innerHTML = e.outerHTML, bt.removeChild(s = bt.firstChild)), !(l.noCloneEvent && l.noCloneChecked || 1 !== e.nodeType && 11 !== e.nodeType || h.isXMLDoc(e)))
                for (r = wt(s), u = wt(e), o = 0; null != (i = u[o]); ++o) r[o] && kt(i, r[o]);
            if (t)
                if (n)
                    for (u = u || wt(e), r = r || wt(s), o = 0; null != (i = u[o]); o++) Ct(i, r[o]);
                else Ct(e, s);
            return r = wt(s, "script"), r.length > 0 && Nt(r, !a && wt(e, "script")), r = u = i = null, s
        },
        buildFragment: function(e, t, n, r) {
            for (var i, s, o, u, a, f, c, p = e.length, d = rt(t), v = [], m = 0; p > m; m++)
                if (s = e[m], s || 0 === s)
                    if ("object" === h.type(s)) h.merge(v, s.nodeType ? [s] : s);
                    else if (ct.test(s)) {
                u = u || d.appendChild(t.createElement("div")), a = (ft.exec(s) || ["", ""])[1].toLowerCase(), c = gt[a] || gt._default, u.innerHTML = c[1] + s.replace(at, "<$1></$2>") + c[2], i = c[0];
                while (i--) u = u.lastChild;
                if (!l.leadingWhitespace && ut.test(s) && v.push(t.createTextNode(ut.exec(s)[0])), !l.tbody) {
                    s = "table" !== a || lt.test(s) ? "<table>" !== c[1] || lt.test(s) ? 0 : u : u.firstChild, i = s && s.childNodes.length;
                    while (i--) h.nodeName(f = s.childNodes[i], "tbody") && !f.childNodes.length && s.removeChild(f)
                }
                h.merge(v, u.childNodes), u.textContent = "";
                while (u.firstChild) u.removeChild(u.firstChild);
                u = d.lastChild
            } else v.push(t.createTextNode(s));
            u && d.removeChild(u), l.appendChecked || h.grep(wt(v, "input"), Et), m = 0;
            while (s = v[m++])
                if ((!r || -1 === h.inArray(s, r)) && (o = h.contains(s.ownerDocument, s), u = wt(d.appendChild(s), "script"), o && Nt(u), n)) {
                    i = 0;
                    while (s = u[i++]) dt.test(s.type || "") && n.push(s)
                }
            return u = null, d
        },
        cleanData: function(e, t) {
            for (var r, i, s, o, u = 0, a = h.expando, f = h.cache, c = l.deleteExpando, p = h.event.special; null != (r = e[u]); u++)
                if ((t || h.acceptData(r)) && (s = r[a], o = s && f[s])) {
                    if (o.events)
                        for (i in o.events) p[i] ? h.event.remove(r, i) : h.removeEvent(r, i, o.handle);
                    f[s] && (delete f[s], c ? delete r[a] : typeof r.removeAttribute !== B ? r.removeAttribute(a) : r[a] = null, n.push(s))
                }
        }
    }), h.fn.extend({
        text: function(e) {
            return $(this, function(e) {
                return void 0 === e ? h.text(this) : this.empty().append((this[0] && this[0].ownerDocument || T).createTextNode(e))
            }, null, e, arguments.length)
        },
        append: function() {
            return this.domManip(arguments, function(e) {
                if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                    var t = St(this, e);
                    t.appendChild(e)
                }
            })
        },
        prepend: function() {
            return this.domManip(arguments, function(e) {
                if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                    var t = St(this, e);
                    t.insertBefore(e, t.firstChild)
                }
            })
        },
        before: function() {
            return this.domManip(arguments, function(e) {
                this.parentNode && this.parentNode.insertBefore(e, this)
            })
        },
        after: function() {
            return this.domManip(arguments, function(e) {
                this.parentNode && this.parentNode.insertBefore(e, this.nextSibling)
            })
        },
        remove: function(e, t) {
            for (var n, r = e ? h.filter(e, this) : this, i = 0; null != (n = r[i]); i++) t || 1 !== n.nodeType || h.cleanData(wt(n)), n.parentNode && (t && h.contains(n.ownerDocument, n) && Nt(wt(n, "script")), n.parentNode.removeChild(n));
            return this
        },
        empty: function() {
            for (var e, t = 0; null != (e = this[t]); t++) {
                1 === e.nodeType && h.cleanData(wt(e, !1));
                while (e.firstChild) e.removeChild(e.firstChild);
                e.options && h.nodeName(e, "select") && (e.options.length = 0)
            }
            return this
        },
        clone: function(e, t) {
            return e = null == e ? !1 : e, t = null == t ? e : t, this.map(function() {
                return h.clone(this, e, t)
            })
        },
        html: function(e) {
            return $(this, function(e) {
                var t = this[0] || {},
                    n = 0,
                    r = this.length;
                if (void 0 === e) return 1 === t.nodeType ? t.innerHTML.replace(st, "") : void 0;
                if (!("string" != typeof e || ht.test(e) || !l.htmlSerialize && ot.test(e) || !l.leadingWhitespace && ut.test(e) || gt[(ft.exec(e) || ["", ""])[1].toLowerCase()])) {
                    e = e.replace(at, "<$1></$2>");
                    try {
                        for (; r > n; n++) t = this[n] || {}, 1 === t.nodeType && (h.cleanData(wt(t, !1)), t.innerHTML = e);
                        t = 0
                    } catch (i) {}
                }
                t && this.empty().append(e)
            }, null, e, arguments.length)
        },
        replaceWith: function() {
            var e = arguments[0];
            return this.domManip(arguments, function(t) {
                e = this.parentNode, h.cleanData(wt(this)), e && e.replaceChild(t, this)
            }), e && (e.length || e.nodeType) ? this : this.remove()
        },
        detach: function(e) {
            return this.remove(e, !0)
        },
        domManip: function(e, t) {
            e = i.apply([], e);
            var n, r, s, o, u, a, f = 0,
                c = this.length,
                p = this,
                d = c - 1,
                v = e[0],
                m = h.isFunction(v);
            if (m || c > 1 && "string" == typeof v && !l.checkClone && pt.test(v)) return this.each(function(n) {
                var r = p.eq(n);
                m && (e[0] = v.call(this, n, r.html())), r.domManip(e, t)
            });
            if (c && (a = h.buildFragment(e, this[0].ownerDocument, !1, this), n = a.firstChild, 1 === a.childNodes.length && (a = n), n)) {
                for (o = h.map(wt(a, "script"), xt), s = o.length; c > f; f++) r = a, f !== d && (r = h.clone(r, !0, !0), s && h.merge(o, wt(r, "script"))), t.call(this[f], r, f);
                if (s)
                    for (u = o[o.length - 1].ownerDocument, h.map(o, Tt), f = 0; s > f; f++) r = o[f], dt.test(r.type || "") && !h._data(r, "globalEval") && h.contains(u, r) && (r.src ? h._evalUrl && h._evalUrl(r.src) : h.globalEval((r.text || r.textContent || r.innerHTML || "").replace(mt, "")));
                a = n = null
            }
            return this
        }
    }), h.each({
        appendTo: "append",
        prependTo: "prepend",
        insertBefore: "before",
        insertAfter: "after",
        replaceAll: "replaceWith"
    }, function(e, t) {
        h.fn[e] = function(e) {
            for (var n, r = 0, i = [], o = h(e), u = o.length - 1; u >= r; r++) n = r === u ? this : this.clone(!0), h(o[r])[t](n), s.apply(i, n.get());
            return this.pushStack(i)
        }
    });
    var Lt, At = {};
    ! function() {
        var e;
        l.shrinkWrapBlocks = function() {
            if (null != e) return e;
            e = !1;
            var t, n, r;
            return n = T.getElementsByTagName("body")[0], n && n.style ? (t = T.createElement("div"), r = T.createElement("div"), r.style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px", n.appendChild(r).appendChild(t), typeof t.style.zoom !== B && (t.style.cssText = "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1", t.appendChild(T.createElement("div")).style.width = "5px", e = 3 !== t.offsetWidth), n.removeChild(r), e) : void 0
        }
    }();
    var _t = /^margin/,
        Dt = new RegExp("^(" + W + ")(?!px)[a-z%]+$", "i"),
        Pt, Ht, Bt = /^(top|right|bottom|left)$/;
    e.getComputedStyle ? (Pt = function(t) {
        return t.ownerDocument.defaultView.opener ? t.ownerDocument.defaultView.getComputedStyle(t, null) : e.getComputedStyle(t, null)
    }, Ht = function(e, t, n) {
        var r, i, s, o, u = e.style;
        return n = n || Pt(e), o = n ? n.getPropertyValue(t) || n[t] : void 0, n && ("" !== o || h.contains(e.ownerDocument, e) || (o = h.style(e, t)), Dt.test(o) && _t.test(t) && (r = u.width, i = u.minWidth, s = u.maxWidth, u.minWidth = u.maxWidth = u.width = o, o = n.width, u.width = r, u.minWidth = i, u.maxWidth = s)), void 0 === o ? o : o + ""
    }) : T.documentElement.currentStyle && (Pt = function(e) {
        return e.currentStyle
    }, Ht = function(e, t, n) {
        var r, i, s, o, u = e.style;
        return n = n || Pt(e), o = n ? n[t] : void 0, null == o && u && u[t] && (o = u[t]), Dt.test(o) && !Bt.test(t) && (r = u.left, i = e.runtimeStyle, s = i && i.left, s && (i.left = e.currentStyle.left), u.left = "fontSize" === t ? "1em" : o, o = u.pixelLeft + "px", u.left = r, s && (i.left = s)), void 0 === o ? o : o + "" || "auto"
    }), ! function() {
        var t, n, r, i, s, o, u;
        if (t = T.createElement("div"), t.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", r = t.getElementsByTagName("a")[0], n = r && r.style) {
            n.cssText = "float:left;opacity:.5", l.opacity = "0.5" === n.opacity, l.cssFloat = !!n.cssFloat, t.style.backgroundClip = "content-box", t.cloneNode(!0).style.backgroundClip = "", l.clearCloneStyle = "content-box" === t.style.backgroundClip, l.boxSizing = "" === n.boxSizing || "" === n.MozBoxSizing || "" === n.WebkitBoxSizing, h.extend(l, {
                reliableHiddenOffsets: function() {
                    return null == o && a(), o
                },
                boxSizingReliable: function() {
                    return null == s && a(), s
                },
                pixelPosition: function() {
                    return null == i && a(), i
                },
                reliableMarginRight: function() {
                    return null == u && a(), u
                }
            });

            function a() {
                var t, n, r, a;
                n = T.getElementsByTagName("body")[0], n && n.style && (t = T.createElement("div"), r = T.createElement("div"), r.style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px", n.appendChild(r).appendChild(t), t.style.cssText = "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute", i = s = !1, u = !0, e.getComputedStyle && (i = "1%" !== (e.getComputedStyle(t, null) || {}).top, s = "4px" === (e.getComputedStyle(t, null) || {
                    width: "4px"
                }).width, a = t.appendChild(T.createElement("div")), a.style.cssText = t.style.cssText = "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0", a.style.marginRight = a.style.width = "0", t.style.width = "1px", u = !parseFloat((e.getComputedStyle(a, null) || {}).marginRight), t.removeChild(a)), t.innerHTML = "<table><tr><td></td><td>t</td></tr></table>", a = t.getElementsByTagName("td"), a[0].style.cssText = "margin:0;border:0;padding:0;display:none", o = 0 === a[0].offsetHeight, o && (a[0].style.display = "", a[1].style.display = "none", o = 0 === a[0].offsetHeight), n.removeChild(r))
            }
        }
    }(), h.swap = function(e, t, n, r) {
        var i, s, o = {};
        for (s in t) o[s] = e.style[s], e.style[s] = t[s];
        i = n.apply(e, r || []);
        for (s in t) e.style[s] = o[s];
        return i
    };
    var Ft = /alpha\([^)]*\)/i,
        It = /opacity\s*=\s*([^)]*)/,
        qt = /^(none|table(?!-c[ea]).+)/,
        Rt = new RegExp("^(" + W + ")(.*)$", "i"),
        Ut = new RegExp("^([+-])=(" + W + ")", "i"),
        zt = {
            position: "absolute",
            visibility: "hidden",
            display: "block"
        },
        Wt = {
            letterSpacing: "0",
            fontWeight: "400"
        },
        Xt = ["Webkit", "O", "Moz", "ms"];
    h.extend({
        cssHooks: {
            opacity: {
                get: function(e, t) {
                    if (t) {
                        var n = Ht(e, "opacity");
                        return "" === n ? "1" : n
                    }
                }
            }
        },
        cssNumber: {
            columnCount: !0,
            fillOpacity: !0,
            flexGrow: !0,
            flexShrink: !0,
            fontWeight: !0,
            lineHeight: !0,
            opacity: !0,
            order: !0,
            orphans: !0,
            widows: !0,
            zIndex: !0,
            zoom: !0
        },
        cssProps: {
            "float": l.cssFloat ? "cssFloat" : "styleFloat"
        },
        style: function(e, t, n, r) {
            if (e && 3 !== e.nodeType && 8 !== e.nodeType && e.style) {
                var i, s, o, u = h.camelCase(t),
                    a = e.style;
                if (t = h.cssProps[u] || (h.cssProps[u] = Vt(a, u)), o = h.cssHooks[t] || h.cssHooks[u], void 0 === n) return o && "get" in o && void 0 !== (i = o.get(e, !1, r)) ? i : a[t];
                if (s = typeof n, "string" === s && (i = Ut.exec(n)) && (n = (i[1] + 1) * i[2] + parseFloat(h.css(e, t)), s = "number"), null != n && n === n && ("number" !== s || h.cssNumber[u] || (n += "px"), l.clearCloneStyle || "" !== n || 0 !== t.indexOf("background") || (a[t] = "inherit"), !(o && "set" in o && void 0 === (n = o.set(e, n, r))))) try {
                    a[t] = n
                } catch (f) {}
            }
        },
        css: function(e, t, n, r) {
            var i, s, o, u = h.camelCase(t);
            return t = h.cssProps[u] || (h.cssProps[u] = Vt(e.style, u)), o = h.cssHooks[t] || h.cssHooks[u], o && "get" in o && (s = o.get(e, !0, n)), void 0 === s && (s = Ht(e, t, r)), "normal" === s && t in Wt && (s = Wt[t]), "" === n || n ? (i = parseFloat(s), n === !0 || h.isNumeric(i) ? i || 0 : s) : s
        }
    }), h.each(["height", "width"], function(e, t) {
        h.cssHooks[t] = {
            get: function(e, n, r) {
                return n ? qt.test(h.css(e, "display")) && 0 === e.offsetWidth ? h.swap(e, zt, function() {
                    return Qt(e, t, r)
                }) : Qt(e, t, r) : void 0
            },
            set: function(e, n, r) {
                var i = r && Pt(e);
                return Jt(e, n, r ? Kt(e, t, r, l.boxSizing && "border-box" === h.css(e, "boxSizing", !1, i), i) : 0)
            }
        }
    }), l.opacity || (h.cssHooks.opacity = {
        get: function(e, t) {
            return It.test((t && e.currentStyle ? e.currentStyle.filter : e.style.filter) || "") ? .01 * parseFloat(RegExp.$1) + "" : t ? "1" : ""
        },
        set: function(e, t) {
            var n = e.style,
                r = e.currentStyle,
                i = h.isNumeric(t) ? "alpha(opacity=" + 100 * t + ")" : "",
                s = r && r.filter || n.filter || "";
            n.zoom = 1, (t >= 1 || "" === t) && "" === h.trim(s.replace(Ft, "")) && n.removeAttribute && (n.removeAttribute("filter"), "" === t || r && !r.filter) || (n.filter = Ft.test(s) ? s.replace(Ft, i) : s + " " + i)
        }
    }), h.cssHooks.marginRight = jt(l.reliableMarginRight, function(e, t) {
        return t ? h.swap(e, {
            display: "inline-block"
        }, Ht, [e, "marginRight"]) : void 0
    }), h.each({
        margin: "",
        padding: "",
        border: "Width"
    }, function(e, t) {
        h.cssHooks[e + t] = {
            expand: function(n) {
                for (var r = 0, i = {}, s = "string" == typeof n ? n.split(" ") : [n]; 4 > r; r++) i[e + X[r] + t] = s[r] || s[r - 2] || s[0];
                return i
            }
        }, _t.test(e) || (h.cssHooks[e + t].set = Jt)
    }), h.fn.extend({
        css: function(e, t) {
            return $(this, function(e, t, n) {
                var r, i, s = {},
                    o = 0;
                if (h.isArray(t)) {
                    for (r = Pt(e), i = t.length; i > o; o++) s[t[o]] = h.css(e, t[o], !1, r);
                    return s
                }
                return void 0 !== n ? h.style(e, t, n) : h.css(e, t)
            }, e, t, arguments.length > 1)
        },
        show: function() {
            return $t(this, !0)
        },
        hide: function() {
            return $t(this)
        },
        toggle: function(e) {
            return "boolean" == typeof e ? e ? this.show() : this.hide() : this.each(function() {
                V(this) ? h(this).show() : h(this).hide()
            })
        }
    }), h.Tween = Gt, Gt.prototype = {
        constructor: Gt,
        init: function(e, t, n, r, i, s) {
            this.elem = e, this.prop = n, this.easing = i || "swing", this.options = t, this.start = this.now = this.cur(), this.end = r, this.unit = s || (h.cssNumber[n] ? "" : "px")
        },
        cur: function() {
            var e = Gt.propHooks[this.prop];
            return e && e.get ? e.get(this) : Gt.propHooks._default.get(this)
        },
        run: function(e) {
            var t, n = Gt.propHooks[this.prop];
            return this.options.duration ? this.pos = t = h.easing[this.easing](e, this.options.duration * e, 0, 1, this.options.duration) : this.pos = t = e, this.now = (this.end - this.start) * t + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), n && n.set ? n.set(this) : Gt.propHooks._default.set(this), this
        }
    }, Gt.prototype.init.prototype = Gt.prototype, Gt.propHooks = {
        _default: {
            get: function(e) {
                var t;
                return null == e.elem[e.prop] || e.elem.style && null != e.elem.style[e.prop] ? (t = h.css(e.elem, e.prop, ""), t && "auto" !== t ? t : 0) : e.elem[e.prop]
            },
            set: function(e) {
                h.fx.step[e.prop] ? h.fx.step[e.prop](e) : e.elem.style && (null != e.elem.style[h.cssProps[e.prop]] || h.cssHooks[e.prop]) ? h.style(e.elem, e.prop, e.now + e.unit) : e.elem[e.prop] = e.now
            }
        }
    }, Gt.propHooks.scrollTop = Gt.propHooks.scrollLeft = {
        set: function(e) {
            e.elem.nodeType && e.elem.parentNode && (e.elem[e.prop] = e.now)
        }
    }, h.easing = {
        linear: function(e) {
            return e
        },
        swing: function(e) {
            return .5 - Math.cos(e * Math.PI) / 2
        }
    }, h.fx = Gt.prototype.init, h.fx.step = {};
    var Yt, Zt, en = /^(?:toggle|show|hide)$/,
        tn = new RegExp("^(?:([+-])=|)(" + W + ")([a-z%]*)$", "i"),
        nn = /queueHooks$/,
        rn = [fn],
        sn = {
            "*": [function(e, t) {
                var n = this.createTween(e, t),
                    r = n.cur(),
                    i = tn.exec(t),
                    s = i && i[3] || (h.cssNumber[e] ? "" : "px"),
                    o = (h.cssNumber[e] || "px" !== s && +r) && tn.exec(h.css(n.elem, e)),
                    u = 1,
                    a = 20;
                if (o && o[3] !== s) {
                    s = s || o[3], i = i || [], o = +r || 1;
                    do u = u || ".5", o /= u, h.style(n.elem, e, o + s); while (u !== (u = n.cur() / r) && 1 !== u && --a)
                }
                return i && (o = n.start = +o || +r || 0, n.unit = s, n.end = i[1] ? o + (i[1] + 1) * i[2] : +i[2]), n
            }]
        };
    h.Animation = h.extend(cn, {
            tweener: function(e, t) {
                h.isFunction(e) ? (t = e, e = ["*"]) : e = e.split(" ");
                for (var n, r = 0, i = e.length; i > r; r++) n = e[r], sn[n] = sn[n] || [], sn[n].unshift(t)
            },
            prefilter: function(e, t) {
                t ? rn.unshift(e) : rn.push(e)
            }
        }), h.speed = function(e, t, n) {
            var r = e && "object" == typeof e ? h.extend({}, e) : {
                complete: n || !n && t || h.isFunction(e) && e,
                duration: e,
                easing: n && t || t && !h.isFunction(t) && t
            };
            return r.duration = h.fx.off ? 0 : "number" == typeof r.duration ? r.duration : r.duration in h.fx.speeds ? h.fx.speeds[r.duration] : h.fx.speeds._default, (null == r.queue || r.queue === !0) && (r.queue = "fx"), r.old = r.complete, r.complete = function() {
                h.isFunction(r.old) && r.old.call(this), r.queue && h.dequeue(this, r.queue)
            }, r
        }, h.fn.extend({
            fadeTo: function(e, t, n, r) {
                return this.filter(V).css("opacity", 0).show().end().animate({
                    opacity: t
                }, e, n, r)
            },
            animate: function(e, t, n, r) {
                var i = h.isEmptyObject(e),
                    s = h.speed(t, n, r),
                    o = function() {
                        var t = cn(this, h.extend({}, e), s);
                        (i || h._data(this, "finish")) && t.stop(!0)
                    };
                return o.finish = o, i || s.queue === !1 ? this.each(o) : this.queue(s.queue, o)
            },
            stop: function(e, t, n) {
                var r = function(e) {
                    var t = e.stop;
                    delete e.stop, t(n)
                };
                return "string" != typeof e && (n = t, t = e, e = void 0), t && e !== !1 && this.queue(e || "fx", []), this.each(function() {
                    var t = !0,
                        i = null != e && e + "queueHooks",
                        s = h.timers,
                        o = h._data(this);
                    if (i) o[i] && o[i].stop && r(o[i]);
                    else
                        for (i in o) o[i] && o[i].stop && nn.test(i) && r(o[i]);
                    for (i = s.length; i--;) s[i].elem !== this || null != e && s[i].queue !== e || (s[i].anim.stop(n), t = !1, s.splice(i, 1));
                    (t || !n) && h.dequeue(this, e)
                })
            },
            finish: function(e) {
                return e !== !1 && (e = e || "fx"), this.each(function() {
                    var t, n = h._data(this),
                        r = n[e + "queue"],
                        i = n[e + "queueHooks"],
                        s = h.timers,
                        o = r ? r.length : 0;
                    for (n.finish = !0, h.queue(this, e, []), i && i.stop && i.stop.call(this, !0), t = s.length; t--;) s[t].elem === this && s[t].queue === e && (s[t].anim.stop(!0), s.splice(t, 1));
                    for (t = 0; o > t; t++) r[t] && r[t].finish && r[t].finish.call(this);
                    delete n.finish
                })
            }
        }), h.each(["toggle", "show", "hide"], function(e, t) {
            var n = h.fn[t];
            h.fn[t] = function(e, r, i) {
                return null == e || "boolean" == typeof e ? n.apply(this, arguments) : this.animate(un(t, !0), e, r, i)
            }
        }), h.each({
            slideDown: un("show"),
            slideUp: un("hide"),
            slideToggle: un("toggle"),
            fadeIn: {
                opacity: "show"
            },
            fadeOut: {
                opacity: "hide"
            },
            fadeToggle: {
                opacity: "toggle"
            }
        }, function(e, t) {
            h.fn[e] = function(e, n, r) {
                return this.animate(t, e, n, r)
            }
        }), h.timers = [], h.fx.tick = function() {
            var e, t = h.timers,
                n = 0;
            for (Yt = h.now(); n < t.length; n++) e = t[n], e() || t[n] !== e || t.splice(n--, 1);
            t.length || h.fx.stop(), Yt = void 0
        }, h.fx.timer = function(e) {
            h.timers.push(e), e() ? h.fx.start() : h.timers.pop()
        }, h.fx.interval = 13, h.fx.start = function() {
            Zt || (Zt = setInterval(h.fx.tick, h.fx.interval))
        }, h.fx.stop = function() {
            clearInterval(Zt), Zt = null
        }, h.fx.speeds = {
            slow: 600,
            fast: 200,
            _default: 400
        }, h.fn.delay = function(e, t) {
            return e = h.fx ? h.fx.speeds[e] || e : e, t = t || "fx", this.queue(t, function(t, n) {
                var r = setTimeout(t, e);
                n.stop = function() {
                    clearTimeout(r)
                }
            })
        },
        function() {
            var e, t, n, r, i;
            t = T.createElement("div"), t.setAttribute("className", "t"), t.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", r = t.getElementsByTagName("a")[0], n = T.createElement("select"), i = n.appendChild(T.createElement("option")), e = t.getElementsByTagName("input")[0], r.style.cssText = "top:1px", l.getSetAttribute = "t" !== t.className, l.style = /top/.test(r.getAttribute("style")), l.hrefNormalized = "/a" === r.getAttribute("href"), l.checkOn = !!e.value, l.optSelected = i.selected, l.enctype = !!T.createElement("form").enctype, n.disabled = !0, l.optDisabled = !i.disabled, e = T.createElement("input"), e.setAttribute("value", ""), l.input = "" === e.getAttribute("value"), e.value = "t", e.setAttribute("type", "radio"), l.radioValue = "t" === e.value
        }();
    var hn = /\r/g;
    h.fn.extend({
        val: function(e) {
            var t, n, r, i = this[0];
            if (arguments.length) return r = h.isFunction(e), this.each(function(n) {
                var i;
                1 === this.nodeType && (i = r ? e.call(this, n, h(this).val()) : e, null == i ? i = "" : "number" == typeof i ? i += "" : h.isArray(i) && (i = h.map(i, function(e) {
                    return null == e ? "" : e + ""
                })), t = h.valHooks[this.type] || h.valHooks[this.nodeName.toLowerCase()], t && "set" in t && void 0 !== t.set(this, i, "value") || (this.value = i))
            });
            if (i) return t = h.valHooks[i.type] || h.valHooks[i.nodeName.toLowerCase()], t && "get" in t && void 0 !== (n = t.get(i, "value")) ? n : (n = i.value, "string" == typeof n ? n.replace(hn, "") : null == n ? "" : n)
        }
    }), h.extend({
        valHooks: {
            option: {
                get: function(e) {
                    var t = h.find.attr(e, "value");
                    return null != t ? t : h.trim(h.text(e))
                }
            },
            select: {
                get: function(e) {
                    for (var t, n, r = e.options, i = e.selectedIndex, s = "select-one" === e.type || 0 > i, o = s ? null : [], u = s ? i + 1 : r.length, a = 0 > i ? u : s ? i : 0; u > a; a++)
                        if (n = r[a], !(!n.selected && a !== i || (l.optDisabled ? n.disabled : null !== n.getAttribute("disabled")) || n.parentNode.disabled && h.nodeName(n.parentNode, "optgroup"))) {
                            if (t = h(n).val(), s) return t;
                            o.push(t)
                        }
                    return o
                },
                set: function(e, t) {
                    var n, r, i = e.options,
                        s = h.makeArray(t),
                        o = i.length;
                    while (o--)
                        if (r = i[o], h.inArray(h.valHooks.option.get(r), s) >= 0) try {
                            r.selected = n = !0
                        } catch (u) {
                            r.scrollHeight
                        } else r.selected = !1;
                    return n || (e.selectedIndex = -1), i
                }
            }
        }
    }), h.each(["radio", "checkbox"], function() {
        h.valHooks[this] = {
            set: function(e, t) {
                return h.isArray(t) ? e.checked = h.inArray(h(e).val(), t) >= 0 : void 0
            }
        }, l.checkOn || (h.valHooks[this].get = function(e) {
            return null === e.getAttribute("value") ? "on" : e.value
        })
    });
    var pn, dn, vn = h.expr.attrHandle,
        mn = /^(?:checked|selected)$/i,
        gn = l.getSetAttribute,
        yn = l.input;
    h.fn.extend({
        attr: function(e, t) {
            return $(this, h.attr, e, t, arguments.length > 1)
        },
        removeAttr: function(e) {
            return this.each(function() {
                h.removeAttr(this, e)
            })
        }
    }), h.extend({
        attr: function(e, t, n) {
            var r, i, s = e.nodeType;
            if (e && 3 !== s && 8 !== s && 2 !== s) return typeof e.getAttribute === B ? h.prop(e, t, n) : (1 === s && h.isXMLDoc(e) || (t = t.toLowerCase(), r = h.attrHooks[t] || (h.expr.match.bool.test(t) ? dn : pn)), void 0 === n ? r && "get" in r && null !== (i = r.get(e, t)) ? i : (i = h.find.attr(e, t), null == i ? void 0 : i) : null !== n ? r && "set" in r && void 0 !== (i = r.set(e, n, t)) ? i : (e.setAttribute(t, n + ""), n) : void h.removeAttr(e, t))
        },
        removeAttr: function(e, t) {
            var n, r, i = 0,
                s = t && t.match(O);
            if (s && 1 === e.nodeType)
                while (n = s[i++]) r = h.propFix[n] || n, h.expr.match.bool.test(n) ? yn && gn || !mn.test(n) ? e[r] = !1 : e[h.camelCase("default-" + n)] = e[r] = !1 : h.attr(e, n, ""), e.removeAttribute(gn ? n : r)
        },
        attrHooks: {
            type: {
                set: function(e, t) {
                    if (!l.radioValue && "radio" === t && h.nodeName(e, "input")) {
                        var n = e.value;
                        return e.setAttribute("type", t), n && (e.value = n), t
                    }
                }
            }
        }
    }), dn = {
        set: function(e, t, n) {
            return t === !1 ? h.removeAttr(e, n) : yn && gn || !mn.test(n) ? e.setAttribute(!gn && h.propFix[n] || n, n) : e[h.camelCase("default-" + n)] = e[n] = !0, n
        }
    }, h.each(h.expr.match.bool.source.match(/\w+/g), function(e, t) {
        var n = vn[t] || h.find.attr;
        vn[t] = yn && gn || !mn.test(t) ? function(e, t, r) {
            var i, s;
            return r || (s = vn[t], vn[t] = i, i = null != n(e, t, r) ? t.toLowerCase() : null, vn[t] = s), i
        } : function(e, t, n) {
            return n ? void 0 : e[h.camelCase("default-" + t)] ? t.toLowerCase() : null
        }
    }), yn && gn || (h.attrHooks.value = {
        set: function(e, t, n) {
            return h.nodeName(e, "input") ? void(e.defaultValue = t) : pn && pn.set(e, t, n)
        }
    }), gn || (pn = {
        set: function(e, t, n) {
            var r = e.getAttributeNode(n);
            return r || e.setAttributeNode(r = e.ownerDocument.createAttribute(n)), r.value = t += "", "value" === n || t === e.getAttribute(n) ? t : void 0
        }
    }, vn.id = vn.name = vn.coords = function(e, t, n) {
        var r;
        return n ? void 0 : (r = e.getAttributeNode(t)) && "" !== r.value ? r.value : null
    }, h.valHooks.button = {
        get: function(e, t) {
            var n = e.getAttributeNode(t);
            return n && n.specified ? n.value : void 0
        },
        set: pn.set
    }, h.attrHooks.contenteditable = {
        set: function(e, t, n) {
            pn.set(e, "" === t ? !1 : t, n)
        }
    }, h.each(["width", "height"], function(e, t) {
        h.attrHooks[t] = {
            set: function(e, n) {
                return "" === n ? (e.setAttribute(t, "auto"), n) : void 0
            }
        }
    })), l.style || (h.attrHooks.style = {
        get: function(e) {
            return e.style.cssText || void 0
        },
        set: function(e, t) {
            return e.style.cssText = t + ""
        }
    });
    var bn = /^(?:input|select|textarea|button|object)$/i,
        wn = /^(?:a|area)$/i;
    h.fn.extend({
        prop: function(e, t) {
            return $(this, h.prop, e, t, arguments.length > 1)
        },
        removeProp: function(e) {
            return e = h.propFix[e] || e, this.each(function() {
                try {
                    this[e] = void 0, delete this[e]
                } catch (t) {}
            })
        }
    }), h.extend({
        propFix: {
            "for": "htmlFor",
            "class": "className"
        },
        prop: function(e, t, n) {
            var r, i, s, o = e.nodeType;
            if (e && 3 !== o && 8 !== o && 2 !== o) return s = 1 !== o || !h.isXMLDoc(e), s && (t = h.propFix[t] || t, i = h.propHooks[t]), void 0 !== n ? i && "set" in i && void 0 !== (r = i.set(e, n, t)) ? r : e[t] = n : i && "get" in i && null !== (r = i.get(e, t)) ? r : e[t]
        },
        propHooks: {
            tabIndex: {
                get: function(e) {
                    var t = h.find.attr(e, "tabindex");
                    return t ? parseInt(t, 10) : bn.test(e.nodeName) || wn.test(e.nodeName) && e.href ? 0 : -1
                }
            }
        }
    }), l.hrefNormalized || h.each(["href", "src"], function(e, t) {
        h.propHooks[t] = {
            get: function(e) {
                return e.getAttribute(t, 4)
            }
        }
    }), l.optSelected || (h.propHooks.selected = {
        get: function(e) {
            var t = e.parentNode;
            return t && (t.selectedIndex, t.parentNode && t.parentNode.selectedIndex), null
        }
    }), h.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function() {
        h.propFix[this.toLowerCase()] = this
    }), l.enctype || (h.propFix.enctype = "encoding");
    var En = /[\t\r\n\f]/g;
    h.fn.extend({
        addClass: function(e) {
            var t, n, r, i, s, o, u = 0,
                a = this.length,
                f = "string" == typeof e && e;
            if (h.isFunction(e)) return this.each(function(t) {
                h(this).addClass(e.call(this, t, this.className))
            });
            if (f)
                for (t = (e || "").match(O) || []; a > u; u++)
                    if (n = this[u], r = 1 === n.nodeType && (n.className ? (" " + n.className + " ").replace(En, " ") : " ")) {
                        s = 0;
                        while (i = t[s++]) r.indexOf(" " + i + " ") < 0 && (r += i + " ");
                        o = h.trim(r), n.className !== o && (n.className = o)
                    }
            return this
        },
        removeClass: function(e) {
            var t, n, r, i, s, o, u = 0,
                a = this.length,
                f = 0 === arguments.length || "string" == typeof e && e;
            if (h.isFunction(e)) return this.each(function(t) {
                h(this).removeClass(e.call(this, t, this.className))
            });
            if (f)
                for (t = (e || "").match(O) || []; a > u; u++)
                    if (n = this[u], r = 1 === n.nodeType && (n.className ? (" " + n.className + " ").replace(En, " ") : "")) {
                        s = 0;
                        while (i = t[s++])
                            while (r.indexOf(" " + i + " ") >= 0) r = r.replace(" " + i + " ", " ");
                        o = e ? h.trim(r) : "", n.className !== o && (n.className = o)
                    }
            return this
        },
        toggleClass: function(e, t) {
            var n = typeof e;
            return "boolean" == typeof t && "string" === n ? t ? this.addClass(e) : this.removeClass(e) : this.each(h.isFunction(e) ? function(n) {
                h(this).toggleClass(e.call(this, n, this.className, t), t)
            } : function() {
                if ("string" === n) {
                    var t, r = 0,
                        i = h(this),
                        s = e.match(O) || [];
                    while (t = s[r++]) i.hasClass(t) ? i.removeClass(t) : i.addClass(t)
                } else(n === B || "boolean" === n) && (this.className && h._data(this, "__className__", this.className), this.className = this.className || e === !1 ? "" : h._data(this, "__className__") || "")
            })
        },
        hasClass: function(e) {
            for (var t = " " + e + " ", n = 0, r = this.length; r > n; n++)
                if (1 === this[n].nodeType && (" " + this[n].className + " ").replace(En, " ").indexOf(t) >= 0) return !0;
            return !1
        }
    }), h.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function(e, t) {
        h.fn[t] = function(e, n) {
            return arguments.length > 0 ? this.on(t, null, e, n) : this.trigger(t)
        }
    }), h.fn.extend({
        hover: function(e, t) {
            return this.mouseenter(e).mouseleave(t || e)
        },
        bind: function(e, t, n) {
            return this.on(e, null, t, n)
        },
        unbind: function(e, t) {
            return this.off(e, null, t)
        },
        delegate: function(e, t, n, r) {
            return this.on(t, e, n, r)
        },
        undelegate: function(e, t, n) {
            return 1 === arguments.length ? this.off(e, "**") : this.off(t, e || "**", n)
        }
    });
    var Sn = h.now(),
        xn = /\?/,
        Tn = /(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;
    h.parseJSON = function(t) {
        if (e.JSON && e.JSON.parse) return e.JSON.parse(t + "");
        var n, r = null,
            i = h.trim(t + "");
        return i && !h.trim(i.replace(Tn, function(e, t, i, s) {
            return n && t && (r = 0), 0 === r ? e : (n = i || t, r += !s - !i, "")
        })) ? Function("return " + i)() : h.error("Invalid JSON: " + t)
    }, h.parseXML = function(t) {
        var n, r;
        if (!t || "string" != typeof t) return null;
        try {
            e.DOMParser ? (r = new DOMParser, n = r.parseFromString(t, "text/xml")) : (n = new ActiveXObject("Microsoft.XMLDOM"), n.async = "false", n.loadXML(t))
        } catch (i) {
            n = void 0
        }
        return n && n.documentElement && !n.getElementsByTagName("parsererror").length || h.error("Invalid XML: " + t), n
    };
    var Nn, Cn, kn = /#.*$/,
        Ln = /([?&])_=[^&]*/,
        An = /^(.*?):[ \t]*([^\r\n]*)\r?$/gm,
        On = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
        Mn = /^(?:GET|HEAD)$/,
        _n = /^\/\//,
        Dn = /^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,
        Pn = {},
        Hn = {},
        Bn = "*/".concat("*");
    try {
        Cn = location.href
    } catch (jn) {
        Cn = T.createElement("a"), Cn.href = "", Cn = Cn.href
    }
    Nn = Dn.exec(Cn.toLowerCase()) || [], h.extend({
        active: 0,
        lastModified: {},
        etag: {},
        ajaxSettings: {
            url: Cn,
            type: "GET",
            isLocal: On.test(Nn[1]),
            global: !0,
            processData: !0,
            async: !0,
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            accepts: {
                "*": Bn,
                text: "text/plain",
                html: "text/html",
                xml: "application/xml, text/xml",
                json: "application/json, text/javascript"
            },
            contents: {
                xml: /xml/,
                html: /html/,
                json: /json/
            },
            responseFields: {
                xml: "responseXML",
                text: "responseText",
                json: "responseJSON"
            },
            converters: {
                "* text": String,
                "text html": !0,
                "text json": h.parseJSON,
                "text xml": h.parseXML
            },
            flatOptions: {
                url: !0,
                context: !0
            }
        },
        ajaxSetup: function(e, t) {
            return t ? qn(qn(e, h.ajaxSettings), t) : qn(h.ajaxSettings, e)
        },
        ajaxPrefilter: Fn(Pn),
        ajaxTransport: Fn(Hn),
        ajax: function(e, t) {
            function x(e, t, n, r) {
                var f, g, y, w, S, x = t;
                2 !== b && (b = 2, o && clearTimeout(o), a = void 0, s = r || "", E.readyState = e > 0 ? 4 : 0, f = e >= 200 && 300 > e || 304 === e, n && (w = Rn(l, E, n)), w = Un(l, w, E, f), f ? (l.ifModified && (S = E.getResponseHeader("Last-Modified"), S && (h.lastModified[i] = S), S = E.getResponseHeader("etag"), S && (h.etag[i] = S)), 204 === e || "HEAD" === l.type ? x = "nocontent" : 304 === e ? x = "notmodified" : (x = w.state, g = w.data, y = w.error, f = !y)) : (y = x, (e || !x) && (x = "error", 0 > e && (e = 0))), E.status = e, E.statusText = (t || x) + "", f ? d.resolveWith(c, [g, x, E]) : d.rejectWith(c, [E, x, y]), E.statusCode(m), m = void 0, u && p.trigger(f ? "ajaxSuccess" : "ajaxError", [E, l, f ? g : y]), v.fireWith(c, [E, x]), u && (p.trigger("ajaxComplete", [E, l]), --h.active || h.event.trigger("ajaxStop")))
            }
            "object" == typeof e && (t = e, e = void 0), t = t || {};
            var n, r, i, s, o, u, a, f, l = h.ajaxSetup({}, t),
                c = l.context || l,
                p = l.context && (c.nodeType || c.jquery) ? h(c) : h.event,
                d = h.Deferred(),
                v = h.Callbacks("once memory"),
                m = l.statusCode || {},
                g = {},
                y = {},
                b = 0,
                w = "canceled",
                E = {
                    readyState: 0,
                    getResponseHeader: function(e) {
                        var t;
                        if (2 === b) {
                            if (!f) {
                                f = {};
                                while (t = An.exec(s)) f[t[1].toLowerCase()] = t[2]
                            }
                            t = f[e.toLowerCase()]
                        }
                        return null == t ? null : t
                    },
                    getAllResponseHeaders: function() {
                        return 2 === b ? s : null
                    },
                    setRequestHeader: function(e, t) {
                        var n = e.toLowerCase();
                        return b || (e = y[n] = y[n] || e, g[e] = t), this
                    },
                    overrideMimeType: function(e) {
                        return b || (l.mimeType = e), this
                    },
                    statusCode: function(e) {
                        var t;
                        if (e)
                            if (2 > b)
                                for (t in e) m[t] = [m[t], e[t]];
                            else E.always(e[E.status]);
                        return this
                    },
                    abort: function(e) {
                        var t = e || w;
                        return a && a.abort(t), x(0, t), this
                    }
                };
            if (d.promise(E).complete = v.add, E.success = E.done, E.error = E.fail, l.url = ((e || l.url || Cn) + "").replace(kn, "").replace(_n, Nn[1] + "//"), l.type = t.method || t.type || l.method || l.type, l.dataTypes = h.trim(l.dataType || "*").toLowerCase().match(O) || [""], null == l.crossDomain && (n = Dn.exec(l.url.toLowerCase()), l.crossDomain = !(!n || n[1] === Nn[1] && n[2] === Nn[2] && (n[3] || ("http:" === n[1] ? "80" : "443")) === (Nn[3] || ("http:" === Nn[1] ? "80" : "443")))), l.data && l.processData && "string" != typeof l.data && (l.data = h.param(l.data, l.traditional)), In(Pn, l, t, E), 2 === b) return E;
            u = h.event && l.global, u && 0 === h.active++ && h.event.trigger("ajaxStart"), l.type = l.type.toUpperCase(), l.hasContent = !Mn.test(l.type), i = l.url, l.hasContent || (l.data && (i = l.url += (xn.test(i) ? "&" : "?") + l.data, delete l.data), l.cache === !1 && (l.url = Ln.test(i) ? i.replace(Ln, "$1_=" + Sn++) : i + (xn.test(i) ? "&" : "?") + "_=" + Sn++)), l.ifModified && (h.lastModified[i] && E.setRequestHeader("If-Modified-Since", h.lastModified[i]), h.etag[i] && E.setRequestHeader("If-None-Match", h.etag[i])), (l.data && l.hasContent && l.contentType !== !1 || t.contentType) && E.setRequestHeader("Content-Type", l.contentType), E.setRequestHeader("Accept", l.dataTypes[0] && l.accepts[l.dataTypes[0]] ? l.accepts[l.dataTypes[0]] + ("*" !== l.dataTypes[0] ? ", " + Bn + "; q=0.01" : "") : l.accepts["*"]);
            for (r in l.headers) E.setRequestHeader(r, l.headers[r]);
            if (!l.beforeSend || l.beforeSend.call(c, E, l) !== !1 && 2 !== b) {
                w = "abort";
                for (r in {
                        success: 1,
                        error: 1,
                        complete: 1
                    }) E[r](l[r]);
                if (a = In(Hn, l, t, E)) {
                    E.readyState = 1, u && p.trigger("ajaxSend", [E, l]), l.async && l.timeout > 0 && (o = setTimeout(function() {
                        E.abort("timeout")
                    }, l.timeout));
                    try {
                        b = 1, a.send(g, x)
                    } catch (S) {
                        if (!(2 > b)) throw S;
                        x(-1, S)
                    }
                } else x(-1, "No Transport");
                return E
            }
            return E.abort()
        },
        getJSON: function(e, t, n) {
            return h.get(e, t, n, "json")
        },
        getScript: function(e, t) {
            return h.get(e, void 0, t, "script")
        }
    }), h.each(["get", "post"], function(e, t) {
        h[t] = function(e, n, r, i) {
            return h.isFunction(n) && (i = i || r, r = n, n = void 0), h.ajax({
                url: e,
                type: t,
                dataType: i,
                data: n,
                success: r
            })
        }
    }), h._evalUrl = function(e) {
        return h.ajax({
            url: e,
            type: "GET",
            dataType: "script",
            async: !1,
            global: !1,
            "throws": !0
        })
    }, h.fn.extend({
        wrapAll: function(e) {
            if (h.isFunction(e)) return this.each(function(t) {
                h(this).wrapAll(e.call(this, t))
            });
            if (this[0]) {
                var t = h(e, this[0].ownerDocument).eq(0).clone(!0);
                this[0].parentNode && t.insertBefore(this[0]), t.map(function() {
                    var e = this;
                    while (e.firstChild && 1 === e.firstChild.nodeType) e = e.firstChild;
                    return e
                }).append(this)
            }
            return this
        },
        wrapInner: function(e) {
            return this.each(h.isFunction(e) ? function(t) {
                h(this).wrapInner(e.call(this, t))
            } : function() {
                var t = h(this),
                    n = t.contents();
                n.length ? n.wrapAll(e) : t.append(e)
            })
        },
        wrap: function(e) {
            var t = h.isFunction(e);
            return this.each(function(n) {
                h(this).wrapAll(t ? e.call(this, n) : e)
            })
        },
        unwrap: function() {
            return this.parent().each(function() {
                h.nodeName(this, "body") || h(this).replaceWith(this.childNodes)
            }).end()
        }
    }), h.expr.filters.hidden = function(e) {
        return e.offsetWidth <= 0 && e.offsetHeight <= 0 || !l.reliableHiddenOffsets() && "none" === (e.style && e.style.display || h.css(e, "display"))
    }, h.expr.filters.visible = function(e) {
        return !h.expr.filters.hidden(e)
    };
    var zn = /%20/g,
        Wn = /\[\]$/,
        Xn = /\r?\n/g,
        Vn = /^(?:submit|button|image|reset|file)$/i,
        $n = /^(?:input|select|textarea|keygen)/i;
    h.param = function(e, t) {
        var n, r = [],
            i = function(e, t) {
                t = h.isFunction(t) ? t() : null == t ? "" : t, r[r.length] = encodeURIComponent(e) + "=" + encodeURIComponent(t)
            };
        if (void 0 === t && (t = h.ajaxSettings && h.ajaxSettings.traditional), h.isArray(e) || e.jquery && !h.isPlainObject(e)) h.each(e, function() {
            i(this.name, this.value)
        });
        else
            for (n in e) Jn(n, e[n], t, i);
        return r.join("&").replace(zn, "+")
    }, h.fn.extend({
        serialize: function() {
            return h.param(this.serializeArray())
        },
        serializeArray: function() {
            return this.map(function() {
                var e = h.prop(this, "elements");
                return e ? h.makeArray(e) : this
            }).filter(function() {
                var e = this.type;
                return this.name && !h(this).is(":disabled") && $n.test(this.nodeName) && !Vn.test(e) && (this.checked || !J.test(e))
            }).map(function(e, t) {
                var n = h(this).val();
                return null == n ? null : h.isArray(n) ? h.map(n, function(e) {
                    return {
                        name: t.name,
                        value: e.replace(Xn, "\r\n")
                    }
                }) : {
                    name: t.name,
                    value: n.replace(Xn, "\r\n")
                }
            }).get()
        }
    }), h.ajaxSettings.xhr = void 0 !== e.ActiveXObject ? function() {
        return !this.isLocal && /^(get|post|head|put|delete|options)$/i.test(this.type) && Yn() || Zn()
    } : Yn;
    var Kn = 0,
        Qn = {},
        Gn = h.ajaxSettings.xhr();
    e.attachEvent && e.attachEvent("onunload", function() {
        for (var e in Qn) Qn[e](void 0, !0)
    }), l.cors = !!Gn && "withCredentials" in Gn, Gn = l.ajax = !!Gn, Gn && h.ajaxTransport(function(e) {
        if (!e.crossDomain || l.cors) {
            var t;
            return {
                send: function(n, r) {
                    var i, s = e.xhr(),
                        o = ++Kn;
                    if (s.open(e.type, e.url, e.async, e.username, e.password), e.xhrFields)
                        for (i in e.xhrFields) s[i] = e.xhrFields[i];
                    e.mimeType && s.overrideMimeType && s.overrideMimeType(e.mimeType), e.crossDomain || n["X-Requested-With"] || (n["X-Requested-With"] = "XMLHttpRequest");
                    for (i in n) void 0 !== n[i] && s.setRequestHeader(i, n[i] + "");
                    s.send(e.hasContent && e.data || null), t = function(n, i) {
                        var u, a, f;
                        if (t && (i || 4 === s.readyState))
                            if (delete Qn[o], t = void 0, s.onreadystatechange = h.noop, i) 4 !== s.readyState && s.abort();
                            else {
                                f = {}, u = s.status, "string" == typeof s.responseText && (f.text = s.responseText);
                                try {
                                    a = s.statusText
                                } catch (l) {
                                    a = ""
                                }
                                u || !e.isLocal || e.crossDomain ? 1223 === u && (u = 204) : u = f.text ? 200 : 404
                            }
                        f && r(u, a, f, s.getAllResponseHeaders())
                    }, e.async ? 4 === s.readyState ? setTimeout(t) : s.onreadystatechange = Qn[o] = t : t()
                },
                abort: function() {
                    t && t(void 0, !0)
                }
            }
        }
    }), h.ajaxSetup({
        accepts: {
            script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
        },
        contents: {
            script: /(?:java|ecma)script/
        },
        converters: {
            "text script": function(e) {
                return h.globalEval(e), e
            }
        }
    }), h.ajaxPrefilter("script", function(e) {
        void 0 === e.cache && (e.cache = !1), e.crossDomain && (e.type = "GET", e.global = !1)
    }), h.ajaxTransport("script", function(e) {
        if (e.crossDomain) {
            var t, n = T.head || h("head")[0] || T.documentElement;
            return {
                send: function(r, i) {
                    t = T.createElement("script"), t.async = !0, e.scriptCharset && (t.charset = e.scriptCharset), t.src = e.url, t.onload = t.onreadystatechange = function(e, n) {
                        (n || !t.readyState || /loaded|complete/.test(t.readyState)) && (t.onload = t.onreadystatechange = null, t.parentNode && t.parentNode.removeChild(t), t = null, n || i(200, "success"))
                    }, n.insertBefore(t, n.firstChild)
                },
                abort: function() {
                    t && t.onload(void 0, !0)
                }
            }
        }
    });
    var er = [],
        tr = /(=)\?(?=&|$)|\?\?/;
    h.ajaxSetup({
        jsonp: "callback",
        jsonpCallback: function() {
            var e = er.pop() || h.expando + "_" + Sn++;
            return this[e] = !0, e
        }
    }), h.ajaxPrefilter("json jsonp", function(t, n, r) {
        var i, s, o, u = t.jsonp !== !1 && (tr.test(t.url) ? "url" : "string" == typeof t.data && !(t.contentType || "").indexOf("application/x-www-form-urlencoded") && tr.test(t.data) && "data");
        return u || "jsonp" === t.dataTypes[0] ? (i = t.jsonpCallback = h.isFunction(t.jsonpCallback) ? t.jsonpCallback() : t.jsonpCallback, u ? t[u] = t[u].replace(tr, "$1" + i) : t.jsonp !== !1 && (t.url += (xn.test(t.url) ? "&" : "?") + t.jsonp + "=" + i), t.converters["script json"] = function() {
            return o || h.error(i + " was not called"), o[0]
        }, t.dataTypes[0] = "json", s = e[i], e[i] = function() {
            o = arguments
        }, r.always(function() {
            e[i] = s, t[i] && (t.jsonpCallback = n.jsonpCallback, er.push(i)), o && h.isFunction(s) && s(o[0]), o = s = void 0
        }), "script") : void 0
    }), h.parseHTML = function(e, t, n) {
        if (!e || "string" != typeof e) return null;
        "boolean" == typeof t && (n = t, t = !1), t = t || T;
        var r = w.exec(e),
            i = !n && [];
        return r ? [t.createElement(r[1])] : (r = h.buildFragment([e], t, i), i && i.length && h(i).remove(), h.merge([], r.childNodes))
    };
    var nr = h.fn.load;
    h.fn.load = function(e, t, n) {
        if ("string" != typeof e && nr) return nr.apply(this, arguments);
        var r, i, s, o = this,
            u = e.indexOf(" ");
        return u >= 0 && (r = h.trim(e.slice(u, e.length)), e = e.slice(0, u)), h.isFunction(t) ? (n = t, t = void 0) : t && "object" == typeof t && (s = "POST"), o.length > 0 && h.ajax({
            url: e,
            type: s,
            dataType: "html",
            data: t
        }).done(function(e) {
            i = arguments, o.html(r ? h("<div>").append(h.parseHTML(e)).find(r) : e)
        }).complete(n && function(e, t) {
            o.each(n, i || [e.responseText, t, e])
        }), this
    }, h.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function(e, t) {
        h.fn[t] = function(e) {
            return this.on(t, e)
        }
    }), h.expr.filters.animated = function(e) {
        return h.grep(h.timers, function(t) {
            return e === t.elem
        }).length
    };
    var rr = e.document.documentElement;
    h.offset = {
        setOffset: function(e, t, n) {
            var r, i, s, o, u, a, f, l = h.css(e, "position"),
                c = h(e),
                p = {};
            "static" === l && (e.style.position = "relative"), u = c.offset(), s = h.css(e, "top"), a = h.css(e, "left"), f = ("absolute" === l || "fixed" === l) && h.inArray("auto", [s, a]) > -1, f ? (r = c.position(), o = r.top, i = r.left) : (o = parseFloat(s) || 0, i = parseFloat(a) || 0), h.isFunction(t) && (t = t.call(e, n, u)), null != t.top && (p.top = t.top - u.top + o), null != t.left && (p.left = t.left - u.left + i), "using" in t ? t.using.call(e, p) : c.css(p)
        }
    }, h.fn.extend({
        offset: function(e) {
            if (arguments.length) return void 0 === e ? this : this.each(function(t) {
                h.offset.setOffset(this, e, t)
            });
            var t, n, r = {
                    top: 0,
                    left: 0
                },
                i = this[0],
                s = i && i.ownerDocument;
            if (s) return t = s.documentElement, h.contains(t, i) ? (typeof i.getBoundingClientRect !== B && (r = i.getBoundingClientRect()), n = ir(s), {
                top: r.top + (n.pageYOffset || t.scrollTop) - (t.clientTop || 0),
                left: r.left + (n.pageXOffset || t.scrollLeft) - (t.clientLeft || 0)
            }) : r
        },
        position: function() {
            if (this[0]) {
                var e, t, n = {
                        top: 0,
                        left: 0
                    },
                    r = this[0];
                return "fixed" === h.css(r, "position") ? t = r.getBoundingClientRect() : (e = this.offsetParent(), t = this.offset(), h.nodeName(e[0], "html") || (n = e.offset()), n.top += h.css(e[0], "borderTopWidth", !0), n.left += h.css(e[0], "borderLeftWidth", !0)), {
                    top: t.top - n.top - h.css(r, "marginTop", !0),
                    left: t.left - n.left - h.css(r, "marginLeft", !0)
                }
            }
        },
        offsetParent: function() {
            return this.map(function() {
                var e = this.offsetParent || rr;
                while (e && !h.nodeName(e, "html") && "static" === h.css(e, "position")) e = e.offsetParent;
                return e || rr
            })
        }
    }), h.each({
        scrollLeft: "pageXOffset",
        scrollTop: "pageYOffset"
    }, function(e, t) {
        var n = /Y/.test(t);
        h.fn[e] = function(r) {
            return $(this, function(e, r, i) {
                var s = ir(e);
                return void 0 === i ? s ? t in s ? s[t] : s.document.documentElement[r] : e[r] : void(s ? s.scrollTo(n ? h(s).scrollLeft() : i, n ? i : h(s).scrollTop()) : e[r] = i)
            }, e, r, arguments.length, null)
        }
    }), h.each(["top", "left"], function(e, t) {
        h.cssHooks[t] = jt(l.pixelPosition, function(e, n) {
            return n ? (n = Ht(e, t), Dt.test(n) ? h(e).position()[t] + "px" : n) : void 0
        })
    }), h.each({
        Height: "height",
        Width: "width"
    }, function(e, t) {
        h.each({
            padding: "inner" + e,
            content: t,
            "": "outer" + e
        }, function(n, r) {
            h.fn[r] = function(r, i) {
                var s = arguments.length && (n || "boolean" != typeof r),
                    o = n || (r === !0 || i === !0 ? "margin" : "border");
                return $(this, function(t, n, r) {
                    var i;
                    return h.isWindow(t) ? t.document.documentElement["client" + e] : 9 === t.nodeType ? (i = t.documentElement, Math.max(t.body["scroll" + e], i["scroll" + e], t.body["offset" + e], i["offset" + e], i["client" + e])) : void 0 === r ? h.css(t, n, o) : h.style(t, n, r, o)
                }, t, s ? r : void 0, s, null)
            }
        })
    }), h.fn.size = function() {
        return this.length
    }, h.fn.andSelf = h.fn.addBack, "function" == typeof define && define.amd && define("jquery", [], function() {
        return h
    });
    var sr = e.jQuery,
        or = e.$;
    return h.noConflict = function(t) {
        return e.$ === h && (e.$ = or), t && e.jQuery === h && (e.jQuery = sr), h
    }, typeof t === B && (e.jQuery = e.$ = h), h
}),
function() {
    function e(e) {
        function t(t, n, r, i, s, o) {
            for (; s >= 0 && o > s; s += e) {
                var u = i ? i[s] : s;
                r = n(r, t[u], u, t)
            }
            return r
        }
        return function(n, r, i, s) {
            r = b(r, s, 4);
            var o = !C(n) && y.keys(n),
                u = (o || n).length,
                a = e > 0 ? 0 : u - 1;
            return arguments.length < 3 && (i = n[o ? o[a] : a], a += e), t(n, r, i, o, a, u)
        }
    }

    function t(e) {
        return function(t, n, r) {
            n = w(n, r);
            for (var i = N(t), s = e > 0 ? 0 : i - 1; s >= 0 && i > s; s += e)
                if (n(t[s], s, t)) return s;
            return -1
        }
    }

    function n(e, t, n) {
        return function(r, i, s) {
            var o = 0,
                u = N(r);
            if ("number" == typeof s) e > 0 ? o = s >= 0 ? s : Math.max(s + u, o) : u = s >= 0 ? Math.min(s + 1, u) : s + u + 1;
            else if (n && s && u) return s = n(r, i), r[s] === i ? s : -1;
            if (i !== i) return s = t(l.call(r, o, u), y.isNaN), s >= 0 ? s + o : -1;
            for (s = e > 0 ? o : u - 1; s >= 0 && u > s; s += e)
                if (r[s] === i) return s;
            return -1
        }
    }

    function r(e, t) {
        var n = M.length,
            r = e.constructor,
            i = y.isFunction(r) && r.prototype || u,
            s = "constructor";
        for (y.has(e, s) && !y.contains(t, s) && t.push(s); n--;) s = M[n], s in e && e[s] !== i[s] && !y.contains(t, s) && t.push(s)
    }
    var i = this,
        s = i._,
        o = Array.prototype,
        u = Object.prototype,
        a = Function.prototype,
        f = o.push,
        l = o.slice,
        c = u.toString,
        h = u.hasOwnProperty,
        p = Array.isArray,
        d = Object.keys,
        v = a.bind,
        m = Object.create,
        g = function() {},
        y = function(e) {
            return e instanceof y ? e : this instanceof y ? void(this._wrapped = e) : new y(e)
        };
    "undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = y), exports._ = y) : i._ = y, y.VERSION = "1.8.3";
    var b = function(e, t, n) {
            if (t === void 0) return e;
            switch (null == n ? 3 : n) {
                case 1:
                    return function(n) {
                        return e.call(t, n)
                    };
                case 2:
                    return function(n, r) {
                        return e.call(t, n, r)
                    };
                case 3:
                    return function(n, r, i) {
                        return e.call(t, n, r, i)
                    };
                case 4:
                    return function(n, r, i, s) {
                        return e.call(t, n, r, i, s)
                    }
            }
            return function() {
                return e.apply(t, arguments)
            }
        },
        w = function(e, t, n) {
            return null == e ? y.identity : y.isFunction(e) ? b(e, t, n) : y.isObject(e) ? y.matcher(e) : y.property(e)
        };
    y.iteratee = function(e, t) {
        return w(e, t, 1 / 0)
    };
    var E = function(e, t) {
            return function(n) {
                var r = arguments.length;
                if (2 > r || null == n) return n;
                for (var i = 1; r > i; i++)
                    for (var s = arguments[i], o = e(s), u = o.length, a = 0; u > a; a++) {
                        var f = o[a];
                        t && n[f] !== void 0 || (n[f] = s[f])
                    }
                return n
            }
        },
        S = function(e) {
            if (!y.isObject(e)) return {};
            if (m) return m(e);
            g.prototype = e;
            var t = new g;
            return g.prototype = null, t
        },
        x = function(e) {
            return function(t) {
                return null == t ? void 0 : t[e]
            }
        },
        T = Math.pow(2, 53) - 1,
        N = x("length"),
        C = function(e) {
            var t = N(e);
            return "number" == typeof t && t >= 0 && T >= t
        };
    y.each = y.forEach = function(e, t, n) {
        t = b(t, n);
        var r, i;
        if (C(e))
            for (r = 0, i = e.length; i > r; r++) t(e[r], r, e);
        else {
            var s = y.keys(e);
            for (r = 0, i = s.length; i > r; r++) t(e[s[r]], s[r], e)
        }
        return e
    }, y.map = y.collect = function(e, t, n) {
        t = w(t, n);
        for (var r = !C(e) && y.keys(e), i = (r || e).length, s = Array(i), o = 0; i > o; o++) {
            var u = r ? r[o] : o;
            s[o] = t(e[u], u, e)
        }
        return s
    }, y.reduce = y.foldl = y.inject = e(1), y.reduceRight = y.foldr = e(-1), y.find = y.detect = function(e, t, n) {
        var r;
        return r = C(e) ? y.findIndex(e, t, n) : y.findKey(e, t, n), r !== void 0 && r !== -1 ? e[r] : void 0
    }, y.filter = y.select = function(e, t, n) {
        var r = [];
        return t = w(t, n), y.each(e, function(e, n, i) {
            t(e, n, i) && r.push(e)
        }), r
    }, y.reject = function(e, t, n) {
        return y.filter(e, y.negate(w(t)), n)
    }, y.every = y.all = function(e, t, n) {
        t = w(t, n);
        for (var r = !C(e) && y.keys(e), i = (r || e).length, s = 0; i > s; s++) {
            var o = r ? r[s] : s;
            if (!t(e[o], o, e)) return !1
        }
        return !0
    }, y.some = y.any = function(e, t, n) {
        t = w(t, n);
        for (var r = !C(e) && y.keys(e), i = (r || e).length, s = 0; i > s; s++) {
            var o = r ? r[s] : s;
            if (t(e[o], o, e)) return !0
        }
        return !1
    }, y.contains = y.includes = y.include = function(e, t, n, r) {
        return C(e) || (e = y.values(e)), ("number" != typeof n || r) && (n = 0), y.indexOf(e, t, n) >= 0
    }, y.invoke = function(e, t) {
        var n = l.call(arguments, 2),
            r = y.isFunction(t);
        return y.map(e, function(e) {
            var i = r ? t : e[t];
            return null == i ? i : i.apply(e, n)
        })
    }, y.pluck = function(e, t) {
        return y.map(e, y.property(t))
    }, y.where = function(e, t) {
        return y.filter(e, y.matcher(t))
    }, y.findWhere = function(e, t) {
        return y.find(e, y.matcher(t))
    }, y.max = function(e, t, n) {
        var r, i, s = -1 / 0,
            o = -1 / 0;
        if (null == t && null != e) {
            e = C(e) ? e : y.values(e);
            for (var u = 0, a = e.length; a > u; u++) r = e[u], r > s && (s = r)
        } else t = w(t, n), y.each(e, function(e, n, r) {
            i = t(e, n, r), (i > o || i === -1 / 0 && s === -1 / 0) && (s = e, o = i)
        });
        return s
    }, y.min = function(e, t, n) {
        var r, i, s = 1 / 0,
            o = 1 / 0;
        if (null == t && null != e) {
            e = C(e) ? e : y.values(e);
            for (var u = 0, a = e.length; a > u; u++) r = e[u], s > r && (s = r)
        } else t = w(t, n), y.each(e, function(e, n, r) {
            i = t(e, n, r), (o > i || 1 / 0 === i && 1 / 0 === s) && (s = e, o = i)
        });
        return s
    }, y.shuffle = function(e) {
        for (var t, n = C(e) ? e : y.values(e), r = n.length, i = Array(r), s = 0; r > s; s++) t = y.random(0, s), t !== s && (i[s] = i[t]), i[t] = n[s];
        return i
    }, y.sample = function(e, t, n) {
        return null == t || n ? (C(e) || (e = y.values(e)), e[y.random(e.length - 1)]) : y.shuffle(e).slice(0, Math.max(0, t))
    }, y.sortBy = function(e, t, n) {
        return t = w(t, n), y.pluck(y.map(e, function(e, n, r) {
            return {
                value: e,
                index: n,
                criteria: t(e, n, r)
            }
        }).sort(function(e, t) {
            var n = e.criteria,
                r = t.criteria;
            if (n !== r) {
                if (n > r || n === void 0) return 1;
                if (r > n || r === void 0) return -1
            }
            return e.index - t.index
        }), "value")
    };
    var k = function(e) {
        return function(t, n, r) {
            var i = {};
            return n = w(n, r), y.each(t, function(r, s) {
                var o = n(r, s, t);
                e(i, r, o)
            }), i
        }
    };
    y.groupBy = k(function(e, t, n) {
        y.has(e, n) ? e[n].push(t) : e[n] = [t]
    }), y.indexBy = k(function(e, t, n) {
        e[n] = t
    }), y.countBy = k(function(e, t, n) {
        y.has(e, n) ? e[n]++ : e[n] = 1
    }), y.toArray = function(e) {
        return e ? y.isArray(e) ? l.call(e) : C(e) ? y.map(e, y.identity) : y.values(e) : []
    }, y.size = function(e) {
        return null == e ? 0 : C(e) ? e.length : y.keys(e).length
    }, y.partition = function(e, t, n) {
        t = w(t, n);
        var r = [],
            i = [];
        return y.each(e, function(e, n, s) {
            (t(e, n, s) ? r : i).push(e)
        }), [r, i]
    }, y.first = y.head = y.take = function(e, t, n) {
        return null == e ? void 0 : null == t || n ? e[0] : y.initial(e, e.length - t)
    }, y.initial = function(e, t, n) {
        return l.call(e, 0, Math.max(0, e.length - (null == t || n ? 1 : t)))
    }, y.last = function(e, t, n) {
        return null == e ? void 0 : null == t || n ? e[e.length - 1] : y.rest(e, Math.max(0, e.length - t))
    }, y.rest = y.tail = y.drop = function(e, t, n) {
        return l.call(e, null == t || n ? 1 : t)
    }, y.compact = function(e) {
        return y.filter(e, y.identity)
    };
    var L = function(e, t, n, r) {
        for (var i = [], s = 0, o = r || 0, u = N(e); u > o; o++) {
            var a = e[o];
            if (C(a) && (y.isArray(a) || y.isArguments(a))) {
                t || (a = L(a, t, n));
                var f = 0,
                    l = a.length;
                for (i.length += l; l > f;) i[s++] = a[f++]
            } else n || (i[s++] = a)
        }
        return i
    };
    y.flatten = function(e, t) {
        return L(e, t, !1)
    }, y.without = function(e) {
        return y.difference(e, l.call(arguments, 1))
    }, y.uniq = y.unique = function(e, t, n, r) {
        y.isBoolean(t) || (r = n, n = t, t = !1), null != n && (n = w(n, r));
        for (var i = [], s = [], o = 0, u = N(e); u > o; o++) {
            var a = e[o],
                f = n ? n(a, o, e) : a;
            t ? (o && s === f || i.push(a), s = f) : n ? y.contains(s, f) || (s.push(f), i.push(a)) : y.contains(i, a) || i.push(a)
        }
        return i
    }, y.union = function() {
        return y.uniq(L(arguments, !0, !0))
    }, y.intersection = function(e) {
        for (var t = [], n = arguments.length, r = 0, i = N(e); i > r; r++) {
            var s = e[r];
            if (!y.contains(t, s)) {
                for (var o = 1; n > o && y.contains(arguments[o], s); o++);
                o === n && t.push(s)
            }
        }
        return t
    }, y.difference = function(e) {
        var t = L(arguments, !0, !0, 1);
        return y.filter(e, function(e) {
            return !y.contains(t, e)
        })
    }, y.zip = function() {
        return y.unzip(arguments)
    }, y.unzip = function(e) {
        for (var t = e && y.max(e, N).length || 0, n = Array(t), r = 0; t > r; r++) n[r] = y.pluck(e, r);
        return n
    }, y.object = function(e, t) {
        for (var n = {}, r = 0, i = N(e); i > r; r++) t ? n[e[r]] = t[r] : n[e[r][0]] = e[r][1];
        return n
    }, y.findIndex = t(1), y.findLastIndex = t(-1), y.sortedIndex = function(e, t, n, r) {
        n = w(n, r, 1);
        for (var i = n(t), s = 0, o = N(e); o > s;) {
            var u = Math.floor((s + o) / 2);
            n(e[u]) < i ? s = u + 1 : o = u
        }
        return s
    }, y.indexOf = n(1, y.findIndex, y.sortedIndex), y.lastIndexOf = n(-1, y.findLastIndex), y.range = function(e, t, n) {
        null == t && (t = e || 0, e = 0), n = n || 1;
        for (var r = Math.max(Math.ceil((t - e) / n), 0), i = Array(r), s = 0; r > s; s++, e += n) i[s] = e;
        return i
    };
    var A = function(e, t, n, r, i) {
        if (r instanceof t) {
            var s = S(e.prototype),
                o = e.apply(s, i);
            return y.isObject(o) ? o : s
        }
        return e.apply(n, i)
    };
    y.bind = function(e, t) {
        if (v && e.bind === v) return v.apply(e, l.call(arguments, 1));
        if (!y.isFunction(e)) throw new TypeError("Bind must be called on a function");
        var n = l.call(arguments, 2),
            r = function() {
                return A(e, r, t, this, n.concat(l.call(arguments)))
            };
        return r
    }, y.partial = function(e) {
        var t = l.call(arguments, 1),
            n = function() {
                for (var r = 0, i = t.length, s = Array(i), o = 0; i > o; o++) s[o] = t[o] === y ? arguments[r++] : t[o];
                for (; r < arguments.length;) s.push(arguments[r++]);
                return A(e, n, this, this, s)
            };
        return n
    }, y.bindAll = function(e) {
        var t, n, r = arguments.length;
        if (1 >= r) throw new Error("bindAll must be passed function names");
        for (t = 1; r > t; t++) n = arguments[t], e[n] = y.bind(e[n], e);
        return e
    }, y.memoize = function(e, t) {
        var n = function(r) {
            var i = n.cache,
                s = "" + (t ? t.apply(this, arguments) : r);
            return y.has(i, s) || (i[s] = e.apply(this, arguments)), i[s]
        };
        return n.cache = {}, n
    }, y.delay = function(e, t) {
        var n = l.call(arguments, 2);
        return setTimeout(function() {
            return e.apply(null, n)
        }, t)
    }, y.defer = y.partial(y.delay, y, 1), y.throttle = function(e, t, n) {
        var r, i, s, o = null,
            u = 0;
        n || (n = {});
        var a = function() {
            u = n.leading === !1 ? 0 : y.now(), o = null, s = e.apply(r, i), o || (r = i = null)
        };
        return function() {
            var f = y.now();
            u || n.leading !== !1 || (u = f);
            var l = t - (f - u);
            return r = this, i = arguments, 0 >= l || l > t ? (o && (clearTimeout(o), o = null), u = f, s = e.apply(r, i), o || (r = i = null)) : o || n.trailing === !1 || (o = setTimeout(a, l)), s
        }
    }, y.debounce = function(e, t, n) {
        var r, i, s, o, u, a = function() {
            var f = y.now() - o;
            t > f && f >= 0 ? r = setTimeout(a, t - f) : (r = null, n || (u = e.apply(s, i), r || (s = i = null)))
        };
        return function() {
            s = this, i = arguments, o = y.now();
            var f = n && !r;
            return r || (r = setTimeout(a, t)), f && (u = e.apply(s, i), s = i = null), u
        }
    }, y.wrap = function(e, t) {
        return y.partial(t, e)
    }, y.negate = function(e) {
        return function() {
            return !e.apply(this, arguments)
        }
    }, y.compose = function() {
        var e = arguments,
            t = e.length - 1;
        return function() {
            for (var n = t, r = e[t].apply(this, arguments); n--;) r = e[n].call(this, r);
            return r
        }
    }, y.after = function(e, t) {
        return function() {
            return --e < 1 ? t.apply(this, arguments) : void 0
        }
    }, y.before = function(e, t) {
        var n;
        return function() {
            return --e > 0 && (n = t.apply(this, arguments)), 1 >= e && (t = null), n
        }
    }, y.once = y.partial(y.before, 2);
    var O = !{
            toString: null
        }.propertyIsEnumerable("toString"),
        M = ["valueOf", "isPrototypeOf", "toString", "propertyIsEnumerable", "hasOwnProperty", "toLocaleString"];
    y.keys = function(e) {
        if (!y.isObject(e)) return [];
        if (d) return d(e);
        var t = [];
        for (var n in e) y.has(e, n) && t.push(n);
        return O && r(e, t), t
    }, y.allKeys = function(e) {
        if (!y.isObject(e)) return [];
        var t = [];
        for (var n in e) t.push(n);
        return O && r(e, t), t
    }, y.values = function(e) {
        for (var t = y.keys(e), n = t.length, r = Array(n), i = 0; n > i; i++) r[i] = e[t[i]];
        return r
    }, y.mapObject = function(e, t, n) {
        t = w(t, n);
        for (var r, i = y.keys(e), s = i.length, o = {}, u = 0; s > u; u++) r = i[u], o[r] = t(e[r], r, e);
        return o
    }, y.pairs = function(e) {
        for (var t = y.keys(e), n = t.length, r = Array(n), i = 0; n > i; i++) r[i] = [t[i], e[t[i]]];
        return r
    }, y.invert = function(e) {
        for (var t = {}, n = y.keys(e), r = 0, i = n.length; i > r; r++) t[e[n[r]]] = n[r];
        return t
    }, y.functions = y.methods = function(e) {
        var t = [];
        for (var n in e) y.isFunction(e[n]) && t.push(n);
        return t.sort()
    }, y.extend = E(y.allKeys), y.extendOwn = y.assign = E(y.keys), y.findKey = function(e, t, n) {
        t = w(t, n);
        for (var r, i = y.keys(e), s = 0, o = i.length; o > s; s++)
            if (r = i[s], t(e[r], r, e)) return r
    }, y.pick = function(e, t, n) {
        var r, i, s = {},
            o = e;
        if (null == o) return s;
        y.isFunction(t) ? (i = y.allKeys(o), r = b(t, n)) : (i = L(arguments, !1, !1, 1), r = function(e, t, n) {
            return t in n
        }, o = Object(o));
        for (var u = 0, a = i.length; a > u; u++) {
            var f = i[u],
                l = o[f];
            r(l, f, o) && (s[f] = l)
        }
        return s
    }, y.omit = function(e, t, n) {
        if (y.isFunction(t)) t = y.negate(t);
        else {
            var r = y.map(L(arguments, !1, !1, 1), String);
            t = function(e, t) {
                return !y.contains(r, t)
            }
        }
        return y.pick(e, t, n)
    }, y.defaults = E(y.allKeys, !0), y.create = function(e, t) {
        var n = S(e);
        return t && y.extendOwn(n, t), n
    }, y.clone = function(e) {
        return y.isObject(e) ? y.isArray(e) ? e.slice() : y.extend({}, e) : e
    }, y.tap = function(e, t) {
        return t(e), e
    }, y.isMatch = function(e, t) {
        var n = y.keys(t),
            r = n.length;
        if (null == e) return !r;
        for (var i = Object(e), s = 0; r > s; s++) {
            var o = n[s];
            if (t[o] !== i[o] || !(o in i)) return !1
        }
        return !0
    };
    var _ = function(e, t, n, r) {
        if (e === t) return 0 !== e || 1 / e === 1 / t;
        if (null == e || null == t) return e === t;
        e instanceof y && (e = e._wrapped), t instanceof y && (t = t._wrapped);
        var i = c.call(e);
        if (i !== c.call(t)) return !1;
        switch (i) {
            case "[object RegExp]":
            case "[object String]":
                return "" + e == "" + t;
            case "[object Number]":
                return +e !== +e ? +t !== +t : 0 === +e ? 1 / +e === 1 / t : +e === +t;
            case "[object Date]":
            case "[object Boolean]":
                return +e === +t
        }
        var s = "[object Array]" === i;
        if (!s) {
            if ("object" != typeof e || "object" != typeof t) return !1;
            var o = e.constructor,
                u = t.constructor;
            if (o !== u && !(y.isFunction(o) && o instanceof o && y.isFunction(u) && u instanceof u) && "constructor" in e && "constructor" in t) return !1
        }
        n = n || [], r = r || [];
        for (var a = n.length; a--;)
            if (n[a] === e) return r[a] === t;
        if (n.push(e), r.push(t), s) {
            if (a = e.length, a !== t.length) return !1;
            for (; a--;)
                if (!_(e[a], t[a], n, r)) return !1
        } else {
            var f, l = y.keys(e);
            if (a = l.length, y.keys(t).length !== a) return !1;
            for (; a--;)
                if (f = l[a], !y.has(t, f) || !_(e[f], t[f], n, r)) return !1
        }
        return n.pop(), r.pop(), !0
    };
    y.isEqual = function(e, t) {
        return _(e, t)
    }, y.isEmpty = function(e) {
        return null == e ? !0 : C(e) && (y.isArray(e) || y.isString(e) || y.isArguments(e)) ? 0 === e.length : 0 === y.keys(e).length
    }, y.isElement = function(e) {
        return !!e && 1 === e.nodeType
    }, y.isArray = p || function(e) {
        return "[object Array]" === c.call(e)
    }, y.isObject = function(e) {
        var t = typeof e;
        return "function" === t || "object" === t && !!e
    }, y.each(["Arguments", "Function", "String", "Number", "Date", "RegExp", "Error"], function(e) {
        y["is" + e] = function(t) {
            return c.call(t) === "[object " + e + "]"
        }
    }), y.isArguments(arguments) || (y.isArguments = function(e) {
        return y.has(e, "callee")
    }), "function" != typeof /./ && "object" != typeof Int8Array && (y.isFunction = function(e) {
        return "function" == typeof e || !1
    }), y.isFinite = function(e) {
        return isFinite(e) && !isNaN(parseFloat(e))
    }, y.isNaN = function(e) {
        return y.isNumber(e) && e !== +e
    }, y.isBoolean = function(e) {
        return e === !0 || e === !1 || "[object Boolean]" === c.call(e)
    }, y.isNull = function(e) {
        return null === e
    }, y.isUndefined = function(e) {
        return e === void 0
    }, y.has = function(e, t) {
        return null != e && h.call(e, t)
    }, y.noConflict = function() {
        return i._ = s, this
    }, y.identity = function(e) {
        return e
    }, y.constant = function(e) {
        return function() {
            return e
        }
    }, y.noop = function() {}, y.property = x, y.propertyOf = function(e) {
        return null == e ? function() {} : function(t) {
            return e[t]
        }
    }, y.matcher = y.matches = function(e) {
        return e = y.extendOwn({}, e),
            function(t) {
                return y.isMatch(t, e)
            }
    }, y.times = function(e, t, n) {
        var r = Array(Math.max(0, e));
        t = b(t, n, 1);
        for (var i = 0; e > i; i++) r[i] = t(i);
        return r
    }, y.random = function(e, t) {
        return null == t && (t = e, e = 0), e + Math.floor(Math.random() * (t - e + 1))
    }, y.now = Date.now || function() {
        return (new Date).getTime()
    };
    var D = {
            "&": "&amp;",
            "<": "&lt;",
            ">": "&gt;",
            '"': "&quot;",
            "'": "&#x27;",
            "`": "&#x60;"
        },
        P = y.invert(D),
        H = function(e) {
            var t = function(t) {
                    return e[t]
                },
                n = "(?:" + y.keys(e).join("|") + ")",
                r = RegExp(n),
                i = RegExp(n, "g");
            return function(e) {
                return e = null == e ? "" : "" + e, r.test(e) ? e.replace(i, t) : e
            }
        };
    y.escape = H(D), y.unescape = H(P), y.result = function(e, t, n) {
        var r = null == e ? void 0 : e[t];
        return r === void 0 && (r = n), y.isFunction(r) ? r.call(e) : r
    };
    var B = 0;
    y.uniqueId = function(e) {
        var t = ++B + "";
        return e ? e + t : t
    }, y.templateSettings = {
        evaluate: /<%([\s\S]+?)%>/g,
        interpolate: /<%=([\s\S]+?)%>/g,
        escape: /<%-([\s\S]+?)%>/g
    };
    var j = /(.)^/,
        F = {
            "'": "'",
            "\\": "\\",
            "\r": "r",
            "\n": "n",
            "\u2028": "u2028",
            "\u2029": "u2029"
        },
        I = /\\|'|\r|\n|\u2028|\u2029/g,
        q = function(e) {
            return "\\" + F[e]
        };
    y.template = function(e, t, n) {
        !t && n && (t = n), t = y.defaults({}, t, y.templateSettings);
        var r = RegExp([(t.escape || j).source, (t.interpolate || j).source, (t.evaluate || j).source].join("|") + "|$", "g"),
            i = 0,
            s = "__p+='";
        e.replace(r, function(t, n, r, o, u) {
            return s += e.slice(i, u).replace(I, q), i = u + t.length, n ? s += "'+\n((__t=(" + n + "))==null?'':_.escape(__t))+\n'" : r ? s += "'+\n((__t=(" + r + "))==null?'':__t)+\n'" : o && (s += "';\n" + o + "\n__p+='"), t
        }), s += "';\n", t.variable || (s = "with(obj||{}){\n" + s + "}\n"), s = "var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n" + s + "return __p;\n";
        try {
            var o = new Function(t.variable || "obj", "_", s)
        } catch (u) {
            throw u.source = s, u
        }
        var a = function(e) {
                return o.call(this, e, y)
            },
            f = t.variable || "obj";
        return a.source = "function(" + f + "){\n" + s + "}", a
    }, y.chain = function(e) {
        var t = y(e);
        return t._chain = !0, t
    };
    var R = function(e, t) {
        return e._chain ? y(t).chain() : t
    };
    y.mixin = function(e) {
        y.each(y.functions(e), function(t) {
            var n = y[t] = e[t];
            y.prototype[t] = function() {
                var e = [this._wrapped];
                return f.apply(e, arguments), R(this, n.apply(y, e))
            }
        })
    }, y.mixin(y), y.each(["pop", "push", "reverse", "shift", "sort", "splice", "unshift"], function(e) {
        var t = o[e];
        y.prototype[e] = function() {
            var n = this._wrapped;
            return t.apply(n, arguments), "shift" !== e && "splice" !== e || 0 !== n.length || delete n[0], R(this, n)
        }
    }), y.each(["concat", "join", "slice"], function(e) {
        var t = o[e];
        y.prototype[e] = function() {
            return R(this, t.apply(this._wrapped, arguments))
        }
    }), y.prototype.value = function() {
        return this._wrapped
    }, y.prototype.valueOf = y.prototype.toJSON = y.prototype.value, y.prototype.toString = function() {
        return "" + this._wrapped
    }, "function" == typeof define && define.amd && define("underscore", [], function() {
        return y
    })
}.call(this),
    function(e) {
        var t = typeof self == "object" && self.self == self && self || typeof global == "object" && global.global == global && global;
        if (typeof define == "function" && define.amd) define("backbone", ["underscore", "jquery", "exports"], function(n, r, i) {
            t.Backbone = e(t, i, n, r)
        });
        else if (typeof exports != "undefined") {
            var n = require("underscore"),
                r;
            try {
                r = require("jquery")
            } catch (i) {}
            e(t, exports, n, r)
        } else t.Backbone = e(t, {}, t._, t.jQuery || t.Zepto || t.ender || t.$)
    }(function(e, t, n, r) {
        var i = e.Backbone,
            s = Array.prototype.slice;
        t.VERSION = "1.2.3", t.$ = r, t.noConflict = function() {
            return e.Backbone = i, this
        }, t.emulateHTTP = !1, t.emulateJSON = !1;
        var o = function(e, t, r) {
                switch (e) {
                    case 1:
                        return function() {
                            return n[t](this[r])
                        };
                    case 2:
                        return function(e) {
                            return n[t](this[r], e)
                        };
                    case 3:
                        return function(e, i) {
                            return n[t](this[r], a(e, this), i)
                        };
                    case 4:
                        return function(e, i, s) {
                            return n[t](this[r], a(e, this), i, s)
                        };
                    default:
                        return function() {
                            var e = s.call(arguments);
                            return e.unshift(this[r]), n[t].apply(n, e)
                        }
                }
            },
            u = function(e, t, r) {
                n.each(t, function(t, i) {
                    n[i] && (e.prototype[i] = o(t, i, r))
                })
            },
            a = function(e, t) {
                return n.isFunction(e) ? e : n.isObject(e) && !t._isModel(e) ? f(e) : n.isString(e) ? function(t) {
                    return t.get(e)
                } : e
            },
            f = function(e) {
                var t = n.matches(e);
                return function(e) {
                    return t(e.attributes)
                }
            },
            l = t.Events = {},
            c = /\s+/,
            h = function(e, t, r, i, s) {
                var o = 0,
                    u;
                if (r && typeof r == "object") {
                    i !== void 0 && "context" in s && s.context === void 0 && (s.context = i);
                    for (u = n.keys(r); o < u.length; o++) t = h(e, t, u[o], r[u[o]], s)
                } else if (r && c.test(r))
                    for (u = r.split(c); o < u.length; o++) t = e(t, u[o], i, s);
                else t = e(t, r, i, s);
                return t
            };
        l.on = function(e, t, n) {
            return p(this, e, t, n)
        };
        var p = function(e, t, n, r, i) {
            e._events = h(d, e._events || {}, t, n, {
                context: r,
                ctx: e,
                listening: i
            });
            if (i) {
                var s = e._listeners || (e._listeners = {});
                s[i.id] = i
            }
            return e
        };
        l.listenTo = function(e, t, r) {
            if (!e) return this;
            var i = e._listenId || (e._listenId = n.uniqueId("l")),
                s = this._listeningTo || (this._listeningTo = {}),
                o = s[i];
            if (!o) {
                var u = this._listenId || (this._listenId = n.uniqueId("l"));
                o = s[i] = {
                    obj: e,
                    objId: i,
                    id: u,
                    listeningTo: s,
                    count: 0
                }
            }
            return p(e, t, r, this, o), this
        };
        var d = function(e, t, n, r) {
            if (n) {
                var i = e[t] || (e[t] = []),
                    s = r.context,
                    o = r.ctx,
                    u = r.listening;
                u && u.count++, i.push({
                    callback: n,
                    context: s,
                    ctx: s || o,
                    listening: u
                })
            }
            return e
        };
        l.off = function(e, t, n) {
            return this._events ? (this._events = h(v, this._events, e, t, {
                context: n,
                listeners: this._listeners
            }), this) : this
        }, l.stopListening = function(e, t, r) {
            var i = this._listeningTo;
            if (!i) return this;
            var s = e ? [e._listenId] : n.keys(i);
            for (var o = 0; o < s.length; o++) {
                var u = i[s[o]];
                if (!u) break;
                u.obj.off(t, r, this)
            }
            return n.isEmpty(i) && (this._listeningTo = void 0), this
        };
        var v = function(e, t, r, i) {
            if (!e) return;
            var s = 0,
                o, u = i.context,
                a = i.listeners;
            if (!t && !r && !u) {
                var f = n.keys(a);
                for (; s < f.length; s++) o = a[f[s]], delete a[o.id], delete o.listeningTo[o.objId];
                return
            }
            var l = t ? [t] : n.keys(e);
            for (; s < l.length; s++) {
                t = l[s];
                var c = e[t];
                if (!c) break;
                var h = [];
                for (var p = 0; p < c.length; p++) {
                    var d = c[p];
                    r && r !== d.callback && r !== d.callback._callback || u && u !== d.context ? h.push(d) : (o = d.listening, o && --o.count === 0 && (delete a[o.id], delete o.listeningTo[o.objId]))
                }
                h.length ? e[t] = h : delete e[t]
            }
            if (n.size(e)) return e
        };
        l.once = function(e, t, r) {
            var i = h(m, {}, e, t, n.bind(this.off, this));
            return this.on(i, void 0, r)
        }, l.listenToOnce = function(e, t, r) {
            var i = h(m, {}, t, r, n.bind(this.stopListening, this, e));
            return this.listenTo(e, i)
        };
        var m = function(e, t, r, i) {
            if (r) {
                var s = e[t] = n.once(function() {
                    i(t, s), r.apply(this, arguments)
                });
                s._callback = r
            }
            return e
        };
        l.trigger = function(e) {
            if (!this._events) return this;
            var t = Math.max(0, arguments.length - 1),
                n = Array(t);
            for (var r = 0; r < t; r++) n[r] = arguments[r + 1];
            return h(g, this._events, e, void 0, n), this
        };
        var g = function(e, t, n, r) {
                if (e) {
                    var i = e[t],
                        s = e.all;
                    i && s && (s = s.slice()), i && y(i, r), s && y(s, [t].concat(r))
                }
                return e
            },
            y = function(e, t) {
                var n, r = -1,
                    i = e.length,
                    s = t[0],
                    o = t[1],
                    u = t[2];
                switch (t.length) {
                    case 0:
                        while (++r < i)(n = e[r]).callback.call(n.ctx);
                        return;
                    case 1:
                        while (++r < i)(n = e[r]).callback.call(n.ctx, s);
                        return;
                    case 2:
                        while (++r < i)(n = e[r]).callback.call(n.ctx, s, o);
                        return;
                    case 3:
                        while (++r < i)(n = e[r]).callback.call(n.ctx, s, o, u);
                        return;
                    default:
                        while (++r < i)(n = e[r]).callback.apply(n.ctx, t);
                        return
                }
            };
        l.bind = l.on, l.unbind = l.off, n.extend(t, l);
        var b = t.Model = function(e, t) {
            var r = e || {};
            t || (t = {}), this.cid = n.uniqueId(this.cidPrefix), this.attributes = {}, t.collection && (this.collection = t.collection), t.parse && (r = this.parse(r, t) || {}), r = n.defaults({}, r, n.result(this, "defaults")), this.set(r, t), this.changed = {}, this.initialize.apply(this, arguments)
        };
        n.extend(b.prototype, l, {
            changed: null,
            validationError: null,
            idAttribute: "id",
            cidPrefix: "c",
            initialize: function() {},
            toJSON: function(e) {
                return n.clone(this.attributes)
            },
            sync: function() {
                return t.sync.apply(this, arguments)
            },
            get: function(e) {
                return this.attributes[e]
            },
            escape: function(e) {
                return n.escape(this.get(e))
            },
            has: function(e) {
                return this.get(e) != null
            },
            matches: function(e) {
                return !!n.iteratee(e, this)(this.attributes)
            },
            set: function(e, t, r) {
                if (e == null) return this;
                var i;
                typeof e == "object" ? (i = e, r = t) : (i = {})[e] = t, r || (r = {});
                if (!this._validate(i, r)) return !1;
                var s = r.unset,
                    o = r.silent,
                    u = [],
                    a = this._changing;
                this._changing = !0, a || (this._previousAttributes = n.clone(this.attributes), this.changed = {});
                var f = this.attributes,
                    l = this.changed,
                    c = this._previousAttributes;
                for (var h in i) t = i[h], n.isEqual(f[h], t) || u.push(h), n.isEqual(c[h], t) ? delete l[h] : l[h] = t, s ? delete f[h] : f[h] = t;
                this.id = this.get(this.idAttribute);
                if (!o) {
                    u.length && (this._pending = r);
                    for (var p = 0; p < u.length; p++) this.trigger("change:" + u[p], this, f[u[p]], r)
                }
                if (a) return this;
                if (!o)
                    while (this._pending) r = this._pending, this._pending = !1, this.trigger("change", this, r);
                return this._pending = !1, this._changing = !1, this
            },
            unset: function(e, t) {
                return this.set(e, void 0, n.extend({}, t, {
                    unset: !0
                }))
            },
            clear: function(e) {
                var t = {};
                for (var r in this.attributes) t[r] = void 0;
                return this.set(t, n.extend({}, e, {
                    unset: !0
                }))
            },
            hasChanged: function(e) {
                return e == null ? !n.isEmpty(this.changed) : n.has(this.changed, e)
            },
            changedAttributes: function(e) {
                if (!e) return this.hasChanged() ? n.clone(this.changed) : !1;
                var t = this._changing ? this._previousAttributes : this.attributes,
                    r = {};
                for (var i in e) {
                    var s = e[i];
                    if (n.isEqual(t[i], s)) continue;
                    r[i] = s
                }
                return n.size(r) ? r : !1
            },
            previous: function(e) {
                return e == null || !this._previousAttributes ? null : this._previousAttributes[e]
            },
            previousAttributes: function() {
                return n.clone(this._previousAttributes)
            },
            fetch: function(e) {
                e = n.extend({
                    parse: !0
                }, e);
                var t = this,
                    r = e.success;
                return e.success = function(n) {
                    var i = e.parse ? t.parse(n, e) : n;
                    if (!t.set(i, e)) return !1;
                    r && r.call(e.context, t, n, e), t.trigger("sync", t, n, e)
                }, R(this, e), this.sync("read", this, e)
            },
            save: function(e, t, r) {
                var i;
                e == null || typeof e == "object" ? (i = e, r = t) : (i = {})[e] = t, r = n.extend({
                    validate: !0,
                    parse: !0
                }, r);
                var s = r.wait;
                if (i && !s) {
                    if (!this.set(i, r)) return !1
                } else if (!this._validate(i, r)) return !1;
                var o = this,
                    u = r.success,
                    a = this.attributes;
                r.success = function(e) {
                    o.attributes = a;
                    var t = r.parse ? o.parse(e, r) : e;
                    s && (t = n.extend({}, i, t));
                    if (t && !o.set(t, r)) return !1;
                    u && u.call(r.context, o, e, r), o.trigger("sync", o, e, r)
                }, R(this, r), i && s && (this.attributes = n.extend({}, a, i));
                var f = this.isNew() ? "create" : r.patch ? "patch" : "update";
                f === "patch" && !r.attrs && (r.attrs = i);
                var l = this.sync(f, this, r);
                return this.attributes = a, l
            },
            destroy: function(e) {
                e = e ? n.clone(e) : {};
                var t = this,
                    r = e.success,
                    i = e.wait,
                    s = function() {
                        t.stopListening(), t.trigger("destroy", t, t.collection, e)
                    };
                e.success = function(n) {
                    i && s(), r && r.call(e.context, t, n, e), t.isNew() || t.trigger("sync", t, n, e)
                };
                var o = !1;
                return this.isNew() ? n.defer(e.success) : (R(this, e), o = this.sync("delete", this, e)), i || s(), o
            },
            url: function() {
                var e = n.result(this, "urlRoot") || n.result(this.collection, "url") || q();
                if (this.isNew()) return e;
                var t = this.get(this.idAttribute);
                return e.replace(/[^\/]$/, "$&/") + encodeURIComponent(t)
            },
            parse: function(e, t) {
                return e
            },
            clone: function() {
                return new this.constructor(this.attributes)
            },
            isNew: function() {
                return !this.has(this.idAttribute)
            },
            isValid: function(e) {
                return this._validate({}, n.defaults({
                    validate: !0
                }, e))
            },
            _validate: function(e, t) {
                if (!t.validate || !this.validate) return !0;
                e = n.extend({}, this.attributes, e);
                var r = this.validationError = this.validate(e, t) || null;
                return r ? (this.trigger("invalid", this, r, n.extend(t, {
                    validationError: r
                })), !1) : !0
            }
        });
        var w = {
            keys: 1,
            values: 1,
            pairs: 1,
            invert: 1,
            pick: 0,
            omit: 0,
            chain: 1,
            isEmpty: 1
        };
        u(b, w, "attributes");
        var E = t.Collection = function(e, t) {
                t || (t = {}), t.model && (this.model = t.model), t.comparator !== void 0 && (this.comparator = t.comparator), this._reset(), this.initialize.apply(this, arguments), e && this.reset(e, n.extend({
                    silent: !0
                }, t))
            },
            S = {
                add: !0,
                remove: !0,
                merge: !0
            },
            x = {
                add: !0,
                remove: !1
            },
            T = function(e, t, n) {
                n = Math.min(Math.max(n, 0), e.length);
                var r = Array(e.length - n),
                    i = t.length;
                for (var s = 0; s < r.length; s++) r[s] = e[s + n];
                for (s = 0; s < i; s++) e[s + n] = t[s];
                for (s = 0; s < r.length; s++) e[s + i + n] = r[s]
            };
        n.extend(E.prototype, l, {
            model: b,
            initialize: function() {},
            toJSON: function(e) {
                return this.map(function(t) {
                    return t.toJSON(e)
                })
            },
            sync: function() {
                return t.sync.apply(this, arguments)
            },
            add: function(e, t) {
                return this.set(e, n.extend({
                    merge: !1
                }, t, x))
            },
            remove: function(e, t) {
                t = n.extend({}, t);
                var r = !n.isArray(e);
                e = r ? [e] : n.clone(e);
                var i = this._removeModels(e, t);
                return !t.silent && i && this.trigger("update", this, t), r ? i[0] : i
            },
            set: function(e, t) {
                if (e == null) return;
                t = n.defaults({}, t, S), t.parse && !this._isModel(e) && (e = this.parse(e, t));
                var r = !n.isArray(e);
                e = r ? [e] : e.slice();
                var i = t.at;
                i != null && (i = +i), i < 0 && (i += this.length + 1);
                var s = [],
                    o = [],
                    u = [],
                    a = {},
                    f = t.add,
                    l = t.merge,
                    c = t.remove,
                    h = !1,
                    p = this.comparator && i == null && t.sort !== !1,
                    d = n.isString(this.comparator) ? this.comparator : null,
                    v;
                for (var m = 0; m < e.length; m++) {
                    v = e[m];
                    var g = this.get(v);
                    if (g) {
                        if (l && v !== g) {
                            var y = this._isModel(v) ? v.attributes : v;
                            t.parse && (y = g.parse(y, t)), g.set(y, t), p && !h && (h = g.hasChanged(d))
                        }
                        a[g.cid] || (a[g.cid] = !0, s.push(g)), e[m] = g
                    } else f && (v = e[m] = this._prepareModel(v, t), v && (o.push(v), this._addReference(v, t), a[v.cid] = !0, s.push(v)))
                }
                if (c) {
                    for (m = 0; m < this.length; m++) v = this.models[m], a[v.cid] || u.push(v);
                    u.length && this._removeModels(u, t)
                }
                var b = !1,
                    w = !p && f && c;
                s.length && w ? (b = this.length != s.length || n.some(this.models, function(e, t) {
                    return e !== s[t]
                }), this.models.length = 0, T(this.models, s, 0), this.length = this.models.length) : o.length && (p && (h = !0), T(this.models, o, i == null ? this.length : i), this.length = this.models.length), h && this.sort({
                    silent: !0
                });
                if (!t.silent) {
                    for (m = 0; m < o.length; m++) i != null && (t.index = i + m), v = o[m], v.trigger("add", v, this, t);
                    (h || b) && this.trigger("sort", this, t), (o.length || u.length) && this.trigger("update", this, t)
                }
                return r ? e[0] : e
            },
            reset: function(e, t) {
                t = t ? n.clone(t) : {};
                for (var r = 0; r < this.models.length; r++) this._removeReference(this.models[r], t);
                return t.previousModels = this.models, this._reset(), e = this.add(e, n.extend({
                    silent: !0
                }, t)), t.silent || this.trigger("reset", this, t), e
            },
            push: function(e, t) {
                return this.add(e, n.extend({
                    at: this.length
                }, t))
            },
            pop: function(e) {
                var t = this.at(this.length - 1);
                return this.remove(t, e)
            },
            unshift: function(e, t) {
                return this.add(e, n.extend({
                    at: 0
                }, t))
            },
            shift: function(e) {
                var t = this.at(0);
                return this.remove(t, e)
            },
            slice: function() {
                return s.apply(this.models, arguments)
            },
            get: function(e) {
                if (e == null) return void 0;
                var t = this.modelId(this._isModel(e) ? e.attributes : e);
                return this._byId[e] || this._byId[t] || this._byId[e.cid]
            },
            at: function(e) {
                return e < 0 && (e += this.length), this.models[e]
            },
            where: function(e, t) {
                return this[t ? "find" : "filter"](e)
            },
            findWhere: function(e) {
                return this.where(e, !0)
            },
            sort: function(e) {
                var t = this.comparator;
                if (!t) throw new Error("Cannot sort a set without a comparator");
                e || (e = {});
                var r = t.length;
                return n.isFunction(t) && (t = n.bind(t, this)), r === 1 || n.isString(t) ? this.models = this.sortBy(t) : this.models.sort(t), e.silent || this.trigger("sort", this, e), this
            },
            pluck: function(e) {
                return n.invoke(this.models, "get", e)
            },
            fetch: function(e) {
                e = n.extend({
                    parse: !0
                }, e);
                var t = e.success,
                    r = this;
                return e.success = function(n) {
                    var i = e.reset ? "reset" : "set";
                    r[i](n, e), t && t.call(e.context, r, n, e), r.trigger("sync", r, n, e)
                }, R(this, e), this.sync("read", this, e)
            },
            create: function(e, t) {
                t = t ? n.clone(t) : {};
                var r = t.wait;
                e = this._prepareModel(e, t);
                if (!e) return !1;
                r || this.add(e, t);
                var i = this,
                    s = t.success;
                return t.success = function(e, t, n) {
                    r && i.add(e, n), s && s.call(n.context, e, t, n)
                }, e.save(null, t), e
            },
            parse: function(e, t) {
                return e
            },
            clone: function() {
                return new this.constructor(this.models, {
                    model: this.model,
                    comparator: this.comparator
                })
            },
            modelId: function(e) {
                return e[this.model.prototype.idAttribute || "id"]
            },
            _reset: function() {
                this.length = 0, this.models = [], this._byId = {}
            },
            _prepareModel: function(e, t) {
                if (this._isModel(e)) return e.collection || (e.collection = this), e;
                t = t ? n.clone(t) : {}, t.collection = this;
                var r = new this.model(e, t);
                return r.validationError ? (this.trigger("invalid", this, r.validationError, t), !1) : r
            },
            _removeModels: function(e, t) {
                var n = [];
                for (var r = 0; r < e.length; r++) {
                    var i = this.get(e[r]);
                    if (!i) continue;
                    var s = this.indexOf(i);
                    this.models.splice(s, 1), this.length--, t.silent || (t.index = s, i.trigger("remove", i, this, t)), n.push(i), this._removeReference(i, t)
                }
                return n.length ? n : !1
            },
            _isModel: function(e) {
                return e instanceof b
            },
            _addReference: function(e, t) {
                this._byId[e.cid] = e;
                var n = this.modelId(e.attributes);
                n != null && (this._byId[n] = e), e.on("all", this._onModelEvent, this)
            },
            _removeReference: function(e, t) {
                delete this._byId[e.cid];
                var n = this.modelId(e.attributes);
                n != null && delete this._byId[n], this === e.collection && delete e.collection, e.off("all", this._onModelEvent, this)
            },
            _onModelEvent: function(e, t, n, r) {
                if ((e === "add" || e === "remove") && n !== this) return;
                e === "destroy" && this.remove(t, r);
                if (e === "change") {
                    var i = this.modelId(t.previousAttributes()),
                        s = this.modelId(t.attributes);
                    i !== s && (i != null && delete this._byId[i], s != null && (this._byId[s] = t))
                }
                this.trigger.apply(this, arguments)
            }
        });
        var N = {
            forEach: 3,
            each: 3,
            map: 3,
            collect: 3,
            reduce: 4,
            foldl: 4,
            inject: 4,
            reduceRight: 4,
            foldr: 4,
            find: 3,
            detect: 3,
            filter: 3,
            select: 3,
            reject: 3,
            every: 3,
            all: 3,
            some: 3,
            any: 3,
            include: 3,
            includes: 3,
            contains: 3,
            invoke: 0,
            max: 3,
            min: 3,
            toArray: 1,
            size: 1,
            first: 3,
            head: 3,
            take: 3,
            initial: 3,
            rest: 3,
            tail: 3,
            drop: 3,
            last: 3,
            without: 0,
            difference: 0,
            indexOf: 3,
            shuffle: 1,
            lastIndexOf: 3,
            isEmpty: 1,
            chain: 1,
            sample: 3,
            partition: 3,
            groupBy: 3,
            countBy: 3,
            sortBy: 3,
            indexBy: 3
        };
        u(E, N, "models");
        var C = t.View = function(e) {
                this.cid = n.uniqueId("view"), n.extend(this, n.pick(e, L)), this._ensureElement(), this.initialize.apply(this, arguments)
            },
            k = /^(\S+)\s*(.*)$/,
            L = ["model", "collection", "el", "id", "attributes", "className", "tagName", "events"];
        n.extend(C.prototype, l, {
            tagName: "div",
            $: function(e) {
                return this.$el.find(e)
            },
            initialize: function() {},
            render: function() {
                return this
            },
            remove: function() {
                return this._removeElement(), this.stopListening(), this
            },
            _removeElement: function() {
                this.$el.remove()
            },
            setElement: function(e) {
                return this.undelegateEvents(), this._setElement(e), this.delegateEvents(), this
            },
            _setElement: function(e) {
                this.$el = e instanceof t.$ ? e : t.$(e), this.el = this.$el[0]
            },
            delegateEvents: function(e) {
                e || (e = n.result(this, "events"));
                if (!e) return this;
                this.undelegateEvents();
                for (var t in e) {
                    var r = e[t];
                    n.isFunction(r) || (r = this[r]);
                    if (!r) continue;
                    var i = t.match(k);
                    this.delegate(i[1], i[2], n.bind(r, this))
                }
                return this
            },
            delegate: function(e, t, n) {
                return this.$el.on(e + ".delegateEvents" + this.cid, t, n), this
            },
            undelegateEvents: function() {
                return this.$el && this.$el.off(".delegateEvents" + this.cid), this
            },
            undelegate: function(e, t, n) {
                return this.$el.off(e + ".delegateEvents" + this.cid, t, n), this
            },
            _createElement: function(e) {
                return document.createElement(e)
            },
            _ensureElement: function() {
                if (!this.el) {
                    var e = n.extend({}, n.result(this, "attributes"));
                    this.id && (e.id = n.result(this, "id")), this.className && (e["class"] = n.result(this, "className")), this.setElement(this._createElement(n.result(this, "tagName"))), this._setAttributes(e)
                } else this.setElement(n.result(this, "el"))
            },
            _setAttributes: function(e) {
                this.$el.attr(e)
            }
        }), t.sync = function(e, r, i) {
            var s = A[e];
            n.defaults(i || (i = {}), {
                emulateHTTP: t.emulateHTTP,
                emulateJSON: t.emulateJSON
            });
            var o = {
                type: s,
                dataType: "json"
            };
            i.url || (o.url = n.result(r, "url") || q()), i.data == null && r && (e === "create" || e === "update" || e === "patch") && (o.contentType = "application/json", o.data = JSON.stringify(i.attrs || r.toJSON(i))), i.emulateJSON && (o.contentType = "application/x-www-form-urlencoded", o.data = o.data ? {
                model: o.data
            } : {});
            if (i.emulateHTTP && (s === "PUT" || s === "DELETE" || s === "PATCH")) {
                o.type = "POST", i.emulateJSON && (o.data._method = s);
                var u = i.beforeSend;
                i.beforeSend = function(e) {
                    e.setRequestHeader("X-HTTP-Method-Override", s);
                    if (u) return u.apply(this, arguments)
                }
            }
            o.type !== "GET" && !i.emulateJSON && (o.processData = !1);
            var a = i.error;
            i.error = function(e, t, n) {
                i.textStatus = t, i.errorThrown = n, a && a.call(i.context, e, t, n)
            };
            var f = i.xhr = t.ajax(n.extend(o, i));
            return r.trigger("request", r, f, i), f
        };
        var A = {
            create: "POST",
            update: "PUT",
            patch: "PATCH",
            "delete": "DELETE",
            read: "GET"
        };
        t.ajax = function() {
            return t.$.ajax.apply(t.$, arguments)
        };
        var O = t.Router = function(e) {
                e || (e = {}), e.routes && (this.routes = e.routes), this._bindRoutes(), this.initialize.apply(this, arguments)
            },
            M = /\((.*?)\)/g,
            _ = /(\(\?)?:\w+/g,
            D = /\*\w+/g,
            P = /[\-{}\[\]+?.,\\\^$|#\s]/g;
        n.extend(O.prototype, l, {
            initialize: function() {},
            route: function(e, r, i) {
                n.isRegExp(e) || (e = this._routeToRegExp(e)), n.isFunction(r) && (i = r, r = ""), i || (i = this[r]);
                var s = this;
                return t.history.route(e, function(n) {
                    var o = s._extractParameters(e, n);
                    s.execute(i, o, r) !== !1 && (s.trigger.apply(s, ["route:" + r].concat(o)), s.trigger("route", r, o), t.history.trigger("route", s, r, o))
                }), this
            },
            execute: function(e, t, n) {
                e && e.apply(this, t)
            },
            navigate: function(e, n) {
                return t.history.navigate(e, n), this
            },
            _bindRoutes: function() {
                if (!this.routes) return;
                this.routes = n.result(this, "routes");
                var e, t = n.keys(this.routes);
                while ((e = t.pop()) != null) this.route(e, this.routes[e])
            },
            _routeToRegExp: function(e) {
                return e = e.replace(P, "\\$&").replace(M, "(?:$1)?").replace(_, function(e, t) {
                    return t ? e : "([^/?]+)"
                }).replace(D, "([^?]*?)"), new RegExp("^" + e + "(?:\\?([\\s\\S]*))?$")
            },
            _extractParameters: function(e, t) {
                var r = e.exec(t).slice(1);
                return n.map(r, function(e, t) {
                    return t === r.length - 1 ? e || null : e ? decodeURIComponent(e) : null
                })
            }
        });
        var H = t.History = function() {
                this.handlers = [], this.checkUrl = n.bind(this.checkUrl, this), typeof window != "undefined" && (this.location = window.location, this.history = window.history)
            },
            B = /^[#\/]|\s+$/g,
            j = /^\/+|\/+$/g,
            F = /#.*$/;
        H.started = !1, n.extend(H.prototype, l, {
            interval: 50,
            atRoot: function() {
                var e = this.location.pathname.replace(/[^\/]$/, "$&/");
                return e === this.root && !this.getSearch()
            },
            matchRoot: function() {
                var e = this.decodeFragment(this.location.pathname),
                    t = e.slice(0, this.root.length - 1) + "/";
                return t === this.root
            },
            decodeFragment: function(e) {
                return decodeURI(e.replace(/%25/g, "%2525"))
            },
            getSearch: function() {
                var e = this.location.href.replace(/#.*/, "").match(/\?.+/);
                return e ? e[0] : ""
            },
            getHash: function(e) {
                var t = (e || this).location.href.match(/#(.*)$/);
                return t ? t[1] : ""
            },
            getPath: function() {
                var e = this.decodeFragment(this.location.pathname + this.getSearch()).slice(this.root.length - 1);
                return e.charAt(0) === "/" ? e.slice(1) : e
            },
            getFragment: function(e) {
                return e == null && (this._usePushState || !this._wantsHashChange ? e = this.getPath() : e = this.getHash()), e.replace(B, "")
            },
            start: function(e) {
                if (H.started) throw new Error("Backbone.history has already been started");
                H.started = !0, this.options = n.extend({
                    root: "/"
                }, this.options, e), this.root = this.options.root, this._wantsHashChange = this.options.hashChange !== !1, this._hasHashChange = "onhashchange" in window && (document.documentMode === void 0 || document.documentMode > 7), this._useHashChange = this._wantsHashChange && this._hasHashChange, this._wantsPushState = !!this.options.pushState, this._hasPushState = !!this.history && !!this.history.pushState, this._usePushState = this._wantsPushState && this._hasPushState, this.fragment = this.getFragment(), this.root = ("/" + this.root + "/").replace(j, "/");
                if (this._wantsHashChange && this._wantsPushState) {
                    if (!this._hasPushState && !this.atRoot()) {
                        var t = this.root.slice(0, -1) || "/";
                        return this.location.replace(t + "#" + this.getPath()), !0
                    }
                    this._hasPushState && this.atRoot() && this.navigate(this.getHash(), {
                        replace: !0
                    })
                }
                if (!this._hasHashChange && this._wantsHashChange && !this._usePushState) {
                    this.iframe = document.createElement("iframe"), this.iframe.src = "javascript:0", this.iframe.style.display = "none", this.iframe.tabIndex = -1;
                    var r = document.body,
                        i = r.insertBefore(this.iframe, r.firstChild).contentWindow;
                    i.document.open(), i.document.close(), i.location.hash = "#" + this.fragment
                }
                var s = window.addEventListener || function(e, t) {
                    return attachEvent("on" + e, t)
                };
                this._usePushState ? s("popstate", this.checkUrl, !1) : this._useHashChange && !this.iframe ? s("hashchange", this.checkUrl, !1) : this._wantsHashChange && (this._checkUrlInterval = setInterval(this.checkUrl, this.interval));
                if (!this.options.silent) return this.loadUrl()
            },
            stop: function() {
                var e = window.removeEventListener || function(e, t) {
                    return detachEvent("on" + e, t)
                };
                this._usePushState ? e("popstate", this.checkUrl, !1) : this._useHashChange && !this.iframe && e("hashchange", this.checkUrl, !1), this.iframe && (document.body.removeChild(this.iframe), this.iframe = null), this._checkUrlInterval && clearInterval(this._checkUrlInterval), H.started = !1
            },
            route: function(e, t) {
                this.handlers.unshift({
                    route: e,
                    callback: t
                })
            },
            checkUrl: function(e) {
                var t = this.getFragment();
                t === this.fragment && this.iframe && (t = this.getHash(this.iframe.contentWindow));
                if (t === this.fragment) return !1;
                this.iframe && this.navigate(t), this.loadUrl()
            },
            loadUrl: function(e) {
                return this.matchRoot() ? (e = this.fragment = this.getFragment(e), n.some(this.handlers, function(t) {
                    if (t.route.test(e)) return t.callback(e), !0
                })) : !1
            },
            navigate: function(e, t) {
                if (!H.started) return !1;
                if (!t || t === !0) t = {
                    trigger: !!t
                };
                e = this.getFragment(e || "");
                var n = this.root;
                if (e === "" || e.charAt(0) === "?") n = n.slice(0, -1) || "/";
                var r = n + e;
                e = this.decodeFragment(e.replace(F, ""));
                if (this.fragment === e) return;
                this.fragment = e;
                if (this._usePushState) this.history[t.replace ? "replaceState" : "pushState"]({}, document.title, r);
                else {
                    if (!this._wantsHashChange) return this.location.assign(r);
                    this._updateHash(this.location, e, t.replace);
                    if (this.iframe && e !== this.getHash(this.iframe.contentWindow)) {
                        var i = this.iframe.contentWindow;
                        t.replace || (i.document.open(), i.document.close()), this._updateHash(i.location, e, t.replace)
                    }
                }
                if (t.trigger) return this.loadUrl(e)
            },
            _updateHash: function(e, t, n) {
                if (n) {
                    var r = e.href.replace(/(javascript:|#).*$/, "");
                    e.replace(r + "#" + t)
                } else e.hash = "#" + t
            }
        }), t.history = new H;
        var I = function(e, t) {
            var r = this,
                i;
            e && n.has(e, "constructor") ? i = e.constructor : i = function() {
                return r.apply(this, arguments)
            }, n.extend(i, r, t);
            var s = function() {
                this.constructor = i
            };
            return s.prototype = r.prototype, i.prototype = new s, e && n.extend(i.prototype, e), i.__super__ = r.prototype, i
        };
        b.extend = E.extend = O.extend = C.extend = H.extend = I;
        var q = function() {
                throw new Error('A "url" property or function must be specified')
            },
            R = function(e, t) {
                var n = t.error;
                t.error = function(r) {
                    n && n.call(t.context, e, r, t), e.trigger("error", e, r, t)
                }
            };
        return t
    }),
    function(deparam) {
        if (typeof require == "function" && typeof exports == "object" && typeof module == "object") {
            var jquery = require("jquery");
            module.exports = deparam(jquery)
        } else if (typeof define == "function" && define.amd) define("jquery.deparam", ["jquery"], function(e) {
            return deparam(e)
        });
        else {
            var global;
            try {
                global = eval("this")
            } catch (e) {
                global = window
            }
            global.deparam = deparam(jQuery)
        }
    }(function(e) {
        var t = function(e, t) {
            var n = {},
                r = {
                    "true": !0,
                    "false": !1,
                    "null": null
                };
            return e.replace(/\+/g, " ").split("&").forEach(function(e) {
                var i = e.split("="),
                    s = decodeURIComponent(i[0]),
                    o, u = n,
                    a = 0,
                    f = s.split("]["),
                    l = f.length - 1;
                /\[/.test(f[0]) && /\]$/.test(f[l]) ? (f[l] = f[l].replace(/\]$/, ""), f = f.shift().split("[").concat(f), l = f.length - 1) : l = 0;
                if (i.length === 2) {
                    o = decodeURIComponent(i[1]), t && (o = o && !isNaN(o) && +o + "" === o ? +o : o === "undefined" ? undefined : r[o] !== undefined ? r[o] : o);
                    if (l)
                        for (; a <= l; a++) s = f[a] === "" ? u.length : f[a], u = u[s] = a < l ? u[s] || (f[a + 1] && isNaN(f[a + 1]) ? {} : []) : o;
                    else Object.prototype.toString.call(n[s]) === "[object Array]" ? n[s].push(o) : {}.hasOwnProperty.call(n, s) ? n[s] = [n[s], o] : n[s] = o
                } else s && (n[s] = t ? undefined : "")
            }), n
        };
        return e.prototype.deparam = e.deparam = t, t
    }),
    function(e) {
        e("jsonpack", [], function() {
            var e = -1,
                t = -2,
                n = -3,
                r = -4,
                i = -5,
                s = function(s, o) {
                    o = o || {};
                    var u = o.verbose || !1;
                    u && console.log("Normalize the JSON Object"), s = typeof s == "string" ? this.JSON.parse(s) : s, u && console.log("Creating a empty dictionary");
                    var f = {
                        strings: [],
                        integers: [],
                        floats: []
                    };
                    u && console.log("Creating the AST");
                    var c = function g(s) {
                            u && console.log("Calling recursiveAstBuilder with " + this.JSON.stringify(s));
                            var o = typeof s;
                            if (s === null) return {
                                type: "null",
                                index: n
                            };
                            if (typeof s == "undefined") return {
                                type: "undefined",
                                index: i
                            };
                            if (s instanceof Array) {
                                var c = ["@"];
                                for (var p in s) {
                                    if (!s.hasOwnProperty(p)) continue;
                                    c.push(g(s[p]))
                                }
                                return c
                            }
                            if (o === "object") {
                                var c = ["$"];
                                for (var d in s) {
                                    if (!s.hasOwnProperty(d)) continue;
                                    c.push(g(d)), c.push(g(s[d]))
                                }
                                return c
                            }
                            if (s === "") return {
                                type: "empty",
                                index: r
                            };
                            if (o === "string") {
                                var v = h.call(f.strings, s);
                                return v == -1 && (f.strings.push(a(s)), v = f.strings.length - 1), {
                                    type: "strings",
                                    index: v
                                }
                            }
                            if (o === "number" && s % 1 === 0) {
                                var v = h.call(f.integers, s);
                                return v == -1 && (f.integers.push(l(s)), v = f.integers.length - 1), {
                                    type: "integers",
                                    index: v
                                }
                            }
                            if (o === "number") {
                                var v = h.call(f.floats, s);
                                return v == -1 && (f.floats.push(s), v = f.floats.length - 1), {
                                    type: "floats",
                                    index: v
                                }
                            }
                            if (o === "boolean") return {
                                type: "boolean",
                                index: s ? e : t
                            };
                            throw new Error("Unexpected argument of type " + typeof s)
                        }(s),
                        p = f.strings.length,
                        d = f.integers.length,
                        v = f.floats.length;
                    u && console.log("Parsing the dictionary");
                    var m = f.strings.join("|");
                    return m += "^" + f.integers.join("|"), m += "^" + f.floats.join("|"), u && console.log("Parsing the structure"), m += "^" + function y(e) {
                        u && console.log("Calling a recursiveParser with " + this.JSON.stringify(e));
                        if (e instanceof Array) {
                            var t = e.shift();
                            for (var s in e) {
                                if (!e.hasOwnProperty(s)) continue;
                                t += y(e[s]) + "|"
                            }
                            return (t[t.length - 1] === "|" ? t.slice(0, -1) : t) + "]"
                        }
                        var o = e.type,
                            a = e.index;
                        if (o === "strings") return l(a);
                        if (o === "integers") return l(p + a);
                        if (o === "floats") return l(p + d + a);
                        if (o === "boolean") return e.index;
                        if (o === "null") return n;
                        if (o === "undefined") return i;
                        if (o === "empty") return r;
                        throw new TypeError("The item is alien!")
                    }(c), u && console.log("Ending parser"), o.debug ? {
                        dictionary: f,
                        ast: c,
                        packed: m
                    } : m
                },
                o = function(s, o) {
                    o = o || {};
                    var u = s.split("^");
                    o.verbose && console.log("Building dictionary");
                    var a = [],
                        l = u[0];
                    if (l !== "") {
                        l = l.split("|"), o.verbose && console.log("Parse the strings dictionary");
                        for (var h = 0, p = l.length; h < p; h++) a.push(f(l[h]))
                    }
                    l = u[1];
                    if (l !== "") {
                        l = l.split("|"), o.verbose && console.log("Parse the integers dictionary");
                        for (var h = 0, p = l.length; h < p; h++) a.push(c(l[h]))
                    }
                    l = u[2];
                    if (l !== "") {
                        l = l.split("|"), o.verbose && console.log("Parse the floats dictionary");
                        for (var h = 0, p = l.length; h < p; h++) a.push(parseFloat(l[h]))
                    }
                    delete l, o.verbose && console.log("Tokenizing the structure");
                    var d = "",
                        v = [],
                        m = u[3].length;
                    for (var h = 0; h < m; h++) {
                        var g = u[3].charAt(h);
                        g === "|" || g === "$" || g === "@" || g === "]" ? (d && (v.push(c(d)), d = ""), g !== "|" && v.push(g)) : d += g
                    }
                    var y = v.length,
                        b = 0;
                    return o.verbose && console.log("Starting recursive parser"),
                        function w() {
                            var s = v[b++];
                            o.verbose && console.log("Reading collection type " + (s === "$" ? "object" : "Array"));
                            if (s === "@") {
                                var u = [];
                                for (; b < y; b++) {
                                    var f = v[b];
                                    o.verbose && console.log("Read " + f + " symbol");
                                    if (f === "]") return u;
                                    if (f === "@" || f === "$") u.push(w());
                                    else switch (f) {
                                        case e:
                                            u.push(!0);
                                            break;
                                        case t:
                                            u.push(!1);
                                            break;
                                        case n:
                                            u.push(null);
                                            break;
                                        case i:
                                            u.push(undefined);
                                            break;
                                        case r:
                                            u.push("");
                                            break;
                                        default:
                                            u.push(a[f])
                                    }
                                }
                                return o.verbose && console.log("Parsed " + this.JSON.stringify(u)), u
                            }
                            if (s === "$") {
                                var u = {};
                                for (; b < y; b++) {
                                    var l = v[b];
                                    if (l === "]") return u;
                                    l === r ? l = "" : l = a[l];
                                    var f = v[++b];
                                    if (f === "@" || f === "$") u[l] = w();
                                    else switch (f) {
                                        case e:
                                            u[l] = !0;
                                            break;
                                        case t:
                                            u[l] = !1;
                                            break;
                                        case n:
                                            u[l] = null;
                                            break;
                                        case i:
                                            u[l] = undefined;
                                            break;
                                        case r:
                                            u[l] = "";
                                            break;
                                        default:
                                            u[l] = a[f]
                                    }
                                }
                                return o.verbose && console.log("Parsed " + this.JSON.stringify(u)), u
                            }
                            throw new TypeError("Bad token " + s + " isn't a type")
                        }()
                },
                u = function(s, o) {
                    var u = typeof o;
                    if (u === "boolean") return o ? e : t;
                    if (o === null) return n;
                    if (typeof o == "undefined") return i;
                    if (o === "") return r;
                    if (u === "string") {
                        o = a(o);
                        var f = h.call(s.strings, o);
                        f === -1 && (s.strings.push(o), f = s.strings.length - 1)
                    }
                    if (u !== "string" && u !== "number") throw new Error("The type is not a JSON type");
                    u === "string" ? o = a(o) : o % 1 === 0 && (o = l(o)), o = u === "number" ? l(o) : a(o);
                    var f = h.call(s[u], o);
                    return f === -1 && (s[u].push(o), f = s[u].length - 1), u === "number" ? "+" + f : f
                },
                a = function(e) {
                    return typeof e != "string" ? e : e.replace(/[\+ \|\^\%]/g, function(e) {
                        return {
                            " ": "+",
                            "+": "%2B",
                            "|": "%7C",
                            "^": "%5E",
                            "%": "%25"
                        }[e]
                    })
                },
                f = function(e) {
                    return typeof e != "string" ? e : e.replace(/\+|%2B|%7C|%5E|%25/g, function(e) {
                        return {
                            "+": " ",
                            "%2B": "+",
                            "%7C": "|",
                            "%5E": "^",
                            "%25": "%"
                        }[e]
                    })
                },
                l = function(e) {
                    return Number.prototype.toString.call(e, 36).toUpperCase()
                },
                c = function(e) {
                    return parseInt(e, 36)
                },
                h = Array.prototype.indexOf || function(e, t) {
                    for (var n = t || 0, r = this.length; n < r; n++)
                        if (this[n] === e) return n;
                    return -1
                };
            return {
                JSON: JSON,
                pack: s,
                unpack: o
            }
        })
    }(typeof define == "undefined" || !define.amd ? function(e, t) {
        var n = t();
        if (typeof exports != "undefined")
            for (var r in n) exports[r] = n[r];
        else window.jsonpack = n
    } : define), define("domReady", [], function() {
        "use strict";

        function u(e) {
            var t;
            for (t = 0; t < e.length; t += 1) e[t](s)
        }

        function a() {
            var e = o;
            i && e.length && (o = [], u(e))
        }

        function f() {
            i || (i = !0, n && clearInterval(n), a())
        }

        function c(e) {
            return i ? e(s) : o.push(e), c
        }
        var e, t, n, r = typeof window != "undefined" && window.document,
            i = !r,
            s = r ? document : null,
            o = [];
        if (r) {
            if (document.addEventListener) document.addEventListener("DOMContentLoaded", f, !1), window.addEventListener("load", f, !1);
            else if (window.attachEvent) {
                window.attachEvent("onload", f), t = document.createElement("div");
                try {
                    e = window.frameElement === null
                } catch (l) {}
                t.doScroll && e && window.external && (n = setInterval(function() {
                    try {
                        t.doScroll(), f()
                    } catch (e) {}
                }, 30))
            }
            document.readyState === "complete" && f()
        }
        return c.version = "2.0.1", c.load = function(e, t, n, r) {
            r.isBuild ? n(null) : c(n)
        }, c
    });
if (typeof jQuery == "undefined") throw new Error("Bootstrap's JavaScript requires jQuery"); + function(e) {
    "use strict";
    var t = e.fn.jquery.split(" ")[0].split(".");
    if (t[0] < 2 && t[1] < 9 || t[0] == 1 && t[1] == 9 && t[2] < 1 || t[0] > 2) throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 3")
}(jQuery), + function(e) {
    "use strict";

    function n(n) {
        return this.each(function() {
            var r = e(this),
                i = r.data("bs.carousel"),
                s = e.extend({}, t.DEFAULTS, r.data(), typeof n == "object" && n),
                o = typeof n == "string" ? n : s.slide;
            i || r.data("bs.carousel", i = new t(this, s)), typeof n == "number" ? i.to(n) : o ? i[o]() : s.interval && i.pause().cycle()
        })
    }
    var t = function(t, n) {
        this.$element = e(t), this.$indicators = this.$element.find(".carousel-indicators"), this.options = n, this.paused = null, this.sliding = null, this.interval = null, this.$active = null, this.$items = null, this.options.keyboard && this.$element.on("keydown.bs.carousel", e.proxy(this.keydown, this)), this.options.pause == "hover" && !("ontouchstart" in document.documentElement) && this.$element.on("mouseenter.bs.carousel", e.proxy(this.pause, this)).on("mouseleave.bs.carousel", e.proxy(this.cycle, this))
    };
    t.VERSION = "3.3.6", t.TRANSITION_DURATION = 600, t.DEFAULTS = {
        interval: 5e3,
        pause: "hover",
        wrap: !0,
        keyboard: !0
    }, t.prototype.keydown = function(e) {
        if (/input|textarea/i.test(e.target.tagName)) return;
        switch (e.which) {
            case 37:
                this.prev();
                break;
            case 39:
                this.next();
                break;
            default:
                return
        }
        e.preventDefault()
    }, t.prototype.cycle = function(t) {
        return t || (this.paused = !1), this.interval && clearInterval(this.interval), this.options.interval && !this.paused && (this.interval = setInterval(e.proxy(this.next, this), this.options.interval)), this
    }, t.prototype.getItemIndex = function(e) {
        return this.$items = e.parent().children(".item"), this.$items.index(e || this.$active)
    }, t.prototype.getItemForDirection = function(e, t) {
        var n = this.getItemIndex(t),
            r = e == "prev" && n === 0 || e == "next" && n == this.$items.length - 1;
        if (r && !this.options.wrap) return t;
        var i = e == "prev" ? -1 : 1,
            s = (n + i) % this.$items.length;
        return this.$items.eq(s)
    }, t.prototype.to = function(e) {
        var t = this,
            n = this.getItemIndex(this.$active = this.$element.find(".item.active"));
        if (e > this.$items.length - 1 || e < 0) return;
        return this.sliding ? this.$element.one("slid.bs.carousel", function() {
            t.to(e)
        }) : n == e ? this.pause().cycle() : this.slide(e > n ? "next" : "prev", this.$items.eq(e))
    }, t.prototype.pause = function(t) {
        return t || (this.paused = !0), this.$element.find(".next, .prev").length && e.support.transition && (this.$element.trigger(e.support.transition.end), this.cycle(!0)), this.interval = clearInterval(this.interval), this
    }, t.prototype.next = function() {
        if (this.sliding) return;
        return this.slide("next")
    }, t.prototype.prev = function() {
        if (this.sliding) return;
        return this.slide("prev")
    }, t.prototype.slide = function(n, r) {
        var i = this.$element.find(".item.active"),
            s = r || this.getItemForDirection(n, i),
            o = this.interval,
            u = n == "next" ? "left" : "right",
            a = this;
        if (s.hasClass("active")) return this.sliding = !1;
        var f = s[0],
            l = e.Event("slide.bs.carousel", {
                relatedTarget: f,
                direction: u
            });
        this.$element.trigger(l);
        if (l.isDefaultPrevented()) return;
        this.sliding = !0, o && this.pause();
        if (this.$indicators.length) {
            this.$indicators.find(".active").removeClass("active");
            var c = e(this.$indicators.children()[this.getItemIndex(s)]);
            c && c.addClass("active")
        }
        var h = e.Event("slid.bs.carousel", {
            relatedTarget: f,
            direction: u
        });
        return e.support.transition && this.$element.hasClass("slide") ? (s.addClass(n), s[0].offsetWidth, i.addClass(u), s.addClass(u), i.one("bsTransitionEnd", function() {
            s.removeClass([n, u].join(" ")).addClass("active"), i.removeClass(["active", u].join(" ")), a.sliding = !1, setTimeout(function() {
                a.$element.trigger(h)
            }, 0)
        }).emulateTransitionEnd(t.TRANSITION_DURATION)) : (i.removeClass("active"), s.addClass("active"), this.sliding = !1, this.$element.trigger(h)), o && this.cycle(), this
    };
    var r = e.fn.carousel;
    e.fn.carousel = n, e.fn.carousel.Constructor = t, e.fn.carousel.noConflict = function() {
        return e.fn.carousel = r, this
    };
    var i = function(t) {
        var r, i = e(this),
            s = e(i.attr("data-target") || (r = i.attr("href")) && r.replace(/.*(?=#[^\s]+$)/, ""));
        if (!s.hasClass("carousel")) return;
        var o = e.extend({}, s.data(), i.data()),
            u = i.attr("data-slide-to");
        u && (o.interval = !1), n.call(s, o), u && s.data("bs.carousel").to(u), t.preventDefault()
    };
    e(document).on("click.bs.carousel.data-api", "[data-slide]", i).on("click.bs.carousel.data-api", "[data-slide-to]", i), e(window).on("load", function() {
        e('[data-ride="carousel"]').each(function() {
            var t = e(this);
            n.call(t, t.data())
        })
    })
}(jQuery), + function(e) {
    "use strict";

    function n(n) {
        return this.each(function() {
            var r = e(this),
                i = r.data("bs.tooltip"),
                s = typeof n == "object" && n;
            if (!i && /destroy|hide/.test(n)) return;
            i || r.data("bs.tooltip", i = new t(this, s)), typeof n == "string" && i[n]()
        })
    }
    var t = function(e, t) {
        this.type = null, this.options = null, this.enabled = null, this.timeout = null, this.hoverState = null, this.$element = null, this.inState = null, this.init("tooltip", e, t)
    };
    t.VERSION = "3.3.6", t.TRANSITION_DURATION = 150, t.DEFAULTS = {
        animation: !0,
        placement: "top",
        selector: !1,
        template: '<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
        trigger: "hover focus",
        title: "",
        delay: 0,
        html: !1,
        container: !1,
        viewport: {
            selector: "body",
            padding: 0
        }
    }, t.prototype.init = function(t, n, r) {
        this.enabled = !0, this.type = t, this.$element = e(n), this.options = this.getOptions(r), this.$viewport = this.options.viewport && e(e.isFunction(this.options.viewport) ? this.options.viewport.call(this, this.$element) : this.options.viewport.selector || this.options.viewport), this.inState = {
            click: !1,
            hover: !1,
            focus: !1
        };
        if (this.$element[0] instanceof document.constructor && !this.options.selector) throw new Error("`selector` option must be specified when initializing " + this.type + " on the window.document object!");
        var i = this.options.trigger.split(" ");
        for (var s = i.length; s--;) {
            var o = i[s];
            if (o == "click") this.$element.on("click." + this.type, this.options.selector, e.proxy(this.toggle, this));
            else if (o != "manual") {
                var u = o == "hover" ? "mouseenter" : "focusin",
                    a = o == "hover" ? "mouseleave" : "focusout";
                this.$element.on(u + "." + this.type, this.options.selector, e.proxy(this.enter, this)), this.$element.on(a + "." + this.type, this.options.selector, e.proxy(this.leave, this))
            }
        }
        this.options.selector ? this._options = e.extend({}, this.options, {
            trigger: "manual",
            selector: ""
        }) : this.fixTitle()
    }, t.prototype.getDefaults = function() {
        return t.DEFAULTS
    }, t.prototype.getOptions = function(t) {
        return t = e.extend({}, this.getDefaults(), this.$element.data(), t), t.delay && typeof t.delay == "number" && (t.delay = {
            show: t.delay,
            hide: t.delay
        }), t
    }, t.prototype.getDelegateOptions = function() {
        var t = {},
            n = this.getDefaults();
        return this._options && e.each(this._options, function(e, r) {
            n[e] != r && (t[e] = r)
        }), t
    }, t.prototype.enter = function(t) {
        var n = t instanceof this.constructor ? t : e(t.currentTarget).data("bs." + this.type);
        n || (n = new this.constructor(t.currentTarget, this.getDelegateOptions()), e(t.currentTarget).data("bs." + this.type, n)), t instanceof e.Event && (n.inState[t.type == "focusin" ? "focus" : "hover"] = !0);
        if (n.tip().hasClass("in") || n.hoverState == "in") {
            n.hoverState = "in";
            return
        }
        clearTimeout(n.timeout), n.hoverState = "in";
        if (!n.options.delay || !n.options.delay.show) return n.show();
        n.timeout = setTimeout(function() {
            n.hoverState == "in" && n.show()
        }, n.options.delay.show)
    }, t.prototype.isInStateTrue = function() {
        for (var e in this.inState)
            if (this.inState[e]) return !0;
        return !1
    }, t.prototype.leave = function(t) {
        var n = t instanceof this.constructor ? t : e(t.currentTarget).data("bs." + this.type);
        n || (n = new this.constructor(t.currentTarget, this.getDelegateOptions()), e(t.currentTarget).data("bs." + this.type, n)), t instanceof e.Event && (n.inState[t.type == "focusout" ? "focus" : "hover"] = !1);
        if (n.isInStateTrue()) return;
        clearTimeout(n.timeout), n.hoverState = "out";
        if (!n.options.delay || !n.options.delay.hide) return n.hide();
        n.timeout = setTimeout(function() {
            n.hoverState == "out" && n.hide()
        }, n.options.delay.hide)
    }, t.prototype.show = function() {
        var n = e.Event("show.bs." + this.type);
        if (this.hasContent() && this.enabled) {
            this.$element.trigger(n);
            var r = e.contains(this.$element[0].ownerDocument.documentElement, this.$element[0]);
            if (n.isDefaultPrevented() || !r) return;
            var i = this,
                s = this.tip(),
                o = this.getUID(this.type);
            this.setContent(), s.attr("id", o), this.$element.attr("aria-describedby", o), this.options.animation && s.addClass("fade");
            var u = typeof this.options.placement == "function" ? this.options.placement.call(this, s[0], this.$element[0]) : this.options.placement,
                a = /\s?auto?\s?/i,
                f = a.test(u);
            f && (u = u.replace(a, "") || "top"), s.detach().css({
                top: 0,
                left: 0,
                display: "block"
            }).addClass(u).data("bs." + this.type, this), this.options.container ? s.appendTo(this.options.container) : s.insertAfter(this.$element), this.$element.trigger("inserted.bs." + this.type);
            var l = this.getPosition(),
                c = s[0].offsetWidth,
                h = s[0].offsetHeight;
            if (f) {
                var p = u,
                    d = this.getPosition(this.$viewport);
                u = u == "bottom" && l.bottom + h > d.bottom ? "top" : u == "top" && l.top - h < d.top ? "bottom" : u == "right" && l.right + c > d.width ? "left" : u == "left" && l.left - c < d.left ? "right" : u, s.removeClass(p).addClass(u)
            }
            var v = this.getCalculatedOffset(u, l, c, h);
            this.applyPlacement(v, u);
            var m = function() {
                var e = i.hoverState;
                i.$element.trigger("shown.bs." + i.type), i.hoverState = null, e == "out" && i.leave(i)
            };
            e.support.transition && this.$tip.hasClass("fade") ? s.one("bsTransitionEnd", m).emulateTransitionEnd(t.TRANSITION_DURATION) : m()
        }
    }, t.prototype.applyPlacement = function(t, n) {
        var r = this.tip(),
            i = r[0].offsetWidth,
            s = r[0].offsetHeight,
            o = parseInt(r.css("margin-top"), 10),
            u = parseInt(r.css("margin-left"), 10);
        isNaN(o) && (o = 0), isNaN(u) && (u = 0), t.top += o, t.left += u, e.offset.setOffset(r[0], e.extend({
            using: function(e) {
                r.css({
                    top: Math.round(e.top),
                    left: Math.round(e.left)
                })
            }
        }, t), 0), r.addClass("in");
        var a = r[0].offsetWidth,
            f = r[0].offsetHeight;
        n == "top" && f != s && (t.top = t.top + s - f);
        var l = this.getViewportAdjustedDelta(n, t, a, f);
        l.left ? t.left += l.left : t.top += l.top;
        var c = /top|bottom/.test(n),
            h = c ? l.left * 2 - i + a : l.top * 2 - s + f,
            p = c ? "offsetWidth" : "offsetHeight";
        r.offset(t), this.replaceArrow(h, r[0][p], c)
    }, t.prototype.replaceArrow = function(e, t, n) {
        this.arrow().css(n ? "left" : "top", 50 * (1 - e / t) + "%").css(n ? "top" : "left", "")
    }, t.prototype.setContent = function() {
        var e = this.tip(),
            t = this.getTitle();
        e.find(".tooltip-inner")[this.options.html ? "html" : "text"](t), e.removeClass("fade in top bottom left right")
    }, t.prototype.hide = function(n) {
        function o() {
            r.hoverState != "in" && i.detach(), r.$element.removeAttr("aria-describedby").trigger("hidden.bs." + r.type), n && n()
        }
        var r = this,
            i = e(this.$tip),
            s = e.Event("hide.bs." + this.type);
        this.$element.trigger(s);
        if (s.isDefaultPrevented()) return;
        return i.removeClass("in"), e.support.transition && i.hasClass("fade") ? i.one("bsTransitionEnd", o).emulateTransitionEnd(t.TRANSITION_DURATION) : o(), this.hoverState = null, this
    }, t.prototype.fixTitle = function() {
        var e = this.$element;
        (e.attr("title") || typeof e.attr("data-original-title") != "string") && e.attr("data-original-title", e.attr("title") || "").attr("title", "")
    }, t.prototype.hasContent = function() {
        return this.getTitle()
    }, t.prototype.getPosition = function(t) {
        t = t || this.$element;
        var n = t[0],
            r = n.tagName == "BODY",
            i = n.getBoundingClientRect();
        i.width == null && (i = e.extend({}, i, {
            width: i.right - i.left,
            height: i.bottom - i.top
        }));
        var s = r ? {
                top: 0,
                left: 0
            } : t.offset(),
            o = {
                scroll: r ? document.documentElement.scrollTop || document.body.scrollTop : t.scrollTop()
            },
            u = r ? {
                width: e(window).width(),
                height: e(window).height()
            } : null;
        return e.extend({}, i, o, u, s)
    }, t.prototype.getCalculatedOffset = function(e, t, n, r) {
        return e == "bottom" ? {
            top: t.top + t.height,
            left: t.left + t.width / 2 - n / 2
        } : e == "top" ? {
            top: t.top - r,
            left: t.left + t.width / 2 - n / 2
        } : e == "left" ? {
            top: t.top + t.height / 2 - r / 2,
            left: t.left - n
        } : {
            top: t.top + t.height / 2 - r / 2,
            left: t.left + t.width
        }
    }, t.prototype.getViewportAdjustedDelta = function(e, t, n, r) {
        var i = {
            top: 0,
            left: 0
        };
        if (!this.$viewport) return i;
        var s = this.options.viewport && this.options.viewport.padding || 0,
            o = this.getPosition(this.$viewport);
        if (/right|left/.test(e)) {
            var u = t.top - s - o.scroll,
                a = t.top + s - o.scroll + r;
            u < o.top ? i.top = o.top - u : a > o.top + o.height && (i.top = o.top + o.height - a)
        } else {
            var f = t.left - s,
                l = t.left + s + n;
            f < o.left ? i.left = o.left - f : l > o.right && (i.left = o.left + o.width - l)
        }
        return i
    }, t.prototype.getTitle = function() {
        var e, t = this.$element,
            n = this.options;
        return e = t.attr("data-original-title") || (typeof n.title == "function" ? n.title.call(t[0]) : n.title), e
    }, t.prototype.getUID = function(e) {
        do e += ~~(Math.random() * 1e6); while (document.getElementById(e));
        return e
    }, t.prototype.tip = function() {
        if (!this.$tip) {
            this.$tip = e(this.options.template);
            if (this.$tip.length != 1) throw new Error(this.type + " `template` option must consist of exactly 1 top-level element!")
        }
        return this.$tip
    }, t.prototype.arrow = function() {
        return this.$arrow = this.$arrow || this.tip().find(".tooltip-arrow")
    }, t.prototype.enable = function() {
        this.enabled = !0
    }, t.prototype.disable = function() {
        this.enabled = !1
    }, t.prototype.toggleEnabled = function() {
        this.enabled = !this.enabled
    }, t.prototype.toggle = function(t) {
        var n = this;
        t && (n = e(t.currentTarget).data("bs." + this.type), n || (n = new this.constructor(t.currentTarget, this.getDelegateOptions()), e(t.currentTarget).data("bs." + this.type, n))), t ? (n.inState.click = !n.inState.click, n.isInStateTrue() ? n.enter(n) : n.leave(n)) : n.tip().hasClass("in") ? n.leave(n) : n.enter(n)
    }, t.prototype.destroy = function() {
        var e = this;
        clearTimeout(this.timeout), this.hide(function() {
            e.$element.off("." + e.type).removeData("bs." + e.type), e.$tip && e.$tip.detach(), e.$tip = null, e.$arrow = null, e.$viewport = null
        })
    };
    var r = e.fn.tooltip;
    e.fn.tooltip = n, e.fn.tooltip.Constructor = t, e.fn.tooltip.noConflict = function() {
        return e.fn.tooltip = r, this
    }
}(jQuery), + function(e) {
    "use strict";

    function n(t) {
        var n, r = t.attr("data-target") || (n = t.attr("href")) && n.replace(/.*(?=#[^\s]+$)/, "");
        return e(r)
    }

    function r(n) {
        return this.each(function() {
            var r = e(this),
                i = r.data("bs.collapse"),
                s = e.extend({}, t.DEFAULTS, r.data(), typeof n == "object" && n);
            !i && s.toggle && /show|hide/.test(n) && (s.toggle = !1), i || r.data("bs.collapse", i = new t(this, s)), typeof n == "string" && i[n]()
        })
    }
    var t = function(n, r) {
        this.$element = e(n), this.options = e.extend({}, t.DEFAULTS, r), this.$trigger = e('[data-toggle="collapse"][href="#' + n.id + '"],' + '[data-toggle="collapse"][data-target="#' + n.id + '"]'), this.transitioning = null, this.options.parent ? this.$parent = this.getParent() : this.addAriaAndCollapsedClass(this.$element, this.$trigger), this.options.toggle && this.toggle()
    };
    t.VERSION = "3.3.6", t.TRANSITION_DURATION = 350, t.DEFAULTS = {
        toggle: !0
    }, t.prototype.dimension = function() {
        var e = this.$element.hasClass("width");
        return e ? "width" : "height"
    }, t.prototype.show = function() {
        if (this.transitioning || this.$element.hasClass("in")) return;
        var n, i = this.$parent && this.$parent.children(".panel").children(".in, .collapsing");
        if (i && i.length) {
            n = i.data("bs.collapse");
            if (n && n.transitioning) return
        }
        var s = e.Event("show.bs.collapse");
        this.$element.trigger(s);
        if (s.isDefaultPrevented()) return;
        i && i.length && (r.call(i, "hide"), n || i.data("bs.collapse", null));
        var o = this.dimension();
        this.$element.removeClass("collapse").addClass("collapsing")[o](0).attr("aria-expanded", !0), this.$trigger.removeClass("collapsed").attr("aria-expanded", !0), this.transitioning = 1;
        var u = function() {
            this.$element.removeClass("collapsing").addClass("collapse in")[o](""), this.transitioning = 0, this.$element.trigger("shown.bs.collapse")
        };
        if (!e.support.transition) return u.call(this);
        var a = e.camelCase(["scroll", o].join("-"));
        this.$element.one("bsTransitionEnd", e.proxy(u, this)).emulateTransitionEnd(t.TRANSITION_DURATION)[o](this.$element[0][a])
    }, t.prototype.hide = function() {
        if (this.transitioning || !this.$element.hasClass("in")) return;
        var n = e.Event("hide.bs.collapse");
        this.$element.trigger(n);
        if (n.isDefaultPrevented()) return;
        var r = this.dimension();
        this.$element[r](this.$element[r]())[0].offsetHeight, this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded", !1), this.$trigger.addClass("collapsed").attr("aria-expanded", !1), this.transitioning = 1;
        var i = function() {
            this.transitioning = 0, this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")
        };
        if (!e.support.transition) return i.call(this);
        this.$element[r](0).one("bsTransitionEnd", e.proxy(i, this)).emulateTransitionEnd(t.TRANSITION_DURATION)
    }, t.prototype.toggle = function() {
        this[this.$element.hasClass("in") ? "hide" : "show"]()
    }, t.prototype.getParent = function() {
        return e(this.options.parent).find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]').each(e.proxy(function(t, r) {
            var i = e(r);
            this.addAriaAndCollapsedClass(n(i), i)
        }, this)).end()
    }, t.prototype.addAriaAndCollapsedClass = function(e, t) {
        var n = e.hasClass("in");
        e.attr("aria-expanded", n), t.toggleClass("collapsed", !n).attr("aria-expanded", n)
    };
    var i = e.fn.collapse;
    e.fn.collapse = r, e.fn.collapse.Constructor = t, e.fn.collapse.noConflict = function() {
        return e.fn.collapse = i, this
    }, e(document).on("click.bs.collapse.data-api", '[data-toggle="collapse"]', function(t) {
        var i = e(this);
        i.attr("data-target") || t.preventDefault();
        var s = n(i),
            o = s.data("bs.collapse"),
            u = o ? "toggle" : i.data();
        r.call(s, u)
    })
}(jQuery), + function(e) {
    "use strict";

    function t() {
        var e = document.createElement("bootstrap"),
            t = {
                WebkitTransition: "webkitTransitionEnd",
                MozTransition: "transitionend",
                OTransition: "oTransitionEnd otransitionend",
                transition: "transitionend"
            };
        for (var n in t)
            if (e.style[n] !== undefined) return {
                end: t[n]
            };
        return !1
    }
    e.fn.emulateTransitionEnd = function(t) {
        var n = !1,
            r = this;
        e(this).one("bsTransitionEnd", function() {
            n = !0
        });
        var i = function() {
            n || e(r).trigger(e.support.transition.end)
        };
        return setTimeout(i, t), this
    }, e(function() {
        e.support.transition = t();
        if (!e.support.transition) return;
        e.event.special.bsTransitionEnd = {
            bindType: e.support.transition.end,
            delegateType: e.support.transition.end,
            handle: function(t) {
                if (e(t.target).is(this)) return t.handleObj.handler.apply(this, arguments)
            }
        }
    })
}(jQuery), define("bootstrap", function() {}), define("components/app/header/HeaderView", ["jquery", "underscore", "backbone", "bootstrap"], function(e, t, n) {
        var r = n.View.extend({
            events: {
                "click .home-link": "handleHomeLink",
                "click .modal-link": "handleModalLink",
                "click .page-link": "handlePageLink"
            },
            initialize: function() {
                this.listenTo(this.model, "change:activePage", this.handleActivePage)
            },
            render: function() {
                return this
            },
            handleHomeLink: function(t) {
                t.preventDefault(), this.$el.trigger("resetApp"), e("#navbar-collapse").collapse("hide")
            },
            handlePageLink: function(t) {
                t.preventDefault(), t.stopPropagation(), this.$el.trigger("pageLinkClick", {
                    target: t.target,
                    id: e(t.target).data("pageid")
                }), e("#navbar-collapse").collapse("hide")
            },
            handleModalLink: function(t) {
                t.preventDefault(), this.$el.trigger("modalOpen", {
                    target: t.target,
                    type: e(t.target).data("modaltype")
                }), e("#navbar-collapse").collapse("hide")
            },
            handleActivePage: function() {
                this.$(".page-link").removeClass("active");
                if (typeof this.model.getActivePage() != "undefined") {
                    var e = typeof this.model.getActivePage().getParent() != "undefined" ? this.model.getActivePage().getParent() : this.model.getActivePage().id;
                    this.$('[data-pageid="' + e + '"]').addClass("active")
                }
            }
        });
        return r
    }), define("components/app/header/HeaderModel", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.Model.extend({
            initialize: function(e) {
                this.options = e || {}
            },
            setActivePath: function(e) {
                this.set("activePath", e)
            },
            setActivePage: function(e) {
                this.set("activePage", e)
            },
            getActivePage: function() {
                return this.attributes.activePage
            },
            getMode: function() {
                return this.attributes.mode
            }
        });
        return r
    }),
    function() {
        var e = ["Msxml2.XMLHTTP", "Microsoft.XMLHTTP", "Msxml2.XMLHTTP.4.0"],
            t = /^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,
            n = /<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,
            r = typeof location != "undefined" && location.href,
            i = r && location.protocol && location.protocol.replace(/\:/, ""),
            s = r && location.hostname,
            o = r && (location.port || void 0),
            u = [];
        define("text", [], function() {
            var a, f, l;
            return typeof window != "undefined" && window.navigator && window.document ? f = function(e, t) {
                var n = a.createXhr();
                n.open("GET", e, !0), n.onreadystatechange = function() {
                    n.readyState === 4 && t(n.responseText)
                }, n.send(null)
            } : typeof process != "undefined" && process.versions && process.versions.node ? (l = require.nodeRequire("fs"), f = function(e, t) {
                t(l.readFileSync(e, "utf8"))
            }) : typeof Packages != "undefined" && (f = function(e, t) {
                var n = new java.io.File(e),
                    r = java.lang.System.getProperty("line.separator"),
                    n = new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(n), "utf-8")),
                    i, s, o = "";
                try {
                    i = new java.lang.StringBuffer, (s = n.readLine()) && s.length() && s.charAt(0) === 65279 && (s = s.substring(1));
                    for (i.append(s);
                        (s = n.readLine()) !== null;) i.append(r), i.append(s);
                    o = String(i.toString())
                } finally {
                    n.close()
                }
                t(o)
            }), a = {
                version: "0.27.0",
                strip: function(e) {
                    if (e) {
                        var e = e.replace(t, ""),
                            r = e.match(n);
                        r && (e = r[1])
                    } else e = "";
                    return e
                },
                jsEscape: function(e) {
                    return e.replace(/(['\\])/g, "\\$1").replace(/[\f]/g, "\\f").replace(/[\b]/g, "\\b").replace(/[\n]/g, "\\n").replace(/[\t]/g, "\\t").replace(/[\r]/g, "\\r")
                },
                createXhr: function() {
                    var t, n, r;
                    if (typeof XMLHttpRequest != "undefined") return new XMLHttpRequest;
                    for (n = 0; n < 3; n++) {
                        r = e[n];
                        try {
                            t = new ActiveXObject(r)
                        } catch (i) {}
                        if (t) {
                            e = [r];
                            break
                        }
                    }
                    if (!t) throw Error("createXhr(): XMLHttpRequest not available");
                    return t
                },
                get: f,
                parseName: function(e) {
                    var t = !1,
                        n = e.indexOf("."),
                        r = e.substring(0, n),
                        e = e.substring(n + 1, e.length),
                        n = e.indexOf("!");
                    return n !== -1 && (t = e.substring(n + 1, e.length), t = t === "strip", e = e.substring(0, n)), {
                        moduleName: r,
                        ext: e,
                        strip: t
                    }
                },
                xdRegExp: /^((\w+)\:)?\/\/([^\/\\]+)/,
                useXhr: function(e, t, n, r) {
                    var i = a.xdRegExp.exec(e),
                        s;
                    return i ? (e = i[2], i = i[3], i = i.split(":"), s = i[1], i = i[0], (!e || e === t) && (!i || i === n) && (!s && !i || s === r)) : !0
                },
                finishLoad: function(e, t, n, r, i) {
                    n = t ? a.strip(n) : n, i.isBuild && i.inlineText && (u[e] = n), r(n)
                },
                load: function(e, t, n, u) {
                    var f = a.parseName(e),
                        l = f.moduleName + "." + f.ext,
                        c = t.toUrl(l),
                        h = u && u.text && u.text.useXhr || a.useXhr;
                    !r || h(c, i, s, o) ? a.get(c, function(t) {
                        a.finishLoad(e, f.strip, t, n, u)
                    }) : t([l], function(e) {
                        a.finishLoad(f.moduleName + "." + f.ext, f.strip, e, n, u)
                    })
                },
                write: function(e, t, n) {
                    if (t in u) {
                        var r = a.jsEscape(u[t]);
                        n.asModule(e + "!" + t, "define(function () { return '" + r + "';});\n")
                    }
                },
                writeFile: function(e, t, n, r, i) {
                    var t = a.parseName(t),
                        s = t.moduleName + "." + t.ext,
                        o = n.toUrl(t.moduleName + "." + t.ext) + ".js";
                    a.load(s, n, function() {
                        var t = function(e) {
                            return r(o, e)
                        };
                        t.asModule = function(e, t) {
                            return r.asModule(e, o, t)
                        }, a.write(e, s, t, i)
                    }, i)
                }
            }
        })
    }(), define("text!components/app/key/mapKeyTemplate.html", [], function() {
        return '<% if (layerKeys.length > 0) {%>\r\n<div class="map-key">\r\n  <div class="map-key-label">\r\n  <%= t.ux.map.map_key %>\r\n  </div>\r\n  <div class="scroll-cover">\r\n    <a class="scroll-up reveal-on-hover" href="#">      \r\n      <span class="icon-wwf_scroll-up hide-on-hover"></span>      \r\n      <span class="icon-wwf_scroll-up-hover show-on-hover  show-on-hover-inline"></span>            \r\n    </a>\r\n    <ul class="map-key-layer-list list-unstyled scroll-scroller  <%= preventLayerToggle ? \'prevent-layer-toggle\' : \'\' %>">\r\n      <% _.each(layerKeys, function(layerKey){ %>\r\n      <li class="map-key-layer-list-item reveal-on-hover">\r\n        <%= layerKey %>\r\n      </li>  \r\n      <% }) %>\r\n    </ul>\r\n    <a class="scroll-down reveal-on-hover" href="#">      \r\n      <span class="icon-wwf_scroll-down hide-on-hover"></span>      \r\n      <span class="icon-wwf_scroll-down-hover show-on-hover show-on-hover-inline"></span>      \r\n    </a>\r\n  </div>\r\n</div>\r\n<% } %>\r\n'
    }), define("text!components/app/key/layerKeyFullTemplate.html", [], function() {
        return '<%= keyHtml %> \r\n<div class="show-on-hover layer-key-panel arrow_box_right key-layer-<%= id %> panel-white">\r\n  <table class="table-layer-select"><tbody>\r\n    <tr class="layer-key-main">\r\n      <td class="toggle">\r\n        <a href="#" class="icon-wwf_tick toggle-layer <%= isActive ? \'active\' : \'\' %>"\r\n           data-toggable="<%= toggable %>"              \r\n           data-layerid="<%= id %>">\r\n        </a>             \r\n      </td>\r\n      <td class="title">\r\n        <a href="#" class="toggle-layer <%= isActive ? \'active\' : \'\' %> " \r\n           data-toggable="<%= toggable %>"\r\n           data-layerid="<%= id %>">\r\n          <div class="title-inner"><%= title %></div>\r\n        </a>\r\n        <% if(hint !== \'\') { %>\r\n        <div class="hint">\r\n          <%= hint %>\r\n        </div>\r\n        <% } %>           \r\n      </td>\r\n     </tr>\r\n    <% if (layerGradient) { %>\r\n    <tr class="layer-color-gradient">\r\n      <td></td>\r\n      <td colspan="2">\r\n        <%= layerGradient %> \r\n      </td>      \r\n    </tr>\r\n    <% } %>\r\n    <% if (layerCategories) { %>\r\n    <tr class="layer-color-groups">\r\n      <td></td>\r\n      <td>\r\n        <ul class="list-unstyled">\r\n        <% _.each(layerCategories, function(cat){ %>\r\n          <li>\r\n            <%= cat.color %>            \r\n            <%= cat.label %>\r\n          </li>          \r\n        <% }) %>\r\n        </ul>\r\n      </td>\r\n      <td></td>\r\n    </tr>    \r\n    <% } %>    \r\n    </tbody>\r\n  </table>\r\n</div>\r\n'
    }), define("components/app/key/KeyView", ["jquery", "underscore", "backbone", "text!./mapKeyTemplate.html", "text!./layerKeyFullTemplate.html"], function(e, t, n, r, i) {
        var s = n.View.extend({
            events: {
                "click .layer-info-link": "handleLayerInfoLink",
                "click .toggle-layer": "toggleLayer",
                "click .scroll-up": "scrollUp",
                "click .scroll-down": "scrollDown",
                "click .edit-layer": "handleLayerEdit"
            },
            initialize: function() {
                this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:activeLayers", this.handleLayerUpdate), this.listenTo(this.model, "change:customLayerData", this.handleLayerUpdate), e(window).on("resize", t.debounce(t.bind(this.resize, this), 100))
            },
            render: function() {
                return this.setupScroll(), this.populateKey(), this
            },
            resize: function() {
                this.setupScroll(), this.scrollToTop()
            },
            handleLayerInfoLink: function(t) {
                t.preventDefault(), this.$el.trigger("layerInfoLinkClick", {
                    target: t.target,
                    id: e(t.target).data("layerid")
                })
            },
            toggleLayer: function(t) {
                t.preventDefault(), t.stopPropagation(), this.model.getAllowLayerToggle() && (e(t.currentTarget).data("toggable") || e(t.currentTarget).data("toggable") === "true") && this.$el.trigger("layerToggled", {
                    id: e(t.currentTarget).data("layerid")
                })
            },
            handleLayerEdit: function(t) {
                t.preventDefault(), this.$el.trigger("editCustomLayer", {
                    id: e(t.target).data("layerid")
                })
            },
            handleActive: function() {
                this.model.isActive() ? this.$el.show() : this.$el.hide()
            },
            handleLayerUpdate: function() {
                this.model.getActiveLayers().length > 0 ? (this.$el.show(), this.render()) : this.$el.hide()
            },
            populateKey: function() {
                var e = this;
                this.$el.html(t.template(r)({
                    preventLayerToggle: !this.model.getAllowLayerToggle(),
                    layerKeys: t.map(this.model.getActiveLayers(), function(n) {
                        return t.template(i)({
                            preventLayerToggle: !e.model.getAllowLayerToggle(),
                            id: n.id,
                            title: n.getTitle(),
                            hint: n.getHint(),
                            toggable: !n.isBasemap(),
                            layerGradient: n.makeLayerGradientKey(),
                            layerCategories: n.makeLayerCategoriesKey(),
                            isActive: n.isActive() || n.isBasemap(),
                            isCustom: n.isCustom(),
                            keyHtml: n.getKeySquareIcon("lg"),
                            lang: lang,
                            t: tlang
                        })
                    }),
                    t: tlang
                })), t.each(this.model.getAddLayers(), function(e) {
                    if (!e.isBasemap()) {
                        var t = this.$(".key-layer-" + e.id);
                        t.addClass("show-hover"), setTimeout(function() {
                            t.removeClass("show-hover")
                        }, 2e3)
                    }
                }, this), this.setupScroll(), this.updateScroll()
            },
            getKeyAvailableHeight: function() {
                return e("#map").outerHeight() - this.$el.offset().top - parseInt(this.$el.css("bottom").replace("px", ""))
            },
            setupScroll: function() {
                this.scroller = {
                    cover: this.$(".scroll-cover"),
                    inner: this.$(".scroll-scroller"),
                    neededh: this.$(".scroll-scroller").outerHeight(),
                    availh: this.getKeyAvailableHeight()
                }
            },
            updateScroll: function() {
                var e = this.$(".map-key-label").outerHeight();
                this.scroller.cover.css("max-height", this.scroller.availh - e);
                var t = this.scroller.neededh - (this.scroller.availh - e);
                if (t > 0) {
                    this.scroller.cover.addClass("scrolling");
                    var n = -parseInt(this.scroller.inner.css("top"), 10);
                    n === t ? this.scroller.cover.addClass("scrolled-bottom") : this.scroller.cover.removeClass("scrolled-bottom"), n > 0 ? this.scroller.cover.addClass("scrolled") : this.scroller.cover.removeClass("scrolled")
                } else this.scroller.cover.removeClass("scrolling");
                this.offsetInfoPanel()
            },
            scrollDown: function(e) {
                e.preventDefault();
                var t = this.$(".map-key-label").outerHeight(),
                    n = this.scroller.neededh - (this.scroller.availh - t),
                    r = -parseInt(this.scroller.inner.css("top"), 10);
                if (r < n) {
                    var i = r + Math.min(this.scroller.availh * .8, n - r),
                        s = this;
                    this.scroller.inner.animate({
                        top: -i
                    }, {
                        duration: 800,
                        step: function() {
                            s.hideOverFlow()
                        },
                        complete: function() {
                            s.updateScroll()
                        }
                    })
                }
            },
            scrollUp: function(e) {
                e.preventDefault();
                var t = this.$(".map-key-label").outerHeight(),
                    n = -parseInt(this.scroller.inner.css("top"), 10);
                if (n > 0) {
                    var r = n - Math.min((this.scroller.availh - t) * .8, n),
                        i = this;
                    this.scroller.inner.animate({
                        top: -r
                    }, {
                        duration: 800,
                        step: function() {
                            i.hideOverFlow()
                        },
                        complete: function() {
                            i.updateScroll()
                        }
                    })
                }
            },
            scrollToTop: function(e) {
                var t = this;
                this.scroller.inner.animate({
                    top: 0
                }, {
                    duration: 100,
                    step: function() {
                        t.hideOverFlow()
                    },
                    complete: function() {
                        t.updateScroll()
                    }
                })
            },
            hideOverFlow: function() {
                var t = 10,
                    n = this.$el.offset().top,
                    r = this.$el.outerHeight() + this.$el.offset().top;
                this.$(".map-key-layer-list-item").each(function() {
                    var i = e(this).offset().top,
                        s = e(this).offset().top + e(this).outerHeight();
                    n + t > i || r - t < s ? e(this).addClass("invisible") : e(this).removeClass("invisible")
                })
            },
            offsetInfoPanel: function() {
                var t = this;
                this.$(".map-key-layer-list-item").each(function() {
                    var t = e(this).find(".layer-key-panel").outerHeight(),
                        n = e(this).outerHeight(),
                        r = window.innerHeight - e(this).offset().top;
                    n < t && r > 0 && r < (t - n) / 2 && e(this).find(".layer-key-panel").addClass("align-bottom")
                })
            }
        });
        return s
    }), define("components/app/key/KeyModel", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.Model.extend({
            initialize: function(e) {
                this.options = e || {}, this.set("activeLayers", []), this.set("addLayers", [])
            },
            setActiveLayers: function(e) {
                this.set("addLayers", t.difference(e, this.attributes.activeLayers)), this.set("activeLayers", e)
            },
            setAllowLayerToggle: function(e) {
                this.set("allowLayerToggle", e)
            },
            setCustomLayerData: function(e) {
                this.set("customLayerData", e)
            },
            getAllowLayerToggle: function() {
                return this.attributes.allowLayerToggle
            },
            getActiveLayers: function() {
                return this.attributes.activeLayers
            },
            getAddLayers: function() {
                return this.attributes.addLayers
            },
            setActive: function(e) {
                e = typeof e != "undefined" ? e : !0, this.set("active", e)
            },
            isActive: function() {
                return this.get("active")
            }
        });
        return r
    }), define("text!components/app/print/printTemplate.html", [], function() {
        return '<div class="print-header">\r\n  <span class="print-header-note ocean-color"><%= t.ux.print.header_note_url %></span>\r\n  <span class="print-header-url ocean-color-dark"><%= custom_url %></span>\r\n</div>\r\n<div class="print-key container-fluid">PRINT KEY HERE </div>\r\n<div class="print-footer">\r\n  <span class="print-footer-note-origin ocean-color"><%= t.ux.print.footer_note_origin %></span>\r\n  <span class="print-header-url ocean-color-dark"><%= url %>. </span>\r\n  <span class="print-footer-note-usage ocean-color"><%= t.ux.print.footer_note_further_use %> </span>\r\n  <span class="print-footer-note-usage ocean-color"><%= t.ux.print.footer_note_map_creator %></span>\r\n</div>\r\n'
    }), define("text!components/app/print/printKeyTemplate.html", [], function() {
        return '<% if (layerChunks.length > 0) {%>\r\n  <% _.each(layerChunks, function(layers){ %>\r\n    <div class="print-key-layer-list row">      \r\n      <% _.each(layers, function(layer){ %>\r\n      <div class="print-key-layer-list-item col-xs-2">        \r\n        <%= layer.keyFullHtml %>\r\n      </div>  \r\n      <% }) %>\r\n    </div>\r\n  <% }) %>\r\n<% } %>'
    }), define("text!components/app/print/printLayerKeyTemplate.html", [], function() {
        return '<div class="layer-key-panel key-layer-<%= id %>">\r\n  <div class="print-key-layer-list-item-top">\r\n    <table class="table-layer-select"><tbody>\r\n      <tr class="layer-key-main">\r\n        <td class="key">\r\n          <%= keyHtml %>\r\n        </td>\r\n        <td class="title">\r\n          <div class="title-inner"><%= title %></div>\r\n          <% if(hint !== \'\') { %>\r\n          <div class="hint">\r\n            <%= hint %>\r\n          </div>\r\n          <% } %>            \r\n        </td>      \r\n      </tr>\r\n        <% if (layerGradient) { %>\r\n        <tr class="layer-color-gradient">\r\n          <td colspan="2">\r\n            <%= layerGradient %> \r\n          </td>      \r\n        </tr>\r\n        <% } %>\r\n        <% if (layerCategories) { %>\r\n        <tr class="layer-color-groups">\r\n          <td colspan="2">\r\n            <ul class="list-unstyled">\r\n            <% _.each(layerCategories, function(cat){ %>\r\n              <li>\r\n                <%= cat.color %>            \r\n                <%= cat.label %>\r\n              </li>          \r\n            <% }) %>\r\n            </ul>\r\n          </td>\r\n        </tr>\r\n        <% } %>      \r\n      </tbody>\r\n    </table>\r\n  </div>\r\n  <div class="print-key-layer-list-item-bottom">\r\n    <div class="print-key-layer-list-item-reference"><%= reference %></div>\r\n  </div>\r\n</div>'
    }), define("components/app/print/PrintView", ["jquery", "underscore", "backbone", "text!./printTemplate.html", "text!./printKeyTemplate.html", "text!./printLayerKeyTemplate.html"], function(e, t, n, r, i, s) {
        var o = n.View.extend({
            initialize: function() {
                this.render()
            },
            render: function() {
                var e, n, i, s = this.model.getMapId();
                return lang === "en" ? e = window.location.host : e = window.location.host + "/" + lang, n = {
                    t: tlang,
                    custom_url: e + "/#!/id/" + s,
                    url: e
                }, this.$el.html(t.template(r)(n)), this.populateKey(), this
            },
            populateKey: function() {
                this.$(".print-key").html(t.template(i)({
                    layerChunks: this.chunk(t.map(this.model.getActiveLayers(), function(e) {
                        return e.keyFullHtml = t.template(s)({
                            id: e.id,
                            title: e.getTitle(),
                            hint: e.getHint(),
                            layerGradient: e.makeLayerGradientKey(),
                            layerCategories: e.makeLayerCategoriesKey(),
                            keyHtml: e.getKeySquareIcon("lg"),
                            reference: e.getReference(!0),
                            lang: lang,
                            t: tlang
                        }), e
                    }), 6).reverse(),
                    t: tlang
                }))
            },
            chunk: function(e, t) {
                return e.reduce(function(e, n, r) {
                    return r % t === 0 && e.push([]), e[e.length - 1].push(n), e
                }, [])
            }
        });
        return o
    }), define("components/app/print/PrintModel", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.Model.extend({
            initialize: function(e) {
                this.options = e || {}
            },
            getActiveLayers: function() {
                return this.attributes.activeLayers
            },
            getMapId: function() {
                return this.attributes.mapid
            }
        });
        return r
    }),
    function(e, t, n) {
        var r = e.L,
            i = {};
        i.version = "0.7.7", typeof module == "object" && typeof module.exports == "object" ? module.exports = i : typeof define == "function" && define.amd && define("leaflet", i), i.noConflict = function() {
                return e.L = r, this
            }, e.L = i, i.Util = {
                extend: function(e) {
                    var t = Array.prototype.slice.call(arguments, 1),
                        n, r, i, s;
                    for (r = 0, i = t.length; r < i; r++) {
                        s = t[r] || {};
                        for (n in s) s.hasOwnProperty(n) && (e[n] = s[n])
                    }
                    return e
                },
                bind: function(e, t) {
                    var n = arguments.length > 2 ? Array.prototype.slice.call(arguments, 2) : null;
                    return function() {
                        return e.apply(t, n || arguments)
                    }
                },
                stamp: function() {
                    var e = 0,
                        t = "_leaflet_id";
                    return function(n) {
                        return n[t] = n[t] || ++e, n[t]
                    }
                }(),
                invokeEach: function(e, t, n) {
                    var r, i;
                    if (typeof e == "object") {
                        i = Array.prototype.slice.call(arguments, 3);
                        for (r in e) t.apply(n, [r, e[r]].concat(i));
                        return !0
                    }
                    return !1
                },
                limitExecByInterval: function(e, t, n) {
                    var r, i;
                    return function s() {
                        var o = arguments;
                        if (r) {
                            i = !0;
                            return
                        }
                        r = !0, setTimeout(function() {
                            r = !1, i && (s.apply(n, o), i = !1)
                        }, t), e.apply(n, o)
                    }
                },
                falseFn: function() {
                    return !1
                },
                formatNum: function(e, t) {
                    var n = Math.pow(10, t || 5);
                    return Math.round(e * n) / n
                },
                trim: function(e) {
                    return e.trim ? e.trim() : e.replace(/^\s+|\s+$/g, "")
                },
                splitWords: function(e) {
                    return i.Util.trim(e).split(/\s+/)
                },
                setOptions: function(e, t) {
                    return e.options = i.extend({}, e.options, t), e.options
                },
                getParamString: function(e, t, n) {
                    var r = [];
                    for (var i in e) r.push(encodeURIComponent(n ? i.toUpperCase() : i) + "=" + encodeURIComponent(e[i]));
                    return (!t || t.indexOf("?") === -1 ? "?" : "&") + r.join("&")
                },
                template: function(e, t) {
                    return e.replace(/\{ *([\w_]+) *\}/g, function(e, r) {
                        var i = t[r];
                        if (i === n) throw new Error("No value provided for variable " + e);
                        return typeof i == "function" && (i = i(t)), i
                    })
                },
                isArray: Array.isArray || function(e) {
                    return Object.prototype.toString.call(e) === "[object Array]"
                },
                emptyImageUrl: "data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="
            },
            function() {
                function t(t) {
                    var n, r, i = ["webkit", "moz", "o", "ms"];
                    for (n = 0; n < i.length && !r; n++) r = e[i[n] + t];
                    return r
                }

                function r(t) {
                    var r = +(new Date),
                        i = Math.max(0, 16 - (r - n));
                    return n = r + i, e.setTimeout(t, i)
                }
                var n = 0,
                    s = e.requestAnimationFrame || t("RequestAnimationFrame") || r,
                    o = e.cancelAnimationFrame || t("CancelAnimationFrame") || t("CancelRequestAnimationFrame") || function(t) {
                        e.clearTimeout(t)
                    };
                i.Util.requestAnimFrame = function(t, n, o, u) {
                    t = i.bind(t, n);
                    if (!o || s !== r) return s.call(e, t, u);
                    t()
                }, i.Util.cancelAnimFrame = function(t) {
                    t && o.call(e, t)
                }
            }(), i.extend = i.Util.extend, i.bind = i.Util.bind, i.stamp = i.Util.stamp, i.setOptions = i.Util.setOptions, i.Class = function() {}, i.Class.extend = function(e) {
                var t = function() {
                        this.initialize && this.initialize.apply(this, arguments), this._initHooks && this.callInitHooks()
                    },
                    n = function() {};
                n.prototype = this.prototype;
                var r = new n;
                r.constructor = t, t.prototype = r;
                for (var s in this) this.hasOwnProperty(s) && s !== "prototype" && (t[s] = this[s]);
                e.statics && (i.extend(t, e.statics), delete e.statics), e.includes && (i.Util.extend.apply(null, [r].concat(e.includes)), delete e.includes), e.options && r.options && (e.options = i.extend({}, r.options, e.options)), i.extend(r, e), r._initHooks = [];
                var o = this;
                return t.__super__ = o.prototype, r.callInitHooks = function() {
                    if (this._initHooksCalled) return;
                    o.prototype.callInitHooks && o.prototype.callInitHooks.call(this), this._initHooksCalled = !0;
                    for (var e = 0, t = r._initHooks.length; e < t; e++) r._initHooks[e].call(this)
                }, t
            }, i.Class.include = function(e) {
                i.extend(this.prototype, e)
            }, i.Class.mergeOptions = function(e) {
                i.extend(this.prototype.options, e)
            }, i.Class.addInitHook = function(e) {
                var t = Array.prototype.slice.call(arguments, 1),
                    n = typeof e == "function" ? e : function() {
                        this[e].apply(this, t)
                    };
                this.prototype._initHooks = this.prototype._initHooks || [], this.prototype._initHooks.push(n)
            };
        var s = "_leaflet_events";
        i.Mixin = {}, i.Mixin.Events = {
                addEventListener: function(e, t, n) {
                    if (i.Util.invokeEach(e, this.addEventListener, this, t, n)) return this;
                    var r = this[s] = this[s] || {},
                        o = n && n !== this && i.stamp(n),
                        u, a, f, l, c, h, p;
                    e = i.Util.splitWords(e);
                    for (u = 0, a = e.length; u < a; u++) f = {
                        action: t,
                        context: n || this
                    }, l = e[u], o ? (c = l + "_idx", h = c + "_len", p = r[c] = r[c] || {}, p[o] || (p[o] = [], r[h] = (r[h] || 0) + 1), p[o].push(f)) : (r[l] = r[l] || [], r[l].push(f));
                    return this
                },
                hasEventListeners: function(e) {
                    var t = this[s];
                    return !!t && (e in t && t[e].length > 0 || e + "_idx" in t && t[e + "_idx_len"] > 0)
                },
                removeEventListener: function(e, t, n) {
                    if (!this[s]) return this;
                    if (!e) return this.clearAllEventListeners();
                    if (i.Util.invokeEach(e, this.removeEventListener, this, t, n)) return this;
                    var r = this[s],
                        o = n && n !== this && i.stamp(n),
                        u, a, f, l, c, h, p, d, v;
                    e = i.Util.splitWords(e);
                    for (u = 0, a = e.length; u < a; u++) {
                        f = e[u], h = f + "_idx", p = h + "_len", d = r[h];
                        if (!t) delete r[f], delete r[h], delete r[p];
                        else {
                            l = o && d ? d[o] : r[f];
                            if (l) {
                                for (c = l.length - 1; c >= 0; c--) l[c].action === t && (!n || l[c].context === n) && (v = l.splice(c, 1), v[0].action = i.Util.falseFn);
                                n && d && l.length === 0 && (delete d[o], r[p]--)
                            }
                        }
                    }
                    return this
                },
                clearAllEventListeners: function() {
                    return delete this[s], this
                },
                fireEvent: function(e, t) {
                    if (!this.hasEventListeners(e)) return this;
                    var n = i.Util.extend({}, t, {
                            type: e,
                            target: this
                        }),
                        r = this[s],
                        o, u, a, f, l;
                    if (r[e]) {
                        o = r[e].slice();
                        for (u = 0, a = o.length; u < a; u++) o[u].action.call(o[u].context, n)
                    }
                    f = r[e + "_idx"];
                    for (l in f) {
                        o = f[l].slice();
                        if (o)
                            for (u = 0, a = o.length; u < a; u++) o[u].action.call(o[u].context, n)
                    }
                    return this
                },
                addOneTimeEventListener: function(e, t, n) {
                    if (i.Util.invokeEach(e, this.addOneTimeEventListener, this, t, n)) return this;
                    var r = i.bind(function() {
                        this.removeEventListener(e, t, n).removeEventListener(e, r, n)
                    }, this);
                    return this.addEventListener(e, t, n).addEventListener(e, r, n)
                }
            }, i.Mixin.Events.on = i.Mixin.Events.addEventListener, i.Mixin.Events.off = i.Mixin.Events.removeEventListener, i.Mixin.Events.once = i.Mixin.Events.addOneTimeEventListener, i.Mixin.Events.fire = i.Mixin.Events.fireEvent,
            function() {
                var r = "ActiveXObject" in e,
                    s = r && !t.addEventListener,
                    o = navigator.userAgent.toLowerCase(),
                    u = o.indexOf("webkit") !== -1,
                    a = o.indexOf("chrome") !== -1,
                    f = o.indexOf("phantom") !== -1,
                    l = o.indexOf("android") !== -1,
                    c = o.search("android [23]") !== -1,
                    h = o.indexOf("gecko") !== -1,
                    p = typeof orientation != n + "",
                    d = !e.PointerEvent && e.MSPointerEvent,
                    v = e.PointerEvent && e.navigator.pointerEnabled || d,
                    m = "devicePixelRatio" in e && e.devicePixelRatio > 1 || "matchMedia" in e && e.matchMedia("(min-resolution:144dpi)") && e.matchMedia("(min-resolution:144dpi)").matches,
                    g = t.documentElement,
                    y = r && "transition" in g.style,
                    b = "WebKitCSSMatrix" in e && "m11" in new e.WebKitCSSMatrix && !c,
                    w = "MozPerspective" in g.style,
                    E = "OTransition" in g.style,
                    S = !e.L_DISABLE_3D && (y || b || w || E) && !f,
                    x = !e.L_NO_TOUCH && !f && (v || "ontouchstart" in e || e.DocumentTouch && t instanceof e.DocumentTouch);
                i.Browser = {
                    ie: r,
                    ielt9: s,
                    webkit: u,
                    gecko: h && !u && !e.opera && !r,
                    android: l,
                    android23: c,
                    chrome: a,
                    ie3d: y,
                    webkit3d: b,
                    gecko3d: w,
                    opera3d: E,
                    any3d: S,
                    mobile: p,
                    mobileWebkit: p && u,
                    mobileWebkit3d: p && b,
                    mobileOpera: p && e.opera,
                    touch: x,
                    msPointer: d,
                    pointer: v,
                    retina: m
                }
            }(), i.Point = function(e, t, n) {
                this.x = n ? Math.round(e) : e, this.y = n ? Math.round(t) : t
            }, i.Point.prototype = {
                clone: function() {
                    return new i.Point(this.x, this.y)
                },
                add: function(e) {
                    return this.clone()._add(i.point(e))
                },
                _add: function(e) {
                    return this.x += e.x, this.y += e.y, this
                },
                subtract: function(e) {
                    return this.clone()._subtract(i.point(e))
                },
                _subtract: function(e) {
                    return this.x -= e.x, this.y -= e.y, this
                },
                divideBy: function(e) {
                    return this.clone()._divideBy(e)
                },
                _divideBy: function(e) {
                    return this.x /= e, this.y /= e, this
                },
                multiplyBy: function(e) {
                    return this.clone()._multiplyBy(e)
                },
                _multiplyBy: function(e) {
                    return this.x *= e, this.y *= e, this
                },
                round: function() {
                    return this.clone()._round()
                },
                _round: function() {
                    return this.x = Math.round(this.x), this.y = Math.round(this.y), this
                },
                floor: function() {
                    return this.clone()._floor()
                },
                _floor: function() {
                    return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this
                },
                distanceTo: function(e) {
                    e = i.point(e);
                    var t = e.x - this.x,
                        n = e.y - this.y;
                    return Math.sqrt(t * t + n * n)
                },
                equals: function(e) {
                    return e = i.point(e), e.x === this.x && e.y === this.y
                },
                contains: function(e) {
                    return e = i.point(e), Math.abs(e.x) <= Math.abs(this.x) && Math.abs(e.y) <= Math.abs(this.y)
                },
                toString: function() {
                    return "Point(" + i.Util.formatNum(this.x) + ", " + i.Util.formatNum(this.y) + ")"
                }
            }, i.point = function(e, t, r) {
                return e instanceof i.Point ? e : i.Util.isArray(e) ? new i.Point(e[0], e[1]) : e === n || e === null ? e : new i.Point(e, t, r)
            }, i.Bounds = function(e, t) {
                if (!e) return;
                var n = t ? [e, t] : e;
                for (var r = 0, i = n.length; r < i; r++) this.extend(n[r])
            }, i.Bounds.prototype = {
                extend: function(e) {
                    return e = i.point(e), !this.min && !this.max ? (this.min = e.clone(), this.max = e.clone()) : (this.min.x = Math.min(e.x, this.min.x), this.max.x = Math.max(e.x, this.max.x), this.min.y = Math.min(e.y, this.min.y), this.max.y = Math.max(e.y, this.max.y)), this
                },
                getCenter: function(e) {
                    return new i.Point((this.min.x + this.max.x) / 2, (this.min.y + this.max.y) / 2, e)
                },
                getBottomLeft: function() {
                    return new i.Point(this.min.x, this.max.y)
                },
                getTopRight: function() {
                    return new i.Point(this.max.x, this.min.y)
                },
                getSize: function() {
                    return this.max.subtract(this.min)
                },
                contains: function(e) {
                    var t, n;
                    return typeof e[0] == "number" || e instanceof i.Point ? e = i.point(e) : e = i.bounds(e), e instanceof i.Bounds ? (t = e.min, n = e.max) : t = n = e, t.x >= this.min.x && n.x <= this.max.x && t.y >= this.min.y && n.y <= this.max.y
                },
                intersects: function(e) {
                    e = i.bounds(e);
                    var t = this.min,
                        n = this.max,
                        r = e.min,
                        s = e.max,
                        o = s.x >= t.x && r.x <= n.x,
                        u = s.y >= t.y && r.y <= n.y;
                    return o && u
                },
                isValid: function() {
                    return !!this.min && !!this.max
                }
            }, i.bounds = function(e, t) {
                return !e || e instanceof i.Bounds ? e : new i.Bounds(e, t)
            }, i.Transformation = function(e, t, n, r) {
                this._a = e, this._b = t, this._c = n, this._d = r
            }, i.Transformation.prototype = {
                transform: function(e, t) {
                    return this._transform(e.clone(), t)
                },
                _transform: function(e, t) {
                    return t = t || 1, e.x = t * (this._a * e.x + this._b), e.y = t * (this._c * e.y + this._d), e
                },
                untransform: function(e, t) {
                    return t = t || 1, new i.Point((e.x / t - this._b) / this._a, (e.y / t - this._d) / this._c)
                }
            }, i.DomUtil = {
                get: function(e) {
                    return typeof e == "string" ? t.getElementById(e) : e
                },
                getStyle: function(e, n) {
                    var r = e.style[n];
                    !r && e.currentStyle && (r = e.currentStyle[n]);
                    if ((!r || r === "auto") && t.defaultView) {
                        var i = t.defaultView.getComputedStyle(e, null);
                        r = i ? i[n] : null
                    }
                    return r === "auto" ? null : r
                },
                getViewportOffset: function(e) {
                    var n = 0,
                        r = 0,
                        s = e,
                        o = t.body,
                        u = t.documentElement,
                        a;
                    do {
                        n += s.offsetTop || 0, r += s.offsetLeft || 0, n += parseInt(i.DomUtil.getStyle(s, "borderTopWidth"), 10) || 0, r += parseInt(i.DomUtil.getStyle(s, "borderLeftWidth"), 10) || 0, a = i.DomUtil.getStyle(s, "position");
                        if (s.offsetParent === o && a === "absolute") break;
                        if (a === "fixed") {
                            n += o.scrollTop || u.scrollTop || 0, r += o.scrollLeft || u.scrollLeft || 0;
                            break
                        }
                        if (a === "relative" && !s.offsetLeft) {
                            var f = i.DomUtil.getStyle(s, "width"),
                                l = i.DomUtil.getStyle(s, "max-width"),
                                c = s.getBoundingClientRect();
                            if (f !== "none" || l !== "none") r += c.left + s.clientLeft;
                            n += c.top + (o.scrollTop || u.scrollTop || 0);
                            break
                        }
                        s = s.offsetParent
                    } while (s);
                    s = e;
                    do {
                        if (s === o) break;
                        n -= s.scrollTop || 0, r -= s.scrollLeft || 0, s = s.parentNode
                    } while (s);
                    return new i.Point(r, n)
                },
                documentIsLtr: function() {
                    return i.DomUtil._docIsLtrCached || (i.DomUtil._docIsLtrCached = !0, i.DomUtil._docIsLtr = i.DomUtil.getStyle(t.body, "direction") === "ltr"), i.DomUtil._docIsLtr
                },
                create: function(e, n, r) {
                    var i = t.createElement(e);
                    return i.className = n, r && r.appendChild(i), i
                },
                hasClass: function(e, t) {
                    if (e.classList !== n) return e.classList.contains(t);
                    var r = i.DomUtil._getClass(e);
                    return r.length > 0 && (new RegExp("(^|\\s)" + t + "(\\s|$)")).test(r)
                },
                addClass: function(e, t) {
                    if (e.classList !== n) {
                        var r = i.Util.splitWords(t);
                        for (var s = 0, o = r.length; s < o; s++) e.classList.add(r[s])
                    } else if (!i.DomUtil.hasClass(e, t)) {
                        var u = i.DomUtil._getClass(e);
                        i.DomUtil._setClass(e, (u ? u + " " : "") + t)
                    }
                },
                removeClass: function(e, t) {
                    e.classList !== n ? e.classList.remove(t) : i.DomUtil._setClass(e, i.Util.trim((" " + i.DomUtil._getClass(e) + " ").replace(" " + t + " ", " ")))
                },
                _setClass: function(e, t) {
                    e.className.baseVal === n ? e.className = t : e.className.baseVal = t
                },
                _getClass: function(e) {
                    return e.className.baseVal === n ? e.className : e.className.baseVal
                },
                setOpacity: function(e, t) {
                    if ("opacity" in e.style) e.style.opacity = t;
                    else if ("filter" in e.style) {
                        var n = !1,
                            r = "DXImageTransform.Microsoft.Alpha";
                        try {
                            n = e.filters.item(r)
                        } catch (i) {
                            if (t === 1) return
                        }
                        t = Math.round(t * 100), n ? (n.Enabled = t !== 100, n.Opacity = t) : e.style.filter += " progid:" + r + "(opacity=" + t + ")"
                    }
                },
                testProp: function(e) {
                    var n = t.documentElement.style;
                    for (var r = 0; r < e.length; r++)
                        if (e[r] in n) return e[r];
                    return !1
                },
                getTranslateString: function(e) {
                    var t = i.Browser.webkit3d,
                        n = "translate" + (t ? "3d" : "") + "(",
                        r = (t ? ",0" : "") + ")";
                    return n + e.x + "px," + e.y + "px" + r
                },
                getScaleString: function(e, t) {
                    var n = i.DomUtil.getTranslateString(t.add(t.multiplyBy(-1 * e))),
                        r = " scale(" + e + ") ";
                    return n + r
                },
                setPosition: function(e, t, n) {
                    e._leaflet_pos = t, !n && i.Browser.any3d ? e.style[i.DomUtil.TRANSFORM] = i.DomUtil.getTranslateString(t) : (e.style.left = t.x + "px", e.style.top = t.y + "px")
                },
                getPosition: function(e) {
                    return e._leaflet_pos
                }
            }, i.DomUtil.TRANSFORM = i.DomUtil.testProp(["transform", "WebkitTransform", "OTransform", "MozTransform", "msTransform"]), i.DomUtil.TRANSITION = i.DomUtil.testProp(["webkitTransition", "transition", "OTransition", "MozTransition", "msTransition"]), i.DomUtil.TRANSITION_END = i.DomUtil.TRANSITION === "webkitTransition" || i.DomUtil.TRANSITION === "OTransition" ? i.DomUtil.TRANSITION + "End" : "transitionend",
            function() {
                if ("onselectstart" in t) i.extend(i.DomUtil, {
                    disableTextSelection: function() {
                        i.DomEvent.on(e, "selectstart", i.DomEvent.preventDefault)
                    },
                    enableTextSelection: function() {
                        i.DomEvent.off(e, "selectstart", i.DomEvent.preventDefault)
                    }
                });
                else {
                    var n = i.DomUtil.testProp(["userSelect", "WebkitUserSelect", "OUserSelect", "MozUserSelect", "msUserSelect"]);
                    i.extend(i.DomUtil, {
                        disableTextSelection: function() {
                            if (n) {
                                var e = t.documentElement.style;
                                this._userSelect = e[n], e[n] = "none"
                            }
                        },
                        enableTextSelection: function() {
                            n && (t.documentElement.style[n] = this._userSelect, delete this._userSelect)
                        }
                    })
                }
                i.extend(i.DomUtil, {
                    disableImageDrag: function() {
                        i.DomEvent.on(e, "dragstart", i.DomEvent.preventDefault)
                    },
                    enableImageDrag: function() {
                        i.DomEvent.off(e, "dragstart", i.DomEvent.preventDefault)
                    }
                })
            }(), i.LatLng = function(e, t, r) {
                e = parseFloat(e), t = parseFloat(t);
                if (isNaN(e) || isNaN(t)) throw new Error("Invalid LatLng object: (" + e + ", " + t + ")");
                this.lat = e, this.lng = t, r !== n && (this.alt = parseFloat(r))
            }, i.extend(i.LatLng, {
                DEG_TO_RAD: Math.PI / 180,
                RAD_TO_DEG: 180 / Math.PI,
                MAX_MARGIN: 1e-9
            }), i.LatLng.prototype = {
                equals: function(e) {
                    if (!e) return !1;
                    e = i.latLng(e);
                    var t = Math.max(Math.abs(this.lat - e.lat), Math.abs(this.lng - e.lng));
                    return t <= i.LatLng.MAX_MARGIN
                },
                toString: function(e) {
                    return "LatLng(" + i.Util.formatNum(this.lat, e) + ", " + i.Util.formatNum(this.lng, e) + ")"
                },
                distanceTo: function(e) {
                    e = i.latLng(e);
                    var t = 6378137,
                        n = i.LatLng.DEG_TO_RAD,
                        r = (e.lat - this.lat) * n,
                        s = (e.lng - this.lng) * n,
                        o = this.lat * n,
                        u = e.lat * n,
                        a = Math.sin(r / 2),
                        f = Math.sin(s / 2),
                        l = a * a + f * f * Math.cos(o) * Math.cos(u);
                    return t * 2 * Math.atan2(Math.sqrt(l), Math.sqrt(1 - l))
                },
                wrap: function(e, t) {
                    var n = this.lng;
                    return e = e || -180, t = t || 180, n = (n + t) % (t - e) + (n < e || n === t ? t : e), new i.LatLng(this.lat, n)
                }
            }, i.latLng = function(e, t) {
                return e instanceof i.LatLng ? e : i.Util.isArray(e) ? typeof e[0] == "number" || typeof e[0] == "string" ? new i.LatLng(e[0], e[1], e[2]) : null : e === n || e === null ? e : typeof e == "object" && "lat" in e ? new i.LatLng(e.lat, "lng" in e ? e.lng : e.lon) : t === n ? null : new i.LatLng(e, t)
            }, i.LatLngBounds = function(e, t) {
                if (!e) return;
                var n = t ? [e, t] : e;
                for (var r = 0, i = n.length; r < i; r++) this.extend(n[r])
            }, i.LatLngBounds.prototype = {
                extend: function(e) {
                    if (!e) return this;
                    var t = i.latLng(e);
                    return t !== null ? e = t : e = i.latLngBounds(e), e instanceof i.LatLng ? !this._southWest && !this._northEast ? (this._southWest = new i.LatLng(e.lat, e.lng), this._northEast = new i.LatLng(e.lat, e.lng)) : (this._southWest.lat = Math.min(e.lat, this._southWest.lat), this._southWest.lng = Math.min(e.lng, this._southWest.lng), this._northEast.lat = Math.max(e.lat, this._northEast.lat), this._northEast.lng = Math.max(e.lng, this._northEast.lng)) : e instanceof i.LatLngBounds && (this.extend(e._southWest), this.extend(e._northEast)), this
                },
                pad: function(e) {
                    var t = this._southWest,
                        n = this._northEast,
                        r = Math.abs(t.lat - n.lat) * e,
                        s = Math.abs(t.lng - n.lng) * e;
                    return new i.LatLngBounds(new i.LatLng(t.lat - r, t.lng - s), new i.LatLng(n.lat + r, n.lng + s))
                },
                getCenter: function() {
                    return new i.LatLng((this._southWest.lat + this._northEast.lat) / 2, (this._southWest.lng + this._northEast.lng) / 2)
                },
                getSouthWest: function() {
                    return this._southWest
                },
                getNorthEast: function() {
                    return this._northEast
                },
                getNorthWest: function() {
                    return new i.LatLng(this.getNorth(), this.getWest())
                },
                getSouthEast: function() {
                    return new i.LatLng(this.getSouth(), this.getEast())
                },
                getWest: function() {
                    return this._southWest.lng
                },
                getSouth: function() {
                    return this._southWest.lat
                },
                getEast: function() {
                    return this._northEast.lng
                },
                getNorth: function() {
                    return this._northEast.lat
                },
                contains: function(e) {
                    typeof e[0] == "number" || e instanceof i.LatLng ? e = i.latLng(e) : e = i.latLngBounds(e);
                    var t = this._southWest,
                        n = this._northEast,
                        r, s;
                    return e instanceof i.LatLngBounds ? (r = e.getSouthWest(), s = e.getNorthEast()) : r = s = e, r.lat >= t.lat && s.lat <= n.lat && r.lng >= t.lng && s.lng <= n.lng
                },
                intersects: function(e) {
                    e = i.latLngBounds(e);
                    var t = this._southWest,
                        n = this._northEast,
                        r = e.getSouthWest(),
                        s = e.getNorthEast(),
                        o = s.lat >= t.lat && r.lat <= n.lat,
                        u = s.lng >= t.lng && r.lng <= n.lng;
                    return o && u
                },
                toBBoxString: function() {
                    return [this.getWest(), this.getSouth(), this.getEast(), this.getNorth()].join(",")
                },
                equals: function(e) {
                    return e ? (e = i.latLngBounds(e), this._southWest.equals(e.getSouthWest()) && this._northEast.equals(e.getNorthEast())) : !1
                },
                isValid: function() {
                    return !!this._southWest && !!this._northEast
                }
            }, i.latLngBounds = function(e, t) {
                return !e || e instanceof i.LatLngBounds ? e : new i.LatLngBounds(e, t)
            }, i.Projection = {}, i.Projection.SphericalMercator = {
                MAX_LATITUDE: 85.0511287798,
                project: function(e) {
                    var t = i.LatLng.DEG_TO_RAD,
                        n = this.MAX_LATITUDE,
                        r = Math.max(Math.min(n, e.lat), -n),
                        s = e.lng * t,
                        o = r * t;
                    return o = Math.log(Math.tan(Math.PI / 4 + o / 2)), new i.Point(s, o)
                },
                unproject: function(e) {
                    var t = i.LatLng.RAD_TO_DEG,
                        n = e.x * t,
                        r = (2 * Math.atan(Math.exp(e.y)) - Math.PI / 2) * t;
                    return new i.LatLng(r, n)
                }
            }, i.Projection.LonLat = {
                project: function(e) {
                    return new i.Point(e.lng, e.lat)
                },
                unproject: function(e) {
                    return new i.LatLng(e.y, e.x)
                }
            }, i.CRS = {
                latLngToPoint: function(e, t) {
                    var n = this.projection.project(e),
                        r = this.scale(t);
                    return this.transformation._transform(n, r)
                },
                pointToLatLng: function(e, t) {
                    var n = this.scale(t),
                        r = this.transformation.untransform(e, n);
                    return this.projection.unproject(r)
                },
                project: function(e) {
                    return this.projection.project(e)
                },
                scale: function(e) {
                    return 256 * Math.pow(2, e)
                },
                getSize: function(e) {
                    var t = this.scale(e);
                    return i.point(t, t)
                }
            }, i.CRS.Simple = i.extend({}, i.CRS, {
                projection: i.Projection.LonLat,
                transformation: new i.Transformation(1, 0, -1, 0),
                scale: function(e) {
                    return Math.pow(2, e)
                }
            }), i.CRS.EPSG3857 = i.extend({}, i.CRS, {
                code: "EPSG:3857",
                projection: i.Projection.SphericalMercator,
                transformation: new i.Transformation(.5 / Math.PI, .5, -0.5 / Math.PI, .5),
                project: function(e) {
                    var t = this.projection.project(e),
                        n = 6378137;
                    return t.multiplyBy(n)
                }
            }), i.CRS.EPSG900913 = i.extend({}, i.CRS.EPSG3857, {
                code: "EPSG:900913"
            }), i.CRS.EPSG4326 = i.extend({}, i.CRS, {
                code: "EPSG:4326",
                projection: i.Projection.LonLat,
                transformation: new i.Transformation(1 / 360, .5, -1 / 360, .5)
            }), i.Map = i.Class.extend({
                includes: i.Mixin.Events,
                options: {
                    crs: i.CRS.EPSG3857,
                    fadeAnimation: i.DomUtil.TRANSITION && !i.Browser.android23,
                    trackResize: !0,
                    markerZoomAnimation: i.DomUtil.TRANSITION && i.Browser.any3d
                },
                initialize: function(e, t) {
                    t = i.setOptions(this, t), this._initContainer(e), this._initLayout(), this._onResize = i.bind(this._onResize, this), this._initEvents(), t.maxBounds && this.setMaxBounds(t.maxBounds), t.center && t.zoom !== n && this.setView(i.latLng(t.center), t.zoom, {
                        reset: !0
                    }), this._handlers = [], this._layers = {}, this._zoomBoundLayers = {}, this._tileLayersNum = 0, this.callInitHooks(), this._addLayers(t.layers)
                },
                setView: function(e, t) {
                    return t = t === n ? this.getZoom() : t, this._resetView(i.latLng(e), this._limitZoom(t)), this
                },
                setZoom: function(e, t) {
                    return this._loaded ? this.setView(this.getCenter(), e, {
                        zoom: t
                    }) : (this._zoom = this._limitZoom(e), this)
                },
                zoomIn: function(e, t) {
                    return this.setZoom(this._zoom + (e || 1), t)
                },
                zoomOut: function(e, t) {
                    return this.setZoom(this._zoom - (e || 1), t)
                },
                setZoomAround: function(e, t, n) {
                    var r = this.getZoomScale(t),
                        s = this.getSize().divideBy(2),
                        o = e instanceof i.Point ? e : this.latLngToContainerPoint(e),
                        u = o.subtract(s).multiplyBy(1 - 1 / r),
                        a = this.containerPointToLatLng(s.add(u));
                    return this.setView(a, t, {
                        zoom: n
                    })
                },
                fitBounds: function(e, t) {
                    t = t || {}, e = e.getBounds ? e.getBounds() : i.latLngBounds(e);
                    var n = i.point(t.paddingTopLeft || t.padding || [0, 0]),
                        r = i.point(t.paddingBottomRight || t.padding || [0, 0]),
                        s = this.getBoundsZoom(e, !1, n.add(r));
                    s = t.maxZoom ? Math.min(t.maxZoom, s) : s;
                    var o = r.subtract(n).divideBy(2),
                        u = this.project(e.getSouthWest(), s),
                        a = this.project(e.getNorthEast(), s),
                        f = this.unproject(u.add(a).divideBy(2).add(o), s);
                    return this.setView(f, s, t)
                },
                fitWorld: function(e) {
                    return this.fitBounds([
                        [-90, -180],
                        [90, 180]
                    ], e)
                },
                panTo: function(e, t) {
                    return this.setView(e, this._zoom, {
                        pan: t
                    })
                },
                panBy: function(e) {
                    return this.fire("movestart"), this._rawPanBy(i.point(e)), this.fire("move"), this.fire("moveend")
                },
                setMaxBounds: function(e) {
                    return e = i.latLngBounds(e), this.options.maxBounds = e, e ? (this._loaded && this._panInsideMaxBounds(), this.on("moveend", this._panInsideMaxBounds, this)) : this.off("moveend", this._panInsideMaxBounds, this)
                },
                panInsideBounds: function(e, t) {
                    var n = this.getCenter(),
                        r = this._limitCenter(n, this._zoom, e);
                    return n.equals(r) ? this : this.panTo(r, t)
                },
                addLayer: function(e) {
                    var t = i.stamp(e);
                    return this._layers[t] ? this : (this._layers[t] = e, e.options && (!isNaN(e.options.maxZoom) || !isNaN(e.options.minZoom)) && (this._zoomBoundLayers[t] = e, this._updateZoomLevels()), this.options.zoomAnimation && i.TileLayer && e instanceof i.TileLayer && (this._tileLayersNum++, this._tileLayersToLoad++, e.on("load", this._onTileLayerLoad, this)), this._loaded && this._layerAdd(e), this)
                },
                removeLayer: function(e) {
                    var t = i.stamp(e);
                    return this._layers[t] ? (this._loaded && e.onRemove(this), delete this._layers[t], this._loaded && this.fire("layerremove", {
                        layer: e
                    }), this._zoomBoundLayers[t] && (delete this._zoomBoundLayers[t], this._updateZoomLevels()), this.options.zoomAnimation && i.TileLayer && e instanceof i.TileLayer && (this._tileLayersNum--, this._tileLayersToLoad--, e.off("load", this._onTileLayerLoad, this)), this) : this
                },
                hasLayer: function(e) {
                    return e ? i.stamp(e) in this._layers : !1
                },
                eachLayer: function(e, t) {
                    for (var n in this._layers) e.call(t, this._layers[n]);
                    return this
                },
                invalidateSize: function(e) {
                    if (!this._loaded) return this;
                    e = i.extend({
                        animate: !1,
                        pan: !0
                    }, e === !0 ? {
                        animate: !0
                    } : e);
                    var t = this.getSize();
                    this._sizeChanged = !0, this._initialCenter = null;
                    var n = this.getSize(),
                        r = t.divideBy(2).round(),
                        s = n.divideBy(2).round(),
                        o = r.subtract(s);
                    return !o.x && !o.y ? this : (e.animate && e.pan ? this.panBy(o) : (e.pan && this._rawPanBy(o), this.fire("move"), e.debounceMoveend ? (clearTimeout(this._sizeTimer), this._sizeTimer = setTimeout(i.bind(this.fire, this, "moveend"), 200)) : this.fire("moveend")), this.fire("resize", {
                        oldSize: t,
                        newSize: n
                    }))
                },
                addHandler: function(e, t) {
                    if (!t) return this;
                    var n = this[e] = new t(this);
                    return this._handlers.push(n), this.options[e] && n.enable(), this
                },
                remove: function() {
                    this._loaded && this.fire("unload"), this._initEvents("off");
                    try {
                        delete this._container._leaflet
                    } catch (e) {
                        this._container._leaflet = n
                    }
                    return this._clearPanes(), this._clearControlPos && this._clearControlPos(), this._clearHandlers(), this
                },
                getCenter: function() {
                    return this._checkIfLoaded(), this._initialCenter && !this._moved() ? this._initialCenter : this.layerPointToLatLng(this._getCenterLayerPoint())
                },
                getZoom: function() {
                    return this._zoom
                },
                getBounds: function() {
                    var e = this.getPixelBounds(),
                        t = this.unproject(e.getBottomLeft()),
                        n = this.unproject(e.getTopRight());
                    return new i.LatLngBounds(t, n)
                },
                getMinZoom: function() {
                    return this.options.minZoom === n ? this._layersMinZoom === n ? 0 : this._layersMinZoom : this.options.minZoom
                },
                getMaxZoom: function() {
                    return this.options.maxZoom === n ? this._layersMaxZoom === n ? Infinity : this._layersMaxZoom : this.options.maxZoom
                },
                getBoundsZoom: function(e, t, n) {
                    e = i.latLngBounds(e);
                    var r = this.getMinZoom() - (t ? 1 : 0),
                        s = this.getMaxZoom(),
                        o = this.getSize(),
                        u = e.getNorthWest(),
                        a = e.getSouthEast(),
                        f = !0,
                        l;
                    n = i.point(n || [0, 0]);
                    do r++, l = this.project(a, r).subtract(this.project(u, r)).add(n), f = t ? l.x < o.x || l.y < o.y : o.contains(l); while (f && r <= s);
                    return f && t ? null : t ? r : r - 1
                },
                getSize: function() {
                    if (!this._size || this._sizeChanged) this._size = new i.Point(this._container.clientWidth, this._container.clientHeight), this._sizeChanged = !1;
                    return this._size.clone()
                },
                getPixelBounds: function() {
                    var e = this._getTopLeftPoint();
                    return new i.Bounds(e, e.add(this.getSize()))
                },
                getPixelOrigin: function() {
                    return this._checkIfLoaded(), this._initialTopLeftPoint
                },
                getPanes: function() {
                    return this._panes
                },
                getContainer: function() {
                    return this._container
                },
                getZoomScale: function(e) {
                    var t = this.options.crs;
                    return t.scale(e) / t.scale(this._zoom)
                },
                getScaleZoom: function(e) {
                    return this._zoom + Math.log(e) / Math.LN2
                },
                project: function(e, t) {
                    return t = t === n ? this._zoom : t, this.options.crs.latLngToPoint(i.latLng(e), t)
                },
                unproject: function(e, t) {
                    return t = t === n ? this._zoom : t, this.options.crs.pointToLatLng(i.point(e), t)
                },
                layerPointToLatLng: function(e) {
                    var t = i.point(e).add(this.getPixelOrigin());
                    return this.unproject(t)
                },
                latLngToLayerPoint: function(e) {
                    var t = this.project(i.latLng(e))._round();
                    return t._subtract(this.getPixelOrigin())
                },
                containerPointToLayerPoint: function(e) {
                    return i.point(e).subtract(this._getMapPanePos())
                },
                layerPointToContainerPoint: function(e) {
                    return i.point(e).add(this._getMapPanePos())
                },
                containerPointToLatLng: function(e) {
                    var t = this.containerPointToLayerPoint(i.point(e));
                    return this.layerPointToLatLng(t)
                },
                latLngToContainerPoint: function(e) {
                    return this.layerPointToContainerPoint(this.latLngToLayerPoint(i.latLng(e)))
                },
                mouseEventToContainerPoint: function(e) {
                    return i.DomEvent.getMousePosition(e, this._container)
                },
                mouseEventToLayerPoint: function(e) {
                    return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))
                },
                mouseEventToLatLng: function(e) {
                    return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))
                },
                _initContainer: function(e) {
                    var t = this._container = i.DomUtil.get(e);
                    if (!t) throw new Error("Map container not found.");
                    if (t._leaflet) throw new Error("Map container is already initialized.");
                    t._leaflet = !0
                },
                _initLayout: function() {
                    var e = this._container;
                    i.DomUtil.addClass(e, "leaflet-container" + (i.Browser.touch ? " leaflet-touch" : "") + (i.Browser.retina ? " leaflet-retina" : "") + (i.Browser.ielt9 ? " leaflet-oldie" : "") + (this.options.fadeAnimation ? " leaflet-fade-anim" : ""));
                    var t = i.DomUtil.getStyle(e, "position");
                    t !== "absolute" && t !== "relative" && t !== "fixed" && (e.style.position = "relative"), this._initPanes(), this._initControlPos && this._initControlPos()
                },
                _initPanes: function() {
                    var e = this._panes = {};
                    this._mapPane = e.mapPane = this._createPane("leaflet-map-pane", this._container), this._tilePane = e.tilePane = this._createPane("leaflet-tile-pane", this._mapPane), e.objectsPane = this._createPane("leaflet-objects-pane", this._mapPane), e.shadowPane = this._createPane("leaflet-shadow-pane"), e.overlayPane = this._createPane("leaflet-overlay-pane"), e.markerPane = this._createPane("leaflet-marker-pane"), e.popupPane = this._createPane("leaflet-popup-pane");
                    var t = " leaflet-zoom-hide";
                    this.options.markerZoomAnimation || (i.DomUtil.addClass(e.markerPane, t), i.DomUtil.addClass(e.shadowPane, t), i.DomUtil.addClass(e.popupPane, t))
                },
                _createPane: function(e, t) {
                    return i.DomUtil.create("div", e, t || this._panes.objectsPane)
                },
                _clearPanes: function() {
                    this._container.removeChild(this._mapPane)
                },
                _addLayers: function(e) {
                    e = e ? i.Util.isArray(e) ? e : [e] : [];
                    for (var t = 0, n = e.length; t < n; t++) this.addLayer(e[t])
                },
                _resetView: function(e, t, n, r) {
                    var s = this._zoom !== t;
                    r || (this.fire("movestart"), s && this.fire("zoomstart")), this._zoom = t, this._initialCenter = e, this._initialTopLeftPoint = this._getNewTopLeftPoint(e), n ? this._initialTopLeftPoint._add(this._getMapPanePos()) : i.DomUtil.setPosition(this._mapPane, new i.Point(0, 0)), this._tileLayersToLoad = this._tileLayersNum;
                    var o = !this._loaded;
                    this._loaded = !0, this.fire("viewreset", {
                        hard: !n
                    }), o && (this.fire("load"), this.eachLayer(this._layerAdd, this)), this.fire("move"), (s || r) && this.fire("zoomend"), this.fire("moveend", {
                        hard: !n
                    })
                },
                _rawPanBy: function(e) {
                    i.DomUtil.setPosition(this._mapPane, this._getMapPanePos().subtract(e))
                },
                _getZoomSpan: function() {
                    return this.getMaxZoom() - this.getMinZoom()
                },
                _updateZoomLevels: function() {
                    var e, t = Infinity,
                        r = -Infinity,
                        i = this._getZoomSpan();
                    for (e in this._zoomBoundLayers) {
                        var s = this._zoomBoundLayers[e];
                        isNaN(s.options.minZoom) || (t = Math.min(t, s.options.minZoom)), isNaN(s.options.maxZoom) || (r = Math.max(r, s.options.maxZoom))
                    }
                    e === n ? this._layersMaxZoom = this._layersMinZoom = n : (this._layersMaxZoom = r, this._layersMinZoom = t), i !== this._getZoomSpan() && this.fire("zoomlevelschange")
                },
                _panInsideMaxBounds: function() {
                    this.panInsideBounds(this.options.maxBounds)
                },
                _checkIfLoaded: function() {
                    if (!this._loaded) throw new Error("Set map center and zoom first.")
                },
                _initEvents: function(t) {
                    if (!i.DomEvent) return;
                    t = t || "on", i.DomEvent[t](this._container, "click", this._onMouseClick, this);
                    var n = ["dblclick", "mousedown", "mouseup", "mouseenter", "mouseleave", "mousemove", "contextmenu"],
                        r, s;
                    for (r = 0, s = n.length; r < s; r++) i.DomEvent[t](this._container, n[r], this._fireMouseEvent, this);
                    this.options.trackResize && i.DomEvent[t](e, "resize", this._onResize, this)
                },
                _onResize: function() {
                    i.Util.cancelAnimFrame(this._resizeRequest), this._resizeRequest = i.Util.requestAnimFrame(function() {
                        this.invalidateSize({
                            debounceMoveend: !0
                        })
                    }, this, !1, this._container)
                },
                _onMouseClick: function(e) {
                    if (!this._loaded || !e._simulated && (this.dragging && this.dragging.moved() || this.boxZoom && this.boxZoom.moved()) || i.DomEvent._skipped(e)) return;
                    this.fire("preclick"), this._fireMouseEvent(e)
                },
                _fireMouseEvent: function(e) {
                    if (!this._loaded || i.DomEvent._skipped(e)) return;
                    var t = e.type;
                    t = t === "mouseenter" ? "mouseover" : t === "mouseleave" ? "mouseout" : t;
                    if (!this.hasEventListeners(t)) return;
                    t === "contextmenu" && i.DomEvent.preventDefault(e);
                    var n = this.mouseEventToContainerPoint(e),
                        r = this.containerPointToLayerPoint(n),
                        s = this.layerPointToLatLng(r);
                    this.fire(t, {
                        latlng: s,
                        layerPoint: r,
                        containerPoint: n,
                        originalEvent: e
                    })
                },
                _onTileLayerLoad: function() {
                    this._tileLayersToLoad--, this._tileLayersNum && !this._tileLayersToLoad && this.fire("tilelayersload")
                },
                _clearHandlers: function() {
                    for (var e = 0, t = this._handlers.length; e < t; e++) this._handlers[e].disable()
                },
                whenReady: function(e, t) {
                    return this._loaded ? e.call(t || this, this) : this.on("load", e, t), this
                },
                _layerAdd: function(e) {
                    e.onAdd(this), this.fire("layeradd", {
                        layer: e
                    })
                },
                _getMapPanePos: function() {
                    return i.DomUtil.getPosition(this._mapPane)
                },
                _moved: function() {
                    var e = this._getMapPanePos();
                    return e && !e.equals([0, 0])
                },
                _getTopLeftPoint: function() {
                    return this.getPixelOrigin().subtract(this._getMapPanePos())
                },
                _getNewTopLeftPoint: function(e, t) {
                    var n = this.getSize()._divideBy(2);
                    return this.project(e, t)._subtract(n)._round()
                },
                _latLngToNewLayerPoint: function(e, t, n) {
                    var r = this._getNewTopLeftPoint(n, t).add(this._getMapPanePos());
                    return this.project(e, t)._subtract(r)
                },
                _getCenterLayerPoint: function() {
                    return this.containerPointToLayerPoint(this.getSize()._divideBy(2))
                },
                _getCenterOffset: function(e) {
                    return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())
                },
                _limitCenter: function(e, t, n) {
                    if (!n) return e;
                    var r = this.project(e, t),
                        s = this.getSize().divideBy(2),
                        o = new i.Bounds(r.subtract(s), r.add(s)),
                        u = this._getBoundsOffset(o, n, t);
                    return this.unproject(r.add(u), t)
                },
                _limitOffset: function(e, t) {
                    if (!t) return e;
                    var n = this.getPixelBounds(),
                        r = new i.Bounds(n.min.add(e), n.max.add(e));
                    return e.add(this._getBoundsOffset(r, t))
                },
                _getBoundsOffset: function(e, t, n) {
                    var r = this.project(t.getNorthWest(), n).subtract(e.min),
                        s = this.project(t.getSouthEast(), n).subtract(e.max),
                        o = this._rebound(r.x, -s.x),
                        u = this._rebound(r.y, -s.y);
                    return new i.Point(o, u)
                },
                _rebound: function(e, t) {
                    return e + t > 0 ? Math.round(e - t) / 2 : Math.max(0, Math.ceil(e)) - Math.max(0, Math.floor(t))
                },
                _limitZoom: function(e) {
                    var t = this.getMinZoom(),
                        n = this.getMaxZoom();
                    return Math.max(t, Math.min(n, e))
                }
            }), i.map = function(e, t) {
                return new i.Map(e, t)
            }, i.Projection.Mercator = {
                MAX_LATITUDE: 85.0840591556,
                R_MINOR: 6356752.314245179,
                R_MAJOR: 6378137,
                project: function(e) {
                    var t = i.LatLng.DEG_TO_RAD,
                        n = this.MAX_LATITUDE,
                        r = Math.max(Math.min(n, e.lat), -n),
                        s = this.R_MAJOR,
                        o = this.R_MINOR,
                        u = e.lng * t * s,
                        a = r * t,
                        f = o / s,
                        l = Math.sqrt(1 - f * f),
                        c = l * Math.sin(a);
                    c = Math.pow((1 - c) / (1 + c), l * .5);
                    var h = Math.tan(.5 * (Math.PI * .5 - a)) / c;
                    return a = -s * Math.log(h), new i.Point(u, a)
                },
                unproject: function(e) {
                    var t = i.LatLng.RAD_TO_DEG,
                        n = this.R_MAJOR,
                        r = this.R_MINOR,
                        s = e.x * t / n,
                        o = r / n,
                        u = Math.sqrt(1 - o * o),
                        a = Math.exp(-e.y / n),
                        f = Math.PI / 2 - 2 * Math.atan(a),
                        l = 15,
                        c = 1e-7,
                        h = l,
                        p = .1,
                        d;
                    while (Math.abs(p) > c && --h > 0) d = u * Math.sin(f), p = Math.PI / 2 - 2 * Math.atan(a * Math.pow((1 - d) / (1 + d), .5 * u)) - f, f += p;
                    return new i.LatLng(f * t, s)
                }
            }, i.CRS.EPSG3395 = i.extend({}, i.CRS, {
                code: "EPSG:3395",
                projection: i.Projection.Mercator,
                transformation: function() {
                    var e = i.Projection.Mercator,
                        t = e.R_MAJOR,
                        n = .5 / (Math.PI * t);
                    return new i.Transformation(n, .5, -n, .5)
                }()
            }), i.TileLayer = i.Class.extend({
                includes: i.Mixin.Events,
                options: {
                    minZoom: 0,
                    maxZoom: 18,
                    tileSize: 256,
                    subdomains: "abc",
                    errorTileUrl: "",
                    attribution: "",
                    zoomOffset: 0,
                    opacity: 1,
                    unloadInvisibleTiles: i.Browser.mobile,
                    updateWhenIdle: i.Browser.mobile
                },
                initialize: function(e, t) {
                    t = i.setOptions(this, t), t.detectRetina && i.Browser.retina && t.maxZoom > 0 && (t.tileSize = Math.floor(t.tileSize / 2), t.zoomOffset++, t.minZoom > 0 && t.minZoom--, this.options.maxZoom--), t.bounds && (t.bounds = i.latLngBounds(t.bounds)), this._url = e;
                    var n = this.options.subdomains;
                    typeof n == "string" && (this.options.subdomains = n.split(""))
                },
                onAdd: function(e) {
                    this._map = e, this._animated = e._zoomAnimated, this._initContainer(), e.on({
                        viewreset: this._reset,
                        moveend: this._update
                    }, this), this._animated && e.on({
                        zoomanim: this._animateZoom,
                        zoomend: this._endZoomAnim
                    }, this), this.options.updateWhenIdle || (this._limitedUpdate = i.Util.limitExecByInterval(this._update, 150, this), e.on("move", this._limitedUpdate, this)), this._reset(), this._update()
                },
                addTo: function(e) {
                    return e.addLayer(this), this
                },
                onRemove: function(e) {
                    this._container.parentNode.removeChild(this._container), e.off({
                        viewreset: this._reset,
                        moveend: this._update
                    }, this), this._animated && e.off({
                        zoomanim: this._animateZoom,
                        zoomend: this._endZoomAnim
                    }, this), this.options.updateWhenIdle || e.off("move", this._limitedUpdate, this), this._container = null, this._map = null
                },
                bringToFront: function() {
                    var e = this._map._panes.tilePane;
                    return this._container && (e.appendChild(this._container), this._setAutoZIndex(e, Math.max)), this
                },
                bringToBack: function() {
                    var e = this._map._panes.tilePane;
                    return this._container && (e.insertBefore(this._container, e.firstChild), this._setAutoZIndex(e, Math.min)), this
                },
                getAttribution: function() {
                    return this.options.attribution
                },
                getContainer: function() {
                    return this._container
                },
                setOpacity: function(e) {
                    return this.options.opacity = e, this._map && this._updateOpacity(), this
                },
                setZIndex: function(e) {
                    return this.options.zIndex = e, this._updateZIndex(), this
                },
                setUrl: function(e, t) {
                    return this._url = e, t || this.redraw(), this
                },
                redraw: function() {
                    return this._map && (this._reset({
                        hard: !0
                    }), this._update()), this
                },
                _updateZIndex: function() {
                    this._container && this.options.zIndex !== n && (this._container.style.zIndex = this.options.zIndex)
                },
                _setAutoZIndex: function(e, t) {
                    var n = e.children,
                        r = -t(Infinity, -Infinity),
                        i, s, o;
                    for (s = 0, o = n.length; s < o; s++) n[s] !== this._container && (i = parseInt(n[s].style.zIndex, 10), isNaN(i) || (r = t(r, i)));
                    this.options.zIndex = this._container.style.zIndex = (isFinite(r) ? r : 0) + t(1, -1)
                },
                _updateOpacity: function() {
                    var e, t = this._tiles;
                    if (i.Browser.ielt9)
                        for (e in t) i.DomUtil.setOpacity(t[e], this.options.opacity);
                    else i.DomUtil.setOpacity(this._container, this.options.opacity)
                },
                _initContainer: function() {
                    var e = this._map._panes.tilePane;
                    if (!this._container) {
                        this._container = i.DomUtil.create("div", "leaflet-layer"), this._updateZIndex();
                        if (this._animated) {
                            var t = "leaflet-tile-container";
                            this._bgBuffer = i.DomUtil.create("div", t, this._container), this._tileContainer = i.DomUtil.create("div", t, this._container)
                        } else this._tileContainer = this._container;
                        e.appendChild(this._container), this.options.opacity < 1 && this._updateOpacity()
                    }
                },
                _reset: function(e) {
                    for (var t in this._tiles) this.fire("tileunload", {
                        tile: this._tiles[t]
                    });
                    this._tiles = {}, this._tilesToLoad = 0, this.options.reuseTiles && (this._unusedTiles = []), this._tileContainer.innerHTML = "", this._animated && e && e.hard && this._clearBgBuffer(), this._initContainer()
                },
                _getTileSize: function() {
                    var e = this._map,
                        t = e.getZoom() + this.options.zoomOffset,
                        n = this.options.maxNativeZoom,
                        r = this.options.tileSize;
                    return n && t > n && (r = Math.round(e.getZoomScale(t) / e.getZoomScale(n) * r)), r
                },
                _update: function() {
                    if (!this._map) return;
                    var e = this._map,
                        t = e.getPixelBounds(),
                        n = e.getZoom(),
                        r = this._getTileSize();
                    if (n > this.options.maxZoom || n < this.options.minZoom) return;
                    var s = i.bounds(t.min.divideBy(r)._floor(), t.max.divideBy(r)._floor());
                    this._addTilesFromCenterOut(s), (this.options.unloadInvisibleTiles || this.options.reuseTiles) && this._removeOtherTiles(s)
                },
                _addTilesFromCenterOut: function(e) {
                    var n = [],
                        r = e.getCenter(),
                        s, o, u;
                    for (s = e.min.y; s <= e.max.y; s++)
                        for (o = e.min.x; o <= e.max.x; o++) u = new i.Point(o, s), this._tileShouldBeLoaded(u) && n.push(u);
                    var a = n.length;
                    if (a === 0) return;
                    n.sort(function(e, t) {
                        return e.distanceTo(r) - t.distanceTo(r)
                    });
                    var f = t.createDocumentFragment();
                    this._tilesToLoad || this.fire("loading"), this._tilesToLoad += a;
                    for (o = 0; o < a; o++) this._addTile(n[o], f);
                    this._tileContainer.appendChild(f)
                },
                _tileShouldBeLoaded: function(e) {
                    if (e.x + ":" + e.y in this._tiles) return !1;
                    var t = this.options;
                    if (!t.continuousWorld) {
                        var n = this._getWrapTileNum();
                        if (t.noWrap && (e.x < 0 || e.x >= n.x) || e.y < 0 || e.y >= n.y) return !1
                    }
                    if (t.bounds) {
                        var r = this._getTileSize(),
                            i = e.multiplyBy(r),
                            s = i.add([r, r]),
                            o = this._map.unproject(i),
                            u = this._map.unproject(s);
                        !t.continuousWorld && !t.noWrap && (o = o.wrap(), u = u.wrap());
                        if (!t.bounds.intersects([o, u])) return !1
                    }
                    return !0
                },
                _removeOtherTiles: function(e) {
                    var t, n, r, i;
                    for (i in this._tiles) t = i.split(":"), n = parseInt(t[0], 10), r = parseInt(t[1], 10), (n < e.min.x || n > e.max.x || r < e.min.y || r > e.max.y) && this._removeTile(i)
                },
                _removeTile: function(e) {
                    var t = this._tiles[e];
                    this.fire("tileunload", {
                        tile: t,
                        url: t.src
                    }), this.options.reuseTiles ? (i.DomUtil.removeClass(t, "leaflet-tile-loaded"), this._unusedTiles.push(t)) : t.parentNode === this._tileContainer && this._tileContainer.removeChild(t), i.Browser.android || (t.onload = null, t.src = i.Util.emptyImageUrl), delete this._tiles[e]
                },
                _addTile: function(e, t) {
                    var n = this._getTilePos(e),
                        r = this._getTile();
                    i.DomUtil.setPosition(r, n, i.Browser.chrome), this._tiles[e.x + ":" + e.y] = r, this._loadTile(r, e), r.parentNode !== this._tileContainer && t.appendChild(r)
                },
                _getZoomForUrl: function() {
                    var e = this.options,
                        t = this._map.getZoom();
                    return e.zoomReverse && (t = e.maxZoom - t), t += e.zoomOffset, e.maxNativeZoom ? Math.min(t, e.maxNativeZoom) : t
                },
                _getTilePos: function(e) {
                    var t = this._map.getPixelOrigin(),
                        n = this._getTileSize();
                    return e.multiplyBy(n).subtract(t)
                },
                getTileUrl: function(e) {
                    return i.Util.template(this._url, i.extend({
                        s: this._getSubdomain(e),
                        z: e.z,
                        x: e.x,
                        y: e.y
                    }, this.options))
                },
                _getWrapTileNum: function() {
                    var e = this._map.options.crs,
                        t = e.getSize(this._map.getZoom());
                    return t.divideBy(this._getTileSize())._floor()
                },
                _adjustTilePoint: function(e) {
                    var t = this._getWrapTileNum();
                    !this.options.continuousWorld && !this.options.noWrap && (e.x = (e.x % t.x + t.x) % t.x), this.options.tms && (e.y = t.y - e.y - 1), e.z = this._getZoomForUrl()
                },
                _getSubdomain: function(e) {
                    var t = Math.abs(e.x + e.y) % this.options.subdomains.length;
                    return this.options.subdomains[t]
                },
                _getTile: function() {
                    if (this.options.reuseTiles && this._unusedTiles.length > 0) {
                        var e = this._unusedTiles.pop();
                        return this._resetTile(e), e
                    }
                    return this._createTile()
                },
                _resetTile: function() {},
                _createTile: function() {
                    var e = i.DomUtil.create("img", "leaflet-tile");
                    return e.style.width = e.style.height = this._getTileSize() + "px", e.galleryimg = "no", e.onselectstart = e.onmousemove = i.Util.falseFn, i.Browser.ielt9 && this.options.opacity !== n && i.DomUtil.setOpacity(e, this.options.opacity), i.Browser.mobileWebkit3d && (e.style.WebkitBackfaceVisibility = "hidden"), e
                },
                _loadTile: function(e, t) {
                    e._layer = this, e.onload = this._tileOnLoad, e.onerror = this._tileOnError, this._adjustTilePoint(t), e.src = this.getTileUrl(t), this.fire("tileloadstart", {
                        tile: e,
                        url: e.src
                    })
                },
                _tileLoaded: function() {
                    this._tilesToLoad--, this._animated && i.DomUtil.addClass(this._tileContainer, "leaflet-zoom-animated"), this._tilesToLoad || (this.fire("load"), this._animated && (clearTimeout(this._clearBgBufferTimer), this._clearBgBufferTimer = setTimeout(i.bind(this._clearBgBuffer, this), 500)))
                },
                _tileOnLoad: function() {
                    var e = this._layer;
                    this.src !== i.Util.emptyImageUrl && (i.DomUtil.addClass(this, "leaflet-tile-loaded"), e.fire("tileload", {
                        tile: this,
                        url: this.src
                    })), e._tileLoaded()
                },
                _tileOnError: function() {
                    var e = this._layer;
                    e.fire("tileerror", {
                        tile: this,
                        url: this.src
                    });
                    var t = e.options.errorTileUrl;
                    t && (this.src = t), e._tileLoaded()
                }
            }), i.tileLayer = function(e, t) {
                return new i.TileLayer(e, t)
            }, i.TileLayer.WMS = i.TileLayer.extend({
                defaultWmsParams: {
                    service: "WMS",
                    request: "GetMap",
                    version: "1.1.1",
                    layers: "",
                    styles: "",
                    format: "image/jpeg",
                    transparent: !1
                },
                initialize: function(e, t) {
                    this._url = e;
                    var n = i.extend({}, this.defaultWmsParams),
                        r = t.tileSize || this.options.tileSize;
                    t.detectRetina && i.Browser.retina ? n.width = n.height = r * 2 : n.width = n.height = r;
                    for (var s in t) !this.options.hasOwnProperty(s) && s !== "crs" && (n[s] = t[s]);
                    this.wmsParams = n, i.setOptions(this, t)
                },
                onAdd: function(e) {
                    this._crs = this.options.crs || e.options.crs, this._wmsVersion = parseFloat(this.wmsParams.version);
                    var t = this._wmsVersion >= 1.3 ? "crs" : "srs";
                    this.wmsParams[t] = this._crs.code, i.TileLayer.prototype.onAdd.call(this, e)
                },
                getTileUrl: function(e) {
                    var t = this._map,
                        n = this.options.tileSize,
                        r = e.multiplyBy(n),
                        s = r.add([n, n]),
                        o = this._crs.project(t.unproject(r, e.z)),
                        u = this._crs.project(t.unproject(s, e.z)),
                        a = this._wmsVersion >= 1.3 && this._crs === i.CRS.EPSG4326 ? [u.y, o.x, o.y, u.x].join(",") : [o.x, u.y, u.x, o.y].join(","),
                        f = i.Util.template(this._url, {
                            s: this._getSubdomain(e)
                        });
                    return f + i.Util.getParamString(this.wmsParams, f, !0) + "&BBOX=" + a
                },
                setParams: function(e, t) {
                    return i.extend(this.wmsParams, e), t || this.redraw(), this
                }
            }), i.tileLayer.wms = function(e, t) {
                return new i.TileLayer.WMS(e, t)
            }, i.TileLayer.Canvas = i.TileLayer.extend({
                options: {
                    async: !1
                },
                initialize: function(e) {
                    i.setOptions(this, e)
                },
                redraw: function() {
                    this._map && (this._reset({
                        hard: !0
                    }), this._update());
                    for (var e in this._tiles) this._redrawTile(this._tiles[e]);
                    return this
                },
                _redrawTile: function(e) {
                    this.drawTile(e, e._tilePoint, this._map._zoom)
                },
                _createTile: function() {
                    var e = i.DomUtil.create("canvas", "leaflet-tile");
                    return e.width = e.height = this.options.tileSize, e.onselectstart = e.onmousemove = i.Util.falseFn, e
                },
                _loadTile: function(e, t) {
                    e._layer = this, e._tilePoint = t, this._redrawTile(e), this.options.async || this.tileDrawn(e)
                },
                drawTile: function() {},
                tileDrawn: function(e) {
                    this._tileOnLoad.call(e)
                }
            }), i.tileLayer.canvas = function(e) {
                return new i.TileLayer.Canvas(e)
            }, i.ImageOverlay = i.Class.extend({
                includes: i.Mixin.Events,
                options: {
                    opacity: 1
                },
                initialize: function(e, t, n) {
                    this._url = e, this._bounds = i.latLngBounds(t), i.setOptions(this, n)
                },
                onAdd: function(e) {
                    this._map = e, this._image || this._initImage(), e._panes.overlayPane.appendChild(this._image), e.on("viewreset", this._reset, this), e.options.zoomAnimation && i.Browser.any3d && e.on("zoomanim", this._animateZoom, this), this._reset()
                },
                onRemove: function(e) {
                    e.getPanes().overlayPane.removeChild(this._image), e.off("viewreset", this._reset, this), e.options.zoomAnimation && e.off("zoomanim", this._animateZoom, this)
                },
                addTo: function(e) {
                    return e.addLayer(this), this
                },
                setOpacity: function(e) {
                    return this.options.opacity = e, this._updateOpacity(), this
                },
                bringToFront: function() {
                    return this._image && this._map._panes.overlayPane.appendChild(this._image), this
                },
                bringToBack: function() {
                    var e = this._map._panes.overlayPane;
                    return this._image && e.insertBefore(this._image, e.firstChild), this
                },
                setUrl: function(e) {
                    this._url = e, this._image.src = this._url
                },
                getAttribution: function() {
                    return this.options.attribution
                },
                _initImage: function() {
                    this._image = i.DomUtil.create("img", "leaflet-image-layer"), this._map.options.zoomAnimation && i.Browser.any3d ? i.DomUtil.addClass(this._image, "leaflet-zoom-animated") : i.DomUtil.addClass(this._image, "leaflet-zoom-hide"), this._updateOpacity(), i.extend(this._image, {
                        galleryimg: "no",
                        onselectstart: i.Util.falseFn,
                        onmousemove: i.Util.falseFn,
                        onload: i.bind(this._onImageLoad, this),
                        src: this._url
                    })
                },
                _animateZoom: function(e) {
                    var t = this._map,
                        n = this._image,
                        r = t.getZoomScale(e.zoom),
                        s = this._bounds.getNorthWest(),
                        o = this._bounds.getSouthEast(),
                        u = t._latLngToNewLayerPoint(s, e.zoom, e.center),
                        a = t._latLngToNewLayerPoint(o, e.zoom, e.center)._subtract(u),
                        f = u._add(a._multiplyBy(.5 * (1 - 1 / r)));
                    n.style[i.DomUtil.TRANSFORM] = i.DomUtil.getTranslateString(f) + " scale(" + r + ") "
                },
                _reset: function() {
                    var e = this._image,
                        t = this._map.latLngToLayerPoint(this._bounds.getNorthWest()),
                        n = this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(t);
                    i.DomUtil.setPosition(e, t), e.style.width = n.x + "px", e.style.height = n.y + "px"
                },
                _onImageLoad: function() {
                    this.fire("load")
                },
                _updateOpacity: function() {
                    i.DomUtil.setOpacity(this._image, this.options.opacity)
                }
            }), i.imageOverlay = function(e, t, n) {
                return new i.ImageOverlay(e, t, n)
            }, i.Icon = i.Class.extend({
                options: {
                    className: ""
                },
                initialize: function(e) {
                    i.setOptions(this, e)
                },
                createIcon: function(e) {
                    return this._createIcon("icon", e)
                },
                createShadow: function(e) {
                    return this._createIcon("shadow", e)
                },
                _createIcon: function(e, t) {
                    var n = this._getIconUrl(e);
                    if (!n) {
                        if (e === "icon") throw new Error("iconUrl not set in Icon options (see the docs).");
                        return null
                    }
                    var r;
                    return !t || t.tagName !== "IMG" ? r = this._createImg(n) : r = this._createImg(n, t), this._setIconStyles(r, e), r
                },
                _setIconStyles: function(e, t) {
                    var n = this.options,
                        r = i.point(n[t + "Size"]),
                        s;
                    t === "shadow" ? s = i.point(n.shadowAnchor || n.iconAnchor) : s = i.point(n.iconAnchor), !s && r && (s = r.divideBy(2, !0)), e.className = "leaflet-marker-" + t + " " + n.className, s && (e.style.marginLeft = -s.x + "px", e.style.marginTop = -s.y + "px"), r && (e.style.width = r.x + "px", e.style.height = r.y + "px")
                },
                _createImg: function(e, n) {
                    return n = n || t.createElement("img"), n.src = e, n
                },
                _getIconUrl: function(e) {
                    return i.Browser.retina && this.options[e + "RetinaUrl"] ? this.options[e + "RetinaUrl"] : this.options[e + "Url"]
                }
            }), i.icon = function(e) {
                return new i.Icon(e)
            }, i.Icon.Default = i.Icon.extend({
                options: {
                    iconSize: [25, 41],
                    iconAnchor: [12, 41],
                    popupAnchor: [1, -34],
                    shadowSize: [41, 41]
                },
                _getIconUrl: function(e) {
                    var t = e + "Url";
                    if (this.options[t]) return this.options[t];
                    i.Browser.retina && e === "icon" && (e += "-2x");
                    var n = i.Icon.Default.imagePath;
                    if (!n) throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");
                    return n + "/marker-" + e + ".png"
                }
            }), i.Icon.Default.imagePath = function() {
                var e = t.getElementsByTagName("script"),
                    n = /[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/,
                    r, i, s, o, u;
                for (r = 0, i = e.length; r < i; r++) {
                    s = e[r].src, o = s.match(n);
                    if (o) return u = s.split(n)[0], (u ? u + "/" : "") + "images"
                }
            }(), i.Marker = i.Class.extend({
                includes: i.Mixin.Events,
                options: {
                    icon: new i.Icon.Default,
                    title: "",
                    alt: "",
                    clickable: !0,
                    draggable: !1,
                    keyboard: !0,
                    zIndexOffset: 0,
                    opacity: 1,
                    riseOnHover: !1,
                    riseOffset: 250
                },
                initialize: function(e, t) {
                    i.setOptions(this, t), this._latlng = i.latLng(e)
                },
                onAdd: function(e) {
                    this._map = e, e.on("viewreset", this.update, this), this._initIcon(), this.update(), this.fire("add"), e.options.zoomAnimation && e.options.markerZoomAnimation && e.on("zoomanim", this._animateZoom, this)
                },
                addTo: function(e) {
                    return e.addLayer(this), this
                },
                onRemove: function(e) {
                    this.dragging && this.dragging.disable(), this._removeIcon(), this._removeShadow(), this.fire("remove"), e.off({
                        viewreset: this.update,
                        zoomanim: this._animateZoom
                    }, this), this._map = null
                },
                getLatLng: function() {
                    return this._latlng
                },
                setLatLng: function(e) {
                    return this._latlng = i.latLng(e), this.update(), this.fire("move", {
                        latlng: this._latlng
                    })
                },
                setZIndexOffset: function(e) {
                    return this.options.zIndexOffset = e, this.update(), this
                },
                setIcon: function(e) {
                    return this.options.icon = e, this._map && (this._initIcon(), this.update()), this._popup && this.bindPopup(this._popup), this
                },
                update: function() {
                    return this._icon && this._setPos(this._map.latLngToLayerPoint(this._latlng).round()), this
                },
                _initIcon: function() {
                    var e = this.options,
                        t = this._map,
                        n = t.options.zoomAnimation && t.options.markerZoomAnimation,
                        r = n ? "leaflet-zoom-animated" : "leaflet-zoom-hide",
                        s = e.icon.createIcon(this._icon),
                        o = !1;
                    s !== this._icon && (this._icon && this._removeIcon(), o = !0, e.title && (s.title = e.title), e.alt && (s.alt = e.alt)), i.DomUtil.addClass(s, r), e.keyboard && (s.tabIndex = "0"), this._icon = s, this._initInteraction(), e.riseOnHover && i.DomEvent.on(s, "mouseover", this._bringToFront, this).on(s, "mouseout", this._resetZIndex, this);
                    var u = e.icon.createShadow(this._shadow),
                        a = !1;
                    u !== this._shadow && (this._removeShadow(), a = !0), u && i.DomUtil.addClass(u, r), this._shadow = u, e.opacity < 1 && this._updateOpacity();
                    var f = this._map._panes;
                    o && f.markerPane.appendChild(this._icon), u && a && f.shadowPane.appendChild(this._shadow)
                },
                _removeIcon: function() {
                    this.options.riseOnHover && i.DomEvent.off(this._icon, "mouseover", this._bringToFront).off(this._icon, "mouseout", this._resetZIndex), this._map._panes.markerPane.removeChild(this._icon), this._icon = null
                },
                _removeShadow: function() {
                    this._shadow && this._map._panes.shadowPane.removeChild(this._shadow), this._shadow = null
                },
                _setPos: function(e) {
                    i.DomUtil.setPosition(this._icon, e), this._shadow && i.DomUtil.setPosition(this._shadow, e), this._zIndex = e.y + this.options.zIndexOffset, this._resetZIndex()
                },
                _updateZIndex: function(e) {
                    this._icon.style.zIndex = this._zIndex + e
                },
                _animateZoom: function(e) {
                    var t = this._map._latLngToNewLayerPoint(this._latlng, e.zoom, e.center).round();
                    this._setPos(t)
                },
                _initInteraction: function() {
                    if (!this.options.clickable) return;
                    var e = this._icon,
                        t = ["dblclick", "mousedown", "mouseover", "mouseout", "contextmenu"];
                    i.DomUtil.addClass(e, "leaflet-clickable"), i.DomEvent.on(e, "click", this._onMouseClick, this), i.DomEvent.on(e, "keypress", this._onKeyPress, this);
                    for (var n = 0; n < t.length; n++) i.DomEvent.on(e, t[n], this._fireMouseEvent, this);
                    i.Handler.MarkerDrag && (this.dragging = new i.Handler.MarkerDrag(this), this.options.draggable && this.dragging.enable())
                },
                _onMouseClick: function(e) {
                    var t = this.dragging && this.dragging.moved();
                    (this.hasEventListeners(e.type) || t) && i.DomEvent.stopPropagation(e);
                    if (t) return;
                    if ((!this.dragging || !this.dragging._enabled) && this._map.dragging && this._map.dragging.moved()) return;
                    this.fire(e.type, {
                        originalEvent: e,
                        latlng: this._latlng
                    })
                },
                _onKeyPress: function(e) {
                    e.keyCode === 13 && this.fire("click", {
                        originalEvent: e,
                        latlng: this._latlng
                    })
                },
                _fireMouseEvent: function(e) {
                    this.fire(e.type, {
                        originalEvent: e,
                        latlng: this._latlng
                    }), e.type === "contextmenu" && this.hasEventListeners(e.type) && i.DomEvent.preventDefault(e), e.type !== "mousedown" ? i.DomEvent.stopPropagation(e) : i.DomEvent.preventDefault(e)
                },
                setOpacity: function(e) {
                    return this.options.opacity = e, this._map && this._updateOpacity(), this
                },
                _updateOpacity: function() {
                    i.DomUtil.setOpacity(this._icon, this.options.opacity), this._shadow && i.DomUtil.setOpacity(this._shadow, this.options.opacity)
                },
                _bringToFront: function() {
                    this._updateZIndex(this.options.riseOffset)
                },
                _resetZIndex: function() {
                    this._updateZIndex(0)
                }
            }), i.marker = function(e, t) {
                return new i.Marker(e, t)
            }, i.DivIcon = i.Icon.extend({
                options: {
                    iconSize: [12, 12],
                    className: "leaflet-div-icon",
                    html: !1
                },
                createIcon: function(e) {
                    var n = e && e.tagName === "DIV" ? e : t.createElement("div"),
                        r = this.options;
                    return r.html !== !1 ? n.innerHTML = r.html : n.innerHTML = "", r.bgPos && (n.style.backgroundPosition = -r.bgPos.x + "px " + -r.bgPos.y + "px"), this._setIconStyles(n, "icon"), n
                },
                createShadow: function() {
                    return null
                }
            }), i.divIcon = function(e) {
                return new i.DivIcon(e)
            }, i.Map.mergeOptions({
                closePopupOnClick: !0
            }), i.Popup = i.Class.extend({
                includes: i.Mixin.Events,
                options: {
                    minWidth: 50,
                    maxWidth: 300,
                    autoPan: !0,
                    closeButton: !0,
                    offset: [0, 7],
                    autoPanPadding: [5, 5],
                    keepInView: !1,
                    className: "",
                    zoomAnimation: !0
                },
                initialize: function(e, t) {
                    i.setOptions(this, e), this._source = t, this._animated = i.Browser.any3d && this.options.zoomAnimation, this._isOpen = !1
                },
                onAdd: function(e) {
                    this._map = e, this._container || this._initLayout();
                    var t = e.options.fadeAnimation;
                    t && i.DomUtil.setOpacity(this._container, 0), e._panes.popupPane.appendChild(this._container), e.on(this._getEvents(), this), this.update(), t && i.DomUtil.setOpacity(this._container, 1), this.fire("open"), e.fire("popupopen", {
                        popup: this
                    }), this._source && this._source.fire("popupopen", {
                        popup: this
                    })
                },
                addTo: function(e) {
                    return e.addLayer(this), this
                },
                openOn: function(e) {
                    return e.openPopup(this), this
                },
                onRemove: function(e) {
                    e._panes.popupPane.removeChild(this._container), i.Util.falseFn(this._container.offsetWidth), e.off(this._getEvents(), this), e.options.fadeAnimation && i.DomUtil.setOpacity(this._container, 0), this._map = null, this.fire("close"), e.fire("popupclose", {
                        popup: this
                    }), this._source && this._source.fire("popupclose", {
                        popup: this
                    })
                },
                getLatLng: function() {
                    return this._latlng
                },
                setLatLng: function(e) {
                    return this._latlng = i.latLng(e), this._map && (this._updatePosition(), this._adjustPan()), this
                },
                getContent: function() {
                    return this._content
                },
                setContent: function(e) {
                    return this._content = e, this.update(), this
                },
                update: function() {
                    if (!this._map) return;
                    this._container.style.visibility = "hidden", this._updateContent(), this._updateLayout(), this._updatePosition(), this._container.style.visibility = "", this._adjustPan()
                },
                _getEvents: function() {
                    var e = {
                        viewreset: this._updatePosition
                    };
                    this._animated && (e.zoomanim = this._zoomAnimation);
                    if ("closeOnClick" in this.options ? this.options.closeOnClick : this._map.options.closePopupOnClick) e.preclick = this._close;
                    return this.options.keepInView && (e.moveend = this._adjustPan), e
                },
                _close: function() {
                    this._map && this._map.closePopup(this)
                },
                _initLayout: function() {
                    var e = "leaflet-popup",
                        t = e + " " + this.options.className + " leaflet-zoom-" + (this._animated ? "animated" : "hide"),
                        n = this._container = i.DomUtil.create("div", t),
                        r;
                    this.options.closeButton && (r = this._closeButton = i.DomUtil.create("a", e + "-close-button", n), r.href = "#close", r.innerHTML = "&#215;", i.DomEvent.disableClickPropagation(r), i.DomEvent.on(r, "click", this._onCloseButtonClick, this));
                    var s = this._wrapper = i.DomUtil.create("div", e + "-content-wrapper", n);
                    i.DomEvent.disableClickPropagation(s), this._contentNode = i.DomUtil.create("div", e + "-content", s), i.DomEvent.disableScrollPropagation(this._contentNode), i.DomEvent.on(s, "contextmenu", i.DomEvent.stopPropagation), this._tipContainer = i.DomUtil.create("div", e + "-tip-container", n), this._tip = i.DomUtil.create("div", e + "-tip", this._tipContainer)
                },
                _updateContent: function() {
                    if (!this._content) return;
                    if (typeof this._content == "string") this._contentNode.innerHTML = this._content;
                    else {
                        while (this._contentNode.hasChildNodes()) this._contentNode.removeChild(this._contentNode.firstChild);
                        this._contentNode.appendChild(this._content)
                    }
                    this.fire("contentupdate")
                },
                _updateLayout: function() {
                    var e = this._contentNode,
                        t = e.style;
                    t.width = "", t.whiteSpace = "nowrap";
                    var n = e.offsetWidth;
                    n = Math.min(n, this.options.maxWidth), n = Math.max(n, this.options.minWidth), t.width = n + 1 + "px", t.whiteSpace = "", t.height = "";
                    var r = e.offsetHeight,
                        s = this.options.maxHeight,
                        o = "leaflet-popup-scrolled";
                    s && r > s ? (t.height = s + "px", i.DomUtil.addClass(e, o)) : i.DomUtil.removeClass(e, o), this._containerWidth = this._container.offsetWidth
                },
                _updatePosition: function() {
                    if (!this._map) return;
                    var e = this._map.latLngToLayerPoint(this._latlng),
                        t = this._animated,
                        n = i.point(this.options.offset);
                    t && i.DomUtil.setPosition(this._container, e), this._containerBottom = -n.y - (t ? 0 : e.y), this._containerLeft = -Math.round(this._containerWidth / 2) + n.x + (t ? 0 : e.x), this._container.style.bottom = this._containerBottom + "px", this._container.style.left = this._containerLeft + "px"
                },
                _zoomAnimation: function(e) {
                    var t = this._map._latLngToNewLayerPoint(this._latlng, e.zoom, e.center);
                    i.DomUtil.setPosition(this._container, t)
                },
                _adjustPan: function() {
                    if (!this.options.autoPan) return;
                    var e = this._map,
                        t = this._container.offsetHeight,
                        n = this._containerWidth,
                        r = new i.Point(this._containerLeft, -t - this._containerBottom);
                    this._animated && r._add(i.DomUtil.getPosition(this._container));
                    var s = e.layerPointToContainerPoint(r),
                        o = i.point(this.options.autoPanPadding),
                        u = i.point(this.options.autoPanPaddingTopLeft || o),
                        a = i.point(this.options.autoPanPaddingBottomRight || o),
                        f = e.getSize(),
                        l = 0,
                        c = 0;
                    s.x + n + a.x > f.x && (l = s.x + n - f.x + a.x), s.x - l - u.x < 0 && (l = s.x - u.x), s.y + t + a.y > f.y && (c = s.y + t - f.y + a.y), s.y - c - u.y < 0 && (c = s.y - u.y), (l || c) && e.fire("autopanstart").panBy([l, c])
                },
                _onCloseButtonClick: function(e) {
                    this._close(), i.DomEvent.stop(e)
                }
            }), i.popup = function(e, t) {
                return new i.Popup(e, t)
            }, i.Map.include({
                openPopup: function(e, t, n) {
                    this.closePopup();
                    if (!(e instanceof i.Popup)) {
                        var r = e;
                        e = (new i.Popup(n)).setLatLng(t).setContent(r)
                    }
                    return e._isOpen = !0, this._popup = e, this.addLayer(e)
                },
                closePopup: function(e) {
                    if (!e || e === this._popup) e = this._popup, this._popup = null;
                    return e && (this.removeLayer(e), e._isOpen = !1), this
                }
            }), i.Marker.include({
                openPopup: function() {
                    return this._popup && this._map && !this._map.hasLayer(this._popup) && (this._popup.setLatLng(this._latlng), this._map.openPopup(this._popup)), this
                },
                closePopup: function() {
                    return this._popup && this._popup._close(), this
                },
                togglePopup: function() {
                    return this._popup && (this._popup._isOpen ? this.closePopup() : this.openPopup()), this
                },
                bindPopup: function(e, t) {
                    var n = i.point(this.options.icon.options.popupAnchor || [0, 0]);
                    return n = n.add(i.Popup.prototype.options.offset), t && t.offset && (n = n.add(t.offset)), t = i.extend({
                        offset: n
                    }, t), this._popupHandlersAdded || (this.on("click", this.togglePopup, this).on("remove", this.closePopup, this).on("move", this._movePopup, this), this._popupHandlersAdded = !0), e instanceof i.Popup ? (i.setOptions(e, t), this._popup = e, e._source = this) : this._popup = (new i.Popup(t, this)).setContent(e), this
                },
                setPopupContent: function(e) {
                    return this._popup && this._popup.setContent(e), this
                },
                unbindPopup: function() {
                    return this._popup && (this._popup = null, this.off("click", this.togglePopup, this).off("remove", this.closePopup, this).off("move", this._movePopup, this), this._popupHandlersAdded = !1), this
                },
                getPopup: function() {
                    return this._popup
                },
                _movePopup: function(e) {
                    this._popup.setLatLng(e.latlng)
                }
            }), i.LayerGroup = i.Class.extend({
                initialize: function(e) {
                    this._layers = {};
                    var t, n;
                    if (e)
                        for (t = 0, n = e.length; t < n; t++) this.addLayer(e[t])
                },
                addLayer: function(e) {
                    var t = this.getLayerId(e);
                    return this._layers[t] = e, this._map && this._map.addLayer(e), this
                },
                removeLayer: function(e) {
                    var t = e in this._layers ? e : this.getLayerId(e);
                    return this._map && this._layers[t] && this._map.removeLayer(this._layers[t]), delete this._layers[t], this
                },
                hasLayer: function(e) {
                    return e ? e in this._layers || this.getLayerId(e) in this._layers : !1
                },
                clearLayers: function() {
                    return this.eachLayer(this.removeLayer, this), this
                },
                invoke: function(e) {
                    var t = Array.prototype.slice.call(arguments, 1),
                        n, r;
                    for (n in this._layers) r = this._layers[n], r[e] && r[e].apply(r, t);
                    return this
                },
                onAdd: function(e) {
                    this._map = e, this.eachLayer(e.addLayer, e)
                },
                onRemove: function(e) {
                    this.eachLayer(e.removeLayer, e), this._map = null
                },
                addTo: function(e) {
                    return e.addLayer(this), this
                },
                eachLayer: function(e, t) {
                    for (var n in this._layers) e.call(t, this._layers[n]);
                    return this
                },
                getLayer: function(e) {
                    return this._layers[e]
                },
                getLayers: function() {
                    var e = [];
                    for (var t in this._layers) e.push(this._layers[t]);
                    return e
                },
                setZIndex: function(e) {
                    return this.invoke("setZIndex", e)
                },
                getLayerId: function(e) {
                    return i.stamp(e)
                }
            }), i.layerGroup = function(e) {
                return new i.LayerGroup(e)
            }, i.FeatureGroup = i.LayerGroup.extend({
                includes: i.Mixin.Events,
                statics: {
                    EVENTS: "click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"
                },
                addLayer: function(e) {
                    return this.hasLayer(e) ? this : ("on" in e && e.on(i.FeatureGroup.EVENTS, this._propagateEvent, this), i.LayerGroup.prototype.addLayer.call(this, e), this._popupContent && e.bindPopup && e.bindPopup(this._popupContent, this._popupOptions), this.fire("layeradd", {
                        layer: e
                    }))
                },
                removeLayer: function(e) {
                    return this.hasLayer(e) ? (e in this._layers && (e = this._layers[e]), "off" in e && e.off(i.FeatureGroup.EVENTS, this._propagateEvent, this), i.LayerGroup.prototype.removeLayer.call(this, e), this._popupContent && this.invoke("unbindPopup"), this.fire("layerremove", {
                        layer: e
                    })) : this
                },
                bindPopup: function(e, t) {
                    return this._popupContent = e, this._popupOptions = t, this.invoke("bindPopup", e, t)
                },
                openPopup: function(e) {
                    for (var t in this._layers) {
                        this._layers[t].openPopup(e);
                        break
                    }
                    return this
                },
                setStyle: function(e) {
                    return this.invoke("setStyle", e)
                },
                bringToFront: function() {
                    return this.invoke("bringToFront")
                },
                bringToBack: function() {
                    return this.invoke("bringToBack")
                },
                getBounds: function() {
                    var e = new i.LatLngBounds;
                    return this.eachLayer(function(t) {
                        e.extend(t instanceof i.Marker ? t.getLatLng() : t.getBounds())
                    }), e
                },
                _propagateEvent: function(e) {
                    e = i.extend({
                        layer: e.target,
                        target: this
                    }, e), this.fire(e.type, e)
                }
            }), i.featureGroup = function(e) {
                return new i.FeatureGroup(e)
            }, i.Path = i.Class.extend({
                includes: [i.Mixin.Events],
                statics: {
                    CLIP_PADDING: function() {
                        var t = i.Browser.mobile ? 1280 : 2e3,
                            n = (t / Math.max(e.outerWidth, e.outerHeight) - 1) / 2;
                        return Math.max(0, Math.min(.5, n))
                    }()
                },
                options: {
                    stroke: !0,
                    color: "#0033ff",
                    dashArray: null,
                    lineCap: null,
                    lineJoin: null,
                    weight: 5,
                    opacity: .5,
                    fill: !1,
                    fillColor: null,
                    fillOpacity: .2,
                    clickable: !0
                },
                initialize: function(e) {
                    i.setOptions(this, e)
                },
                onAdd: function(e) {
                    this._map = e, this._container || (this._initElements(), this._initEvents()), this.projectLatlngs(), this._updatePath(), this._container && this._map._pathRoot.appendChild(this._container), this.fire("add"), e.on({
                        viewreset: this.projectLatlngs,
                        moveend: this._updatePath
                    }, this)
                },
                addTo: function(e) {
                    return e.addLayer(this), this
                },
                onRemove: function(e) {
                    e._pathRoot.removeChild(this._container), this.fire("remove"), this._map = null, i.Browser.vml && (this._container = null, this._stroke = null, this._fill = null), e.off({
                        viewreset: this.projectLatlngs,
                        moveend: this._updatePath
                    }, this)
                },
                projectLatlngs: function() {},
                setStyle: function(e) {
                    return i.setOptions(this, e), this._container && this._updateStyle(), this
                },
                redraw: function() {
                    return this._map && (this.projectLatlngs(), this._updatePath()), this
                }
            }), i.Map.include({
                _updatePathViewport: function() {
                    var e = i.Path.CLIP_PADDING,
                        t = this.getSize(),
                        n = i.DomUtil.getPosition(this._mapPane),
                        r = n.multiplyBy(-1)._subtract(t.multiplyBy(e)._round()),
                        s = r.add(t.multiplyBy(1 + e * 2)._round());
                    this._pathViewport = new i.Bounds(r, s)
                }
            }), i.Path.SVG_NS = "http://www.w3.org/2000/svg", i.Browser.svg = !!t.createElementNS && !!t.createElementNS(i.Path.SVG_NS, "svg").createSVGRect, i.Path = i.Path.extend({
                statics: {
                    SVG: i.Browser.svg
                },
                bringToFront: function() {
                    var e = this._map._pathRoot,
                        t = this._container;
                    return t && e.lastChild !== t && e.appendChild(t), this
                },
                bringToBack: function() {
                    var e = this._map._pathRoot,
                        t = this._container,
                        n = e.firstChild;
                    return t && n !== t && e.insertBefore(t, n), this
                },
                getPathString: function() {},
                _createElement: function(e) {
                    return t.createElementNS(i.Path.SVG_NS, e)
                },
                _initElements: function() {
                    this._map._initPathRoot(), this._initPath(), this._initStyle()
                },
                _initPath: function() {
                    this._container = this._createElement("g"), this._path = this._createElement("path"), this.options.className && i.DomUtil.addClass(this._path, this.options.className), this._container.appendChild(this._path)
                },
                _initStyle: function() {
                    this.options.stroke && (this._path.setAttribute("stroke-linejoin", "round"), this._path.setAttribute("stroke-linecap", "round")), this.options.fill && this._path.setAttribute("fill-rule", "evenodd"), this.options.pointerEvents && this._path.setAttribute("pointer-events", this.options.pointerEvents), !this.options.clickable && !this.options.pointerEvents && this._path.setAttribute("pointer-events", "none"), this._updateStyle()
                },
                _updateStyle: function() {
                    this.options.stroke ? (this._path.setAttribute("stroke", this.options.color), this._path.setAttribute("stroke-opacity", this.options.opacity), this._path.setAttribute("stroke-width", this.options.weight), this.options.dashArray ? this._path.setAttribute("stroke-dasharray", this.options.dashArray) : this._path.removeAttribute("stroke-dasharray"), this.options.lineCap && this._path.setAttribute("stroke-linecap", this.options.lineCap), this.options.lineJoin && this._path.setAttribute("stroke-linejoin", this.options.lineJoin)) : this._path.setAttribute("stroke", "none"), this.options.fill ? (this._path.setAttribute("fill", this.options.fillColor || this.options.color), this._path.setAttribute("fill-opacity", this.options.fillOpacity)) : this._path.setAttribute("fill", "none")
                },
                _updatePath: function() {
                    var e = this.getPathString();
                    e || (e = "M0 0"), this._path.setAttribute("d", e)
                },
                _initEvents: function() {
                    if (this.options.clickable) {
                        (i.Browser.svg || !i.Browser.vml) && i.DomUtil.addClass(this._path, "leaflet-clickable"), i.DomEvent.on(this._container, "click", this._onMouseClick, this);
                        var e = ["dblclick", "mousedown", "mouseover", "mouseout", "mousemove", "contextmenu"];
                        for (var t = 0; t < e.length; t++) i.DomEvent.on(this._container, e[t], this._fireMouseEvent, this)
                    }
                },
                _onMouseClick: function(e) {
                    if (this._map.dragging && this._map.dragging.moved()) return;
                    this._fireMouseEvent(e)
                },
                _fireMouseEvent: function(e) {
                    if (!this._map || !this.hasEventListeners(e.type)) return;
                    var t = this._map,
                        n = t.mouseEventToContainerPoint(e),
                        r = t.containerPointToLayerPoint(n),
                        s = t.layerPointToLatLng(r);
                    this.fire(e.type, {
                        latlng: s,
                        layerPoint: r,
                        containerPoint: n,
                        originalEvent: e
                    }), e.type === "contextmenu" && i.DomEvent.preventDefault(e), e.type !== "mousemove" && i.DomEvent.stopPropagation(e)
                }
            }), i.Map.include({
                _initPathRoot: function() {
                    this._pathRoot || (this._pathRoot = i.Path.prototype._createElement("svg"), this._panes.overlayPane.appendChild(this._pathRoot), this.options.zoomAnimation && i.Browser.any3d ? (i.DomUtil.addClass(this._pathRoot, "leaflet-zoom-animated"), this.on({
                        zoomanim: this._animatePathZoom,
                        zoomend: this._endPathZoom
                    })) : i.DomUtil.addClass(this._pathRoot, "leaflet-zoom-hide"), this.on("moveend", this._updateSvgViewport), this._updateSvgViewport())
                },
                _animatePathZoom: function(e) {
                    var t = this.getZoomScale(e.zoom),
                        n = this._getCenterOffset(e.center)._multiplyBy(-t)._add(this._pathViewport.min);
                    this._pathRoot.style[i.DomUtil.TRANSFORM] = i.DomUtil.getTranslateString(n) + " scale(" + t + ") ", this._pathZooming = !0
                },
                _endPathZoom: function() {
                    this._pathZooming = !1
                },
                _updateSvgViewport: function() {
                    if (this._pathZooming) return;
                    this._updatePathViewport();
                    var e = this._pathViewport,
                        t = e.min,
                        n = e.max,
                        r = n.x - t.x,
                        s = n.y - t.y,
                        o = this._pathRoot,
                        u = this._panes.overlayPane;
                    i.Browser.mobileWebkit && u.removeChild(o), i.DomUtil.setPosition(o, t), o.setAttribute("width", r), o.setAttribute("height", s), o.setAttribute("viewBox", [t.x, t.y, r, s].join(" ")), i.Browser.mobileWebkit && u.appendChild(o)
                }
            }), i.Path.include({
                bindPopup: function(e, t) {
                    if (e instanceof i.Popup) this._popup = e;
                    else {
                        if (!this._popup || t) this._popup = new i.Popup(t, this);
                        this._popup.setContent(e)
                    }
                    return this._popupHandlersAdded || (this.on("click", this._openPopup, this).on("remove", this.closePopup, this), this._popupHandlersAdded = !0), this
                },
                unbindPopup: function() {
                    return this._popup && (this._popup = null, this.off("click", this._openPopup).off("remove", this.closePopup), this._popupHandlersAdded = !1), this
                },
                openPopup: function(e) {
                    return this._popup && (e = e || this._latlng || this._latlngs[Math.floor(this._latlngs.length / 2)], this._openPopup({
                        latlng: e
                    })), this
                },
                closePopup: function() {
                    return this._popup && this._popup._close(), this
                },
                _openPopup: function(e) {
                    this._popup.setLatLng(e.latlng), this._map.openPopup(this._popup)
                }
            }), i.Browser.vml = !i.Browser.svg && function() {
                try {
                    var e = t.createElement("div");
                    e.innerHTML = '<v:shape adj="1"/>';
                    var n = e.firstChild;
                    return n.style.behavior = "url(#default#VML)", n && typeof n.adj == "object"
                } catch (r) {
                    return !1
                }
            }(), i.Path = i.Browser.svg || !i.Browser.vml ? i.Path : i.Path.extend({
                statics: {
                    VML: !0,
                    CLIP_PADDING: .02
                },
                _createElement: function() {
                    try {
                        return t.namespaces.add("lvml", "urn:schemas-microsoft-com:vml"),
                            function(e) {
                                return t.createElement("<lvml:" + e + ' class="lvml">')
                            }
                    } catch (e) {
                        return function(e) {
                            return t.createElement("<" + e + ' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')
                        }
                    }
                }(),
                _initPath: function() {
                    var e = this._container = this._createElement("shape");
                    i.DomUtil.addClass(e, "leaflet-vml-shape" + (this.options.className ? " " + this.options.className : "")), this.options.clickable && i.DomUtil.addClass(e, "leaflet-clickable"), e.coordsize = "1 1", this._path = this._createElement("path"), e.appendChild(this._path), this._map._pathRoot.appendChild(e)
                },
                _initStyle: function() {
                    this._updateStyle()
                },
                _updateStyle: function() {
                    var e = this._stroke,
                        t = this._fill,
                        n = this.options,
                        r = this._container;
                    r.stroked = n.stroke, r.filled = n.fill, n.stroke ? (e || (e = this._stroke = this._createElement("stroke"), e.endcap = "round", r.appendChild(e)), e.weight = n.weight + "px", e.color = n.color, e.opacity = n.opacity, n.dashArray ? e.dashStyle = i.Util.isArray(n.dashArray) ? n.dashArray.join(" ") : n.dashArray.replace(/( *, *)/g, " ") : e.dashStyle = "", n.lineCap && (e.endcap = n.lineCap.replace("butt", "flat")), n.lineJoin && (e.joinstyle = n.lineJoin)) : e && (r.removeChild(e), this._stroke = null), n.fill ? (t || (t = this._fill = this._createElement("fill"), r.appendChild(t)), t.color = n.fillColor || n.color, t.opacity = n.fillOpacity) : t && (r.removeChild(t), this._fill = null)
                },
                _updatePath: function() {
                    var e = this._container.style;
                    e.display = "none", this._path.v = this.getPathString() + " ", e.display = ""
                }
            }), i.Map.include(i.Browser.svg || !i.Browser.vml ? {} : {
                _initPathRoot: function() {
                    if (this._pathRoot) return;
                    var e = this._pathRoot = t.createElement("div");
                    e.className = "leaflet-vml-container", this._panes.overlayPane.appendChild(e), this.on("moveend", this._updatePathViewport), this._updatePathViewport()
                }
            }), i.Browser.canvas = function() {
                return !!t.createElement("canvas").getContext
            }(), i.Path = i.Path.SVG && !e.L_PREFER_CANVAS || !i.Browser.canvas ? i.Path : i.Path.extend({
                statics: {
                    CANVAS: !0,
                    SVG: !1
                },
                redraw: function() {
                    return this._map && (this.projectLatlngs(), this._requestUpdate()), this
                },
                setStyle: function(e) {
                    return i.setOptions(this, e), this._map && (this._updateStyle(), this._requestUpdate()), this
                },
                onRemove: function(e) {
                    e.off("viewreset", this.projectLatlngs, this).off("moveend", this._updatePath, this), this.options.clickable && (this._map.off("click", this._onClick, this), this._map.off("mousemove", this._onMouseMove, this)), this._requestUpdate(), this.fire("remove"), this._map = null
                },
                _requestUpdate: function() {
                    this._map && !i.Path._updateRequest && (i.Path._updateRequest = i.Util.requestAnimFrame(this._fireMapMoveEnd, this._map))
                },
                _fireMapMoveEnd: function() {
                    i.Path._updateRequest = null, this.fire("moveend")
                },
                _initElements: function() {
                    this._map._initPathRoot(), this._ctx = this._map._canvasCtx
                },
                _updateStyle: function() {
                    var e = this.options;
                    e.stroke && (this._ctx.lineWidth = e.weight, this._ctx.strokeStyle = e.color), e.fill && (this._ctx.fillStyle = e.fillColor || e.color), e.lineCap && (this._ctx.lineCap = e.lineCap), e.lineJoin && (this._ctx.lineJoin = e.lineJoin)
                },
                _drawPath: function() {
                    var e, t, n, r, s, o;
                    this._ctx.beginPath();
                    for (e = 0, n = this._parts.length; e < n; e++) {
                        for (t = 0, r = this._parts[e].length; t < r; t++) s = this._parts[e][t], o = (t === 0 ? "move" : "line") + "To", this._ctx[o](s.x, s.y);
                        this instanceof i.Polygon && this._ctx.closePath()
                    }
                },
                _checkIfEmpty: function() {
                    return !this._parts.length
                },
                _updatePath: function() {
                    if (this._checkIfEmpty()) return;
                    var e = this._ctx,
                        t = this.options;
                    this._drawPath(), e.save(), this._updateStyle(), t.fill && (e.globalAlpha = t.fillOpacity, e.fill(t.fillRule || "evenodd")), t.stroke && (e.globalAlpha = t.opacity, e.stroke()), e.restore()
                },
                _initEvents: function() {
                    this.options.clickable && (this._map.on("mousemove", this._onMouseMove, this), this._map.on("click dblclick contextmenu", this._fireMouseEvent, this))
                },
                _fireMouseEvent: function(e) {
                    this._containsPoint(e.layerPoint) && this.fire(e.type, e)
                },
                _onMouseMove: function(e) {
                    if (!this._map || this._map._animatingZoom) return;
                    this._containsPoint(e.layerPoint) ? (this._ctx.canvas.style.cursor = "pointer", this._mouseInside = !0, this.fire("mouseover", e)) : this._mouseInside && (this._ctx.canvas.style.cursor = "", this._mouseInside = !1, this.fire("mouseout", e))
                }
            }), i.Map.include(i.Path.SVG && !e.L_PREFER_CANVAS || !i.Browser.canvas ? {} : {
                _initPathRoot: function() {
                    var e = this._pathRoot,
                        n;
                    e || (e = this._pathRoot = t.createElement("canvas"), e.style.position = "absolute", n = this._canvasCtx = e.getContext("2d"), n.lineCap = "round", n.lineJoin = "round", this._panes.overlayPane.appendChild(e), this.options.zoomAnimation && (this._pathRoot.className = "leaflet-zoom-animated", this.on("zoomanim", this._animatePathZoom), this.on("zoomend", this._endPathZoom)), this.on("moveend", this._updateCanvasViewport), this._updateCanvasViewport())
                },
                _updateCanvasViewport: function() {
                    if (this._pathZooming) return;
                    this._updatePathViewport();
                    var e = this._pathViewport,
                        t = e.min,
                        n = e.max.subtract(t),
                        r = this._pathRoot;
                    i.DomUtil.setPosition(r, t), r.width = n.x, r.height = n.y, r.getContext("2d").translate(-t.x, -t.y)
                }
            }), i.LineUtil = {
                simplify: function(e, t) {
                    if (!t || !e.length) return e.slice();
                    var n = t * t;
                    return e = this._reducePoints(e, n), e = this._simplifyDP(e, n), e
                },
                pointToSegmentDistance: function(e, t, n) {
                    return Math.sqrt(this._sqClosestPointOnSegment(e, t, n, !0))
                },
                closestPointOnSegment: function(e, t, n) {
                    return this._sqClosestPointOnSegment(e, t, n)
                },
                _simplifyDP: function(e, t) {
                    var r = e.length,
                        i = typeof Uint8Array != n + "" ? Uint8Array : Array,
                        s = new i(r);
                    s[0] = s[r - 1] = 1, this._simplifyDPStep(e, s, t, 0, r - 1);
                    var o, u = [];
                    for (o = 0; o < r; o++) s[o] && u.push(e[o]);
                    return u
                },
                _simplifyDPStep: function(e, t, n, r, i) {
                    var s = 0,
                        o, u, a;
                    for (u = r + 1; u <= i - 1; u++) a = this._sqClosestPointOnSegment(e[u], e[r], e[i], !0), a > s && (o = u, s = a);
                    s > n && (t[o] = 1, this._simplifyDPStep(e, t, n, r, o), this._simplifyDPStep(e, t, n, o, i))
                },
                _reducePoints: function(e, t) {
                    var n = [e[0]];
                    for (var r = 1, i = 0, s = e.length; r < s; r++) this._sqDist(e[r], e[i]) > t && (n.push(e[r]), i = r);
                    return i < s - 1 && n.push(e[s - 1]), n
                },
                clipSegment: function(e, t, n, r) {
                    var i = r ? this._lastCode : this._getBitCode(e, n),
                        s = this._getBitCode(t, n),
                        o, u, a;
                    this._lastCode = s;
                    for (;;) {
                        if (!(i | s)) return [e, t];
                        if (i & s) return !1;
                        o = i || s, u = this._getEdgeIntersection(e, t, o, n), a = this._getBitCode(u, n), o === i ? (e = u, i = a) : (t = u, s = a)
                    }
                },
                _getEdgeIntersection: function(e, t, n, r) {
                    var s = t.x - e.x,
                        o = t.y - e.y,
                        u = r.min,
                        a = r.max;
                    if (n & 8) return new i.Point(e.x + s * (a.y - e.y) / o, a.y);
                    if (n & 4) return new i.Point(e.x + s * (u.y - e.y) / o, u.y);
                    if (n & 2) return new i.Point(a.x, e.y + o * (a.x - e.x) / s);
                    if (n & 1) return new i.Point(u.x, e.y + o * (u.x - e.x) / s)
                },
                _getBitCode: function(e, t) {
                    var n = 0;
                    return e.x < t.min.x ? n |= 1 : e.x > t.max.x && (n |= 2), e.y < t.min.y ? n |= 4 : e.y > t.max.y && (n |= 8), n
                },
                _sqDist: function(e, t) {
                    var n = t.x - e.x,
                        r = t.y - e.y;
                    return n * n + r * r
                },
                _sqClosestPointOnSegment: function(e, t, n, r) {
                    var s = t.x,
                        o = t.y,
                        u = n.x - s,
                        a = n.y - o,
                        f = u * u + a * a,
                        l;
                    return f > 0 && (l = ((e.x - s) * u + (e.y - o) * a) / f, l > 1 ? (s = n.x, o = n.y) : l > 0 && (s += u * l, o += a * l)), u = e.x - s, a = e.y - o, r ? u * u + a * a : new i.Point(s, o)
                }
            }, i.Polyline = i.Path.extend({
                initialize: function(e, t) {
                    i.Path.prototype.initialize.call(this, t), this._latlngs = this._convertLatLngs(e)
                },
                options: {
                    smoothFactor: 1,
                    noClip: !1
                },
                projectLatlngs: function() {
                    this._originalPoints = [];
                    for (var e = 0, t = this._latlngs.length; e < t; e++) this._originalPoints[e] = this._map.latLngToLayerPoint(this._latlngs[e])
                },
                getPathString: function() {
                    for (var e = 0, t = this._parts.length, n = ""; e < t; e++) n += this._getPathPartStr(this._parts[e]);
                    return n
                },
                getLatLngs: function() {
                    return this._latlngs
                },
                setLatLngs: function(e) {
                    return this._latlngs = this._convertLatLngs(e), this.redraw()
                },
                addLatLng: function(e) {
                    return this._latlngs.push(i.latLng(e)), this.redraw()
                },
                spliceLatLngs: function() {
                    var e = [].splice.apply(this._latlngs, arguments);
                    return this._convertLatLngs(this._latlngs, !0), this.redraw(), e
                },
                closestLayerPoint: function(e) {
                    var t = Infinity,
                        n = this._parts,
                        r, s, o = null;
                    for (var u = 0, a = n.length; u < a; u++) {
                        var f = n[u];
                        for (var l = 1, c = f.length; l < c; l++) {
                            r = f[l - 1], s = f[l];
                            var h = i.LineUtil._sqClosestPointOnSegment(e, r, s, !0);
                            h < t && (t = h, o = i.LineUtil._sqClosestPointOnSegment(e, r, s))
                        }
                    }
                    return o && (o.distance = Math.sqrt(t)), o
                },
                getBounds: function() {
                    return new i.LatLngBounds(this.getLatLngs())
                },
                _convertLatLngs: function(e, t) {
                    var n, r, s = t ? e : [];
                    for (n = 0, r = e.length; n < r; n++) {
                        if (i.Util.isArray(e[n]) && typeof e[n][0] != "number") return;
                        s[n] = i.latLng(e[n])
                    }
                    return s
                },
                _initEvents: function() {
                    i.Path.prototype._initEvents.call(this)
                },
                _getPathPartStr: function(e) {
                    var t = i.Path.VML;
                    for (var n = 0, r = e.length, s = "", o; n < r; n++) o = e[n], t && o._round(), s += (n ? "L" : "M") + o.x + " " + o.y;
                    return s
                },
                _clipPoints: function() {
                    var e = this._originalPoints,
                        t = e.length,
                        n, r, s;
                    if (this.options.noClip) {
                        this._parts = [e];
                        return
                    }
                    this._parts = [];
                    var o = this._parts,
                        u = this._map._pathViewport,
                        a = i.LineUtil;
                    for (n = 0, r = 0; n < t - 1; n++) {
                        s = a.clipSegment(e[n], e[n + 1], u, n);
                        if (!s) continue;
                        o[r] = o[r] || [], o[r].push(s[0]);
                        if (s[1] !== e[n + 1] || n === t - 2) o[r].push(s[1]), r++
                    }
                },
                _simplifyPoints: function() {
                    var e = this._parts,
                        t = i.LineUtil;
                    for (var n = 0, r = e.length; n < r; n++) e[n] = t.simplify(e[n], this.options.smoothFactor)
                },
                _updatePath: function() {
                    if (!this._map) return;
                    this._clipPoints(), this._simplifyPoints(), i.Path.prototype._updatePath.call(this)
                }
            }), i.polyline = function(e, t) {
                return new i.Polyline(e, t)
            }, i.PolyUtil = {}, i.PolyUtil.clipPolygon = function(e, t) {
                var n, r = [1, 4, 2, 8],
                    s, o, u, a, f, l, c, h, p = i.LineUtil;
                for (s = 0, l = e.length; s < l; s++) e[s]._code = p._getBitCode(e[s], t);
                for (u = 0; u < 4; u++) {
                    c = r[u], n = [];
                    for (s = 0, l = e.length, o = l - 1; s < l; o = s++) a = e[s], f = e[o], a._code & c ? f._code & c || (h = p._getEdgeIntersection(f, a, c, t), h._code = p._getBitCode(h, t), n.push(h)) : (f._code & c && (h = p._getEdgeIntersection(f, a, c, t), h._code = p._getBitCode(h, t), n.push(h)), n.push(a));
                    e = n
                }
                return e
            }, i.Polygon = i.Polyline.extend({
                options: {
                    fill: !0
                },
                initialize: function(e, t) {
                    i.Polyline.prototype.initialize.call(this, e, t), this._initWithHoles(e)
                },
                _initWithHoles: function(e) {
                    var t, n, r;
                    if (e && i.Util.isArray(e[0]) && typeof e[0][0] != "number") {
                        this._latlngs = this._convertLatLngs(e[0]), this._holes = e.slice(1);
                        for (t = 0, n = this._holes.length; t < n; t++) r = this._holes[t] = this._convertLatLngs(this._holes[t]), r[0].equals(r[r.length - 1]) && r.pop()
                    }
                    e = this._latlngs, e.length >= 2 && e[0].equals(e[e.length - 1]) && e.pop()
                },
                projectLatlngs: function() {
                    i.Polyline.prototype.projectLatlngs.call(this), this._holePoints = [];
                    if (!this._holes) return;
                    var e, t, n, r;
                    for (e = 0, n = this._holes.length; e < n; e++) {
                        this._holePoints[e] = [];
                        for (t = 0, r = this._holes[e].length; t < r; t++) this._holePoints[e][t] = this._map.latLngToLayerPoint(this._holes[e][t])
                    }
                },
                setLatLngs: function(e) {
                    return e && i.Util.isArray(e[0]) && typeof e[0][0] != "number" ? (this._initWithHoles(e), this.redraw()) : i.Polyline.prototype.setLatLngs.call(this, e)
                },
                _clipPoints: function() {
                    var e = this._originalPoints,
                        t = [];
                    this._parts = [e].concat(this._holePoints);
                    if (this.options.noClip) return;
                    for (var n = 0, r = this._parts.length; n < r; n++) {
                        var s = i.PolyUtil.clipPolygon(this._parts[n], this._map._pathViewport);
                        s.length && t.push(s)
                    }
                    this._parts = t
                },
                _getPathPartStr: function(e) {
                    var t = i.Polyline.prototype._getPathPartStr.call(this, e);
                    return t + (i.Browser.svg ? "z" : "x")
                }
            }), i.polygon = function(e, t) {
                return new i.Polygon(e, t)
            },
            function() {
                function e(e) {
                    return i.FeatureGroup.extend({
                        initialize: function(e, t) {
                            this._layers = {}, this._options = t, this.setLatLngs(e)
                        },
                        setLatLngs: function(t) {
                            var n = 0,
                                r = t.length;
                            this.eachLayer(function(e) {
                                n < r ? e.setLatLngs(t[n++]) : this.removeLayer(e)
                            }, this);
                            while (n < r) this.addLayer(new e(t[n++], this._options));
                            return this
                        },
                        getLatLngs: function() {
                            var e = [];
                            return this.eachLayer(function(t) {
                                e.push(t.getLatLngs())
                            }), e
                        }
                    })
                }
                i.MultiPolyline = e(i.Polyline), i.MultiPolygon = e(i.Polygon), i.multiPolyline = function(e, t) {
                    return new i.MultiPolyline(e, t)
                }, i.multiPolygon = function(e, t) {
                    return new i.MultiPolygon(e, t)
                }
            }(), i.Rectangle = i.Polygon.extend({
                initialize: function(e, t) {
                    i.Polygon.prototype.initialize.call(this, this._boundsToLatLngs(e), t)
                },
                setBounds: function(e) {
                    this.setLatLngs(this._boundsToLatLngs(e))
                },
                _boundsToLatLngs: function(e) {
                    return e = i.latLngBounds(e), [e.getSouthWest(), e.getNorthWest(), e.getNorthEast(), e.getSouthEast()]
                }
            }), i.rectangle = function(e, t) {
                return new i.Rectangle(e, t)
            }, i.Circle = i.Path.extend({
                initialize: function(e, t, n) {
                    i.Path.prototype.initialize.call(this, n), this._latlng = i.latLng(e), this._mRadius = t
                },
                options: {
                    fill: !0
                },
                setLatLng: function(e) {
                    return this._latlng = i.latLng(e), this.redraw()
                },
                setRadius: function(e) {
                    return this._mRadius = e, this.redraw()
                },
                projectLatlngs: function() {
                    var e = this._getLngRadius(),
                        t = this._latlng,
                        n = this._map.latLngToLayerPoint([t.lat, t.lng - e]);
                    this._point = this._map.latLngToLayerPoint(t), this._radius = Math.max(this._point.x - n.x, 1)
                },
                getBounds: function() {
                    var e = this._getLngRadius(),
                        t = this._mRadius / 40075017 * 360,
                        n = this._latlng;
                    return new i.LatLngBounds([n.lat - t, n.lng - e], [n.lat + t, n.lng + e])
                },
                getLatLng: function() {
                    return this._latlng
                },
                getPathString: function() {
                    var e = this._point,
                        t = this._radius;
                    return this._checkIfEmpty() ? "" : i.Browser.svg ? "M" + e.x + "," + (e.y - t) + "A" + t + "," + t + ",0,1,1," + (e.x - .1) + "," + (e.y - t) + " z" : (e._round(), t = Math.round(t), "AL " + e.x + "," + e.y + " " + t + "," + t + " 0," + 23592600)
                },
                getRadius: function() {
                    return this._mRadius
                },
                _getLatRadius: function() {
                    return this._mRadius / 40075017 * 360
                },
                _getLngRadius: function() {
                    return this._getLatRadius() / Math.cos(i.LatLng.DEG_TO_RAD * this._latlng.lat)
                },
                _checkIfEmpty: function() {
                    if (!this._map) return !1;
                    var e = this._map._pathViewport,
                        t = this._radius,
                        n = this._point;
                    return n.x - t > e.max.x || n.y - t > e.max.y || n.x + t < e.min.x || n.y + t < e.min.y
                }
            }), i.circle = function(e, t, n) {
                return new i.Circle(e, t, n)
            }, i.CircleMarker = i.Circle.extend({
                options: {
                    radius: 10,
                    weight: 2
                },
                initialize: function(e, t) {
                    i.Circle.prototype.initialize.call(this, e, null, t), this._radius = this.options.radius
                },
                projectLatlngs: function() {
                    this._point = this._map.latLngToLayerPoint(this._latlng)
                },
                _updateStyle: function() {
                    i.Circle.prototype._updateStyle.call(this), this.setRadius(this.options.radius)
                },
                setLatLng: function(e) {
                    return i.Circle.prototype.setLatLng.call(this, e), this._popup && this._popup._isOpen && this._popup.setLatLng(e), this
                },
                setRadius: function(e) {
                    return this.options.radius = this._radius = e, this.redraw()
                },
                getRadius: function() {
                    return this._radius
                }
            }), i.circleMarker = function(e, t) {
                return new i.CircleMarker(e, t)
            }, i.Polyline.include(i.Path.CANVAS ? {
                _containsPoint: function(e, t) {
                    var n, r, s, o, u, a, f, l = this.options.weight / 2;
                    i.Browser.touch && (l += 10);
                    for (n = 0, o = this._parts.length; n < o; n++) {
                        f = this._parts[n];
                        for (r = 0, u = f.length, s = u - 1; r < u; s = r++) {
                            if (!t && r === 0) continue;
                            a = i.LineUtil.pointToSegmentDistance(e, f[s], f[r]);
                            if (a <= l) return !0
                        }
                    }
                    return !1
                }
            } : {}), i.Polygon.include(i.Path.CANVAS ? {
                _containsPoint: function(e) {
                    var t = !1,
                        n, r, s, o, u, a, f, l;
                    if (i.Polyline.prototype._containsPoint.call(this, e, !0)) return !0;
                    for (o = 0, f = this._parts.length; o < f; o++) {
                        n = this._parts[o];
                        for (u = 0, l = n.length, a = l - 1; u < l; a = u++) r = n[u], s = n[a], r.y > e.y != s.y > e.y && e.x < (s.x - r.x) * (e.y - r.y) / (s.y - r.y) + r.x && (t = !t)
                    }
                    return t
                }
            } : {}), i.Circle.include(i.Path.CANVAS ? {
                _drawPath: function() {
                    var e = this._point;
                    this._ctx.beginPath(), this._ctx.arc(e.x, e.y, this._radius, 0, Math.PI * 2, !1)
                },
                _containsPoint: function(e) {
                    var t = this._point,
                        n = this.options.stroke ? this.options.weight / 2 : 0;
                    return e.distanceTo(t) <= this._radius + n
                }
            } : {}), i.CircleMarker.include(i.Path.CANVAS ? {
                _updateStyle: function() {
                    i.Path.prototype._updateStyle.call(this)
                }
            } : {}), i.GeoJSON = i.FeatureGroup.extend({
                initialize: function(e, t) {
                    i.setOptions(this, t), this._layers = {}, e && this.addData(e)
                },
                addData: function(e) {
                    var t = i.Util.isArray(e) ? e : e.features,
                        n, r, s;
                    if (t) {
                        for (n = 0, r = t.length; n < r; n++) s = t[n], (s.geometries || s.geometry || s.features || s.coordinates) && this.addData(t[n]);
                        return this
                    }
                    var o = this.options;
                    if (o.filter && !o.filter(e)) return;
                    var u = i.GeoJSON.geometryToLayer(e, o.pointToLayer, o.coordsToLatLng, o);
                    return u.feature = i.GeoJSON.asFeature(e), u.defaultOptions = u.options, this.resetStyle(u), o.onEachFeature && o.onEachFeature(e, u), this.addLayer(u)
                },
                resetStyle: function(e) {
                    var t = this.options.style;
                    t && (i.Util.extend(e.options, e.defaultOptions), this._setLayerStyle(e, t))
                },
                setStyle: function(e) {
                    this.eachLayer(function(t) {
                        this._setLayerStyle(t, e)
                    }, this)
                },
                _setLayerStyle: function(e, t) {
                    typeof t == "function" && (t = t(e.feature)), e.setStyle && e.setStyle(t)
                }
            }), i.extend(i.GeoJSON, {
                geometryToLayer: function(e, t, n, r) {
                    var s = e.type === "Feature" ? e.geometry : e,
                        o = s.coordinates,
                        u = [],
                        a, f, l, c;
                    n = n || this.coordsToLatLng;
                    switch (s.type) {
                        case "Point":
                            return a = n(o), t ? t(e, a) : new i.Marker(a);
                        case "MultiPoint":
                            for (l = 0, c = o.length; l < c; l++) a = n(o[l]), u.push(t ? t(e, a) : new i.Marker(a));
                            return new i.FeatureGroup(u);
                        case "LineString":
                            return f = this.coordsToLatLngs(o, 0, n), new i.Polyline(f, r);
                        case "Polygon":
                            if (o.length === 2 && !o[1].length) throw new Error("Invalid GeoJSON object.");
                            return f = this.coordsToLatLngs(o, 1, n), new i.Polygon(f, r);
                        case "MultiLineString":
                            return f = this.coordsToLatLngs(o, 1, n), new i.MultiPolyline(f, r);
                        case "MultiPolygon":
                            return f = this.coordsToLatLngs(o, 2, n), new i.MultiPolygon(f, r);
                        case "GeometryCollection":
                            for (l = 0, c = s.geometries.length; l < c; l++) u.push(this.geometryToLayer({
                                geometry: s.geometries[l],
                                type: "Feature",
                                properties: e.properties
                            }, t, n, r));
                            return new i.FeatureGroup(u);
                        default:
                            throw new Error("Invalid GeoJSON object.")
                    }
                },
                coordsToLatLng: function(e) {
                    return new i.LatLng(e[1], e[0], e[2])
                },
                coordsToLatLngs: function(e, t, n) {
                    var r, i, s, o = [];
                    for (i = 0, s = e.length; i < s; i++) r = t ? this.coordsToLatLngs(e[i], t - 1, n) : (n || this.coordsToLatLng)(e[i]), o.push(r);
                    return o
                },
                latLngToCoords: function(e) {
                    var t = [e.lng, e.lat];
                    return e.alt !== n && t.push(e.alt), t
                },
                latLngsToCoords: function(e) {
                    var t = [];
                    for (var n = 0, r = e.length; n < r; n++) t.push(i.GeoJSON.latLngToCoords(e[n]));
                    return t
                },
                getFeature: function(e, t) {
                    return e.feature ? i.extend({}, e.feature, {
                        geometry: t
                    }) : i.GeoJSON.asFeature(t)
                },
                asFeature: function(e) {
                    return e.type === "Feature" ? e : {
                        type: "Feature",
                        properties: {},
                        geometry: e
                    }
                }
            });
        var o = {
            toGeoJSON: function() {
                return i.GeoJSON.getFeature(this, {
                    type: "Point",
                    coordinates: i.GeoJSON.latLngToCoords(this.getLatLng())
                })
            }
        };
        i.Marker.include(o), i.Circle.include(o), i.CircleMarker.include(o), i.Polyline.include({
                toGeoJSON: function() {
                    return i.GeoJSON.getFeature(this, {
                        type: "LineString",
                        coordinates: i.GeoJSON.latLngsToCoords(this.getLatLngs())
                    })
                }
            }), i.Polygon.include({
                toGeoJSON: function() {
                    var e = [i.GeoJSON.latLngsToCoords(this.getLatLngs())],
                        t, n, r;
                    e[0].push(e[0][0]);
                    if (this._holes)
                        for (t = 0, n = this._holes.length; t < n; t++) r = i.GeoJSON.latLngsToCoords(this._holes[t]), r.push(r[0]), e.push(r);
                    return i.GeoJSON.getFeature(this, {
                        type: "Polygon",
                        coordinates: e
                    })
                }
            }),
            function() {
                function e(e) {
                    return function() {
                        var t = [];
                        return this.eachLayer(function(e) {
                            t.push(e.toGeoJSON().geometry.coordinates)
                        }), i.GeoJSON.getFeature(this, {
                            type: e,
                            coordinates: t
                        })
                    }
                }
                i.MultiPolyline.include({
                    toGeoJSON: e("MultiLineString")
                }), i.MultiPolygon.include({
                    toGeoJSON: e("MultiPolygon")
                }), i.LayerGroup.include({
                    toGeoJSON: function() {
                        var t = this.feature && this.feature.geometry,
                            n = [],
                            r;
                        if (t && t.type === "MultiPoint") return e("MultiPoint").call(this);
                        var s = t && t.type === "GeometryCollection";
                        return this.eachLayer(function(e) {
                            e.toGeoJSON && (r = e.toGeoJSON(), n.push(s ? r.geometry : i.GeoJSON.asFeature(r)))
                        }), s ? i.GeoJSON.getFeature(this, {
                            geometries: n,
                            type: "GeometryCollection"
                        }) : {
                            type: "FeatureCollection",
                            features: n
                        }
                    }
                })
            }(), i.geoJson = function(e, t) {
                return new i.GeoJSON(e, t)
            }, i.DomEvent = {
                addListener: function(e, t, n, r) {
                    var s = i.stamp(n),
                        o = "_leaflet_" + t + s,
                        u, a, f;
                    return e[o] ? this : (u = function(t) {
                        return n.call(r || e, t || i.DomEvent._getEvent())
                    }, i.Browser.pointer && t.indexOf("touch") === 0 ? this.addPointerListener(e, t, u, s) : (i.Browser.touch && t === "dblclick" && this.addDoubleTapListener && this.addDoubleTapListener(e, u, s), "addEventListener" in e ? t === "mousewheel" ? (e.addEventListener("DOMMouseScroll", u, !1), e.addEventListener(t, u, !1)) : t === "mouseenter" || t === "mouseleave" ? (a = u, f = t === "mouseenter" ? "mouseover" : "mouseout", u = function(t) {
                        if (!i.DomEvent._checkMouse(e, t)) return;
                        return a(t)
                    }, e.addEventListener(f, u, !1)) : t === "click" && i.Browser.android ? (a = u, u = function(e) {
                        return i.DomEvent._filterClick(e, a)
                    }, e.addEventListener(t, u, !1)) : e.addEventListener(t, u, !1) : "attachEvent" in e && e.attachEvent("on" + t, u), e[o] = u, this))
                },
                removeListener: function(e, t, n) {
                    var r = i.stamp(n),
                        s = "_leaflet_" + t + r,
                        o = e[s];
                    return o ? (i.Browser.pointer && t.indexOf("touch") === 0 ? this.removePointerListener(e, t, r) : i.Browser.touch && t === "dblclick" && this.removeDoubleTapListener ? this.removeDoubleTapListener(e, r) : "removeEventListener" in e ? t === "mousewheel" ? (e.removeEventListener("DOMMouseScroll", o, !1), e.removeEventListener(t, o, !1)) : t === "mouseenter" || t === "mouseleave" ? e.removeEventListener(t === "mouseenter" ? "mouseover" : "mouseout", o, !1) : e.removeEventListener(t, o, !1) : "detachEvent" in e && e.detachEvent("on" + t, o), e[s] = null, this) : this
                },
                stopPropagation: function(e) {
                    return e.stopPropagation ? e.stopPropagation() : e.cancelBubble = !0, i.DomEvent._skipped(e), this
                },
                disableScrollPropagation: function(e) {
                    var t = i.DomEvent.stopPropagation;
                    return i.DomEvent.on(e, "mousewheel", t).on(e, "MozMousePixelScroll", t)
                },
                disableClickPropagation: function(e) {
                    var t = i.DomEvent.stopPropagation;
                    for (var n = i.Draggable.START.length - 1; n >= 0; n--) i.DomEvent.on(e, i.Draggable.START[n], t);
                    return i.DomEvent.on(e, "click", i.DomEvent._fakeStop).on(e, "dblclick", t)
                },
                preventDefault: function(e) {
                    return e.preventDefault ? e.preventDefault() : e.returnValue = !1, this
                },
                stop: function(e) {
                    return i.DomEvent.preventDefault(e).stopPropagation(e)
                },
                getMousePosition: function(e, t) {
                    if (!t) return new i.Point(e.clientX, e.clientY);
                    var n = t.getBoundingClientRect();
                    return new i.Point(e.clientX - n.left - t.clientLeft, e.clientY - n.top - t.clientTop)
                },
                getWheelDelta: function(e) {
                    var t = 0;
                    return e.wheelDelta && (t = e.wheelDelta / 120), e.detail && (t = -e.detail / 3), t
                },
                _skipEvents: {},
                _fakeStop: function(e) {
                    i.DomEvent._skipEvents[e.type] = !0
                },
                _skipped: function(e) {
                    var t = this._skipEvents[e.type];
                    return this._skipEvents[e.type] = !1, t
                },
                _checkMouse: function(e, t) {
                    var n = t.relatedTarget;
                    if (!n) return !0;
                    try {
                        while (n && n !== e) n = n.parentNode
                    } catch (r) {
                        return !1
                    }
                    return n !== e
                },
                _getEvent: function() {
                    var t = e.event;
                    if (!t) {
                        var n = arguments.callee.caller;
                        while (n) {
                            t = n.arguments[0];
                            if (t && e.Event === t.constructor) break;
                            n = n.caller
                        }
                    }
                    return t
                },
                _filterClick: function(e, t) {
                    var n = e.timeStamp || e.originalEvent.timeStamp,
                        r = i.DomEvent._lastClick && n - i.DomEvent._lastClick;
                    if (r && r > 100 && r < 500 || e.target._simulatedClick && !e._simulated) {
                        i.DomEvent.stop(e);
                        return
                    }
                    return i.DomEvent._lastClick = n, t(e)
                }
            }, i.DomEvent.on = i.DomEvent.addListener, i.DomEvent.off = i.DomEvent.removeListener, i.Draggable = i.Class.extend({
                includes: i.Mixin.Events,
                statics: {
                    START: i.Browser.touch ? ["touchstart", "mousedown"] : ["mousedown"],
                    END: {
                        mousedown: "mouseup",
                        touchstart: "touchend",
                        pointerdown: "touchend",
                        MSPointerDown: "touchend"
                    },
                    MOVE: {
                        mousedown: "mousemove",
                        touchstart: "touchmove",
                        pointerdown: "touchmove",
                        MSPointerDown: "touchmove"
                    }
                },
                initialize: function(e, t) {
                    this._element = e, this._dragStartTarget = t || e
                },
                enable: function() {
                    if (this._enabled) return;
                    for (var e = i.Draggable.START.length - 1; e >= 0; e--) i.DomEvent.on(this._dragStartTarget, i.Draggable.START[e], this._onDown, this);
                    this._enabled = !0
                },
                disable: function() {
                    if (!this._enabled) return;
                    for (var e = i.Draggable.START.length - 1; e >= 0; e--) i.DomEvent.off(this._dragStartTarget, i.Draggable.START[e], this._onDown, this);
                    this._enabled = !1, this._moved = !1
                },
                _onDown: function(e) {
                    this._moved = !1;
                    if (e.shiftKey || e.which !== 1 && e.button !== 1 && !e.touches) return;
                    i.DomEvent.stopPropagation(e);
                    if (i.Draggable._disabled) return;
                    i.DomUtil.disableImageDrag(), i.DomUtil.disableTextSelection();
                    if (this._moving) return;
                    var n = e.touches ? e.touches[0] : e;
                    this._startPoint = new i.Point(n.clientX, n.clientY), this._startPos = this._newPos = i.DomUtil.getPosition(this._element), i.DomEvent.on(t, i.Draggable.MOVE[e.type], this._onMove, this).on(t, i.Draggable.END[e.type], this._onUp, this)
                },
                _onMove: function(e) {
                    if (e.touches && e.touches.length > 1) {
                        this._moved = !0;
                        return
                    }
                    var n = e.touches && e.touches.length === 1 ? e.touches[0] : e,
                        r = new i.Point(n.clientX, n.clientY),
                        s = r.subtract(this._startPoint);
                    if (!s.x && !s.y) return;
                    if (i.Browser.touch && Math.abs(s.x) + Math.abs(s.y) < 3) return;
                    i.DomEvent.preventDefault(e), this._moved || (this.fire("dragstart"), this._moved = !0, this._startPos = i.DomUtil.getPosition(this._element).subtract(s), i.DomUtil.addClass(t.body, "leaflet-dragging"), this._lastTarget = e.target || e.srcElement, i.DomUtil.addClass(this._lastTarget, "leaflet-drag-target")), this._newPos = this._startPos.add(s), this._moving = !0, i.Util.cancelAnimFrame(this._animRequest), this._animRequest = i.Util.requestAnimFrame(this._updatePosition, this, !0, this._dragStartTarget)
                },
                _updatePosition: function() {
                    this.fire("predrag"), i.DomUtil.setPosition(this._element, this._newPos), this.fire("drag")
                },
                _onUp: function() {
                    i.DomUtil.removeClass(t.body, "leaflet-dragging"), this._lastTarget && (i.DomUtil.removeClass(this._lastTarget, "leaflet-drag-target"), this._lastTarget = null);
                    for (var e in i.Draggable.MOVE) i.DomEvent.off(t, i.Draggable.MOVE[e], this._onMove).off(t, i.Draggable.END[e], this._onUp);
                    i.DomUtil.enableImageDrag(), i.DomUtil.enableTextSelection(), this._moved && this._moving && (i.Util.cancelAnimFrame(this._animRequest), this.fire("dragend", {
                        distance: this._newPos.distanceTo(this._startPos)
                    })), this._moving = !1
                }
            }), i.Handler = i.Class.extend({
                initialize: function(e) {
                    this._map = e
                },
                enable: function() {
                    if (this._enabled) return;
                    this._enabled = !0, this.addHooks()
                },
                disable: function() {
                    if (!this._enabled) return;
                    this._enabled = !1, this.removeHooks()
                },
                enabled: function() {
                    return !!this._enabled
                }
            }), i.Map.mergeOptions({
                dragging: !0,
                inertia: !i.Browser.android23,
                inertiaDeceleration: 3400,
                inertiaMaxSpeed: Infinity,
                inertiaThreshold: i.Browser.touch ? 32 : 18,
                easeLinearity: .25,
                worldCopyJump: !1
            }), i.Map.Drag = i.Handler.extend({
                addHooks: function() {
                    if (!this._draggable) {
                        var e = this._map;
                        this._draggable = new i.Draggable(e._mapPane, e._container), this._draggable.on({
                            dragstart: this._onDragStart,
                            drag: this._onDrag,
                            dragend: this._onDragEnd
                        }, this), e.options.worldCopyJump && (this._draggable.on("predrag", this._onPreDrag, this), e.on("viewreset", this._onViewReset, this), e.whenReady(this._onViewReset, this))
                    }
                    this._draggable.enable()
                },
                removeHooks: function() {
                    this._draggable.disable()
                },
                moved: function() {
                    return this._draggable && this._draggable._moved
                },
                _onDragStart: function() {
                    var e = this._map;
                    e._panAnim && e._panAnim.stop(), e.fire("movestart").fire("dragstart"), e.options.inertia && (this._positions = [], this._times = [])
                },
                _onDrag: function() {
                    if (this._map.options.inertia) {
                        var e = this._lastTime = +(new Date),
                            t = this._lastPos = this._draggable._newPos;
                        this._positions.push(t), this._times.push(e), e - this._times[0] > 200 && (this._positions.shift(), this._times.shift())
                    }
                    this._map.fire("move").fire("drag")
                },
                _onViewReset: function() {
                    var e = this._map.getSize()._divideBy(2),
                        t = this._map.latLngToLayerPoint([0, 0]);
                    this._initialWorldOffset = t.subtract(e).x, this._worldWidth = this._map.project([0, 180]).x
                },
                _onPreDrag: function() {
                    var e = this._worldWidth,
                        t = Math.round(e / 2),
                        n = this._initialWorldOffset,
                        r = this._draggable._newPos.x,
                        i = (r - t + n) % e + t - n,
                        s = (r + t + n) % e - t - n,
                        o = Math.abs(i + n) < Math.abs(s + n) ? i : s;
                    this._draggable._newPos.x = o
                },
                _onDragEnd: function(e) {
                    var t = this._map,
                        n = t.options,
                        r = +(new Date) - this._lastTime,
                        s = !n.inertia || r > n.inertiaThreshold || !this._positions[0];
                    t.fire("dragend", e);
                    if (s) t.fire("moveend");
                    else {
                        var o = this._lastPos.subtract(this._positions[0]),
                            u = (this._lastTime + r - this._times[0]) / 1e3,
                            a = n.easeLinearity,
                            f = o.multiplyBy(a / u),
                            l = f.distanceTo([0, 0]),
                            c = Math.min(n.inertiaMaxSpeed, l),
                            h = f.multiplyBy(c / l),
                            p = c / (n.inertiaDeceleration * a),
                            d = h.multiplyBy(-p / 2).round();
                        !d.x || !d.y ? t.fire("moveend") : (d = t._limitOffset(d, t.options.maxBounds), i.Util.requestAnimFrame(function() {
                            t.panBy(d, {
                                duration: p,
                                easeLinearity: a,
                                noMoveStart: !0
                            })
                        }))
                    }
                }
            }), i.Map.addInitHook("addHandler", "dragging", i.Map.Drag), i.Map.mergeOptions({
                doubleClickZoom: !0
            }), i.Map.DoubleClickZoom = i.Handler.extend({
                addHooks: function() {
                    this._map.on("dblclick", this._onDoubleClick, this)
                },
                removeHooks: function() {
                    this._map.off("dblclick", this._onDoubleClick, this)
                },
                _onDoubleClick: function(e) {
                    var t = this._map,
                        n = t.getZoom() + (e.originalEvent.shiftKey ? -1 : 1);
                    t.options.doubleClickZoom === "center" ? t.setZoom(n) : t.setZoomAround(e.containerPoint, n)
                }
            }), i.Map.addInitHook("addHandler", "doubleClickZoom", i.Map.DoubleClickZoom), i.Map.mergeOptions({
                scrollWheelZoom: !0
            }), i.Map.ScrollWheelZoom = i.Handler.extend({
                addHooks: function() {
                    i.DomEvent.on(this._map._container, "mousewheel", this._onWheelScroll, this), i.DomEvent.on(this._map._container, "MozMousePixelScroll", i.DomEvent.preventDefault), this._delta = 0
                },
                removeHooks: function() {
                    i.DomEvent.off(this._map._container, "mousewheel", this._onWheelScroll), i.DomEvent.off(this._map._container, "MozMousePixelScroll", i.DomEvent.preventDefault)
                },
                _onWheelScroll: function(e) {
                    var t = i.DomEvent.getWheelDelta(e);
                    this._delta += t, this._lastMousePos = this._map.mouseEventToContainerPoint(e), this._startTime || (this._startTime = +(new Date));
                    var n = Math.max(40 - (+(new Date) - this._startTime), 0);
                    clearTimeout(this._timer), this._timer = setTimeout(i.bind(this._performZoom, this), n), i.DomEvent.preventDefault(e), i.DomEvent.stopPropagation(e)
                },
                _performZoom: function() {
                    var e = this._map,
                        t = this._delta,
                        n = e.getZoom();
                    t = t > 0 ? Math.ceil(t) : Math.floor(t), t = Math.max(Math.min(t, 4), -4), t = e._limitZoom(n + t) - n, this._delta = 0, this._startTime = null;
                    if (!t) return;
                    e.options.scrollWheelZoom === "center" ? e.setZoom(n + t) : e.setZoomAround(this._lastMousePos, n + t)
                }
            }), i.Map.addInitHook("addHandler", "scrollWheelZoom", i.Map.ScrollWheelZoom), i.extend(i.DomEvent, {
                _touchstart: i.Browser.msPointer ? "MSPointerDown" : i.Browser.pointer ? "pointerdown" : "touchstart",
                _touchend: i.Browser.msPointer ? "MSPointerUp" : i.Browser.pointer ? "pointerup" : "touchend",
                addDoubleTapListener: function(e, n, r) {
                    function p(e) {
                        var t;
                        i.Browser.pointer ? (h.push(e.pointerId), t = h.length) : t = e.touches.length;
                        if (t > 1) return;
                        var n = Date.now(),
                            r = n - (s || n);
                        a = e.touches ? e.touches[0] : e, o = r > 0 && r <= u, s = n
                    }

                    function d(e) {
                        if (i.Browser.pointer) {
                            var t = h.indexOf(e.pointerId);
                            if (t === -1) return;
                            h.splice(t, 1)
                        }
                        if (o) {
                            if (i.Browser.pointer) {
                                var r = {},
                                    u;
                                for (var f in a) u = a[f], typeof u == "function" ? r[f] = u.bind(a) : r[f] = u;
                                a = r
                            }
                            a.type = "dblclick", n(a), s = null
                        }
                    }
                    var s, o = !1,
                        u = 250,
                        a, f = "_leaflet_",
                        l = this._touchstart,
                        c = this._touchend,
                        h = [];
                    e[f + l + r] = p, e[f + c + r] = d;
                    var v = i.Browser.pointer ? t.documentElement : e;
                    return e.addEventListener(l, p, !1), v.addEventListener(c, d, !1), i.Browser.pointer && v.addEventListener(i.DomEvent.POINTER_CANCEL, d, !1), this
                },
                removeDoubleTapListener: function(e, n) {
                    var r = "_leaflet_";
                    return e.removeEventListener(this._touchstart, e[r + this._touchstart + n], !1), (i.Browser.pointer ? t.documentElement : e).removeEventListener(this._touchend, e[r + this._touchend + n], !1), i.Browser.pointer && t.documentElement.removeEventListener(i.DomEvent.POINTER_CANCEL, e[r + this._touchend + n], !1), this
                }
            }), i.extend(i.DomEvent, {
                POINTER_DOWN: i.Browser.msPointer ? "MSPointerDown" : "pointerdown",
                POINTER_MOVE: i.Browser.msPointer ? "MSPointerMove" : "pointermove",
                POINTER_UP: i.Browser.msPointer ? "MSPointerUp" : "pointerup",
                POINTER_CANCEL: i.Browser.msPointer ? "MSPointerCancel" : "pointercancel",
                _pointers: [],
                _pointerDocumentListener: !1,
                addPointerListener: function(e, t, n, r) {
                    switch (t) {
                        case "touchstart":
                            return this.addPointerListenerStart(e, t, n, r);
                        case "touchend":
                            return this.addPointerListenerEnd(e, t, n, r);
                        case "touchmove":
                            return this.addPointerListenerMove(e, t, n, r);
                        default:
                            throw "Unknown touch event type"
                    }
                },
                addPointerListenerStart: function(e, n, r, s) {
                    var o = "_leaflet_",
                        u = this._pointers,
                        a = function(e) {
                            e.pointerType !== "mouse" && e.pointerType !== e.MSPOINTER_TYPE_MOUSE && i.DomEvent.preventDefault(e);
                            var t = !1;
                            for (var n = 0; n < u.length; n++)
                                if (u[n].pointerId === e.pointerId) {
                                    t = !0;
                                    break
                                }
                            t || u.push(e), e.touches = u.slice(), e.changedTouches = [e], r(e)
                        };
                    e[o + "touchstart" + s] = a, e.addEventListener(this.POINTER_DOWN, a, !1);
                    if (!this._pointerDocumentListener) {
                        var f = function(e) {
                            for (var t = 0; t < u.length; t++)
                                if (u[t].pointerId === e.pointerId) {
                                    u.splice(t, 1);
                                    break
                                }
                        };
                        t.documentElement.addEventListener(this.POINTER_UP, f, !1), t.documentElement.addEventListener(this.POINTER_CANCEL, f, !1), this._pointerDocumentListener = !0
                    }
                    return this
                },
                addPointerListenerMove: function(e, t, n, r) {
                    function o(e) {
                        if ((e.pointerType === e.MSPOINTER_TYPE_MOUSE || e.pointerType === "mouse") && e.buttons === 0) return;
                        for (var t = 0; t < s.length; t++)
                            if (s[t].pointerId === e.pointerId) {
                                s[t] = e;
                                break
                            }
                        e.touches = s.slice(), e.changedTouches = [e], n(e)
                    }
                    var i = "_leaflet_",
                        s = this._pointers;
                    return e[i + "touchmove" + r] = o, e.addEventListener(this.POINTER_MOVE, o, !1), this
                },
                addPointerListenerEnd: function(e, t, n, r) {
                    var i = "_leaflet_",
                        s = this._pointers,
                        o = function(e) {
                            for (var t = 0; t < s.length; t++)
                                if (s[t].pointerId === e.pointerId) {
                                    s.splice(t, 1);
                                    break
                                }
                            e.touches = s.slice(), e.changedTouches = [e], n(e)
                        };
                    return e[i + "touchend" + r] = o, e.addEventListener(this.POINTER_UP, o, !1), e.addEventListener(this.POINTER_CANCEL, o, !1), this
                },
                removePointerListener: function(e, t, n) {
                    var r = "_leaflet_",
                        i = e[r + t + n];
                    switch (t) {
                        case "touchstart":
                            e.removeEventListener(this.POINTER_DOWN, i, !1);
                            break;
                        case "touchmove":
                            e.removeEventListener(this.POINTER_MOVE, i, !1);
                            break;
                        case "touchend":
                            e.removeEventListener(this.POINTER_UP, i, !1), e.removeEventListener(this.POINTER_CANCEL, i, !1)
                    }
                    return this
                }
            }), i.Map.mergeOptions({
                touchZoom: i.Browser.touch && !i.Browser.android23,
                bounceAtZoomLimits: !0
            }), i.Map.TouchZoom = i.Handler.extend({
                addHooks: function() {
                    i.DomEvent.on(this._map._container, "touchstart", this._onTouchStart, this)
                },
                removeHooks: function() {
                    i.DomEvent.off(this._map._container, "touchstart", this._onTouchStart, this)
                },
                _onTouchStart: function(e) {
                    var n = this._map;
                    if (!e.touches || e.touches.length !== 2 || n._animatingZoom || this._zooming) return;
                    var r = n.mouseEventToLayerPoint(e.touches[0]),
                        s = n.mouseEventToLayerPoint(e.touches[1]),
                        o = n._getCenterLayerPoint();
                    this._startCenter = r.add(s)._divideBy(2), this._startDist = r.distanceTo(s), this._moved = !1, this._zooming = !0, this._centerOffset = o.subtract(this._startCenter), n._panAnim && n._panAnim.stop(), i.DomEvent.on(t, "touchmove", this._onTouchMove, this).on(t, "touchend", this._onTouchEnd, this), i.DomEvent.preventDefault(e)
                },
                _onTouchMove: function(e) {
                    var t = this._map;
                    if (!e.touches || e.touches.length !== 2 || !this._zooming) return;
                    var n = t.mouseEventToLayerPoint(e.touches[0]),
                        r = t.mouseEventToLayerPoint(e.touches[1]);
                    this._scale = n.distanceTo(r) / this._startDist, this._delta = n._add(r)._divideBy(2)._subtract(this._startCenter);
                    if (this._scale === 1) return;
                    if (!t.options.bounceAtZoomLimits)
                        if (t.getZoom() === t.getMinZoom() && this._scale < 1 || t.getZoom() === t.getMaxZoom() && this._scale > 1) return;
                    this._moved || (i.DomUtil.addClass(t._mapPane, "leaflet-touching"), t.fire("movestart").fire("zoomstart"), this._moved = !0), i.Util.cancelAnimFrame(this._animRequest), this._animRequest = i.Util.requestAnimFrame(this._updateOnMove, this, !0, this._map._container), i.DomEvent.preventDefault(e)
                },
                _updateOnMove: function() {
                    var e = this._map,
                        t = this._getScaleOrigin(),
                        n = e.layerPointToLatLng(t),
                        r = e.getScaleZoom(this._scale);
                    e._animateZoom(n, r, this._startCenter, this._scale, this._delta, !1, !0)
                },
                _onTouchEnd: function() {
                    if (!this._moved || !this._zooming) {
                        this._zooming = !1;
                        return
                    }
                    var e = this._map;
                    this._zooming = !1, i.DomUtil.removeClass(e._mapPane, "leaflet-touching"), i.Util.cancelAnimFrame(this._animRequest), i.DomEvent.off(t, "touchmove", this._onTouchMove).off(t, "touchend", this._onTouchEnd);
                    var n = this._getScaleOrigin(),
                        r = e.layerPointToLatLng(n),
                        s = e.getZoom(),
                        o = e.getScaleZoom(this._scale) - s,
                        u = o > 0 ? Math.ceil(o) : Math.floor(o),
                        a = e._limitZoom(s + u),
                        f = e.getZoomScale(a) / this._scale;
                    e._animateZoom(r, a, n, f)
                },
                _getScaleOrigin: function() {
                    var e = this._centerOffset.subtract(this._delta).divideBy(this._scale);
                    return this._startCenter.add(e)
                }
            }), i.Map.addInitHook("addHandler", "touchZoom", i.Map.TouchZoom), i.Map.mergeOptions({
                tap: !0,
                tapTolerance: 15
            }), i.Map.Tap = i.Handler.extend({
                addHooks: function() {
                    i.DomEvent.on(this._map._container, "touchstart", this._onDown, this)
                },
                removeHooks: function() {
                    i.DomEvent.off(this._map._container, "touchstart", this._onDown, this)
                },
                _onDown: function(e) {
                    if (!e.touches) return;
                    i.DomEvent.preventDefault(e), this._fireClick = !0;
                    if (e.touches.length > 1) {
                        this._fireClick = !1, clearTimeout(this._holdTimeout);
                        return
                    }
                    var n = e.touches[0],
                        r = n.target;
                    this._startPos = this._newPos = new i.Point(n.clientX, n.clientY), r.tagName && r.tagName.toLowerCase() === "a" && i.DomUtil.addClass(r, "leaflet-active"), this._holdTimeout = setTimeout(i.bind(function() {
                        this._isTapValid() && (this._fireClick = !1, this._onUp(), this._simulateEvent("contextmenu", n))
                    }, this), 1e3), i.DomEvent.on(t, "touchmove", this._onMove, this).on(t, "touchend", this._onUp, this)
                },
                _onUp: function(e) {
                    clearTimeout(this._holdTimeout), i.DomEvent.off(t, "touchmove", this._onMove, this).off(t, "touchend", this._onUp, this);
                    if (this._fireClick && e && e.changedTouches) {
                        var n = e.changedTouches[0],
                            r = n.target;
                        r && r.tagName && r.tagName.toLowerCase() === "a" && i.DomUtil.removeClass(r, "leaflet-active"), this._isTapValid() && this._simulateEvent("click", n)
                    }
                },
                _isTapValid: function() {
                    return this._newPos.distanceTo(this._startPos) <= this._map.options.tapTolerance
                },
                _onMove: function(e) {
                    var t = e.touches[0];
                    this._newPos = new i.Point(t.clientX, t.clientY)
                },
                _simulateEvent: function(n, r) {
                    var i = t.createEvent("MouseEvents");
                    i._simulated = !0, r.target._simulatedClick = !0, i.initMouseEvent(n, !0, !0, e, 1, r.screenX, r.screenY, r.clientX, r.clientY, !1, !1, !1, !1, 0, null), r.target.dispatchEvent(i)
                }
            }), i.Browser.touch && !i.Browser.pointer && i.Map.addInitHook("addHandler", "tap", i.Map.Tap), i.Map.mergeOptions({
                boxZoom: !0
            }), i.Map.BoxZoom = i.Handler.extend({
                initialize: function(e) {
                    this._map = e, this._container = e._container, this._pane = e._panes.overlayPane, this._moved = !1
                },
                addHooks: function() {
                    i.DomEvent.on(this._container, "mousedown", this._onMouseDown, this)
                },
                removeHooks: function() {
                    i.DomEvent.off(this._container, "mousedown", this._onMouseDown), this._moved = !1
                },
                moved: function() {
                    return this._moved
                },
                _onMouseDown: function(e) {
                    this._moved = !1;
                    if (!e.shiftKey || e.which !== 1 && e.button !== 1) return !1;
                    i.DomUtil.disableTextSelection(), i.DomUtil.disableImageDrag(), this._startLayerPoint = this._map.mouseEventToLayerPoint(e), i.DomEvent.on(t, "mousemove", this._onMouseMove, this).on(t, "mouseup", this._onMouseUp, this).on(t, "keydown", this._onKeyDown, this)
                },
                _onMouseMove: function(e) {
                    this._moved || (this._box = i.DomUtil.create("div", "leaflet-zoom-box", this._pane), i.DomUtil.setPosition(this._box, this._startLayerPoint), this._container.style.cursor = "crosshair", this._map.fire("boxzoomstart"));
                    var t = this._startLayerPoint,
                        n = this._box,
                        r = this._map.mouseEventToLayerPoint(e),
                        s = r.subtract(t),
                        o = new i.Point(Math.min(r.x, t.x), Math.min(r.y, t.y));
                    i.DomUtil.setPosition(n, o), this._moved = !0, n.style.width = Math.max(0, Math.abs(s.x) - 4) + "px", n.style.height = Math.max(0, Math.abs(s.y) - 4) + "px"
                },
                _finish: function() {
                    this._moved && (this._pane.removeChild(this._box), this._container.style.cursor = ""), i.DomUtil.enableTextSelection(), i.DomUtil.enableImageDrag(), i.DomEvent.off(t, "mousemove", this._onMouseMove).off(t, "mouseup", this._onMouseUp).off(t, "keydown", this._onKeyDown)
                },
                _onMouseUp: function(e) {
                    this._finish();
                    var t = this._map,
                        n = t.mouseEventToLayerPoint(e);
                    if (this._startLayerPoint.equals(n)) return;
                    var r = new i.LatLngBounds(t.layerPointToLatLng(this._startLayerPoint), t.layerPointToLatLng(n));
                    t.fitBounds(r), t.fire("boxzoomend", {
                        boxZoomBounds: r
                    })
                },
                _onKeyDown: function(e) {
                    e.keyCode === 27 && this._finish()
                }
            }), i.Map.addInitHook("addHandler", "boxZoom", i.Map.BoxZoom), i.Map.mergeOptions({
                keyboard: !0,
                keyboardPanOffset: 80,
                keyboardZoomOffset: 1
            }), i.Map.Keyboard = i.Handler.extend({
                keyCodes: {
                    left: [37],
                    right: [39],
                    down: [40],
                    up: [38],
                    zoomIn: [187, 107, 61, 171],
                    zoomOut: [189, 109, 173]
                },
                initialize: function(e) {
                    this._map = e, this._setPanOffset(e.options.keyboardPanOffset), this._setZoomOffset(e.options.keyboardZoomOffset)
                },
                addHooks: function() {
                    var e = this._map._container;
                    e.tabIndex === -1 && (e.tabIndex = "0"), i.DomEvent.on(e, "focus", this._onFocus, this).on(e, "blur", this._onBlur, this).on(e, "mousedown", this._onMouseDown, this), this._map.on("focus", this._addHooks, this).on("blur", this._removeHooks, this)
                },
                removeHooks: function() {
                    this._removeHooks();
                    var e = this._map._container;
                    i.DomEvent.off(e, "focus", this._onFocus, this).off(e, "blur", this._onBlur, this).off(e, "mousedown", this._onMouseDown, this), this._map.off("focus", this._addHooks, this).off("blur", this._removeHooks, this)
                },
                _onMouseDown: function() {
                    if (this._focused) return;
                    var n = t.body,
                        r = t.documentElement,
                        i = n.scrollTop || r.scrollTop,
                        s = n.scrollLeft || r.scrollLeft;
                    this._map._container.focus(), e.scrollTo(s, i)
                },
                _onFocus: function() {
                    this._focused = !0, this._map.fire("focus")
                },
                _onBlur: function() {
                    this._focused = !1, this._map.fire("blur")
                },
                _setPanOffset: function(e) {
                    var t = this._panKeys = {},
                        n = this.keyCodes,
                        r, i;
                    for (r = 0, i = n.left.length; r < i; r++) t[n.left[r]] = [-1 * e, 0];
                    for (r = 0, i = n.right.length; r < i; r++) t[n.right[r]] = [e, 0];
                    for (r = 0, i = n.down.length; r < i; r++) t[n.down[r]] = [0, e];
                    for (r = 0, i = n.up.length; r < i; r++) t[n.up[r]] = [0, -1 * e]
                },
                _setZoomOffset: function(e) {
                    var t = this._zoomKeys = {},
                        n = this.keyCodes,
                        r, i;
                    for (r = 0, i = n.zoomIn.length; r < i; r++) t[n.zoomIn[r]] = e;
                    for (r = 0, i = n.zoomOut.length; r < i; r++) t[n.zoomOut[r]] = -e
                },
                _addHooks: function() {
                    i.DomEvent.on(t, "keydown", this._onKeyDown, this)
                },
                _removeHooks: function() {
                    i.DomEvent.off(t, "keydown", this._onKeyDown, this)
                },
                _onKeyDown: function(e) {
                    var t = e.keyCode,
                        n = this._map;
                    if (t in this._panKeys) {
                        if (n._panAnim && n._panAnim._inProgress) return;
                        n.panBy(this._panKeys[t]), n.options.maxBounds && n.panInsideBounds(n.options.maxBounds)
                    } else {
                        if (!(t in this._zoomKeys)) return;
                        n.setZoom(n.getZoom() + this._zoomKeys[t])
                    }
                    i.DomEvent.stop(e)
                }
            }), i.Map.addInitHook("addHandler", "keyboard", i.Map.Keyboard), i.Handler.MarkerDrag = i.Handler.extend({
                initialize: function(e) {
                    this._marker = e
                },
                addHooks: function() {
                    var e = this._marker._icon;
                    this._draggable || (this._draggable = new i.Draggable(e, e)), this._draggable.on("dragstart", this._onDragStart, this).on("drag", this._onDrag, this).on("dragend", this._onDragEnd, this), this._draggable.enable(), i.DomUtil.addClass(this._marker._icon, "leaflet-marker-draggable")
                },
                removeHooks: function() {
                    this._draggable.off("dragstart", this._onDragStart, this).off("drag", this._onDrag, this).off("dragend", this._onDragEnd, this), this._draggable.disable(), i.DomUtil.removeClass(this._marker._icon, "leaflet-marker-draggable")
                },
                moved: function() {
                    return this._draggable && this._draggable._moved
                },
                _onDragStart: function() {
                    this._marker.closePopup().fire("movestart").fire("dragstart")
                },
                _onDrag: function() {
                    var e = this._marker,
                        t = e._shadow,
                        n = i.DomUtil.getPosition(e._icon),
                        r = e._map.layerPointToLatLng(n);
                    t && i.DomUtil.setPosition(t, n), e._latlng = r, e.fire("move", {
                        latlng: r
                    }).fire("drag")
                },
                _onDragEnd: function(e) {
                    this._marker.fire("moveend").fire("dragend", e)
                }
            }), i.Control = i.Class.extend({
                options: {
                    position: "topright"
                },
                initialize: function(e) {
                    i.setOptions(this, e)
                },
                getPosition: function() {
                    return this.options.position
                },
                setPosition: function(e) {
                    var t = this._map;
                    return t && t.removeControl(this), this.options.position = e, t && t.addControl(this), this
                },
                getContainer: function() {
                    return this._container
                },
                addTo: function(e) {
                    this._map = e;
                    var t = this._container = this.onAdd(e),
                        n = this.getPosition(),
                        r = e._controlCorners[n];
                    return i.DomUtil.addClass(t, "leaflet-control"), n.indexOf("bottom") !== -1 ? r.insertBefore(t, r.firstChild) : r.appendChild(t), this
                },
                removeFrom: function(e) {
                    var t = this.getPosition(),
                        n = e._controlCorners[t];
                    return n.removeChild(this._container), this._map = null, this.onRemove && this.onRemove(e), this
                },
                _refocusOnMap: function() {
                    this._map && this._map.getContainer().focus()
                }
            }), i.control = function(e) {
                return new i.Control(e)
            }, i.Map.include({
                addControl: function(e) {
                    return e.addTo(this), this
                },
                removeControl: function(e) {
                    return e.removeFrom(this), this
                },
                _initControlPos: function() {
                    function r(r, s) {
                        var o = t + r + " " + t + s;
                        e[r + s] = i.DomUtil.create("div", o, n)
                    }
                    var e = this._controlCorners = {},
                        t = "leaflet-",
                        n = this._controlContainer = i.DomUtil.create("div", t + "control-container", this._container);
                    r("top", "left"), r("top", "right"), r("bottom", "left"), r("bottom", "right")
                },
                _clearControlPos: function() {
                    this._container.removeChild(this._controlContainer)
                }
            }), i.Control.Zoom = i.Control.extend({
                options: {
                    position: "topleft",
                    zoomInText: "+",
                    zoomInTitle: "Zoom in",
                    zoomOutText: "-",
                    zoomOutTitle: "Zoom out"
                },
                onAdd: function(e) {
                    var t = "leaflet-control-zoom",
                        n = i.DomUtil.create("div", t + " leaflet-bar");
                    return this._map = e, this._zoomInButton = this._createButton(this.options.zoomInText, this.options.zoomInTitle, t + "-in", n, this._zoomIn, this), this._zoomOutButton = this._createButton(this.options.zoomOutText, this.options.zoomOutTitle, t + "-out", n, this._zoomOut, this), this._updateDisabled(), e.on("zoomend zoomlevelschange", this._updateDisabled, this), n
                },
                onRemove: function(e) {
                    e.off("zoomend zoomlevelschange", this._updateDisabled, this)
                },
                _zoomIn: function(e) {
                    this._map.zoomIn(e.shiftKey ? 3 : 1)
                },
                _zoomOut: function(e) {
                    this._map.zoomOut(e.shiftKey ? 3 : 1)
                },
                _createButton: function(e, t, n, r, s, o) {
                    var u = i.DomUtil.create("a", n, r);
                    u.innerHTML = e, u.href = "#", u.title = t;
                    var a = i.DomEvent.stopPropagation;
                    return i.DomEvent.on(u, "click", a).on(u, "mousedown", a).on(u, "dblclick", a).on(u, "click", i.DomEvent.preventDefault).on(u, "click", s, o).on(u, "click", this._refocusOnMap, o), u
                },
                _updateDisabled: function() {
                    var e = this._map,
                        t = "leaflet-disabled";
                    i.DomUtil.removeClass(this._zoomInButton, t), i.DomUtil.removeClass(this._zoomOutButton, t), e._zoom === e.getMinZoom() && i.DomUtil.addClass(this._zoomOutButton, t), e._zoom === e.getMaxZoom() && i.DomUtil.addClass(this._zoomInButton, t)
                }
            }), i.Map.mergeOptions({
                zoomControl: !0
            }), i.Map.addInitHook(function() {
                this.options.zoomControl && (this.zoomControl = new i.Control.Zoom, this.addControl(this.zoomControl))
            }), i.control.zoom = function(e) {
                return new i.Control.Zoom(e)
            }, i.Control.Attribution = i.Control.extend({
                options: {
                    position: "bottomright",
                    prefix: '<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'
                },
                initialize: function(e) {
                    i.setOptions(this, e), this._attributions = {}
                },
                onAdd: function(e) {
                    this._container = i.DomUtil.create("div", "leaflet-control-attribution"), i.DomEvent.disableClickPropagation(this._container);
                    for (var t in e._layers) e._layers[t].getAttribution && this.addAttribution(e._layers[t].getAttribution());
                    return e.on("layeradd", this._onLayerAdd, this).on("layerremove", this._onLayerRemove, this), this._update(), this._container
                },
                onRemove: function(e) {
                    e.off("layeradd", this._onLayerAdd).off("layerremove", this._onLayerRemove)
                },
                setPrefix: function(e) {
                    return this.options.prefix = e, this._update(), this
                },
                addAttribution: function(e) {
                    if (!e) return;
                    return this._attributions[e] || (this._attributions[e] = 0), this._attributions[e]++, this._update(), this
                },
                removeAttribution: function(e) {
                    if (!e) return;
                    return this._attributions[e] && (this._attributions[e]--, this._update()), this
                },
                _update: function() {
                    if (!this._map) return;
                    var e = [];
                    for (var t in this._attributions) this._attributions[t] && e.push(t);
                    var n = [];
                    this.options.prefix && n.push(this.options.prefix), e.length && n.push(e.join(", ")), this._container.innerHTML = n.join(" | ")
                },
                _onLayerAdd: function(e) {
                    e.layer.getAttribution && this.addAttribution(e.layer.getAttribution())
                },
                _onLayerRemove: function(e) {
                    e.layer.getAttribution && this.removeAttribution(e.layer.getAttribution())
                }
            }), i.Map.mergeOptions({
                attributionControl: !0
            }), i.Map.addInitHook(function() {
                this.options.attributionControl && (this.attributionControl = (new i.Control.Attribution).addTo(this))
            }), i.control.attribution = function(e) {
                return new i.Control.Attribution(e)
            }, i.Control.Scale = i.Control.extend({
                options: {
                    position: "bottomleft",
                    maxWidth: 100,
                    metric: !0,
                    imperial: !0,
                    updateWhenIdle: !1
                },
                onAdd: function(e) {
                    this._map = e;
                    var t = "leaflet-control-scale",
                        n = i.DomUtil.create("div", t),
                        r = this.options;
                    return this._addScales(r, t, n), e.on(r.updateWhenIdle ? "moveend" : "move", this._update, this), e.whenReady(this._update, this), n
                },
                onRemove: function(e) {
                    e.off(this.options.updateWhenIdle ? "moveend" : "move", this._update, this)
                },
                _addScales: function(e, t, n) {
                    e.metric && (this._mScale = i.DomUtil.create("div", t + "-line", n)), e.imperial && (this._iScale = i.DomUtil.create("div", t + "-line", n))
                },
                _update: function() {
                    var e = this._map.getBounds(),
                        t = e.getCenter().lat,
                        n = 6378137 * Math.PI * Math.cos(t * Math.PI / 180),
                        r = n * (e.getNorthEast().lng - e.getSouthWest().lng) / 180,
                        i = this._map.getSize(),
                        s = this.options,
                        o = 0;
                    i.x > 0 && (o = r * (s.maxWidth / i.x)), this._updateScales(s, o)
                },
                _updateScales: function(e, t) {
                    e.metric && t && this._updateMetric(t), e.imperial && t && this._updateImperial(t)
                },
                _updateMetric: function(e) {
                    var t = this._getRoundNum(e);
                    this._mScale.style.width = this._getScaleWidth(t / e) + "px", this._mScale.innerHTML = t < 1e3 ? t + " m" : t / 1e3 + " km"
                },
                _updateImperial: function(e) {
                    var t = e * 3.2808399,
                        n = this._iScale,
                        r, i, s;
                    t > 5280 ? (r = t / 5280, i = this._getRoundNum(r), n.style.width = this._getScaleWidth(i / r) + "px", n.innerHTML = i + " mi") : (s = this._getRoundNum(t), n.style.width = this._getScaleWidth(s / t) + "px", n.innerHTML = s + " ft")
                },
                _getScaleWidth: function(e) {
                    return Math.round(this.options.maxWidth * e) - 10
                },
                _getRoundNum: function(e) {
                    var t = Math.pow(10, (Math.floor(e) + "").length - 1),
                        n = e / t;
                    return n = n >= 10 ? 10 : n >= 5 ? 5 : n >= 3 ? 3 : n >= 2 ? 2 : 1, t * n
                }
            }), i.control.scale = function(e) {
                return new i.Control.Scale(e)
            }, i.Control.Layers = i.Control.extend({
                options: {
                    collapsed: !0,
                    position: "topright",
                    autoZIndex: !0
                },
                initialize: function(e, t, n) {
                    i.setOptions(this, n), this._layers = {}, this._lastZIndex = 0, this._handlingClick = !1;
                    for (var r in e) this._addLayer(e[r], r);
                    for (r in t) this._addLayer(t[r], r, !0)
                },
                onAdd: function(e) {
                    return this._initLayout(), this._update(), e.on("layeradd", this._onLayerChange, this).on("layerremove", this._onLayerChange, this), this._container
                },
                onRemove: function(e) {
                    e.off("layeradd", this._onLayerChange, this).off("layerremove", this._onLayerChange, this)
                },
                addBaseLayer: function(e, t) {
                    return this._addLayer(e, t), this._update(), this
                },
                addOverlay: function(e, t) {
                    return this._addLayer(e, t, !0), this._update(), this
                },
                removeLayer: function(e) {
                    var t = i.stamp(e);
                    return delete this._layers[t], this._update(), this
                },
                _initLayout: function() {
                    var e = "leaflet-control-layers",
                        t = this._container = i.DomUtil.create("div", e);
                    t.setAttribute("aria-haspopup", !0), i.Browser.touch ? i.DomEvent.on(t, "click", i.DomEvent.stopPropagation) : i.DomEvent.disableClickPropagation(t).disableScrollPropagation(t);
                    var n = this._form = i.DomUtil.create("form", e + "-list");
                    if (this.options.collapsed) {
                        i.Browser.android || i.DomEvent.on(t, "mouseover", this._expand, this).on(t, "mouseout", this._collapse, this);
                        var r = this._layersLink = i.DomUtil.create("a", e + "-toggle", t);
                        r.href = "#", r.title = "Layers", i.Browser.touch ? i.DomEvent.on(r, "click", i.DomEvent.stop).on(r, "click", this._expand, this) : i.DomEvent.on(r, "focus", this._expand, this), i.DomEvent.on(n, "click", function() {
                            setTimeout(i.bind(this._onInputClick, this), 0)
                        }, this), this._map.on("click", this._collapse, this)
                    } else this._expand();
                    this._baseLayersList = i.DomUtil.create("div", e + "-base", n), this._separator = i.DomUtil.create("div", e + "-separator", n), this._overlaysList = i.DomUtil.create("div", e + "-overlays", n), t.appendChild(n)
                },
                _addLayer: function(e, t, n) {
                    var r = i.stamp(e);
                    this._layers[r] = {
                        layer: e,
                        name: t,
                        overlay: n
                    }, this.options.autoZIndex && e.setZIndex && (this._lastZIndex++, e.setZIndex(this._lastZIndex))
                },
                _update: function() {
                    if (!this._container) return;
                    this._baseLayersList.innerHTML = "", this._overlaysList.innerHTML = "";
                    var e = !1,
                        t = !1,
                        n, r;
                    for (n in this._layers) r = this._layers[n], this._addItem(r), t = t || r.overlay, e = e || !r.overlay;
                    this._separator.style.display = t && e ? "" : "none"
                },
                _onLayerChange: function(e) {
                    var t = this._layers[i.stamp(e.layer)];
                    if (!t) return;
                    this._handlingClick || this._update();
                    var n = t.overlay ? e.type === "layeradd" ? "overlayadd" : "overlayremove" : e.type === "layeradd" ? "baselayerchange" : null;
                    n && this._map.fire(n, t)
                },
                _createRadioElement: function(e, n) {
                    var r = '<input type="radio" class="leaflet-control-layers-selector" name="' + e + '"';
                    n && (r += ' checked="checked"'), r += "/>";
                    var i = t.createElement("div");
                    return i.innerHTML = r, i.firstChild
                },
                _addItem: function(e) {
                    var n = t.createElement("label"),
                        r, s = this._map.hasLayer(e.layer);
                    e.overlay ? (r = t.createElement("input"), r.type = "checkbox", r.className = "leaflet-control-layers-selector", r.defaultChecked = s) : r = this._createRadioElement("leaflet-base-layers", s), r.layerId = i.stamp(e.layer), i.DomEvent.on(r, "click", this._onInputClick, this);
                    var o = t.createElement("span");
                    o.innerHTML = " " + e.name, n.appendChild(r), n.appendChild(o);
                    var u = e.overlay ? this._overlaysList : this._baseLayersList;
                    return u.appendChild(n), n
                },
                _onInputClick: function() {
                    var e, t, n, r = this._form.getElementsByTagName("input"),
                        i = r.length;
                    this._handlingClick = !0;
                    for (e = 0; e < i; e++) t = r[e], n = this._layers[t.layerId], t.checked && !this._map.hasLayer(n.layer) ? this._map.addLayer(n.layer) : !t.checked && this._map.hasLayer(n.layer) && this._map.removeLayer(n.layer);
                    this._handlingClick = !1, this._refocusOnMap()
                },
                _expand: function() {
                    i.DomUtil.addClass(this._container, "leaflet-control-layers-expanded")
                },
                _collapse: function() {
                    this._container.className = this._container.className.replace(" leaflet-control-layers-expanded", "")
                }
            }), i.control.layers = function(e, t, n) {
                return new i.Control.Layers(e, t, n)
            }, i.PosAnimation = i.Class.extend({
                includes: i.Mixin.Events,
                run: function(e, t, n, r) {
                    this.stop(), this._el = e, this._inProgress = !0, this._newPos = t, this.fire("start"), e.style[i.DomUtil.TRANSITION] = "all " + (n || .25) + "s cubic-bezier(0,0," + (r || .5) + ",1)", i.DomEvent.on(e, i.DomUtil.TRANSITION_END, this._onTransitionEnd, this), i.DomUtil.setPosition(e, t), i.Util.falseFn(e.offsetWidth), this._stepTimer = setInterval(i.bind(this._onStep, this), 50)
                },
                stop: function() {
                    if (!this._inProgress) return;
                    i.DomUtil.setPosition(this._el, this._getPos()), this._onTransitionEnd(), i.Util.falseFn(this._el.offsetWidth)
                },
                _onStep: function() {
                    var e = this._getPos();
                    if (!e) {
                        this._onTransitionEnd();
                        return
                    }
                    this._el._leaflet_pos = e, this.fire("step")
                },
                _transformRe: /([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,
                _getPos: function() {
                    var t, n, r, s = this._el,
                        o = e.getComputedStyle(s);
                    if (i.Browser.any3d) {
                        r = o[i.DomUtil.TRANSFORM].match(this._transformRe);
                        if (!r) return;
                        t = parseFloat(r[1]), n = parseFloat(r[2])
                    } else t = parseFloat(o.left), n = parseFloat(o.top);
                    return new i.Point(t, n, !0)
                },
                _onTransitionEnd: function() {
                    i.DomEvent.off(this._el, i.DomUtil.TRANSITION_END, this._onTransitionEnd, this);
                    if (!this._inProgress) return;
                    this._inProgress = !1, this._el.style[i.DomUtil.TRANSITION] = "", this._el._leaflet_pos = this._newPos, clearInterval(this._stepTimer), this.fire("step").fire("end")
                }
            }), i.Map.include({
                setView: function(e, t, r) {
                    t = t === n ? this._zoom : this._limitZoom(t), e = this._limitCenter(i.latLng(e), t, this.options.maxBounds), r = r || {}, this._panAnim && this._panAnim.stop();
                    if (this._loaded && !r.reset && r !== !0) {
                        r.animate !== n && (r.zoom = i.extend({
                            animate: r.animate
                        }, r.zoom), r.pan = i.extend({
                            animate: r.animate
                        }, r.pan));
                        var s = this._zoom !== t ? this._tryAnimatedZoom && this._tryAnimatedZoom(e, t, r.zoom) : this._tryAnimatedPan(e, r.pan);
                        if (s) return clearTimeout(this._sizeTimer), this
                    }
                    return this._resetView(e, t), this
                },
                panBy: function(e, t) {
                    e = i.point(e).round(), t = t || {};
                    if (!e.x && !e.y) return this;
                    this._panAnim || (this._panAnim = new i.PosAnimation, this._panAnim.on({
                        step: this._onPanTransitionStep,
                        end: this._onPanTransitionEnd
                    }, this)), t.noMoveStart || this.fire("movestart");
                    if (t.animate !== !1) {
                        i.DomUtil.addClass(this._mapPane, "leaflet-pan-anim");
                        var n = this._getMapPanePos().subtract(e);
                        this._panAnim.run(this._mapPane, n, t.duration || .25, t.easeLinearity)
                    } else this._rawPanBy(e), this.fire("move").fire("moveend");
                    return this
                },
                _onPanTransitionStep: function() {
                    this.fire("move")
                },
                _onPanTransitionEnd: function() {
                    i.DomUtil.removeClass(this._mapPane, "leaflet-pan-anim"), this.fire("moveend")
                },
                _tryAnimatedPan: function(e, t) {
                    var n = this._getCenterOffset(e)._floor();
                    return (t && t.animate) !== !0 && !this.getSize().contains(n) ? !1 : (this.panBy(n, t), !0)
                }
            }), i.PosAnimation = i.DomUtil.TRANSITION ? i.PosAnimation : i.PosAnimation.extend({
                run: function(e, t, n, r) {
                    this.stop(), this._el = e, this._inProgress = !0, this._duration = n || .25, this._easeOutPower = 1 / Math.max(r || .5, .2), this._startPos = i.DomUtil.getPosition(e), this._offset = t.subtract(this._startPos), this._startTime = +(new Date), this.fire("start"), this._animate()
                },
                stop: function() {
                    if (!this._inProgress) return;
                    this._step(), this._complete()
                },
                _animate: function() {
                    this._animId = i.Util.requestAnimFrame(this._animate, this), this._step()
                },
                _step: function() {
                    var e = +(new Date) - this._startTime,
                        t = this._duration * 1e3;
                    e < t ? this._runFrame(this._easeOut(e / t)) : (this._runFrame(1), this._complete())
                },
                _runFrame: function(e) {
                    var t = this._startPos.add(this._offset.multiplyBy(e));
                    i.DomUtil.setPosition(this._el, t), this.fire("step")
                },
                _complete: function() {
                    i.Util.cancelAnimFrame(this._animId), this._inProgress = !1, this.fire("end")
                },
                _easeOut: function(e) {
                    return 1 - Math.pow(1 - e, this._easeOutPower)
                }
            }), i.Map.mergeOptions({
                zoomAnimation: !0,
                zoomAnimationThreshold: 4
            }), i.DomUtil.TRANSITION && i.Map.addInitHook(function() {
                this._zoomAnimated = this.options.zoomAnimation && i.DomUtil.TRANSITION && i.Browser.any3d && !i.Browser.android23 && !i.Browser.mobileOpera, this._zoomAnimated && i.DomEvent.on(this._mapPane, i.DomUtil.TRANSITION_END, this._catchTransitionEnd, this)
            }), i.Map.include(i.DomUtil.TRANSITION ? {
                _catchTransitionEnd: function(e) {
                    this._animatingZoom && e.propertyName.indexOf("transform") >= 0 && this._onZoomTransitionEnd()
                },
                _nothingToAnimate: function() {
                    return !this._container.getElementsByClassName("leaflet-zoom-animated").length
                },
                _tryAnimatedZoom: function(e, t, n) {
                    if (this._animatingZoom) return !0;
                    n = n || {};
                    if (!this._zoomAnimated || n.animate === !1 || this._nothingToAnimate() || Math.abs(t - this._zoom) > this.options.zoomAnimationThreshold) return !1;
                    var r = this.getZoomScale(t),
                        i = this._getCenterOffset(e)._divideBy(1 - 1 / r),
                        s = this._getCenterLayerPoint()._add(i);
                    return n.animate !== !0 && !this.getSize().contains(i) ? !1 : (this.fire("movestart").fire("zoomstart"), this._animateZoom(e, t, s, r, null, !0), !0)
                },
                _animateZoom: function(e, t, n, r, s, o, u) {
                    u || (this._animatingZoom = !0), i.DomUtil.addClass(this._mapPane, "leaflet-zoom-anim"), this._animateToCenter = e, this._animateToZoom = t, i.Draggable && (i.Draggable._disabled = !0), i.Util.requestAnimFrame(function() {
                        this.fire("zoomanim", {
                            center: e,
                            zoom: t,
                            origin: n,
                            scale: r,
                            delta: s,
                            backwards: o
                        }), setTimeout(i.bind(this._onZoomTransitionEnd, this), 250)
                    }, this)
                },
                _onZoomTransitionEnd: function() {
                    if (!this._animatingZoom) return;
                    this._animatingZoom = !1, i.DomUtil.removeClass(this._mapPane, "leaflet-zoom-anim"), i.Util.requestAnimFrame(function() {
                        this._resetView(this._animateToCenter, this._animateToZoom, !0, !0), i.Draggable && (i.Draggable._disabled = !1)
                    }, this)
                }
            } : {}), i.TileLayer.include({
                _animateZoom: function(e) {
                    this._animating || (this._animating = !0, this._prepareBgBuffer());
                    var t = this._bgBuffer,
                        n = i.DomUtil.TRANSFORM,
                        r = e.delta ? i.DomUtil.getTranslateString(e.delta) : t.style[n],
                        s = i.DomUtil.getScaleString(e.scale, e.origin);
                    t.style[n] = e.backwards ? s + " " + r : r + " " + s
                },
                _endZoomAnim: function() {
                    var e = this._tileContainer,
                        t = this._bgBuffer;
                    e.style.visibility = "", e.parentNode.appendChild(e), i.Util.falseFn(t.offsetWidth);
                    var n = this._map.getZoom();
                    (n > this.options.maxZoom || n < this.options.minZoom) && this._clearBgBuffer(), this._animating = !1
                },
                _clearBgBuffer: function() {
                    var e = this._map;
                    e && !e._animatingZoom && !e.touchZoom._zooming && (this._bgBuffer.innerHTML = "", this._bgBuffer.style[i.DomUtil.TRANSFORM] = "")
                },
                _prepareBgBuffer: function() {
                    var e = this._tileContainer,
                        t = this._bgBuffer,
                        n = this._getLoadedTilesPercentage(t),
                        r = this._getLoadedTilesPercentage(e);
                    if (t && n > .5 && r < .5) {
                        e.style.visibility = "hidden", this._stopLoadingImages(e);
                        return
                    }
                    t.style.visibility = "hidden", t.style[i.DomUtil.TRANSFORM] = "", this._tileContainer = t, t = this._bgBuffer = e, this._stopLoadingImages(t), clearTimeout(this._clearBgBufferTimer)
                },
                _getLoadedTilesPercentage: function(e) {
                    var t = e.getElementsByTagName("img"),
                        n, r, i = 0;
                    for (n = 0, r = t.length; n < r; n++) t[n].complete && i++;
                    return i / r
                },
                _stopLoadingImages: function(e) {
                    var t = Array.prototype.slice.call(e.getElementsByTagName("img")),
                        n, r, s;
                    for (n = 0, r = t.length; n < r; n++) s = t[n], s.complete || (s.onload = i.Util.falseFn, s.onerror = i.Util.falseFn, s.src = i.Util.emptyImageUrl, s.parentNode.removeChild(s))
                }
            }), i.Map.include({
                _defaultLocateOptions: {
                    watch: !1,
                    setView: !1,
                    maxZoom: Infinity,
                    timeout: 1e4,
                    maximumAge: 0,
                    enableHighAccuracy: !1
                },
                locate: function(e) {
                    e = this._locateOptions = i.extend(this._defaultLocateOptions, e);
                    if (!navigator.geolocation) return this._handleGeolocationError({
                        code: 0,
                        message: "Geolocation not supported."
                    }), this;
                    var t = i.bind(this._handleGeolocationResponse, this),
                        n = i.bind(this._handleGeolocationError, this);
                    return e.watch ? this._locationWatchId = navigator.geolocation.watchPosition(t, n, e) : navigator.geolocation.getCurrentPosition(t, n, e), this
                },
                stopLocate: function() {
                    return navigator.geolocation && navigator.geolocation.clearWatch(this._locationWatchId), this._locateOptions && (this._locateOptions.setView = !1), this
                },
                _handleGeolocationError: function(e) {
                    var t = e.code,
                        n = e.message || (t === 1 ? "permission denied" : t === 2 ? "position unavailable" : "timeout");
                    this._locateOptions.setView && !this._loaded && this.fitWorld(), this.fire("locationerror", {
                        code: t,
                        message: "Geolocation error: " + n + "."
                    })
                },
                _handleGeolocationResponse: function(e) {
                    var t = e.coords.latitude,
                        n = e.coords.longitude,
                        r = new i.LatLng(t, n),
                        s = 180 * e.coords.accuracy / 40075017,
                        o = s / Math.cos(i.LatLng.DEG_TO_RAD * t),
                        u = i.latLngBounds([t - s, n - o], [t + s, n + o]),
                        a = this._locateOptions;
                    if (a.setView) {
                        var f = Math.min(this.getBoundsZoom(u), a.maxZoom);
                        this.setView(r, f)
                    }
                    var l = {
                        latlng: r,
                        bounds: u,
                        timestamp: e.timestamp
                    };
                    for (var c in e.coords) typeof e.coords[c] == "number" && (l[c] = e.coords[c]);
                    this.fire("locationfound", l)
                }
            })
    }(window, document),
    function() {
        "use strict";

        function n(r) {
            if (!r) throw new Error("No options passed to Waypoint constructor");
            if (!r.element) throw new Error("No element option passed to Waypoint constructor");
            if (!r.handler) throw new Error("No handler option passed to Waypoint constructor");
            this.key = "waypoint-" + e, this.options = n.Adapter.extend({}, n.defaults, r), this.element = this.options.element, this.adapter = new n.Adapter(this.element), this.callback = r.handler, this.axis = this.options.horizontal ? "horizontal" : "vertical", this.enabled = this.options.enabled, this.triggerPoint = null, this.group = n.Group.findOrCreate({
                name: this.options.group,
                axis: this.axis
            }), this.context = n.Context.findOrCreateByElement(this.options.context), n.offsetAliases[this.options.offset] && (this.options.offset = n.offsetAliases[this.options.offset]), this.group.add(this), this.context.add(this), t[this.key] = this, e += 1
        }
        var e = 0,
            t = {};
        n.prototype.queueTrigger = function(e) {
            this.group.queueTrigger(this, e)
        }, n.prototype.trigger = function(e) {
            if (!this.enabled) return;
            this.callback && this.callback.apply(this, e)
        }, n.prototype.destroy = function() {
            this.context.remove(this), this.group.remove(this), delete t[this.key]
        }, n.prototype.disable = function() {
            return this.enabled = !1, this
        }, n.prototype.enable = function() {
            return this.context.refresh(), this.enabled = !0, this
        }, n.prototype.next = function() {
            return this.group.next(this)
        }, n.prototype.previous = function() {
            return this.group.previous(this)
        }, n.invokeAll = function(e) {
            var n = [];
            for (var r in t) n.push(t[r]);
            for (var i = 0, s = n.length; i < s; i++) n[i][e]()
        }, n.destroyAll = function() {
            n.invokeAll("destroy")
        }, n.disableAll = function() {
            n.invokeAll("disable")
        }, n.enableAll = function() {
            n.invokeAll("enable")
        }, n.refreshAll = function() {
            n.Context.refreshAll()
        }, n.viewportHeight = function() {
            return window.innerHeight || document.documentElement.clientHeight
        }, n.viewportWidth = function() {
            return document.documentElement.clientWidth
        }, n.adapters = [], n.defaults = {
            context: window,
            continuous: !0,
            enabled: !0,
            group: "default",
            horizontal: !1,
            offset: 0
        }, n.offsetAliases = {
            "bottom-in-view": function() {
                return this.context.innerHeight() - this.adapter.outerHeight()
            },
            "right-in-view": function() {
                return this.context.innerWidth() - this.adapter.outerWidth()
            }
        }, window.Waypoint = n
    }(),
    function() {
        "use strict";

        function e(e) {
            window.setTimeout(e, 1e3 / 60)
        }

        function s(e) {
            this.element = e, this.Adapter = r.Adapter, this.adapter = new this.Adapter(e), this.key = "waypoint-context-" + t, this.didScroll = !1, this.didResize = !1, this.oldScroll = {
                x: this.adapter.scrollLeft(),
                y: this.adapter.scrollTop()
            }, this.waypoints = {
                vertical: {},
                horizontal: {}
            }, e.waypointContextKey = this.key, n[e.waypointContextKey] = this, t += 1, this.createThrottledScrollHandler(), this.createThrottledResizeHandler()
        }
        var t = 0,
            n = {},
            r = window.Waypoint,
            i = window.onload;
        s.prototype.add = function(e) {
            var t = e.options.horizontal ? "horizontal" : "vertical";
            this.waypoints[t][e.key] = e, this.refresh()
        }, s.prototype.checkEmpty = function() {
            var e = this.Adapter.isEmptyObject(this.waypoints.horizontal),
                t = this.Adapter.isEmptyObject(this.waypoints.vertical);
            e && t && (this.adapter.off(".waypoints"), delete n[this.key])
        }, s.prototype.createThrottledResizeHandler = function() {
            function t() {
                e.handleResize(), e.didResize = !1
            }
            var e = this;
            this.adapter.on("resize.waypoints", function() {
                e.didResize || (e.didResize = !0, r.requestAnimationFrame(t))
            })
        }, s.prototype.createThrottledScrollHandler = function() {
            function t() {
                e.handleScroll(), e.didScroll = !1
            }
            var e = this;
            this.adapter.on("scroll.waypoints", function() {
                if (!e.didScroll || r.isTouch) e.didScroll = !0, r.requestAnimationFrame(t)
            })
        }, s.prototype.handleResize = function() {
            r.Context.refreshAll()
        }, s.prototype.handleScroll = function() {
            var e = {},
                t = {
                    horizontal: {
                        newScroll: this.adapter.scrollLeft(),
                        oldScroll: this.oldScroll.x,
                        forward: "right",
                        backward: "left"
                    },
                    vertical: {
                        newScroll: this.adapter.scrollTop(),
                        oldScroll: this.oldScroll.y,
                        forward: "down",
                        backward: "up"
                    }
                };
            for (var n in t) {
                var r = t[n],
                    i = r.newScroll > r.oldScroll,
                    s = i ? r.forward : r.backward;
                for (var o in this.waypoints[n]) {
                    var u = this.waypoints[n][o],
                        a = r.oldScroll < u.triggerPoint,
                        f = r.newScroll >= u.triggerPoint,
                        l = a && f,
                        c = !a && !f;
                    if (l || c) u.queueTrigger(s), e[u.group.id] = u.group
                }
            }
            for (var h in e) e[h].flushTriggers();
            this.oldScroll = {
                x: t.horizontal.newScroll,
                y: t.vertical.newScroll
            }
        }, s.prototype.innerHeight = function() {
            return this.element == this.element.window ? r.viewportHeight() : this.adapter.innerHeight()
        }, s.prototype.remove = function(e) {
            delete this.waypoints[e.axis][e.key], this.checkEmpty()
        }, s.prototype.innerWidth = function() {
            return this.element == this.element.window ? r.viewportWidth() : this.adapter.innerWidth()
        }, s.prototype.destroy = function() {
            var e = [];
            for (var t in this.waypoints)
                for (var n in this.waypoints[t]) e.push(this.waypoints[t][n]);
            for (var r = 0, i = e.length; r < i; r++) e[r].destroy()
        }, s.prototype.refresh = function() {
            var e = this.element == this.element.window,
                t = e ? undefined : this.adapter.offset(),
                n = {},
                i;
            this.handleScroll(), i = {
                horizontal: {
                    contextOffset: e ? 0 : t.left,
                    contextScroll: e ? 0 : this.oldScroll.x,
                    contextDimension: this.innerWidth(),
                    oldScroll: this.oldScroll.x,
                    forward: "right",
                    backward: "left",
                    offsetProp: "left"
                },
                vertical: {
                    contextOffset: e ? 0 : t.top,
                    contextScroll: e ? 0 : this.oldScroll.y,
                    contextDimension: this.innerHeight(),
                    oldScroll: this.oldScroll.y,
                    forward: "down",
                    backward: "up",
                    offsetProp: "top"
                }
            };
            for (var s in i) {
                var o = i[s];
                for (var u in this.waypoints[s]) {
                    var a = this.waypoints[s][u],
                        f = a.options.offset,
                        l = a.triggerPoint,
                        c = 0,
                        h = l == null,
                        p, d, v, m, g;
                    a.element !== a.element.window && (c = a.adapter.offset()[o.offsetProp]), typeof f == "function" ? f = f.apply(a) : typeof f == "string" && (f = parseFloat(f), a.options.offset.indexOf("%") > -1 && (f = Math.ceil(o.contextDimension * f / 100))), p = o.contextScroll - o.contextOffset, a.triggerPoint = c + p - f, d = l < o.oldScroll, v = a.triggerPoint >= o.oldScroll, m = d && v, g = !d && !v, !h && m ? (a.queueTrigger(o.backward), n[a.group.id] = a.group) : !h && g ? (a.queueTrigger(o.forward), n[a.group.id] = a.group) : h && o.oldScroll >= a.triggerPoint && (a.queueTrigger(o.forward), n[a.group.id] = a.group)
                }
            }
            return r.requestAnimationFrame(function() {
                for (var e in n) n[e].flushTriggers()
            }), this
        }, s.findOrCreateByElement = function(e) {
            return s.findByElement(e) || new s(e)
        }, s.refreshAll = function() {
            for (var e in n) n[e].refresh()
        }, s.findByElement = function(e) {
            return n[e.waypointContextKey]
        }, window.onload = function() {
            i && i(), s.refreshAll()
        }, r.requestAnimationFrame = function(t) {
            var n = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || e;
            n.call(window, t)
        }, r.Context = s
    }(),
    function() {
        "use strict";

        function e(e, t) {
            return e.triggerPoint - t.triggerPoint
        }

        function t(e, t) {
            return t.triggerPoint - e.triggerPoint
        }

        function i(e) {
            this.name = e.name, this.axis = e.axis, this.id = this.name + "-" + this.axis, this.waypoints = [], this.clearTriggerQueues(), n[this.axis][this.name] = this
        }
        var n = {
                vertical: {},
                horizontal: {}
            },
            r = window.Waypoint;
        i.prototype.add = function(e) {
            this.waypoints.push(e)
        }, i.prototype.clearTriggerQueues = function() {
            this.triggerQueues = {
                up: [],
                down: [],
                left: [],
                right: []
            }
        }, i.prototype.flushTriggers = function() {
            for (var n in this.triggerQueues) {
                var r = this.triggerQueues[n],
                    i = n === "up" || n === "left";
                r.sort(i ? t : e);
                for (var s = 0, o = r.length; s < o; s += 1) {
                    var u = r[s];
                    (u.options.continuous || s === r.length - 1) && u.trigger([n])
                }
            }
            this.clearTriggerQueues()
        }, i.prototype.next = function(t) {
            this.waypoints.sort(e);
            var n = r.Adapter.inArray(t, this.waypoints),
                i = n === this.waypoints.length - 1;
            return i ? null : this.waypoints[n + 1]
        }, i.prototype.previous = function(t) {
            this.waypoints.sort(e);
            var n = r.Adapter.inArray(t, this.waypoints);
            return n ? this.waypoints[n - 1] : null
        }, i.prototype.queueTrigger = function(e, t) {
            this.triggerQueues[t].push(e)
        }, i.prototype.remove = function(e) {
            var t = r.Adapter.inArray(e, this.waypoints);
            t > -1 && this.waypoints.splice(t, 1)
        }, i.prototype.first = function() {
            return this.waypoints[0]
        }, i.prototype.last = function() {
            return this.waypoints[this.waypoints.length - 1]
        }, i.findOrCreate = function(e) {
            return n[e.axis][e.name] || new i(e)
        }, r.Group = i
    }(),
    function() {
        "use strict";

        function n(t) {
            this.$element = e(t)
        }
        var e = window.jQuery,
            t = window.Waypoint;
        e.each(["innerHeight", "innerWidth", "off", "offset", "on", "outerHeight", "outerWidth", "scrollLeft", "scrollTop"], function(e, t) {
            n.prototype[t] = function() {
                var e = Array.prototype.slice.call(arguments);
                return this.$element[t].apply(this.$element, e)
            }
        }), e.each(["extend", "inArray", "isEmptyObject"], function(t, r) {
            n[r] = e[r]
        }), t.adapters.push({
            name: "jquery",
            Adapter: n
        }), t.Adapter = n
    }(),
    function() {
        "use strict";

        function t(t) {
            return function() {
                var n = [],
                    r = arguments[0];
                return t.isFunction(arguments[0]) && (r = t.extend({}, arguments[1]), r.handler = arguments[0]), this.each(function() {
                    var i = t.extend({}, r, {
                        element: this
                    });
                    typeof i.context == "string" && (i.context = t(this).closest(i.context)[0]), n.push(new e(i))
                }), n
            }
        }
        var e = window.Waypoint;
        window.jQuery && (window.jQuery.fn.waypoint = t(window.jQuery)), window.Zepto && (window.Zepto.fn.waypoint = t(window.Zepto))
    }(), define("jquery.waypoints", function() {}), define("text!templates/oceanHeaderTemplate.html", [], function() {
        return '<%= t.oceans[ocean] %>\r\n'
    }), define("text!components/app/story/storyBottomHintsTemplate.html", [], function() {
        return '<div class="row">\r\n  <div class="col-xs-6">\r\n    <div class="story-bottom-hint story-region-hint hint">\r\n      <%= t.ux.story.select_story %>\r\n    </div>      \r\n  </div>\r\n  <div class="col-xs-6">\r\n    <div class="story-bottom-hint story-layer-hint hint">\r\n      <%= t.ux.story.explore_more[ocean] %>\r\n    </div>      \r\n  </div>\r\n</div>'
    }), define("text!templates/layerControlPlaceholderTemplate.html", [], function() {
        return '<div class="layer-control">\r\n  <table class="table-layer-select"><tbody>\r\n    <tr class="layer-key-main">\r\n      <td class="toggle">\r\n        <a href="#" class="icon-wwf_tick toggle-layer <%= isActive ? \'active\' : \'\' %>"\r\n           data-toggable="<%= toggable %>"                         \r\n           data-layerid="<%= id %>">\r\n        </a>     \r\n      </td>\r\n      <td class="title">\r\n        <a href="#" class="toggle-layer <%= isActive ? \'active\' : \'\' %> " \r\n           data-toggable="<%= toggable %>"           \r\n           data-layerid="<%= id %>">\r\n          <div class="title-inner"><%= title %></div>\r\n        </a>\r\n        <% if(hint !== \'\') { %>\r\n        <div class="hint">\r\n          <%= hint %>\r\n        </div>\r\n        <% } %>        \r\n      </td>\r\n         <td class="key">\r\n        <%= keyHtml %>\r\n      </td>      \r\n    </tr>\r\n    <% if (layerGradient) { %>\r\n    <tr class="layer-color-gradient">\r\n      <td></td>\r\n      <td colspan="<%= info ? 3 : 2 %>">\r\n        <%= layerGradient %> \r\n      </td>      \r\n    </tr>\r\n    <% } %>\r\n    <% if (layerCategories) { %>\r\n    <tr class="layer-color-groups">\r\n      <td></td>\r\n      <td>\r\n        <ul class="list-unstyled">\r\n        <% _.each(layerCategories, function(cat){ %>\r\n          <li>\r\n            <%= cat.color %>            \r\n            <%= cat.label %>\r\n          </li>          \r\n        <% }) %>\r\n        </ul>\r\n      </td>\r\n      <td></td>\r\n    </tr>\r\n    <% } %>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n'
    }), define("text!templates/storyNavTemplate.html", [], function() {
        return '  <ul class="list-inline story-list links-large list-module-nav nav-secondary ">\r\n    <% _.each(stories, function(story){ %>\r\n    <li class="nav-story-item">\r\n      <a href="#" data-storyid="<%= story.id %>" class="story-link <%= typeof linkClass !== \'undefined\' ? linkClass : \'\' %>">\r\n        <%= story.getTitle() %>\r\n      </a>      \r\n    </li>  \r\n    <% }) %>\r\n  </ul>'
    }), define("components/app/story/StoryView", ["jquery", "underscore", "backbone", "leaflet", "jquery.waypoints", "bootstrap", "text!templates/oceanHeaderTemplate.html", "text!./storyBottomHintsTemplate.html", "text!templates/layerControlPlaceholderTemplate.html", "text!templates/storyNavTemplate.html"], function(e, t, n, r, i, s, o, u, a, f) {
        var l = n.View.extend({
            events: {
                "click .chapter-link": "handleChapterLink",
                "click .previous-story-link": "handlePreviousStoryLink",
                "click .next-story-link": "handleNextStoryLink",
                "click .play-button": "handlePlayAudio",
                "click .toggle-layer": "toggleLayer",
                "click .layer-info-link": "handleLayerInfoLink",
                "click .story-link": "handleStoryLink"
            },
            initialize: function() {
                this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:story", this.handleStoryUpdate), e(window).on("resize", t.debounce(t.bind(this.resize, this), 200)), this.scroll_offset_chapter = 50, this.waypoints_offset_chapter = 100, this.waypoints_offset_layers = 175, this._scrolling = !1
            },
            render: function() {
                return this
            },
            resize: function() {
                typeof this.model != "undefined" && this.model.isActive() && this.refreshWaypoints()
            },
            loadStory: function() {
                var e = this.model.getStory();
                if (this.model.isActive() && e !== null) {
                    this.$el.html('<span class="loading-animation content-loading-animation"></span>');
                    var t = this;
                    e.getContent(function(e) {
                        t.$el.html(""), t.$el.append(e), t.populatePlaceholders(), t.initSlideshow(), t.initWaypoints(), t.initActives(), t.initLayers(), t.initAudio()
                    })
                }
            },
            initLayers: function() {
                this.$el.trigger("preloadLayers", {
                    layerids: t.without(t.uniq(t.flatten(t.map(e(".story-item"), function(n) {
                        return t.map(e(n).data("layers").split(","), function(e) {
                            return e.trim()
                        })
                    }))), "")
                })
            },
            initActives: function() {
                this.$('.chapter-link[data-chapterid="0"]').addClass("active");
                var t = this.model.getStory(),
                    n = this;
                waitFor(function() {
                    return t.isContentReady()
                }, function() {
                    n.itemTriggered({
                        layers: e("#chapter-0 .story-item").data("layers")
                    })
                })
            },
            populatePlaceholders: function() {
                var n = this.model.getStory(),
                    r = this;
                waitFor(function() {
                    return n.isContentReady()
                }, function() {
                    var i = n.getOceanId();
                    r.$(".placeholder-ocean").html(t.template(o)({
                        ocean: i,
                        t: tlang
                    })), r.$(".placeholder-story-layer-hint").html(t.template(u)({
                        ocean: i,
                        t: tlang
                    })), r.$(".placeholder-story-nav").html(t.template(f)({
                        stories: t.filter(r.model.getStories(), function(e) {
                            return e.id !== r.model.getStory().id
                        }),
                        linkClass: "ocean-color"
                    })), r.$(".story-item").each(function(n, i) {
                        var s = t.without(t.map(e(i).data("layers").split(","), function(e) {
                            return e.trim()
                        }), "");
                        s.length && (e(i).find(".placeholder-layercontrol").html('<h5 class=layer-control-title">' + tlang.nav.layers + '</h5>\n               <ul class="list-unstyled layer-control-list"></ul>'), t.each(s, function(n) {
                            var s = r.model.attributes.layers.findWhere({
                                id: n
                            });
                            e(i).find(".placeholder-layercontrol .layer-control-list").append('<li class="layer-control-list-item">' + t.template(a)({
                                id: n,
                                title: s.getTitle(),
                                hint: s.getHint(),
                                info: !0,
                                toggable: !1,
                                layerGradient: s.makeLayerGradientKey(),
                                layerCategories: s.makeLayerCategoriesKey(),
                                isActive: !0,
                                keyHtml: s.getKeySquareIcon("sm"),
                                t: tlang
                            }) + "</li>")
                        }))
                    })
                })
            },
            initWaypoints: function() {
                var t = this;
                this.$(".story-item").waypoint({
                    handler: function(n) {
                        if (!t._scrolling && t.model.isActive())
                            if (n === "down") t.itemTriggered({
                                layers: e(this.element).data("layers")
                            });
                            else {
                                var r = e(".story-item").index(this.element) !== 0 ? e(e(".story-item")[e(".story-item").index(this.element) - 1]) : e(this.element);
                                t.itemTriggered({
                                    layers: r.data("layers")
                                })
                            }
                    },
                    context: this.$(".content-scroll"),
                    offset: this.waypoints_offset_layers,
                    continuous: !0
                }), this.$(".chapter-link").removeClass("active"), this.$(".chapter").waypoint({
                    handler: function(n) {
                        if (t.model.isActive())
                            if (n === "down") t.chapterTriggered(e(this.element).data("chapterid"));
                            else {
                                var r = e(this.element).data("chapterid") > 0 ? e("#chapter-" + (e(this.element).data("chapterid") - 1)) : e(this.element);
                                r.length !== 0 && t.chapterTriggered(r.data("chapterid"))
                            }
                    },
                    context: this.$(".content-scroll"),
                    offset: this.waypoints_offset_chapter,
                    continuous: !0
                }), this.$el.removeClass("chapter-nav-stuck"), this.$(".chapter-nav").waypoint({
                    handler: function(e) {
                        t.model.isActive() && (e === "down" ? t.$el.addClass("chapter-nav-stuck") : t.$el.removeClass("chapter-nav-stuck"))
                    },
                    context: this.$(".content-scroll")
                })
            },
            refreshWaypoints: function() {
                var e = this.model.getStory(),
                    t = this;
                waitFor(function() {
                    return e.isContentReady()
                }, function() {
                    window.Waypoint.refreshAll()
                })
            },
            initSlideshow: function() {
                this.$(".carousel").length > 0 && this.$(".carousel").carousel({
                    interval: !1
                })
            },
            initAudio: function() {
                var t = this;
                this.$(".audio").each(function() {
                    var n = e(this),
                        r = n.find("audio").get(0),
                        i = null;
                    r.addEventListener("loadedmetadata", function() {
                        r.setAttribute("data-time", r.duration), n.find(".time-total").html(t.formatTime(r.duration))
                    }, !1), r.addEventListener("play", function() {
                        i = setInterval(function() {
                            t.audioUpdateTime(r, n)
                        }, 10)
                    }), r.addEventListener("pause", function() {
                        clearInterval(i)
                    }), r.addEventListener("ended", function() {
                        clearInterval(i), n.find(".audio-slider").width("100%"), n.find(".play-button").addClass("end"), n.find(".play-button").removeClass("active")
                    }), n.find(".audio-position").on("click", function(i) {
                        n.find(".play-button").removeClass("end");
                        var s = i.offsetX / e(this).width();
                        r.currentTime = s * r.duration, e(this).find(".audio-slider").width(i.offsetX + "px"), n.find(".time-progress").html(t.formatTime(r.currentTime))
                    })
                })
            },
            formatTime: function(e) {
                var t = Math.floor(e / 60),
                    n = Math.floor(e) - t * 60,
                    r = "";
                return r += "" + t + ":" + (n < 10 ? "0" : ""), r += "" + n, r
            },
            audioUpdateTime: function(e, t) {
                var n = t.find(".audio-position"),
                    r = e.currentTime / e.duration,
                    i = n.width() * r;
                n.find(".audio-slider").width(Math.round(i * 100) / 100 + "px"), t.find(".time-progress").html(this.formatTime(e.currentTime))
            },
            scrollToChapter: function(e) {
                var t = this.$(".content-scroll"),
                    n = this;
                typeof e == "undefined" || e === "" || e === 0 || e === "0" ? t.scrollTop() !== 0 && (this._scrolling = !0, t.animate({
                    scrollTop: 0
                }, "fast", "swing", function() {
                    n.onScrollAnimationEnd(0)
                })) : this.$("#chapter-" + e).offset().top !== 0 && (this._scrolling = !0, console.log("story.onScrollAnimationStart"), t.animate({
                    scrollTop: this.$("#chapter-" + e).offset().top + t.scrollTop() - this.scroll_offset_chapter
                }, "slow", "swing", function() {
                    n.onScrollAnimationEnd(e)
                }))
            },
            onScrollAnimationEnd: function(e) {
                console.log("story.onScrollAnimationEnd");
                var n = this.$("#chapter-" + e + " .story-item").first().data("layers");
                this.triggerLayers(t.map(n.split(","), function(e) {
                    return e.trim()
                })), this._scrolling = !1, this.chapterTriggered(e)
            },
            chapterTriggered: function(e) {
                this.$(".chapter-link").removeClass("active"), this.$('.chapter-link[data-chapterid="' + e + '"]').addClass("active")
            },
            itemTriggered: function(e) {
                !this._scrolling && typeof e.layers != "undefined" && this.triggerLayers(t.map(e.layers.split(","), function(e) {
                    return e.trim()
                }))
            },
            triggerLayers: function(e) {
                e = typeof e != "undefined" ? e : "", this.$el.trigger("storyItemActivated", {
                    layerIds: e
                })
            },
            handleActive: function() {
                var e = this;
                this.model.isActive() ? (this.$el.show(), e.$el.removeClass("chapter-nav-stuck")) : (this.$el.hide(), e.$el.removeClass("chapter-nav-stuck"))
            },
            handleStoryUpdate: function() {
                this.loadStory()
            },
            handleChapterLink: function(t) {
                t.preventDefault(), this.scrollToChapter(e(t.target).data("chapterid"))
            },
            handlePreviousStoryLink: function(e) {
                e.preventDefault(), this.$el.trigger("previousStoryLinkClick", {
                    target: e.target,
                    id: this.model.getStory().id
                })
            },
            handleNextStoryLink: function(e) {
                e.preventDefault(), this.$el.trigger("nextStoryLinkClick", {
                    target: e.target,
                    id: this.model.getStory().id
                })
            },
            handlePlayAudio: function(e) {
                e.preventDefault();
                var t = this.$(e.target).closest(".play-button"),
                    n = this.$(e.target).closest(".audio"),
                    r = n.find("audio").get(0);
                r.ended ? (r.play(), t.addClass("active"), t.removeClass("end")) : r.paused ? (r.play(), t.addClass("active")) : (r.pause(), t.removeClass("active"))
            },
            handleLayerInfoLink: function(t) {
                t.preventDefault(), this.$el.trigger("layerInfoLinkClick", {
                    target: t.target,
                    id: e(t.target).data("layerid")
                })
            },
            toggleLayer: function(e) {
                e.preventDefault(), e.stopPropagation()
            },
            handleStoryLink: function(t) {
                t.preventDefault(), this.$el.trigger("storyLinkClick", {
                    target: t.target,
                    id: e(t.target).data("storyid")
                })
            }
        });
        return l
    }), define("models/ViewModel", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.Model.extend({
            initialize: function(e) {
                this.options = e || {}
            },
            setActive: function(e) {
                e = typeof e != "undefined" ? e : !0, this.set("active", e)
            },
            isActive: function() {
                return this.get("active")
            }
        });
        return r
    }), define("components/app/story/StoryViewModel", ["jquery", "underscore", "backbone", "models/ViewModel"], function(e, t, n, r) {
        return r.extend({
            initialize: function(e) {
                this.options = e || {}
            },
            getLayers: function() {
                return this.attributes.layers
            },
            setLayers: function(e) {
                this.set("layers", e)
            },
            getStory: function() {
                return this.attributes.story
            },
            setStory: function(e) {
                this.set("story", e)
            },
            getStories: function() {
                return this.attributes.stories
            },
            setStories: function(e) {
                this.set("stories", e)
            }
        })
    }), define("components/app/home/HomeView", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.View.extend({
            events: {},
            initialize: function() {
                this.listenTo(this.model, "change:active", this.handleActive);
                var n = this;
                if (Modernizr.touch) {
                    var r = this.$(".content-wrap");
                    this._scrollOffset = r.offset().top, this._scrollOffsetInitial = r.offset().top, this._maxOverflow = r[0].scrollHeight - e("#application").outerHeight(), this._scrolled = 0, r.on({
                        "touchstart mousedown": t.bind(function(e) {
                            typeof e.originalEvent.changedTouches != "undefined" && (this._touched = e.originalEvent.changedTouches[0].pageY, r.on("touchmove mousemove", t.bind(this.move, this)))
                        }, this),
                        "touchend mouseup": function(e) {
                            r.off("touchmove mousemove")
                        }
                    })
                }
            },
            move: function(e) {
                e.preventDefault();
                var t = e.originalEvent.changedTouches[0],
                    n = this.$(".content-wrap"),
                    r = this._touched - t.pageY;
                this._touched = t.pageY, n.css({
                    top: Math.min(this._scrollOffsetInitial, Math.max(-this._maxOverflow, this._scrollOffset - r)) + "px"
                }), this._scrollOffset = n.offset().top
            },
            render: function() {
                return this
            },
            handleActive: function() {
                this.model.isActive() ? this.$el.show() : this.$el.hide()
            }
        });
        return r
    }), define("components/app/ocean/OceanView", ["jquery", "underscore", "backbone", "text!templates/storyNavTemplate.html"], function(e, t, n, r) {
        var i = n.View.extend({
            events: {
                "click .previous-ocean-link": "handlePreviousOceanLink",
                "click .next-ocean-link": "handleNextOceanLink",
                "click .story-link": "handleStoryLink"
            },
            initialize: function() {
                this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:ocean", this.handleOceanChange), this.listenTo(this.model, "change:stories", this.handleStoriesChange)
            },
            initScroll: function() {
                if (Modernizr.touch) {
                    var n = this.$(".content-wrap");
                    this._scrollOffset = n.offset().top, this._scrollOffsetInitial = n.offset().top, this._maxOverflow = n[0].scrollHeight - e("#application").outerHeight(), this._scrolled = 0, n.on({
                        "touchstart mousedown": t.bind(function(e) {
                            typeof e.originalEvent.changedTouches != "undefined" && (this._touched = e.originalEvent.changedTouches[0].pageY, n.on("touchmove mousemove", t.bind(this.move, this)))
                        }, this),
                        "touchend mouseup": function(e) {
                            n.off("touchmove mousemove")
                        }
                    })
                }
            },
            move: function(e) {
                e.preventDefault();
                var t = e.originalEvent.changedTouches[0],
                    n = this.$(".content-wrap"),
                    r = this._touched - t.pageY;
                this._touched = t.pageY, n.css({
                    top: Math.min(this._scrollOffsetInitial, Math.max(-this._maxOverflow, this._scrollOffset - r)) + "px"
                }), this._scrollOffset = n.offset().top
            },
            render: function() {
                return this
            },
            loadOcean: function() {
                var e = this.model.getOcean();
                this.$el.html('<div class="content-aside content-wrap"><span class="loading-animation content-loading-animation"></span></div>');
                var t = this;
                e.getContent(function(e) {
                    t.$el.html(""), t.$el.append(e), t.populateStoryNav(), t.initScroll()
                })
            },
            populateStoryNav: function() {
                var e = this.model.getOcean(),
                    n = this;
                waitFor(function() {
                    return e.isContentReady()
                }, function() {
                    var e = {
                        stories: n.model.getStories()
                    };
                    n.$(".placeholder-story-nav").html(t.template(r)(e))
                })
            },
            handleActive: function() {
                this.model.isActive() ? this.$el.show() : this.$el.hide()
            },
            handleOceanChange: function() {
                this.loadOcean()
            },
            handleStoriesChange: function() {
                this.populateStoryNav()
            },
            handlePreviousOceanLink: function(e) {
                e.preventDefault(), this.$el.trigger("previousOceanLinkClick", {
                    target: e.target,
                    id: this.model.getOcean().id
                })
            },
            handleNextOceanLink: function(e) {
                e.preventDefault(), this.$el.trigger("nextOceanLinkClick", {
                    target: e.target,
                    id: this.model.getOcean().id
                })
            },
            handleStoryLink: function(t) {
                t.preventDefault(), this.$el.trigger("storyLinkClick", {
                    target: t.target,
                    id: e(t.target).data("storyid")
                })
            }
        });
        return i
    }), define("components/app/ocean/OceanViewModel", ["jquery", "underscore", "backbone", "models/ViewModel"], function(e, t, n, r) {
        return r.extend({
            setOcean: function(e) {
                this.set("ocean", e)
            },
            getOcean: function() {
                return this.attributes.ocean
            },
            setStories: function(e) {
                this.set("stories", e)
            },
            getStories: function() {
                return this.attributes.stories
            }
        })
    }), define("text!components/app/pages/subpageNavTemplate.html", [], function() {
        return '  <ul class="list-inline subpage-list nav-secondary">\r\n    <% _.each(pages, function(page){ %>\r\n    <li class="page-item">\r\n      <a href="#" data-pageid="<%= page.id %>" class="page-link <%= pageactive === page.id ? \'active\' : \'\'  %>">\r\n        <%= page.getTitle() %>\r\n      </a>      \r\n    </li>  \r\n    <% }) %>\r\n  </ul>'
    }), define("components/app/pages/PagesView", ["jquery", "underscore", "backbone", "bootstrap", "text!./subpageNavTemplate.html"], function(e, t, n, r, i) {
        var s = n.View.extend({
            events: {
                "click .page-link": "handlePageLink"
            },
            initialize: function() {
                this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:path", this.handlePathChange)
            },
            render: function() {
                return this
            },
            loadPage: function() {
                var e = this.model.getPageId(),
                    t = this.model.getPage(),
                    n = "page-" + e;
                this.$(".page").hide();
                if (this.$("." + n).length === 0) {
                    this.$el.append('<div class="page ' + n + '"><div class="content-full content-wrap"><span class="loading-animation page-loading-animation"></span></div></div>');
                    var r = this;
                    t.getContent(function(e) {
                        r.$("." + n).html(""), r.$("." + n).append(e), r.populatePlaceholders(), r.initBlockquotes(), r.initSlideshow()
                    })
                } else this.$("." + n).show()
            },
            initSlideshow: function() {
                this.$(".carousel").length > 0 && this.$(".carousel").carousel({
                    interval: !1
                })
            },
            initBlockquotes: function() {
                var t = this.model.getPageId(),
                    n = "page-" + t;
                this.$("." + n).find("blockquote").each(function(t) {
                    t % 2 === 1 && e(this).addClass("blockquote-offset-right")
                })
            },
            populatePlaceholders: function() {
                var e = this.model.getPageId(),
                    n = this.model.getPage(),
                    r = "page-" + e,
                    s = this;
                waitFor(function() {
                    return n.isContentReady()
                }, function() {
                    if (s.model.getPagesByCategory().length) {
                        var n = {
                            pages: s.model.getPagesByCategory(),
                            pageactive: e
                        };
                        s.$("." + r).find(".placeholder-subpage-nav").html(t.template(i)(n))
                    }
                    typeof s.model.getPage().getParent() != "undefined" && s.$("." + r).find(".placeholder-section-title").html(tlang.nav[s.model.getPage().getParent()])
                })
            },
            handlePageLink: function(t) {
                if (typeof e(t.target).data("pageid") != "undefined") t.preventDefault(), t.stopPropagation(), this.$el.trigger("pageLinkClick", {
                    target: t.target,
                    id: e(t.target).data("pageid")
                });
                else if (e(t.target).attr("href").startsWith("#?modal=")) {
                    t.preventDefault(), t.stopPropagation();
                    var n = e(t.target).attr("href").split("modal=")[1];
                    this.$el.trigger("modalOpen", {
                        target: t.target,
                        type: n
                    })
                } else if (e(t.target).attr("href").startsWith("#?page=")) {
                    t.preventDefault(), t.stopPropagation();
                    var r = e(t.target).attr("href").split("page=")[1];
                    this.$el.trigger("pageLinkClick", {
                        target: t.target,
                        id: r
                    })
                } else t.stopPropagation()
            },
            handleActive: function() {
                this.model.isActive() ? this.$el.show() : this.$el.hide()
            },
            handlePathChange: function() {
                this.loadPage()
            }
        });
        return s
    }), define("components/app/pages/PagesModel", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.Model.extend({
            initialize: function(e) {
                this.options = e || {}
            },
            setActive: function(e) {
                e = typeof e != "undefined" ? e : !0, this.set("active", e)
            },
            isActive: function() {
                return this.get("active")
            },
            setPath: function(e) {
                this.set("path", e)
            },
            getPageId: function() {
                return this.attributes.path
            },
            getPages: function() {
                return this.attributes.pages
            },
            getPage: function() {
                return this.attributes.pages.findWhere({
                    id: this.attributes.path
                })
            },
            getPagesByCategory: function() {
                return this.attributes.pages.where({
                    parent: this.getPage().getParent()
                })
            }
        });
        return r
    }),
    function(e) {
        typeof define == "function" && define.amd ? define("esri.leaflet", ["leaflet"], function(t) {
            return e(t)
        }) : typeof module == "object" && typeof module.exports == "object" && (module.exports = e(require("leaflet"))), typeof window != "undefined" && window.L && e(window.L)
    }(function(e) {
        var t = {
            VERSION: "1.0.0",
            Layers: {},
            Services: {},
            Controls: {},
            Tasks: {},
            Util: {},
            Support: {
                CORS: !!(window.XMLHttpRequest && "withCredentials" in new XMLHttpRequest),
                pointerEvents: document.documentElement.style.pointerEvents === ""
            }
        };
        return typeof window != "undefined" && window.L && (window.L.esri = t),
            function(t) {
                function r(e) {
                    var t = {};
                    for (var n in e) e.hasOwnProperty(n) && (t[n] = e[n]);
                    return t
                }

                function i(e, t) {
                    for (var n = 0; n < e.length; n++)
                        if (e[n] !== t[n]) return !1;
                    return !0
                }

                function s(e) {
                    return i(e[0], e[e.length - 1]) || e.push(e[0]), e
                }

                function o(e) {
                    var t = 0,
                        n = 0,
                        r = e.length,
                        i = e[n],
                        s;
                    for (n; n < r - 1; n++) s = e[n + 1], t += (s[0] - i[0]) * (s[1] + i[1]), i = s;
                    return t >= 0
                }

                function u(e, t, n, r) {
                    var i = (r[0] - n[0]) * (e[1] - n[1]) - (r[1] - n[1]) * (e[0] - n[0]),
                        s = (t[0] - e[0]) * (e[1] - n[1]) - (t[1] - e[1]) * (e[0] - n[0]),
                        o = (r[1] - n[1]) * (t[0] - e[0]) - (r[0] - n[0]) * (t[1] - e[1]);
                    if (o !== 0) {
                        var u = i / o,
                            a = s / o;
                        if (0 <= u && u <= 1 && 0 <= a && a <= 1) return !0
                    }
                    return !1
                }

                function a(e, t) {
                    for (var n = 0; n < e.length - 1; n++)
                        for (var r = 0; r < t.length - 1; r++)
                            if (u(e[n], e[n + 1], t[r], t[r + 1])) return !0;
                    return !1
                }

                function f(e, t) {
                    var n = !1;
                    for (var r = -1, i = e.length, s = i - 1; ++r < i; s = r)(e[r][1] <= t[1] && t[1] < e[s][1] || e[s][1] <= t[1] && t[1] < e[r][1]) && t[0] < (e[s][0] - e[r][0]) * (t[1] - e[r][1]) / (e[s][1] - e[r][1]) + e[r][0] && (n = !n);
                    return n
                }

                function l(e, t) {
                    var n = a(e, t),
                        r = f(e, t[0]);
                    return !n && r ? !0 : !1
                }

                function c(e) {
                    var t = [],
                        n = [],
                        r, i, u;
                    for (var f = 0; f < e.length; f++) {
                        var c = s(e[f].slice(0));
                        if (c.length < 4) continue;
                        if (o(c)) {
                            var h = [c];
                            t.push(h)
                        } else n.push(c)
                    }
                    var p = [];
                    while (n.length) {
                        u = n.pop();
                        var d = !1;
                        for (r = t.length - 1; r >= 0; r--) {
                            i = t[r][0];
                            if (l(i, u)) {
                                t[r].push(u), d = !0;
                                break
                            }
                        }
                        d || p.push(u)
                    }
                    while (p.length) {
                        u = p.pop();
                        var v = !1;
                        for (r = t.length - 1; r >= 0; r--) {
                            i = t[r][0];
                            if (a(i, u)) {
                                t[r].push(u), v = !0;
                                break
                            }
                        }
                        v || t.push([u.reverse()])
                    }
                    return t.length === 1 ? {
                        type: "Polygon",
                        coordinates: t[0]
                    } : {
                        type: "MultiPolygon",
                        coordinates: t
                    }
                }

                function h(e) {
                    var t = [],
                        n = e.slice(0),
                        r = s(n.shift().slice(0));
                    if (r.length >= 4) {
                        o(r) || r.reverse(), t.push(r);
                        for (var i = 0; i < n.length; i++) {
                            var u = s(n[i].slice(0));
                            u.length >= 4 && (o(u) && u.reverse(), t.push(u))
                        }
                    }
                    return t
                }

                function p(e) {
                    var t = [];
                    for (var n = 0; n < e.length; n++) {
                        var r = h(e[n]);
                        for (var i = r.length - 1; i >= 0; i--) {
                            var s = r[i].slice(0);
                            t.push(s)
                        }
                    }
                    return t
                }
                var n = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame || function(e) {
                    return window.setTimeout(e, 1e3 / 60)
                };
                t.Util.extentToBounds = function(t) {
                    var n = new e.LatLng(t.ymin, t.xmin),
                        r = new e.LatLng(t.ymax, t.xmax);
                    return new e.LatLngBounds(n, r)
                }, t.Util.boundsToExtent = function(t) {
                    return t = e.latLngBounds(t), {
                        xmin: t.getSouthWest().lng,
                        ymin: t.getSouthWest().lat,
                        xmax: t.getNorthEast().lng,
                        ymax: t.getNorthEast().lat,
                        spatialReference: {
                            wkid: 4326
                        }
                    }
                }, t.Util.arcgisToGeojson = function(e, n) {
                    var i = {};
                    typeof e.x == "number" && typeof e.y == "number" && (i.type = "Point", i.coordinates = [e.x, e.y]), e.points && (i.type = "MultiPoint", i.coordinates = e.points.slice(0)), e.paths && (e.paths.length === 1 ? (i.type = "LineString", i.coordinates = e.paths[0].slice(0)) : (i.type = "MultiLineString", i.coordinates = e.paths.slice(0))), e.rings && (i = c(e.rings.slice(0)));
                    if (e.geometry || e.attributes) i.type = "Feature", i.geometry = e.geometry ? t.Util.arcgisToGeojson(e.geometry) : null, i.properties = e.attributes ? r(e.attributes) : null, e.attributes && (i.id = e.attributes[n] || e.attributes.OBJECTID || e.attributes.FID);
                    return i
                }, t.Util.geojsonToArcGIS = function(e, n) {
                    n = n || "OBJECTID";
                    var i = {
                            wkid: 4326
                        },
                        s = {},
                        o;
                    switch (e.type) {
                        case "Point":
                            s.x = e.coordinates[0], s.y = e.coordinates[1], s.spatialReference = i;
                            break;
                        case "MultiPoint":
                            s.points = e.coordinates.slice(0), s.spatialReference = i;
                            break;
                        case "LineString":
                            s.paths = [e.coordinates.slice(0)], s.spatialReference = i;
                            break;
                        case "MultiLineString":
                            s.paths = e.coordinates.slice(0), s.spatialReference = i;
                            break;
                        case "Polygon":
                            s.rings = h(e.coordinates.slice(0)), s.spatialReference = i;
                            break;
                        case "MultiPolygon":
                            s.rings = p(e.coordinates.slice(0)), s.spatialReference = i;
                            break;
                        case "Feature":
                            e.geometry && (s.geometry = t.Util.geojsonToArcGIS(e.geometry, n)), s.attributes = e.properties ? r(e.properties) : {}, e.id && (s.attributes[n] = e.id);
                            break;
                        case "FeatureCollection":
                            s = [];
                            for (o = 0; o < e.features.length; o++) s.push(t.Util.geojsonToArcGIS(e.features[o], n));
                            break;
                        case "GeometryCollection":
                            s = [];
                            for (o = 0; o < e.geometries.length; o++) s.push(t.Util.geojsonToArcGIS(e.geometries[o], n))
                    }
                    return s
                }, t.Util.responseToFeatureCollection = function(e, n) {
                    var r;
                    if (n) r = n;
                    else if (e.objectIdFieldName) r = e.objectIdFieldName;
                    else if (e.fields) {
                        for (var i = 0; i <= e.fields.length - 1; i++)
                            if (e.fields[i].type === "esriFieldTypeOID") {
                                r = e.fields[i].name;
                                break
                            }
                    } else r = "OBJECTID";
                    var s = {
                            type: "FeatureCollection",
                            features: []
                        },
                        o = e.features || e.results;
                    if (o.length)
                        for (var u = o.length - 1; u >= 0; u--) s.features.push(t.Util.arcgisToGeojson(o[u], r));
                    return s
                }, t.Util.cleanUrl = function(e) {
                    return e = e.replace(/^\s+|\s+$|\A\s+|\s+\z/g, ""), e[e.length - 1] !== "/" && (e += "/"), e
                }, t.Util.isArcgisOnline = function(e) {
                    return /\.arcgis\.com.*?FeatureServer/g.test(e)
                }, t.Util.geojsonTypeToArcGIS = function(e) {
                    var t;
                    switch (e) {
                        case "Point":
                            t = "esriGeometryPoint";
                            break;
                        case "MultiPoint":
                            t = "esriGeometryMultipoint";
                            break;
                        case "LineString":
                            t = "esriGeometryPolyline";
                            break;
                        case "MultiLineString":
                            t = "esriGeometryPolyline";
                            break;
                        case "Polygon":
                            t = "esriGeometryPolygon";
                            break;
                        case "MultiPolygon":
                            t = "esriGeometryPolygon"
                    }
                    return t
                }, t.Util.requestAnimationFrame = e.Util.bind(n, window), t.Util.warn = function(e) {
                    console && console.warn && console.warn(e)
                }
            }(t),
            function(t) {
                function r(e) {
                    var t = "";
                    e.f = e.f || "json";
                    for (var n in e)
                        if (e.hasOwnProperty(n)) {
                            var r = e[n],
                                i = Object.prototype.toString.call(r),
                                s;
                            t.length && (t += "&"), i === "[object Array]" ? s = Object.prototype.toString.call(r[0]) === "[object Object]" ? JSON.stringify(r) : r.join(",") : i === "[object Object]" ? s = JSON.stringify(r) : i === "[object Date]" ? s = r.valueOf() : s = r, t += encodeURIComponent(n) + "=" + encodeURIComponent(s)
                        }
                    return t
                }

                function i(t, n) {
                    var r = new XMLHttpRequest;
                    return r.onerror = function(i) {
                        r.onreadystatechange = e.Util.falseFn, t.call(n, {
                            error: {
                                code: 500,
                                message: "XMLHttpRequest error"
                            }
                        }, null)
                    }, r.onreadystatechange = function() {
                        var i, s;
                        if (r.readyState === 4) {
                            try {
                                i = JSON.parse(r.responseText)
                            } catch (o) {
                                i = null, s = {
                                    code: 500,
                                    message: "Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."
                                }
                            }!s && i.error && (s = i.error, i = null), r.onerror = e.Util.falseFn, t.call(n, s, i)
                        }
                    }, r
                }
                var n = 0;
                window._EsriLeafletCallbacks = {}, t.Request = {
                    request: function(n, s, o, u) {
                        var a = r(s),
                            f = i(o, u),
                            l = (n + "?" + a).length;
                        if (l <= 2e3 && e.esri.Support.CORS) f.open("GET", n + "?" + a), f.send(null);
                        else {
                            if (!(l > 2e3 && e.esri.Support.CORS)) {
                                if (l <= 2e3 && !e.esri.Support.CORS) return e.esri.Request.get.JSONP(n, s, o, u);
                                t.Util.warn("a request to " + n + " was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");
                                return
                            }
                            f.open("POST", n), f.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), f.send(a)
                        }
                        return f
                    },
                    post: {
                        XMLHTTP: function(e, t, n, s) {
                            var o = i(n, s);
                            return o.open("POST", e), o.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), o.send(r(t)), o
                        }
                    },
                    get: {
                        CORS: function(e, t, n, s) {
                            var o = i(n, s);
                            return o.open("GET", e + "?" + r(t), !0), o.send(null), o
                        },
                        JSONP: function(t, i, s, o) {
                            var u = "c" + n;
                            i.callback = "window._EsriLeafletCallbacks." + u;
                            var a = e.DomUtil.create("script", null, document.body);
                            return a.type = "text/javascript", a.src = t + "?" + r(i), a.id = u, window._EsriLeafletCallbacks[u] = function(e) {
                                if (window._EsriLeafletCallbacks[u] !== !0) {
                                    var t, n = Object.prototype.toString.call(e);
                                    n !== "[object Object]" && n !== "[object Array]" && (t = {
                                        error: {
                                            code: 500,
                                            message: "Expected array or object as JSONP response"
                                        }
                                    }, e = null), !t && e.error && (t = e, e = null), s.call(o, t, e), window._EsriLeafletCallbacks[u] = !0
                                }
                            }, n++, {
                                id: u,
                                url: a.src,
                                abort: function() {
                                    window._EsriLeafletCallbacks._callback[u]({
                                        code: 0,
                                        message: "Request aborted."
                                    })
                                }
                            }
                        }
                    }
                }, t.get = t.Support.CORS ? t.Request.get.CORS : t.Request.get.JSONP, t.post = t.Request.post.XMLHTTP, t.request = t.Request.request
            }(t), t.Services.Service = e.Class.extend({
                includes: e.Mixin.Events,
                options: {
                    proxy: !1,
                    useCors: t.Support.CORS
                },
                initialize: function(n) {
                    n = n || {}, this._requestQueue = [], this._authenticating = !1, e.Util.setOptions(this, n), this.options.url = t.Util.cleanUrl(this.options.url)
                },
                get: function(e, t, n, r) {
                    return this._request("get", e, t, n, r)
                },
                post: function(e, t, n, r) {
                    return this._request("post", e, t, n, r)
                },
                request: function(e, t, n, r) {
                    return this._request("request", e, t, n, r)
                },
                metadata: function(e, t) {
                    return this._request("get", "", {}, e, t)
                },
                authenticate: function(e) {
                    return this._authenticating = !1, this.options.token = e, this._runQueue(), this
                },
                _request: function(e, n, r, i, s) {
                    this.fire("requeststart", {
                        url: this.options.url + n,
                        params: r,
                        method: e
                    });
                    var o = this._createServiceCallback(e, n, r, i, s);
                    this.options.token && (r.token = this.options.token);
                    if (this._authenticating) {
                        this._requestQueue.push([e, n, r, i, s]);
                        return
                    }
                    var u = this.options.proxy ? this.options.proxy + "?" + this.options.url + n : this.options.url + n;
                    return e !== "get" && e !== "request" || !!this.options.useCors ? t[e](u, r, o) : t.Request.get.JSONP(u, r, o)
                },
                _createServiceCallback: function(t, n, r, i, s) {
                    return e.Util.bind(function(o, u) {
                        o && (o.code === 499 || o.code === 498) && (this._authenticating = !0, this._requestQueue.push([t, n, r, i, s]), this.fire("authenticationrequired", {
                            authenticate: e.Util.bind(this.authenticate, this)
                        }), o.authenticate = e.Util.bind(this.authenticate, this)), i.call(s, o, u), o ? this.fire("requesterror", {
                            url: this.options.url + n,
                            params: r,
                            message: o.message,
                            code: o.code,
                            method: t
                        }) : this.fire("requestsuccess", {
                            url: this.options.url + n,
                            params: r,
                            response: u,
                            method: t
                        }), this.fire("requestend", {
                            url: this.options.url + n,
                            params: r,
                            method: t
                        })
                    }, this)
                },
                _runQueue: function() {
                    for (var e = this._requestQueue.length - 1; e >= 0; e--) {
                        var t = this._requestQueue[e],
                            n = t.shift();
                        this[n].apply(this, t)
                    }
                    this._requestQueue = []
                }
            }), t.Services.service = function(e) {
                return new t.Services.Service(e)
            }, t.Services.FeatureLayerService = t.Services.Service.extend({
                options: {
                    idAttribute: "OBJECTID"
                },
                query: function() {
                    return new t.Tasks.Query(this)
                },
                addFeature: function(e, n, r) {
                    return delete e.id, e = t.Util.geojsonToArcGIS(e), this.post("addFeatures", {
                        features: [e]
                    }, function(e, t) {
                        var i = t && t.addResults ? t.addResults[0] : undefined;
                        n && n.call(r, e || t.addResults[0].error, i)
                    }, r)
                },
                updateFeature: function(e, n, r) {
                    return e = t.Util.geojsonToArcGIS(e, this.options.idAttribute), this.post("updateFeatures", {
                        features: [e]
                    }, function(e, t) {
                        var i = t && t.updateResults ? t.updateResults[0] : undefined;
                        n && n.call(r, e || t.updateResults[0].error, i)
                    }, r)
                },
                deleteFeature: function(e, t, n) {
                    return this.post("deleteFeatures", {
                        objectIds: e
                    }, function(e, r) {
                        var i = r && r.deleteResults ? r.deleteResults[0] : undefined;
                        t && t.call(n, e || r.deleteResults[0].error, i)
                    }, n)
                },
                deleteFeatures: function(e, t, n) {
                    return this.post("deleteFeatures", {
                        objectIds: e
                    }, function(e, r) {
                        var i = r && r.deleteResults ? r.deleteResults : undefined;
                        t && t.call(n, e || r.deleteResults[0].error, i)
                    }, n)
                }
            }), t.Services.featureLayerService = function(e) {
                return new t.Services.FeatureLayerService(e)
            }, t.Services.MapService = t.Services.Service.extend({
                identify: function() {
                    return new t.Tasks.identifyFeatures(this)
                },
                find: function() {
                    return new t.Tasks.Find(this)
                },
                query: function() {
                    return new t.Tasks.Query(this)
                }
            }), t.Services.mapService = function(e) {
                return new t.Services.MapService(e)
            }, t.Services.ImageService = t.Services.Service.extend({
                query: function() {
                    return new t.Tasks.Query(this)
                },
                identify: function() {
                    return new t.Tasks.IdentifyImage(this)
                }
            }), t.Services.imageService = function(e) {
                return new t.Services.ImageService(e)
            }, t.Tasks.Task = e.Class.extend({
                options: {
                    proxy: !1,
                    useCors: t.Support.CORS
                },
                generateSetter: function(t, n) {
                    return e.Util.bind(function(e) {
                        return this.params[t] = e, this
                    }, n)
                },
                initialize: function(t) {
                    t.request && t.options ? (this._service = t, e.Util.setOptions(this, t.options)) : (e.Util.setOptions(this, t), this.options.url = e.esri.Util.cleanUrl(t.url)), this.params = e.Util.extend({}, this.params || {});
                    if (this.setters)
                        for (var n in this.setters) {
                            var r = this.setters[n];
                            this[n] = this.generateSetter(r, this)
                        }
                },
                token: function(e) {
                    return this._service ? this._service.authenticate(e) : this.params.token = e, this
                },
                request: function(e, t) {
                    return this._service ? this._service.request(this.path, this.params, e, t) : this._request("request", this.path, this.params, e, t)
                },
                _request: function(e, n, r, i, s) {
                    var o = this.options.proxy ? this.options.proxy + "?" + this.options.url + n : this.options.url + n;
                    return e !== "get" && e !== "request" || !!this.options.useCors ? t[e](o, r, i, s) : t.Request.get.JSONP(o, r, i, s)
                }
            }), t.Tasks.Query = t.Tasks.Task.extend({
                setters: {
                    offset: "offset",
                    limit: "limit",
                    fields: "outFields",
                    precision: "geometryPrecision",
                    featureIds: "objectIds",
                    returnGeometry: "returnGeometry",
                    token: "token"
                },
                path: "query",
                params: {
                    returnGeometry: !0,
                    where: "1=1",
                    outSr: 4326,
                    outFields: "*"
                },
                within: function(e) {
                    return this._setGeometry(e), this.params.spatialRel = "esriSpatialRelContains", this
                },
                intersects: function(e) {
                    return this._setGeometry(e), this.params.spatialRel = "esriSpatialRelIntersects", this
                },
                contains: function(e) {
                    return this._setGeometry(e), this.params.spatialRel = "esriSpatialRelWithin", this
                },
                overlaps: function(e) {
                    return this._setGeometry(e), this.params.spatialRel = "esriSpatialRelOverlaps", this
                },
                nearby: function(t, n) {
                    return t = e.latLng(t), this.params.geometry = [t.lng, t.lat], this.params.geometryType = "esriGeometryPoint", this.params.spatialRel = "esriSpatialRelIntersects", this.params.units = "esriSRUnit_Meter", this.params.distance = n, this.params.inSr = 4326, this
                },
                where: function(e) {
                    return this.params.where = e, this
                },
                between: function(e, t) {
                    return this.params.time = [e.valueOf(), t.valueOf()], this
                },
                simplify: function(e, t) {
                    var n = Math.abs(e.getBounds().getWest() - e.getBounds().getEast());
                    return this.params.maxAllowableOffset = n / e.getSize().y * t, this
                },
                orderBy: function(e, t) {
                    return t = t || "ASC", this.params.orderByFields = this.params.orderByFields ? this.params.orderByFields + "," : "", this.params.orderByFields += [e, t].join(" "), this
                },
                run: function(e, n) {
                    return this._cleanParams(), t.Util.isArcgisOnline(this.options.url) ? (this.params.f = "geojson", this.request(function(t, r) {
                        this._trapSQLerrors(t), e.call(n, t, r, r)
                    }, this)) : this.request(function(r, i) {
                        this._trapSQLerrors(r), e.call(n, r, i && t.Util.responseToFeatureCollection(i), i)
                    }, this)
                },
                count: function(e, t) {
                    return this._cleanParams(), this.params.returnCountOnly = !0, this.request(function(t, n) {
                        e.call(this, t, n && n.count, n)
                    }, t)
                },
                ids: function(e, t) {
                    return this._cleanParams(), this.params.returnIdsOnly = !0, this.request(function(t, n) {
                        e.call(this, t, n && n.objectIds, n)
                    }, t)
                },
                bounds: function(e, n) {
                    return this._cleanParams(), this.params.returnExtentOnly = !0, this.request(function(r, i) {
                        e.call(n, r, i && i.extent && t.Util.extentToBounds(i.extent), i)
                    }, n)
                },
                pixelSize: function(t) {
                    return t = e.point(t), this.params.pixelSize = [t.x, t.y], this
                },
                layer: function(e) {
                    return this.path = e + "/query", this
                },
                _trapSQLerrors: function(e) {
                    e && e.code === "400" && t.Util.warn("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")
                },
                _cleanParams: function() {
                    delete this.params.returnIdsOnly, delete this.params.returnExtentOnly, delete this.params.returnCountOnly
                },
                _setGeometry: function(n) {
                    this.params.inSr = 4326;
                    if (n instanceof e.LatLngBounds) {
                        this.params.geometry = t.Util.boundsToExtent(n), this.params.geometryType = "esriGeometryEnvelope";
                        return
                    }
                    n.getLatLng && (n = n.getLatLng()), n instanceof e.LatLng && (n = {
                        type: "Point",
                        coordinates: [n.lng, n.lat]
                    }), n instanceof e.GeoJSON && (n = n.getLayers()[0].feature.geometry, this.params.geometry = t.Util.geojsonToArcGIS(n), this.params.geometryType = t.Util.geojsonTypeToArcGIS(n.type)), n.toGeoJSON && (n = n.toGeoJSON()), n.type === "Feature" && (n = n.geometry);
                    if (n.type === "Point" || n.type === "LineString" || n.type === "Polygon") {
                        this.params.geometry = t.Util.geojsonToArcGIS(n), this.params.geometryType = t.Util.geojsonTypeToArcGIS(n.type);
                        return
                    }
                    t.Util.warn("invalid geometry passed to spatial query. Should be an L.LatLng, L.LatLngBounds or L.Marker or a GeoJSON Point Line or Polygon object");
                    return
                }
            }), t.Tasks.query = function(e) {
                return new t.Tasks.Query(e)
            }, t.Tasks.Find = t.Tasks.Task.extend({
                setters: {
                    contains: "contains",
                    text: "searchText",
                    fields: "searchFields",
                    spatialReference: "sr",
                    sr: "sr",
                    layers: "layers",
                    returnGeometry: "returnGeometry",
                    maxAllowableOffset: "maxAllowableOffset",
                    precision: "geometryPrecision",
                    dynamicLayers: "dynamicLayers",
                    returnZ: "returnZ",
                    returnM: "returnM",
                    gdbVersion: "gdbVersion",
                    token: "token"
                },
                path: "find",
                params: {
                    sr: 4326,
                    contains: !0,
                    returnGeometry: !0,
                    returnZ: !0,
                    returnM: !1
                },
                layerDefs: function(e, t) {
                    return this.params.layerDefs = this.params.layerDefs ? this.params.layerDefs + ";" : "", this.params.layerDefs += [e, t].join(":"), this
                },
                simplify: function(e, t) {
                    var n = Math.abs(e.getBounds().getWest() - e.getBounds().getEast());
                    return this.params.maxAllowableOffset = n / e.getSize().y * t, this
                },
                run: function(e, n) {
                    return this.request(function(r, i) {
                        e.call(n, r, i && t.Util.responseToFeatureCollection(i), i)
                    }, n)
                }
            }), t.Tasks.find = function(e) {
                return new t.Tasks.Find(e)
            }, t.Tasks.Identify = t.Tasks.Task.extend({
                path: "identify",
                between: function(e, t) {
                    return this.params.time = [e.valueOf(), t.valueOf()], this
                }
            }), t.Tasks.IdentifyImage = t.Tasks.Identify.extend({
                setters: {
                    setMosaicRule: "mosaicRule",
                    setRenderingRule: "renderingRule",
                    setPixelSize: "pixelSize",
                    returnCatalogItems: "returnCatalogItems",
                    returnGeometry: "returnGeometry"
                },
                params: {
                    returnGeometry: !1
                },
                at: function(t) {
                    return t = e.latLng(t), this.params.geometry = JSON.stringify({
                        x: t.lng,
                        y: t.lat,
                        spatialReference: {
                            wkid: 4326
                        }
                    }), this.params.geometryType = "esriGeometryPoint", this
                },
                getMosaicRule: function() {
                    return this.params.mosaicRule
                },
                getRenderingRule: function() {
                    return this.params.renderingRule
                },
                getPixelSize: function() {
                    return this.params.pixelSize
                },
                run: function(e, t) {
                    return this.request(function(n, r) {
                        e.call(t, n, r && this._responseToGeoJSON(r), r)
                    }, this)
                },
                _responseToGeoJSON: function(e) {
                    var n = e.location,
                        r = e.catalogItems,
                        i = e.catalogItemVisibilities,
                        s = {
                            pixel: {
                                type: "Feature",
                                geometry: {
                                    type: "Point",
                                    coordinates: [n.x, n.y]
                                },
                                crs: {
                                    type: "EPSG",
                                    properties: {
                                        code: n.spatialReference.wkid
                                    }
                                },
                                properties: {
                                    OBJECTID: e.objectId,
                                    name: e.name,
                                    value: e.value
                                },
                                id: e.objectId
                            }
                        };
                    e.properties && e.properties.Values && (s.pixel.properties.values = e.properties.Values);
                    if (r && r.features) {
                        s.catalogItems = t.Util.responseToFeatureCollection(r);
                        if (i && i.length === s.catalogItems.features.length)
                            for (var o = i.length - 1; o >= 0; o--) s.catalogItems.features[o].properties.catalogItemVisibility = i[o]
                    }
                    return s
                }
            }), t.Tasks.identifyImage = function(e) {
                return new t.Tasks.IdentifyImage(e)
            }, t.Tasks.IdentifyFeatures = t.Tasks.Identify.extend({
                setters: {
                    layers: "layers",
                    precision: "geometryPrecision",
                    tolerance: "tolerance",
                    returnGeometry: "returnGeometry"
                },
                params: {
                    sr: 4326,
                    layers: "all",
                    tolerance: 3,
                    returnGeometry: !0
                },
                on: function(e) {
                    var n = t.Util.boundsToExtent(e.getBounds()),
                        r = e.getSize();
                    return this.params.imageDisplay = [r.x, r.y, 96], this.params.mapExtent = [n.xmin, n.ymin, n.xmax, n.ymax], this
                },
                at: function(t) {
                    return t = e.latLng(t), this.params.geometry = [t.lng, t.lat], this.params.geometryType = "esriGeometryPoint", this
                },
                layerDef: function(e, t) {
                    return this.params.layerDefs = this.params.layerDefs ? this.params.layerDefs + ";" : "", this.params.layerDefs += [e, t].join(":"), this
                },
                simplify: function(e, t) {
                    var n = Math.abs(e.getBounds().getWest() - e.getBounds().getEast());
                    return this.params.maxAllowableOffset = n / e.getSize().y * (1 - t), this
                },
                run: function(e, n) {
                    return this.request(function(r, i) {
                        if (r) {
                            e.call(n, r, undefined, i);
                            return
                        }
                        var s = t.Util.responseToFeatureCollection(i);
                        i.results = i.results.reverse();
                        for (var o = 0; o < s.features.length; o++) {
                            var u = s.features[o];
                            u.layerId = i.results[o].layerId
                        }
                        e.call(n, undefined, s, i)
                    })
                }
            }), t.Tasks.identifyFeatures = function(e) {
                return new t.Tasks.IdentifyFeatures(e)
            },
            function(t) {
                var n = window.location.protocol !== "https:" ? "http:" : "https:";
                t.Layers.BasemapLayer = e.TileLayer.extend({
                    statics: {
                        TILES: {
                            Streets: {
                                urlTemplate: n + "//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",
                                attributionUrl: "https://static.arcgis.com/attribution/World_Street_Map",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri"
                                }
                            },
                            Topographic: {
                                urlTemplate: n + "//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",
                                attributionUrl: "https://static.arcgis.com/attribution/World_Topo_Map",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri"
                                }
                            },
                            Oceans: {
                                urlTemplate: n + "//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",
                                attributionUrl: "https://static.arcgis.com/attribution/Ocean_Basemap",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 16,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri"
                                }
                            },
                            OceansLabels: {
                                urlTemplate: n + "//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !0,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 16,
                                    subdomains: ["server", "services"]
                                }
                            },
                            NationalGeographic: {
                                urlTemplate: n + "//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 16,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri"
                                }
                            },
                            DarkGray: {
                                urlTemplate: n + "//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 16,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri, DeLorme, HERE"
                                }
                            },
                            DarkGrayLabels: {
                                urlTemplate: n + "//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !0,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 16,
                                    subdomains: ["server", "services"]
                                }
                            },
                            Gray: {
                                urlTemplate: n + "//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 16,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri, NAVTEQ, DeLorme"
                                }
                            },
                            GrayLabels: {
                                urlTemplate: n + "//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !0,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 16,
                                    subdomains: ["server", "services"]
                                }
                            },
                            Imagery: {
                                urlTemplate: n + "//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri, DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community"
                                }
                            },
                            ImageryLabels: {
                                urlTemplate: n + "//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !0,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"]
                                }
                            },
                            ImageryTransportation: {
                                urlTemplate: n + "//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !0,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 19,
                                    subdomains: ["server", "services"]
                                }
                            },
                            ShadedRelief: {
                                urlTemplate: n + "//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 13,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri, NAVTEQ, DeLorme"
                                }
                            },
                            ShadedReliefLabels: {
                                urlTemplate: n + "//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !0,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 12,
                                    subdomains: ["server", "services"]
                                }
                            },
                            Terrain: {
                                urlTemplate: n + "//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !1,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 13,
                                    subdomains: ["server", "services"],
                                    attribution: "Esri, USGS, NOAA"
                                }
                            },
                            TerrainLabels: {
                                urlTemplate: n + "//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",
                                options: {
                                    hideLogo: !0,
                                    logoPosition: "bottomright",
                                    minZoom: 1,
                                    maxZoom: 13,
                                    subdomains: ["server", "services"]
                                }
                            }
                        }
                    },
                    initialize: function(n, r) {
                        var i;
                        if (typeof n == "object" && n.urlTemplate && n.options) i = n;
                        else {
                            if (typeof n != "string" || !t.BasemapLayer.TILES[n]) throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ShadedRelief", "ShadedReliefLabels", "Terrain" or "TerrainLabels"');
                            i = t.BasemapLayer.TILES[n]
                        }
                        var s = e.Util.extend(i.options, r);
                        e.TileLayer.prototype.initialize.call(this, i.urlTemplate, e.Util.setOptions(this, s)), i.attributionUrl && this._getAttributionData(i.attributionUrl), this._logo = new t.Controls.Logo({
                            position: this.options.logoPosition
                        })
                    },
                    onAdd: function(t) {
                        !this.options.hideLogo && !t._hasEsriLogo && (this._logo.addTo(t), t._hasEsriLogo = !0), e.TileLayer.prototype.onAdd.call(this, t), t.on("moveend", this._updateMapAttribution, this)
                    },
                    onRemove: function(t) {
                        this._logo && this._logo._container && (t.removeControl(this._logo), t._hasEsriLogo = !1), e.TileLayer.prototype.onRemove.call(this, t), t.off("moveend", this._updateMapAttribution, this)
                    },
                    getAttribution: function() {
                        var e = '<span class="esri-attributions" style="line-height:14px; vertical-align: -3px; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; display:inline-block;">' + this.options.attribution + "</span>";
                        return e
                    },
                    _getAttributionData: function(t) {
                        e.esri.Request.get.JSONP(t, {}, e.Util.bind(function(t, n) {
                            this._attributions = [];
                            for (var r = 0; r < n.contributors.length; r++) {
                                var i = n.contributors[r];
                                for (var s = 0; s < i.coverageAreas.length; s++) {
                                    var o = i.coverageAreas[s],
                                        u = new e.LatLng(o.bbox[0], o.bbox[1]),
                                        a = new e.LatLng(o.bbox[2], o.bbox[3]);
                                    this._attributions.push({
                                        attribution: i.attribution,
                                        score: o.score,
                                        bounds: new e.LatLngBounds(u, a),
                                        minZoom: o.zoomMin,
                                        maxZoom: o.zoomMax
                                    })
                                }
                            }
                            this._attributions.sort(function(e, t) {
                                return t.score - e.score
                            }), this._updateMapAttribution()
                        }, this))
                    },
                    _updateMapAttribution: function() {
                        if (this._map && this._map.attributionControl && this._attributions) {
                            var e = "",
                                t = this._map.getBounds(),
                                n = this._map.getZoom();
                            for (var r = 0; r < this._attributions.length; r++) {
                                var i = this._attributions[r],
                                    s = i.attribution;
                                !e.match(s) && t.intersects(i.bounds) && n >= i.minZoom && n <= i.maxZoom && (e += ", " + s)
                            }
                            e = e.substr(2);
                            var o = this._map.attributionControl._container.querySelector(".esri-attributions");
                            o.innerHTML = e, o.style.maxWidth = this._map.getSize().x * .65 + "px", this.fire("attributionupdated", {
                                attribution: e
                            })
                        }
                    }
                }), t.BasemapLayer = t.Layers.BasemapLayer, t.Layers.basemapLayer = function(e, n) {
                    return new t.Layers.BasemapLayer(e, n)
                }, t.basemapLayer = function(e, n) {
                    return new t.Layers.BasemapLayer(e, n)
                }
            }(t), t.Layers.RasterLayer = e.Class.extend({
                includes: e.Mixin.Events,
                options: {
                    opacity: 1,
                    position: "front",
                    f: "image"
                },
                onAdd: function(t) {
                    this._map = t, this._update = e.Util.limitExecByInterval(this._update, this.options.updateInterval, this);
                    if (t.options.crs && t.options.crs.code) {
                        var n = t.options.crs.code.split(":")[1];
                        this.options.bboxSR = n, this.options.imageSR = n
                    }
                    t.on("moveend", this._update, this), this._currentImage && this._currentImage._bounds.equals(this._map.getBounds()) ? t.addLayer(this._currentImage) : this._currentImage && (this._map.removeLayer(this._currentImage), this._currentImage = null), this._update(), this._popup && (this._map.on("click", this._getPopupData, this), this._map.on("dblclick", this._resetPopupState, this))
                },
                bindPopup: function(t, n) {
                    return this._shouldRenderPopup = !1, this._lastClick = !1, this._popup = e.popup(n), this._popupFunction = t, this._map && (this._map.on("click", this._getPopupData, this), this._map.on("dblclick", this._resetPopupState, this)), this
                },
                unbindPopup: function() {
                    return this._map && (this._map.closePopup(this._popup), this._map.off("click", this._getPopupData, this), this._map.off("dblclick", this._resetPopupState, this)), this._popup = !1, this
                },
                onRemove: function(e) {
                    this._currentImage && this._map.removeLayer(this._currentImage), this._popup && (this._map.off("click", this._getPopupData, this), this._map.off("dblclick", this._resetPopupState, this)), this._map.off("moveend", this._update, this), this._map = null
                },
                addTo: function(e) {
                    return e.addLayer(this), this
                },
                removeFrom: function(e) {
                    return e.removeLayer(this), this
                },
                bringToFront: function() {
                    return this.options.position = "front", this._currentImage && this._currentImage.bringToFront(), this
                },
                bringToBack: function() {
                    return this.options.position = "back", this._currentImage && this._currentImage.bringToBack(), this
                },
                getAttribution: function() {
                    return this.options.attribution
                },
                getOpacity: function() {
                    return this.options.opacity
                },
                setOpacity: function(e) {
                    return this.options.opacity = e, this._currentImage.setOpacity(e), this
                },
                getTimeRange: function() {
                    return [this.options.from, this.options.to]
                },
                setTimeRange: function(e, t) {
                    return this.options.from = e, this.options.to = t, this._update(), this
                },
                metadata: function(e, t) {
                    return this._service.metadata(e, t), this
                },
                authenticate: function(e) {
                    return this._service.authenticate(e), this
                },
                _renderImage: function(t, n) {
                    if (this._map) {
                        var r = (new e.ImageOverlay(t, n, {
                            opacity: 0
                        })).addTo(this._map);
                        r.once("load", function(e) {
                            var t = e.target,
                                r = this._currentImage;
                            t._bounds.equals(n) && t._bounds.equals(this._map.getBounds()) ? (this._currentImage = t, this.options.position === "front" ? this.bringToFront() : this.bringToBack(), this._map && this._currentImage._map ? this._currentImage.setOpacity(this.options.opacity) : this._currentImage._map.removeLayer(this._currentImage), r && this._map && this._map.removeLayer(r), r && r._map && r._map.removeLayer(r)) : this._map.removeLayer(t), this.fire("load", {
                                bounds: n
                            })
                        }, this), this.fire("loading", {
                            bounds: n
                        })
                    }
                },
                _update: function() {
                    if (!this._map) return;
                    var e = this._map.getZoom(),
                        t = this._map.getBounds();
                    if (this._animatingZoom) return;
                    if (this._map._panTransition && this._map._panTransition._inProgress) return;
                    if (e > this.options.maxZoom || e < this.options.minZoom) return;
                    var n = this._buildExportParams();
                    this._requestExport(n, t)
                },
                _renderPopup: function(t, n, r, i) {
                    t = e.latLng(t);
                    if (this._shouldRenderPopup && this._lastClick.equals(t)) {
                        var s = this._popupFunction(n, r, i);
                        s && this._popup.setLatLng(t).setContent(s).openOn(this._map)
                    }
                },
                _resetPopupState: function(e) {
                    this._shouldRenderPopup = !1, this._lastClick = e.latlng
                },
                _propagateEvent: function(t) {
                    t = e.extend({
                        layer: t.target,
                        target: this
                    }, t), this.fire(t.type, t)
                }
            }), t.Layers.DynamicMapLayer = t.Layers.RasterLayer.extend({
                options: {
                    updateInterval: 150,
                    layers: !1,
                    layerDefs: !1,
                    timeOptions: !1,
                    format: "png24",
                    transparent: !0,
                    f: "json"
                },
                initialize: function(n) {
                    n.url = t.Util.cleanUrl(n.url), this._service = new t.Services.MapService(n), this._service.on("authenticationrequired requeststart requestend requesterror requestsuccess", this._propagateEvent, this), (n.proxy || n.token) && n.f !== "json" && (n.f = "json"), e.Util.setOptions(this, n)
                },
                getDynamicLayers: function() {
                    return this.options.dynamicLayers
                },
                setDynamicLayers: function(e) {
                    return this.options.dynamicLayers = e, this._update(), this
                },
                getLayers: function() {
                    return this.options.layers
                },
                setLayers: function(e) {
                    return this.options.layers = e, this._update(), this
                },
                getLayerDefs: function() {
                    return this.options.layerDefs
                },
                setLayerDefs: function(e) {
                    return this.options.layerDefs = e, this._update(), this
                },
                getTimeOptions: function() {
                    return this.options.timeOptions
                },
                setTimeOptions: function(e) {
                    return this.options.timeOptions = e, this._update(), this
                },
                query: function() {
                    return this._service.query()
                },
                identify: function() {
                    return this._service.identify()
                },
                find: function() {
                    return this._service.find()
                },
                _getPopupData: function(t) {
                    var n = e.Util.bind(function(n, r, i) {
                            if (n) return;
                            setTimeout(e.Util.bind(function() {
                                this._renderPopup(t.latlng, n, r, i)
                            }, this), 300)
                        }, this),
                        r = this.identify().on(this._map).at(t.latlng);
                    this.options.layers ? r.layers("visible:" + this.options.layers.join(",")) : r.layers("visible"), r.run(n), this._shouldRenderPopup = !0, this._lastClick = t.latlng
                },
                _buildExportParams: function() {
                    var e = this._map.getBounds(),
                        t = this._map.getSize(),
                        n = this._map.options.crs.project(e._northEast),
                        r = this._map.options.crs.project(e._southWest),
                        i = this._map.latLngToLayerPoint(e._northEast),
                        s = this._map.latLngToLayerPoint(e._southWest);
                    if (i.y > 0 || s.y < t.y) t.y = s.y - i.y;
                    var o = {
                        bbox: [r.x, r.y, n.x, n.y].join(","),
                        size: t.x + "," + t.y,
                        dpi: 96,
                        format: this.options.format,
                        transparent: this.options.transparent,
                        bboxSR: this.options.bboxSR,
                        imageSR: this.options.imageSR
                    };
                    return this.options.dynamicLayers && (o.dynamicLayers = this.options.dynamicLayers), this.options.layers && (o.layers = "show:" + this.options.layers.join(",")), this.options.layerDefs && (o.layerDefs = JSON.stringify(this.options.layerDefs)), this.options.timeOptions && (o.timeOptions = JSON.stringify(this.options.timeOptions)), this.options.from && this.options.to && (o.time = this.options.from.valueOf() + "," + this.options.to.valueOf()), this._service.options.token && (o.token = this._service.options.token), o
                },
                _requestExport: function(t, n) {
                    this.options.f === "json" ? this._service.request("export", t, function(e, t) {
                        if (e) return;
                        this._renderImage(t.href, n)
                    }, this) : (t.f = "image", this._renderImage(this.options.url + "export" + e.Util.getParamString(t), n))
                }
            }), t.DynamicMapLayer = t.Layers.DynamicMapLayer, t.Layers.dynamicMapLayer = function(e) {
                return new t.Layers.DynamicMapLayer(e)
            }, t.dynamicMapLayer = function(e) {
                return new t.Layers.DynamicMapLayer(e)
            }, t.Layers.ImageMapLayer = t.Layers.RasterLayer.extend({
                options: {
                    updateInterval: 150,
                    format: "jpgpng",
                    transparent: !0,
                    f: "json"
                },
                query: function() {
                    return this._service.query()
                },
                identify: function() {
                    return this._service.identify()
                },
                initialize: function(n) {
                    n.url = t.Util.cleanUrl(n.url), this._service = new t.Services.ImageService(n), this._service.on("authenticationrequired requeststart requestend requesterror requestsuccess", this._propagateEvent, this), e.Util.setOptions(this, n)
                },
                setPixelType: function(e) {
                    return this.options.pixelType = e, this._update(), this
                },
                getPixelType: function() {
                    return this.options.pixelType
                },
                setBandIds: function(t) {
                    return e.Util.isArray(t) ? this.options.bandIds = t.join(",") : this.options.bandIds = t.toString(), this._update(), this
                },
                getBandIds: function() {
                    return this.options.bandIds
                },
                setNoData: function(t, n) {
                    return e.Util.isArray(t) ? this.options.noData = t.join(",") : this.options.noData = t.toString(), n && (this.options.noDataInterpretation = n), this._update(), this
                },
                getNoData: function() {
                    return this.options.noData
                },
                getNoDataInterpretation: function() {
                    return this.options.noDataInterpretation
                },
                setRenderingRule: function(e) {
                    this.options.renderingRule = e, this._update()
                },
                getRenderingRule: function() {
                    return this.options.renderingRule
                },
                setMosaicRule: function(e) {
                    this.options.mosaicRule = e, this._update()
                },
                getMosaicRule: function() {
                    return this.options.mosaicRule
                },
                _getPopupData: function(t) {
                    var n = e.Util.bind(function(n, r, i) {
                            if (n) return;
                            setTimeout(e.Util.bind(function() {
                                this._renderPopup(t.latlng, n, r, i)
                            }, this), 300)
                        }, this),
                        r = this.identify().at(t.latlng);
                    this.options.mosaicRule && r.setMosaicRule(this.options.mosaicRule), r.run(n), this._shouldRenderPopup = !0, this._lastClick = t.latlng
                },
                _buildExportParams: function() {
                    var e = this._map.getBounds(),
                        t = this._map.getSize(),
                        n = this._map.options.crs.project(e._northEast),
                        r = this._map.options.crs.project(e._southWest),
                        i = {
                            bbox: [r.x, r.y, n.x, n.y].join(","),
                            size: t.x + "," + t.y,
                            format: this.options.format,
                            transparent: this.options.transparent,
                            bboxSR: this.options.bboxSR,
                            imageSR: this.options.imageSR
                        };
                    return this.options.from && this.options.to && (i.time = this.options.from.valueOf() + "," + this.options.to.valueOf()), this.options.pixelType && (i.pixelType = this.options.pixelType), this.options.interpolation && (i.interpolation = this.options.interpolation), this.options.compressionQuality && (i.compressionQuality = this.options.compressionQuality), this.options.bandIds && (i.bandIds = this.options.bandIds), this.options.noData && (i.noData = this.options.noData), this.options.noDataInterpretation && (i.noDataInterpretation = this.options.noDataInterpretation), this._service.options.token && (i.token = this._service.options.token), this.options.renderingRule && (i.renderingRule = JSON.stringify(this.options.renderingRule)), this.options.mosaicRule && (i.mosaicRule = JSON.stringify(this.options.mosaicRule)), i
                },
                _requestExport: function(t, n) {
                    this.options.f === "json" ? this._service.request("exportImage", t, function(e, t) {
                        if (e) return;
                        this._renderImage(t.href, n)
                    }, this) : (t.f = "image", this._renderImage(this.options.url + "exportImage" + e.Util.getParamString(t), n))
                }
            }), t.ImageMapLayer = t.Layers.ImageMapLayer, t.Layers.imageMapLayer = function(e) {
                return new t.Layers.ImageMapLayer(e)
            }, t.imageMapLayer = function(e) {
                return new t.Layers.ImageMapLayer(e)
            }, t.Layers.TiledMapLayer = e.TileLayer.extend({
                options: {
                    zoomOffsetAllowance: .1,
                    correctZoomLevels: !0
                },
                statics: {
                    MercatorZoomLevels: {
                        0: 156543.033928,
                        1: 78271.5169639999,
                        2: 39135.7584820001,
                        3: 19567.8792409999,
                        4: 9783.93962049996,
                        5: 4891.96981024998,
                        6: 2445.98490512499,
                        7: 1222.99245256249,
                        8: 611.49622628138,
                        9: 305.748113140558,
                        10: 152.874056570411,
                        11: 76.4370282850732,
                        12: 38.2185141425366,
                        13: 19.1092570712683,
                        14: 9.55462853563415,
                        15: 4.77731426794937,
                        16: 2.38865713397468,
                        17: 1.19432856685505,
                        18: .597164283559817,
                        19: .298582141647617,
                        20: .14929107082381,
                        21: .07464553541191,
                        22: .0373227677059525,
                        23: .0186613838529763
                    }
                },
                initialize: function(n) {
                    n.url = t.Util.cleanUrl(n.url), n = e.Util.setOptions(this, n), this.tileUrl = e.esri.Util.cleanUrl(n.url) + "tile/{z}/{y}/{x}", this._service = new e.esri.Services.MapService(n), this._service.on("authenticationrequired requeststart requestend requesterror requestsuccess", this._propagateEvent, this), this.tileUrl.match("://tiles.arcgisonline.com") && (this.tileUrl = this.tileUrl.replace("://tiles.arcgisonline.com", "://tiles{s}.arcgisonline.com"), n.subdomains = ["1", "2", "3", "4"]), this.options.token && (this.tileUrl += "?token=" + this.options.token), e.TileLayer.prototype.initialize.call(this, this.tileUrl, n)
                },
                getTileUrl: function(t) {
                    return e.Util.template(this.tileUrl, e.extend({
                        s: this._getSubdomain(t),
                        z: this._lodMap[t.z] || t.z,
                        x: t.x,
                        y: t.y
                    }, this.options))
                },
                onAdd: function(n) {
                    !this._lodMap && this.options.correctZoomLevels ? (this._lodMap = {}, this.metadata(function(r, i) {
                        if (!r) {
                            var s = i.spatialReference.latestWkid || i.spatialReference.wkid;
                            if (s === 102100 || s === 3857) {
                                var o = i.tileInfo.lods,
                                    u = t.Layers.TiledMapLayer.MercatorZoomLevels;
                                for (var a = 0; a < o.length; a++) {
                                    var f = o[a];
                                    for (var l in u) {
                                        var c = u[l];
                                        if (this._withinPercentage(f.resolution, c, this.options.zoomOffsetAllowance)) {
                                            this._lodMap[l] = f.level;
                                            break
                                        }
                                    }
                                }
                            } else t.Util.warn("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html")
                        }
                        e.TileLayer.prototype.onAdd.call(this, n)
                    }, this)) : e.TileLayer.prototype.onAdd.call(this, n)
                },
                metadata: function(e, t) {
                    return this._service.metadata(e, t), this
                },
                identify: function() {
                    return this._service.identify()
                },
                authenticate: function(e) {
                    var t = "?token=" + e;
                    return this.tileUrl = this.options.token ? this.tileUrl.replace(/\?token=(.+)/g, t) : this.tileUrl + t, this.options.token = e, this._service.authenticate(e), this
                },
                _propagateEvent: function(t) {
                    t = e.extend({
                        layer: t.target,
                        target: this
                    }, t), this.fire(t.type, t)
                },
                _withinPercentage: function(e, t, n) {
                    var r = Math.abs(e / t - 1);
                    return r < n
                }
            }), e.esri.TiledMapLayer = e.esri.Layers.tiledMapLayer, e.esri.Layers.tiledMapLayer = function(t) {
                return new e.esri.Layers.TiledMapLayer(t)
            }, e.esri.tiledMapLayer = function(t) {
                return new e.esri.Layers.TiledMapLayer(t)
            }, t.Layers.FeatureGrid = e.Class.extend({
                includes: e.Mixin.Events,
                options: {
                    cellSize: 512,
                    updateInterval: 150
                },
                initialize: function(t) {
                    t = e.setOptions(this, t)
                },
                onAdd: function(t) {
                    this._map = t, this._update = e.Util.limitExecByInterval(this._update, this.options.updateInterval, this), this._map.addEventListener(this.getEvents(), this), this._reset(), this._update()
                },
                onRemove: function() {
                    this._map.removeEventListener(this.getEvents(), this), this._removeCells()
                },
                getEvents: function() {
                    var e = {
                        viewreset: this._reset,
                        moveend: this._update,
                        zoomend: this._onZoom
                    };
                    return e
                },
                addTo: function(e) {
                    return e.addLayer(this), this
                },
                removeFrom: function(e) {
                    return e.removeLayer(this), this
                },
                _onZoom: function() {
                    var e = this._map.getZoom();
                    e > this.options.maxZoom || e < this.options.minZoom ? (this.removeFrom(this._map), this._map.addEventListener("zoomend", this.getEvents().zoomend, this)) : this._map.hasLayer(this) || (this._map.removeEventListener("zoomend", this.getEvents().zoomend, this), this.addTo(this._map))
                },
                _reset: function() {
                    this._removeCells(), this._cells = {}, this._activeCells = {}, this._cellsToLoad = 0, this._cellsTotal = 0, this._resetWrap()
                },
                _resetWrap: function() {
                    var e = this._map,
                        t = e.options.crs;
                    if (t.infinite) return;
                    var n = this._getCellSize();
                    t.wrapLng && (this._wrapLng = [Math.floor(e.project([0, t.wrapLng[0]]).x / n), Math.ceil(e.project([0, t.wrapLng[1]]).x / n)]), t.wrapLat && (this._wrapLat = [Math.floor(e.project([t.wrapLat[0], 0]).y / n), Math.ceil(e.project([t.wrapLat[1], 0]).y / n)])
                },
                _getCellSize: function() {
                    return this.options.cellSize
                },
                _update: function() {
                    if (!this._map) return;
                    var t = this._map.getPixelBounds(),
                        n = this._map.getZoom(),
                        r = this._getCellSize(),
                        i = [r / 2, r / 2];
                    if (n > this.options.maxZoom || n < this.options.minZoom) return;
                    var s = t.min.subtract(i).divideBy(r).floor();
                    s.x = Math.max(s.x, 0), s.y = Math.max(s.y, 0);
                    var o = e.bounds(s, t.max.add(i).divideBy(r).floor());
                    this._removeOtherCells(o), this._addCells(o)
                },
                _addCells: function(t) {
                    var n = [],
                        r = t.getCenter(),
                        i = this._map.getZoom(),
                        s, o, u;
                    for (s = t.min.y; s <= t.max.y; s++)
                        for (o = t.min.x; o <= t.max.x; o++) u = new e.Point(o, s), u.z = i, n.push(u);
                    var a = n.length;
                    if (a === 0) return;
                    this._cellsToLoad += a, this._cellsTotal += a, n.sort(function(e, t) {
                        return e.distanceTo(r) - t.distanceTo(r)
                    });
                    for (o = 0; o < a; o++) this._addCell(n[o])
                },
                _cellCoordsToBounds: function(t) {
                    var n = this._map,
                        r = this.options.cellSize,
                        i = t.multiplyBy(r),
                        s = i.add([r, r]),
                        o = n.unproject(i, t.z).wrap(),
                        u = n.unproject(s, t.z).wrap();
                    return new e.LatLngBounds(o, u)
                },
                _cellCoordsToKey: function(e) {
                    return e.x + ":" + e.y
                },
                _keyToCellCoords: function(t) {
                    var n = t.split(":"),
                        r = parseInt(n[0], 10),
                        i = parseInt(n[1], 10);
                    return new e.Point(r, i)
                },
                _removeOtherCells: function(e) {
                    for (var t in this._cells) e.contains(this._keyToCellCoords(t)) || this._removeCell(t)
                },
                _removeCell: function(e) {
                    var t = this._activeCells[e];
                    t && (delete this._activeCells[e], this.cellLeave && this.cellLeave(t.bounds, t.coords), this.fire("cellleave", {
                        bounds: t.bounds,
                        coords: t.coords
                    }))
                },
                _removeCells: function() {
                    for (var e in this._cells) {
                        var t = this._cells[e].bounds,
                            n = this._cells[e].coords;
                        this.cellLeave && this.cellLeave(t, n), this.fire("cellleave", {
                            bounds: t,
                            coords: n
                        })
                    }
                },
                _addCell: function(e) {
                    this._wrapCoords(e);
                    var t = this._cellCoordsToKey(e),
                        n = this._cells[t];
                    n && !this._activeCells[t] && (this.cellEnter && this.cellEnter(n.bounds, e), this.fire("cellenter", {
                        bounds: n.bounds,
                        coords: e
                    }), this._activeCells[t] = n), n || (n = {
                        coords: e,
                        bounds: this._cellCoordsToBounds(e)
                    }, this._cells[t] = n, this._activeCells[t] = n, this.createCell && this.createCell(n.bounds, e), this.fire("cellcreate", {
                        bounds: n.bounds,
                        coords: e
                    }))
                },
                _wrapCoords: function(t) {
                    t.x = this._wrapLng ? e.Util.wrapNum(t.x, this._wrapLng) : t.x, t.y = this._wrapLat ? e.Util.wrapNum(t.y, this._wrapLat) : t.y
                }
            }),
            function(t) {
                function n(e) {
                    this.values = e || []
                }
                t.Layers.FeatureManager = t.Layers.FeatureGrid.extend({
                    options: {
                        where: "1=1",
                        fields: ["*"],
                        from: !1,
                        to: !1,
                        timeField: !1,
                        timeFilterMode: "server",
                        simplifyFactor: 0,
                        precision: 6
                    },
                    initialize: function(r) {
                        t.Layers.FeatureGrid.prototype.initialize.call(this, r), r.url = t.Util.cleanUrl(r.url), r = e.setOptions(this, r), this._service = new t.Services.FeatureLayerService(r);
                        if (this.options.fields[0] !== "*") {
                            var i = !1;
                            for (var s = 0; s < this.options.fields.length; s++) this.options.fields[s].match(/^(OBJECTID|FID|OID|ID)$/i) && (i = !0);
                            i === !1 && t.Util.warn("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")
                        }
                        this._service.on("authenticationrequired requeststart requestend requesterror requestsuccess", function(t) {
                            t = e.extend({
                                target: this
                            }, t), this.fire(t.type, t)
                        }, this), this.options.timeField.start && this.options.timeField.end ? (this._startTimeIndex = new n, this._endTimeIndex = new n) : this.options.timeField && (this._timeIndex = new n), this._cache = {}, this._currentSnapshot = [], this._activeRequests = 0, this._pendingRequests = []
                    },
                    onAdd: function(e) {
                        return t.Layers.FeatureGrid.prototype.onAdd.call(this, e)
                    },
                    onRemove: function(e) {
                        return t.Layers.FeatureGrid.prototype.onRemove.call(this, e)
                    },
                    getAttribution: function() {
                        return this.options.attribution
                    },
                    createCell: function(e, t) {
                        this._requestFeatures(e, t)
                    },
                    _requestFeatures: function(n, r, i) {
                        this._activeRequests++, this._activeRequests === 1 && this.fire("loading", {
                            bounds: n
                        }), this._buildQuery(n).run(function(s, o, u) {
                            u && u.exceededTransferLimit && this.fire("drawlimitexceeded"), !s && o && o.features.length && t.Util.requestAnimationFrame(e.Util.bind(function() {
                                this._addFeatures(o.features, r), this._postProcessFeatures(n)
                            }, this)), !s && o && !o.features.length && this._postProcessFeatures(n), i && i.call(this, s, o)
                        }, this)
                    },
                    _postProcessFeatures: function(e) {
                        this._activeRequests--, this._activeRequests <= 0 && this.fire("load", {
                            bounds: e
                        })
                    },
                    _cacheKey: function(e) {
                        return e.z + ":" + e.x + ":" + e.y
                    },
                    _addFeatures: function(e, t) {
                        var n = this._cacheKey(t);
                        this._cache[n] = this._cache[n] || [];
                        for (var r = e.length - 1; r >= 0; r--) {
                            var i = e[r].id;
                            this._currentSnapshot.push(i), this._cache[n].push(i)
                        }
                        this.options.timeField && this._buildTimeIndexes(e);
                        var s = this._map.getZoom();
                        if (s > this.options.maxZoom || s < this.options.minZoom) return;
                        this.createLayers(e)
                    },
                    _buildQuery: function(e) {
                        var t = this._service.query().intersects(e).where(this.options.where).fields(this.options.fields).precision(this.options.precision);
                        return this.options.simplifyFactor && t.simplify(this._map, this.options.simplifyFactor), this.options.timeFilterMode === "server" && this.options.from && this.options.to && t.between(this.options.from, this.options.to), t
                    },
                    setWhere: function(n, r, i) {
                        this.options.where = n && n.length ? n : "1=1";
                        var s = [],
                            o = [],
                            u = 0,
                            a = null,
                            f = e.Util.bind(function(n, f) {
                                u--, n && (a = n);
                                if (f)
                                    for (var l = f.features.length - 1; l >= 0; l--) o.push(f.features[l].id);
                                u <= 0 && (this._currentSnapshot = o, t.Util.requestAnimationFrame(e.Util.bind(function() {
                                    this.removeLayers(s), this.addLayers(o), r && r.call(i, a)
                                }, this)))
                            }, this);
                        for (var l = this._currentSnapshot.length - 1; l >= 0; l--) s.push(this._currentSnapshot[l]);
                        for (var c in this._activeCells) {
                            u++;
                            var h = this._keyToCellCoords(c),
                                p = this._cellCoordsToBounds(h);
                            this._requestFeatures(p, c, f)
                        }
                        return this
                    },
                    getWhere: function() {
                        return this.options.where
                    },
                    getTimeRange: function() {
                        return [this.options.from, this.options.to]
                    },
                    setTimeRange: function(t, n, r, i) {
                        var s = this.options.from,
                            o = this.options.to,
                            u = 0,
                            a = null,
                            f = e.Util.bind(function(e) {
                                e && (a = e), this._filterExistingFeatures(s, o, t, n), u--, r && u <= 0 && r.call(i, a)
                            }, this);
                        this.options.from = t, this.options.to = n, this._filterExistingFeatures(s, o, t, n);
                        if (this.options.timeFilterMode === "server")
                            for (var l in this._activeCells) {
                                u++;
                                var c = this._keyToCellCoords(l),
                                    h = this._cellCoordsToBounds(c);
                                this._requestFeatures(h, l, f)
                            }
                    },
                    refresh: function() {
                        for (var e in this._activeCells) {
                            var t = this._keyToCellCoords(e),
                                n = this._cellCoordsToBounds(t);
                            this._requestFeatures(n, e)
                        }
                        this.redraw && this.once("load", function() {
                            this.eachFeature(function(e) {
                                this._redraw(e.feature.id)
                            }, this)
                        }, this)
                    },
                    _filterExistingFeatures: function(n, r, i, s) {
                        var o = n && r ? this._getFeaturesInTimeRange(n, r) : this._currentSnapshot,
                            u = this._getFeaturesInTimeRange(i, s);
                        if (u.indexOf)
                            for (var a = 0; a < u.length; a++) {
                                var f = o.indexOf(u[a]);
                                f >= 0 && o.splice(f, 1)
                            }
                        t.Util.requestAnimationFrame(e.Util.bind(function() {
                            this.removeLayers(o), this.addLayers(u)
                        }, this))
                    },
                    _getFeaturesInTimeRange: function(e, t) {
                        var n = [],
                            r;
                        if (this.options.timeField.start && this.options.timeField.end) {
                            var i = this._startTimeIndex.between(e, t),
                                s = this._endTimeIndex.between(e, t);
                            r = i.concat(s)
                        } else r = this._timeIndex.between(e, t);
                        for (var o = r.length - 1; o >= 0; o--) n.push(r[o].id);
                        return n
                    },
                    _buildTimeIndexes: function(e) {
                        var t, n;
                        if (this.options.timeField.start && this.options.timeField.end) {
                            var r = [],
                                i = [];
                            for (t = e.length - 1; t >= 0; t--) n = e[t], r.push({
                                id: n.id,
                                value: new Date(n.properties[this.options.timeField.start])
                            }), i.push({
                                id: n.id,
                                value: new Date(n.properties[this.options.timeField.end])
                            });
                            this._startTimeIndex.bulkAdd(r), this._endTimeIndex.bulkAdd(i)
                        } else {
                            var s = [];
                            for (t = e.length - 1; t >= 0; t--) n = e[t], s.push({
                                id: n.id,
                                value: new Date(n.properties[this.options.timeField])
                            });
                            this._timeIndex.bulkAdd(s)
                        }
                    },
                    _featureWithinTimeRange: function(e) {
                        if (!this.options.from || !this.options.to) return !0;
                        var t = +this.options.from.valueOf(),
                            n = +this.options.to.valueOf();
                        if (typeof this.options.timeField == "string") {
                            var r = +e.properties[this.options.timeField];
                            return r >= t && r <= n
                        }
                        if (this.options.timeField.start && this.options.timeField.end) {
                            var i = +e.properties[this.options.timeField.start],
                                s = +e.properties[this.options.timeField.end];
                            return i >= t && i <= n || s >= t && s <= n
                        }
                    },
                    authenticate: function(e) {
                        return this._service.authenticate(e), this
                    },
                    metadata: function(e, t) {
                        return this._service.metadata(e, t), this
                    },
                    query: function() {
                        return this._service.query()
                    },
                    _getMetadata: function(t) {
                        if (this._metadata) {
                            var n;
                            t(n, this._metadata)
                        } else this.metadata(e.Util.bind(function(e, n) {
                            this._metadata = n, t(e, this._metadata)
                        }, this))
                    },
                    addFeature: function(t, n, r) {
                        this._getMetadata(e.Util.bind(function(i, s) {
                            this._service.addFeature(t, e.Util.bind(function(e, i) {
                                e || (t.properties[s.objectIdField] = i.objectId, t.id = i.objectId, this.createLayers([t])), n && n.call(r, e, i)
                            }, this))
                        }, this))
                    },
                    updateFeature: function(e, t, n) {
                        this._service.updateFeature(e, function(r, i) {
                            r || (this.removeLayers([e.id], !0), this.createLayers([e])), t && t.call(n, r, i)
                        }, this)
                    },
                    deleteFeature: function(e, t, n) {
                        this._service.deleteFeature(e, function(e, r) {
                            !e && r.objectId && this.removeLayers([r.objectId], !0), t && t.call(n, e, r)
                        }, this)
                    },
                    deleteFeatures: function(e, t, n) {
                        return this._service.deleteFeatures(e, function(e, r) {
                            if (!e && r.length > 0)
                                for (var i = 0; i < r.length; i++) this.removeLayers([r[i].objectId], !0);
                            t && t.call(n, e, r)
                        }, this)
                    }
                }), n.prototype._query = function(e) {
                    var t = 0,
                        n = this.values.length - 1,
                        r, i, s;
                    while (t <= n) {
                        s = r = (t + n) / 2 | 0, i = this.values[Math.round(r)];
                        if (+i.value < +e) t = r + 1;
                        else {
                            if (!(+i.value > +e)) return r;
                            n = r - 1
                        }
                    }
                    return ~n
                }, n.prototype.sort = function() {
                    this.values.sort(function(e, t) {
                        return +t.value - +e.value
                    }).reverse(), this.dirty = !1
                }, n.prototype.between = function(e, t) {
                    this.dirty && this.sort();
                    var n = this._query(e),
                        r = this._query(t);
                    return n === 0 && r === 0 ? [] : (n = Math.abs(n), r = r < 0 ? Math.abs(r) : r + 1, this.values.slice(n, r))
                }, n.prototype.bulkAdd = function(e) {
                    this.dirty = !0, this.values = this.values.concat(e)
                }
            }(t), t.Layers.FeatureLayer = t.Layers.FeatureManager.extend({
                statics: {
                    EVENTS: "click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"
                },
                options: {
                    cacheLayers: !0
                },
                initialize: function(n) {
                    t.Layers.FeatureManager.prototype.initialize.call(this, n), n = e.setOptions(this, n), this._layers = {}, this._leafletIds = {}, this._key = "c" + (Math.random() * 1e9).toString(36).replace(".", "_")
                },
                onAdd: function(e) {
                    return e.on("zoomstart zoomend", function(e) {
                        this._zooming = e.type === "zoomstart"
                    }, this), t.Layers.FeatureManager.prototype.onAdd.call(this, e)
                },
                onRemove: function(e) {
                    for (var n in this._layers) e.removeLayer(this._layers[n]);
                    return t.Layers.FeatureManager.prototype.onRemove.call(this, e)
                },
                createNewLayer: function(t) {
                    return e.GeoJSON.geometryToLayer(t, this.options.pointToLayer, e.GeoJSON.coordsToLatLng, this.options)
                },
                _updateLayer: function(t, n) {
                    var r = [],
                        i = this.options.coordsToLatLng || e.GeoJSON.coordsToLatLng;
                    n.properties && (t.feature.properties = n.properties);
                    switch (n.geometry.type) {
                        case "Point":
                            r = e.GeoJSON.coordsToLatLng(n.geometry.coordinates), t.setLatLng(r);
                            break;
                        case "LineString":
                            r = e.GeoJSON.coordsToLatLngs(n.geometry.coordinates, 0, i), t.setLatLngs(r);
                            break;
                        case "MultiLineString":
                            r = e.GeoJSON.coordsToLatLngs(n.geometry.coordinates, 1, i), t.setLatLngs(r);
                            break;
                        case "Polygon":
                            r = e.GeoJSON.coordsToLatLngs(n.geometry.coordinates, 1, i), t.setLatLngs(r);
                            break;
                        case "MultiPolygon":
                            r = e.GeoJSON.coordsToLatLngs(n.geometry.coordinates, 2, i), t.setLatLngs(r)
                    }
                },
                createLayers: function(e) {
                    for (var n = e.length - 1; n >= 0; n--) {
                        var r = e[n],
                            i = this._layers[r.id],
                            s;
                        i && !this._map.hasLayer(i) && this._map.addLayer(i), i && (i.setLatLngs || i.setLatLng) && this._updateLayer(i, r), i || (s = this.createNewLayer(r), s.feature = r, this.options.style ? s._originalStyle = this.options.style : s.setStyle && (s._originalStyle = s.options), s._leaflet_id = this._key + "_" + r.id, this._leafletIds[s._leaflet_id] = r.id, s.on(t.Layers.FeatureLayer.EVENTS, this._propagateEvent, this), this._popup && s.bindPopup && s.bindPopup(this._popup(s.feature, s), this._popupOptions), this.options.onEachFeature && this.options.onEachFeature(s.feature, s), this._layers[s.feature.id] = s, this.resetStyle(s.feature.id), this.fire("createfeature", {
                            feature: s.feature
                        }), (!this.options.timeField || this.options.timeField && this._featureWithinTimeRange(r)) && this._map.addLayer(s))
                    }
                },
                addLayers: function(e) {
                    for (var t = e.length - 1; t >= 0; t--) {
                        var n = this._layers[e[t]];
                        n && (this.fire("addfeature", {
                            feature: n.feature
                        }), this._map.addLayer(n))
                    }
                },
                removeLayers: function(e, t) {
                    for (var n = e.length - 1; n >= 0; n--) {
                        var r = e[n],
                            i = this._layers[r];
                        i && (this.fire("removefeature", {
                            feature: i.feature,
                            permanent: t
                        }), this._map.removeLayer(i)), i && t && delete this._layers[r]
                    }
                },
                cellEnter: function(n, r) {
                    this._zooming || t.Util.requestAnimationFrame(e.Util.bind(function() {
                        var e = this._cacheKey(r),
                            t = this._cellCoordsToKey(r),
                            n = this._cache[e];
                        this._activeCells[t] && n && this.addLayers(n)
                    }, this))
                },
                cellLeave: function(n, r) {
                    this._zooming || t.Util.requestAnimationFrame(e.Util.bind(function() {
                        var e = this._cacheKey(r),
                            t = this._cellCoordsToKey(r),
                            n = this._cache[e],
                            i = this._map.getBounds();
                        if (!this._activeCells[t] && n) {
                            var s = !0;
                            for (var o = 0; o < n.length; o++) {
                                var u = this._layers[n[o]];
                                u && u.getBounds && i.intersects(u.getBounds()) && (s = !1)
                            }
                            s && this.removeLayers(n, !this.options.cacheLayers), !this.options.cacheLayers && s && (delete this._cache[e], delete this._cells[t], delete this._activeCells[t])
                        }
                    }, this))
                },
                resetStyle: function(e) {
                    var t = this._layers[e];
                    return t && this.setFeatureStyle(t.feature.id, t._originalStyle), this
                },
                setStyle: function(e) {
                    return this.options.style = e, this.eachFeature(function(t) {
                        this.setFeatureStyle(t.feature.id, e)
                    }, this), this
                },
                setFeatureStyle: function(t, n) {
                    var r = this._layers[t];
                    return typeof n == "function" && (n = n(r.feature)), !n && !r.defaultOptions && (n = e.Path.prototype.options, n.fill = !0), r && r.setStyle && r.setStyle(n), this
                },
                bindPopup: function(e, t) {
                    this._popup = e, this._popupOptions = t;
                    for (var n in this._layers) {
                        var r = this._layers[n],
                            i = this._popup(r.feature, r);
                        r.bindPopup(i, t)
                    }
                    return this
                },
                unbindPopup: function() {
                    this._popup = !1;
                    for (var e in this._layers) {
                        var t = this._layers[e];
                        if (t.unbindPopup) t.unbindPopup();
                        else if (t.getLayers) {
                            var n = t.getLayers();
                            for (var r in n) {
                                var i = n[r];
                                i.unbindPopup()
                            }
                        }
                    }
                    return this
                },
                eachFeature: function(e, t) {
                    for (var n in this._layers) e.call(t, this._layers[n]);
                    return this
                },
                getFeature: function(e) {
                    return this._layers[e]
                },
                bringToBack: function() {
                    this.eachFeature(function(e) {
                        e.bringToBack && e.bringToBack()
                    })
                },
                bringToFront: function() {
                    this.eachFeature(function(e) {
                        e.bringToFront && e.bringToFront()
                    })
                },
                redraw: function(e) {
                    return e && this._redraw(e), this
                },
                _redraw: function(t) {
                    var n = this._layers[t],
                        r = n.feature;
                    if (n && n.setIcon && this.options.pointToLayer && this.options.pointToLayer) {
                        var i = this.options.pointToLayer(r, e.latLng(r.geometry.coordinates[1], r.geometry.coordinates[0])),
                            s = i.options.icon;
                        n.setIcon(s)
                    }
                    if (n && n.setStyle && this.options.pointToLayer) {
                        var o = this.options.pointToLayer(r, e.latLng(r.geometry.coordinates[1], r.geometry.coordinates[0])),
                            u = o.options;
                        this.setFeatureStyle(r.id, u)
                    }
                    n && n.setStyle && this.options.style && this.resetStyle(r.id)
                },
                _propagateEvent: function(e) {
                    e.layer = this._layers[this._leafletIds[e.target._leaflet_id]], e.target = this, this.fire(e.type, e)
                }
            }), t.FeatureLayer = t.Layers.FeatureLayer, t.Layers.featureLayer = function(e) {
                return new t.Layers.FeatureLayer(e)
            }, t.featureLayer = function(e) {
                return new t.Layers.FeatureLayer(e)
            }, t.Controls.Logo = e.Control.extend({
                options: {
                    position: "bottomright",
                    marginTop: 0,
                    marginLeft: 0,
                    marginBottom: 0,
                    marginRight: 0
                },
                onAdd: function() {
                    var t = e.DomUtil.create("div", "esri-leaflet-logo");
                    return t.style.marginTop = this.options.marginTop, t.style.marginLeft = this.options.marginLeft, t.style.marginBottom = this.options.marginBottom, t.style.marginRight = this.options.marginRight, t.innerHTML = this._adjustLogo(this._map._size), this._map.on("resize", function(e) {
                        t.innerHTML = this._adjustLogo(e.newSize)
                    }, this), t
                },
                _adjustLogo: function(e) {
                    return e.x <= 600 || e.y <= 600 ? '<a href="https://developers.arcgis.com" style="border: none;"><img src="https://js.arcgis.com/3.13/esri/images/map/logo-sm.png" alt="Powered by Esri" style="border: none;"></a>' : '<a href="https://developers.arcgis.com" style="border: none;"><img src="https://js.arcgis.com/3.13/esri/images/map/logo-med.png" alt="Powered by Esri" style="border: none;"></a>'
                }
            }), t.Controls.logo = function(t) {
                return new e.esri.Controls.Logo(t)
            }, t
    }),
    function(e, t, n) {
        L.drawVersion = "0.2.4-dev", L.drawLocal = {
            draw: {
                toolbar: {
                    actions: {
                        title: "Cancel drawing",
                        text: "Cancel"
                    },
                    undo: {
                        title: "Delete last point drawn",
                        text: "Delete last point"
                    },
                    buttons: {
                        polyline: "Draw a polyline",
                        polygon: "Draw a polygon",
                        rectangle: "Draw a rectangle",
                        circle: "Draw a circle",
                        marker: "Draw a marker"
                    }
                },
                handlers: {
                    circle: {
                        tooltip: {
                            start: "Click and drag to draw circle."
                        },
                        radius: "Radius"
                    },
                    marker: {
                        tooltip: {
                            start: "Click map to place marker."
                        }
                    },
                    polygon: {
                        tooltip: {
                            start: "Click to start drawing shape.",
                            cont: "Click to continue drawing shape.",
                            end: "Click first point to close this shape."
                        }
                    },
                    polyline: {
                        error: "<strong>Error:</strong> shape edges cannot cross!",
                        tooltip: {
                            start: "Click to start drawing line.",
                            cont: "Click to continue drawing line.",
                            end: "Click last point to finish line."
                        }
                    },
                    rectangle: {
                        tooltip: {
                            start: "Click and drag to draw rectangle."
                        }
                    },
                    simpleshape: {
                        tooltip: {
                            end: "Release mouse to finish drawing."
                        }
                    }
                }
            },
            edit: {
                toolbar: {
                    actions: {
                        save: {
                            title: "Save changes.",
                            text: "Save"
                        },
                        cancel: {
                            title: "Cancel editing, discards all changes.",
                            text: "Cancel"
                        }
                    },
                    buttons: {
                        edit: "Edit layers.",
                        editDisabled: "No layers to edit.",
                        remove: "Delete layers.",
                        removeDisabled: "No layers to delete."
                    }
                },
                handlers: {
                    edit: {
                        tooltip: {
                            text: "Drag handles, or marker to edit feature.",
                            subtext: "Click cancel to undo changes."
                        }
                    },
                    remove: {
                        tooltip: {
                            text: "Click on a feature to remove"
                        }
                    }
                }
            }
        }, L.Draw = {}, L.Draw.Feature = L.Handler.extend({
            includes: L.Mixin.Events,
            initialize: function(e, t) {
                this._map = e, this._container = e._container, this._overlayPane = e._panes.overlayPane, this._popupPane = e._panes.popupPane, t && t.shapeOptions && (t.shapeOptions = L.Util.extend({}, this.options.shapeOptions, t.shapeOptions)), L.setOptions(this, t)
            },
            enable: function() {
                if (this._enabled) return;
                L.Handler.prototype.enable.call(this), this.fire("enabled", {
                    handler: this.type
                }), this._map.fire("draw:drawstart", {
                    layerType: this.type
                })
            },
            disable: function() {
                if (!this._enabled) return;
                L.Handler.prototype.disable.call(this), this._map.fire("draw:drawstop", {
                    layerType: this.type
                }), this.fire("disabled", {
                    handler: this.type
                })
            },
            addHooks: function() {
                var e = this._map;
                e && (L.DomUtil.disableTextSelection(), e.getContainer().focus(), this._tooltip = new L.Tooltip(this._map), L.DomEvent.on(this._container, "keyup", this._cancelDrawing, this))
            },
            removeHooks: function() {
                this._map && (L.DomUtil.enableTextSelection(), this._tooltip.dispose(), this._tooltip = null, L.DomEvent.off(this._container, "keyup", this._cancelDrawing, this))
            },
            setOptions: function(e) {
                L.setOptions(this, e)
            },
            _fireCreatedEvent: function(e) {
                this._map.fire("draw:created", {
                    layer: e,
                    layerType: this.type
                })
            },
            _cancelDrawing: function(e) {
                e.keyCode === 27 && this.disable()
            }
        }), L.Draw.Polyline = L.Draw.Feature.extend({
            statics: {
                TYPE: "polyline"
            },
            Poly: L.Polyline,
            options: {
                allowIntersection: !0,
                repeatMode: !1,
                drawError: {
                    color: "#b00b00",
                    timeout: 2500
                },
                icon: new L.DivIcon({
                    iconSize: new L.Point(8, 8),
                    className: "leaflet-div-icon leaflet-editing-icon"
                }),
                guidelineDistance: 20,
                maxGuideLineLength: 4e3,
                shapeOptions: {
                    stroke: !0,
                    color: "#f06eaa",
                    weight: 4,
                    opacity: .5,
                    fill: !1,
                    clickable: !0
                },
                metric: !0,
                showLength: !0,
                zIndexOffset: 2e3
            },
            initialize: function(e, t) {
                this.options.drawError.message = L.drawLocal.draw.handlers.polyline.error, t && t.drawError && (t.drawError = L.Util.extend({}, this.options.drawError, t.drawError)), this.type = L.Draw.Polyline.TYPE, L.Draw.Feature.prototype.initialize.call(this, e, t)
            },
            addHooks: function() {
                L.Draw.Feature.prototype.addHooks.call(this), this._map && (this._markers = [], this._markerGroup = new L.LayerGroup, this._map.addLayer(this._markerGroup), this._poly = new L.Polyline([], this.options.shapeOptions), this._tooltip.updateContent(this._getTooltipText()), this._mouseMarker || (this._mouseMarker = L.marker(this._map.getCenter(), {
                    icon: L.divIcon({
                        className: "leaflet-mouse-marker",
                        iconAnchor: [20, 20],
                        iconSize: [40, 40]
                    }),
                    opacity: 0,
                    zIndexOffset: this.options.zIndexOffset
                })), this._mouseMarker.on("mousedown", this._onMouseDown, this).addTo(this._map), this._map.on("mousemove", this._onMouseMove, this).on("mouseup", this._onMouseUp, this).on("zoomend", this._onZoomEnd, this))
            },
            removeHooks: function() {
                L.Draw.Feature.prototype.removeHooks.call(this), this._clearHideErrorTimeout(), this._cleanUpShape(), this._map.removeLayer(this._markerGroup), delete this._markerGroup, delete this._markers, this._map.removeLayer(this._poly), delete this._poly, this._mouseMarker.off("mousedown", this._onMouseDown, this).off("mouseup", this._onMouseUp, this), this._map.removeLayer(this._mouseMarker), delete this._mouseMarker, this._clearGuides(), this._map.off("mousemove", this._onMouseMove, this).off("zoomend", this._onZoomEnd, this)
            },
            deleteLastVertex: function() {
                if (this._markers.length <= 1) return;
                var e = this._markers.pop(),
                    t = this._poly,
                    n = this._poly.spliceLatLngs(t.getLatLngs().length - 1, 1)[0];
                this._markerGroup.removeLayer(e), t.getLatLngs().length < 2 && this._map.removeLayer(t), this._vertexChanged(n, !1)
            },
            addVertex: function(e) {
                var t = this._markers.length;
                if (t > 0 && !this.options.allowIntersection && this._poly.newLatLngIntersects(e)) {
                    this._showErrorTooltip();
                    return
                }
                this._errorShown && this._hideErrorTooltip(), this._markers.push(this._createMarker(e)), this._poly.addLatLng(e), this._poly.getLatLngs().length === 2 && this._map.addLayer(this._poly), this._vertexChanged(e, !0)
            },
            _finishShape: function() {
                var e = this._poly.newLatLngIntersects(this._poly.getLatLngs()[0], !0);
                if (!this.options.allowIntersection && e || !this._shapeIsValid()) {
                    this._showErrorTooltip();
                    return
                }
                this._fireCreatedEvent(), this.disable(), this.options.repeatMode && this.enable()
            },
            _shapeIsValid: function() {
                return !0
            },
            _onZoomEnd: function() {
                this._updateGuide()
            },
            _onMouseMove: function(e) {
                var t = e.layerPoint,
                    n = e.latlng;
                this._currentLatLng = n, this._updateTooltip(n), this._updateGuide(t), this._mouseMarker.setLatLng(n), L.DomEvent.preventDefault(e.originalEvent)
            },
            _vertexChanged: function(e, t) {
                this._updateFinishHandler(), this._updateRunningMeasure(e, t), this._clearGuides(), this._updateTooltip()
            },
            _onMouseDown: function(e) {
                var t = e.originalEvent;
                this._mouseDownOrigin = L.point(t.clientX, t.clientY)
            },
            _onMouseUp: function(t) {
                if (this._mouseDownOrigin) {
                    var n = L.point(t.originalEvent.clientX, t.originalEvent.clientY).distanceTo(this._mouseDownOrigin);
                    Math.abs(n) < 9 * (e.devicePixelRatio || 1) && this.addVertex(t.latlng)
                }
                this._mouseDownOrigin = null
            },
            _updateFinishHandler: function() {
                var e = this._markers.length;
                e > 1 && this._markers[e - 1].on("click", this._finishShape, this), e > 2 && this._markers[e - 2].off("click", this._finishShape, this)
            },
            _createMarker: function(e) {
                var t = new L.Marker(e, {
                    icon: this.options.icon,
                    zIndexOffset: this.options.zIndexOffset * 2
                });
                return this._markerGroup.addLayer(t), t
            },
            _updateGuide: function(e) {
                var t = this._markers.length;
                t > 0 && (e = e || this._map.latLngToLayerPoint(this._currentLatLng), this._clearGuides(), this._drawGuide(this._map.latLngToLayerPoint(this._markers[t - 1].getLatLng()), e))
            },
            _updateTooltip: function(e) {
                var t = this._getTooltipText();
                e && this._tooltip.updatePosition(e), this._errorShown || this._tooltip.updateContent(t)
            },
            _drawGuide: function(e, t) {
                var n = Math.floor(Math.sqrt(Math.pow(t.x - e.x, 2) + Math.pow(t.y - e.y, 2))),
                    r = this.options.guidelineDistance,
                    i = this.options.maxGuideLineLength,
                    s = n > i ? n - i : r,
                    o, u, a;
                this._guidesContainer || (this._guidesContainer = L.DomUtil.create("div", "leaflet-draw-guides", this._overlayPane));
                for (; s < n; s += this.options.guidelineDistance) o = s / n, u = {
                    x: Math.floor(e.x * (1 - o) + o * t.x),
                    y: Math.floor(e.y * (1 - o) + o * t.y)
                }, a = L.DomUtil.create("div", "leaflet-draw-guide-dash", this._guidesContainer), a.style.backgroundColor = this._errorShown ? this.options.drawError.color : this.options.shapeOptions.color, L.DomUtil.setPosition(a, u)
            },
            _updateGuideColor: function(e) {
                if (this._guidesContainer)
                    for (var t = 0, n = this._guidesContainer.childNodes.length; t < n; t++) this._guidesContainer.childNodes[t].style.backgroundColor = e
            },
            _clearGuides: function() {
                if (this._guidesContainer)
                    while (this._guidesContainer.firstChild) this._guidesContainer.removeChild(this._guidesContainer.firstChild)
            },
            _getTooltipText: function() {
                var e = this.options.showLength,
                    t, n;
                return this._markers.length === 0 ? t = {
                    text: L.drawLocal.draw.handlers.polyline.tooltip.start
                } : (n = e ? this._getMeasurementString() : "", this._markers.length === 1 ? t = {
                    text: L.drawLocal.draw.handlers.polyline.tooltip.cont,
                    subtext: n
                } : t = {
                    text: L.drawLocal.draw.handlers.polyline.tooltip.end,
                    subtext: n
                }), t
            },
            _updateRunningMeasure: function(e, t) {
                var n = this._markers.length,
                    r, i;
                this._markers.length === 1 ? this._measurementRunningTotal = 0 : (r = n - (t ? 2 : 1), i = e.distanceTo(this._markers[r].getLatLng()), this._measurementRunningTotal += i * (t ? 1 : -1))
            },
            _getMeasurementString: function() {
                var e = this._currentLatLng,
                    t = this._markers[this._markers.length - 1].getLatLng(),
                    n;
                return n = this._measurementRunningTotal + e.distanceTo(t), L.GeometryUtil.readableDistance(n, this.options.metric)
            },
            _showErrorTooltip: function() {
                this._errorShown = !0, this._tooltip.showAsError().updateContent({
                    text: this.options.drawError.message
                }), this._updateGuideColor(this.options.drawError.color), this._poly.setStyle({
                    color: this.options.drawError.color
                }), this._clearHideErrorTimeout(), this._hideErrorTimeout = setTimeout(L.Util.bind(this._hideErrorTooltip, this), this.options.drawError.timeout)
            },
            _hideErrorTooltip: function() {
                this._errorShown = !1, this._clearHideErrorTimeout(), this._tooltip.removeError().updateContent(this._getTooltipText()), this._updateGuideColor(this.options.shapeOptions.color), this._poly.setStyle({
                    color: this.options.shapeOptions.color
                })
            },
            _clearHideErrorTimeout: function() {
                this._hideErrorTimeout && (clearTimeout(this._hideErrorTimeout), this._hideErrorTimeout = null)
            },
            _cleanUpShape: function() {
                this._markers.length > 1 && this._markers[this._markers.length - 1].off("click", this._finishShape, this)
            },
            _fireCreatedEvent: function() {
                var e = new this.Poly(this._poly.getLatLngs(), this.options.shapeOptions);
                L.Draw.Feature.prototype._fireCreatedEvent.call(this, e)
            }
        }), L.Draw.Polygon = L.Draw.Polyline.extend({
            statics: {
                TYPE: "polygon"
            },
            Poly: L.Polygon,
            options: {
                showArea: !1,
                shapeOptions: {
                    stroke: !0,
                    color: "#f06eaa",
                    weight: 4,
                    opacity: .5,
                    fill: !0,
                    fillColor: null,
                    fillOpacity: .2,
                    clickable: !0
                }
            },
            initialize: function(e, t) {
                L.Draw.Polyline.prototype.initialize.call(this, e, t), this.type = L.Draw.Polygon.TYPE
            },
            _updateFinishHandler: function() {
                var e = this._markers.length;
                e === 1 && this._markers[0].on("click", this._finishShape, this), e > 2 && (this._markers[e - 1].on("dblclick", this._finishShape, this), e > 3 && this._markers[e - 2].off("dblclick", this._finishShape, this))
            },
            _getTooltipText: function() {
                var e, t;
                return this._markers.length === 0 ? e = L.drawLocal.draw.handlers.polygon.tooltip.start : this._markers.length < 3 ? e = L.drawLocal.draw.handlers.polygon.tooltip.cont : (e = L.drawLocal.draw.handlers.polygon.tooltip.end, t = this._getMeasurementString()), {
                    text: e,
                    subtext: t
                }
            },
            _getMeasurementString: function() {
                var e = this._area;
                return e ? L.GeometryUtil.readableArea(e, this.options.metric) : null
            },
            _shapeIsValid: function() {
                return this._markers.length >= 3
            },
            _vertexChanged: function(e, t) {
                var n;
                !this.options.allowIntersection && this.options.showArea && (n = this._poly.getLatLngs(), this._area = L.GeometryUtil.geodesicArea(n)), L.Draw.Polyline.prototype._vertexChanged.call(this, e, t)
            },
            _cleanUpShape: function() {
                var e = this._markers.length;
                e > 0 && (this._markers[0].off("click", this._finishShape, this), e > 2 && this._markers[e - 1].off("dblclick", this._finishShape, this))
            }
        }), L.SimpleShape = {}, L.Draw.SimpleShape = L.Draw.Feature.extend({
            options: {
                repeatMode: !1
            },
            initialize: function(e, t) {
                this._endLabelText = L.drawLocal.draw.handlers.simpleshape.tooltip.end, L.Draw.Feature.prototype.initialize.call(this, e, t)
            },
            addHooks: function() {
                L.Draw.Feature.prototype.addHooks.call(this), this._map && (this._mapDraggable = this._map.dragging.enabled(), this._mapDraggable && this._map.dragging.disable(), this._container.style.cursor = "crosshair", this._tooltip.updateContent({
                    text: this._initialLabelText
                }), this._map.on("mousedown", this._onMouseDown, this).on("mousemove", this._onMouseMove, this))
            },
            removeHooks: function() {
                L.Draw.Feature.prototype.removeHooks.call(this), this._map && (this._mapDraggable && this._map.dragging.enable(), this._container.style.cursor = "", this._map.off("mousedown", this._onMouseDown, this).off("mousemove", this._onMouseMove, this), L.DomEvent.off(t, "mouseup", this._onMouseUp, this), this._shape && (this._map.removeLayer(this._shape), delete this._shape)), this._isDrawing = !1
            },
            _getTooltipText: function() {
                return {
                    text: this._endLabelText
                }
            },
            _onMouseDown: function(e) {
                this._isDrawing = !0, this._startLatLng = e.latlng, L.DomEvent.on(t, "mouseup", this._onMouseUp, this).preventDefault(e.originalEvent)
            },
            _onMouseMove: function(e) {
                var t = e.latlng;
                this._tooltip.updatePosition(t), this._isDrawing && (this._tooltip.updateContent(this._getTooltipText()), this._drawShape(t))
            },
            _onMouseUp: function() {
                this._shape && this._fireCreatedEvent(), this.disable(), this.options.repeatMode && this.enable()
            }
        }), L.Draw.Rectangle = L.Draw.SimpleShape.extend({
            statics: {
                TYPE: "rectangle"
            },
            options: {
                shapeOptions: {
                    stroke: !0,
                    color: "#f06eaa",
                    weight: 4,
                    opacity: .5,
                    fill: !0,
                    fillColor: null,
                    fillOpacity: .2,
                    clickable: !0
                },
                showAres: !0,
                metric: !0
            },
            initialize: function(e, t) {
                this.type = L.Draw.Rectangle.TYPE, this._initialLabelText = L.drawLocal.draw.handlers.rectangle.tooltip.start, L.Draw.SimpleShape.prototype.initialize.call(this, e, t)
            },
            _drawShape: function(e) {
                this._shape ? this._shape.setBounds(new L.LatLngBounds(this._startLatLng, e)) : (this._shape = new L.Rectangle(new L.LatLngBounds(this._startLatLng, e), this.options.shapeOptions), this._map.addLayer(this._shape))
            },
            _fireCreatedEvent: function() {
                var e = new L.Rectangle(this._shape.getBounds(), this.options.shapeOptions);
                L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this, e)
            },
            _getTooltipText: function() {
                var e = L.Draw.SimpleShape.prototype._getTooltipText.call(this),
                    t = this._shape,
                    n, r, i;
                return t && (n = this._shape.getLatLngs(), this.options.showArea && (r = L.GeometryUtil.geodesicArea(n), i = L.GeometryUtil.readableArea(r, this.options.metric))), {
                    text: e.text,
                    subtext: i
                }
            }
        }), L.Draw.Circle = L.Draw.SimpleShape.extend({
            statics: {
                TYPE: "circle"
            },
            options: {
                shapeOptions: {
                    stroke: !0,
                    color: "#f06eaa",
                    weight: 4,
                    opacity: .5,
                    fill: !0,
                    fillColor: null,
                    fillOpacity: .2,
                    clickable: !0
                },
                showRadius: !0,
                metric: !0
            },
            initialize: function(e, t) {
                this.type = L.Draw.Circle.TYPE, this._initialLabelText = L.drawLocal.draw.handlers.circle.tooltip.start, L.Draw.SimpleShape.prototype.initialize.call(this, e, t)
            },
            _drawShape: function(e) {
                this._shape ? this._shape.setRadius(this._startLatLng.distanceTo(e)) : (this._shape = new L.Circle(this._startLatLng, this._startLatLng.distanceTo(e), this.options.shapeOptions), this._map.addLayer(this._shape))
            },
            _fireCreatedEvent: function() {
                var e = new L.Circle(this._startLatLng, this._shape.getRadius(), this.options.shapeOptions);
                L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this, e)
            },
            _onMouseMove: function(e) {
                var t = e.latlng,
                    n = this.options.showRadius,
                    r = this.options.metric,
                    i;
                this._tooltip.updatePosition(t), this._isDrawing && (this._drawShape(t), i = this._shape.getRadius().toFixed(1), this._tooltip.updateContent({
                    text: this._endLabelText,
                    subtext: n ? L.drawLocal.draw.handlers.circle.radius + ": " + L.GeometryUtil.readableDistance(i, r) : ""
                }))
            }
        }), L.Draw.Marker = L.Draw.Feature.extend({
            statics: {
                TYPE: "marker"
            },
            options: {
                icon: new L.Icon.Default,
                repeatMode: !1,
                zIndexOffset: 2e3
            },
            initialize: function(e, t) {
                this.type = L.Draw.Marker.TYPE, L.Draw.Feature.prototype.initialize.call(this, e, t)
            },
            addHooks: function() {
                L.Draw.Feature.prototype.addHooks.call(this), this._map && (this._tooltip.updateContent({
                    text: L.drawLocal.draw.handlers.marker.tooltip.start
                }), this._mouseMarker || (this._mouseMarker = L.marker(this._map.getCenter(), {
                    icon: L.divIcon({
                        className: "leaflet-mouse-marker",
                        iconAnchor: [20, 20],
                        iconSize: [40, 40]
                    }),
                    opacity: 0,
                    zIndexOffset: this.options.zIndexOffset
                })), this._mouseMarker.on("click", this._onClick, this).addTo(this._map), this._map.on("mousemove", this._onMouseMove, this))
            },
            removeHooks: function() {
                L.Draw.Feature.prototype.removeHooks.call(this), this._map && (this._marker && (this._marker.off("click", this._onClick, this), this._map.off("click", this._onClick, this).removeLayer(this._marker), delete this._marker), this._mouseMarker.off("click", this._onClick, this), this._map.removeLayer(this._mouseMarker), delete this._mouseMarker, this._map.off("mousemove", this._onMouseMove, this))
            },
            _onMouseMove: function(e) {
                var t = e.latlng;
                this._tooltip.updatePosition(t), this._mouseMarker.setLatLng(t), this._marker ? (t = this._mouseMarker.getLatLng(), this._marker.setLatLng(t)) : (this._marker = new L.Marker(t, {
                    icon: this.options.icon,
                    zIndexOffset: this.options.zIndexOffset
                }), this._marker.on("click", this._onClick, this), this._map.on("click", this._onClick, this).addLayer(this._marker))
            },
            _onClick: function() {
                this._fireCreatedEvent(), this.disable(), this.options.repeatMode && this.enable()
            },
            _fireCreatedEvent: function() {
                var e = new L.Marker(this._marker.getLatLng(), {
                    icon: this.options.icon
                });
                L.Draw.Feature.prototype._fireCreatedEvent.call(this, e)
            }
        }), L.Edit = L.Edit || {}, L.Edit.Marker = L.Handler.extend({
            initialize: function(e, t) {
                this._marker = e, L.setOptions(this, t)
            },
            addHooks: function() {
                var e = this._marker;
                e.dragging.enable(), e.on("dragend", this._onDragEnd, e), this._toggleMarkerHighlight()
            },
            removeHooks: function() {
                var e = this._marker;
                e.dragging.disable(), e.off("dragend", this._onDragEnd, e), this._toggleMarkerHighlight()
            },
            _onDragEnd: function(e) {
                var t = e.target;
                t.edited = !0
            },
            _toggleMarkerHighlight: function() {
                if (!this._icon) return;
                var e = this._icon;
                e.style.display = "none", L.DomUtil.hasClass(e, "leaflet-edit-marker-selected") ? (L.DomUtil.removeClass(e, "leaflet-edit-marker-selected"), this._offsetMarker(e, -4)) : (L.DomUtil.addClass(e, "leaflet-edit-marker-selected"), this._offsetMarker(e, 4)), e.style.display = ""
            },
            _offsetMarker: function(e, t) {
                var n = parseInt(e.style.marginTop, 10) - t,
                    r = parseInt(e.style.marginLeft, 10) - t;
                e.style.marginTop = n + "px", e.style.marginLeft = r + "px"
            }
        }), L.Marker.addInitHook(function() {
            L.Edit.Marker && (this.editing = new L.Edit.Marker(this), this.options.editable && this.editing.enable())
        }), L.Edit = L.Edit || {}, L.Edit.Poly = L.Handler.extend({
            options: {
                icon: new L.DivIcon({
                    iconSize: new L.Point(8, 8),
                    className: "leaflet-div-icon leaflet-editing-icon"
                })
            },
            initialize: function(e, t) {
                this._poly = e, L.setOptions(this, t)
            },
            addHooks: function() {
                var e = this._poly;
                e instanceof L.Polygon || (e.options.editing.fill = !1), e.setStyle(e.options.editing), this._poly._map && (this._markerGroup || this._initMarkers(), this._poly._map.addLayer(this._markerGroup))
            },
            removeHooks: function() {
                var e = this._poly;
                e.setStyle(e.options.original), e._map && (e._map.removeLayer(this._markerGroup), delete this._markerGroup, delete this._markers)
            },
            updateMarkers: function() {
                this._markerGroup.clearLayers(), this._initMarkers()
            },
            _initMarkers: function() {
                this._markerGroup || (this._markerGroup = new L.LayerGroup), this._markers = [];
                var e = this._poly._latlngs,
                    t, n, r, i;
                for (t = 0, r = e.length; t < r; t++) i = this._createMarker(e[t], t), i.on("click", this._onMarkerClick, this), this._markers.push(i);
                var s, o;
                for (t = 0, n = r - 1; t < r; n = t++) {
                    if (t === 0 && !(L.Polygon && this._poly instanceof L.Polygon)) continue;
                    s = this._markers[n], o = this._markers[t], this._createMiddleMarker(s, o), this._updatePrevNext(s, o)
                }
            },
            _createMarker: function(e, t) {
                var n = new L.Marker(e, {
                    draggable: !0,
                    icon: this.options.icon
                });
                return n._origLatLng = e, n._index = t, n.on("drag", this._onMarkerDrag, this), n.on("dragend", this._fireEdit, this), this._markerGroup.addLayer(n), n
            },
            _removeMarker: function(e) {
                var t = e._index;
                this._markerGroup.removeLayer(e), this._markers.splice(t, 1), this._poly.spliceLatLngs(t, 1), this._updateIndexes(t, -1), e.off("drag", this._onMarkerDrag, this).off("dragend", this._fireEdit, this).off("click", this._onMarkerClick, this)
            },
            _fireEdit: function() {
                this._poly.edited = !0, this._poly.fire("edit")
            },
            _onMarkerDrag: function(e) {
                var t = e.target;
                L.extend(t._origLatLng, t._latlng), t._middleLeft && t._middleLeft.setLatLng(this._getMiddleLatLng(t._prev, t)), t._middleRight && t._middleRight.setLatLng(this._getMiddleLatLng(t, t._next)), this._poly.redraw()
            },
            _onMarkerClick: function(e) {
                var t = L.Polygon && this._poly instanceof L.Polygon ? 4 : 3,
                    n = e.target;
                if (this._poly._latlngs.length < t) return;
                this._removeMarker(n), this._updatePrevNext(n._prev, n._next), n._middleLeft && this._markerGroup.removeLayer(n._middleLeft), n._middleRight && this._markerGroup.removeLayer(n._middleRight), n._prev && n._next ? this._createMiddleMarker(n._prev, n._next) : n._prev ? n._next || (n._prev._middleRight = null) : n._next._middleLeft = null, this._fireEdit()
            },
            _updateIndexes: function(e, t) {
                this._markerGroup.eachLayer(function(n) {
                    n._index > e && (n._index += t)
                })
            },
            _createMiddleMarker: function(e, t) {
                var n = this._getMiddleLatLng(e, t),
                    r = this._createMarker(n),
                    i, s, o;
                r.setOpacity(.6), e._middleRight = t._middleLeft = r, s = function() {
                    var s = t._index;
                    r._index = s, r.off("click", i, this).on("click", this._onMarkerClick, this), n.lat = r.getLatLng().lat, n.lng = r.getLatLng().lng, this._poly.spliceLatLngs(s, 0, n), this._markers.splice(s, 0, r), r.setOpacity(1), this._updateIndexes(s, 1), t._index++, this._updatePrevNext(e, r), this._updatePrevNext(r, t), this._poly.fire("editstart")
                }, o = function() {
                    r.off("dragstart", s, this), r.off("dragend", o, this), this._createMiddleMarker(e, r), this._createMiddleMarker(r, t)
                }, i = function() {
                    s.call(this), o.call(this), this._fireEdit()
                }, r.on("click", i, this).on("dragstart", s, this).on("dragend", o, this), this._markerGroup.addLayer(r)
            },
            _updatePrevNext: function(e, t) {
                e && (e._next = t), t && (t._prev = e)
            },
            _getMiddleLatLng: function(e, t) {
                var n = this._poly._map,
                    r = n.project(e.getLatLng()),
                    i = n.project(t.getLatLng());
                return n.unproject(r._add(i)._divideBy(2))
            }
        }), L.Polyline.addInitHook(function() {
            if (this.editing) return;
            L.Edit.Poly && (this.editing = new L.Edit.Poly(this), this.options.editable && this.editing.enable()), this.on("add", function() {
                this.editing && this.editing.enabled() && this.editing.addHooks()
            }), this.on("remove", function() {
                this.editing && this.editing.enabled() && this.editing.removeHooks()
            })
        }), L.Edit = L.Edit || {}, L.Edit.SimpleShape = L.Handler.extend({
            options: {
                moveIcon: new L.DivIcon({
                    iconSize: new L.Point(8, 8),
                    className: "leaflet-div-icon leaflet-editing-icon leaflet-edit-move"
                }),
                resizeIcon: new L.DivIcon({
                    iconSize: new L.Point(8, 8),
                    className: "leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"
                })
            },
            initialize: function(e, t) {
                this._shape = e, L.Util.setOptions(this, t)
            },
            addHooks: function() {
                var e = this._shape;
                e.setStyle(e.options.editing), e._map && (this._map = e._map, this._markerGroup || this._initMarkers(), this._map.addLayer(this._markerGroup))
            },
            removeHooks: function() {
                var e = this._shape;
                e.setStyle(e.options.original);
                if (e._map) {
                    this._unbindMarker(this._moveMarker);
                    for (var t = 0, n = this._resizeMarkers.length; t < n; t++) this._unbindMarker(this._resizeMarkers[t]);
                    this._resizeMarkers = null, this._map.removeLayer(this._markerGroup), delete this._markerGroup
                }
                this._map = null
            },
            updateMarkers: function() {
                this._markerGroup.clearLayers(), this._initMarkers()
            },
            _initMarkers: function() {
                this._markerGroup || (this._markerGroup = new L.LayerGroup), this._createMoveMarker(), this._createResizeMarker()
            },
            _createMoveMarker: function() {},
            _createResizeMarker: function() {},
            _createMarker: function(e, t) {
                var n = new L.Marker(e, {
                    draggable: !0,
                    icon: t,
                    zIndexOffset: 10
                });
                return this._bindMarker(n), this._markerGroup.addLayer(n), n
            },
            _bindMarker: function(e) {
                e.on("dragstart", this._onMarkerDragStart, this).on("drag", this._onMarkerDrag, this).on("dragend", this._onMarkerDragEnd, this)
            },
            _unbindMarker: function(e) {
                e.off("dragstart", this._onMarkerDragStart, this).off("drag", this._onMarkerDrag, this).off("dragend", this._onMarkerDragEnd, this)
            },
            _onMarkerDragStart: function(e) {
                var t = e.target;
                t.setOpacity(0), this._shape.fire("editstart")
            },
            _fireEdit: function() {
                this._shape.edited = !0, this._shape.fire("edit")
            },
            _onMarkerDrag: function(e) {
                var t = e.target,
                    n = t.getLatLng();
                t === this._moveMarker ? this._move(n) : this._resize(n), this._shape.redraw()
            },
            _onMarkerDragEnd: function(e) {
                var t = e.target;
                t.setOpacity(1), this._fireEdit()
            },
            _move: function() {},
            _resize: function() {}
        }), L.Edit = L.Edit || {}, L.Edit.Rectangle = L.Edit.SimpleShape.extend({
            _createMoveMarker: function() {
                var e = this._shape.getBounds(),
                    t = e.getCenter();
                this._moveMarker = this._createMarker(t, this.options.moveIcon)
            },
            _createResizeMarker: function() {
                var e = this._getCorners();
                this._resizeMarkers = [];
                for (var t = 0, n = e.length; t < n; t++) this._resizeMarkers.push(this._createMarker(e[t], this.options.resizeIcon)), this._resizeMarkers[t]._cornerIndex = t
            },
            _onMarkerDragStart: function(e) {
                L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this, e);
                var t = this._getCorners(),
                    n = e.target,
                    r = n._cornerIndex;
                this._oppositeCorner = t[(r + 2) % 4], this._toggleCornerMarkers(0, r)
            },
            _onMarkerDragEnd: function(e) {
                var t = e.target,
                    n, r;
                t === this._moveMarker && (n = this._shape.getBounds(), r = n.getCenter(), t.setLatLng(r)), this._toggleCornerMarkers(1), this._repositionCornerMarkers(), L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this, e)
            },
            _move: function(e) {
                var t = this._shape.getLatLngs(),
                    n = this._shape.getBounds(),
                    r = n.getCenter(),
                    i, s = [];
                for (var o = 0, u = t.length; o < u; o++) i = [t[o].lat - r.lat, t[o].lng - r.lng], s.push([e.lat + i[0], e.lng + i[1]]);
                this._shape.setLatLngs(s), this._repositionCornerMarkers()
            },
            _resize: function(e) {
                var t;
                this._shape.setBounds(L.latLngBounds(e, this._oppositeCorner)), t = this._shape.getBounds(), this._moveMarker.setLatLng(t.getCenter())
            },
            _getCorners: function() {
                var e = this._shape.getBounds(),
                    t = e.getNorthWest(),
                    n = e.getNorthEast(),
                    r = e.getSouthEast(),
                    i = e.getSouthWest();
                return [t, n, r, i]
            },
            _toggleCornerMarkers: function(e) {
                for (var t = 0, n = this._resizeMarkers.length; t < n; t++) this._resizeMarkers[t].setOpacity(e)
            },
            _repositionCornerMarkers: function() {
                var e = this._getCorners();
                for (var t = 0, n = this._resizeMarkers.length; t < n; t++) this._resizeMarkers[t].setLatLng(e[t])
            }
        }), L.Rectangle.addInitHook(function() {
            L.Edit.Rectangle && (this.editing = new L.Edit.Rectangle(this), this.options.editable && this.editing.enable())
        }), L.Edit = L.Edit || {}, L.Edit.Circle = L.Edit.SimpleShape.extend({
            _createMoveMarker: function() {
                var e = this._shape.getLatLng();
                this._moveMarker = this._createMarker(e, this.options.moveIcon)
            },
            _createResizeMarker: function() {
                var e = this._shape.getLatLng(),
                    t = this._getResizeMarkerPoint(e);
                this._resizeMarkers = [], this._resizeMarkers.push(this._createMarker(t, this.options.resizeIcon))
            },
            _getResizeMarkerPoint: function(e) {
                var t = this._shape._radius * Math.cos(Math.PI / 4),
                    n = this._map.project(e);
                return this._map.unproject([n.x + t, n.y - t])
            },
            _move: function(e) {
                var t = this._getResizeMarkerPoint(e);
                this._resizeMarkers[0].setLatLng(t), this._shape.setLatLng(e)
            },
            _resize: function(e) {
                var t = this._moveMarker.getLatLng(),
                    n = t.distanceTo(e);
                this._shape.setRadius(n)
            }
        }), L.Circle.addInitHook(function() {
            L.Edit.Circle && (this.editing = new L.Edit.Circle(this), this.options.editable && this.editing.enable()), this.on("add", function() {
                this.editing && this.editing.enabled() && this.editing.addHooks()
            }), this.on("remove", function() {
                this.editing && this.editing.enabled() && this.editing.removeHooks()
            })
        }), L.LatLngUtil = {
            cloneLatLngs: function(e) {
                var t = [];
                for (var n = 0, r = e.length; n < r; n++) t.push(this.cloneLatLng(e[n]));
                return t
            },
            cloneLatLng: function(e) {
                return L.latLng(e.lat, e.lng)
            }
        }, L.GeometryUtil = L.extend(L.GeometryUtil || {}, {
            geodesicArea: function(e) {
                var t = e.length,
                    n = 0,
                    r = L.LatLng.DEG_TO_RAD,
                    i, s;
                if (t > 2) {
                    for (var o = 0; o < t; o++) i = e[o], s = e[(o + 1) % t], n += (s.lng - i.lng) * r * (2 + Math.sin(i.lat * r) + Math.sin(s.lat * r));
                    n = n * 6378137 * 6378137 / 2
                }
                return Math.abs(n)
            },
            readableArea: function(e, t) {
                var n;
                return t ? e >= 1e4 ? n = (e * 1e-4).toFixed(2) + " ha" : n = e.toFixed(2) + " m&sup2;" : (e /= .836127, e >= 3097600 ? n = (e / 3097600).toFixed(2) + " mi&sup2;" : e >= 4840 ? n = (e / 4840).toFixed(2) + " acres" : n = Math.ceil(e) + " yd&sup2;"), n
            },
            readableDistance: function(e, t) {
                var n;
                return t ? e > 1e3 ? n = (e / 1e3).toFixed(2) + " km" : n = Math.ceil(e) + " m" : (e *= 1.09361, e > 1760 ? n = (e / 1760).toFixed(2) + " miles" : n = Math.ceil(e) + " yd"), n
            }
        }), L.Util.extend(L.LineUtil, {
            segmentsIntersect: function(e, t, n, r) {
                return this._checkCounterclockwise(e, n, r) !== this._checkCounterclockwise(t, n, r) && this._checkCounterclockwise(e, t, n) !== this._checkCounterclockwise(e, t, r)
            },
            _checkCounterclockwise: function(e, t, n) {
                return (n.y - e.y) * (t.x - e.x) > (t.y - e.y) * (n.x - e.x)
            }
        }), L.Polyline.include({
            intersects: function() {
                var e = this._originalPoints,
                    t = e ? e.length : 0,
                    n, r, i;
                if (this._tooFewPointsForIntersection()) return !1;
                for (n = t - 1; n >= 3; n--) {
                    r = e[n - 1], i = e[n];
                    if (this._lineSegmentsIntersectsRange(r, i, n - 2)) return !0
                }
                return !1
            },
            newLatLngIntersects: function(e, t) {
                return this._map ? this.newPointIntersects(this._map.latLngToLayerPoint(e), t) : !1
            },
            newPointIntersects: function(e, t) {
                var n = this._originalPoints,
                    r = n ? n.length : 0,
                    i = n ? n[r - 1] : null,
                    s = r - 2;
                return this._tooFewPointsForIntersection(1) ? !1 : this._lineSegmentsIntersectsRange(i, e, s, t ? 1 : 0)
            },
            _tooFewPointsForIntersection: function(e) {
                var t = this._originalPoints,
                    n = t ? t.length : 0;
                return n += e || 0, !this._originalPoints || n <= 3
            },
            _lineSegmentsIntersectsRange: function(e, t, n, r) {
                var i = this._originalPoints,
                    s, o;
                r = r || 0;
                for (var u = n; u > r; u--) {
                    s = i[u - 1], o = i[u];
                    if (L.LineUtil.segmentsIntersect(e, t, s, o)) return !0
                }
                return !1
            }
        }), L.Polygon.include({
            intersects: function() {
                var e, t = this._originalPoints,
                    n, r, i, s;
                return this._tooFewPointsForIntersection() ? !1 : (e = L.Polyline.prototype.intersects.call(this), e ? !0 : (n = t.length, r = t[0], i = t[n - 1], s = n - 2, this._lineSegmentsIntersectsRange(i, r, s, 1)))
            }
        }), L.Control.Draw = L.Control.extend({
            options: {
                position: "topleft",
                draw: {},
                edit: !1
            },
            initialize: function(e) {
                if (L.version < "0.7") throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");
                L.Control.prototype.initialize.call(this, e);
                var t;
                this._toolbars = {}, L.DrawToolbar && this.options.draw && (t = new L.DrawToolbar(this.options.draw), this._toolbars[L.DrawToolbar.TYPE] = t, this._toolbars[L.DrawToolbar.TYPE].on("enable", this._toolbarEnabled, this)), L.EditToolbar && this.options.edit && (t = new L.EditToolbar(this.options.edit), this._toolbars[L.EditToolbar.TYPE] = t, this._toolbars[L.EditToolbar.TYPE].on("enable", this._toolbarEnabled, this))
            },
            onAdd: function(e) {
                var t = L.DomUtil.create("div", "leaflet-draw"),
                    n = !1,
                    r = "leaflet-draw-toolbar-top",
                    i;
                for (var s in this._toolbars) this._toolbars.hasOwnProperty(s) && (i = this._toolbars[s].addToolbar(e), i && (n || (L.DomUtil.hasClass(i, r) || L.DomUtil.addClass(i.childNodes[0], r), n = !0), t.appendChild(i)));
                return t
            },
            onRemove: function() {
                for (var e in this._toolbars) this._toolbars.hasOwnProperty(e) && this._toolbars[e].removeToolbar()
            },
            setDrawingOptions: function(e) {
                for (var t in this._toolbars) this._toolbars[t] instanceof L.DrawToolbar && this._toolbars[t].setOptions(e)
            },
            _toolbarEnabled: function(e) {
                var t = e.target;
                for (var n in this._toolbars) this._toolbars[n] !== t && this._toolbars[n].disable()
            }
        }), L.Map.mergeOptions({
            drawControlTooltips: !0,
            drawControl: !1
        }), L.Map.addInitHook(function() {
            this.options.drawControl && (this.drawControl = new L.Control.Draw, this.addControl(this.drawControl))
        }), L.Toolbar = L.Class.extend({
            includes: [L.Mixin.Events],
            initialize: function(e) {
                L.setOptions(this, e), this._modes = {}, this._actionButtons = [], this._activeMode = null
            },
            enabled: function() {
                return this._activeMode !== null
            },
            disable: function() {
                if (!this.enabled()) return;
                this._activeMode.handler.disable()
            },
            addToolbar: function(e) {
                var t = L.DomUtil.create("div", "leaflet-draw-section"),
                    n = 0,
                    r = this._toolbarClass || "",
                    i = this.getModeHandlers(e),
                    s;
                this._toolbarContainer = L.DomUtil.create("div", "leaflet-draw-toolbar leaflet-bar"), this._map = e;
                for (s = 0; s < i.length; s++) i[s].enabled && this._initModeHandler(i[s].handler, this._toolbarContainer, n++, r, i[s].title);
                if (!n) return;
                return this._lastButtonIndex = --n, this._actionsContainer = L.DomUtil.create("ul", "leaflet-draw-actions"), t.appendChild(this._toolbarContainer), t.appendChild(this._actionsContainer), t
            },
            removeToolbar: function() {
                for (var e in this._modes) this._modes.hasOwnProperty(e) && (this._disposeButton(this._modes[e].button, this._modes[e].handler.enable, this._modes[e].handler), this._modes[e].handler.disable(), this._modes[e].handler.off("enabled", this._handlerActivated, this).off("disabled", this._handlerDeactivated, this));
                this._modes = {};
                for (var t = 0, n = this._actionButtons.length; t < n; t++) this._disposeButton(this._actionButtons[t].button, this._actionButtons[t].callback, this);
                this._actionButtons = [], this._actionsContainer = null
            },
            _initModeHandler: function(e, t, n, r, i) {
                var s = e.type;
                this._modes[s] = {}, this._modes[s].handler = e, this._modes[s].button = this._createButton({
                    title: i,
                    className: r + "-" + s,
                    container: t,
                    callback: this._modes[s].handler.enable,
                    context: this._modes[s].handler
                }), this._modes[s].buttonIndex = n, this._modes[s].handler.on("enabled", this._handlerActivated, this).on("disabled", this._handlerDeactivated, this)
            },
            _createButton: function(e) {
                var t = L.DomUtil.create("a", e.className || "", e.container);
                return t.href = "#", e.text && (t.innerHTML = e.text), e.title && (t.title = e.title), L.DomEvent.on(t, "click", L.DomEvent.stopPropagation).on(t, "mousedown", L.DomEvent.stopPropagation).on(t, "dblclick", L.DomEvent.stopPropagation).on(t, "click", L.DomEvent.preventDefault).on(t, "click", e.callback, e.context), t
            },
            _disposeButton: function(e, t) {
                L.DomEvent.off(e, "click", L.DomEvent.stopPropagation).off(e, "mousedown", L.DomEvent.stopPropagation).off(e, "dblclick", L.DomEvent.stopPropagation).off(e, "click", L.DomEvent.preventDefault).off(e, "click", t)
            },
            _handlerActivated: function(e) {
                this.disable(), this._activeMode = this._modes[e.handler], L.DomUtil.addClass(this._activeMode.button, "leaflet-draw-toolbar-button-enabled"), this._showActionsToolbar(), this.fire("enable")
            },
            _handlerDeactivated: function() {
                this._hideActionsToolbar(), L.DomUtil.removeClass(this._activeMode.button, "leaflet-draw-toolbar-button-enabled"), this._activeMode = null, this.fire("disable")
            },
            _createActions: function(e) {
                var t = this._actionsContainer,
                    n = this.getActions(e),
                    r = n.length,
                    i, s, o, u;
                for (s = 0, o = this._actionButtons.length; s < o; s++) this._disposeButton(this._actionButtons[s].button, this._actionButtons[s].callback);
                this._actionButtons = [];
                while (t.firstChild) t.removeChild(t.firstChild);
                for (var a = 0; a < r; a++) {
                    if ("enabled" in n[a] && !n[a].enabled) continue;
                    i = L.DomUtil.create("li", "", t), u = this._createButton({
                        title: n[a].title,
                        text: n[a].text,
                        container: i,
                        callback: n[a].callback,
                        context: n[a].context
                    }), this._actionButtons.push({
                        button: u,
                        callback: n[a].callback
                    })
                }
            },
            _showActionsToolbar: function() {
                var e = this._activeMode.buttonIndex,
                    t = this._lastButtonIndex,
                    n = this._activeMode.button.offsetTop - 1;
                this._createActions(this._activeMode.handler), this._actionsContainer.style.top = n + "px", e === 0 && (L.DomUtil.addClass(this._toolbarContainer, "leaflet-draw-toolbar-notop"), L.DomUtil.addClass(this._actionsContainer, "leaflet-draw-actions-top")), e === t && (L.DomUtil.addClass(this._toolbarContainer, "leaflet-draw-toolbar-nobottom"), L.DomUtil.addClass(this._actionsContainer, "leaflet-draw-actions-bottom")), this._actionsContainer.style.display = "block"
            },
            _hideActionsToolbar: function() {
                this._actionsContainer.style.display = "none", L.DomUtil.removeClass(this._toolbarContainer, "leaflet-draw-toolbar-notop"), L.DomUtil.removeClass(this._toolbarContainer, "leaflet-draw-toolbar-nobottom"), L.DomUtil.removeClass(this._actionsContainer, "leaflet-draw-actions-top"), L.DomUtil.removeClass(this._actionsContainer, "leaflet-draw-actions-bottom")
            }
        }), L.Tooltip = L.Class.extend({
            initialize: function(e) {
                this._map = e, this._popupPane = e._panes.popupPane, this._container = e.options.drawControlTooltips ? L.DomUtil.create("div", "leaflet-draw-tooltip", this._popupPane) : null, this._singleLineLabel = !1
            },
            dispose: function() {
                this._container && (this._popupPane.removeChild(this._container), this._container = null)
            },
            updateContent: function(e) {
                return this._container ? (e.subtext = e.subtext || "", e.subtext.length === 0 && !this._singleLineLabel ? (L.DomUtil.addClass(this._container, "leaflet-draw-tooltip-single"), this._singleLineLabel = !0) : e.subtext.length > 0 && this._singleLineLabel && (L.DomUtil.removeClass(this._container, "leaflet-draw-tooltip-single"), this._singleLineLabel = !1), this._container.innerHTML = (e.subtext.length > 0 ? '<span class="leaflet-draw-tooltip-subtext">' + e.subtext + "</span>" + "<br />" : "") + "<span>" + e.text + "</span>", this) : this
            },
            updatePosition: function(e) {
                var t = this._map.latLngToLayerPoint(e),
                    n = this._container;
                return this._container && (n.style.visibility = "inherit", L.DomUtil.setPosition(n, t)), this
            },
            showAsError: function() {
                return this._container && L.DomUtil.addClass(this._container, "leaflet-error-draw-tooltip"), this
            },
            removeError: function() {
                return this._container && L.DomUtil.removeClass(this._container, "leaflet-error-draw-tooltip"), this
            }
        }), L.DrawToolbar = L.Toolbar.extend({
            statics: {
                TYPE: "draw"
            },
            options: {
                polyline: {},
                polygon: {},
                rectangle: {},
                circle: {},
                marker: {}
            },
            initialize: function(e) {
                for (var t in this.options) this.options.hasOwnProperty(t) && e[t] && (e[t] = L.extend({}, this.options[t], e[t]));
                this._toolbarClass = "leaflet-draw-draw", L.Toolbar.prototype.initialize.call(this, e)
            },
            getModeHandlers: function(e) {
                return [{
                    enabled: this.options.polyline,
                    handler: new L.Draw.Polyline(e, this.options.polyline),
                    title: L.drawLocal.draw.toolbar.buttons.polyline
                }, {
                    enabled: this.options.polygon,
                    handler: new L.Draw.Polygon(e, this.options.polygon),
                    title: L.drawLocal.draw.toolbar.buttons.polygon
                }, {
                    enabled: this.options.rectangle,
                    handler: new L.Draw.Rectangle(e, this.options.rectangle),
                    title: L.drawLocal.draw.toolbar.buttons.rectangle
                }, {
                    enabled: this.options.circle,
                    handler: new L.Draw.Circle(e, this.options.circle),
                    title: L.drawLocal.draw.toolbar.buttons.circle
                }, {
                    enabled: this.options.marker,
                    handler: new L.Draw.Marker(e, this.options.marker),
                    title: L.drawLocal.draw.toolbar.buttons.marker
                }]
            },
            getActions: function(e) {
                return [{
                    enabled: e.deleteLastVertex,
                    title: L.drawLocal.draw.toolbar.undo.title,
                    text: L.drawLocal.draw.toolbar.undo.text,
                    callback: e.deleteLastVertex,
                    context: e
                }, {
                    title: L.drawLocal.draw.toolbar.actions.title,
                    text: L.drawLocal.draw.toolbar.actions.text,
                    callback: this.disable,
                    context: this
                }]
            },
            setOptions: function(e) {
                L.setOptions(this, e);
                for (var t in this._modes) this._modes.hasOwnProperty(t) && e.hasOwnProperty(t) && this._modes[t].handler.setOptions(e[t])
            }
        }), L.EditToolbar = L.Toolbar.extend({
            statics: {
                TYPE: "edit"
            },
            options: {
                edit: {
                    selectedPathOptions: {
                        color: "#fe57a1",
                        opacity: .6,
                        dashArray: "10, 10",
                        fill: !0,
                        fillColor: "#fe57a1",
                        fillOpacity: .1,
                        maintainColor: !1
                    }
                },
                remove: {},
                featureGroup: null
            },
            initialize: function(e) {
                e.edit && (typeof e.edit.selectedPathOptions == "undefined" && (e.edit.selectedPathOptions = this.options.edit.selectedPathOptions), e.edit.selectedPathOptions = L.extend({}, this.options.edit.selectedPathOptions, e.edit.selectedPathOptions)), e.remove && (e.remove = L.extend({}, this.options.remove, e.remove)), this._toolbarClass = "leaflet-draw-edit", L.Toolbar.prototype.initialize.call(this, e), this._selectedFeatureCount = 0
            },
            getModeHandlers: function(e) {
                var t = this.options.featureGroup;
                return [{
                    enabled: this.options.edit,
                    handler: new L.EditToolbar.Edit(e, {
                        featureGroup: t,
                        selectedPathOptions: this.options.edit.selectedPathOptions
                    }),
                    title: L.drawLocal.edit.toolbar.buttons.edit
                }, {
                    enabled: this.options.remove,
                    handler: new L.EditToolbar.Delete(e, {
                        featureGroup: t
                    }),
                    title: L.drawLocal.edit.toolbar.buttons.remove
                }]
            },
            getActions: function() {
                return [{
                    title: L.drawLocal.edit.toolbar.actions.save.title,
                    text: L.drawLocal.edit.toolbar.actions.save.text,
                    callback: this._save,
                    context: this
                }, {
                    title: L.drawLocal.edit.toolbar.actions.cancel.title,
                    text: L.drawLocal.edit.toolbar.actions.cancel.text,
                    callback: this.disable,
                    context: this
                }]
            },
            addToolbar: function(e) {
                var t = L.Toolbar.prototype.addToolbar.call(this, e);
                return this._checkDisabled(), this.options.featureGroup.on("layeradd layerremove", this._checkDisabled, this), t
            },
            removeToolbar: function() {
                this.options.featureGroup.off("layeradd layerremove", this._checkDisabled, this), L.Toolbar.prototype.removeToolbar.call(this)
            },
            disable: function() {
                if (!this.enabled()) return;
                this._activeMode.handler.revertLayers(), L.Toolbar.prototype.disable.call(this)
            },
            _save: function() {
                this._activeMode.handler.save(), this._activeMode.handler.disable()
            },
            _checkDisabled: function() {
                var e = this.options.featureGroup,
                    t = e.getLayers().length !== 0,
                    n;
                this.options.edit && (n = this._modes[L.EditToolbar.Edit.TYPE].button, t ? L.DomUtil.removeClass(n, "leaflet-disabled") : L.DomUtil.addClass(n, "leaflet-disabled"), n.setAttribute("title", t ? L.drawLocal.edit.toolbar.buttons.edit : L.drawLocal.edit.toolbar.buttons.editDisabled)), this.options.remove && (n = this._modes[L.EditToolbar.Delete.TYPE].button, t ? L.DomUtil.removeClass(n, "leaflet-disabled") : L.DomUtil.addClass(n, "leaflet-disabled"), n.setAttribute("title", t ? L.drawLocal.edit.toolbar.buttons.remove : L.drawLocal.edit.toolbar.buttons.removeDisabled))
            }
        }), L.EditToolbar.Edit = L.Handler.extend({
            statics: {
                TYPE: "edit"
            },
            includes: L.Mixin.Events,
            initialize: function(e, t) {
                L.Handler.prototype.initialize.call(this, e), L.setOptions(this, t), this._featureGroup = t.featureGroup;
                if (!(this._featureGroup instanceof L.FeatureGroup)) throw new Error("options.featureGroup must be a L.FeatureGroup");
                this._uneditedLayerProps = {}, this.type = L.EditToolbar.Edit.TYPE
            },
            enable: function() {
                if (this._enabled || !this._hasAvailableLayers()) return;
                this.fire("enabled", {
                    handler: this.type
                }), this._map.fire("draw:editstart", {
                    handler: this.type
                }), L.Handler.prototype.enable.call(this), this._featureGroup.on("layeradd", this._enableLayerEdit, this).on("layerremove", this._disableLayerEdit, this)
            },
            disable: function() {
                if (!this._enabled) return;
                this._featureGroup.off("layeradd", this._enableLayerEdit, this).off("layerremove", this._disableLayerEdit, this), L.Handler.prototype.disable.call(this), this._map.fire("draw:editstop", {
                    handler: this.type
                }), this.fire("disabled", {
                    handler: this.type
                })
            },
            addHooks: function() {
                var e = this._map;
                e && (e.getContainer().focus(), this._featureGroup.eachLayer(this._enableLayerEdit, this), this._tooltip = new L.Tooltip(this._map), this._tooltip.updateContent({
                    text: L.drawLocal.edit.handlers.edit.tooltip.text,
                    subtext: L.drawLocal.edit.handlers.edit.tooltip.subtext
                }), this._map.on("mousemove", this._onMouseMove, this))
            },
            removeHooks: function() {
                this._map && (this._featureGroup.eachLayer(this._disableLayerEdit, this), this._uneditedLayerProps = {}, this._tooltip.dispose(), this._tooltip = null, this._map.off("mousemove", this._onMouseMove, this))
            },
            revertLayers: function() {
                this._featureGroup.eachLayer(function(e) {
                    this._revertLayer(e)
                }, this)
            },
            save: function() {
                var e = new L.LayerGroup;
                this._featureGroup.eachLayer(function(t) {
                    t.edited && (e.addLayer(t), t.edited = !1)
                }), this._map.fire("draw:edited", {
                    layers: e
                })
            },
            _backupLayer: function(e) {
                var t = L.Util.stamp(e);
                this._uneditedLayerProps[t] || (e instanceof L.Polyline || e instanceof L.Polygon || e instanceof L.Rectangle ? this._uneditedLayerProps[t] = {
                    latlngs: L.LatLngUtil.cloneLatLngs(e.getLatLngs())
                } : e instanceof L.Circle ? this._uneditedLayerProps[t] = {
                    latlng: L.LatLngUtil.cloneLatLng(e.getLatLng()),
                    radius: e.getRadius()
                } : e instanceof L.Marker && (this._uneditedLayerProps[t] = {
                    latlng: L.LatLngUtil.cloneLatLng(e.getLatLng())
                }))
            },
            _revertLayer: function(e) {
                var t = L.Util.stamp(e);
                e.edited = !1, this._uneditedLayerProps.hasOwnProperty(t) && (e instanceof L.Polyline || e instanceof L.Polygon || e instanceof L.Rectangle ? e.setLatLngs(this._uneditedLayerProps[t].latlngs) : e instanceof L.Circle ? (e.setLatLng(this._uneditedLayerProps[t].latlng), e.setRadius(this._uneditedLayerProps[t].radius)) : e instanceof L.Marker && e.setLatLng(this._uneditedLayerProps[t].latlng), e.fire("revert-edited", {
                    layer: e
                }))
            },
            _enableLayerEdit: function(e) {
                var t = e.layer || e.target || e,
                    n;
                this._backupLayer(t), this.options.selectedPathOptions && (n = L.Util.extend({}, this.options.selectedPathOptions), n.maintainColor && (n.color = t.options.color, n.fillColor = t.options.fillColor), t.options.original = L.extend({}, t.options), t.options.editing = n), t.editing.enable()
            },
            _disableLayerEdit: function(e) {
                var t = e.layer || e.target || e;
                t.edited = !1, t.editing.disable(), delete t.options.editing, delete t.options.original
            },
            _onMouseMove: function(e) {
                this._tooltip.updatePosition(e.latlng)
            },
            _hasAvailableLayers: function() {
                return this._featureGroup.getLayers().length !== 0
            }
        }), L.EditToolbar.Delete = L.Handler.extend({
            statics: {
                TYPE: "remove"
            },
            includes: L.Mixin.Events,
            initialize: function(e, t) {
                L.Handler.prototype.initialize.call(this, e), L.Util.setOptions(this, t), this._deletableLayers = this.options.featureGroup;
                if (!(this._deletableLayers instanceof L.FeatureGroup)) throw new Error("options.featureGroup must be a L.FeatureGroup");
                this.type = L.EditToolbar.Delete.TYPE
            },
            enable: function() {
                if (this._enabled || !this._hasAvailableLayers()) return;
                this.fire("enabled", {
                    handler: this.type
                }), this._map.fire("draw:deletestart", {
                    handler: this.type
                }), L.Handler.prototype.enable.call(this), this._deletableLayers.on("layeradd", this._enableLayerDelete, this).on("layerremove", this._disableLayerDelete, this)
            },
            disable: function() {
                if (!this._enabled) return;
                this._deletableLayers.off("layeradd", this._enableLayerDelete, this).off("layerremove", this._disableLayerDelete, this), L.Handler.prototype.disable.call(this), this._map.fire("draw:deletestop", {
                    handler: this.type
                }), this.fire("disabled", {
                    handler: this.type
                })
            },
            addHooks: function() {
                var e = this._map;
                e && (e.getContainer().focus(), this._deletableLayers.eachLayer(this._enableLayerDelete, this), this._deletedLayers = new L.LayerGroup, this._tooltip = new L.Tooltip(this._map), this._tooltip.updateContent({
                    text: L.drawLocal.edit.handlers.remove.tooltip.text
                }), this._map.on("mousemove", this._onMouseMove, this))
            },
            removeHooks: function() {
                this._map && (this._deletableLayers.eachLayer(this._disableLayerDelete, this), this._deletedLayers = null, this._tooltip.dispose(), this._tooltip = null, this._map.off("mousemove", this._onMouseMove, this))
            },
            revertLayers: function() {
                this._deletedLayers.eachLayer(function(e) {
                    this._deletableLayers.addLayer(e), e.fire("revert-deleted", {
                        layer: e
                    })
                }, this)
            },
            save: function() {
                this._map.fire("draw:deleted", {
                    layers: this._deletedLayers
                })
            },
            _enableLayerDelete: function(e) {
                var t = e.layer || e.target || e;
                t.on("click", this._removeLayer, this)
            },
            _disableLayerDelete: function(e) {
                var t = e.layer || e.target || e;
                t.off("click", this._removeLayer, this), this._deletedLayers.removeLayer(t)
            },
            _removeLayer: function(e) {
                var t = e.layer || e.target || e;
                this._deletableLayers.removeLayer(t), this._deletedLayers.addLayer(t), t.fire("deleted")
            },
            _onMouseMove: function(e) {
                this._tooltip.updatePosition(e.latlng)
            },
            _hasAvailableLayers: function() {
                return this._deletableLayers.getLayers().length !== 0
            }
        })
    }(window, document), define("leaflet.draw", function() {}),
    function(e, t, n) {
        var r = e.L;
        r.labelVersion = "0.2.2-dev", r.Label = (r.Layer ? r.Layer : r.Class).extend({
            includes: r.Mixin.Events,
            options: {
                className: "",
                clickable: !1,
                direction: "right",
                noHide: !1,
                offset: [12, -15],
                opacity: 1,
                zoomAnimation: !0
            },
            initialize: function(e, t) {
                r.setOptions(this, e), this._source = t, this._animated = r.Browser.any3d && this.options.zoomAnimation, this._isOpen = !1
            },
            onAdd: function(e) {
                this._map = e, this._pane = this.options.pane ? e._panes[this.options.pane] : this._source instanceof r.Marker ? e._panes.markerPane : e._panes.popupPane, this._container || this._initLayout(), this._pane.appendChild(this._container), this._initInteraction(), this._update(), this.setOpacity(this.options.opacity), e.on("moveend", this._onMoveEnd, this).on("viewreset", this._onViewReset, this), this._animated && e.on("zoomanim", this._zoomAnimation, this), r.Browser.touch && !this.options.noHide && (r.DomEvent.on(this._container, "click", this.close, this), e.on("click", this.close, this))
            },
            onRemove: function(e) {
                this._pane.removeChild(this._container), e.off({
                    zoomanim: this._zoomAnimation,
                    moveend: this._onMoveEnd,
                    viewreset: this._onViewReset
                }, this), this._removeInteraction(), this._map = null
            },
            setLatLng: function(e) {
                return this._latlng = r.latLng(e), this._map && this._updatePosition(), this
            },
            setContent: function(e) {
                return this._previousContent = this._content, this._content = e, this._updateContent(), this
            },
            close: function() {
                var e = this._map;
                e && (r.Browser.touch && !this.options.noHide && (r.DomEvent.off(this._container, "click", this.close), e.off("click", this.close, this)), e.removeLayer(this))
            },
            updateZIndex: function(e) {
                this._zIndex = e, this._container && this._zIndex && (this._container.style.zIndex = e)
            },
            setOpacity: function(e) {
                this.options.opacity = e, this._container && r.DomUtil.setOpacity(this._container, e)
            },
            _initLayout: function() {
                this._container = r.DomUtil.create("div", "leaflet-label " + this.options.className + " leaflet-zoom-animated"), this.updateZIndex(this._zIndex)
            },
            _update: function() {
                if (!this._map) return;
                this._container.style.visibility = "hidden", this._updateContent(), this._updatePosition(), this._container.style.visibility = ""
            },
            _updateContent: function() {
                if (!this._content || !this._map || this._prevContent === this._content) return;
                typeof this._content == "string" && (this._container.innerHTML = this._content, this._prevContent = this._content, this._labelWidth = this._container.offsetWidth)
            },
            _updatePosition: function() {
                var e = this._map.latLngToLayerPoint(this._latlng);
                this._setPosition(e)
            },
            _setPosition: function(e) {
                var t = this._map,
                    n = this._container,
                    i = t.latLngToContainerPoint(t.getCenter()),
                    s = t.layerPointToContainerPoint(e),
                    o = this.options.direction,
                    u = this._labelWidth,
                    a = r.point(this.options.offset);
                o === "right" || o === "auto" && s.x < i.x ? (r.DomUtil.addClass(n, "leaflet-label-right"), r.DomUtil.removeClass(n, "leaflet-label-left"), e = e.add(a)) : (r.DomUtil.addClass(n, "leaflet-label-left"), r.DomUtil.removeClass(n, "leaflet-label-right"), e = e.add(r.point(-a.x - u, a.y))), r.DomUtil.setPosition(n, e)
            },
            _zoomAnimation: function(e) {
                var t = this._map._latLngToNewLayerPoint(this._latlng, e.zoom, e.center).round();
                this._setPosition(t)
            },
            _onMoveEnd: function() {
                (!this._animated || this.options.direction === "auto") && this._updatePosition()
            },
            _onViewReset: function(e) {
                e && e.hard && this._update()
            },
            _initInteraction: function() {
                if (!this.options.clickable) return;
                var e = this._container,
                    t = ["dblclick", "mousedown", "mouseover", "mouseout", "contextmenu"];
                r.DomUtil.addClass(e, "leaflet-clickable"), r.DomEvent.on(e, "click", this._onMouseClick, this);
                for (var n = 0; n < t.length; n++) r.DomEvent.on(e, t[n], this._fireMouseEvent, this)
            },
            _removeInteraction: function() {
                if (!this.options.clickable) return;
                var e = this._container,
                    t = ["dblclick", "mousedown", "mouseover", "mouseout", "contextmenu"];
                r.DomUtil.removeClass(e, "leaflet-clickable"), r.DomEvent.off(e, "click", this._onMouseClick, this);
                for (var n = 0; n < t.length; n++) r.DomEvent.off(e, t[n], this._fireMouseEvent, this)
            },
            _onMouseClick: function(e) {
                this.hasEventListeners(e.type) && r.DomEvent.stopPropagation(e), this.fire(e.type, {
                    originalEvent: e
                })
            },
            _fireMouseEvent: function(e) {
                this.fire(e.type, {
                    originalEvent: e
                }), e.type === "contextmenu" && this.hasEventListeners(e.type) && r.DomEvent.preventDefault(e), e.type !== "mousedown" ? r.DomEvent.stopPropagation(e) : r.DomEvent.preventDefault(e)
            }
        }), r.BaseMarkerMethods = {
            showLabel: function() {
                return this.label && this._map && (this.label.setLatLng(this._latlng), this._map.showLabel(this.label)), this
            },
            hideLabel: function() {
                return this.label && this.label.close(), this
            },
            setLabelNoHide: function(e) {
                if (this._labelNoHide === e) return;
                this._labelNoHide = e, e ? (this._removeLabelRevealHandlers(), this.showLabel()) : (this._addLabelRevealHandlers(), this.hideLabel())
            },
            bindLabel: function(e, t) {
                var n = this.options.icon ? this.options.icon.options.labelAnchor : this.options.labelAnchor,
                    i = r.point(n) || r.point(0, 0);
                return i = i.add(r.Label.prototype.options.offset), t && t.offset && (i = i.add(t.offset)), t = r.Util.extend({
                    offset: i
                }, t), this._labelNoHide = t.noHide, this.label || (this._labelNoHide || this._addLabelRevealHandlers(), this.on("remove", this.hideLabel, this).on("move", this._moveLabel, this).on("add", this._onMarkerAdd, this), this._hasLabelHandlers = !0), this.label = (new r.Label(t, this)).setContent(e), this
            },
            unbindLabel: function() {
                return this.label && (this.hideLabel(), this.label = null, this._hasLabelHandlers && (this._labelNoHide || this._removeLabelRevealHandlers(), this.off("remove", this.hideLabel, this).off("move", this._moveLabel, this).off("add", this._onMarkerAdd, this)), this._hasLabelHandlers = !1), this
            },
            updateLabelContent: function(e) {
                this.label && this.label.setContent(e)
            },
            getLabel: function() {
                return this.label
            },
            _onMarkerAdd: function() {
                this._labelNoHide && this.showLabel()
            },
            _addLabelRevealHandlers: function() {
                this.on("mouseover", this.showLabel, this).on("mouseout", this.hideLabel, this), r.Browser.touch && this.on("click", this.showLabel, this)
            },
            _removeLabelRevealHandlers: function() {
                this.off("mouseover", this.showLabel, this).off("mouseout", this.hideLabel, this), r.Browser.touch && this.off("click", this.showLabel, this)
            },
            _moveLabel: function(e) {
                this.label.setLatLng(e.latlng)
            }
        }, r.Icon.Default.mergeOptions({
            labelAnchor: new r.Point(9, -20)
        }), r.Marker.mergeOptions({
            icon: new r.Icon.Default
        }), r.Marker.include(r.BaseMarkerMethods), r.Marker.include({
            _originalUpdateZIndex: r.Marker.prototype._updateZIndex,
            _updateZIndex: function(e) {
                var t = this._zIndex + e;
                this._originalUpdateZIndex(e), this.label && this.label.updateZIndex(t)
            },
            _originalSetOpacity: r.Marker.prototype.setOpacity,
            setOpacity: function(e, t) {
                this.options.labelHasSemiTransparency = t, this._originalSetOpacity(e)
            },
            _originalUpdateOpacity: r.Marker.prototype._updateOpacity,
            _updateOpacity: function() {
                var e = this.options.opacity === 0 ? 0 : 1;
                this._originalUpdateOpacity(), this.label && this.label.setOpacity(this.options.labelHasSemiTransparency ? this.options.opacity : e)
            },
            _originalSetLatLng: r.Marker.prototype.setLatLng,
            setLatLng: function(e) {
                return this.label && !this._labelNoHide && this.hideLabel(), this._originalSetLatLng(e)
            }
        }), r.CircleMarker.mergeOptions({
            labelAnchor: new r.Point(0, 0)
        }), r.CircleMarker.include(r.BaseMarkerMethods), r.Path.include({
            bindLabel: function(e, t) {
                if (!this.label || this.label.options !== t) this.label = new r.Label(t, this);
                return this.label.setContent(e), this._showLabelAdded || (this.on("mouseover", this._showLabel, this).on("mousemove", this._moveLabel, this).on("mouseout remove", this._hideLabel, this), r.Browser.touch && this.on("click", this._showLabel, this), this._showLabelAdded = !0), this
            },
            unbindLabel: function() {
                return this.label && (this._hideLabel(), this.label = null, this._showLabelAdded = !1, this.off("mouseover", this._showLabel, this).off("mousemove", this._moveLabel, this).off("mouseout remove", this._hideLabel, this)), this
            },
            updateLabelContent: function(e) {
                this.label && this.label.setContent(e)
            },
            _showLabel: function(e) {
                this.label.setLatLng(e.latlng), this._map.showLabel(this.label)
            },
            _moveLabel: function(e) {
                this.label.setLatLng(e.latlng)
            },
            _hideLabel: function() {
                this.label.close()
            }
        }), r.Map.include({
            showLabel: function(e) {
                return this.addLayer(e)
            }
        }), r.FeatureGroup.include({
            clearLayers: function() {
                return this.unbindLabel(), this.eachLayer(this.removeLayer, this), this
            },
            bindLabel: function(e, t) {
                return this.invoke("bindLabel", e, t)
            },
            unbindLabel: function() {
                return this.invoke("unbindLabel")
            },
            updateLabelContent: function(e) {
                this.invoke("updateLabelContent", e)
            }
        })
    }(window, document), define("leaflet.label", function() {}),
    function(e, t, n) {
        L.MarkerClusterGroup = L.FeatureGroup.extend({
                options: {
                    maxClusterRadius: 80,
                    iconCreateFunction: null,
                    spiderfyOnMaxZoom: !0,
                    showCoverageOnHover: !0,
                    zoomToBoundsOnClick: !0,
                    singleMarkerMode: !1,
                    disableClusteringAtZoom: null,
                    removeOutsideVisibleBounds: !0,
                    animate: !0,
                    animateAddingMarkers: !1,
                    spiderfyDistanceMultiplier: 1,
                    spiderLegPolylineOptions: {
                        weight: 1.5,
                        color: "#222",
                        opacity: .5
                    },
                    chunkedLoading: !1,
                    chunkInterval: 200,
                    chunkDelay: 50,
                    chunkProgress: null,
                    polygonOptions: {}
                },
                initialize: function(e) {
                    L.Util.setOptions(this, e), this.options.iconCreateFunction || (this.options.iconCreateFunction = this._defaultIconCreateFunction), this._featureGroup = L.featureGroup(), this._featureGroup.on(L.FeatureGroup.EVENTS, this._propagateEvent, this), this._nonPointGroup = L.featureGroup(), this._nonPointGroup.on(L.FeatureGroup.EVENTS, this._propagateEvent, this), this._inZoomAnimation = 0, this._needsClustering = [], this._needsRemoving = [], this._currentShownBounds = null, this._queue = [];
                    var t = L.DomUtil.TRANSITION && this.options.animate;
                    L.extend(this, t ? this._withAnimation : this._noAnimation), this._markerCluster = t ? L.MarkerCluster : L.MarkerClusterNonAnimated
                },
                addLayer: function(e) {
                    if (e instanceof L.LayerGroup) {
                        var t = [];
                        for (var n in e._layers) t.push(e._layers[n]);
                        return this.addLayers(t)
                    }
                    if (!e.getLatLng) return this._nonPointGroup.addLayer(e), this;
                    if (!this._map) return this._needsClustering.push(e), this;
                    if (this.hasLayer(e)) return this;
                    this._unspiderfy && this._unspiderfy(), this._addLayer(e, this._maxZoom), this._topClusterLevel._recalculateBounds();
                    var r = e,
                        i = this._map.getZoom();
                    if (e.__parent)
                        while (r.__parent._zoom >= i) r = r.__parent;
                    return this._currentShownBounds.contains(r.getLatLng()) && (this.options.animateAddingMarkers ? this._animationAddLayer(e, r) : this._animationAddLayerNonAnimated(e, r)), this
                },
                removeLayer: function(e) {
                    if (e instanceof L.LayerGroup) {
                        var t = [];
                        for (var n in e._layers) t.push(e._layers[n]);
                        return this.removeLayers(t)
                    }
                    return e.getLatLng ? this._map ? e.__parent ? (this._unspiderfy && (this._unspiderfy(), this._unspiderfyLayer(e)), this._removeLayer(e, !0), this._topClusterLevel._recalculateBounds(), this._featureGroup.hasLayer(e) && (this._featureGroup.removeLayer(e), e.clusterShow && e.clusterShow()), this) : this : (!this._arraySplice(this._needsClustering, e) && this.hasLayer(e) && this._needsRemoving.push(e), this) : (this._nonPointGroup.removeLayer(e), this)
                },
                addLayers: function(e) {
                    var t = this._featureGroup,
                        n = this._nonPointGroup,
                        r = this.options.chunkedLoading,
                        i = this.options.chunkInterval,
                        s = this.options.chunkProgress,
                        o, u, a, f;
                    if (this._map) {
                        var l = 0,
                            c = (new Date).getTime(),
                            h = L.bind(function() {
                                var o = (new Date).getTime();
                                for (; l < e.length; l++) {
                                    if (r && l % 200 === 0) {
                                        var u = (new Date).getTime() - o;
                                        if (u > i) break
                                    }
                                    f = e[l];
                                    if (!f.getLatLng) {
                                        n.addLayer(f);
                                        continue
                                    }
                                    if (this.hasLayer(f)) continue;
                                    this._addLayer(f, this._maxZoom);
                                    if (f.__parent && f.__parent.getChildCount() === 2) {
                                        var a = f.__parent.getAllChildMarkers(),
                                            p = a[0] === f ? a[1] : a[0];
                                        t.removeLayer(p)
                                    }
                                }
                                s && s(l, e.length, (new Date).getTime() - c), l === e.length ? (this._topClusterLevel._recalculateBounds(), this._featureGroup.eachLayer(function(e) {
                                    e instanceof L.MarkerCluster && e._iconNeedsUpdate && e._updateIcon()
                                }), this._topClusterLevel._recursivelyAddChildrenToMap(null, this._zoom, this._currentShownBounds)) : setTimeout(h, this.options.chunkDelay)
                            }, this);
                        h()
                    } else {
                        o = [];
                        for (u = 0, a = e.length; u < a; u++) {
                            f = e[u];
                            if (!f.getLatLng) {
                                n.addLayer(f);
                                continue
                            }
                            if (this.hasLayer(f)) continue;
                            o.push(f)
                        }
                        this._needsClustering = this._needsClustering.concat(o)
                    }
                    return this
                },
                removeLayers: function(e) {
                    var t, n, r, i = this._featureGroup,
                        s = this._nonPointGroup;
                    if (!this._map) {
                        for (t = 0, n = e.length; t < n; t++) r = e[t], this._arraySplice(this._needsClustering, r), s.removeLayer(r), this.hasLayer(r) && this._needsRemoving.push(r);
                        return this
                    }
                    if (this._unspiderfy) {
                        this._unspiderfy();
                        for (t = 0, n = e.length; t < n; t++) r = e[t], this._unspiderfyLayer(r)
                    }
                    for (t = 0, n = e.length; t < n; t++) {
                        r = e[t];
                        if (!r.__parent) {
                            s.removeLayer(r);
                            continue
                        }
                        this._removeLayer(r, !0, !0), i.hasLayer(r) && (i.removeLayer(r), r.clusterShow && r.clusterShow())
                    }
                    return this._topClusterLevel._recalculateBounds(), this._topClusterLevel._recursivelyAddChildrenToMap(null, this._zoom, this._currentShownBounds), i.eachLayer(function(e) {
                        e instanceof L.MarkerCluster && e._updateIcon()
                    }), this
                },
                clearLayers: function() {
                    return this._map || (this._needsClustering = [], delete this._gridClusters, delete this._gridUnclustered), this._noanimationUnspiderfy && this._noanimationUnspiderfy(), this._featureGroup.clearLayers(), this._nonPointGroup.clearLayers(), this.eachLayer(function(e) {
                        delete e.__parent
                    }), this._map && this._generateInitialClusters(), this
                },
                getBounds: function() {
                    var e = new L.LatLngBounds;
                    this._topClusterLevel && e.extend(this._topClusterLevel._bounds);
                    for (var t = this._needsClustering.length - 1; t >= 0; t--) e.extend(this._needsClustering[t].getLatLng());
                    return e.extend(this._nonPointGroup.getBounds()), e
                },
                eachLayer: function(e, t) {
                    var n = this._needsClustering.slice(),
                        r;
                    this._topClusterLevel && this._topClusterLevel.getAllChildMarkers(n);
                    for (r = n.length - 1; r >= 0; r--) e.call(t, n[r]);
                    this._nonPointGroup.eachLayer(e, t)
                },
                getLayers: function() {
                    var e = [];
                    return this.eachLayer(function(t) {
                        e.push(t)
                    }), e
                },
                getLayer: function(e) {
                    var t = null;
                    return e = parseInt(e, 10), this.eachLayer(function(n) {
                        L.stamp(n) === e && (t = n)
                    }), t
                },
                hasLayer: function(e) {
                    if (!e) return !1;
                    var t, n = this._needsClustering;
                    for (t = n.length - 1; t >= 0; t--)
                        if (n[t] === e) return !0;
                    n = this._needsRemoving;
                    for (t = n.length - 1; t >= 0; t--)
                        if (n[t] === e) return !1;
                    return !!e.__parent && e.__parent._group === this || this._nonPointGroup.hasLayer(e)
                },
                zoomToShowLayer: function(e, t) {
                    typeof t != "function" && (t = function() {});
                    var n = function() {
                        (e._icon || e.__parent._icon) && !this._inZoomAnimation && (this._map.off("moveend", n, this), this.off("animationend", n, this), e._icon ? t() : e.__parent._icon && (this.once("spiderfied", t, this), e.__parent.spiderfy()))
                    };
                    if (e._icon && this._map.getBounds().contains(e.getLatLng())) t();
                    else if (e.__parent._zoom < this._map.getZoom()) this._map.on("moveend", n, this), this._map.panTo(e.getLatLng());
                    else {
                        var r = function() {
                            this._map.off("movestart", r, this), r = null
                        };
                        this._map.on("movestart", r, this), this._map.on("moveend", n, this), this.on("animationend", n, this), e.__parent.zoomToBounds(), r && n.call(this)
                    }
                },
                onAdd: function(e) {
                    this._map = e;
                    var t, n, r;
                    if (!isFinite(this._map.getMaxZoom())) throw "Map has no maxZoom specified";
                    this._featureGroup.onAdd(e), this._nonPointGroup.onAdd(e), this._gridClusters || this._generateInitialClusters(), this._maxLat = e.options.crs.projection.MAX_LATITUDE;
                    for (t = 0, n = this._needsRemoving.length; t < n; t++) r = this._needsRemoving[t], this._removeLayer(r, !0);
                    this._needsRemoving = [], this._zoom = this._map.getZoom(), this._currentShownBounds = this._getExpandedVisibleBounds(), this._map.on("zoomend", this._zoomEnd, this), this._map.on("moveend", this._moveEnd, this), this._spiderfierOnAdd && this._spiderfierOnAdd(), this._bindEvents(), n = this._needsClustering, this._needsClustering = [], this.addLayers(n)
                },
                onRemove: function(e) {
                    e.off("zoomend", this._zoomEnd, this), e.off("moveend", this._moveEnd, this), this._unbindEvents(), this._map._mapPane.className = this._map._mapPane.className.replace(" leaflet-cluster-anim", ""), this._spiderfierOnRemove && this._spiderfierOnRemove(), delete this._maxLat, this._hideCoverage(), this._featureGroup.onRemove(e), this._nonPointGroup.onRemove(e), this._featureGroup.clearLayers(), this._map = null
                },
                getVisibleParent: function(e) {
                    var t = e;
                    while (t && !t._icon) t = t.__parent;
                    return t || null
                },
                _arraySplice: function(e, t) {
                    for (var n = e.length - 1; n >= 0; n--)
                        if (e[n] === t) return e.splice(n, 1), !0
                },
                _removeFromGridUnclustered: function(e, t) {
                    var n = this._map,
                        r = this._gridUnclustered;
                    for (; t >= 0; t--)
                        if (!r[t].removeObject(e, n.project(e.getLatLng(), t))) break
                },
                _removeLayer: function(e, t, n) {
                    var r = this._gridClusters,
                        i = this._gridUnclustered,
                        s = this._featureGroup,
                        o = this._map;
                    t && this._removeFromGridUnclustered(e, this._maxZoom);
                    var u = e.__parent,
                        a = u._markers,
                        f;
                    this._arraySplice(a, e);
                    while (u) {
                        u._childCount--, u._boundsNeedUpdate = !0;
                        if (u._zoom < 0) break;
                        t && u._childCount <= 1 ? (f = u._markers[0] === e ? u._markers[1] : u._markers[0], r[u._zoom].removeObject(u, o.project(u._cLatLng, u._zoom)), i[u._zoom].addObject(f, o.project(f.getLatLng(), u._zoom)), this._arraySplice(u.__parent._childClusters, u), u.__parent._markers.push(f), f.__parent = u.__parent, u._icon && (s.removeLayer(u), n || s.addLayer(f))) : (!n || !u._icon) && u._updateIcon(), u = u.__parent
                    }
                    delete e.__parent
                },
                _isOrIsParent: function(e, t) {
                    while (t) {
                        if (e === t) return !0;
                        t = t.parentNode
                    }
                    return !1
                },
                _propagateEvent: function(e) {
                    if (e.layer instanceof L.MarkerCluster) {
                        if (e.originalEvent && this._isOrIsParent(e.layer._icon, e.originalEvent.relatedTarget)) return;
                        e.type = "cluster" + e.type
                    }
                    this.fire(e.type, e)
                },
                _defaultIconCreateFunction: function(e) {
                    var t = e.getChildCount(),
                        n = " marker-cluster-";
                    return t < 10 ? n += "small" : t < 100 ? n += "medium" : n += "large", new L.DivIcon({
                        html: "<div><span>" + t + "</span></div>",
                        className: "marker-cluster" + n,
                        iconSize: new L.Point(40, 40)
                    })
                },
                _bindEvents: function() {
                    var e = this._map,
                        t = this.options.spiderfyOnMaxZoom,
                        n = this.options.showCoverageOnHover,
                        r = this.options.zoomToBoundsOnClick;
                    (t || r) && this.on("clusterclick", this._zoomOrSpiderfy, this), n && (this.on("clustermouseover", this._showCoverage, this), this.on("clustermouseout", this._hideCoverage, this), e.on("zoomend", this._hideCoverage, this))
                },
                _zoomOrSpiderfy: function(e) {
                    var t = e.layer,
                        n = t;
                    while (n._childClusters.length === 1) n = n._childClusters[0];
                    n._zoom === this._maxZoom && n._childCount === t._childCount ? this.options.spiderfyOnMaxZoom && t.spiderfy() : this.options.zoomToBoundsOnClick && t.zoomToBounds(), e.originalEvent && e.originalEvent.keyCode === 13 && this._map._container.focus()
                },
                _showCoverage: function(e) {
                    var t = this._map;
                    if (this._inZoomAnimation) return;
                    this._shownPolygon && t.removeLayer(this._shownPolygon), e.layer.getChildCount() > 2 && e.layer !== this._spiderfied && (this._shownPolygon = new L.Polygon(e.layer.getConvexHull(), this.options.polygonOptions), t.addLayer(this._shownPolygon))
                },
                _hideCoverage: function() {
                    this._shownPolygon && (this._map.removeLayer(this._shownPolygon), this._shownPolygon = null)
                },
                _unbindEvents: function() {
                    var e = this.options.spiderfyOnMaxZoom,
                        t = this.options.showCoverageOnHover,
                        n = this.options.zoomToBoundsOnClick,
                        r = this._map;
                    (e || n) && this.off("clusterclick", this._zoomOrSpiderfy, this), t && (this.off("clustermouseover", this._showCoverage, this), this.off("clustermouseout", this._hideCoverage, this), r.off("zoomend", this._hideCoverage, this))
                },
                _zoomEnd: function() {
                    if (!this._map) return;
                    this._mergeSplitClusters(), this._zoom = this._map._zoom, this._currentShownBounds = this._getExpandedVisibleBounds()
                },
                _moveEnd: function() {
                    if (this._inZoomAnimation) return;
                    var e = this._getExpandedVisibleBounds();
                    this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, this._zoom, e), this._topClusterLevel._recursivelyAddChildrenToMap(null, this._map._zoom, e), this._currentShownBounds = e;
                    return
                },
                _generateInitialClusters: function() {
                    var e = this._map.getMaxZoom(),
                        t = this.options.maxClusterRadius,
                        n = t;
                    typeof t != "function" && (n = function() {
                        return t
                    }), this.options.disableClusteringAtZoom && (e = this.options.disableClusteringAtZoom - 1), this._maxZoom = e, this._gridClusters = {}, this._gridUnclustered = {};
                    for (var r = e; r >= 0; r--) this._gridClusters[r] = new L.DistanceGrid(n(r)), this._gridUnclustered[r] = new L.DistanceGrid(n(r));
                    this._topClusterLevel = new this._markerCluster(this, -1)
                },
                _addLayer: function(e, t) {
                    var n = this._gridClusters,
                        r = this._gridUnclustered,
                        i, s;
                    this.options.singleMarkerMode && this._overrideMarkerIcon(e);
                    for (; t >= 0; t--) {
                        i = this._map.project(e.getLatLng(), t);
                        var o = n[t].getNearObject(i);
                        if (o) {
                            o._addChild(e), e.__parent = o;
                            return
                        }
                        o = r[t].getNearObject(i);
                        if (o) {
                            var u = o.__parent;
                            u && this._removeLayer(o, !1);
                            var a = new this._markerCluster(this, t, o, e);
                            n[t].addObject(a, this._map.project(a._cLatLng, t)), o.__parent = a, e.__parent = a;
                            var f = a;
                            for (s = t - 1; s > u._zoom; s--) f = new this._markerCluster(this, s, f), n[s].addObject(f, this._map.project(o.getLatLng(), s));
                            u._addChild(f), this._removeFromGridUnclustered(o, t);
                            return
                        }
                        r[t].addObject(e, i)
                    }
                    this._topClusterLevel._addChild(e), e.__parent = this._topClusterLevel;
                    return
                },
                _enqueue: function(e) {
                    this._queue.push(e), this._queueTimeout || (this._queueTimeout = setTimeout(L.bind(this._processQueue, this), 300))
                },
                _processQueue: function() {
                    for (var e = 0; e < this._queue.length; e++) this._queue[e].call(this);
                    this._queue.length = 0, clearTimeout(this._queueTimeout), this._queueTimeout = null
                },
                _mergeSplitClusters: function() {
                    this._processQueue(), this._zoom < this._map._zoom && this._currentShownBounds.intersects(this._getExpandedVisibleBounds()) ? (this._animationStart(), this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, this._zoom, this._getExpandedVisibleBounds()), this._animationZoomIn(this._zoom, this._map._zoom)) : this._zoom > this._map._zoom ? (this._animationStart(), this._animationZoomOut(this._zoom, this._map._zoom)) : this._moveEnd()
                },
                _getExpandedVisibleBounds: function() {
                    return this.options.removeOutsideVisibleBounds ? L.Browser.mobile ? this._checkBoundsMaxLat(this._map.getBounds()) : this._checkBoundsMaxLat(this._map.getBounds().pad(1)) : this._mapBoundsInfinite
                },
                _checkBoundsMaxLat: function(e) {
                    var t = this._maxLat;
                    return t !== n && (e.getNorth() >= t && (e._northEast.lat = Infinity), e.getSouth() <= -t && (e._southWest.lat = -Infinity)), e
                },
                _animationAddLayerNonAnimated: function(e, t) {
                    if (t === e) this._featureGroup.addLayer(e);
                    else if (t._childCount === 2) {
                        t._addToMap();
                        var n = t.getAllChildMarkers();
                        this._featureGroup.removeLayer(n[0]), this._featureGroup.removeLayer(n[1])
                    } else t._updateIcon()
                },
                _overrideMarkerIcon: function(e) {
                    var t = e.options.icon = this.options.iconCreateFunction({
                        getChildCount: function() {
                            return 1
                        },
                        getAllChildMarkers: function() {
                            return [e]
                        }
                    });
                    return t
                }
            }), L.MarkerClusterGroup.include({
                _mapBoundsInfinite: new L.LatLngBounds(new L.LatLng(-Infinity, -Infinity), new L.LatLng(Infinity, Infinity))
            }), L.MarkerClusterGroup.include({
                _noAnimation: {
                    _animationStart: function() {},
                    _animationZoomIn: function(e, t) {
                        this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, e), this._topClusterLevel._recursivelyAddChildrenToMap(null, t, this._getExpandedVisibleBounds()), this.fire("animationend")
                    },
                    _animationZoomOut: function(e, t) {
                        this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, e), this._topClusterLevel._recursivelyAddChildrenToMap(null, t, this._getExpandedVisibleBounds()), this.fire("animationend")
                    },
                    _animationAddLayer: function(e, t) {
                        this._animationAddLayerNonAnimated(e, t)
                    }
                },
                _withAnimation: {
                    _animationStart: function() {
                        this._map._mapPane.className += " leaflet-cluster-anim", this._inZoomAnimation++
                    },
                    _animationZoomIn: function(e, t) {
                        var n = this._getExpandedVisibleBounds(),
                            r = this._featureGroup,
                            i;
                        this._topClusterLevel._recursively(n, e, 0, function(s) {
                            var o = s._latlng,
                                u = s._markers,
                                a;
                            n.contains(o) || (o = null), s._isSingleParent() && e + 1 === t ? (r.removeLayer(s), s._recursivelyAddChildrenToMap(null, t, n)) : (s.clusterHide(), s._recursivelyAddChildrenToMap(o, t, n));
                            for (i = u.length - 1; i >= 0; i--) a = u[i], n.contains(a._latlng) || r.removeLayer(a)
                        }), this._forceLayout(), this._topClusterLevel._recursivelyBecomeVisible(n, t), r.eachLayer(function(e) {
                            !(e instanceof L.MarkerCluster) && e._icon && e.clusterShow()
                        }), this._topClusterLevel._recursively(n, e, t, function(e) {
                            e._recursivelyRestoreChildPositions(t)
                        }), this._enqueue(function() {
                            this._topClusterLevel._recursively(n, e, 0, function(e) {
                                r.removeLayer(e), e.clusterShow()
                            }), this._animationEnd()
                        })
                    },
                    _animationZoomOut: function(e, t) {
                        this._animationZoomOutSingle(this._topClusterLevel, e - 1, t), this._topClusterLevel._recursivelyAddChildrenToMap(null, t, this._getExpandedVisibleBounds()), this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, e, this._getExpandedVisibleBounds())
                    },
                    _animationAddLayer: function(e, t) {
                        var n = this,
                            r = this._featureGroup;
                        r.addLayer(e), t !== e && (t._childCount > 2 ? (t._updateIcon(), this._forceLayout(), this._animationStart(), e._setPos(this._map.latLngToLayerPoint(t.getLatLng())), e.clusterHide(), this._enqueue(function() {
                            r.removeLayer(e), e.clusterShow(), n._animationEnd()
                        })) : (this._forceLayout(), n._animationStart(), n._animationZoomOutSingle(t, this._map.getMaxZoom(), this._map.getZoom())))
                    }
                },
                _animationZoomOutSingle: function(e, t, n) {
                    var r = this._getExpandedVisibleBounds();
                    e._recursivelyAnimateChildrenInAndAddSelfToMap(r, t + 1, n);
                    var i = this;
                    this._forceLayout(), e._recursivelyBecomeVisible(r, n), this._enqueue(function() {
                        if (e._childCount === 1) {
                            var s = e._markers[0];
                            s.setLatLng(s.getLatLng()), s.clusterShow && s.clusterShow()
                        } else e._recursively(r, n, 0, function(e) {
                            e._recursivelyRemoveChildrenFromMap(r, t + 1)
                        });
                        i._animationEnd()
                    })
                },
                _animationEnd: function() {
                    this._map && (this._map._mapPane.className = this._map._mapPane.className.replace(" leaflet-cluster-anim", "")), this._inZoomAnimation--, this.fire("animationend")
                },
                _forceLayout: function() {
                    L.Util.falseFn(t.body.offsetWidth)
                }
            }), L.markerClusterGroup = function(e) {
                return new L.MarkerClusterGroup(e)
            }, L.MarkerCluster = L.Marker.extend({
                initialize: function(e, t, n, r) {
                    L.Marker.prototype.initialize.call(this, n ? n._cLatLng || n.getLatLng() : new L.LatLng(0, 0), {
                        icon: this
                    }), this._group = e, this._zoom = t, this._markers = [], this._childClusters = [], this._childCount = 0, this._iconNeedsUpdate = !0, this._boundsNeedUpdate = !0, this._bounds = new L.LatLngBounds, n && this._addChild(n), r && this._addChild(r)
                },
                getAllChildMarkers: function(e) {
                    e = e || [];
                    for (var t = this._childClusters.length - 1; t >= 0; t--) this._childClusters[t].getAllChildMarkers(e);
                    for (var n = this._markers.length - 1; n >= 0; n--) e.push(this._markers[n]);
                    return e
                },
                getChildCount: function() {
                    return this._childCount
                },
                zoomToBounds: function() {
                    var e = this._childClusters.slice(),
                        t = this._group._map,
                        n = t.getBoundsZoom(this._bounds),
                        r = this._zoom + 1,
                        i = t.getZoom(),
                        s;
                    while (e.length > 0 && n > r) {
                        r++;
                        var o = [];
                        for (s = 0; s < e.length; s++) o = o.concat(e[s]._childClusters);
                        e = o
                    }
                    n > r ? this._group._map.setView(this._latlng, r) : n <= i ? this._group._map.setView(this._latlng, i + 1) : this._group._map.fitBounds(this._bounds)
                },
                getBounds: function() {
                    var e = new L.LatLngBounds;
                    return e.extend(this._bounds), e
                },
                _updateIcon: function() {
                    this._iconNeedsUpdate = !0, this._icon && this.setIcon(this)
                },
                createIcon: function() {
                    return this._iconNeedsUpdate && (this._iconObj = this._group.options.iconCreateFunction(this), this._iconNeedsUpdate = !1), this._iconObj.createIcon()
                },
                createShadow: function() {
                    return this._iconObj.createShadow()
                },
                _addChild: function(e, t) {
                    this._iconNeedsUpdate = !0, this._boundsNeedUpdate = !0, this._setClusterCenter(e), e instanceof L.MarkerCluster ? (t || (this._childClusters.push(e), e.__parent = this), this._childCount += e._childCount) : (t || this._markers.push(e), this._childCount++), this.__parent && this.__parent._addChild(e, !0)
                },
                _setClusterCenter: function(e) {
                    this._cLatLng || (this._cLatLng = e._cLatLng || e._latlng)
                },
                _resetBounds: function() {
                    var e = this._bounds;
                    e._southWest && (e._southWest.lat = Infinity, e._southWest.lng = Infinity), e._northEast && (e._northEast.lat = -Infinity, e._northEast.lng = -Infinity)
                },
                _recalculateBounds: function() {
                    var e = this._markers,
                        t = this._childClusters,
                        n = 0,
                        r = 0,
                        i = this._childCount,
                        s, o, u, a;
                    if (i === 0) return;
                    this._resetBounds();
                    for (s = 0; s < e.length; s++) u = e[s]._latlng, this._bounds.extend(u), n += u.lat, r += u.lng;
                    for (s = 0; s < t.length; s++) o = t[s], o._boundsNeedUpdate && o._recalculateBounds(), this._bounds.extend(o._bounds), u = o._wLatLng, a = o._childCount, n += u.lat * a, r += u.lng * a;
                    this._latlng = this._wLatLng = new L.LatLng(n / i, r / i), this._boundsNeedUpdate = !1
                },
                _addToMap: function(e) {
                    e && (this._backupLatlng = this._latlng, this.setLatLng(e)), this._group._featureGroup.addLayer(this)
                },
                _recursivelyAnimateChildrenIn: function(e, t, n) {
                    this._recursively(e, 0, n - 1, function(e) {
                        var n = e._markers,
                            r, i;
                        for (r = n.length - 1; r >= 0; r--) i = n[r], i._icon && (i._setPos(t), i.clusterHide())
                    }, function(e) {
                        var n = e._childClusters,
                            r, i;
                        for (r = n.length - 1; r >= 0; r--) i = n[r], i._icon && (i._setPos(t), i.clusterHide())
                    })
                },
                _recursivelyAnimateChildrenInAndAddSelfToMap: function(e, t, n) {
                    this._recursively(e, n, 0, function(r) {
                        r._recursivelyAnimateChildrenIn(e, r._group._map.latLngToLayerPoint(r.getLatLng()).round(), t), r._isSingleParent() && t - 1 === n ? (r.clusterShow(), r._recursivelyRemoveChildrenFromMap(e, t)) : r.clusterHide(), r._addToMap()
                    })
                },
                _recursivelyBecomeVisible: function(e, t) {
                    this._recursively(e, 0, t, null, function(e) {
                        e.clusterShow()
                    })
                },
                _recursivelyAddChildrenToMap: function(e, t, n) {
                    this._recursively(n, -1, t, function(r) {
                        if (t === r._zoom) return;
                        for (var i = r._markers.length - 1; i >= 0; i--) {
                            var s = r._markers[i];
                            if (!n.contains(s._latlng)) continue;
                            e && (s._backupLatlng = s.getLatLng(), s.setLatLng(e), s.clusterHide && s.clusterHide()), r._group._featureGroup.addLayer(s)
                        }
                    }, function(t) {
                        t._addToMap(e)
                    })
                },
                _recursivelyRestoreChildPositions: function(e) {
                    for (var t = this._markers.length - 1; t >= 0; t--) {
                        var n = this._markers[t];
                        n._backupLatlng && (n.setLatLng(n._backupLatlng), delete n._backupLatlng)
                    }
                    if (e - 1 === this._zoom)
                        for (var r = this._childClusters.length - 1; r >= 0; r--) this._childClusters[r]._restorePosition();
                    else
                        for (var i = this._childClusters.length - 1; i >= 0; i--) this._childClusters[i]._recursivelyRestoreChildPositions(e)
                },
                _restorePosition: function() {
                    this._backupLatlng && (this.setLatLng(this._backupLatlng), delete this._backupLatlng)
                },
                _recursivelyRemoveChildrenFromMap: function(e, t, n) {
                    var r, i;
                    this._recursively(e, -1, t - 1, function(e) {
                        for (i = e._markers.length - 1; i >= 0; i--) {
                            r = e._markers[i];
                            if (!n || !n.contains(r._latlng)) e._group._featureGroup.removeLayer(r), r.clusterShow && r.clusterShow()
                        }
                    }, function(e) {
                        for (i = e._childClusters.length - 1; i >= 0; i--) {
                            r = e._childClusters[i];
                            if (!n || !n.contains(r._latlng)) e._group._featureGroup.removeLayer(r), r.clusterShow && r.clusterShow()
                        }
                    })
                },
                _recursively: function(e, t, n, r, i) {
                    var s = this._childClusters,
                        o = this._zoom,
                        u, a;
                    if (t > o)
                        for (u = s.length - 1; u >= 0; u--) a = s[u], e.intersects(a._bounds) && a._recursively(e, t, n, r, i);
                    else {
                        r && r(this), i && this._zoom === n && i(this);
                        if (n > o)
                            for (u = s.length - 1; u >= 0; u--) a = s[u], e.intersects(a._bounds) && a._recursively(e, t, n, r, i)
                    }
                },
                _isSingleParent: function() {
                    return this._childClusters.length > 0 && this._childClusters[0]._childCount === this._childCount
                }
            }), L.Marker.include({
                clusterHide: function() {
                    return this.options.opacityWhenUnclustered = this.options.opacity || 1, this.setOpacity(0)
                },
                clusterShow: function() {
                    var e = this.setOpacity(this.options.opacity || this.options.opacityWhenUnclustered);
                    return delete this.options.opacityWhenUnclustered, e
                }
            }), L.DistanceGrid = function(e) {
                this._cellSize = e, this._sqCellSize = e * e, this._grid = {}, this._objectPoint = {}
            }, L.DistanceGrid.prototype = {
                addObject: function(e, t) {
                    var n = this._getCoord(t.x),
                        r = this._getCoord(t.y),
                        i = this._grid,
                        s = i[r] = i[r] || {},
                        o = s[n] = s[n] || [],
                        u = L.Util.stamp(e);
                    this._objectPoint[u] = t, o.push(e)
                },
                updateObject: function(e, t) {
                    this.removeObject(e), this.addObject(e, t)
                },
                removeObject: function(e, t) {
                    var n = this._getCoord(t.x),
                        r = this._getCoord(t.y),
                        i = this._grid,
                        s = i[r] = i[r] || {},
                        o = s[n] = s[n] || [],
                        u, a;
                    delete this._objectPoint[L.Util.stamp(e)];
                    for (u = 0, a = o.length; u < a; u++)
                        if (o[u] === e) return o.splice(u, 1), a === 1 && delete s[n], !0
                },
                eachObject: function(e, t) {
                    var n, r, i, s, o, u, a, f = this._grid;
                    for (n in f) {
                        o = f[n];
                        for (r in o) {
                            u = o[r];
                            for (i = 0, s = u.length; i < s; i++) a = e.call(t, u[i]), a && (i--, s--)
                        }
                    }
                },
                getNearObject: function(e) {
                    var t = this._getCoord(e.x),
                        n = this._getCoord(e.y),
                        r, i, s, o, u, a, f, l, c = this._objectPoint,
                        h = this._sqCellSize,
                        p = null;
                    for (r = n - 1; r <= n + 1; r++) {
                        o = this._grid[r];
                        if (o)
                            for (i = t - 1; i <= t + 1; i++) {
                                u = o[i];
                                if (u)
                                    for (s = 0, a = u.length; s < a; s++) f = u[s], l = this._sqDist(c[L.Util.stamp(f)], e), l < h && (h = l, p = f)
                            }
                    }
                    return p
                },
                _getCoord: function(e) {
                    return Math.floor(e / this._cellSize)
                },
                _sqDist: function(e, t) {
                    var n = t.x - e.x,
                        r = t.y - e.y;
                    return n * n + r * r
                }
            },
            function() {
                L.QuickHull = {
                    getDistant: function(e, t) {
                        var n = t[1].lat - t[0].lat,
                            r = t[0].lng - t[1].lng;
                        return r * (e.lat - t[0].lat) + n * (e.lng - t[0].lng)
                    },
                    findMostDistantPointFromBaseLine: function(e, t) {
                        var n = 0,
                            r = null,
                            i = [],
                            s, o, u;
                        for (s = t.length - 1; s >= 0; s--) {
                            o = t[s], u = this.getDistant(o, e);
                            if (!(u > 0)) continue;
                            i.push(o), u > n && (n = u, r = o)
                        }
                        return {
                            maxPoint: r,
                            newPoints: i
                        }
                    },
                    buildConvexHull: function(e, t) {
                        var n = [],
                            r = this.findMostDistantPointFromBaseLine(e, t);
                        return r.maxPoint ? (n = n.concat(this.buildConvexHull([e[0], r.maxPoint], r.newPoints)), n = n.concat(this.buildConvexHull([r.maxPoint, e[1]], r.newPoints)), n) : [e[0]]
                    },
                    getConvexHull: function(e) {
                        var t = !1,
                            n = !1,
                            r = !1,
                            i = !1,
                            s = null,
                            o = null,
                            u = null,
                            a = null,
                            f = null,
                            l = null,
                            c;
                        for (c = e.length - 1; c >= 0; c--) {
                            var h = e[c];
                            if (t === !1 || h.lat > t) s = h, t = h.lat;
                            if (n === !1 || h.lat < n) o = h, n = h.lat;
                            if (r === !1 || h.lng > r) u = h, r = h.lng;
                            if (i === !1 || h.lng < i) a = h, i = h.lng
                        }
                        n !== t ? (l = o, f = s) : (l = a, f = u);
                        var p = [].concat(this.buildConvexHull([l, f], e), this.buildConvexHull([f, l], e));
                        return p
                    }
                }
            }(), L.MarkerCluster.include({
                getConvexHull: function() {
                    var e = this.getAllChildMarkers(),
                        t = [],
                        n, r;
                    for (r = e.length - 1; r >= 0; r--) n = e[r].getLatLng(), t.push(n);
                    return L.QuickHull.getConvexHull(t)
                }
            }), L.MarkerCluster.include({
                _2PI: Math.PI * 2,
                _circleFootSeparation: 25,
                _circleStartAngle: Math.PI / 6,
                _spiralFootSeparation: 28,
                _spiralLengthStart: 11,
                _spiralLengthFactor: 5,
                _circleSpiralSwitchover: 9,
                spiderfy: function() {
                    if (this._group._spiderfied === this || this._group._inZoomAnimation) return;
                    var e = this.getAllChildMarkers(),
                        t = this._group,
                        n = t._map,
                        r = n.latLngToLayerPoint(this._latlng),
                        i;
                    this._group._unspiderfy(), this._group._spiderfied = this, e.length >= this._circleSpiralSwitchover ? i = this._generatePointsSpiral(e.length, r) : (r.y += 10, i = this._generatePointsCircle(e.length, r)), this._animationSpiderfy(e, i)
                },
                unspiderfy: function(e) {
                    if (this._group._inZoomAnimation) return;
                    this._animationUnspiderfy(e), this._group._spiderfied = null
                },
                _generatePointsCircle: function(e, t) {
                    var n = this._group.options.spiderfyDistanceMultiplier * this._circleFootSeparation * (2 + e),
                        r = n / this._2PI,
                        i = this._2PI / e,
                        s = [],
                        o, u;
                    s.length = e;
                    for (o = e - 1; o >= 0; o--) u = this._circleStartAngle + o * i, s[o] = (new L.Point(t.x + r * Math.cos(u), t.y + r * Math.sin(u)))._round();
                    return s
                },
                _generatePointsSpiral: function(e, t) {
                    var n = this._group.options.spiderfyDistanceMultiplier,
                        r = n * this._spiralLengthStart,
                        i = n * this._spiralFootSeparation,
                        s = n * this._spiralLengthFactor * this._2PI,
                        o = 0,
                        u = [],
                        a;
                    u.length = e;
                    for (a = e - 1; a >= 0; a--) o += i / r + a * 5e-4, u[a] = (new L.Point(t.x + r * Math.cos(o), t.y + r * Math.sin(o)))._round(), r += s / o;
                    return u
                },
                _noanimationUnspiderfy: function() {
                    var e = this._group,
                        t = e._map,
                        n = e._featureGroup,
                        r = this.getAllChildMarkers(),
                        i, s;
                    this.setOpacity(1);
                    for (s = r.length - 1; s >= 0; s--) i = r[s], n.removeLayer(i), i._preSpiderfyLatlng && (i.setLatLng(i._preSpiderfyLatlng), delete i._preSpiderfyLatlng), i.setZIndexOffset && i.setZIndexOffset(0), i._spiderLeg && (t.removeLayer(i._spiderLeg), delete i._spiderLeg);
                    e.fire("unspiderfied", {
                        cluster: this,
                        markers: r
                    }), e._spiderfied = null
                }
            }), L.MarkerClusterNonAnimated = L.MarkerCluster.extend({
                _animationSpiderfy: function(e, t) {
                    var n = this._group,
                        r = n._map,
                        i = n._featureGroup,
                        s = this._group.options.spiderLegPolylineOptions,
                        o, u, a, f;
                    for (o = 0; o < e.length; o++) f = r.layerPointToLatLng(t[o]), u = e[o], a = new L.Polyline([this._latlng, f], s), r.addLayer(a), u._spiderLeg = a, u._preSpiderfyLatlng = u._latlng, u.setLatLng(f), u.setZIndexOffset && u.setZIndexOffset(1e6), i.addLayer(u);
                    this.setOpacity(.3), n.fire("spiderfied", {
                        cluster: this,
                        markers: e
                    })
                },
                _animationUnspiderfy: function() {
                    this._noanimationUnspiderfy()
                }
            }), L.MarkerCluster.include({
                _animationSpiderfy: function(e, t) {
                    var r = this,
                        i = this._group,
                        s = i._map,
                        o = i._featureGroup,
                        u = this._latlng,
                        a = s.latLngToLayerPoint(u),
                        f = L.Path.SVG,
                        l = L.extend({}, this._group.options.spiderLegPolylineOptions),
                        c = l.opacity,
                        h, p, d, v, m, g;
                    c === n && (c = L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity), f ? (l.opacity = 0, l.className = (l.className || "") + " leaflet-cluster-spider-leg") : l.opacity = c;
                    for (h = 0; h < e.length; h++) p = e[h], g = s.layerPointToLatLng(t[h]), d = new L.Polyline([u, g], l), s.addLayer(d), p._spiderLeg = d, f && (v = d._path, m = v.getTotalLength() + .1, v.style.strokeDasharray = m, v.style.strokeDashoffset = m), p.setZIndexOffset && p.setZIndexOffset(1e6), p.clusterHide && p.clusterHide(), o.addLayer(p), p._setPos && p._setPos(a);
                    i._forceLayout(), i._animationStart();
                    for (h = e.length - 1; h >= 0; h--) g = s.layerPointToLatLng(t[h]), p = e[h], p._preSpiderfyLatlng = p._latlng, p.setLatLng(g), p.clusterShow && p.clusterShow(), f && (d = p._spiderLeg, v = d._path, v.style.strokeDashoffset = 0, d.setStyle({
                        opacity: c
                    }));
                    this.setOpacity(.3), setTimeout(function() {
                        i._animationEnd(), i.fire("spiderfied", {
                            cluster: r,
                            markers: e
                        })
                    }, 200)
                },
                _animationUnspiderfy: function(e) {
                    var t = this,
                        n = this._group,
                        r = n._map,
                        i = n._featureGroup,
                        s = e ? r._latLngToNewLayerPoint(this._latlng, e.zoom, e.center) : r.latLngToLayerPoint(this._latlng),
                        o = this.getAllChildMarkers(),
                        u = L.Path.SVG,
                        a, f, l, c, h, p;
                    n._animationStart(), this.setOpacity(1);
                    for (f = o.length - 1; f >= 0; f--) {
                        a = o[f];
                        if (!a._preSpiderfyLatlng) continue;
                        a.setLatLng(a._preSpiderfyLatlng), delete a._preSpiderfyLatlng, p = !0, a._setPos && (a._setPos(s), p = !1), a.clusterHide && (a.clusterHide(), p = !1), p && i.removeLayer(a), u && (l = a._spiderLeg, c = l._path, h = c.getTotalLength() + .1, c.style.strokeDashoffset = h, l.setStyle({
                            opacity: 0
                        }))
                    }
                    setTimeout(function() {
                        var e = 0;
                        for (f = o.length - 1; f >= 0; f--) a = o[f], a._spiderLeg && e++;
                        for (f = o.length - 1; f >= 0; f--) {
                            a = o[f];
                            if (!a._spiderLeg) continue;
                            a.clusterShow && a.clusterShow(), a.setZIndexOffset && a.setZIndexOffset(0), e > 1 && i.removeLayer(a), r.removeLayer(a._spiderLeg), delete a._spiderLeg
                        }
                        n._animationEnd(), n.fire("unspiderfied", {
                            cluster: t,
                            markers: o
                        })
                    }, 200)
                }
            }), L.MarkerClusterGroup.include({
                _spiderfied: null,
                _spiderfierOnAdd: function() {
                    this._map.on("click", this._unspiderfyWrapper, this), this._map.options.zoomAnimation && this._map.on("zoomstart", this._unspiderfyZoomStart, this), this._map.on("zoomend", this._noanimationUnspiderfy, this)
                },
                _spiderfierOnRemove: function() {
                    this._map.off("click", this._unspiderfyWrapper, this), this._map.off("zoomstart", this._unspiderfyZoomStart, this), this._map.off("zoomanim", this._unspiderfyZoomAnim, this), this._map.off("zoomend", this._noanimationUnspiderfy, this), this._noanimationUnspiderfy()
                },
                _unspiderfyZoomStart: function() {
                    if (!this._map) return;
                    this._map.on("zoomanim", this._unspiderfyZoomAnim, this)
                },
                _unspiderfyZoomAnim: function(e) {
                    if (L.DomUtil.hasClass(this._map._mapPane, "leaflet-touching")) return;
                    this._map.off("zoomanim", this._unspiderfyZoomAnim, this), this._unspiderfy(e)
                },
                _unspiderfyWrapper: function() {
                    this._unspiderfy()
                },
                _unspiderfy: function(e) {
                    this._spiderfied && this._spiderfied.unspiderfy(e)
                },
                _noanimationUnspiderfy: function() {
                    this._spiderfied && this._spiderfied._noanimationUnspiderfy()
                },
                _unspiderfyLayer: function(e) {
                    e._spiderLeg && (this._featureGroup.removeLayer(e), e.clusterShow && e.clusterShow(), e.setZIndexOffset && e.setZIndexOffset(0), this._map.removeLayer(e._spiderLeg), delete e._spiderLeg)
                }
            }), L.MarkerClusterGroup.include({
                refreshClusters: function(e) {
                    return e ? e instanceof L.MarkerClusterGroup ? e = e._topClusterLevel.getAllChildMarkers() : e instanceof L.LayerGroup ? e = e._layers : e instanceof L.MarkerCluster ? e = e.getAllChildMarkers() : e instanceof L.Marker && (e = [e]) : e = this._topClusterLevel.getAllChildMarkers(), this._flagParentsIconsNeedUpdate(e), this._refreshClustersIcons(), this.options.singleMarkerMode && this._refreshSingleMarkerModeMarkers(e), this
                },
                _flagParentsIconsNeedUpdate: function(e) {
                    var t, n;
                    for (t in e) {
                        n = e[t].__parent;
                        while (n) n._iconNeedsUpdate = !0, n = n.__parent
                    }
                },
                _refreshClustersIcons: function() {
                    this._featureGroup.eachLayer(function(e) {
                        e instanceof L.MarkerCluster && e._iconNeedsUpdate && e._updateIcon()
                    })
                },
                _refreshSingleMarkerModeMarkers: function(e) {
                    var t, n;
                    for (t in e) n = e[t], this.hasLayer(n) && n.setIcon(this._overrideMarkerIcon(n))
                }
            }), L.Marker.include({
                refreshIconOptions: function(e, t) {
                    var n = this.options.icon;
                    return L.setOptions(n, e), this.setIcon(n), t && this.__parent && this.__parent._group.refreshClusters(this), this
                }
            })
    }(window, document), define("leaflet.markercluster", function() {}), ! function(e) {
        if ("object" == typeof exports) module.exports = e();
        else if ("function" == typeof define && define.amd) define("proj4", e);
        else {
            var t;
            "undefined" != typeof window ? t = window : "undefined" != typeof global ? t = global : "undefined" != typeof self && (t = self), t.proj4 = e()
        }
    }(function() {
        var e, t, n;
        return function r(e, t, n) {
            function i(o, u) {
                if (!t[o]) {
                    if (!e[o]) {
                        var a = typeof require == "function" && require;
                        if (!u && a) return a(o, !0);
                        if (s) return s(o, !0);
                        throw new Error("Cannot find module '" + o + "'")
                    }
                    var f = t[o] = {
                        exports: {}
                    };
                    e[o][0].call(f.exports, function(t) {
                        var n = e[o][1][t];
                        return i(n ? n : t)
                    }, f, f.exports, r, e, t, n)
                }
                return t[o].exports
            }
            var s = typeof require == "function" && require;
            for (var o = 0; o < n.length; o++) i(n[o]);
            return i
        }({
            1: [function(e, t, n) {
                function i(e, t, n) {
                    if (!(this instanceof i)) return new i(e, t, n);
                    if (Array.isArray(e)) this.x = e[0], this.y = e[1], this.z = e[2] || 0;
                    else if (typeof e == "object") this.x = e.x, this.y = e.y, this.z = e.z || 0;
                    else if (typeof e == "string" && typeof t == "undefined") {
                        var r = e.split(",");
                        this.x = parseFloat(r[0], 10), this.y = parseFloat(r[1], 10), this.z = parseFloat(r[2], 10) || 0
                    } else this.x = e, this.y = t, this.z = n || 0;
                    console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")
                }
                var r = e("mgrs");
                i.fromMGRS = function(e) {
                    return new i(r.toPoint(e))
                }, i.prototype.toMGRS = function(e) {
                    return r.forward([this.x, this.y], e)
                }, t.exports = i
            }, {
                mgrs: 67
            }],
            2: [function(e, t, n) {
                function u(e, t) {
                    if (!(this instanceof u)) return new u(e);
                    t = t || function(e) {
                        if (e) throw e
                    };
                    var n = r(e);
                    if (typeof n != "object") {
                        t(e);
                        return
                    }
                    var s = o(n),
                        a = u.projections.get(s.projName);
                    a ? (i(this, s), i(this, a), this.init(), t(null, this)) : t(e)
                }
                var r = e("./parseCode"),
                    i = e("./extend"),
                    s = e("./projections"),
                    o = e("./deriveConstants");
                u.projections = s, u.projections.start(), t.exports = u
            }, {
                "./deriveConstants": 33,
                "./extend": 34,
                "./parseCode": 37,
                "./projections": 39
            }],
            3: [function(e, t, n) {
                t.exports = function(e, t, n) {
                    var r = n.x,
                        i = n.y,
                        s = n.z || 0,
                        o, u, a;
                    for (a = 0; a < 3; a++) {
                        if (t && a === 2 && n.z === undefined) continue;
                        a === 0 ? (o = r, u = "x") : a === 1 ? (o = i, u = "y") : (o = s, u = "z");
                        switch (e.axis[a]) {
                            case "e":
                                n[u] = o;
                                break;
                            case "w":
                                n[u] = -o;
                                break;
                            case "n":
                                n[u] = o;
                                break;
                            case "s":
                                n[u] = -o;
                                break;
                            case "u":
                                n[u] !== undefined && (n.z = o);
                                break;
                            case "d":
                                n[u] !== undefined && (n.z = -o);
                                break;
                            default:
                                return null
                        }
                    }
                    return n
                }
            }, {}],
            4: [function(e, t, n) {
                var r = Math.PI / 2,
                    i = e("./sign");
                t.exports = function(e) {
                    return Math.abs(e) < r ? e : e - i(e) * Math.PI
                }
            }, {
                "./sign": 21
            }],
            5: [function(e, t, n) {
                var r = Math.PI * 2,
                    i = 3.14159265359,
                    s = e("./sign");
                t.exports = function(e) {
                    return Math.abs(e) <= i ? e : e - s(e) * r
                }
            }, {
                "./sign": 21
            }],
            6: [function(e, t, n) {
                t.exports = function(e) {
                    return Math.abs(e) > 1 && (e = e > 1 ? 1 : -1), Math.asin(e)
                }
            }, {}],
            7: [function(e, t, n) {
                t.exports = function(e) {
                    return 1 - .25 * e * (1 + e / 16 * (3 + 1.25 * e))
                }
            }, {}],
            8: [function(e, t, n) {
                t.exports = function(e) {
                    return .375 * e * (1 + .25 * e * (1 + .46875 * e))
                }
            }, {}],
            9: [function(e, t, n) {
                t.exports = function(e) {
                    return .05859375 * e * e * (1 + .75 * e)
                }
            }, {}],
            10: [function(e, t, n) {
                t.exports = function(e) {
                    return e * e * e * (35 / 3072)
                }
            }, {}],
            11: [function(e, t, n) {
                t.exports = function(e, t, n) {
                    var r = t * n;
                    return e / Math.sqrt(1 - r * r)
                }
            }, {}],
            12: [function(e, t, n) {
                t.exports = function(e, t, n, r, i) {
                    var s, o;
                    s = e / t;
                    for (var u = 0; u < 15; u++) {
                        o = (e - (t * s - n * Math.sin(2 * s) + r * Math.sin(4 * s) - i * Math.sin(6 * s))) / (t - 2 * n * Math.cos(2 * s) + 4 * r * Math.cos(4 * s) - 6 * i * Math.cos(6 * s)), s += o;
                        if (Math.abs(o) <= 1e-10) return s
                    }
                    return NaN
                }
            }, {}],
            13: [function(e, t, n) {
                var r = Math.PI / 2;
                t.exports = function(e, t) {
                    var n = 1 - (1 - e * e) / (2 * e) * Math.log((1 - e) / (1 + e));
                    if (Math.abs(Math.abs(t) - n) < 1e-6) return t < 0 ? -1 * r : r;
                    var i = Math.asin(.5 * t),
                        s, o, u, a;
                    for (var f = 0; f < 30; f++) {
                        o = Math.sin(i), u = Math.cos(i), a = e * o, s = Math.pow(1 - a * a, 2) / (2 * u) * (t / (1 - e * e) - o / (1 - a * a) + .5 / e * Math.log((1 - a) / (1 + a))), i += s;
                        if (Math.abs(s) <= 1e-10) return i
                    }
                    return NaN
                }
            }, {}],
            14: [function(e, t, n) {
                t.exports = function(e, t, n, r, i) {
                    return e * i - t * Math.sin(2 * i) + n * Math.sin(4 * i) - r * Math.sin(6 * i)
                }
            }, {}],
            15: [function(e, t, n) {
                t.exports = function(e, t, n) {
                    var r = e * t;
                    return n / Math.sqrt(1 - r * r)
                }
            }, {}],
            16: [function(e, t, n) {
                var r = Math.PI / 2;
                t.exports = function(e, t) {
                    var n = .5 * e,
                        i, s, o = r - 2 * Math.atan(t);
                    for (var u = 0; u <= 15; u++) {
                        i = e * Math.sin(o), s = r - 2 * Math.atan(t * Math.pow((1 - i) / (1 + i), n)) - o, o += s;
                        if (Math.abs(s) <= 1e-10) return o
                    }
                    return -9999
                }
            }, {}],
            17: [function(e, t, n) {
                var r = 1,
                    i = .25,
                    s = .046875,
                    o = .01953125,
                    u = .01068115234375,
                    a = .75,
                    f = .46875,
                    l = .013020833333333334,
                    c = .007120768229166667,
                    h = .3645833333333333,
                    p = .005696614583333333,
                    d = .3076171875;
                t.exports = function(e) {
                    var t = [];
                    t[0] = r - e * (i + e * (s + e * (o + e * u))), t[1] = e * (a - e * (s + e * (o + e * u)));
                    var n = e * e;
                    return t[2] = n * (f - e * (l + e * c)), n *= e, t[3] = n * (h - e * p), t[4] = n * e * d, t
                }
            }, {}],
            18: [function(e, t, n) {
                var r = e("./pj_mlfn"),
                    i = 1e-10,
                    s = 20;
                t.exports = function(e, t, n) {
                    var o = 1 / (1 - t),
                        u = e;
                    for (var a = s; a; --a) {
                        var f = Math.sin(u),
                            l = 1 - t * f * f;
                        l = (r(u, f, Math.cos(u), n) - e) * l * Math.sqrt(l) * o, u -= l;
                        if (Math.abs(l) < i) return u
                    }
                    return u
                }
            }, {
                "./pj_mlfn": 19
            }],
            19: [function(e, t, n) {
                t.exports = function(e, t, n, r) {
                    return n *= t, t *= t, r[0] * e - n * (r[1] + t * (r[2] + t * (r[3] + t * r[4])))
                }
            }, {}],
            20: [function(e, t, n) {
                t.exports = function(e, t) {
                    var n;
                    return e > 1e-7 ? (n = e * t, (1 - e * e) * (t / (1 - n * n) - .5 / e * Math.log((1 - n) / (1 + n)))) : 2 * t
                }
            }, {}],
            21: [function(e, t, n) {
                t.exports = function(e) {
                    return e < 0 ? -1 : 1
                }
            }, {}],
            22: [function(e, t, n) {
                t.exports = function(e, t) {
                    return Math.pow((1 - e) / (1 + e), t)
                }
            }, {}],
            23: [function(e, t, n) {
                t.exports = function(e) {
                    var t = {
                        x: e[0],
                        y: e[1]
                    };
                    return e.length > 2 && (t.z = e[2]), e.length > 3 && (t.m = e[3]), t
                }
            }, {}],
            24: [function(e, t, n) {
                var r = Math.PI / 2;
                t.exports = function(e, t, n) {
                    var i = e * n,
                        s = .5 * e;
                    return i = Math.pow((1 - i) / (1 + i), s), Math.tan(.5 * (r - t)) / i
                }
            }, {}],
            25: [function(e, t, n) {
                n.wgs84 = {
                    towgs84: "0,0,0",
                    ellipse: "WGS84",
                    datumName: "WGS84"
                }, n.ch1903 = {
                    towgs84: "674.374,15.056,405.346",
                    ellipse: "bessel",
                    datumName: "swiss"
                }, n.ggrs87 = {
                    towgs84: "-199.87,74.79,246.62",
                    ellipse: "GRS80",
                    datumName: "Greek_Geodetic_Reference_System_1987"
                }, n.nad83 = {
                    towgs84: "0,0,0",
                    ellipse: "GRS80",
                    datumName: "North_American_Datum_1983"
                }, n.nad27 = {
                    nadgrids: "@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",
                    ellipse: "clrk66",
                    datumName: "North_American_Datum_1927"
                }, n.potsdam = {
                    towgs84: "606.0,23.0,413.0",
                    ellipse: "bessel",
                    datumName: "Potsdam Rauenberg 1950 DHDN"
                }, n.carthage = {
                    towgs84: "-263.0,6.0,431.0",
                    ellipse: "clark80",
                    datumName: "Carthage 1934 Tunisia"
                }, n.hermannskogel = {
                    towgs84: "653.0,-212.0,449.0",
                    ellipse: "bessel",
                    datumName: "Hermannskogel"
                }, n.ire65 = {
                    towgs84: "482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",
                    ellipse: "mod_airy",
                    datumName: "Ireland 1965"
                }, n.rassadiran = {
                    towgs84: "-133.63,-157.5,-158.62",
                    ellipse: "intl",
                    datumName: "Rassadiran"
                }, n.nzgd49 = {
                    towgs84: "59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",
                    ellipse: "intl",
                    datumName: "New Zealand Geodetic Datum 1949"
                }, n.osgb36 = {
                    towgs84: "446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",
                    ellipse: "airy",
                    datumName: "Airy 1830"
                }, n.s_jtsk = {
                    towgs84: "589,76,480",
                    ellipse: "bessel",
                    datumName: "S-JTSK (Ferro)"
                }, n.beduaram = {
                    towgs84: "-106,-87,188",
                    ellipse: "clrk80",
                    datumName: "Beduaram"
                }, n.gunung_segara = {
                    towgs84: "-403,684,41",
                    ellipse: "bessel",
                    datumName: "Gunung Segara Jakarta"
                }, n.rnb72 = {
                    towgs84: "106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",
                    ellipse: "intl",
                    datumName: "Reseau National Belge 1972"
                }
            }, {}],
            26: [function(e, t, n) {
                n.MERIT = {
                    a: 6378137,
                    rf: 298.257,
                    ellipseName: "MERIT 1983"
                }, n.SGS85 = {
                    a: 6378136,
                    rf: 298.257,
                    ellipseName: "Soviet Geodetic System 85"
                }, n.GRS80 = {
                    a: 6378137,
                    rf: 298.257222101,
                    ellipseName: "GRS 1980(IUGG, 1980)"
                }, n.IAU76 = {
                    a: 6378140,
                    rf: 298.257,
                    ellipseName: "IAU 1976"
                }, n.airy = {
                    a: 6377563.396,
                    b: 6356256.91,
                    ellipseName: "Airy 1830"
                }, n.APL4 = {
                    a: 6378137,
                    rf: 298.25,
                    ellipseName: "Appl. Physics. 1965"
                }, n.NWL9D = {
                    a: 6378145,
                    rf: 298.25,
                    ellipseName: "Naval Weapons Lab., 1965"
                }, n.mod_airy = {
                    a: 6377340.189,
                    b: 6356034.446,
                    ellipseName: "Modified Airy"
                }, n.andrae = {
                    a: 6377104.43,
                    rf: 300,
                    ellipseName: "Andrae 1876 (Den., Iclnd.)"
                }, n.aust_SA = {
                    a: 6378160,
                    rf: 298.25,
                    ellipseName: "Australian Natl & S. Amer. 1969"
                }, n.GRS67 = {
                    a: 6378160,
                    rf: 298.247167427,
                    ellipseName: "GRS 67(IUGG 1967)"
                }, n.bessel = {
                    a: 6377397.155,
                    rf: 299.1528128,
                    ellipseName: "Bessel 1841"
                }, n.bess_nam = {
                    a: 6377483.865,
                    rf: 299.1528128,
                    ellipseName: "Bessel 1841 (Namibia)"
                }, n.clrk66 = {
                    a: 6378206.4,
                    b: 6356583.8,
                    ellipseName: "Clarke 1866"
                }, n.clrk80 = {
                    a: 6378249.145,
                    rf: 293.4663,
                    ellipseName: "Clarke 1880 mod."
                }, n.clrk58 = {
                    a: 6378293.645208759,
                    rf: 294.2606763692654,
                    ellipseName: "Clarke 1858"
                }, n.CPM = {
                    a: 6375738.7,
                    rf: 334.29,
                    ellipseName: "Comm. des Poids et Mesures 1799"
                }, n.delmbr = {
                    a: 6376428,
                    rf: 311.5,
                    ellipseName: "Delambre 1810 (Belgium)"
                }, n.engelis = {
                    a: 6378136.05,
                    rf: 298.2566,
                    ellipseName: "Engelis 1985"
                }, n.evrst30 = {
                    a: 6377276.345,
                    rf: 300.8017,
                    ellipseName: "Everest 1830"
                }, n.evrst48 = {
                    a: 6377304.063,
                    rf: 300.8017,
                    ellipseName: "Everest 1948"
                }, n.evrst56 = {
                    a: 6377301.243,
                    rf: 300.8017,
                    ellipseName: "Everest 1956"
                }, n.evrst69 = {
                    a: 6377295.664,
                    rf: 300.8017,
                    ellipseName: "Everest 1969"
                }, n.evrstSS = {
                    a: 6377298.556,
                    rf: 300.8017,
                    ellipseName: "Everest (Sabah & Sarawak)"
                }, n.fschr60 = {
                    a: 6378166,
                    rf: 298.3,
                    ellipseName: "Fischer (Mercury Datum) 1960"
                }, n.fschr60m = {
                    a: 6378155,
                    rf: 298.3,
                    ellipseName: "Fischer 1960"
                }, n.fschr68 = {
                    a: 6378150,
                    rf: 298.3,
                    ellipseName: "Fischer 1968"
                }, n.helmert = {
                    a: 6378200,
                    rf: 298.3,
                    ellipseName: "Helmert 1906"
                }, n.hough = {
                    a: 6378270,
                    rf: 297,
                    ellipseName: "Hough"
                }, n.intl = {
                    a: 6378388,
                    rf: 297,
                    ellipseName: "International 1909 (Hayford)"
                }, n.kaula = {
                    a: 6378163,
                    rf: 298.24,
                    ellipseName: "Kaula 1961"
                }, n.lerch = {
                    a: 6378139,
                    rf: 298.257,
                    ellipseName: "Lerch 1979"
                }, n.mprts = {
                    a: 6397300,
                    rf: 191,
                    ellipseName: "Maupertius 1738"
                }, n.new_intl = {
                    a: 6378157.5,
                    b: 6356772.2,
                    ellipseName: "New International 1967"
                }, n.plessis = {
                    a: 6376523,
                    rf: 6355863,
                    ellipseName: "Plessis 1817 (France)"
                }, n.krass = {
                    a: 6378245,
                    rf: 298.3,
                    ellipseName: "Krassovsky, 1942"
                }, n.SEasia = {
                    a: 6378155,
                    b: 6356773.3205,
                    ellipseName: "Southeast Asia"
                }, n.walbeck = {
                    a: 6376896,
                    b: 6355834.8467,
                    ellipseName: "Walbeck"
                }, n.WGS60 = {
                    a: 6378165,
                    rf: 298.3,
                    ellipseName: "WGS 60"
                }, n.WGS66 = {
                    a: 6378145,
                    rf: 298.25,
                    ellipseName: "WGS 66"
                }, n.WGS7 = {
                    a: 6378135,
                    rf: 298.26,
                    ellipseName: "WGS 72"
                }, n.WGS84 = {
                    a: 6378137,
                    rf: 298.257223563,
                    ellipseName: "WGS 84"
                }, n.sphere = {
                    a: 6370997,
                    b: 6370997,
                    ellipseName: "Normal Sphere (r=6370997)"
                }
            }, {}],
            27: [function(e, t, n) {
                n.greenwich = 0, n.lisbon = -9.131906111111, n.paris = 2.337229166667, n.bogota = -74.080916666667, n.madrid = -3.687938888889, n.rome = 12.452333333333, n.bern = 7.439583333333, n.jakarta = 106.807719444444, n.ferro = -17.666666666667, n.brussels = 4.367975, n.stockholm = 18.058277777778, n.athens = 23.7163375, n.oslo = 10.722916666667
            }, {}],
            28: [function(e, t, n) {
                n.ft = {
                    to_meter: .3048
                }, n["us-ft"] = {
                    to_meter: 1200 / 3937
                }
            }, {}],
            29: [function(e, t, n) {
                function o(e, t, n) {
                    var r;
                    return Array.isArray(n) ? (r = i(e, t, n), n.length === 3 ? [r.x, r.y, r.z] : [r.x, r.y]) : i(e, t, n)
                }

                function u(e) {
                    return e instanceof r ? e : e.oProj ? e.oProj : r(e)
                }

                function a(e, t, n) {
                    e = u(e);
                    var r = !1,
                        i;
                    if (typeof t == "undefined") t = e, e = s, r = !0;
                    else if (typeof t.x != "undefined" || Array.isArray(t)) n = t, t = e, e = s, r = !0;
                    return t = u(t), n ? o(e, t, n) : (i = {
                        forward: function(n) {
                            return o(e, t, n)
                        },
                        inverse: function(n) {
                            return o(t, e, n)
                        }
                    }, r && (i.oProj = t), i)
                }
                var r = e("./Proj"),
                    i = e("./transform"),
                    s = r("WGS84");
                t.exports = a
            }, {
                "./Proj": 2,
                "./transform": 65
            }],
            30: [function(e, t, n) {
                var r = Math.PI / 2,
                    i = 1,
                    s = 2,
                    o = 3,
                    u = 4,
                    a = 5,
                    f = 484813681109536e-20,
                    l = 1.0026,
                    c = .3826834323650898,
                    h = function(e) {
                        if (!(this instanceof h)) return new h(e);
                        this.datum_type = u;
                        if (!e) return;
                        e.datumCode && e.datumCode === "none" && (this.datum_type = a);
                        if (e.datum_params) {
                            this.datum_params = e.datum_params.map(parseFloat);
                            if (this.datum_params[0] !== 0 || this.datum_params[1] !== 0 || this.datum_params[2] !== 0) this.datum_type = i;
                            this.datum_params.length > 3 && (this.datum_params[3] !== 0 || this.datum_params[4] !== 0 || this.datum_params[5] !== 0 || this.datum_params[6] !== 0) && (this.datum_type = s, this.datum_params[3] *= f, this.datum_params[4] *= f, this.datum_params[5] *= f, this.datum_params[6] = this.datum_params[6] / 1e6 + 1)
                        }
                        this.datum_type = e.grids ? o : this.datum_type, this.a = e.a, this.b = e.b, this.es = e.es, this.ep2 = e.ep2, this.datum_type === o && (this.grids = e.grids)
                    };
                h.prototype = {
                    compare_datums: function(e) {
                        return this.datum_type !== e.datum_type ? !1 : this.a !== e.a || Math.abs(this.es - e.es) > 5e-11 ? !1 : this.datum_type === i ? this.datum_params[0] === e.datum_params[0] && this.datum_params[1] === e.datum_params[1] && this.datum_params[2] === e.datum_params[2] : this.datum_type === s ? this.datum_params[0] === e.datum_params[0] && this.datum_params[1] === e.datum_params[1] && this.datum_params[2] === e.datum_params[2] && this.datum_params[3] === e.datum_params[3] && this.datum_params[4] === e.datum_params[4] && this.datum_params[5] === e.datum_params[5] && this.datum_params[6] === e.datum_params[6] : this.datum_type === o || e.datum_type === o ? this.nadgrids === e.nadgrids : !0
                    },
                    geodetic_to_geocentric: function(e) {
                        var t = e.x,
                            n = e.y,
                            i = e.z ? e.z : 0,
                            s, o, u, a = 0,
                            f, l, c, h;
                        if (n < -r && n > -1.001 * r) n = -r;
                        else if (n > r && n < 1.001 * r) n = r;
                        else if (n < -r || n > r) return null;
                        return t > Math.PI && (t -= 2 * Math.PI), l = Math.sin(n), h = Math.cos(n), c = l * l, f = this.a / Math.sqrt(1 - this.es * c), s = (f + i) * h * Math.cos(t), o = (f + i) * h * Math.sin(t), u = (f * (1 - this.es) + i) * l, e.x = s, e.y = o, e.z = u, a
                    },
                    geocentric_to_geodetic: function(e) {
                        var t = 1e-12,
                            n = t * t,
                            i = 30,
                            s, o, u, a, f, l, c, h, p, d, v, m, g, y, b = e.x,
                            w = e.y,
                            E = e.z ? e.z : 0,
                            S, x, T;
                        g = !1, s = Math.sqrt(b * b + w * w), o = Math.sqrt(b * b + w * w + E * E);
                        if (s / this.a < t) {
                            g = !0, S = 0;
                            if (o / this.a < t) {
                                x = r, T = -this.b;
                                return
                            }
                        } else S = Math.atan2(w, b);
                        u = E / o, a = s / o, f = 1 / Math.sqrt(1 - this.es * (2 - this.es) * a * a), h = a * (1 - this.es) * f, p = u * f, y = 0;
                        do y++, c = this.a / Math.sqrt(1 - this.es * p * p), T = s * h + E * p - c * (1 - this.es * p * p), l = this.es * c / (c + T), f = 1 / Math.sqrt(1 - l * (2 - l) * a * a), d = a * (1 - l) * f, v = u * f, m = v * h - d * p, h = d, p = v; while (m * m > n && y < i);
                        return x = Math.atan(v / Math.abs(d)), e.x = S, e.y = x, e.z = T, e
                    },
                    geocentric_to_geodetic_noniter: function(e) {
                        var t = e.x,
                            n = e.y,
                            i = e.z ? e.z : 0,
                            s, o, u, a, f, h, p, d, v, m, g, y, b, w, E, S, x;
                        t = parseFloat(t), n = parseFloat(n), i = parseFloat(i), x = !1;
                        if (t !== 0) s = Math.atan2(n, t);
                        else if (n > 0) s = r;
                        else if (n < 0) s = -r;
                        else {
                            x = !0, s = 0;
                            if (i > 0) o = r;
                            else {
                                if (!(i < 0)) {
                                    o = r, u = -this.b;
                                    return
                                }
                                o = -r
                            }
                        }
                        return f = t * t + n * n, a = Math.sqrt(f), h = i * l, d = Math.sqrt(h * h + f), m = h / d, y = a / d, g = m * m * m, p = i + this.b * this.ep2 * g, S = a - this.a * this.es * y * y * y, v = Math.sqrt(p * p + S * S), b = p / v, w = S / v, E = this.a / Math.sqrt(1 - this.es * b * b), w >= c ? u = a / w - E : w <= -c ? u = a / -w - E : u = i / b + E * (this.es - 1), x === !1 && (o = Math.atan(b / w)), e.x = s, e.y = o, e.z = u, e
                    },
                    geocentric_to_wgs84: function(e) {
                        if (this.datum_type === i) e.x += this.datum_params[0], e.y += this.datum_params[1], e.z += this.datum_params[2];
                        else if (this.datum_type === s) {
                            var t = this.datum_params[0],
                                n = this.datum_params[1],
                                r = this.datum_params[2],
                                o = this.datum_params[3],
                                u = this.datum_params[4],
                                a = this.datum_params[5],
                                f = this.datum_params[6],
                                l = f * (e.x - a * e.y + u * e.z) + t,
                                c = f * (a * e.x + e.y - o * e.z) + n,
                                h = f * (-u * e.x + o * e.y + e.z) + r;
                            e.x = l, e.y = c, e.z = h
                        }
                    },
                    geocentric_from_wgs84: function(e) {
                        if (this.datum_type === i) e.x -= this.datum_params[0], e.y -= this.datum_params[1], e.z -= this.datum_params[2];
                        else if (this.datum_type === s) {
                            var t = this.datum_params[0],
                                n = this.datum_params[1],
                                r = this.datum_params[2],
                                o = this.datum_params[3],
                                u = this.datum_params[4],
                                a = this.datum_params[5],
                                f = this.datum_params[6],
                                l = (e.x - t) / f,
                                c = (e.y - n) / f,
                                h = (e.z - r) / f;
                            e.x = l + a * c - u * h, e.y = -a * l + c + o * h, e.z = u * l - o * c + h
                        }
                    }
                }, t.exports = h
            }, {}],
            31: [function(e, t, n) {
                var r = 1,
                    i = 2,
                    s = 3,
                    o = 5,
                    u = 6378137,
                    a = .006694379990141316;
                t.exports = function(e, t, n) {
                    function h(e) {
                        return e === r || e === i
                    }
                    var f, l, c;
                    if (e.compare_datums(t)) return n;
                    if (e.datum_type === o || t.datum_type === o) return n;
                    var p = e.a,
                        d = e.es,
                        v = t.a,
                        m = t.es,
                        g = e.datum_type;
                    if (g === s)
                        if (this.apply_gridshift(e, 0, n) === 0) e.a = u, e.es = a;
                        else {
                            if (!e.datum_params) return e.a = p, e.es = e.es, n;
                            f = 1;
                            for (l = 0, c = e.datum_params.length; l < c; l++) f *= e.datum_params[l];
                            if (f === 0) return e.a = p, e.es = e.es, n;
                            e.datum_params.length > 3 ? g = i : g = r
                        }
                    t.datum_type === s && (t.a = u, t.es = a);
                    if (e.es !== t.es || e.a !== t.a || h(g) || h(t.datum_type)) e.geodetic_to_geocentric(n), h(e.datum_type) && e.geocentric_to_wgs84(n), h(t.datum_type) && t.geocentric_from_wgs84(n), t.geocentric_to_geodetic(n);
                    return t.datum_type === s && this.apply_gridshift(t, 1, n), e.a = p, e.es = d, t.a = v, t.es = m, n
                }
            }, {}],
            32: [function(e, t, n) {
                function o(e) {
                    var t = this;
                    if (arguments.length === 2) {
                        var n = arguments[1];
                        typeof n == "string" ? n.charAt(0) === "+" ? o[e] = i(arguments[1]) : o[e] = s(arguments[1]) : o[e] = n
                    } else if (arguments.length === 1) {
                        if (Array.isArray(e)) return e.map(function(e) {
                            Array.isArray(e) ? o.apply(t, e) : o(e)
                        });
                        if (typeof e == "string") {
                            if (e in o) return o[e]
                        } else "EPSG" in e ? o["EPSG:" + e.EPSG] = e : "ESRI" in e ? o["ESRI:" + e.ESRI] = e : "IAU2000" in e ? o["IAU2000:" + e.IAU2000] = e : console.log(e);
                        return
                    }
                }
                var r = e("./global"),
                    i = e("./projString"),
                    s = e("./wkt");
                r(o), t.exports = o
            }, {
                "./global": 35,
                "./projString": 38,
                "./wkt": 66
            }],
            33: [function(e, t, n) {
                var r = e("./constants/Datum"),
                    i = e("./constants/Ellipsoid"),
                    s = e("./extend"),
                    o = e("./datum"),
                    u = 1e-10,
                    a = .16666666666666666,
                    f = .04722222222222222,
                    l = .022156084656084655;
                t.exports = function(e) {
                    if (e.datumCode && e.datumCode !== "none") {
                        var t = r[e.datumCode];
                        t && (e.datum_params = t.towgs84 ? t.towgs84.split(",") : null, e.ellps = t.ellipse, e.datumName = t.datumName ? t.datumName : e.datumCode)
                    }
                    if (!e.a) {
                        var n = i[e.ellps] ? i[e.ellps] : i.WGS84;
                        s(e, n)
                    }
                    e.rf && !e.b && (e.b = (1 - 1 / e.rf) * e.a);
                    if (e.rf === 0 || Math.abs(e.a - e.b) < u) e.sphere = !0, e.b = e.a;
                    return e.a2 = e.a * e.a, e.b2 = e.b * e.b, e.es = (e.a2 - e.b2) / e.a2, e.e = Math.sqrt(e.es), e.R_A && (e.a *= 1 - e.es * (a + e.es * (f + e.es * l)), e.a2 = e.a * e.a, e.b2 = e.b * e.b, e.es = 0), e.ep2 = (e.a2 - e.b2) / e.b2, e.k0 || (e.k0 = 1), e.axis || (e.axis = "enu"), e.datum || (e.datum = o(e)), e
                }
            }, {
                "./constants/Datum": 25,
                "./constants/Ellipsoid": 26,
                "./datum": 30,
                "./extend": 34
            }],
            34: [function(e, t, n) {
                t.exports = function(e, t) {
                    e = e || {};
                    var n, r;
                    if (!t) return e;
                    for (r in t) n = t[r], n !== undefined && (e[r] = n);
                    return e
                }
            }, {}],
            35: [function(e, t, n) {
                t.exports = function(e) {
                    e("EPSG:4326", "+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"), e("EPSG:4269", "+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"), e("EPSG:3857", "+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"), e.WGS84 = e["EPSG:4326"], e["EPSG:3785"] = e["EPSG:3857"], e.GOOGLE = e["EPSG:3857"], e["EPSG:900913"] = e["EPSG:3857"], e["EPSG:102113"] = e["EPSG:3857"]
                }
            }, {}],
            36: [function(e, t, n) {
                var r = e("./core");
                r.defaultDatum = "WGS84", r.Proj = e("./Proj"), r.WGS84 = new r.Proj("WGS84"), r.Point = e("./Point"), r.toPoint = e("./common/toPoint"), r.defs = e("./defs"), r.transform = e("./transform"), r.mgrs = e("mgrs"), r.version = e("../package.json").version, e("./includedProjections")(r), t.exports = r
            }, {
                "../package.json": 68,
                "./Point": 1,
                "./Proj": 2,
                "./common/toPoint": 23,
                "./core": 29,
                "./defs": 32,
                "./includedProjections": "hTEDpn",
                "./transform": 65,
                mgrs: 67
            }],
            37: [function(e, t, n) {
                function o(e) {
                    return typeof e == "string"
                }

                function u(e) {
                    return e in r
                }

                function a(e) {
                    var t = ["GEOGCS", "GEOCCS", "PROJCS", "LOCAL_CS"];
                    return t.reduce(function(t, n) {
                        return t + 1 + e.indexOf(n)
                    }, 0)
                }

                function f(e) {
                    return e[0] === "+"
                }

                function l(e) {
                    if (!o(e)) return e;
                    if (u(e)) return r[e];
                    if (a(e)) return i(e);
                    if (f(e)) return s(e)
                }
                var r = e("./defs"),
                    i = e("./wkt"),
                    s = e("./projString");
                t.exports = l
            }, {
                "./defs": 32,
                "./projString": 38,
                "./wkt": 66
            }],
            38: [function(e, t, n) {
                var r = .017453292519943295,
                    i = e("./constants/PrimeMeridian"),
                    s = e("./constants/units");
                t.exports = function(e) {
                    var t = {},
                        n = {};
                    e.split("+").map(function(e) {
                        return e.trim()
                    }).filter(function(e) {
                        return e
                    }).forEach(function(e) {
                        var t = e.split("=");
                        t.push(!0), n[t[0].toLowerCase()] = t[1]
                    });
                    var o, u, a, f = {
                        proj: "projName",
                        datum: "datumCode",
                        rf: function(e) {
                            t.rf = parseFloat(e)
                        },
                        lat_0: function(e) {
                            t.lat0 = e * r
                        },
                        lat_1: function(e) {
                            t.lat1 = e * r
                        },
                        lat_2: function(e) {
                            t.lat2 = e * r
                        },
                        lat_ts: function(e) {
                            t.lat_ts = e * r
                        },
                        lon_0: function(e) {
                            t.long0 = e * r
                        },
                        lon_1: function(e) {
                            t.long1 = e * r
                        },
                        lon_2: function(e) {
                            t.long2 = e * r
                        },
                        alpha: function(e) {
                            t.alpha = parseFloat(e) * r
                        },
                        lonc: function(e) {
                            t.longc = e * r
                        },
                        x_0: function(e) {
                            t.x0 = parseFloat(e)
                        },
                        y_0: function(e) {
                            t.y0 = parseFloat(e)
                        },
                        k_0: function(e) {
                            t.k0 = parseFloat(e)
                        },
                        k: function(e) {
                            t.k0 = parseFloat(e)
                        },
                        a: function(e) {
                            t.a = parseFloat(e)
                        },
                        b: function(e) {
                            t.b = parseFloat(e)
                        },
                        r_a: function() {
                            t.R_A = !0
                        },
                        zone: function(e) {
                            t.zone = parseInt(e, 10)
                        },
                        south: function() {
                            t.utmSouth = !0
                        },
                        towgs84: function(e) {
                            t.datum_params = e.split(",").map(function(e) {
                                return parseFloat(e)
                            })
                        },
                        to_meter: function(e) {
                            t.to_meter = parseFloat(e)
                        },
                        units: function(e) {
                            t.units = e, s[e] && (t.to_meter = s[e].to_meter)
                        },
                        from_greenwich: function(e) {
                            t.from_greenwich = e * r
                        },
                        pm: function(e) {
                            t.from_greenwich = (i[e] ? i[e] : parseFloat(e)) * r
                        },
                        nadgrids: function(e) {
                            e === "@null" ? t.datumCode = "none" : t.nadgrids = e
                        },
                        axis: function(e) {
                            var n = "ewnsud";
                            e.length === 3 && n.indexOf(e.substr(0, 1)) !== -1 && n.indexOf(e.substr(1, 1)) !== -1 && n.indexOf(e.substr(2, 1)) !== -1 && (t.axis = e)
                        }
                    };
                    for (o in n) u = n[o], o in f ? (a = f[o], typeof a == "function" ? a(u) : t[a] = u) : t[o] = u;
                    return typeof t.datumCode == "string" && t.datumCode !== "WGS84" && (t.datumCode = t.datumCode.toLowerCase()), t
                }
            }, {
                "./constants/PrimeMeridian": 27,
                "./constants/units": 28
            }],
            39: [function(e, t, n) {
                function o(e, t) {
                    var n = s.length;
                    return e.names ? (s[n] = e, e.names.forEach(function(e) {
                        i[e.toLowerCase()] = n
                    }), this) : (console.log(t), !0)
                }
                var r = [e("./projections/merc"), e("./projections/longlat")],
                    i = {},
                    s = [];
                n.add = o, n.get = function(e) {
                    if (!e) return !1;
                    var t = e.toLowerCase();
                    if (typeof i[t] != "undefined" && s[i[t]]) return s[i[t]]
                }, n.start = function() {
                    r.forEach(o)
                }
            }, {
                "./projections/longlat": 51,
                "./projections/merc": 52
            }],
            40: [function(e, t, n) {
                var r = 1e-10,
                    i = e("../common/msfnz"),
                    s = e("../common/qsfnz"),
                    o = e("../common/adjust_lon"),
                    u = e("../common/asinz");
                n.init = function() {
                    if (Math.abs(this.lat1 + this.lat2) < r) return;
                    this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e3 = Math.sqrt(this.es), this.sin_po = Math.sin(this.lat1), this.cos_po = Math.cos(this.lat1), this.t1 = this.sin_po, this.con = this.sin_po, this.ms1 = i(this.e3, this.sin_po, this.cos_po), this.qs1 = s(this.e3, this.sin_po, this.cos_po), this.sin_po = Math.sin(this.lat2), this.cos_po = Math.cos(this.lat2), this.t2 = this.sin_po, this.ms2 = i(this.e3, this.sin_po, this.cos_po), this.qs2 = s(this.e3, this.sin_po, this.cos_po), this.sin_po = Math.sin(this.lat0), this.cos_po = Math.cos(this.lat0), this.t3 = this.sin_po, this.qs0 = s(this.e3, this.sin_po, this.cos_po), Math.abs(this.lat1 - this.lat2) > r ? this.ns0 = (this.ms1 * this.ms1 - this.ms2 * this.ms2) / (this.qs2 - this.qs1) : this.ns0 = this.con, this.c = this.ms1 * this.ms1 + this.ns0 * this.qs1, this.rh = this.a * Math.sqrt(this.c - this.ns0 * this.qs0) / this.ns0
                }, n.forward = function(e) {
                    var t = e.x,
                        n = e.y;
                    this.sin_phi = Math.sin(n), this.cos_phi = Math.cos(n);
                    var r = s(this.e3, this.sin_phi, this.cos_phi),
                        i = this.a * Math.sqrt(this.c - this.ns0 * r) / this.ns0,
                        u = this.ns0 * o(t - this.long0),
                        a = i * Math.sin(u) + this.x0,
                        f = this.rh - i * Math.cos(u) + this.y0;
                    return e.x = a, e.y = f, e
                }, n.inverse = function(e) {
                    var t, n, r, i, s, u;
                    return e.x -= this.x0, e.y = this.rh - e.y + this.y0, this.ns0 >= 0 ? (t = Math.sqrt(e.x * e.x + e.y * e.y), r = 1) : (t = -Math.sqrt(e.x * e.x + e.y * e.y), r = -1), i = 0, t !== 0 && (i = Math.atan2(r * e.x, r * e.y)), r = t * this.ns0 / this.a, this.sphere ? u = Math.asin((this.c - r * r) / (2 * this.ns0)) : (n = (this.c - r * r) / this.ns0, u = this.phi1z(this.e3, n)), s = o(i / this.ns0 + this.long0), e.x = s, e.y = u, e
                }, n.phi1z = function(e, t) {
                    var n, i, s, o, a, f = u(.5 * t);
                    if (e < r) return f;
                    var l = e * e;
                    for (var c = 1; c <= 25; c++) {
                        n = Math.sin(f), i = Math.cos(f), s = e * n, o = 1 - s * s, a = .5 * o * o / i * (t / (1 - l) - n / o + .5 / e * Math.log((1 - s) / (1 + s))), f += a;
                        if (Math.abs(a) <= 1e-7) return f
                    }
                    return null
                }, n.names = ["Albers_Conic_Equal_Area", "Albers", "aea"]
            }, {
                "../common/adjust_lon": 5,
                "../common/asinz": 6,
                "../common/msfnz": 15,
                "../common/qsfnz": 20
            }],
            41: [function(e, t, n) {
                var r = e("../common/adjust_lon"),
                    i = Math.PI / 2,
                    s = 1e-10,
                    o = e("../common/mlfn"),
                    u = e("../common/e0fn"),
                    a = e("../common/e1fn"),
                    f = e("../common/e2fn"),
                    l = e("../common/e3fn"),
                    c = e("../common/gN"),
                    h = e("../common/asinz"),
                    p = e("../common/imlfn");
                n.init = function() {
                    this.sin_p12 = Math.sin(this.lat0), this.cos_p12 = Math.cos(this.lat0)
                }, n.forward = function(e) {
                    var t = e.x,
                        n = e.y,
                        h = Math.sin(e.y),
                        p = Math.cos(e.y),
                        d = r(t - this.long0),
                        v, m, g, y, b, w, E, S, x, T, N, C, k, L, A, O, M, _, D, P, H, B, j;
                    return this.sphere ? Math.abs(this.sin_p12 - 1) <= s ? (e.x = this.x0 + this.a * (i - n) * Math.sin(d), e.y = this.y0 - this.a * (i - n) * Math.cos(d), e) : Math.abs(this.sin_p12 + 1) <= s ? (e.x = this.x0 + this.a * (i + n) * Math.sin(d), e.y = this.y0 + this.a * (i + n) * Math.cos(d), e) : (_ = this.sin_p12 * h + this.cos_p12 * p * Math.cos(d), O = Math.acos(_), M = O / Math.sin(O), e.x = this.x0 + this.a * M * p * Math.sin(d), e.y = this.y0 + this.a * M * (this.cos_p12 * h - this.sin_p12 * p * Math.cos(d)), e) : (v = u(this.es), m = a(this.es), g = f(this.es), y = l(this.es), Math.abs(this.sin_p12 - 1) <= s ? (b = this.a * o(v, m, g, y, i), w = this.a * o(v, m, g, y, n), e.x = this.x0 + (b - w) * Math.sin(d), e.y = this.y0 - (b - w) * Math.cos(d), e) : Math.abs(this.sin_p12 + 1) <= s ? (b = this.a * o(v, m, g, y, i), w = this.a * o(v, m, g, y, n), e.x = this.x0 + (b + w) * Math.sin(d), e.y = this.y0 + (b + w) * Math.cos(d), e) : (E = h / p, S = c(this.a, this.e, this.sin_p12), x = c(this.a, this.e, h), T = Math.atan((1 - this.es) * E + this.es * S * this.sin_p12 / (x * p)), N = Math.atan2(Math.sin(d), this.cos_p12 * Math.tan(T) - this.sin_p12 * Math.cos(d)), N === 0 ? D = Math.asin(this.cos_p12 * Math.sin(T) - this.sin_p12 * Math.cos(T)) : Math.abs(Math.abs(N) - Math.PI) <= s ? D = -Math.asin(this.cos_p12 * Math.sin(T) - this.sin_p12 * Math.cos(T)) : D = Math.asin(Math.sin(d) * Math.cos(T) / Math.sin(N)), C = this.e * this.sin_p12 / Math.sqrt(1 - this.es), k = this.e * this.cos_p12 * Math.cos(N) / Math.sqrt(1 - this.es), L = C * k, A = k * k, P = D * D, H = P * D, B = H * D, j = B * D, O = S * D * (1 - P * A * (1 - A) / 6 + H / 8 * L * (1 - 2 * A) + B / 120 * (A * (4 - 7 * A) - 3 * C * C * (1 - 7 * A)) - j / 48 * L), e.x = this.x0 + O * Math.sin(N), e.y = this.y0 + O * Math.cos(N), e))
                }, n.inverse = function(e) {
                    e.x -= this.x0, e.y -= this.y0;
                    var t, n, d, v, m, g, y, b, w, E, S, x, T, N, C, k, L, A, O, M, _, D, P;
                    if (this.sphere) {
                        t = Math.sqrt(e.x * e.x + e.y * e.y);
                        if (t > 2 * i * this.a) return;
                        return n = t / this.a, d = Math.sin(n), v = Math.cos(n), m = this.long0, Math.abs(t) <= s ? g = this.lat0 : (g = h(v * this.sin_p12 + e.y * d * this.cos_p12 / t), y = Math.abs(this.lat0) - i, Math.abs(y) <= s ? this.lat0 >= 0 ? m = r(this.long0 + Math.atan2(e.x, -e.y)) : m = r(this.long0 - Math.atan2(-e.x, e.y)) : m = r(this.long0 + Math.atan2(e.x * d, t * this.cos_p12 * v - e.y * this.sin_p12 * d))), e.x = m, e.y = g, e
                    }
                    return b = u(this.es), w = a(this.es), E = f(this.es), S = l(this.es), Math.abs(this.sin_p12 - 1) <= s ? (x = this.a * o(b, w, E, S, i), t = Math.sqrt(e.x * e.x + e.y * e.y), T = x - t, g = p(T / this.a, b, w, E, S), m = r(this.long0 + Math.atan2(e.x, -1 * e.y)), e.x = m, e.y = g, e) : Math.abs(this.sin_p12 + 1) <= s ? (x = this.a * o(b, w, E, S, i), t = Math.sqrt(e.x * e.x + e.y * e.y), T = t - x, g = p(T / this.a, b, w, E, S), m = r(this.long0 + Math.atan2(e.x, e.y)), e.x = m, e.y = g, e) : (t = Math.sqrt(e.x * e.x + e.y * e.y), k = Math.atan2(e.x, e.y), N = c(this.a, this.e, this.sin_p12), L = Math.cos(k), A = this.e * this.cos_p12 * L, O = -A * A / (1 - this.es), M = 3 * this.es * (1 - O) * this.sin_p12 * this.cos_p12 * L / (1 - this.es), _ = t / N, D = _ - O * (1 + O) * Math.pow(_, 3) / 6 - M * (1 + 3 * O) * Math.pow(_, 4) / 24, P = 1 - O * D * D / 2 - _ * D * D * D / 6, C = Math.asin(this.sin_p12 * Math.cos(D) + this.cos_p12 * Math.sin(D) * L), m = r(this.long0 + Math.asin(Math.sin(k) * Math.sin(D) / Math.cos(C))), g = Math.atan((1 - this.es * P * this.sin_p12 / Math.sin(C)) * Math.tan(C) / (1 - this.es)), e.x = m, e.y = g, e)
                }, n.names = ["Azimuthal_Equidistant", "aeqd"]
            }, {
                "../common/adjust_lon": 5,
                "../common/asinz": 6,
                "../common/e0fn": 7,
                "../common/e1fn": 8,
                "../common/e2fn": 9,
                "../common/e3fn": 10,
                "../common/gN": 11,
                "../common/imlfn": 12,
                "../common/mlfn": 14
            }],
            42: [function(e, t, n) {
                var r = e("../common/mlfn"),
                    i = e("../common/e0fn"),
                    s = e("../common/e1fn"),
                    o = e("../common/e2fn"),
                    u = e("../common/e3fn"),
                    a = e("../common/gN"),
                    f = e("../common/adjust_lon"),
                    l = e("../common/adjust_lat"),
                    c = e("../common/imlfn"),
                    h = Math.PI / 2,
                    p = 1e-10;
                n.init = function() {
                    this.sphere || (this.e0 = i(this.es), this.e1 = s(this.es), this.e2 = o(this.es), this.e3 = u(this.es), this.ml0 = this.a * r(this.e0, this.e1, this.e2, this.e3, this.lat0))
                }, n.forward = function(e) {
                    var t, n, i = e.x,
                        s = e.y;
                    i = f(i - this.long0);
                    if (this.sphere) t = this.a * Math.asin(Math.cos(s) * Math.sin(i)), n = this.a * (Math.atan2(Math.tan(s), Math.cos(i)) - this.lat0);
                    else {
                        var o = Math.sin(s),
                            u = Math.cos(s),
                            l = a(this.a, this.e, o),
                            c = Math.tan(s) * Math.tan(s),
                            h = i * Math.cos(s),
                            p = h * h,
                            d = this.es * u * u / (1 - this.es),
                            v = this.a * r(this.e0, this.e1, this.e2, this.e3, s);
                        t = l * h * (1 - p * c * (1 / 6 - (8 - c + 8 * d) * p / 120)), n = v - this.ml0 + l * o / u * p * (.5 + (5 - c + 6 * d) * p / 24)
                    }
                    return e.x = t + this.x0, e.y = n + this.y0, e
                }, n.inverse = function(e) {
                    e.x -= this.x0, e.y -= this.y0;
                    var t = e.x / this.a,
                        n = e.y / this.a,
                        r, i;
                    if (this.sphere) {
                        var s = n + this.lat0;
                        r = Math.asin(Math.sin(s) * Math.cos(t)), i = Math.atan2(Math.tan(t), Math.cos(s))
                    } else {
                        var o = this.ml0 / this.a + n,
                            u = c(o, this.e0, this.e1, this.e2, this.e3);
                        if (Math.abs(Math.abs(u) - h) <= p) return e.x = this.long0, e.y = h, n < 0 && (e.y *= -1), e;
                        var d = a(this.a, this.e, Math.sin(u)),
                            v = d * d * d / this.a / this.a * (1 - this.es),
                            m = Math.pow(Math.tan(u), 2),
                            g = t * this.a / d,
                            y = g * g;
                        r = u - d * Math.tan(u) / v * g * g * (.5 - (1 + 3 * m) * g * g / 24), i = g * (1 - y * (m / 3 + (1 + 3 * m) * m * y / 15)) / Math.cos(u)
                    }
                    return e.x = f(i + this.long0), e.y = l(r), e
                }, n.names = ["Cassini", "Cassini_Soldner", "cass"]
            }, {
                "../common/adjust_lat": 4,
                "../common/adjust_lon": 5,
                "../common/e0fn": 7,
                "../common/e1fn": 8,
                "../common/e2fn": 9,
                "../common/e3fn": 10,
                "../common/gN": 11,
                "../common/imlfn": 12,
                "../common/mlfn": 14
            }],
            43: [function(e, t, n) {
                var r = e("../common/adjust_lon"),
                    i = e("../common/qsfnz"),
                    s = e("../common/msfnz"),
                    o = e("../common/iqsfnz");
                n.init = function() {
                    this.sphere || (this.k0 = s(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)))
                }, n.forward = function(e) {
                    var t = e.x,
                        n = e.y,
                        s, o, u = r(t - this.long0);
                    if (this.sphere) s = this.x0 + this.a * u * Math.cos(this.lat_ts), o = this.y0 + this.a * Math.sin(n) / Math.cos(this.lat_ts);
                    else {
                        var a = i(this.e, Math.sin(n));
                        s = this.x0 + this.a * this.k0 * u, o = this.y0 + this.a * a * .5 / this.k0
                    }
                    return e.x = s, e.y = o, e
                }, n.inverse = function(e) {
                    e.x -= this.x0, e.y -= this.y0;
                    var t, n;
                    return this.sphere ? (t = r(this.long0 + e.x / this.a / Math.cos(this.lat_ts)), n = Math.asin(e.y / this.a * Math.cos(this.lat_ts))) : (n = o(this.e, 2 * e.y * this.k0 / this.a), t = r(this.long0 + e.x / (this.a * this.k0))), e.x = t, e.y = n, e
                }, n.names = ["cea"]
            }, {
                "../common/adjust_lon": 5,
                "../common/iqsfnz": 13,
                "../common/msfnz": 15,
                "../common/qsfnz": 20
            }],
            44: [function(e, t, n) {
                var r = e("../common/adjust_lon"),
                    i = e("../common/adjust_lat");
                n.init = function() {
                    this.x0 = this.x0 || 0, this.y0 = this.y0 || 0, this.lat0 = this.lat0 || 0, this.long0 = this.long0 || 0, this.lat_ts = this.lat_ts || 0, this.title = this.title || "Equidistant Cylindrical (Plate Carre)", this.rc = Math.cos(this.lat_ts)
                }, n.forward = function(e) {
                    var t = e.x,
                        n = e.y,
                        s = r(t - this.long0),
                        o = i(n - this.lat0);
                    return e.x = this.x0 + this.a * s * this.rc, e.y = this.y0 + this.a * o, e
                }, n.inverse = function(e) {
                    var t = e.x,
                        n = e.y;
                    return e.x = r(this.long0 + (t - this.x0) / (this.a * this.rc)), e.y = i(this.lat0 + (n - this.y0) / this.a), e
                }, n.names = ["Equirectangular", "Equidistant_Cylindrical", "eqc"]
            }, {
                "../common/adjust_lat": 4,
                "../common/adjust_lon": 5
            }],
            45: [function(e, t, n) {
                var r = e("../common/e0fn"),
                    i = e("../common/e1fn"),
                    s = e("../common/e2fn"),
                    o = e("../common/e3fn"),
                    u = e("../common/msfnz"),
                    a = e("../common/mlfn"),
                    f = e("../common/adjust_lon"),
                    l = e("../common/adjust_lat"),
                    c = e("../common/imlfn"),
                    h = 1e-10;
                n.init = function() {
                    if (Math.abs(this.lat1 + this.lat2) < h) return;
                    this.lat2 = this.lat2 || this.lat1, this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e = Math.sqrt(this.es), this.e0 = r(this.es), this.e1 = i(this.es), this.e2 = s(this.es), this.e3 = o(this.es), this.sinphi = Math.sin(this.lat1), this.cosphi = Math.cos(this.lat1), this.ms1 = u(this.e, this.sinphi, this.cosphi), this.ml1 = a(this.e0, this.e1, this.e2, this.e3, this.lat1), Math.abs(this.lat1 - this.lat2) < h ? this.ns = this.sinphi : (this.sinphi = Math.sin(this.lat2), this.cosphi = Math.cos(this.lat2), this.ms2 = u(this.e, this.sinphi, this.cosphi), this.ml2 = a(this.e0, this.e1, this.e2, this.e3, this.lat2), this.ns = (this.ms1 - this.ms2) / (this.ml2 - this.ml1)), this.g = this.ml1 + this.ms1 / this.ns, this.ml0 = a(this.e0, this.e1, this.e2, this.e3, this.lat0), this.rh = this.a * (this.g - this.ml0)
                }, n.forward = function(e) {
                    var t = e.x,
                        n = e.y,
                        r;
                    if (this.sphere) r = this.a * (this.g - n);
                    else {
                        var i = a(this.e0, this.e1, this.e2, this.e3, n);
                        r = this.a * (this.g - i)
                    }
                    var s = this.ns * f(t - this.long0),
                        o = this.x0 + r * Math.sin(s),
                        u = this.y0 + this.rh - r * Math.cos(s);
                    return e.x = o, e.y = u, e
                }, n.inverse = function(e) {
                    e.x -= this.x0, e.y = this.rh - e.y + this.y0;
                    var t, n, r, i;
                    this.ns >= 0 ? (n = Math.sqrt(e.x * e.x + e.y * e.y), t = 1) : (n = -Math.sqrt(e.x * e.x + e.y * e.y), t = -1);
                    var s = 0;
                    n !== 0 && (s = Math.atan2(t * e.x, t * e.y));
                    if (this.sphere) return i = f(this.long0 + s / this.ns), r = l(this.g - n / this.a), e.x = i, e.y = r, e;
                    var o = this.g - n / this.a;
                    return r = c(o, this.e0, this.e1, this.e2, this.e3), i = f(this.long0 + s / this.ns), e.x = i, e.y = r, e
                }, n.names = ["Equidistant_Conic", "eqdc"]
            }, {
                "../common/adjust_lat": 4,
                "../common/adjust_lon": 5,
                "../common/e0fn": 7,
                "../common/e1fn": 8,
                "../common/e2fn": 9,
                "../common/e3fn": 10,
                "../common/imlfn": 12,
                "../common/mlfn": 14,
                "../common/msfnz": 15
            }],
            46: [function(e, t, n) {
                var r = Math.PI / 4,
                    i = e("../common/srat"),
                    s = Math.PI / 2,
                    o = 20;
                n.init = function() {
                    var e = Math.sin(this.lat0),
                        t = Math.cos(this.lat0);
                    t *= t, this.rc = Math.sqrt(1 - this.es) / (1 - this.es * e * e), this.C = Math.sqrt(1 + this.es * t * t / (1 - this.es)), this.phic0 = Math.asin(e / this.C), this.ratexp = .5 * this.C * this.e;
                    var n = Math.tan(.5 * this.phic0 + r),
                        s = Math.tan(.5 * this.lat0 + r);
                    n = n !== Number.POSITIVE_INFINITY ? n : Number.MAX_VALUE, s = s !== Number.POSITIVE_INFINITY ? s : Number.MAX_VALUE, this.K = n / (Math.pow(s, this.C) * i(this.e * e, this.ratexp))
                }, n.forward = function(e) {
                    var t = e.x,
                        n = e.y,
                        o = Math.tan(.5 * n + r);
                    return o = o !== Number.POSITIVE_INFINITY ? o : Number.MAX_VALUE, e.y = 2 * Math.atan(this.K * Math.pow(o, this.C) * i(this.e * Math.sin(n), this.ratexp)) - s, e.x = this.C * t, e
                }, n.inverse = function(e) {
                    var t = 1e-14,
                        n = e.x / this.C,
                        u = e.y,
                        a = Math.tan(.5 * u + r);
                    a = a !== Number.POSITIVE_INFINITY ? a : Number.MAX_VALUE;
                    var f = Math.pow(a / this.K, 1 / this.C);
                    for (var l = o; l > 0; --l) {
                        u = 2 * Math.atan(f * i(this.e * Math.sin(e.y), -0.5 * this.e)) - s;
                        if (Math.abs(u - e.y) < t) break;
                        e.y = u
                    }
                    return l ? (e.x = n, e.y = u, e) : null
                }, n.names = ["gauss"]
            }, {
                "../common/srat": 22
            }],
            47: [function(e, t, n) {
                var r = e("../common/adjust_lon"),
                    i = 1e-10,
                    s = e("../common/asinz");
                n.init = function() {
                    this.sin_p14 = Math.sin(this.lat0), this.cos_p14 = Math.cos(this.lat0), this.infinity_dist = 1e3 * this.a, this.rc = 1
                }, n.forward = function(e) {
                    var t, n, s, o, u, a, f, l, c = e.x,
                        h = e.y;
                    return s = r(c - this.long0), t = Math.sin(h), n = Math.cos(h), o = Math.cos(s), a = this.sin_p14 * t + this.cos_p14 * n * o, u = 1, a > 0 || Math.abs(a) <= i ? (f = this.x0 + this.a * u * n * Math.sin(s) / a, l = this.y0 + this.a * u * (this.cos_p14 * t - this.sin_p14 * n * o) / a) : (f = this.x0 + this.infinity_dist * n * Math.sin(s), l = this.y0 + this.infinity_dist * (this.cos_p14 * t - this.sin_p14 * n * o)), e.x = f, e.y = l, e
                }, n.inverse = function(e) {
                    var t, n, i, o, u, a;
                    return e.x = (e.x - this.x0) / this.a, e.y = (e.y - this.y0) / this.a, e.x /= this.k0, e.y /= this.k0, (t = Math.sqrt(e.x * e.x + e.y * e.y)) ? (o = Math.atan2(t, this.rc), n = Math.sin(o), i = Math.cos(o), a = s(i * this.sin_p14 + e.y * n * this.cos_p14 / t), u = Math.atan2(e.x * n, t * this.cos_p14 * i - e.y * this.sin_p14 * n), u = r(this.long0 + u)) : (a = this.phic0, u = 0), e.x = u, e.y = a, e
                }, n.names = ["gnom"]
            }, {
                "../common/adjust_lon": 5,
                "../common/asinz": 6
            }],
            48: [function(e, t, n) {
                var r = e("../common/adjust_lon");
                n.init = function() {
                    this.a = 6377397.155, this.es = .006674372230614, this.e = Math.sqrt(this.es), this.lat0 || (this.lat0 = .863937979737193), this.long0 || (this.long0 = .4334234309119251), this.k0 || (this.k0 = .9999), this.s45 = .785398163397448, this.s90 = 2 * this.s45, this.fi0 = this.lat0, this.e2 = this.es, this.e = Math.sqrt(this.e2), this.alfa = Math.sqrt(1 + this.e2 * Math.pow(Math.cos(this.fi0), 4) / (1 - this.e2)), this.uq = 1.04216856380474, this.u0 = Math.asin(Math.sin(this.fi0) / this.alfa), this.g = Math.pow((1 + this.e * Math.sin(this.fi0)) / (1 - this.e * Math.sin(this.fi0)), this.alfa * this.e / 2), this.k = Math.tan(this.u0 / 2 + this.s45) / Math.pow(Math.tan(this.fi0 / 2 + this.s45), this.alfa) * this.g, this.k1 = this.k0, this.n0 = this.a * Math.sqrt(1 - this.e2) / (1 - this.e2 * Math.pow(Math.sin(this.fi0), 2)), this.s0 = 1.37008346281555, this.n = Math.sin(this.s0), this.ro0 = this.k1 * this.n0 / Math.tan(this.s0), this.ad = this.s90 - this.uq
                }, n.forward = function(e) {
                    var t, n, i, s, o, u, a, f = e.x,
                        l = e.y,
                        c = r(f - this.long0);
                    return t = Math.pow((1 + this.e * Math.sin(l)) / (1 - this.e * Math.sin(l)), this.alfa * this.e / 2), n = 2 * (Math.atan(this.k * Math.pow(Math.tan(l / 2 + this.s45), this.alfa) / t) - this.s45), i = -c * this.alfa, s = Math.asin(Math.cos(this.ad) * Math.sin(n) + Math.sin(this.ad) * Math.cos(n) * Math.cos(i)), o = Math.asin(Math.cos(n) * Math.sin(i) / Math.cos(s)), u = this.n * o, a = this.ro0 * Math.pow(Math.tan(this.s0 / 2 + this.s45), this.n) / Math.pow(Math.tan(s / 2 + this.s45), this.n), e.y = a * Math.cos(u) / 1, e.x = a * Math.sin(u) / 1, this.czech || (e.y *= -1, e.x *= -1), e
                }, n.inverse = function(e) {
                    var t, n, r, i, s, o, u, a, f = e.x;
                    e.x = e.y, e.y = f, this.czech || (e.y *= -1, e.x *= -1), o = Math.sqrt(e.x * e.x + e.y * e.y), s = Math.atan2(e.y, e.x), i = s / Math.sin(this.s0), r = 2 * (Math.atan(Math.pow(this.ro0 / o, 1 / this.n) * Math.tan(this.s0 / 2 + this.s45)) - this.s45), t = Math.asin(Math.cos(this.ad) * Math.sin(r) - Math.sin(this.ad) * Math.cos(r) * Math.cos(i)), n = Math.asin(Math.cos(r) * Math.sin(i) / Math.cos(t)), e.x = this.long0 - n / this.alfa, u = t, a = 0;
                    var l = 0;
                    do e.y = 2 * (Math.atan(Math.pow(this.k, -1 / this.alfa) * Math.pow(Math.tan(t / 2 + this.s45), 1 / this.alfa) * Math.pow((1 + this.e * Math.sin(u)) / (1 - this.e * Math.sin(u)), this.e / 2)) - this.s45), Math.abs(u - e.y) < 1e-10 && (a = 1), u = e.y, l += 1; while (a === 0 && l < 15);
                    return l >= 15 ? null : e
                }, n.names = ["Krovak", "krovak"]
            }, {
                "../common/adjust_lon": 5
            }],
            49: [function(e, t, n) {
                var r = Math.PI / 2,
                    i = Math.PI / 4,
                    s = 1e-10,
                    o = e("../common/qsfnz"),
                    u = e("../common/adjust_lon");
                n.S_POLE = 1, n.N_POLE = 2, n.EQUIT = 3, n.OBLIQ = 4, n.init = function() {
                    var e = Math.abs(this.lat0);
                    Math.abs(e - r) < s ? this.mode = this.lat0 < 0 ? this.S_POLE : this.N_POLE : Math.abs(e) < s ? this.mode = this.EQUIT : this.mode = this.OBLIQ;
                    if (this.es > 0) {
                        var t;
                        this.qp = o(this.e, 1), this.mmf = .5 / (1 - this.es), this.apa = this.authset(this.es);
                        switch (this.mode) {
                            case this.N_POLE:
                                this.dd = 1;
                                break;
                            case this.S_POLE:
                                this.dd = 1;
                                break;
                            case this.EQUIT:
                                this.rq = Math.sqrt(.5 * this.qp), this.dd = 1 / this.rq, this.xmf = 1, this.ymf = .5 * this.qp;
                                break;
                            case this.OBLIQ:
                                this.rq = Math.sqrt(.5 * this.qp), t = Math.sin(this.lat0), this.sinb1 = o(this.e, t) / this.qp, this.cosb1 = Math.sqrt(1 - this.sinb1 * this.sinb1), this.dd = Math.cos(this.lat0) / (Math.sqrt(1 - this.es * t * t) * this.rq * this.cosb1), this.ymf = (this.xmf = this.rq) / this.dd, this.xmf *= this.dd
                        }
                    } else this.mode === this.OBLIQ && (this.sinph0 = Math.sin(this.lat0), this.cosph0 = Math.cos(this.lat0))
                }, n.forward = function(e) {
                    var t, n, a, f, l, c, h, p, d, v, m = e.x,
                        g = e.y;
                    m = u(m - this.long0);
                    if (this.sphere) {
                        l = Math.sin(g), v = Math.cos(g), a = Math.cos(m);
                        if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                            n = this.mode === this.EQUIT ? 1 + v * a : 1 + this.sinph0 * l + this.cosph0 * v * a;
                            if (n <= s) return null;
                            n = Math.sqrt(2 / n), t = n * v * Math.sin(m), n *= this.mode === this.EQUIT ? l : this.cosph0 * l - this.sinph0 * v * a
                        } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
                            this.mode === this.N_POLE && (a = -a);
                            if (Math.abs(g + this.phi0) < s) return null;
                            n = i - g * .5, n = 2 * (this.mode === this.S_POLE ? Math.cos(n) : Math.sin(n)), t = n * Math.sin(m), n *= a
                        }
                    } else {
                        h = 0, p = 0, d = 0, a = Math.cos(m), f = Math.sin(m), l = Math.sin(g), c = o(this.e, l);
                        if (this.mode === this.OBLIQ || this.mode === this.EQUIT) h = c / this.qp, p = Math.sqrt(1 - h * h);
                        switch (this.mode) {
                            case this.OBLIQ:
                                d = 1 + this.sinb1 * h + this.cosb1 * p * a;
                                break;
                            case this.EQUIT:
                                d = 1 + p * a;
                                break;
                            case this.N_POLE:
                                d = r + g, c = this.qp - c;
                                break;
                            case this.S_POLE:
                                d = g - r, c = this.qp + c
                        }
                        if (Math.abs(d) < s) return null;
                        switch (this.mode) {
                            case this.OBLIQ:
                            case this.EQUIT:
                                d = Math.sqrt(2 / d), this.mode === this.OBLIQ ? n = this.ymf * d * (this.cosb1 * h - this.sinb1 * p * a) : n = (d = Math.sqrt(2 / (1 + p * a))) * h * this.ymf, t = this.xmf * d * p * f;
                                break;
                            case this.N_POLE:
                            case this.S_POLE:
                                c >= 0 ? (t = (d = Math.sqrt(c)) * f, n = a * (this.mode === this.S_POLE ? d : -d)) : t = n = 0
                        }
                    }
                    return e.x = this.a * t + this.x0, e.y = this.a * n + this.y0, e
                }, n.inverse = function(e) {
                    e.x -= this.x0, e.y -= this.y0;
                    var t = e.x / this.a,
                        n = e.y / this.a,
                        i, o, a, f, l, c, h;
                    if (this.sphere) {
                        var p = 0,
                            d, v = 0;
                        d = Math.sqrt(t * t + n * n), o = d * .5;
                        if (o > 1) return null;
                        o = 2 * Math.asin(o);
                        if (this.mode === this.OBLIQ || this.mode === this.EQUIT) v = Math.sin(o), p = Math.cos(o);
                        switch (this.mode) {
                            case this.EQUIT:
                                o = Math.abs(d) <= s ? 0 : Math.asin(n * v / d), t *= v, n = p * d;
                                break;
                            case this.OBLIQ:
                                o = Math.abs(d) <= s ? this.phi0 : Math.asin(p * this.sinph0 + n * v * this.cosph0 / d), t *= v * this.cosph0, n = (p - Math.sin(o) * this.sinph0) * d;
                                break;
                            case this.N_POLE:
                                n = -n, o = r - o;
                                break;
                            case this.S_POLE:
                                o -= r
                        }
                        i = n !== 0 || this.mode !== this.EQUIT && this.mode !== this.OBLIQ ? Math.atan2(t, n) : 0
                    } else {
                        h = 0;
                        if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                            t /= this.dd, n *= this.dd, c = Math.sqrt(t * t + n * n);
                            if (c < s) return e.x = 0, e.y = this.phi0, e;
                            f = 2 * Math.asin(.5 * c / this.rq), a = Math.cos(f), t *= f = Math.sin(f), this.mode === this.OBLIQ ? (h = a * this.sinb1 + n * f * this.cosb1 / c, l = this.qp * h, n = c * this.cosb1 * a - n * this.sinb1 * f) : (h = n * f / c, l = this.qp * h, n = c * a)
                        } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
                            this.mode === this.N_POLE && (n = -n), l = t * t + n * n;
                            if (!l) return e.x = 0, e.y = this.phi0, e;
                            h = 1 - l / this.qp, this.mode === this.S_POLE && (h = -h)
                        }
                        i = Math.atan2(t, n), o = this.authlat(Math.asin(h), this.apa)
                    }
                    return e.x = u(this.long0 + i), e.y = o, e
                }, n.P00 = .3333333333333333, n.P01 = .17222222222222222, n.P02 = .10257936507936508, n.P10 = .06388888888888888, n.P11 = .0664021164021164, n.P20 = .016415012942191543, n.authset = function(e) {
                    var t, n = [];
                    return n[0] = e * this.P00, t = e * e, n[0] += t * this.P01, n[1] = t * this.P10, t *= e, n[0] += t * this.P02, n[1] += t * this.P11, n[2] = t * this.P20, n
                }, n.authlat = function(e, t) {
                    var n = e + e;
                    return e + t[0] * Math.sin(n) + t[1] * Math.sin(n + n) + t[2] * Math.sin(n + n + n)
                }, n.names = ["Lambert Azimuthal Equal Area", "Lambert_Azimuthal_Equal_Area", "laea"]
            }, {
                "../common/adjust_lon": 5,
                "../common/qsfnz": 20
            }],
            50: [function(e, t, n) {
                var r = 1e-10,
                    i = e("../common/msfnz"),
                    s = e("../common/tsfnz"),
                    o = Math.PI / 2,
                    u = e("../common/sign"),
                    a = e("../common/adjust_lon"),
                    f = e("../common/phi2z");
                n.init = function() {
                    this.lat2 || (this.lat2 = this.lat1), this.k0 || (this.k0 = 1), this.x0 = this.x0 || 0, this.y0 = this.y0 || 0;
                    if (Math.abs(this.lat1 + this.lat2) < r) return;
                    var e = this.b / this.a;
                    this.e = Math.sqrt(1 - e * e);
                    var t = Math.sin(this.lat1),
                        n = Math.cos(this.lat1),
                        o = i(this.e, t, n),
                        u = s(this.e, this.lat1, t),
                        a = Math.sin(this.lat2),
                        f = Math.cos(this.lat2),
                        l = i(this.e, a, f),
                        c = s(this.e, this.lat2, a),
                        h = s(this.e, this.lat0, Math.sin(this.lat0));
                    Math.abs(this.lat1 - this.lat2) > r ? this.ns = Math.log(o / l) / Math.log(u / c) : this.ns = t, isNaN(this.ns) && (this.ns = t), this.f0 = o / (this.ns * Math.pow(u, this.ns)), this.rh = this.a * this.f0 * Math.pow(h, this.ns), this.title || (this.title = "Lambert Conformal Conic")
                }, n.forward = function(e) {
                    var t = e.x,
                        n = e.y;
                    Math.abs(2 * Math.abs(n) - Math.PI) <= r && (n = u(n) * (o - 2 * r));
                    var i = Math.abs(Math.abs(n) - o),
                        f, l;
                    if (i > r) f = s(this.e, n, Math.sin(n)), l = this.a * this.f0 * Math.pow(f, this.ns);
                    else {
                        i = n * this.ns;
                        if (i <= 0) return null;
                        l = 0
                    }
                    var c = this.ns * a(t - this.long0);
                    return e.x = this.k0 * l * Math.sin(c) + this.x0, e.y = this.k0 * (this.rh - l * Math.cos(c)) + this.y0, e
                }, n.inverse = function(e) {
                    var t, n, r, i, s, u = (e.x - this.x0) / this.k0,
                        l = this.rh - (e.y - this.y0) / this.k0;
                    this.ns > 0 ? (t = Math.sqrt(u * u + l * l), n = 1) : (t = -Math.sqrt(u * u + l * l), n = -1);
                    var c = 0;
                    t !== 0 && (c = Math.atan2(n * u, n * l));
                    if (t !== 0 || this.ns > 0) {
                        n = 1 / this.ns, r = Math.pow(t / (this.a * this.f0), n), i = f(this.e, r);
                        if (i === -9999) return null
                    } else i = -o;
                    return s = a(c / this.ns + this.long0), e.x = s, e.y = i, e
                }, n.names = ["Lambert Tangential Conformal Conic Projection", "Lambert_Conformal_Conic", "Lambert_Conformal_Conic_2SP", "lcc"]
            }, {
                "../common/adjust_lon": 5,
                "../common/msfnz": 15,
                "../common/phi2z": 16,
                "../common/sign": 21,
                "../common/tsfnz": 24
            }],
            51: [function(e, t, n) {
                function r(e) {
                    return e
                }
                n.init = function() {}, n.forward = r, n.inverse = r, n.names = ["longlat", "identity"]
            }, {}],
            52: [function(e, t, n) {
                var r = e("../common/msfnz"),
                    i = Math.PI / 2,
                    s = 1e-10,
                    o = 57.29577951308232,
                    u = e("../common/adjust_lon"),
                    a = Math.PI / 4,
                    f = e("../common/tsfnz"),
                    l = e("../common/phi2z");
                n.init = function() {
                    var e = this.b / this.a;
                    this.es = 1 - e * e, "x0" in this || (this.x0 = 0), "y0" in this || (this.y0 = 0), this.e = Math.sqrt(this.es), this.lat_ts ? this.sphere ? this.k0 = Math.cos(this.lat_ts) : this.k0 = r(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) : this.k0 || (this.k ? this.k0 = this.k : this.k0 = 1)
                }, n.forward = function(e) {
                    var t = e.x,
                        n = e.y;
                    if (n * o > 90 && n * o < -90 && t * o > 180 && t * o < -180) return null;
                    var r, l;
                    if (Math.abs(Math.abs(n) - i) <= s) return null;
                    if (this.sphere) r = this.x0 + this.a * this.k0 * u(t - this.long0), l = this.y0 + this.a * this.k0 * Math.log(Math.tan(a + .5 * n));
                    else {
                        var c = Math.sin(n),
                            h = f(this.e, n, c);
                        r = this.x0 + this.a * this.k0 * u(t - this.long0), l = this.y0 - this.a * this.k0 * Math.log(h)
                    }
                    return e.x = r, e.y = l, e
                }, n.inverse = function(e) {
                    var t = e.x - this.x0,
                        n = e.y - this.y0,
                        r, s;
                    if (this.sphere) s = i - 2 * Math.atan(Math.exp(-n / (this.a * this.k0)));
                    else {
                        var o = Math.exp(-n / (this.a * this.k0));
                        s = l(this.e, o);
                        if (s === -9999) return null
                    }
                    return r = u(this.long0 + t / (this.a * this.k0)), e.x = r, e.y = s, e
                }, n.names = ["Mercator", "Popular Visualisation Pseudo Mercator", "Mercator_1SP", "Mercator_Auxiliary_Sphere", "merc"]
            }, {
                "../common/adjust_lon": 5,
                "../common/msfnz": 15,
                "../common/phi2z": 16,
                "../common/tsfnz": 24
            }],
            53: [function(e, t, n) {
                var r = e("../common/adjust_lon");
                n.init = function() {}, n.forward = function(e) {
                    var t = e.x,
                        n = e.y,
                        i = r(t - this.long0),
                        s = this.x0 + this.a * i,
                        o = this.y0 + this.a * Math.log(Math.tan(Math.PI / 4 + n / 2.5)) * 1.25;
                    return e.x = s, e.y = o, e
                }, n.inverse = function(e) {
                    e.x -= this.x0, e.y -= this.y0;
                    var t = r(this.long0 + e.x / this.a),
                        n = 2.5 * (Math.atan(Math.exp(.8 * e.y / this.a)) - Math.PI / 4);
                    return e.x = t, e.y = n, e
                }, n.names = ["Miller_Cylindrical", "mill"]
            }, {
                "../common/adjust_lon": 5
            }],
            54: [function(e, t, n) {
                var r = e("../common/adjust_lon"),
                    i = 1e-10;
                n.init = function() {}, n.forward = function(e) {
                    var t = e.x,
                        n = e.y,
                        s = r(t - this.long0),
                        o = n,
                        u = Math.PI * Math.sin(n);
                    for (var a = 0; !0; a++) {
                        var f = -(o + Math.sin(o) - u) / (1 + Math.cos(o));
                        o += f;
                        if (Math.abs(f) < i) break
                    }
                    o /= 2, Math.PI / 2 - Math.abs(n) < i && (s = 0);
                    var l = .900316316158 * this.a * s * Math.cos(o) + this.x0,
                        c = 1.4142135623731 * this.a * Math.sin(o) + this.y0;
                    return e.x = l, e.y = c, e
                }, n.inverse = function(e) {
                    var t, n;
                    e.x -= this.x0, e.y -= this.y0, n = e.y / (1.4142135623731 * this.a), Math.abs(n) > .999999999999 && (n = .999999999999), t = Math.asin(n);
                    var i = r(this.long0 + e.x / (.900316316158 * this.a * Math.cos(t)));
                    i < -Math.PI && (i = -Math.PI), i > Math.PI && (i = Math.PI), n = (2 * t + Math.sin(2 * t)) / Math.PI, Math.abs(n) > 1 && (n = 1);
                    var s = Math.asin(n);
                    return e.x = i, e.y = s, e
                }, n.names = ["Mollweide", "moll"]
            }, {
                "../common/adjust_lon": 5
            }],
            55: [function(e, t, n) {
                var r = 484813681109536e-20;
                n.iterations = 1, n.init = function() {
                    this.A = [], this.A[1] = .6399175073, this.A[2] = -0.1358797613, this.A[3] = .063294409, this.A[4] = -0.02526853, this.A[5] = .0117879, this.A[6] = -0.0055161, this.A[7] = .0026906, this.A[8] = -0.001333, this.A[9] = 67e-5, this.A[10] = -0.00034, this.B_re = [], this.B_im = [], this.B_re[1] = .7557853228, this.B_im[1] = 0, this.B_re[2] = .249204646, this.B_im[2] = .003371507, this.B_re[3] = -0.001541739, this.B_im[3] = .04105856, this.B_re[4] = -0.10162907, this.B_im[4] = .01727609, this.B_re[5] = -0.26623489, this.B_im[5] = -0.36249218, this.B_re[6] = -0.6870983, this.B_im[6] = -1.1651967, this.C_re = [], this.C_im = [], this.C_re[1] = 1.3231270439, this.C_im[1] = 0, this.C_re[2] = -0.577245789, this.C_im[2] = -0.007809598, this.C_re[3] = .508307513, this.C_im[3] = -0.112208952, this.C_re[4] = -0.15094762, this.C_im[4] = .18200602, this.C_re[5] = 1.01418179, this.C_im[5] = 1.64497696, this.C_re[6] = 1.9660549, this.C_im[6] = 2.5127645, this.D = [], this.D[1] = 1.5627014243, this.D[2] = .5185406398, this.D[3] = -0.03333098, this.D[4] = -0.1052906, this.D[5] = -0.0368594, this.D[6] = .007317, this.D[7] = .0122, this.D[8] = .00394, this.D[9] = -0.0013
                }, n.forward = function(e) {
                    var t, n = e.x,
                        i = e.y,
                        s = i - this.lat0,
                        o = n - this.long0,
                        u = s / r * 1e-5,
                        a = o,
                        f = 1,
                        l = 0;
                    for (t = 1; t <= 10; t++) f *= u, l += this.A[t] * f;
                    var c = l,
                        h = a,
                        p = 1,
                        d = 0,
                        v, m, g = 0,
                        y = 0;
                    for (t = 1; t <= 6; t++) v = p * c - d * h, m = d * c + p * h, p = v, d = m, g = g + this.B_re[t] * p - this.B_im[t] * d, y = y + this.B_im[t] * p + this.B_re[t] * d;
                    return e.x = y * this.a + this.x0, e.y = g * this.a + this.y0, e
                }, n.inverse = function(e) {
                    var t, n = e.x,
                        i = e.y,
                        s = n - this.x0,
                        o = i - this.y0,
                        u = o / this.a,
                        a = s / this.a,
                        f = 1,
                        l = 0,
                        c, h, p = 0,
                        d = 0;
                    for (t = 1; t <= 6; t++) c = f * u - l * a, h = l * u + f * a, f = c, l = h, p = p + this.C_re[t] * f - this.C_im[t] * l, d = d + this.C_im[t] * f + this.C_re[t] * l;
                    for (var v = 0; v < this.iterations; v++) {
                        var m = p,
                            g = d,
                            y, b, w = u,
                            E = a;
                        for (t = 2; t <= 6; t++) y = m * p - g * d, b = g * p + m * d, m = y, g = b, w += (t - 1) * (this.B_re[t] * m - this.B_im[t] * g), E += (t - 1) * (this.B_im[t] * m + this.B_re[t] * g);
                        m = 1, g = 0;
                        var S = this.B_re[1],
                            x = this.B_im[1];
                        for (t = 2; t <= 6; t++) y = m * p - g * d, b = g * p + m * d, m = y, g = b, S += t * (this.B_re[t] * m - this.B_im[t] * g), x += t * (this.B_im[t] * m + this.B_re[t] * g);
                        var T = S * S + x * x;
                        p = (w * S + E * x) / T, d = (E * S - w * x) / T
                    }
                    var N = p,
                        C = d,
                        k = 1,
                        L = 0;
                    for (t = 1; t <= 9; t++) k *= N, L += this.D[t] * k;
                    var A = this.lat0 + L * r * 1e5,
                        O = this.long0 + C;
                    return e.x = O, e.y = A, e
                }, n.names = ["New_Zealand_Map_Grid", "nzmg"]
            }, {}],
            56: [function(e, t, n) {
                var r = e("../common/tsfnz"),
                    i = e("../common/adjust_lon"),
                    s = e("../common/phi2z"),
                    o = Math.PI / 2,
                    u = Math.PI / 4,
                    a = 1e-10;
                n.init = function() {
                    this.no_off = this.no_off || !1, this.no_rot = this.no_rot || !1, isNaN(this.k0) && (this.k0 = 1);
                    var e = Math.sin(this.lat0),
                        t = Math.cos(this.lat0),
                        n = this.e * e;
                    this.bl = Math.sqrt(1 + this.es / (1 - this.es) * Math.pow(t, 4)), this.al = this.a * this.bl * this.k0 * Math.sqrt(1 - this.es) / (1 - n * n);
                    var s = r(this.e, this.lat0, e),
                        o = this.bl / t * Math.sqrt((1 - this.es) / (1 - n * n));
                    o * o < 1 && (o = 1);
                    var u, a;
                    if (!isNaN(this.longc)) this.lat0 >= 0 ? u = o + Math.sqrt(o * o - 1) : u = o - Math.sqrt(o * o - 1), this.el = u * Math.pow(s, this.bl), a = .5 * (u - 1 / u), this.gamma0 = Math.asin(Math.sin(this.alpha) / o), this.long0 = this.longc - Math.asin(a * Math.tan(this.gamma0)) / this.bl;
                    else {
                        var f = r(this.e, this.lat1, Math.sin(this.lat1)),
                            l = r(this.e, this.lat2, Math.sin(this.lat2));
                        this.lat0 >= 0 ? this.el = (o + Math.sqrt(o * o - 1)) * Math.pow(s, this.bl) : this.el = (o - Math.sqrt(o * o - 1)) * Math.pow(s, this.bl);
                        var c = Math.pow(f, this.bl),
                            h = Math.pow(l, this.bl);
                        u = this.el / c, a = .5 * (u - 1 / u);
                        var p = (this.el * this.el - h * c) / (this.el * this.el + h * c),
                            d = (h - c) / (h + c),
                            v = i(this.long1 - this.long2);
                        this.long0 = .5 * (this.long1 + this.long2) - Math.atan(p * Math.tan(.5 * this.bl * v) / d) / this.bl, this.long0 = i(this.long0);
                        var m = i(this.long1 - this.long0);
                        this.gamma0 = Math.atan(Math.sin(this.bl * m) / a), this.alpha = Math.asin(o * Math.sin(this.gamma0))
                    }
                    this.no_off ? this.uc = 0 : this.lat0 >= 0 ? this.uc = this.al / this.bl * Math.atan2(Math.sqrt(o * o - 1), Math.cos(this.alpha)) : this.uc = -1 * this.al / this.bl * Math.atan2(Math.sqrt(o * o - 1), Math.cos(this.alpha))
                }, n.forward = function(e) {
                    var t = e.x,
                        n = e.y,
                        s = i(t - this.long0),
                        f, l, c;
                    if (Math.abs(Math.abs(n) - o) <= a) n > 0 ? c = -1 : c = 1, l = this.al / this.bl * Math.log(Math.tan(u + c * this.gamma0 * .5)), f = -1 * c * o * this.al / this.bl;
                    else {
                        var h = r(this.e, n, Math.sin(n)),
                            p = this.el / Math.pow(h, this.bl),
                            d = .5 * (p - 1 / p),
                            v = .5 * (p + 1 / p),
                            m = Math.sin(this.bl * s),
                            g = (d * Math.sin(this.gamma0) - m * Math.cos(this.gamma0)) / v;
                        Math.abs(Math.abs(g) - 1) <= a ? l = Number.POSITIVE_INFINITY : l = .5 * this.al * Math.log((1 - g) / (1 + g)) / this.bl, Math.abs(Math.cos(this.bl * s)) <= a ? f = this.al * this.bl * s : f = this.al * Math.atan2(d * Math.cos(this.gamma0) + m * Math.sin(this.gamma0), Math.cos(this.bl * s)) / this.bl
                    }
                    return this.no_rot ? (e.x = this.x0 + f, e.y = this.y0 + l) : (f -= this.uc, e.x = this.x0 + l * Math.cos(this.alpha) + f * Math.sin(this.alpha), e.y = this.y0 + f * Math.cos(this.alpha) - l * Math.sin(this.alpha)), e
                }, n.inverse = function(e) {
                    var t, n;
                    this.no_rot ? (n = e.y - this.y0, t = e.x - this.x0) : (n = (e.x - this.x0) * Math.cos(this.alpha) - (e.y - this.y0) * Math.sin(this.alpha), t = (e.y - this.y0) * Math.cos(this.alpha) + (e.x - this.x0) * Math.sin(this.alpha), t += this.uc);
                    var r = Math.exp(-1 * this.bl * n / this.al),
                        u = .5 * (r - 1 / r),
                        f = .5 * (r + 1 / r),
                        l = Math.sin(this.bl * t / this.al),
                        c = (l * Math.cos(this.gamma0) + u * Math.sin(this.gamma0)) / f,
                        h = Math.pow(this.el / Math.sqrt((1 + c) / (1 - c)), 1 / this.bl);
                    return Math.abs(c - 1) < a ? (e.x = this.long0, e.y = o) : Math.abs(c + 1) < a ? (e.x = this.long0, e.y = -1 * o) : (e.y = s(this.e, h), e.x = i(this.long0 - Math.atan2(u * Math.cos(this.gamma0) - l * Math.sin(this.gamma0), Math.cos(this.bl * t / this.al)) / this.bl)), e
                }, n.names = ["Hotine_Oblique_Mercator", "Hotine Oblique Mercator", "Hotine_Oblique_Mercator_Azimuth_Natural_Origin", "Hotine_Oblique_Mercator_Azimuth_Center", "omerc"]
            }, {
                "../common/adjust_lon": 5,
                "../common/phi2z": 16,
                "../common/tsfnz": 24
            }],
            57: [function(e, t, n) {
                var r = e("../common/e0fn"),
                    i = e("../common/e1fn"),
                    s = e("../common/e2fn"),
                    o = e("../common/e3fn"),
                    u = e("../common/adjust_lon"),
                    a = e("../common/adjust_lat"),
                    f = e("../common/mlfn"),
                    l = 1e-10,
                    c = e("../common/gN"),
                    h = 20;
                n.init = function() {
                    this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e = Math.sqrt(this.es), this.e0 = r(this.es), this.e1 = i(this.es), this.e2 = s(this.es), this.e3 = o(this.es), this.ml0 = this.a * f(this.e0, this.e1, this.e2, this.e3, this.lat0)
                }, n.forward = function(e) {
                    var t = e.x,
                        n = e.y,
                        r, i, s, o = u(t - this.long0);
                    s = o * Math.sin(n);
                    if (this.sphere) Math.abs(n) <= l ? (r = this.a * o, i = -1 * this.a * this.lat0) : (r = this.a * Math.sin(s) / Math.tan(n), i = this.a * (a(n - this.lat0) + (1 - Math.cos(s)) / Math.tan(n)));
                    else if (Math.abs(n) <= l) r = this.a * o, i = -1 * this.ml0;
                    else {
                        var h = c(this.a, this.e, Math.sin(n)) / Math.tan(n);
                        r = h * Math.sin(s), i = this.a * f(this.e0, this.e1, this.e2, this.e3, n) - this.ml0 + h * (1 - Math.cos(s))
                    }
                    return e.x = r + this.x0, e.y = i + this.y0, e
                }, n.inverse = function(e) {
                    var t, n, r, i, s, o, a, c, p;
                    r = e.x - this.x0, i = e.y - this.y0;
                    if (this.sphere)
                        if (Math.abs(i + this.a * this.lat0) <= l) t = u(r / this.a + this.long0), n = 0;
                        else {
                            o = this.lat0 + i / this.a, a = r * r / this.a / this.a + o * o, c = o;
                            var d;
                            for (s = h; s; --s) {
                                d = Math.tan(c), p = -1 * (o * (c * d + 1) - c - .5 * (c * c + a) * d) / ((c - o) / d - 1), c += p;
                                if (Math.abs(p) <= l) {
                                    n = c;
                                    break
                                }
                            }
                            t = u(this.long0 + Math.asin(r * Math.tan(c) / this.a) / Math.sin(n))
                        } else if (Math.abs(i + this.ml0) <= l) n = 0, t = u(this.long0 + r / this.a);
                    else {
                        o = (this.ml0 + i) / this.a, a = r * r / this.a / this.a + o * o, c = o;
                        var v, m, g, y, b;
                        for (s = h; s; --s) {
                            b = this.e * Math.sin(c), v = Math.sqrt(1 - b * b) * Math.tan(c), m = this.a * f(this.e0, this.e1, this.e2, this.e3, c), g = this.e0 - 2 * this.e1 * Math.cos(2 * c) + 4 * this.e2 * Math.cos(4 * c) - 6 * this.e3 * Math.cos(6 * c), y = m / this.a, p = (o * (v * y + 1) - y - .5 * v * (y * y + a)) / (this.es * Math.sin(2 * c) * (y * y + a - 2 * o * y) / (4 * v) + (o - y) * (v * g - 2 / Math.sin(2 * c)) - g), c -= p;
                            if (Math.abs(p) <= l) {
                                n = c;
                                break
                            }
                        }
                        v = Math.sqrt(1 - this.es * Math.pow(Math.sin(n), 2)) * Math.tan(n), t = u(this.long0 + Math.asin(r * v / this.a) / Math.sin(n))
                    }
                    return e.x = t, e.y = n, e
                }, n.names = ["Polyconic", "poly"]
            }, {
                "../common/adjust_lat": 4,
                "../common/adjust_lon": 5,
                "../common/e0fn": 7,
                "../common/e1fn": 8,
                "../common/e2fn": 9,
                "../common/e3fn": 10,
                "../common/gN": 11,
                "../common/mlfn": 14
            }],
            58: [function(e, t, n) {
                var r = e("../common/adjust_lon"),
                    i = e("../common/adjust_lat"),
                    s = e("../common/pj_enfn"),
                    o = 20,
                    u = e("../common/pj_mlfn"),
                    a = e("../common/pj_inv_mlfn"),
                    f = Math.PI / 2,
                    l = 1e-10,
                    c = e("../common/asinz");
                n.init = function() {
                    this.sphere ? (this.n = 1, this.m = 0, this.es = 0, this.C_y = Math.sqrt((this.m + 1) / this.n), this.C_x = this.C_y / (this.m + 1)) : this.en = s(this.es)
                }, n.forward = function(e) {
                    var t, n, i = e.x,
                        s = e.y;
                    i = r(i - this.long0);
                    if (this.sphere) {
                        if (!this.m) s = this.n !== 1 ? Math.asin(this.n * Math.sin(s)) : s;
                        else {
                            var a = this.n * Math.sin(s);
                            for (var f = o; f; --f) {
                                var c = (this.m * s + Math.sin(s) - a) / (this.m + Math.cos(s));
                                s -= c;
                                if (Math.abs(c) < l) break
                            }
                        }
                        t = this.a * this.C_x * i * (this.m + Math.cos(s)), n = this.a * this.C_y * s
                    } else {
                        var h = Math.sin(s),
                            p = Math.cos(s);
                        n = this.a * u(s, h, p, this.en), t = this.a * i * p / Math.sqrt(1 - this.es * h * h)
                    }
                    return e.x = t, e.y = n, e
                }, n.inverse = function(e) {
                    var t, n, s, o;
                    return e.x -= this.x0, s = e.x / this.a, e.y -= this.y0, t = e.y / this.a, this.sphere ? (t /= this.C_y, s /= this.C_x * (this.m + Math.cos(t)), this.m ? t = c((this.m * t + Math.sin(t)) / this.n) : this.n !== 1 && (t = c(Math.sin(t) / this.n)), s = r(s + this.long0), t = i(t)) : (t = a(e.y / this.a, this.es, this.en), o = Math.abs(t), o < f ? (o = Math.sin(t), n = this.long0 + e.x * Math.sqrt(1 - this.es * o * o) / (this.a * Math.cos(t)), s = r(n)) : o - l < f && (s = this.long0)), e.x = s, e.y = t, e
                }, n.names = ["Sinusoidal", "sinu"]
            }, {
                "../common/adjust_lat": 4,
                "../common/adjust_lon": 5,
                "../common/asinz": 6,
                "../common/pj_enfn": 17,
                "../common/pj_inv_mlfn": 18,
                "../common/pj_mlfn": 19
            }],
            59: [function(e, t, n) {
                n.init = function() {
                    var e = this.lat0;
                    this.lambda0 = this.long0;
                    var t = Math.sin(e),
                        n = this.a,
                        r = this.rf,
                        i = 1 / r,
                        s = 2 * i - Math.pow(i, 2),
                        o = this.e = Math.sqrt(s);
                    this.R = this.k0 * n * Math.sqrt(1 - s) / (1 - s * Math.pow(t, 2)), this.alpha = Math.sqrt(1 + s / (1 - s) * Math.pow(Math.cos(e), 4)), this.b0 = Math.asin(t / this.alpha);
                    var u = Math.log(Math.tan(Math.PI / 4 + this.b0 / 2)),
                        a = Math.log(Math.tan(Math.PI / 4 + e / 2)),
                        f = Math.log((1 + o * t) / (1 - o * t));
                    this.K = u - this.alpha * a + this.alpha * o / 2 * f
                }, n.forward = function(e) {
                    var t = Math.log(Math.tan(Math.PI / 4 - e.y / 2)),
                        n = this.e / 2 * Math.log((1 + this.e * Math.sin(e.y)) / (1 - this.e * Math.sin(e.y))),
                        r = -this.alpha * (t + n) + this.K,
                        i = 2 * (Math.atan(Math.exp(r)) - Math.PI / 4),
                        s = this.alpha * (e.x - this.lambda0),
                        o = Math.atan(Math.sin(s) / (Math.sin(this.b0) * Math.tan(i) + Math.cos(this.b0) * Math.cos(s))),
                        u = Math.asin(Math.cos(this.b0) * Math.sin(i) - Math.sin(this.b0) * Math.cos(i) * Math.cos(s));
                    return e.y = this.R / 2 * Math.log((1 + Math.sin(u)) / (1 - Math.sin(u))) + this.y0, e.x = this.R * o + this.x0, e
                }, n.inverse = function(e) {
                    var t = e.x - this.x0,
                        n = e.y - this.y0,
                        r = t / this.R,
                        i = 2 * (Math.atan(Math.exp(n / this.R)) - Math.PI / 4),
                        s = Math.asin(Math.cos(this.b0) * Math.sin(i) + Math.sin(this.b0) * Math.cos(i) * Math.cos(r)),
                        o = Math.atan(Math.sin(r) / (Math.cos(this.b0) * Math.cos(r) - Math.sin(this.b0) * Math.tan(i))),
                        u = this.lambda0 + o / this.alpha,
                        a = 0,
                        f = s,
                        l = -1e3,
                        c = 0;
                    while (Math.abs(f - l) > 1e-7) {
                        if (++c > 20) return;
                        a = 1 / this.alpha * (Math.log(Math.tan(Math.PI / 4 + s / 2)) - this.K) + this.e * Math.log(Math.tan(Math.PI / 4 + Math.asin(this.e * Math.sin(f)) / 2)), l = f, f = 2 * Math.atan(Math.exp(a)) - Math.PI / 2
                    }
                    return e.x = u, e.y = f, e
                }, n.names = ["somerc"]
            }, {}],
            60: [function(e, t, n) {
                var r = Math.PI / 2,
                    i = 1e-10,
                    s = e("../common/sign"),
                    o = e("../common/msfnz"),
                    u = e("../common/tsfnz"),
                    a = e("../common/phi2z"),
                    f = e("../common/adjust_lon");
                n.ssfn_ = function(e, t, n) {
                    return t *= n, Math.tan(.5 * (r + e)) * Math.pow((1 - t) / (1 + t), .5 * n)
                }, n.init = function() {
                    this.coslat0 = Math.cos(this.lat0), this.sinlat0 = Math.sin(this.lat0), this.sphere ? this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= i && (this.k0 = .5 * (1 + s(this.lat0) * Math.sin(this.lat_ts))) : (Math.abs(this.coslat0) <= i && (this.lat0 > 0 ? this.con = 1 : this.con = -1), this.cons = Math.sqrt(Math.pow(1 + this.e, 1 + this.e) * Math.pow(1 - this.e, 1 - this.e)), this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= i && (this.k0 = .5 * this.cons * o(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) / u(this.e, this.con * this.lat_ts, this.con * Math.sin(this.lat_ts))), this.ms1 = o(this.e, this.sinlat0, this.coslat0), this.X0 = 2 * Math.atan(this.ssfn_(this.lat0, this.sinlat0, this.e)) - r, this.cosX0 = Math.cos(this.X0), this.sinX0 = Math.sin(this.X0))
                }, n.forward = function(e) {
                    var t = e.x,
                        n = e.y,
                        s = Math.sin(n),
                        o = Math.cos(n),
                        a, l, c, h, p, d, v = f(t - this.long0);
                    return Math.abs(Math.abs(t - this.long0) - Math.PI) <= i && Math.abs(n + this.lat0) <= i ? (e.x = NaN, e.y = NaN, e) : this.sphere ? (a = 2 * this.k0 / (1 + this.sinlat0 * s + this.coslat0 * o * Math.cos(v)), e.x = this.a * a * o * Math.sin(v) + this.x0, e.y = this.a * a * (this.coslat0 * s - this.sinlat0 * o * Math.cos(v)) + this.y0, e) : (l = 2 * Math.atan(this.ssfn_(n, s, this.e)) - r, h = Math.cos(l), c = Math.sin(l), Math.abs(this.coslat0) <= i ? (p = u(this.e, n * this.con, this.con * s), d = 2 * this.a * this.k0 * p / this.cons, e.x = this.x0 + d * Math.sin(t - this.long0), e.y = this.y0 - this.con * d * Math.cos(t - this.long0), e) : (Math.abs(this.sinlat0) < i ? (a = 2 * this.a * this.k0 / (1 + h * Math.cos(v)), e.y = a * c) : (a = 2 * this.a * this.k0 * this.ms1 / (this.cosX0 * (1 + this.sinX0 * c + this.cosX0 * h * Math.cos(v))), e.y = a * (this.cosX0 * c - this.sinX0 * h * Math.cos(v)) + this.y0), e.x = a * h * Math.sin(v) + this.x0, e))
                }, n.inverse = function(e) {
                    e.x -= this.x0, e.y -= this.y0;
                    var t, n, s, o, u, l = Math.sqrt(e.x * e.x + e.y * e.y);
                    if (this.sphere) {
                        var c = 2 * Math.atan(l / (.5 * this.a * this.k0));
                        return t = this.long0, n = this.lat0, l <= i ? (e.x = t, e.y = n, e) : (n = Math.asin(Math.cos(c) * this.sinlat0 + e.y * Math.sin(c) * this.coslat0 / l), Math.abs(this.coslat0) < i ? this.lat0 > 0 ? t = f(this.long0 + Math.atan2(e.x, -1 * e.y)) : t = f(this.long0 + Math.atan2(e.x, e.y)) : t = f(this.long0 + Math.atan2(e.x * Math.sin(c), l * this.coslat0 * Math.cos(c) - e.y * this.sinlat0 * Math.sin(c))), e.x = t, e.y = n, e)
                    }
                    if (Math.abs(this.coslat0) <= i) {
                        if (l <= i) return n = this.lat0, t = this.long0, e.x = t, e.y = n, e;
                        e.x *= this.con, e.y *= this.con, s = l * this.cons / (2 * this.a * this.k0), n = this.con * a(this.e, s), t = this.con * f(this.con * this.long0 + Math.atan2(e.x, -1 * e.y))
                    } else o = 2 * Math.atan(l * this.cosX0 / (2 * this.a * this.k0 * this.ms1)), t = this.long0, l <= i ? u = this.X0 : (u = Math.asin(Math.cos(o) * this.sinX0 + e.y * Math.sin(o) * this.cosX0 / l), t = f(this.long0 + Math.atan2(e.x * Math.sin(o), l * this.cosX0 * Math.cos(o) - e.y * this.sinX0 * Math.sin(o)))), n = -1 * a(this.e, Math.tan(.5 * (r + u)));
                    return e.x = t, e.y = n, e
                }, n.names = ["stere", "Stereographic_South_Pole", "Polar Stereographic (variant B)"]
            }, {
                "../common/adjust_lon": 5,
                "../common/msfnz": 15,
                "../common/phi2z": 16,
                "../common/sign": 21,
                "../common/tsfnz": 24
            }],
            61: [function(e, t, n) {
                var r = e("./gauss"),
                    i = e("../common/adjust_lon");
                n.init = function() {
                    r.init.apply(this);
                    if (!this.rc) return;
                    this.sinc0 = Math.sin(this.phic0), this.cosc0 = Math.cos(this.phic0), this.R2 = 2 * this.rc, this.title || (this.title = "Oblique Stereographic Alternative")
                }, n.forward = function(e) {
                    var t, n, s, o;
                    return e.x = i(e.x - this.long0), r.forward.apply(this, [e]), t = Math.sin(e.y), n = Math.cos(e.y), s = Math.cos(e.x), o = this.k0 * this.R2 / (1 + this.sinc0 * t + this.cosc0 * n * s), e.x = o * n * Math.sin(e.x), e.y = o * (this.cosc0 * t - this.sinc0 * n * s), e.x = this.a * e.x + this.x0, e.y = this.a * e.y + this.y0, e
                }, n.inverse = function(e) {
                    var t, n, s, o, u;
                    e.x = (e.x - this.x0) / this.a, e.y = (e.y - this.y0) / this.a, e.x /= this.k0, e.y /= this.k0;
                    if (u = Math.sqrt(e.x * e.x + e.y * e.y)) {
                        var a = 2 * Math.atan2(u, this.R2);
                        t = Math.sin(a), n = Math.cos(a), o = Math.asin(n * this.sinc0 + e.y * t * this.cosc0 / u), s = Math.atan2(e.x * t, u * this.cosc0 * n - e.y * this.sinc0 * t)
                    } else o = this.phic0, s = 0;
                    return e.x = s, e.y = o, r.inverse.apply(this, [e]), e.x = i(e.x + this.long0), e
                }, n.names = ["Stereographic_North_Pole", "Oblique_Stereographic", "Polar_Stereographic", "sterea", "Oblique Stereographic Alternative"]
            }, {
                "../common/adjust_lon": 5,
                "./gauss": 46
            }],
            62: [function(e, t, n) {
                var r = e("../common/e0fn"),
                    i = e("../common/e1fn"),
                    s = e("../common/e2fn"),
                    o = e("../common/e3fn"),
                    u = e("../common/mlfn"),
                    a = e("../common/adjust_lon"),
                    f = Math.PI / 2,
                    l = 1e-10,
                    c = e("../common/sign"),
                    h = e("../common/asinz");
                n.init = function() {
                    this.e0 = r(this.es), this.e1 = i(this.es), this.e2 = s(this.es), this.e3 = o(this.es), this.ml0 = this.a * u(this.e0, this.e1, this.e2, this.e3, this.lat0)
                }, n.forward = function(e) {
                    var t = e.x,
                        n = e.y,
                        r = a(t - this.long0),
                        i, s, o, f = Math.sin(n),
                        l = Math.cos(n);
                    if (this.sphere) {
                        var c = l * Math.sin(r);
                        if (Math.abs(Math.abs(c) - 1) < 1e-10) return 93;
                        s = .5 * this.a * this.k0 * Math.log((1 + c) / (1 - c)), i = Math.acos(l * Math.cos(r) / Math.sqrt(1 - c * c)), n < 0 && (i = -i), o = this.a * this.k0 * (i - this.lat0)
                    } else {
                        var h = l * r,
                            p = Math.pow(h, 2),
                            d = this.ep2 * Math.pow(l, 2),
                            v = Math.tan(n),
                            m = Math.pow(v, 2);
                        i = 1 - this.es * Math.pow(f, 2);
                        var g = this.a / Math.sqrt(i),
                            y = this.a * u(this.e0, this.e1, this.e2, this.e3, n);
                        s = this.k0 * g * h * (1 + p / 6 * (1 - m + d + p / 20 * (5 - 18 * m + Math.pow(m, 2) + 72 * d - 58 * this.ep2))) + this.x0, o = this.k0 * (y - this.ml0 + g * v * p * (.5 + p / 24 * (5 - m + 9 * d + 4 * Math.pow(d, 2) + p / 30 * (61 - 58 * m + Math.pow(m, 2) + 600 * d - 330 * this.ep2)))) + this.y0
                    }
                    return e.x = s, e.y = o, e
                }, n.inverse = function(e) {
                    var t, n, r, i, s = 6,
                        o, u;
                    if (this.sphere) {
                        var p = Math.exp(e.x / (this.a * this.k0)),
                            d = .5 * (p - 1 / p),
                            v = this.lat0 + e.y / (this.a * this.k0),
                            m = Math.cos(v);
                        t = Math.sqrt((1 - m * m) / (1 + d * d)), o = h(t), v < 0 && (o = -o), d === 0 && m === 0 ? u = this.long0 : u = a(Math.atan2(d, m) + this.long0)
                    } else {
                        var g = e.x - this.x0,
                            y = e.y - this.y0;
                        t = (this.ml0 + y / this.k0) / this.a, n = t;
                        for (i = 0; !0; i++) {
                            r = (t + this.e1 * Math.sin(2 * n) - this.e2 * Math.sin(4 * n) + this.e3 * Math.sin(6 * n)) / this.e0 - n, n += r;
                            if (Math.abs(r) <= l) break;
                            if (i >= s) return 95
                        }
                        if (Math.abs(n) < f) {
                            var b = Math.sin(n),
                                w = Math.cos(n),
                                E = Math.tan(n),
                                S = this.ep2 * Math.pow(w, 2),
                                x = Math.pow(S, 2),
                                T = Math.pow(E, 2),
                                N = Math.pow(T, 2);
                            t = 1 - this.es * Math.pow(b, 2);
                            var C = this.a / Math.sqrt(t),
                                k = C * (1 - this.es) / t,
                                L = g / (C * this.k0),
                                A = Math.pow(L, 2);
                            o = n - C * E * A / k * (.5 - A / 24 * (5 + 3 * T + 10 * S - 4 * x - 9 * this.ep2 - A / 30 * (61 + 90 * T + 298 * S + 45 * N - 252 * this.ep2 - 3 * x))), u = a(this.long0 + L * (1 - A / 6 * (1 + 2 * T + S - A / 20 * (5 - 2 * S + 28 * T - 3 * x + 8 * this.ep2 + 24 * N))) / w)
                        } else o = f * c(y), u = this.long0
                    }
                    return e.x = u, e.y = o, e
                }, n.names = ["Transverse_Mercator", "Transverse Mercator", "tmerc"]
            }, {
                "../common/adjust_lon": 5,
                "../common/asinz": 6,
                "../common/e0fn": 7,
                "../common/e1fn": 8,
                "../common/e2fn": 9,
                "../common/e3fn": 10,
                "../common/mlfn": 14,
                "../common/sign": 21
            }],
            63: [function(e, t, n) {
                var r = .017453292519943295,
                    i = e("./tmerc");
                n.dependsOn = "tmerc", n.init = function() {
                    if (!this.zone) return;
                    this.lat0 = 0, this.long0 = (6 * Math.abs(this.zone) - 183) * r, this.x0 = 5e5, this.y0 = this.utmSouth ? 1e7 : 0, this.k0 = .9996, i.init.apply(this), this.forward = i.forward, this.inverse = i.inverse
                }, n.names = ["Universal Transverse Mercator System", "utm"]
            }, {
                "./tmerc": 62
            }],
            64: [function(e, t, n) {
                var r = e("../common/adjust_lon"),
                    i = Math.PI / 2,
                    s = 1e-10,
                    o = e("../common/asinz");
                n.init = function() {
                    this.R = this.a
                }, n.forward = function(e) {
                    var t = e.x,
                        n = e.y,
                        u = r(t - this.long0),
                        a, f;
                    Math.abs(n) <= s && (a = this.x0 + this.R * u, f = this.y0);
                    var l = o(2 * Math.abs(n / Math.PI));
                    if (Math.abs(u) <= s || Math.abs(Math.abs(n) - i) <= s) a = this.x0, n >= 0 ? f = this.y0 + Math.PI * this.R * Math.tan(.5 * l) : f = this.y0 + Math.PI * this.R * -Math.tan(.5 * l);
                    var c = .5 * Math.abs(Math.PI / u - u / Math.PI),
                        h = c * c,
                        p = Math.sin(l),
                        d = Math.cos(l),
                        v = d / (p + d - 1),
                        m = v * v,
                        g = v * (2 / p - 1),
                        y = g * g,
                        b = Math.PI * this.R * (c * (v - y) + Math.sqrt(h * (v - y) * (v - y) - (y + h) * (m - y))) / (y + h);
                    u < 0 && (b = -b), a = this.x0 + b;
                    var w = h + v;
                    return b = Math.PI * this.R * (g * w - c * Math.sqrt((y + h) * (h + 1) - w * w)) / (y + h), n >= 0 ? f = this.y0 + b : f = this.y0 - b, e.x = a, e.y = f, e
                }, n.inverse = function(e) {
                    var t, n, i, o, u, a, f, l, c, h, p, d, v;
                    return e.x -= this.x0, e.y -= this.y0, p = Math.PI * this.R, i = e.x / p, o = e.y / p, u = i * i + o * o, a = -Math.abs(o) * (1 + u), f = a - 2 * o * o + i * i, l = -2 * a + 1 + 2 * o * o + u * u, v = o * o / l + (2 * f * f * f / l / l / l - 9 * a * f / l / l) / 27, c = (a - f * f / 3 / l) / l, h = 2 * Math.sqrt(-c / 3), p = 3 * v / c / h, Math.abs(p) > 1 && (p >= 0 ? p = 1 : p = -1), d = Math.acos(p) / 3, e.y >= 0 ? n = (-h * Math.cos(d + Math.PI / 3) - f / 3 / l) * Math.PI : n = -(-h * Math.cos(d + Math.PI / 3) - f / 3 / l) * Math.PI, Math.abs(i) < s ? t = this.long0 : t = r(this.long0 + Math.PI * (u - 1 + Math.sqrt(1 + 2 * (i * i - o * o) + u * u)) / 2 / i), e.x = t, e.y = n, e
                }, n.names = ["Van_der_Grinten_I", "VanDerGrinten", "vandg"]
            }, {
                "../common/adjust_lon": 5,
                "../common/asinz": 6
            }],
            65: [function(e, t, n) {
                var r = .017453292519943295,
                    i = 57.29577951308232,
                    s = 1,
                    o = 2,
                    u = e("./datum_transform"),
                    a = e("./adjust_axis"),
                    f = e("./Proj"),
                    l = e("./common/toPoint");
                t.exports = function c(e, t, n) {
                    function p(e, t) {
                        return (e.datum.datum_type === s || e.datum.datum_type === o) && t.datumCode !== "WGS84"
                    }
                    var h;
                    return Array.isArray(n) && (n = l(n)), e.datum && t.datum && (p(e, t) || p(t, e)) && (h = new f("WGS84"), c(e, h, n), e = h), e.axis !== "enu" && a(e, !1, n), e.projName === "longlat" ? (n.x *= r, n.y *= r) : (e.to_meter && (n.x *= e.to_meter, n.y *= e.to_meter), e.inverse(n)), e.from_greenwich && (n.x += e.from_greenwich), n = u(e.datum, t.datum, n), t.from_greenwich && (n.x -= t.from_greenwich), t.projName === "longlat" ? (n.x *= i, n.y *= i) : (t.forward(n), t.to_meter && (n.x /= t.to_meter, n.y /= t.to_meter)), t.axis !== "enu" && a(t, !0, n), n
                }
            }, {
                "./Proj": 2,
                "./adjust_axis": 3,
                "./common/toPoint": 23,
                "./datum_transform": 31
            }],
            66: [function(e, t, n) {
                function s(e, t, n) {
                    e[t] = n.map(function(e) {
                        var t = {};
                        return o(e, t), t
                    }).reduce(function(e, t) {
                        return i(e, t)
                    }, {})
                }

                function o(e, t) {
                    var n;
                    if (!Array.isArray(e)) {
                        t[e] = !0;
                        return
                    }
                    n = e.shift(), n === "PARAMETER" && (n = e.shift()), e.length === 1 ? Array.isArray(e[0]) ? (t[n] = {}, o(e[0], t[n])) : t[n] = e[0] : e.length ? n === "TOWGS84" ? t[n] = e : (t[n] = {}, ["UNIT", "PRIMEM", "VERT_DATUM"].indexOf(n) > -1 ? (t[n] = {
                        name: e[0].toLowerCase(),
                        convert: e[1]
                    }, e.length === 3 && (t[n].auth = e[2])) : n === "SPHEROID" ? (t[n] = {
                        name: e[0],
                        a: e[1],
                        rf: e[2]
                    }, e.length === 4 && (t[n].auth = e[3])) : ["GEOGCS", "GEOCCS", "DATUM", "VERT_CS", "COMPD_CS", "LOCAL_CS", "FITTED_CS", "LOCAL_DATUM"].indexOf(n) > -1 ? (e[0] = ["name", e[0]], s(t, n, e)) : e.every(function(e) {
                        return Array.isArray(e)
                    }) ? s(t, n, e) : o(e, t[n])) : t[n] = !0
                }

                function u(e, t) {
                    var n = t[0],
                        r = t[1];
                    !(n in e) && r in e && (e[n] = e[r], t.length === 3 && (e[n] = t[2](e[n])))
                }

                function a(e) {
                    return e * r
                }

                function f(e) {
                    function t(t) {
                        var n = e.to_meter || 1;
                        return parseFloat(t, 10) * n
                    }
                    e.type === "GEOGCS" ? e.projName = "longlat" : e.type === "LOCAL_CS" ? (e.projName = "identity", e.local = !0) : typeof e.PROJECTION == "object" ? e.projName = Object.keys(e.PROJECTION)[0] : e.projName = e.PROJECTION, e.UNIT && (e.units = e.UNIT.name.toLowerCase(), e.units === "metre" && (e.units = "meter"), e.UNIT.convert && (e.type === "GEOGCS" ? e.DATUM && e.DATUM.SPHEROID && (e.to_meter = parseFloat(e.UNIT.convert, 10) * e.DATUM.SPHEROID.a) : e.to_meter = parseFloat(e.UNIT.convert, 10)));
                    if (e.GEOGCS) {
                        e.GEOGCS.DATUM ? e.datumCode = e.GEOGCS.DATUM.name.toLowerCase() : e.datumCode = e.GEOGCS.name.toLowerCase(), e.datumCode.slice(0, 2) === "d_" && (e.datumCode = e.datumCode.slice(2));
                        if (e.datumCode === "new_zealand_geodetic_datum_1949" || e.datumCode === "new_zealand_1949") e.datumCode = "nzgd49";
                        e.datumCode === "wgs_1984" && (e.PROJECTION === "Mercator_Auxiliary_Sphere" && (e.sphere = !0), e.datumCode = "wgs84"), e.datumCode.slice(-6) === "_ferro" && (e.datumCode = e.datumCode.slice(0, -6)), e.datumCode.slice(-8) === "_jakarta" && (e.datumCode = e.datumCode.slice(0, -8)), ~e.datumCode.indexOf("belge") && (e.datumCode = "rnb72"), e.GEOGCS.DATUM && e.GEOGCS.DATUM.SPHEROID && (e.ellps = e.GEOGCS.DATUM.SPHEROID.name.replace("_19", "").replace(/[Cc]larke\_18/, "clrk"), e.ellps.toLowerCase().slice(0, 13) === "international" && (e.ellps = "intl"), e.a = e.GEOGCS.DATUM.SPHEROID.a, e.rf = parseFloat(e.GEOGCS.DATUM.SPHEROID.rf, 10)), ~e.datumCode.indexOf("osgb_1936") && (e.datumCode = "osgb36")
                    }
                    e.b && !isFinite(e.b) && (e.b = e.a);
                    var n = function(t) {
                            return u(e, t)
                        },
                        r = [
                            ["standard_parallel_1", "Standard_Parallel_1"],
                            ["standard_parallel_2", "Standard_Parallel_2"],
                            ["false_easting", "False_Easting"],
                            ["false_northing", "False_Northing"],
                            ["central_meridian", "Central_Meridian"],
                            ["latitude_of_origin", "Latitude_Of_Origin"],
                            ["latitude_of_origin", "Central_Parallel"],
                            ["scale_factor", "Scale_Factor"],
                            ["k0", "scale_factor"],
                            ["latitude_of_center", "Latitude_of_center"],
                            ["lat0", "latitude_of_center", a],
                            ["longitude_of_center", "Longitude_Of_Center"],
                            ["longc", "longitude_of_center", a],
                            ["x0", "false_easting", t],
                            ["y0", "false_northing", t],
                            ["long0", "central_meridian", a],
                            ["lat0", "latitude_of_origin", a],
                            ["lat0", "standard_parallel_1", a],
                            ["lat1", "standard_parallel_1", a],
                            ["lat2", "standard_parallel_2", a],
                            ["alpha", "azimuth", a],
                            ["srsCode", "name"]
                        ];
                    r.forEach(n), !e.long0 && e.longc && (e.projName === "Albers_Conic_Equal_Area" || e.projName === "Lambert_Azimuthal_Equal_Area") && (e.long0 = e.longc), !e.lat_ts && e.lat1 && (e.projName === "Stereographic_South_Pole" || e.projName === "Polar Stereographic (variant B)") && (e.lat0 = a(e.lat1 > 0 ? 90 : -90), e.lat_ts = e.lat1)
                }
                var r = .017453292519943295,
                    i = e("./extend");
                t.exports = function(e, t) {
                    var n = JSON.parse(("," + e).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g, ',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g, ',"$1"]').replace(/,\["VERTCS".+/, "")),
                        r = n.shift(),
                        s = n.shift();
                    n.unshift(["name", s]), n.unshift(["type", r]), n.unshift("output");
                    var u = {};
                    return o(n, u), f(u.output), i(t, u.output)
                }
            }, {
                "./extend": 34
            }],
            67: [function(e, t, n) {
                function c(e) {
                    return e * (Math.PI / 180)
                }

                function h(e) {
                    return 180 * (e / Math.PI)
                }

                function p(e) {
                    var t = e.lat,
                        n = e.lon,
                        r = 6378137,
                        i = .00669438,
                        s = .9996,
                        o, u, a, f, l, h, p, d = c(t),
                        m = c(n),
                        g, y;
                    y = Math.floor((n + 180) / 6) + 1, n === 180 && (y = 60), t >= 56 && t < 64 && n >= 3 && n < 12 && (y = 32), t >= 72 && t < 84 && (n >= 0 && n < 9 ? y = 31 : n >= 9 && n < 21 ? y = 33 : n >= 21 && n < 33 ? y = 35 : n >= 33 && n < 42 && (y = 37)), o = (y - 1) * 6 - 180 + 3, g = c(o), u = i / (1 - i), a = r / Math.sqrt(1 - i * Math.sin(d) * Math.sin(d)), f = Math.tan(d) * Math.tan(d), l = u * Math.cos(d) * Math.cos(d), h = Math.cos(d) * (m - g), p = r * ((1 - i / 4 - 3 * i * i / 64 - 5 * i * i * i / 256) * d - (3 * i / 8 + 3 * i * i / 32 + 45 * i * i * i / 1024) * Math.sin(2 * d) + (15 * i * i / 256 + 45 * i * i * i / 1024) * Math.sin(4 * d) - 35 * i * i * i / 3072 * Math.sin(6 * d));
                    var b = s * a * (h + (1 - f + l) * h * h * h / 6 + (5 - 18 * f + f * f + 72 * l - 58 * u) * h * h * h * h * h / 120) + 5e5,
                        w = s * (p + a * Math.tan(d) * (h * h / 2 + (5 - f + 9 * l + 4 * l * l) * h * h * h * h / 24 + (61 - 58 * f + f * f + 600 * l - 330 * u) * h * h * h * h * h * h / 720));
                    return t < 0 && (w += 1e7), {
                        northing: Math.round(w),
                        easting: Math.round(b),
                        zoneNumber: y,
                        zoneLetter: v(t)
                    }
                }

                function d(e) {
                    var t = e.northing,
                        n = e.easting,
                        r = e.zoneLetter,
                        i = e.zoneNumber;
                    if (i < 0 || i > 60) return null;
                    var s = .9996,
                        o = 6378137,
                        u = .00669438,
                        a, f = (1 - Math.sqrt(1 - u)) / (1 + Math.sqrt(1 - u)),
                        l, c, p, v, m, g, y, b, w, E = n - 5e5,
                        S = t;
                    r < "N" && (S -= 1e7), y = (i - 1) * 6 - 180 + 3, a = u / (1 - u), g = S / s, b = g / (o * (1 - u / 4 - 3 * u * u / 64 - 5 * u * u * u / 256)), w = b + (3 * f / 2 - 27 * f * f * f / 32) * Math.sin(2 * b) + (21 * f * f / 16 - 55 * f * f * f * f / 32) * Math.sin(4 * b) + 151 * f * f * f / 96 * Math.sin(6 * b), l = o / Math.sqrt(1 - u * Math.sin(w) * Math.sin(w)), c = Math.tan(w) * Math.tan(w), p = a * Math.cos(w) * Math.cos(w), v = o * (1 - u) / Math.pow(1 - u * Math.sin(w) * Math.sin(w), 1.5), m = E / (l * s);
                    var x = w - l * Math.tan(w) / v * (m * m / 2 - (5 + 3 * c + 10 * p - 4 * p * p - 9 * a) * m * m * m * m / 24 + (61 + 90 * c + 298 * p + 45 * c * c - 252 * a - 3 * p * p) * m * m * m * m * m * m / 720);
                    x = h(x);
                    var T = (m - (1 + 2 * c + p) * m * m * m / 6 + (5 - 2 * p + 28 * c - 3 * p * p + 8 * a + 24 * c * c) * m * m * m * m * m / 120) / Math.cos(w);
                    T = y + h(T);
                    var N;
                    if (e.accuracy) {
                        var C = d({
                            northing: e.northing + e.accuracy,
                            easting: e.easting + e.accuracy,
                            zoneLetter: e.zoneLetter,
                            zoneNumber: e.zoneNumber
                        });
                        N = {
                            top: C.lat,
                            right: C.lon,
                            bottom: x,
                            left: T
                        }
                    } else N = {
                        lat: x,
                        lon: T
                    };
                    return N
                }

                function v(e) {
                    var t = "Z";
                    return 84 >= e && e >= 72 ? t = "X" : 72 > e && e >= 64 ? t = "W" : 64 > e && e >= 56 ? t = "V" : 56 > e && e >= 48 ? t = "U" : 48 > e && e >= 40 ? t = "T" : 40 > e && e >= 32 ? t = "S" : 32 > e && e >= 24 ? t = "R" : 24 > e && e >= 16 ? t = "Q" : 16 > e && e >= 8 ? t = "P" : 8 > e && e >= 0 ? t = "N" : 0 > e && e >= -8 ? t = "M" : -8 > e && e >= -16 ? t = "L" : -16 > e && e >= -24 ? t = "K" : -24 > e && e >= -32 ? t = "J" : -32 > e && e >= -40 ? t = "H" : -40 > e && e >= -48 ? t = "G" : -48 > e && e >= -56 ? t = "F" : -56 > e && e >= -64 ? t = "E" : -64 > e && e >= -72 ? t = "D" : -72 > e && e >= -80 && (t = "C"), t
                }

                function m(e, t) {
                    var n = "00000" + e.easting,
                        r = "00000" + e.northing;
                    return e.zoneNumber + e.zoneLetter + g(e.easting, e.northing, e.zoneNumber) + n.substr(n.length - 5, t) + r.substr(r.length - 5, t)
                }

                function g(e, t, n) {
                    var r = y(n),
                        i = Math.floor(e / 1e5),
                        s = Math.floor(t / 1e5) % 20;
                    return b(i, s, r)
                }

                function y(e) {
                    var t = e % r;
                    return t === 0 && (t = r), t
                }

                function b(e, t, n) {
                    var r = n - 1,
                        c = i.charCodeAt(r),
                        h = s.charCodeAt(r),
                        p = c + e - 1,
                        d = h + t,
                        v = !1;
                    p > l && (p = p - l + o - 1, v = !0), (p === u || c < u && p > u || (p > u || c < u) && v) && p++;
                    if (p === a || c < a && p > a || (p > a || c < a) && v) p++, p === u && p++;
                    p > l && (p = p - l + o - 1), d > f ? (d = d - f + o - 1, v = !0) : v = !1, (d === u || h < u && d > u || (d > u || h < u) && v) && d++;
                    if (d === a || h < a && d > a || (d > a || h < a) && v) d++, d === u && d++;
                    d > f && (d = d - f + o - 1);
                    var m = String.fromCharCode(p) + String.fromCharCode(d);
                    return m
                }

                function w(e) {
                    if (e && e.length === 0) throw "MGRSPoint coverting from nothing";
                    var t = e.length,
                        n = null,
                        r = "",
                        i, s = 0;
                    while (!/[A-Z]/.test(i = e.charAt(s))) {
                        if (s >= 2) throw "MGRSPoint bad conversion from: " + e;
                        r += i, s++
                    }
                    var o = parseInt(r, 10);
                    if (s === 0 || s + 3 > t) throw "MGRSPoint bad conversion from: " + e;
                    var u = e.charAt(s++);
                    if (u <= "A" || u === "B" || u === "Y" || u >= "Z" || u === "I" || u === "O") throw "MGRSPoint zone letter " + u + " not handled: " + e;
                    n = e.substring(s, s += 2);
                    var a = y(o),
                        f = E(n.charAt(0), a),
                        l = S(n.charAt(1), a);
                    while (l < x(u)) l += 2e6;
                    var c = t - s;
                    if (c % 2 !== 0) throw "MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters" + e;
                    var h = c / 2,
                        p = 0,
                        d = 0,
                        v, m, g, b, w;
                    return h > 0 && (v = 1e5 / Math.pow(10, h), m = e.substring(s, s + h), p = parseFloat(m) * v, g = e.substring(s + h), d = parseFloat(g) * v), b = p + f, w = d + l, {
                        easting: b,
                        northing: w,
                        zoneLetter: u,
                        zoneNumber: o,
                        accuracy: v
                    }
                }

                function E(e, t) {
                    var n = i.charCodeAt(t - 1),
                        r = 1e5,
                        s = !1;
                    while (n !== e.charCodeAt(0)) {
                        n++, n === u && n++, n === a && n++;
                        if (n > l) {
                            if (s) throw "Bad character: " + e;
                            n = o, s = !0
                        }
                        r += 1e5
                    }
                    return r
                }

                function S(e, t) {
                    if (e > "V") throw "MGRSPoint given invalid Northing " + e;
                    var n = s.charCodeAt(t - 1),
                        r = 0,
                        i = !1;
                    while (n !== e.charCodeAt(0)) {
                        n++, n === u && n++, n === a && n++;
                        if (n > f) {
                            if (i) throw "Bad character: " + e;
                            n = o, i = !0
                        }
                        r += 1e5
                    }
                    return r
                }

                function x(e) {
                    var t;
                    switch (e) {
                        case "C":
                            t = 11e5;
                            break;
                        case "D":
                            t = 2e6;
                            break;
                        case "E":
                            t = 28e5;
                            break;
                        case "F":
                            t = 37e5;
                            break;
                        case "G":
                            t = 46e5;
                            break;
                        case "H":
                            t = 55e5;
                            break;
                        case "J":
                            t = 64e5;
                            break;
                        case "K":
                            t = 73e5;
                            break;
                        case "L":
                            t = 82e5;
                            break;
                        case "M":
                            t = 91e5;
                            break;
                        case "N":
                            t = 0;
                            break;
                        case "P":
                            t = 8e5;
                            break;
                        case "Q":
                            t = 17e5;
                            break;
                        case "R":
                            t = 26e5;
                            break;
                        case "S":
                            t = 35e5;
                            break;
                        case "T":
                            t = 44e5;
                            break;
                        case "U":
                            t = 53e5;
                            break;
                        case "V":
                            t = 62e5;
                            break;
                        case "W":
                            t = 7e6;
                            break;
                        case "X":
                            t = 79e5;
                            break;
                        default:
                            t = -1
                    }
                    if (t >= 0) return t;
                    throw "Invalid zone letter: " + e
                }
                var r = 6,
                    i = "AJSAJS",
                    s = "AFAFAF",
                    o = 65,
                    u = 73,
                    a = 79,
                    f = 86,
                    l = 90;
                n.forward = function(e, t) {
                    return t = t || 5, m(p({
                        lat: e[1],
                        lon: e[0]
                    }), t)
                }, n.inverse = function(e) {
                    var t = d(w(e.toUpperCase()));
                    return t.lat && t.lon ? [t.lon, t.lat, t.lon, t.lat] : [t.left, t.bottom, t.right, t.top]
                }, n.toPoint = function(e) {
                    var t = d(w(e.toUpperCase()));
                    return t.lat && t.lon ? [t.lon, t.lat] : [(t.left + t.right) / 2, (t.top + t.bottom) / 2]
                }
            }, {}],
            68: [function(e, t, n) {
                t.exports = {
                    name: "proj4",
                    version: "2.3.14",
                    description: "Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",
                    main: "lib/index.js",
                    directories: {
                        test: "test",
                        doc: "docs"
                    },
                    scripts: {
                        test: "./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"
                    },
                    repository: {
                        type: "git",
                        url: "git://github.com/proj4js/proj4js.git"
                    },
                    author: "",
                    license: "MIT",
                    jam: {
                        main: "dist/proj4.js",
                        include: ["dist/proj4.js", "README.md", "AUTHORS", "LICENSE.md"]
                    },
                    devDependencies: {
                        "grunt-cli": "~0.1.13",
                        grunt: "~0.4.2",
                        "grunt-contrib-connect": "~0.6.0",
                        "grunt-contrib-jshint": "~0.8.0",
                        chai: "~1.8.1",
                        mocha: "~1.17.1",
                        "grunt-mocha-phantomjs": "~0.4.0",
                        browserify: "~12.0.1",
                        "grunt-browserify": "~4.0.1",
                        "grunt-contrib-uglify": "~0.11.1",
                        curl: "git://github.com/cujojs/curl.git",
                        istanbul: "~0.2.4",
                        tin: "~0.4.0"
                    },
                    dependencies: {
                        mgrs: "~0.0.2"
                    }
                }
            }, {}],
            "./includedProjections": [function(e, t, n) {
                t.exports = e("hTEDpn")
            }, {}],
            hTEDpn: [function(e, t, n) {
                var r = [e("./lib/projections/tmerc"), e("./lib/projections/utm"), e("./lib/projections/sterea"), e("./lib/projections/stere"), e("./lib/projections/somerc"), e("./lib/projections/omerc"), e("./lib/projections/lcc"), e("./lib/projections/krovak"), e("./lib/projections/cass"), e("./lib/projections/laea"), e("./lib/projections/aea"), e("./lib/projections/gnom"), e("./lib/projections/cea"), e("./lib/projections/eqc"), e("./lib/projections/poly"), e("./lib/projections/nzmg"), e("./lib/projections/mill"), e("./lib/projections/sinu"), e("./lib/projections/moll"), e("./lib/projections/eqdc"), e("./lib/projections/vandg"), e("./lib/projections/aeqd")];
                t.exports = function(e) {
                    r.forEach(function(t) {
                        e.Proj.projections.add(t)
                    })
                }
            }, {
                "./lib/projections/aea": 40,
                "./lib/projections/aeqd": 41,
                "./lib/projections/cass": 42,
                "./lib/projections/cea": 43,
                "./lib/projections/eqc": 44,
                "./lib/projections/eqdc": 45,
                "./lib/projections/gnom": 47,
                "./lib/projections/krovak": 48,
                "./lib/projections/laea": 49,
                "./lib/projections/lcc": 50,
                "./lib/projections/mill": 53,
                "./lib/projections/moll": 54,
                "./lib/projections/nzmg": 55,
                "./lib/projections/omerc": 56,
                "./lib/projections/poly": 57,
                "./lib/projections/sinu": 58,
                "./lib/projections/somerc": 59,
                "./lib/projections/stere": 60,
                "./lib/projections/sterea": 61,
                "./lib/projections/tmerc": 62,
                "./lib/projections/utm": 63,
                "./lib/projections/vandg": 64
            }]
        }, {}, [36])(36)
    }),
    function(e) {
        var t, n;
        if (typeof define == "function" && define.amd) define("proj4.leaflet", ["leaflet", "proj4"], e);
        else if (typeof module != "undefined") t = require("leaflet"), n = require("proj4"), module.exports = e(t, n);
        else {
            if (typeof window.L == "undefined" || typeof window.proj4 == "undefined") throw "Leaflet and proj4 must be loaded first";
            e(window.L, window.proj4)
        }
    }(function(e, t) {
        return e.Proj = {}, e.Proj._isProj4Obj = function(e) {
            return typeof e.inverse != "undefined" && typeof e.forward != "undefined"
        }, e.Proj.ScaleDependantTransformation = function(e) {
            this.scaleTransforms = e
        }, e.Proj.ScaleDependantTransformation.prototype.transform = function(e, t) {
            return this.scaleTransforms[t].transform(e, t)
        }, e.Proj.ScaleDependantTransformation.prototype.untransform = function(e, t) {
            return this.scaleTransforms[t].untransform(e, t)
        }, e.Proj.Projection = e.Class.extend({
            initialize: function(n, r) {
                if (e.Proj._isProj4Obj(n)) this._proj = n;
                else {
                    var i = n;
                    if (r) t.defs(i, r);
                    else if (t.defs[i] === undefined) {
                        var s = i.split(":");
                        s.length > 3 && (i = s[s.length - 3] + ":" + s[s.length - 1]);
                        if (t.defs[i] === undefined) throw "No projection definition for code " + i
                    }
                    this._proj = t(i)
                }
            },
            project: function(t) {
                var n = this._proj.forward([t.lng, t.lat]);
                return new e.Point(n[0], n[1])
            },
            unproject: function(t, n) {
                var r = this._proj.inverse([t.x, t.y]);
                return new e.LatLng(r[1], r[0], n)
            }
        }), e.Proj.CRS = e.Class.extend({
            includes: e.CRS,
            options: {
                transformation: new e.Transformation(1, 0, -1, 0)
            },
            initialize: function(t, n, r) {
                var i, s, o, u;
                e.Proj._isProj4Obj(t) ? (s = t, i = s.srsCode, u = n || {}, this.projection = new e.Proj.Projection(s)) : (i = t, o = n, u = r || {}, this.projection = new e.Proj.Projection(i, o)), e.Util.setOptions(this, u), this.code = i, this.transformation = this.options.transformation, this.options.origin && (this.transformation = new e.Transformation(1, -this.options.origin[0], -1, this.options.origin[1]));
                if (this.options.scales) this._scales = this.options.scales;
                else if (this.options.resolutions) {
                    this._scales = [];
                    for (var a = this.options.resolutions.length - 1; a >= 0; a--) this.options.resolutions[a] && (this._scales[a] = 1 / this.options.resolutions[a])
                }
            },
            scale: function(e) {
                var t = Math.floor(e),
                    n, r, i, s;
                return e === t ? this._scales[e] : (n = this._scales[t], r = this._scales[t + 1], i = r - n, s = e - t, n + i * s)
            },
            getSize: function(t) {
                var n = this.options.bounds,
                    r, i, s;
                return n ? (r = this.scale(t), i = this.transformation.transform(n.min, r), s = this.transformation.transform(n.max, r), e.point(Math.abs(s.x - i.x), Math.abs(s.y - i.y))) : (r = 256 * Math.pow(2, t), e.point(r, r))
            }
        }), e.Proj.CRS.TMS = e.Proj.CRS.extend({
            options: {
                tileSize: 256
            },
            initialize: function(t, n, r, i) {
                var s, o, u, a, f;
                e.Proj._isProj4Obj(t) ? (u = t, a = n, f = r || {}, f.origin = [a[0], a[3]], e.Proj.CRS.prototype.initialize.call(this, u, f)) : (s = t, o = n, a = r, f = i || {}, f.origin = [a[0], a[3]], e.Proj.CRS.prototype.initialize.call(this, s, o, f)), this.projectedBounds = a, this._sizes = this._calculateSizes()
            },
            _calculateSizes: function() {
                var t = [],
                    n = this.projectedBounds,
                    r, i, s, o;
                for (i = this._scales.length - 1; i >= 0; i--) this._scales[i] && (r = this.options.tileSize / this._scales[i], s = Math.ceil(parseFloat((n[2] - n[0]) / r).toPrecision(3)) * r * this._scales[i], o = Math.ceil(parseFloat((n[3] - n[1]) / r).toPrecision(3)) * r * this._scales[i], t[i] = e.point(s, o));
                return t
            },
            getSize: function(e) {
                return this._sizes[e]
            }
        }), e.Proj.TileLayer = {}, e.Proj.TileLayer.TMS = e.TileLayer.extend({
            options: {
                continuousWorld: !0
            },
            initialize: function(t, n, r) {
                var i = !0,
                    s, o, u, a;
                if (!(n instanceof e.Proj.CRS.TMS)) throw "CRS is not L.Proj.CRS.TMS.";
                e.TileLayer.prototype.initialize.call(this, t, r), this.options.tms = !1, this.crs = n, u = this.crs.projectedBounds;
                for (a = this.options.minZoom; a < this.options.maxZoom && i; a++) {
                    var f = (u[3] - u[1]) / this._projectedTileSize(a);
                    i = Math.abs(f - Math.round(f)) > .001
                }
                if (!i) {
                    s = {};
                    for (a = this.options.minZoom; a < this.options.maxZoom; a++) o = u[1] + Math.ceil((u[3] - u[1]) / this._projectedTileSize(a)) * this._projectedTileSize(a), s[this.crs.scale(a)] = new e.Transformation(1, -u[0], -1, o);
                    this.crs = new e.Proj.CRS.TMS(this.crs.projection._proj, u, this.crs.options), this.crs.transformation = new e.Proj.ScaleDependantTransformation(s)
                }
            },
            getTileUrl: function(t) {
                var n = this._map.getZoom(),
                    r = Math.ceil((this.crs.projectedBounds[3] - this.crs.projectedBounds[1]) / this._projectedTileSize(n));
                return e.Util.template(this._url, e.Util.extend({
                    s: this._getSubdomain(t),
                    z: this._getZoomForUrl(),
                    x: t.x,
                    y: r - t.y - 1
                }, this.options))
            },
            _projectedTileSize: function(e) {
                return this.options.tileSize / this.crs.scale(e)
            }
        }), e.Proj.GeoJSON = e.GeoJSON.extend({
            initialize: function(t, n) {
                this._callLevel = 0, e.GeoJSON.prototype.initialize.call(this, null, n), t && this.addData(t)
            },
            addData: function(t) {
                var n;
                t && (t.crs && t.crs.type === "name" ? n = new e.Proj.CRS(t.crs.properties.name) : t.crs && t.crs.type && (n = new e.Proj.CRS(t.crs.type + ":" + t.crs.properties.code)), n !== undefined && (this.options.coordsToLatLng = function(t) {
                    var r = e.point(t[0], t[1]);
                    return n.projection.unproject(r)
                })), this._callLevel++;
                try {
                    e.GeoJSON.prototype.addData.call(this, t)
                } finally {
                    this._callLevel--, this._callLevel === 0 && delete this.options.coordsToLatLng
                }
            }
        }), e.Proj.geoJson = function(t, n) {
            return new e.Proj.GeoJSON(t, n)
        }, e.Proj.ImageOverlay = e.ImageOverlay.extend({
            initialize: function(t, n, r) {
                e.ImageOverlay.prototype.initialize.call(this, t, null, r), this._projBounds = n
            },
            _animateZoom: function(t) {
                var n = e.point(this._projBounds.min.x, this._projBounds.max.y),
                    r = e.point(this._projBounds.max.x, this._projBounds.min.y),
                    i = this._projectedToNewLayerPoint(n, t.zoom, t.center),
                    s = this._projectedToNewLayerPoint(r, t.zoom, t.center).subtract(i),
                    o = i.add(s._multiplyBy((1 - 1 / t.scale) / 2));
                this._image.style[e.DomUtil.TRANSFORM] = e.DomUtil.getTranslateString(o) + " scale(" + this._map.getZoomScale(t.zoom) + ") "
            },
            _reset: function() {
                var t = this._map.getZoom(),
                    n = this._map.getPixelOrigin(),
                    r = e.bounds(this._transform(this._projBounds.min, t)._subtract(n), this._transform(this._projBounds.max, t)._subtract(n)),
                    i = r.getSize(),
                    s = this._image;
                e.DomUtil.setPosition(s, r.min), s.style.width = i.x + "px", s.style.height = i.y + "px"
            },
            _projectedToNewLayerPoint: function(e, t, n) {
                var r = this._map._getNewTopLeftPoint(n, t).add(this._map._getMapPanePos());
                return this._transform(e, t)._subtract(r)
            },
            _transform: function(e, t) {
                var n = this._map.options.crs,
                    r = n.transformation,
                    i = n.scale(t);
                return r.transform(e, i)
            }
        }), e.Proj.imageOverlay = function(t, n, r) {
            return new e.Proj.ImageOverlay(t, n, r)
        }, typeof e.CRS != "undefined" && (e.CRS.proj4js = function() {
            return function(t, n, r, i) {
                return i = i || {}, r && (i.transformation = r), new e.Proj.CRS(t, n, i)
            }
        }()), e.Proj
    }), define("text!components/app/map/mapTemplate.html", [], function() {
        return '<span class="loading-animation hide-on-app-loaded map-loading-animation"></span>    \r\n<div id="basemap"></div>\r\n'
    }), define("components/app/map/MapView", ["jquery", "underscore", "backbone", "leaflet", "esri.leaflet", "leaflet.draw", "leaflet.label", "leaflet.markercluster", "proj4.leaflet", "proj4", "text!./mapTemplate.html"], function(e, t, n, r, i, s, o, u, a, f, l) {
        var c = n.View.extend({
            initialize: function() {
                this._layerGroup = new L.layerGroup, this._baseLayerGroup = new L.layerGroup, this.viewUpdating = !1, this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:view", this.handleViewUpdate), this.listenTo(this.model, "change:baseLayers", this.handleBaseLayersUpdate), this.listenTo(this.model, "change:addLayers", this.handleAddLayersUpdate), this.listenTo(this.model, "change:removeLayers", this.handleRemoveLayersUpdate), this.listenTo(this.model, "change:activeLocation", this.handleLayersUpdate), this.listenTo(this.model, "change:filteredLocations", this.handleLocationsUpdate), this.listenTo(this.model, "change:customLayerEdit", this.handleCustomsUpdate), this.listenTo(this.model, "change:customLayerData", this.handleCustomsUpdate), this.listenTo(this.model, "change:mapControl", this.mapControl), this.listenTo(this.model, "change:invalidateSize", this.invalidateSize), this.render();
                var e = this;
                waitFor(function() {
                    return e.model.mapConfigLoaded()
                }, function() {
                    e.configureMap()
                })
            },
            render: function() {
                this.$el.html(t.template(l)({
                    t: tlang
                }));
                var e = this;
                return waitFor(function() {
                    return e.model.mapConfigured()
                }, function() {
                    e.updateBaseLayers()
                }), this
            },
            configureMap: function() {
                var e = this.model.getConfig();
                this.model.setMapOptions(e.mapOptions), this.initProjections(), this._map = L.map(e.mapID, this.model.getMapOptions()).on("zoomstart", t.bind(this.onZoomStart, this)).on("movestart", t.bind(this.onMoveStart, this)).on("zoomend", t.bind(this.onZoomEnd, this)).on("moveend", t.bind(this.onMoveEnd, this)).on("resize", t.debounce(t.bind(this.resize, this), 500)), this.initDraw(), this.updateMapView(), this._zoomControl = L.control.zoom({
                    zoomInText: '<span class="icon-wwf_plus"></span>',
                    zoomOutText: '<span class="icon-wwf_minus"></span>'
                });
                var n = L.control.attribution({
                    position: "bottomleft"
                }).setPrefix("").addAttribution(this.model.getConfig().attribution);
                this._map.addControl(n), this._layerGroup.addTo(this._map), this._baseLayerGroup.addTo(this._map), this.model.setMap(this._map), this.model.mapConfigured(!0)
            },
            initProjections: function() {
                typeof this.model.getConfig().proj4defs != "undefined" && f.defs(this.model.getConfig().proj4defs);
                var e = this.model.getConfig().projection;
                typeof e != "undefined" && (this.model.setCrs(new L.Proj.CRS(e.crs, e.proj4def, {
                    resolutions: e.resolutions,
                    origin: e.origin
                })), this.model.setMapOptions(t.extend(this.model.get("mapOptions"), {
                    crs: this.model.getCrs()
                })))
            },
            initDraw: function() {
                this._map.on("draw:created", t.bind(this.onDrawCreated, this)), this._map.on("draw:edited", t.bind(this.onDrawEdited, this)), this._map.on("draw:deleted", t.bind(this.onDrawDeleted, this)), this.updateCustomLayers()
            },
            updateMapView: function() {
                var e = this.model.getView();
                e !== null && typeof e == "string" && (e = this.model.getConfigView(e));
                if (e !== null && typeof e != "undefined" && typeof e.center != "undefined" && typeof e.zoom != "undefined" && typeof e.dimensions != "undefined")
                    if (this.model.mapConfigured()) {
                        var t = this.getZoomForDimensions(e);
                        (this._map.getZoom() !== t || this.roundDegrees(this._map.getCenter().lat) !== e.center.lat || this.roundDegrees(this._map.getCenter().lng) !== e.center.lng) && this._map.setView(e.center, t, {
                            animate: !0
                        })
                    } else {
                        var n = this.model.getDefaultView();
                        this._map.setView(n.center, this.getZoomForDimensions(n), {
                            animate: !0
                        })
                    } else {
                    var n = this.model.getDefaultView();
                    this._map.setView(n.center, this.getZoomForDimensions(n), {
                        animate: !0
                    })
                }
                this.triggerMapViewUpdated()
            },
            updateBaseLayers: function() {
                this._baseLayerGroup.clearLayers();
                var e = this;
                this.model.getBaseLayers().each(function(t) {
                    t.getMapLayer(function(t) {
                        e._baseLayerGroup.addLayer(t)
                    }, {
                        map: e._map
                    })
                })
            },
            refreshLayers: function() {
                var e = this
            },
            addLayers: function() {
                var e = this.model.getAddLayers(),
                    n = this;
                e.length && (t.each(e, function(e) {
                    e.getMapLayer(function(e, t) {
                        t.getType() === "raster" && n._layerGroup.addLayer(e)
                    }, {
                        map: n._map
                    })
                }), waitFor(function() {
                    return !n.model.activeLayersLoading()
                }, function() {
                    t.each(e, function(e) {
                        e.getType() !== "raster" && e.getMapLayer(function(e, t) {
                            waitFor(function() {
                                return !n.zooming && !n.moving
                            }, function() {
                                n._layerGroup.addLayer(e), t.fadeEnabled() && n.$(".leaflet-overlay-pane .wwf-layer-" + t.id).animate({
                                    opacity: 1
                                }, "fast", "linear")
                            })
                        }, {
                            map: n._map
                        })
                    }), n.model.setAddLayers([])
                }))
            },
            removeLayers: function() {
                var e = this.model.getRemoveLayers(),
                    n = this;
                e.length && t.each(e, function(e) {
                    e.getMapLayer(function(e, t) {
                        t.fadeEnabled() ? n.$(".leaflet-overlay-pane .wwf-layer-" + t.id).animate({
                            opacity: 0
                        }, "fast", "linear").promise().done(function() {
                            n._layerGroup.removeLayer(e)
                        }) : n._layerGroup.removeLayer(e)
                    }, {
                        map: n._map
                    }), e.isCustom() && e.getDrawControl()._map && this._map.removeControl(e.getDrawControl())
                }, this)
            },
            updateCustomLayers: function() {
                t.each(this.model.getActiveLayers(), function(e) {
                    e.isCustom() && (e.isEdit() ? e.getDrawControl()._map || (this._map.addControl(e.getDrawControl()), this.$(".leaflet-draw-draw-polyline").html("<span class='icon-wwf_line'></span>"), this.$(".leaflet-draw-draw-polygon").html("<span class='icon-wwf_polygon'></span>"), this.$(".leaflet-draw-draw-rectangle").html("<span class='icon-wwf_square'></span>"), this.$(".leaflet-draw-draw-circle").html("<span class='icon-wwf_circle'></span>"), this.$(".leaflet-draw-draw-marker").html("<span class='icon-wwf_marker'></span>"), this.$(".leaflet-draw-draw-note").html("<span class='icon-wwf_type'></span>"), this.$(".leaflet-draw-edit-edit").html("<span class='icon-wwf_edit'></span>"), this.$(".leaflet-draw-edit-remove").html("<span class='icon-wwf_remove'></span>")) : e.getDrawControl()._map && this._map.removeControl(e.getDrawControl()))
                }, this)
            },
            handleActive: function() {
                if (this.model.isActive()) {
                    this.$el.show();
                    var e = this;
                    waitFor(function() {
                        return e.model.mapConfigured()
                    }, function() {
                        e.invalidateSize(!1)
                    })
                } else this.$el.hide()
            },
            handleViewUpdate: function() {
                var e = this;
                waitFor(function() {
                    return e.model.mapConfigured()
                }, function() {
                    e.updateMapView()
                })
            },
            handleLocationsUpdate: function() {
                var e = this;
                waitFor(function() {
                    return e.model.mapConfigured()
                }, function() {
                    e.refreshLayers()
                })
            },
            handleLayersUpdate: function() {
                var e = this;
                waitFor(function() {
                    return e.model.mapConfigured()
                }, function() {
                    e.refreshLayers()
                })
            },
            handleAddLayersUpdate: function() {
                var e = this;
                waitFor(function() {
                    return e.model.mapConfigured()
                }, function() {
                    e.addLayers()
                })
            },
            handleRemoveLayersUpdate: function() {
                var e = this;
                waitFor(function() {
                    return e.model.mapConfigured()
                }, function() {
                    e.removeLayers()
                })
            },
            handleBaseLayersUpdate: function() {
                var e = this;
                waitFor(function() {
                    return e.model.mapConfigured()
                }, function() {
                    e.updateBaseLayers()
                })
            },
            handleCustomsUpdate: function() {
                var e = this;
                waitFor(function() {
                    return e.model.mapConfigured()
                }, function() {
                    e.updateCustomLayers()
                })
            },
            mapControl: function() {
                var e = this;
                waitFor(function() {
                    return e.model.mapConfigured()
                }, function() {
                    e.model.getMapControl() ? (e.$el.removeClass("control-disabled"), e._zoomControl._map || e._zoomControl.addTo(e._map), e.enableInteractions()) : (e.$el.addClass("control-disabled"), e._zoomControl._map && e._zoomControl.removeFrom(e._map), e.disableInteractions())
                })
            },
            enableInteractions: function() {
                this._map.dragging.enable(), this._map.touchZoom.enable(), this._map.doubleClickZoom.enable(), this._map.scrollWheelZoom.enable(), this._map.boxZoom.enable(), typeof this._map.tap != "undefined" && this._map.tap.enable()
            },
            disableInteractions: function() {
                this._map.dragging.disable(), this._map.touchZoom.disable(), this._map.doubleClickZoom.disable(), this._map.scrollWheelZoom.disable(), this._map.boxZoom.disable(), typeof this._map.tap != "undefined" && this._map.tap.disable()
            },
            resize: function() {
                this.updateMapView()
            },
            invalidateSize: function(e) {
                e = typeof e != "undefined" ? e : !1, typeof this._map != "undefined" && this._map.invalidateSize(e)
            },
            onZoomStart: function(e) {
                this.zooming = !0
            },
            onMoveStart: function(e) {
                this.moving = !0
            },
            onZoomEnd: function(e) {
                this.zooming = !1, this.triggerMapViewUpdated()
            },
            onMoveEnd: function(e) {
                this.moving = !1, this.triggerMapViewUpdated()
            },
            onDrawCreated: function(e) {
                var n = e.layer.toGeoJSON();
                n.properties.featureid = Math.random().toString(36).slice(-5), n.properties.type = e.layerType;
                var r = this;
                n.geometry.type === "Polygon" && (n.geometry.coordinates[0] = t.map(n.geometry.coordinates[0], function(e) {
                    return [this.roundDegrees(e[0]), this.roundDegrees(e[1])]
                }, this)), n.geometry.type === "Point" && (n.geometry.coordinates = [this.roundDegrees(n.geometry.coordinates[0]), this.roundDegrees(n.geometry.coordinates[1])]), e.layerType === "circle" && (n.properties.radius = Math.round(e.layer._mRadius)), this.$el.trigger("customUpdated", {
                    layer: {
                        id: this.model.get("customLayerEdit"),
                        shapes: [n]
                    }
                })
            },
            onDrawEdited: function(e) {
                var n = [],
                    r = this;
                e.layers.eachLayer(function(i) {
                    var s = i.toGeoJSON();
                    s.geometry.type === "Polygon" && (s.geometry.coordinates[0] = t.map(s.geometry.coordinates[0], function(e) {
                        return [r.roundDegrees(e[0]), r.roundDegrees(e[1])]
                    })), s.geometry.type === "Point" && (s.geometry.coordinates = [r.roundDegrees(s.geometry.coordinates[0]), r.roundDegrees(s.geometry.coordinates[1])]), i.feature.properties.type === "circle" && (s.properties.radius = Math.round(t.values(e.layers._layers)[0]._mRadius)), n.push(s)
                }), this.$el.trigger("customUpdated", {
                    layer: {
                        id: this.model.get("customLayerEdit"),
                        shapes: n
                    }
                })
            },
            onDrawDeleted: function(e) {
                var t = [],
                    n = this;
                e.layers.eachLayer(function(e) {
                    t.push(e.feature.properties.featureid)
                }), this.$el.trigger("customDeleted", {
                    layer: {
                        id: this.model.get("customLayerEdit"),
                        shapes: t
                    }
                })
            },
            triggerMapViewUpdated: function() {
                if (!this.viewUpdating) {
                    var e = this;
                    this.viewUpdating = !0, waitFor(function() {
                        return e.model.mapConfigured() && e.model.getView() !== null
                    }, function() {
                        e.viewUpdating = !1;
                        var n = e.model.getView();
                        typeof n != "undefined" && (n.zoom !== e._map.getZoom() || n.center.lat !== e.roundDegrees(e._map.getCenter().lat) || n.center.lng !== e.roundDegrees(e._map.getCenter().lng) || !t.isEqual(n.dimensions, e.getDimensions())) && e.$el.trigger("mapViewUpdated", {
                            zoom: e._map.getZoom(),
                            center: {
                                lat: e.roundDegrees(e._map.getCenter().lat),
                                lng: e.roundDegrees(e._map.getCenter().lng)
                            },
                            dimensions: e.getDimensions()
                        })
                    })
                }
            },
            getDimensions: function() {
                return [this.$el.innerWidth(), this.$el.innerHeight()]
            },
            getZoomOffset: function(e) {
                var t = this.getDimensions(),
                    n = this.model.getMode() === "print" ? this.model.attributes.config.printMargin * 2 : 0,
                    r = [e.dimensions[0] - n, e.dimensions[1] - n],
                    i = 1,
                    s = 0,
                    o = 1;
                t[0] / t[1] > r[0] / r[1] ? i = t[1] / r[1] : i = t[0] / r[0];
                if (i === 1) return s;
                if (i > 1)
                    while (o * 1.9 < i) o *= 2, s++;
                else {
                    var s = 0,
                        o = 1;
                    while (o > i) o /= 2, s--
                }
                return s
            },
            getZoomForDimensions: function(e) {
                return Math.max(Math.min(e.zoom + this.getZoomOffset(e), this._map.getMaxZoom()), this._map.getMinZoom())
            },
            setZoomClass: function() {
                this.$el.removeClass(function(e, t) {
                    return (t.match(/\bzoom-level-\S+/g) || []).join(" ")
                }), this.$el.addClass("zoom-level-" + this.model.getZoom())
            },
            roundDegrees: function(e) {
                return Math.round(e * 1e4) / 1e4
            }
        });
        return c
    }), define("components/app/map/MapModel", ["jquery", "underscore", "backbone", "leaflet"], function(e, t, n, r) {
        var i = n.Model.extend({
            initialize: function(e) {
                this.options = e || {}, this.set("activeLayers", []), this.set("removeLayers", []), this.set("addLayers", []), this.set("keepLayers", []), this.set("mapConfigured", !1), this.set("mapControl", null), this.processMapConfig()
            },
            processMapConfig: function() {
                this.setConfigViews(this.attributes.config.views)
            },
            preloadLayer: function(e) {
                e.get("type") !== "point" && e.get("type") !== "raster" && e.getMapLayer(function() {}, {
                    map: this.attributes.map
                })
            },
            getConfig: function() {
                return this.attributes.config
            },
            getMapOptions: function() {
                var e = t.clone(this.attributes.mapOptions);
                return this.getMode() === "print" && (e.maxZoom = e.maxZoom + 2), e
            },
            mapConfigLoaded: function() {
                return typeof this.attributes.config != "undefined"
            },
            mapConfigured: function(e) {
                return typeof e != "undefined" ? this.set("mapConfigured", e) : this.attributes.mapConfigured
            },
            setView: function(e) {
                this.set("view", e)
            },
            getView: function() {
                return this.attributes.view
            },
            setConfigViews: function(e) {
                this.set("configViews", e)
            },
            getConfigView: function(e) {
                return this.attributes.configViews[e]
            },
            getDefaultView: function() {
                return this.getConfigView("default")
            },
            setBaseLayers: function(e) {
                this.set("baseLayers", e)
            },
            getBaseLayers: function() {
                return this.attributes.baseLayers
            },
            setActiveLayers: function(e) {
                this.set("removeLayers", t.difference(this.attributes.activeLayers, e)), this.set("addLayers", t.difference(e, this.attributes.activeLayers)), this.set("keepLayers", t.intersection(this.attributes.activeLayers, e));
                var n = this;
                waitFor(function() {
                    return n.mapConfigured() && !n.activeLayersLoading()
                }, function() {
                    n.set("activeLayers", e)
                })
            },
            activeLayersLoading: function() {
                var e = t.where(t.pluck(this.attributes.addLayers, "attributes"), {
                    loading: !1
                }).length;
                return e.length === this.attributes.addLayers.length
            },
            getActiveLayers: function() {
                return this.attributes.activeLayers
            },
            getRemoveLayers: function() {
                return this.attributes.removeLayers
            },
            getAddLayers: function() {
                return this.attributes.addLayers
            },
            setAddLayers: function(e) {
                this.set("addLayers", e)
            },
            getKeepLayers: function() {
                return this.attributes.keepLayers
            },
            setCustomShapes: function(e) {
                this.set("customs", e)
            },
            getCustomShapes: function() {
                return this.attributes.customs
            },
            getCrs: function() {
                return this.attributes.crs
            },
            setCrs: function(e) {
                this.set("crs", e)
            },
            setInvalidateSize: function(e) {
                this.set("invalidateSize", e)
            },
            getZoom: function() {
                return this.attributes.zoom
            },
            getMapControl: function() {
                return this.attributes.mapControl
            },
            setMapControl: function(e) {
                this.set("mapControl", e)
            },
            setMap: function(e) {
                this.set("map", e)
            },
            setMapOptions: function(e) {
                this.set("mapOptions", e)
            },
            setActive: function(e) {
                e = typeof e != "undefined" ? e : !0, this.set("active", e)
            },
            isActive: function() {
                return this.get("active")
            },
            getMode: function() {
                return this.attributes.mode
            },
            getType: function() {
                return this.attributes.type
            }
        });
        return i
    }), define("text!components/app/modal/modalTemplate.html", [], function() {
        return '<div class="modal content-scroll panel-light"></div>'
    }), define("text!components/app/modal/modalShareTemplate.html", [], function() {
        return '<div class="modal content-scroll panel-dark">\r\n  <div class="share-modal-header panel-header">\r\n    <a href="#" class="icon-wwf_close close-item ocean-bgcolor"></a>\r\n    <h3 class="modal-subtitle ocean-color"><%= t.app.title %></h3>\r\n    <h1 class="modal-title"><%= t.ux.share.share_title %></h1>\r\n  </div>\r\n  <div class="waves"></div>        \r\n  <div class="modal-content">\r\n    <div class="content-container">\r\n      <ul class="share-links list-unstyled list-inline">\r\n        <li>\r\n          <a href="//twitter.com/intent/tweet?text=<%= encodeURI(t.ux.share.share_tweet) %>&url=<%= url_enc %>&hashtags=<%= t.ux.share.share_twitter_hashtag %>&via=<%= t.ux.share.share_twitter_via %>"\r\n           class="btn btn-small btn-default btn-share ocean-bgcolor" target="_blank" >\r\n          <span class="btn-icon icon-wwf_twitter"></span>\r\n          <span class="btn-icon-text"><%= t.ux.share.twitter %></span>\r\n        </a>\r\n        </li><li>\r\n        <a href="//www.facebook.com/sharer/sharer.php?u=<%= url_enc %>"\r\n           class="btn btn-small btn-default btn-share ocean-bgcolor" target="_blank" >\r\n          <span class="btn-icon icon-wwf_facebook"></span>\r\n          <span class="btn-icon-text"><%= t.ux.share.facebook %></span>\r\n        </a>\r\n        </li>\r\n      </ul>\r\n      <div class="share-copy-link">\r\n        <h4><%= t.ux.share.share_link_current_view %></h4>\r\n        <input class="form-control select-on-click share-link ocean-color" type="text" value="<%= url_current %>">\r\n      </div>        \r\n    </div>\r\n    <div class="content-container container-fluid">\r\n      <div class="share-accounts">\r\n        <h4><%= t.ux.share.share_visit %></h4>\r\n        <div class="row">\r\n          <ul class="account-links list-unstyled col-xs-6 col-sm-4 col-sm-offset-2">\r\n            <li>\r\n              <a href="<%= t.ux.share.twitter_url %>" target="_blank" class="">\r\n              <span class="account-icon icon-wwf_twitter"></span>\r\n              <span class="account-text"><%= t.ux.share.twitter %></span>\r\n            </a>\r\n            </li>\r\n            <li>\r\n              <a href="<%= t.ux.share.facebook_url %>" target="_blank" class="">\r\n                <span class="account-icon icon-wwf_facebook"></span>\r\n                <span class="account-text"><%= t.ux.share.facebook %></span>\r\n              </a>\r\n            </li>\r\n            <li>\r\n              <a href="<%= t.ux.share.google_url %>" target="_blank" class="">\r\n                <span class="account-icon icon-wwf_googleplus"></span>\r\n                <span class="account-text"><%= t.ux.share.google %></span>\r\n              </a>\r\n            </li>\r\n            <li>\r\n              <a href="<%= t.ux.share.instagram_url %>" target="_blank" class="">\r\n                <span class="account-icon icon-wwf_instagram"></span>\r\n                <span class="account-text"><%= t.ux.share.instagram %></span>\r\n              </a>\r\n            </li>\r\n          </ul>\r\n          <ul class="account-links list-unstyled col-xs-6 col-sm-4">              \r\n            <li>\r\n              <a href="<%= t.ux.share.pinterest_url %>" target="_blank" class="">\r\n                <span class="account-icon icon-wwf_pinterest"></span>\r\n                <span class="account-text"><%= t.ux.share.pinterest %></span>\r\n              </a>\r\n            </li>\r\n            <li>\r\n              <a href="<%= t.ux.share.youtube_url %>" target="_blank" class="">\r\n                <span class="account-icon icon-wwf_youtube"></span>\r\n                <span class="account-text"><%= t.ux.share.youtube %></span>\r\n              </a>\r\n            </li>\r\n            <li>\r\n              <a href="<%= t.ux.share.blog_url %>" target="_blank" class="">\r\n                <span class="account-icon icon-wwf_wwf"></span>\r\n                <span class="account-text"><%= t.ux.share.blog %></span>\r\n              </a>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n        <a href="<%= t.app.wwfurl %>" target="_blank" class="hero ocean-color"><%= t.app.wwfanchor %></a>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</div>  '
    }), define("text!components/app/modal/modalPrintTemplate.html", [], function() {
        return '<div class="modal content-scroll panel-dark">\r\n  <div class="share-modal-header panel-header">\r\n    <a href="#" class="icon-wwf_close close-item ocean-bgcolor"></a>\r\n    <h3 class="modal-suptitle ocean-color"><%= t.app.title %></h3>\r\n    <h1 class="modal-title"><%= t.ux.print.print_title %></h1>\r\n  </div>\r\n  <div class="waves"></div>          \r\n  <div class="modal-content">\r\n    <div class="content-container">\r\n      <% if (print_url === \'\' || print_url === \'loading\'){ %>\r\n      <p> <%= t.ux.print.wait  %> </p>\r\n      <span class="loading-animation print-loading-animation"></span>\r\n\r\n      <% } else { %>\r\n\r\n      <ul class="share-links print-links list-unstyled list-inline">\r\n        <li>\r\n          <a href=\'<%= print_url %>\' target=\'_blank\'\r\n           class="btn btn-small btn-default btn-share ocean-bgcolor" >\r\n          <span class="btn-icon-text"><%= t.ux.print.download %></span>\r\n        </a>\r\n        </li>\r\n        <li>\r\n          <a href="#"\r\n           class="btn btn-small btn-default btn-share print-share ocean-bgcolor" target="_blank" >\r\n          <span class="btn-icon-text"><%= t.ux.print.share %></span>\r\n        </a>\r\n        </li>\r\n      </ul>\r\n      <% } %>\r\n      <div class="share-copy-link">\r\n        <h4><%= t.ux.print.link %></h4>\r\n        <input class="form-control select-on-click share-link ocean-color" type="text" value="<%= url_id %>">\r\n      </div>\r\n    </div>\r\n  </div> \r\n</div>'
    }), define("text!templates/categoryPlaceholderTemplate.html", [], function() {
        return '<div class="category category-<%= catId %>">  \r\n  <table><tbody>\r\n  <tr>\r\n    <td class="category-icon icon-wwf_<%= catId %>-grey"></td>\r\n    <td class="category-text">\r\n      <div class="category-title"><%= catTitle %></div>\r\n      <div class="subcategory-title"><%= subcatTitle %></div>\r\n    </td>\r\n  </tr>\r\n  </tbody></table>\r\n</div>\r\n'
    }), define("text!templates/layerReferencePlaceholderTemplate.html", [], function() {
        return '<span class="layer-reference">  \r\n  <%= text %>\r\n</span>\r\n'
    }), define("components/app/modal/ModalView", ["jquery", "underscore", "backbone", "jquery.deparam", "text!./modalTemplate.html", "text!./modalShareTemplate.html", "text!./modalPrintTemplate.html", "text!templates/categoryPlaceholderTemplate.html", "text!templates/layerControlPlaceholderTemplate.html", "text!templates/layerReferencePlaceholderTemplate.html", "text!templates/oceanHeaderTemplate.html"], function(e, t, n, r, i, s, o, u, a, f, l) {
        var c = n.View.extend({
            events: {
                "click #modal-wrap": "closeModal",
                "click .close-item": "closeModal",
                "click .print-share": "shareMap",
                "click .select-in-click": "selectOnClick",
                "click .toggle-layer": "toggleLayer"
            },
            initialize: function() {
                this.listenTo(this.model, "change:modal", this.handleModalChange), this.listenTo(this.model, "change:modalid", this.handleModalChange), this.listenTo(this.model, "change:printURL", this.handleModalChange), this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:path", this.handlePathChange)
            },
            render: function() {
                return this
            },
            loadShareContent: function() {
                var e, n, r;
                lang === "en" ? e = window.location.protocol + "//" + window.location.host + "/" : e = window.location.protocol + "//" + window.location.host + "/" + lang + "/", r = window.location.href, r = this.removeURLParam(r, "modal"), r = this.removeURLParam(r, "modalid"), n = {
                    t: tlang,
                    url: e,
                    url_enc: encodeURIComponent(e),
                    url_current: r
                }, this.$("#modal-wrap").html(t.template(s)(n)), this.$(".select-on-click").on("click", this.selectOnClick)
            },
            loadPrintContent: function() {
                var e, n, r, i = this.model.getModalId();
                lang === "en" ? e = window.location.protocol + "//" + window.location.host + "/" : e = window.location.protocol + "//" + window.location.host + "/" + lang + "/", n = {
                    t: tlang,
                    url_id: e + "#!/id/" + i,
                    print_url: this.model.getPrintURL()
                }, this.$("#modal-wrap").html(t.template(o)(n)), this.$(".select-on-click").on("click", this.selectOnClick)
            },
            loadLayerContent: function(e) {
                if (typeof e != "undefined" && e !== "" && t.contains(this.model.getLayers().getIds(), e)) {
                    this.$("#modal-wrap").html(i);
                    var n = this.model.getLayers().get(e),
                        r = this;
                    this.$(".modal").html('<div class="content-aside content-wrap"><span class="loading-animation panel-loading-animation"></span></div>'), n.getContent(function(e) {
                        r.$(".modal").html(e[0]), r.populatePlaceholders(n)
                    })
                } else this.$el.trigger("modalClose")
            },
            populatePlaceholders: function(e) {
                e.getCategory() !== "undefined" && this.$(".placeholder-category").html(t.template(u)({
                    catId: e.getCategory(),
                    catTitle: tlang.categories[e.getCategory()],
                    subcatTitle: e.getSubcategory() !== "undefined" ? tlang.subcategories[e.getSubcategory()].title : ""
                })), this.model.getOcean() !== "" ? this.$(".placeholder-ocean").html(t.template(l)({
                    ocean: this.model.getOcean(),
                    t: tlang
                })) : this.$(".placeholder-ocean").html(tlang.app.title), this.$(".placeholder-layercontrol").html(t.template(a)({
                    id: e.id,
                    title: e.getTitle(),
                    hint: e.getHint(),
                    info: !1,
                    toggable: !1,
                    layerGradient: e.makeLayerGradientKey(),
                    layerCategories: e.makeLayerCategoriesKey(),
                    isActive: e.isActive() || e.isBasemap(),
                    keyHtml: e.getKeySquareIcon("sm"),
                    t: tlang
                })), this.$(".placeholder-layer-reference").html(t.template(f)({
                    text: e.getReference()
                }))
            },
            removeURLParam: function(e, t) {
                var n = e.split("?");
                if (n.length >= 2) {
                    var r = encodeURIComponent(t) + "=",
                        i = n[1].split(/[&;]/g);
                    for (var s = i.length; s-- > 0;) i[s].indexOf(r, 0) == 0 && i.splice(s, 1);
                    return i.length > 0 ? n[0] + "?" + i.join("&") : n[0]
                }
                return e
            },
            selectOnClick: function(e) {
                e.preventDefault(), e.target.focus(), e.target.select(), setTimeout(function() {
                    e.target.setSelectionRange(0, 9999)
                }, 1)
            },
            handleModalChange: function() {
                switch (this.model.getModal()) {
                    case "layer":
                        this.loadLayerContent(this.model.getModalId());
                        break;
                    case "share":
                        this.loadShareContent();
                        break;
                    case "print":
                        this.loadPrintContent();
                        break;
                    default:
                        this.$el.trigger("modalClose")
                }
            },
            loadPage: function() {
                var e = this.model.getPath(),
                    t = "page-" + e;
                this.$(".page").hide();
                if (this.$("." + t).length === 0) {
                    this.$el.append('<div class="page ' + t + '"></div>');
                    var n = this;
                    this.model.getPages().findWhere({
                        id: e
                    }).getContent(function(e) {
                        n.$("." + t).append(e)
                    })
                } else this.$("." + t).show()
            },
            handleActive: function() {
                this.model.isActive() ? (this.$el.show(), this.render()) : this.$el.hide()
            },
            handlePathChange: function() {
                this.loadPage()
            },
            shareMap: function(t) {
                function i(e) {}
                t.preventDefault();
                var n;
                lang === "en" ? n = window.location.protocol + "//" + window.location.host + "/" : n = window.location.protocol + "//" + window.location.host + "/" + lang + "/";
                var r = {
                    method: "feed",
                    name: e(document).find("title").text(),
                    caption: "",
                    description: e(document).find("meta[name=description]").attr("content"),
                    link: n + "#!/id/" + this.model.getModalId(),
                    display: "popup",
                    picture: this.model.getPrintURL(),
                    actions: [{
                        name: e(document).find("title").text(),
                        link: n
                    }]
                };
                FB.ui(r, i)
            },
            closeModal: function(e) {
                if (e.target !== e.currentTarget) return;
                e.preventDefault(), e.stopPropagation(), this.$el.trigger("modalClose")
            },
            toggleLayer: function(e) {
                e.preventDefault(), e.stopPropagation()
            }
        });
        return c
    }), define("components/app/modal/ModalModel", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.Model.extend({
            initialize: function(e) {
                this.options = e || {}
            },
            getLayers: function() {
                return this.attributes.layers
            },
            getModal: function() {
                return this.attributes.modal
            },
            getOcean: function() {
                return this.attributes.ocean
            },
            getModalId: function() {
                return this.attributes.modalid
            },
            setPrintURL: function(e) {
                this.set("printURL", e)
            },
            getPrintURL: function() {
                return this.attributes.printURL
            },
            getPath: function() {
                return this.attributes.path
            },
            getPages: function() {
                return this.attributes.pages
            },
            setActive: function(e) {
                e = typeof e != "undefined" ? e : !0, this.set("active", e)
            },
            isActive: function() {
                return this.get("active")
            }
        });
        return r
    }), define("text!components/app/layers/layerCategory/layerCategoryTemplate.html", [], function() {
        return '<div class="content-wrap">\r\n  <div class="panel-header content-container text-center">\r\n    <a href="#" class="icon-wwf_close close-item visible-xs ocean-bgcolor"></a>\r\n    <h3><%= t.oceans[ocean] %></h3>\r\n      </div>\r\n  <div class="waves"></div>   \r\n  <div class="layer-container content-container">\r\n    \r\n    <%= catNav %>\r\n\r\n    \r\n    <ul class="list-unstyled">\r\n  <% _.each(grouped, function(groups,subcategory){ %>\r\n    <% if (subcategory !== \'undefined\') { %>\r\n      <li class="layer-subcategory">\r\n        <h3><%= typeof t.subcategories[subcategory] !== \'undefined\' ? t.subcategories[subcategory].title : subcategory %></h3>\r\n        <div class="subcategory-disclaimer">\r\n          <%= typeof t.subcategories[subcategory] !== \'undefined\' ? t.subcategories[subcategory].disclaimer : \'\' %>\r\n        </div>\r\n        <ul class="layer-select-list list-unstyled">\r\n    <% } %>\r\n    <% _.each(groups, function(layers,group){ %>\r\n      <% if (group === \'undefined\'){ %>\r\n        <% _.each(layers, function(layer){ %>\r\n          <li class="layer-group layer-group-undefined">\r\n            <table class="table-layer-select <%= layer.isModuleDefault() ? \'module-default\' : \'\' %>"><tbody>\r\n              <tr class="layer-key-main">\r\n                <td class="toggle">\r\n                  <a href="#" class="toggle-layer <%= layer.isActive() ? \'active\' : \'\' %>"\r\n                     data-layerid="<%= layer.id %>">\r\n                    <span class="icon-wwf_tick show-on-active"></span>\r\n                  </a>\r\n                </td>\r\n                <td class="title">\r\n                  <a href="#" class="toggle-layer <%= layer.isActive() ? \'active\' : \'\' %>" \r\n                     data-layerid="<%= layer.id %>">\r\n                    <div class="title-inner"><%= layer.getTitle() %></div>\r\n                  </a>\r\n                  <% if(layer.getHint() !== \'\') { %>\r\n                  <div class="hint">\r\n                    <%= layer.getHint() %>\r\n                  </div>\r\n                  <% } %>\r\n                </td>\r\n                <td class="key">\r\n                  <%= layer.getKeySquareIcon(\'sm\') %>\r\n                </td>\r\n              </tr></tbody>\r\n            </table>\r\n          </li>\r\n        <% }) %>\r\n      <% }  %>\r\n    <% }) %>      \r\n    <% _.each(groups, function(layers,group){ %>\r\n      <% if (group !== \'undefined\'){ %>      \r\n        <% var groupActive = _.reduce(layers, function(memo, layer){return memo && layer.isActive()}, true) %>\r\n          <li class="layer-group">\r\n            <h4><%= t.groups[group]%></h4>\r\n            <ul class="layer-select-list list-unstyled">\r\n        <% _.each(layers, function(layer){ %>\r\n              <li class="layer-select-list-item">\r\n                <table class="table-layer-select <%= layer.isModuleDefault() ? \'module-default\' : \'\' %>"><tbody>\r\n                  <tr class="layer-key-main">\r\n                    <td class="toggle">\r\n                      <a href="#" class="toggle-layer <%= layer.isActive() ? \'active\' : \'\' %>"\r\n                        data-layerid="<%= layer.id %>">\r\n                        <span class="icon-wwf_tick show-on-active"></span>\r\n                      </a>\r\n                    </td>\r\n                    <td class="title">\r\n                      <a href="#"\r\n                        class="toggle-layer <% if (layer.isActive()) { %> active<% }%>"\r\n                        data-layerid="<%= layer.id %>">\r\n                        <div class="title-inner"><%= layer.getTitle() %></div>\r\n                      </a>\r\n                      <% if(layer.getHint() !== \'\') { %>\r\n                      <div class="hint">\r\n                        <%= layer.getHint() %>\r\n                      </div>\r\n                      <% } %>\r\n                    </td>\r\n                      <td class="key">\r\n                      <%= layer.getKeySquareIcon(\'sm\') %>\r\n                    </td>\r\n                  </tr></tbody>\r\n                </table>\r\n              </li>\r\n        <% }) %>\r\n            </ul>\r\n          </li>\r\n      <% } %>\r\n    <% }) %>\r\n    <% if (subcategory !== \'undefined\') { %>\r\n        </ul>\r\n      </li>\r\n    <% } %>\r\n  <% }) %>\r\n    </ul>\r\n  </div>\r\n</div>\r\n'
    }), define("components/app/layers/layerCategory/LayerCategoryView", ["jquery", "underscore", "backbone", "text!./layerCategoryTemplate.html", "text!templates/categoryNavigationTemplate.html"], function(e, t, n, r, i) {
        var s = n.View.extend({
            events: {
                "click .toggle-layer": "toggleLayer",
                "click .layer-info-link": "handleLayerInfoLink",
                "click .print-map": "handlePrintMap",
                "click .close-item": "closeCategory"
            },
            initialize: function() {
                this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:activeLayerIds", this.handleActiveLayersUpdate), this.listenTo(this.model, "change:categories", this.handleActiveLayersUpdate)
            },
            render: function() {
                var n = t.groupBy(this.model.getLayers().models, function(e) {
                        return e.getSubcategory()
                    }),
                    s = {};
                t.each(n, function(e, n) {
                    s[n] = t.groupBy(e, function(e) {
                        return e.getGroup()
                    })
                }), this.$el.html(t.template(r)({
                    category: this.model.getCategory(),
                    catNav: t.template(i)({
                        categories: this.model.getCategories(),
                        t: tlang,
                        category: this.model.getCategory()
                    }),
                    ocean: this.model.getOcean(),
                    grouped: s,
                    lang: lang,
                    t: tlang
                }));
                var o = this;
                return e(function() {
                    o.$('[data-toggle="tooltip"]').tooltip()
                }), this
            },
            handleActive: function() {
                this.model.isActive() ? (this.render(), this.$el.show()) : this.$el.hide()
            },
            handleActiveLayersUpdate: function() {
                this.render()
            },
            closeCategory: function(e) {
                e.preventDefault(), e.stopPropagation(), this.$el.trigger("layerCategoryClose")
            },
            toggleLayer: function(t) {
                t.preventDefault(), t.stopPropagation(), this.$el.trigger("layerToggled", {
                    id: e(t.currentTarget).data("layerid")
                })
            },
            toggleLayerGroup: function(t) {
                t.preventDefault(), this.$el.trigger("layerGroupToggled", {
                    group: e(t.currentTarget).data("groupid"),
                    active: !e(t.currentTarget).data("active")
                })
            },
            handleLayerInfoLink: function(t) {
                t.preventDefault(), this.$el.trigger("layerInfoLinkClick", {
                    target: t.target,
                    id: e(t.target).data("layerid")
                })
            },
            handlePrintMap: function(e) {
                e.preventDefault(), this.$el.trigger("printMapModal")
            }
        });
        return s
    }), define("components/app/layers/layerCategory/LayerCategoryModel", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.Model.extend({
            initialize: function(e) {
                this.options = e || {}
            },
            setActive: function(e) {
                e = typeof e != "undefined" ? e : !0, this.set("active", e)
            },
            isActive: function() {
                return this.get("active")
            },
            getCategory: function() {
                return this.attributes.category
            },
            getCategories: function() {
                return this.attributes.categories
            },
            setCategories: function(e) {
                this.set("categories", e)
            },
            getLayers: function() {
                return this.attributes.layers
            },
            setLayers: function(e) {
                this.set("layers", e)
            },
            setActiveLayerIds: function(e) {
                this.set("activeLayerIds", e)
            },
            getOcean: function() {
                return this.attributes.ocean
            }
        });
        return r
    }),
    function(e) {
        "use strict";
        typeof define == "function" && define.amd ? define("jquery.spectrum", ["jquery"], e) : typeof exports == "object" && typeof module == "object" ? module.exports = e(require("jquery")) : e(jQuery)
    }(function(e, t) {
        "use strict";

        function a(t, n, r, i) {
            var o = [];
            for (var u = 0; u < t.length; u++) {
                var a = t[u];
                if (a) {
                    var f = tinycolor(a),
                        l = f.toHsl().l < .5 ? "sp-thumb-el sp-thumb-dark" : "sp-thumb-el sp-thumb-light";
                    l += tinycolor.equals(n, a) ? " sp-thumb-active" : "";
                    var c = f.toString(i.preferredFormat || "rgb"),
                        h = s ? "background-color:" + f.toRgbString() : "filter:" + f.toFilter();
                    o.push('<span title="' + c + '" data-color="' + f.toRgbString() + '" class="' + l + '"><span class="sp-thumb-inner" style="' + h + ';" /></span>')
                } else {
                    var p = "sp-clear-display";
                    o.push(e("<div />").append(e('<span data-color="" style="background-color:transparent;" class="' + p + '"></span>').attr("title", i.noColorSelectedText)).html())
                }
            }
            return "<div class='sp-cf " + r + "'>" + o.join("") + "</div>"
        }

        function f() {
            for (var e = 0; e < r.length; e++) r[e] && r[e].hide()
        }

        function l(t, r) {
            var i = e.extend({}, n, t);
            return i.callbacks = {
                move: v(i.move, r),
                change: v(i.change, r),
                show: v(i.show, r),
                hide: v(i.hide, r),
                beforeShow: v(i.beforeShow, r)
            }, i
        }

        function c(n, c) {
            function Tt() {
                p.showPaletteOnly && (p.showPalette = !0), ct.text(p.showPaletteOnly ? p.togglePaletteMoreText : p.togglePaletteLessText);
                if (p.palette) {
                    F = p.palette.slice(0), I = e.isArray(F[0]) ? F : [F], q = {};
                    for (var t = 0; t < I.length; t++)
                        for (var n = 0; n < I[t].length; n++) {
                            var r = tinycolor(I[t][n]).toRgbString();
                            q[r] = !0
                        }
                }
                Q.toggleClass("sp-flat", v), Q.toggleClass("sp-input-disabled", !p.showInput), Q.toggleClass("sp-alpha-enabled", p.showAlpha), Q.toggleClass("sp-clear-enabled", xt), Q.toggleClass("sp-buttons-disabled", !p.showButtons), Q.toggleClass("sp-palette-buttons-disabled", !p.togglePaletteOnly), Q.toggleClass("sp-palette-disabled", !p.showPalette), Q.toggleClass("sp-palette-only", p.showPaletteOnly), Q.toggleClass("sp-initial-disabled", !p.showInitial), Q.addClass(p.className).addClass(p.containerClassName), $t()
            }

            function Nt() {
                function n(t) {
                    return t.data && t.data.ignore ? (qt(e(t.target).closest(".sp-thumb-el").data("color")), zt()) : (qt(e(t.target).closest(".sp-thumb-el").data("color")), zt(), Vt(!0), p.hideAfterPaletteSelect && Ft()), !1
                }
                i && Q.find("*:not(input)").attr("unselectable", "on"), Tt(), dt && J.after(vt).hide(), xt || ft.hide();
                if (v) J.after(Q).hide();
                else {
                    var t = p.appendTo === "parent" ? J.parent() : e(p.appendTo);
                    t.length !== 1 && (t = e("body")), t.append(Q)
                }
                Ct(), mt.bind("click.spectrum touchstart.spectrum", function(t) {
                    K || Pt(), t.stopPropagation(), e(t.target).is("input") || t.preventDefault()
                }), (J.is(":disabled") || p.disabled === !0) && Gt(), Q.click(d), st.change(Dt), st.bind("paste", function() {
                    setTimeout(Dt, 1)
                }), st.keydown(function(e) {
                    e.keyCode == 13 && Dt()
                }), at.text(p.cancelText), at.bind("click.spectrum", function(e) {
                    e.stopPropagation(), e.preventDefault(), It(), Ft()
                }), ft.attr("title", p.clearText), ft.bind("click.spectrum", function(e) {
                    e.stopPropagation(), e.preventDefault(), St = !0, zt(), v && Vt(!0)
                }), lt.text(p.chooseText), lt.bind("click.spectrum", function(e) {
                    e.stopPropagation(), e.preventDefault(), i && st.is(":focus") && st.trigger("change"), Ut() && (Vt(!0), Ft())
                }), ct.text(p.showPaletteOnly ? p.togglePaletteMoreText : p.togglePaletteLessText), ct.bind("click.spectrum", function(e) {
                    e.stopPropagation(), e.preventDefault(), p.showPaletteOnly = !p.showPaletteOnly, !p.showPaletteOnly && !v && Q.css("left", "-=" + (G.outerWidth(!0) + 5)), Tt()
                }), m(rt, function(e, t, n) {
                    j = e / M, St = !1, n.shiftKey && (j = Math.round(j * 10) / 10), zt()
                }, Mt, _t), m(et, function(e, t) {
                    P = parseFloat(t / A), St = !1, p.showAlpha || (j = 1), zt()
                }, Mt, _t), m(Y, function(e, t, n) {
                    if (!n.shiftKey) W = null;
                    else if (!W) {
                        var r = H * C,
                            i = k - B * k,
                            s = Math.abs(e - r) > Math.abs(t - i);
                        W = s ? "x" : "y"
                    }
                    var o = !W || W === "x",
                        u = !W || W === "y";
                    o && (H = parseFloat(e / C)), u && (B = parseFloat((k - t) / k)), St = !1, p.showAlpha || (j = 1), zt()
                }, Mt, _t), yt ? (qt(yt), Wt(), wt = p.preferredFormat || tinycolor(yt).format, kt(yt)) : Wt(), v && Ht();
                var r = i ? "mousedown.spectrum" : "click.spectrum touchstart.spectrum";
                ot.delegate(".sp-thumb-el", r, n), ut.delegate(".sp-thumb-el:nth-child(1)", r, {
                    ignore: !0
                }, n)
            }

            function Ct() {
                if (w && window.localStorage) {
                    try {
                        var t = window.localStorage[w].split(",#");
                        t.length > 1 && (delete window.localStorage[w], e.each(t, function(e, t) {
                            kt(t)
                        }))
                    } catch (n) {}
                    try {
                        R = window.localStorage[w].split(";")
                    } catch (n) {}
                }
            }

            function kt(t) {
                if (b) {
                    var n = tinycolor(t).toRgbString();
                    if (!q[n] && e.inArray(n, R) === -1) {
                        R.push(n);
                        while (R.length > U) R.shift()
                    }
                    if (w && window.localStorage) try {
                        window.localStorage[w] = R.join(";")
                    } catch (r) {}
                }
            }

            function Lt() {
                var e = [];
                if (p.showPalette)
                    for (var t = 0; t < R.length; t++) {
                        var n = tinycolor(R[t]).toRgbString();
                        q[n] || e.push(R[t])
                    }
                return e.reverse().slice(0, p.maxSelectionSize)
            }

            function At() {
                var t = Rt(),
                    n = e.map(I, function(e, n) {
                        return a(e, t, "sp-palette-row sp-palette-row-" + n, p)
                    });
                Ct(), R && n.push(a(Lt(), t, "sp-palette-row sp-palette-row-selection", p)), ot.html(n.join(""))
            }

            function Ot() {
                if (p.showInitial) {
                    var e = bt,
                        t = Rt();
                    ut.html(a([e, t], t, "sp-palette-row-initial", p))
                }
            }

            function Mt() {
                (k <= 0 || C <= 0 || A <= 0) && $t(), N = !0, Q.addClass(z), W = null, J.trigger("dragstart.spectrum", [Rt()])
            }

            function _t() {
                N = !1, Q.removeClass(z), J.trigger("dragstop.spectrum", [Rt()])
            }

            function Dt() {
                var e = st.val();
                if (e !== null && e !== "" || !xt) {
                    var t = tinycolor(e);
                    t.isValid() ? (qt(t), Vt(!0)) : st.addClass("sp-validation-error")
                } else qt(null), Vt(!0)
            }

            function Pt() {
                T ? Ft() : Ht()
            }

            function Ht() {
                var t = e.Event("beforeShow.spectrum");
                if (T) {
                    $t();
                    return
                }
                J.trigger(t, [Rt()]);
                if (S.beforeShow(Rt()) === !1 || t.isDefaultPrevented()) return;
                f(), T = !0, e(X).bind("keydown.spectrum", Bt), e(X).bind("click.spectrum", jt), e(window).bind("resize.spectrum", x), vt.addClass("sp-active"), Q.removeClass("sp-hidden"), $t(), Wt(), bt = Rt(), Ot(), S.show(bt), J.trigger("show.spectrum", [bt])
            }

            function Bt(e) {
                e.keyCode === 27 && Ft()
            }

            function jt(e) {
                if (e.button == 2) return;
                if (N) return;
                Et ? Vt(!0) : It(), Ft()
            }

            function Ft() {
                if (!T || v) return;
                T = !1, e(X).unbind("keydown.spectrum", Bt), e(X).unbind("click.spectrum", jt), e(window).unbind("resize.spectrum", x), vt.removeClass("sp-active"), Q.addClass("sp-hidden"), S.hide(Rt()), J.trigger("hide.spectrum", [Rt()])
            }

            function It() {
                qt(bt, !0)
            }

            function qt(e, t) {
                if (tinycolor.equals(e, Rt())) {
                    Wt();
                    return
                }
                var n, r;
                !e && xt ? St = !0 : (St = !1, n = tinycolor(e), r = n.toHsv(), P = r.h % 360 / 360, H = r.s, B = r.v, j = r.a), Wt(), n && n.isValid() && !t && (wt = p.preferredFormat || n.getFormat())
            }

            function Rt(e) {
                return e = e || {}, xt && St ? null : tinycolor.fromRatio({
                    h: P,
                    s: H,
                    v: B,
                    a: Math.round(j * 100) / 100
                }, {
                    format: e.format || wt
                })
            }

            function Ut() {
                return !st.hasClass("sp-validation-error")
            }

            function zt() {
                Wt(), S.move(Rt()), J.trigger("move.spectrum", [Rt()])
            }

            function Wt() {
                st.removeClass("sp-validation-error"), Xt();
                var e = tinycolor.fromRatio({
                    h: P,
                    s: 1,
                    v: 1
                });
                Y.css("background-color", e.toHexString());
                var t = wt;
                j < 1 && (j !== 0 || t !== "name") && (t === "hex" || t === "hex3" || t === "hex6" || t === "name") && (t = "rgb");
                var n = Rt({
                        format: t
                    }),
                    r = "";
                gt.removeClass("sp-clear-display"), gt.css("background-color", "transparent");
                if (!n && xt) gt.addClass("sp-clear-display");
                else {
                    var o = n.toHexString(),
                        u = n.toRgbString();
                    s || n.alpha === 1 ? gt.css("background-color", u) : (gt.css("background-color", "transparent"), gt.css("filter", n.toFilter()));
                    if (p.showAlpha) {
                        var a = n.toRgb();
                        a.a = 0;
                        var f = tinycolor(a).toRgbString(),
                            l = "linear-gradient(left, " + f + ", " + o + ")";
                        i ? nt.css("filter", tinycolor(f).toFilter({
                            gradientType: 1
                        }, o)) : (nt.css("background", "-webkit-" + l), nt.css("background", "-moz-" + l), nt.css("background", "-ms-" + l), nt.css("background", "linear-gradient(to right, " + f + ", " + o + ")"))
                    }
                    r = n.toString(t)
                }
                p.showInput && st.val(r), p.showPalette && At(), Ot()
            }

            function Xt() {
                var e = H,
                    t = B;
                if (xt && St) it.hide(), tt.hide(), Z.hide();
                else {
                    it.show(), tt.show(), Z.show();
                    var n = e * C,
                        r = k - t * k;
                    n = Math.max(-L, Math.min(C - L, n - L)), r = Math.max(-L, Math.min(k - L, r - L)), Z.css({
                        top: r + "px",
                        left: n + "px"
                    });
                    var i = j * M;
                    it.css({
                        left: i - _ / 2 + "px"
                    });
                    var s = P * A;
                    tt.css({
                        top: s - D + "px"
                    })
                }
            }

            function Vt(e) {
                var t = Rt(),
                    n = "",
                    r = !tinycolor.equals(t, bt);
                t && (n = t.toString(wt), kt(t)), ht && J.val(n), e && r && (S.change(t), J.trigger("change", [t]))
            }

            function $t() {
                if (!T) return;
                C = Y.width(), k = Y.height(), L = Z.height(), O = et.width(), A = et.height(), D = tt.height(), M = rt.width(), _ = it.width(), v || (Q.css("position", "absolute"), p.offset ? Q.offset(p.offset) : Q.offset(h(Q, mt))), Xt(), p.showPalette && At(), J.trigger("reflow.spectrum")
            }

            function Jt() {
                J.show(), mt.unbind("click.spectrum touchstart.spectrum"), Q.remove(), vt.remove(), r[Zt.id] = null
            }

            function Kt(n, r) {
                if (n === t) return e.extend({}, p);
                if (r === t) return p[n];
                p[n] = r, n === "preferredFormat" && (wt = p.preferredFormat), Tt()
            }

            function Qt() {
                K = !1, J.attr("disabled", !1), mt.removeClass("sp-disabled")
            }

            function Gt() {
                Ft(), K = !0, J.attr("disabled", !0), mt.addClass("sp-disabled")
            }

            function Yt(e) {
                p.offset = e, $t()
            }
            var p = l(c, n),
                v = p.flat,
                b = p.showSelectionPalette,
                w = p.localStorageKey,
                E = p.theme,
                S = p.callbacks,
                x = g($t, 10),
                T = !1,
                N = !1,
                C = 0,
                k = 0,
                L = 0,
                A = 0,
                O = 0,
                M = 0,
                _ = 0,
                D = 0,
                P = 0,
                H = 0,
                B = 0,
                j = 1,
                F = [],
                I = [],
                q = {},
                R = p.selectionPalette.slice(0),
                U = p.maxSelectionSize,
                z = "sp-dragging",
                W = null,
                X = n.ownerDocument,
                V = X.body,
                J = e(n),
                K = !1,
                Q = e(u, X).addClass(E),
                G = Q.find(".sp-picker-container"),
                Y = Q.find(".sp-color"),
                Z = Q.find(".sp-dragger"),
                et = Q.find(".sp-hue"),
                tt = Q.find(".sp-slider"),
                nt = Q.find(".sp-alpha-inner"),
                rt = Q.find(".sp-alpha"),
                it = Q.find(".sp-alpha-handle"),
                st = Q.find(".sp-input"),
                ot = Q.find(".sp-palette"),
                ut = Q.find(".sp-initial"),
                at = Q.find(".sp-cancel"),
                ft = Q.find(".sp-clear"),
                lt = Q.find(".sp-choose"),
                ct = Q.find(".sp-palette-toggle"),
                ht = J.is("input"),
                pt = ht && J.attr("type") === "color" && y(),
                dt = ht && !v,
                vt = dt ? e(o).addClass(E).addClass(p.className).addClass(p.replacerClassName) : e([]),
                mt = dt ? vt : J,
                gt = vt.find(".sp-preview-inner"),
                yt = p.color || ht && J.val(),
                bt = !1,
                wt = p.preferredFormat,
                Et = !p.showButtons || p.clickoutFiresChange,
                St = !yt,
                xt = p.allowEmpty && !pt;
            Nt();
            var Zt = {
                show: Ht,
                hide: Ft,
                toggle: Pt,
                reflow: $t,
                option: Kt,
                enable: Qt,
                disable: Gt,
                offset: Yt,
                set: function(e) {
                    qt(e), Vt()
                },
                get: Rt,
                destroy: Jt,
                container: Q
            };
            return Zt.id = r.push(Zt) - 1, Zt
        }

        function h(t, n) {
            var r = 0,
                i = t.outerWidth(),
                s = t.outerHeight(),
                o = n.outerHeight(),
                u = t[0].ownerDocument,
                a = u.documentElement,
                f = a.clientWidth + e(u).scrollLeft(),
                l = a.clientHeight + e(u).scrollTop(),
                c = n.offset();
            return c.top += o, c.left -= Math.min(c.left, c.left + i > f && f > i ? Math.abs(c.left + i - f) : 0), c.top -= Math.min(c.top, c.top + s > l && l > s ? Math.abs(s + o - r) : r), c
        }

        function p() {}

        function d(e) {
            e.stopPropagation()
        }

        function v(e, t) {
            var n = Array.prototype.slice,
                r = n.call(arguments, 2);
            return function() {
                return e.apply(t, r.concat(n.call(arguments)))
            }
        }

        function m(t, n, r, s) {
            function p(e) {
                e.stopPropagation && e.stopPropagation(), e.preventDefault && e.preventDefault(), e.returnValue = !1
            }

            function d(e) {
                if (u) {
                    if (i && o.documentMode < 9 && !e.button) return m();
                    var r = e.originalEvent && e.originalEvent.touches && e.originalEvent.touches[0],
                        s = r && r.pageX || e.pageX,
                        h = r && r.pageY || e.pageY,
                        d = Math.max(0, Math.min(s - a.left, l)),
                        v = Math.max(0, Math.min(h - a.top, f));
                    c && p(e), n.apply(t, [d, v, e])
                }
            }

            function v(n) {
                var i = n.which ? n.which == 3 : n.button == 2;
                !i && !u && r.apply(t, arguments) !== !1 && (u = !0, f = e(t).height(), l = e(t).width(), a = e(t).offset(), e(o).bind(h), e(o.body).addClass("sp-dragging"), d(n), p(n))
            }

            function m() {
                u && (e(o).unbind(h), e(o.body).removeClass("sp-dragging"), setTimeout(function() {
                    s.apply(t, arguments)
                }, 0)), u = !1
            }
            n = n || function() {}, r = r || function() {}, s = s || function() {};
            var o = document,
                u = !1,
                a = {},
                f = 0,
                l = 0,
                c = "ontouchstart" in window,
                h = {};
            h.selectstart = p, h.dragstart = p, h["touchmove mousemove"] = d, h["touchend mouseup"] = m, e(t).bind("touchstart mousedown", v)
        }

        function g(e, t, n) {
            var r;
            return function() {
                var i = this,
                    s = arguments,
                    o = function() {
                        r = null, e.apply(i, s)
                    };
                n && clearTimeout(r);
                if (n || !r) r = setTimeout(o, t)
            }
        }

        function y() {
            return e.fn.spectrum.inputTypeColorSupport()
        }
        var n = {
                beforeShow: p,
                move: p,
                change: p,
                show: p,
                hide: p,
                color: !1,
                flat: !1,
                showInput: !1,
                allowEmpty: !1,
                showButtons: !0,
                clickoutFiresChange: !0,
                showInitial: !1,
                showPalette: !1,
                showPaletteOnly: !1,
                hideAfterPaletteSelect: !1,
                togglePaletteOnly: !1,
                showSelectionPalette: !0,
                localStorageKey: !1,
                appendTo: "body",
                maxSelectionSize: 7,
                cancelText: "cancel",
                chooseText: "choose",
                togglePaletteMoreText: "more",
                togglePaletteLessText: "less",
                clearText: "Clear Color Selection",
                noColorSelectedText: "No Color Selected",
                preferredFormat: !1,
                className: "",
                containerClassName: "",
                replacerClassName: "",
                showAlpha: !1,
                theme: "sp-light",
                palette: [
                    ["#ffffff", "#000000", "#ff0000", "#ff8000", "#ffff00", "#008000", "#0000ff", "#4b0082", "#9400d3"]
                ],
                selectionPalette: [],
                disabled: !1,
                offset: null
            },
            r = [],
            i = !!/msie/i.exec(window.navigator.userAgent),
            s = function() {
                function e(e, t) {
                    return !!~("" + e).indexOf(t)
                }
                var t = document.createElement("div"),
                    n = t.style;
                return n.cssText = "background-color:rgba(0,0,0,.5)", e(n.backgroundColor, "rgba") || e(n.backgroundColor, "hsla")
            }(),
            o = ["<div class='sp-replacer'>", "<div class='sp-preview'><div class='sp-preview-inner'></div></div>", "<div class='sp-dd'>&#9660;</div>", "</div>"].join(""),
            u = function() {
                var e = "";
                if (i)
                    for (var t = 1; t <= 6; t++) e += "<div class='sp-" + t + "'></div>";
                return ["<div class='sp-container sp-hidden'>", "<div class='sp-palette-container'>", "<div class='sp-palette sp-thumb sp-cf'></div>", "<div class='sp-palette-button-container sp-cf'>", "<button type='button' class='sp-palette-toggle'></button>", "</div>", "</div>", "<div class='sp-picker-container'>", "<div class='sp-top sp-cf'>", "<div class='sp-fill'></div>", "<div class='sp-top-inner'>", "<div class='sp-color'>", "<div class='sp-sat'>", "<div class='sp-val'>", "<div class='sp-dragger'></div>", "</div>", "</div>", "</div>", "<div class='sp-clear sp-clear-display'>", "</div>", "<div class='sp-hue'>", "<div class='sp-slider'></div>", e, "</div>", "</div>", "<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>", "</div>", "<div class='sp-input-container sp-cf'>", "<input class='sp-input' type='text' spellcheck='false'  />", "</div>", "<div class='sp-initial sp-thumb sp-cf'></div>", "<div class='sp-button-container sp-cf'>", "<a class='sp-cancel' href='#'></a>", "<button type='button' class='sp-choose'></button>", "</div>", "</div>", "</div>"].join("")
            }(),
            b = "spectrum.id";
        e.fn.spectrum = function(t, n) {
                if (typeof t == "string") {
                    var i = this,
                        s = Array.prototype.slice.call(arguments, 1);
                    return this.each(function() {
                        var n = r[e(this).data(b)];
                        if (n) {
                            var o = n[t];
                            if (!o) throw new Error("Spectrum: no such method: '" + t + "'");
                            t == "get" ? i = n.get() : t == "container" ? i = n.container : t == "option" ? i = n.option.apply(n, s) : t == "destroy" ? (n.destroy(), e(this).removeData(b)) : o.apply(n, s)
                        }
                    }), i
                }
                return this.spectrum("destroy").each(function() {
                    var n = e.extend({}, t, e(this).data()),
                        r = c(this, n);
                    e(this).data(b, r.id)
                })
            }, e.fn.spectrum.load = !0, e.fn.spectrum.loadOpts = {}, e.fn.spectrum.draggable = m, e.fn.spectrum.defaults = n, e.fn.spectrum.inputTypeColorSupport = function w() {
                if (typeof w._cachedResult == "undefined") {
                    var t = e("<input type='color'/>")[0];
                    w._cachedResult = t.type === "color" && t.value !== ""
                }
                return w._cachedResult
            }, e.spectrum = {}, e.spectrum.localization = {}, e.spectrum.palettes = {}, e.fn.spectrum.processNativeColorInputs = function() {
                var t = e("input[type=color]");
                t.length && !y() && t.spectrum({
                    preferredFormat: "hex6"
                })
            },
            function() {
                function f(e) {
                    var t = {
                            r: 0,
                            g: 0,
                            b: 0
                        },
                        n = 1,
                        r = !1,
                        i = !1;
                    return typeof e == "string" && (e = W(e)), typeof e == "object" && (e.hasOwnProperty("r") && e.hasOwnProperty("g") && e.hasOwnProperty("b") ? (t = l(e.r, e.g, e.b), r = !0, i = String(e.r).substr(-1) === "%" ? "prgb" : "rgb") : e.hasOwnProperty("h") && e.hasOwnProperty("s") && e.hasOwnProperty("v") ? (e.s = q(e.s), e.v = q(e.v), t = d(e.h, e.s, e.v), r = !0, i = "hsv") : e.hasOwnProperty("h") && e.hasOwnProperty("s") && e.hasOwnProperty("l") && (e.s = q(e.s), e.l = q(e.l), t = h(e.h, e.s, e.l), r = !0, i = "hsl"), e.hasOwnProperty("a") && (n = e.a)), n = D(n), {
                        ok: r,
                        format: e.format || i,
                        r: s(255, o(t.r, 0)),
                        g: s(255, o(t.g, 0)),
                        b: s(255, o(t.b, 0)),
                        a: n
                    }
                }

                function l(e, t, n) {
                    return {
                        r: P(e, 255) * 255,
                        g: P(t, 255) * 255,
                        b: P(n, 255) * 255
                    }
                }

                function c(e, t, n) {
                    e = P(e, 255), t = P(t, 255), n = P(n, 255);
                    var r = o(e, t, n),
                        i = s(e, t, n),
                        u, a, f = (r + i) / 2;
                    if (r == i) u = a = 0;
                    else {
                        var l = r - i;
                        a = f > .5 ? l / (2 - r - i) : l / (r + i);
                        switch (r) {
                            case e:
                                u = (t - n) / l + (t < n ? 6 : 0);
                                break;
                            case t:
                                u = (n - e) / l + 2;
                                break;
                            case n:
                                u = (e - t) / l + 4
                        }
                        u /= 6
                    }
                    return {
                        h: u,
                        s: a,
                        l: f
                    }
                }

                function h(e, t, n) {
                    function o(e, t, n) {
                        return n < 0 && (n += 1), n > 1 && (n -= 1), n < 1 / 6 ? e + (t - e) * 6 * n : n < .5 ? t : n < 2 / 3 ? e + (t - e) * (2 / 3 - n) * 6 : e
                    }
                    var r, i, s;
                    e = P(e, 360), t = P(t, 100), n = P(n, 100);
                    if (t === 0) r = i = s = n;
                    else {
                        var u = n < .5 ? n * (1 + t) : n + t - n * t,
                            a = 2 * n - u;
                        r = o(a, u, e + 1 / 3), i = o(a, u, e), s = o(a, u, e - 1 / 3)
                    }
                    return {
                        r: r * 255,
                        g: i * 255,
                        b: s * 255
                    }
                }

                function p(e, t, n) {
                    e = P(e, 255), t = P(t, 255), n = P(n, 255);
                    var r = o(e, t, n),
                        i = s(e, t, n),
                        u, a, f = r,
                        l = r - i;
                    a = r === 0 ? 0 : l / r;
                    if (r == i) u = 0;
                    else {
                        switch (r) {
                            case e:
                                u = (t - n) / l + (t < n ? 6 : 0);
                                break;
                            case t:
                                u = (n - e) / l + 2;
                                break;
                            case n:
                                u = (e - t) / l + 4
                        }
                        u /= 6
                    }
                    return {
                        h: u,
                        s: a,
                        v: f
                    }
                }

                function d(e, t, n) {
                    e = P(e, 360) * 6, t = P(t, 100), n = P(n, 100);
                    var i = r.floor(e),
                        s = e - i,
                        o = n * (1 - t),
                        u = n * (1 - s * t),
                        a = n * (1 - (1 - s) * t),
                        f = i % 6,
                        l = [n, u, o, o, a, n][f],
                        c = [a, n, n, u, o, o][f],
                        h = [o, o, a, n, n, u][f];
                    return {
                        r: l * 255,
                        g: c * 255,
                        b: h * 255
                    }
                }

                function v(e, t, n, r) {
                    var s = [I(i(e).toString(16)), I(i(t).toString(16)), I(i(n).toString(16))];
                    return r && s[0].charAt(0) == s[0].charAt(1) && s[1].charAt(0) == s[1].charAt(1) && s[2].charAt(0) == s[2].charAt(1) ? s[0].charAt(0) + s[1].charAt(0) + s[2].charAt(0) : s.join("")
                }

                function m(e, t, n, r) {
                    var s = [I(R(r)), I(i(e).toString(16)), I(i(t).toString(16)), I(i(n).toString(16))];
                    return s.join("")
                }

                function g(e, t) {
                    t = t === 0 ? 0 : t || 10;
                    var n = a(e).toHsl();
                    return n.s -= t / 100, n.s = H(n.s), a(n)
                }

                function y(e, t) {
                    t = t === 0 ? 0 : t || 10;
                    var n = a(e).toHsl();
                    return n.s += t / 100, n.s = H(n.s), a(n)
                }

                function b(e) {
                    return a(e).desaturate(100)
                }

                function w(e, t) {
                    t = t === 0 ? 0 : t || 10;
                    var n = a(e).toHsl();
                    return n.l += t / 100, n.l = H(n.l), a(n)
                }

                function E(e, t) {
                    t = t === 0 ? 0 : t || 10;
                    var n = a(e).toRgb();
                    return n.r = o(0, s(255, n.r - i(255 * -(t / 100)))), n.g = o(0, s(255, n.g - i(255 * -(t / 100)))), n.b = o(0, s(255, n.b - i(255 * -(t / 100)))), a(n)
                }

                function S(e, t) {
                    t = t === 0 ? 0 : t || 10;
                    var n = a(e).toHsl();
                    return n.l -= t / 100, n.l = H(n.l), a(n)
                }

                function x(e, t) {
                    var n = a(e).toHsl(),
                        r = (i(n.h) + t) % 360;
                    return n.h = r < 0 ? 360 + r : r, a(n)
                }

                function T(e) {
                    var t = a(e).toHsl();
                    return t.h = (t.h + 180) % 360, a(t)
                }

                function N(e) {
                    var t = a(e).toHsl(),
                        n = t.h;
                    return [a(e), a({
                        h: (n + 120) % 360,
                        s: t.s,
                        l: t.l
                    }), a({
                        h: (n + 240) % 360,
                        s: t.s,
                        l: t.l
                    })]
                }

                function C(e) {
                    var t = a(e).toHsl(),
                        n = t.h;
                    return [a(e), a({
                        h: (n + 90) % 360,
                        s: t.s,
                        l: t.l
                    }), a({
                        h: (n + 180) % 360,
                        s: t.s,
                        l: t.l
                    }), a({
                        h: (n + 270) % 360,
                        s: t.s,
                        l: t.l
                    })]
                }

                function k(e) {
                    var t = a(e).toHsl(),
                        n = t.h;
                    return [a(e), a({
                        h: (n + 72) % 360,
                        s: t.s,
                        l: t.l
                    }), a({
                        h: (n + 216) % 360,
                        s: t.s,
                        l: t.l
                    })]
                }

                function L(e, t, n) {
                    t = t || 6, n = n || 30;
                    var r = a(e).toHsl(),
                        i = 360 / n,
                        s = [a(e)];
                    for (r.h = (r.h - (i * t >> 1) + 720) % 360; --t;) r.h = (r.h + i) % 360, s.push(a(r));
                    return s
                }

                function A(e, t) {
                    t = t || 6;
                    var n = a(e).toHsv(),
                        r = n.h,
                        i = n.s,
                        s = n.v,
                        o = [],
                        u = 1 / t;
                    while (t--) o.push(a({
                        h: r,
                        s: i,
                        v: s
                    })), s = (s + u) % 1;
                    return o
                }

                function _(e) {
                    var t = {};
                    for (var n in e) e.hasOwnProperty(n) && (t[e[n]] = n);
                    return t
                }

                function D(e) {
                    e = parseFloat(e);
                    if (isNaN(e) || e < 0 || e > 1) e = 1;
                    return e
                }

                function P(e, t) {
                    j(e) && (e = "100%");
                    var n = F(e);
                    return e = s(t, o(0, parseFloat(e))), n && (e = parseInt(e * t, 10) / 100), r.abs(e - t) < 1e-6 ? 1 : e % t / parseFloat(t)
                }

                function H(e) {
                    return s(1, o(0, e))
                }

                function B(e) {
                    return parseInt(e, 16)
                }

                function j(e) {
                    return typeof e == "string" && e.indexOf(".") != -1 && parseFloat(e) === 1
                }

                function F(e) {
                    return typeof e == "string" && e.indexOf("%") != -1
                }

                function I(e) {
                    return e.length == 1 ? "0" + e : "" + e
                }

                function q(e) {
                    return e <= 1 && (e = e * 100 + "%"), e
                }

                function R(e) {
                    return Math.round(parseFloat(e) * 255).toString(16)
                }

                function U(e) {
                    return B(e) / 255
                }

                function W(n) {
                    n = n.replace(e, "").replace(t, "").toLowerCase();
                    var r = !1;
                    if (O[n]) n = O[n], r = !0;
                    else if (n == "transparent") return {
                        r: 0,
                        g: 0,
                        b: 0,
                        a: 0,
                        format: "name"
                    };
                    var i;
                    return (i = z.rgb.exec(n)) ? {
                        r: i[1],
                        g: i[2],
                        b: i[3]
                    } : (i = z.rgba.exec(n)) ? {
                        r: i[1],
                        g: i[2],
                        b: i[3],
                        a: i[4]
                    } : (i = z.hsl.exec(n)) ? {
                        h: i[1],
                        s: i[2],
                        l: i[3]
                    } : (i = z.hsla.exec(n)) ? {
                        h: i[1],
                        s: i[2],
                        l: i[3],
                        a: i[4]
                    } : (i = z.hsv.exec(n)) ? {
                        h: i[1],
                        s: i[2],
                        v: i[3]
                    } : (i = z.hsva.exec(n)) ? {
                        h: i[1],
                        s: i[2],
                        v: i[3],
                        a: i[4]
                    } : (i = z.hex8.exec(n)) ? {
                        a: U(i[1]),
                        r: B(i[2]),
                        g: B(i[3]),
                        b: B(i[4]),
                        format: r ? "name" : "hex8"
                    } : (i = z.hex6.exec(n)) ? {
                        r: B(i[1]),
                        g: B(i[2]),
                        b: B(i[3]),
                        format: r ? "name" : "hex"
                    } : (i = z.hex3.exec(n)) ? {
                        r: B(i[1] + "" + i[1]),
                        g: B(i[2] + "" + i[2]),
                        b: B(i[3] + "" + i[3]),
                        format: r ? "name" : "hex"
                    } : !1
                }
                var e = /^[\s,#]+/,
                    t = /\s+$/,
                    n = 0,
                    r = Math,
                    i = r.round,
                    s = r.min,
                    o = r.max,
                    u = r.random,
                    a = function(e, t) {
                        e = e ? e : "", t = t || {};
                        if (e instanceof a) return e;
                        if (!(this instanceof a)) return new a(e, t);
                        var r = f(e);
                        this._originalInput = e, this._r = r.r, this._g = r.g, this._b = r.b, this._a = r.a, this._roundA = i(100 * this._a) / 100, this._format = t.format || r.format, this._gradientType = t.gradientType, this._r < 1 && (this._r = i(this._r)), this._g < 1 && (this._g = i(this._g)), this._b < 1 && (this._b = i(this._b)), this._ok = r.ok, this._tc_id = n++
                    };
                a.prototype = {
                    isDark: function() {
                        return this.getBrightness() < 128
                    },
                    isLight: function() {
                        return !this.isDark()
                    },
                    isValid: function() {
                        return this._ok
                    },
                    getOriginalInput: function() {
                        return this._originalInput
                    },
                    getFormat: function() {
                        return this._format
                    },
                    getAlpha: function() {
                        return this._a
                    },
                    getBrightness: function() {
                        var e = this.toRgb();
                        return (e.r * 299 + e.g * 587 + e.b * 114) / 1e3
                    },
                    setAlpha: function(e) {
                        return this._a = D(e), this._roundA = i(100 * this._a) / 100, this
                    },
                    toHsv: function() {
                        var e = p(this._r, this._g, this._b);
                        return {
                            h: e.h * 360,
                            s: e.s,
                            v: e.v,
                            a: this._a
                        }
                    },
                    toHsvString: function() {
                        var e = p(this._r, this._g, this._b),
                            t = i(e.h * 360),
                            n = i(e.s * 100),
                            r = i(e.v * 100);
                        return this._a == 1 ? "hsv(" + t + ", " + n + "%, " + r + "%)" : "hsva(" + t + ", " + n + "%, " + r + "%, " + this._roundA + ")"
                    },
                    toHsl: function() {
                        var e = c(this._r, this._g, this._b);
                        return {
                            h: e.h * 360,
                            s: e.s,
                            l: e.l,
                            a: this._a
                        }
                    },
                    toHslString: function() {
                        var e = c(this._r, this._g, this._b),
                            t = i(e.h * 360),
                            n = i(e.s * 100),
                            r = i(e.l * 100);
                        return this._a == 1 ? "hsl(" + t + ", " + n + "%, " + r + "%)" : "hsla(" + t + ", " + n + "%, " + r + "%, " + this._roundA + ")"
                    },
                    toHex: function(e) {
                        return v(this._r, this._g, this._b, e)
                    },
                    toHexString: function(e) {
                        return "#" + this.toHex(e)
                    },
                    toHex8: function() {
                        return m(this._r, this._g, this._b, this._a)
                    },
                    toHex8String: function() {
                        return "#" + this.toHex8()
                    },
                    toRgb: function() {
                        return {
                            r: i(this._r),
                            g: i(this._g),
                            b: i(this._b),
                            a: this._a
                        }
                    },
                    toRgbString: function() {
                        return this._a == 1 ? "rgb(" + i(this._r) + ", " + i(this._g) + ", " + i(this._b) + ")" : "rgba(" + i(this._r) + ", " + i(this._g) + ", " + i(this._b) + ", " + this._roundA + ")"
                    },
                    toPercentageRgb: function() {
                        return {
                            r: i(P(this._r, 255) * 100) + "%",
                            g: i(P(this._g, 255) * 100) + "%",
                            b: i(P(this._b, 255) * 100) + "%",
                            a: this._a
                        }
                    },
                    toPercentageRgbString: function() {
                        return this._a == 1 ? "rgb(" + i(P(this._r, 255) * 100) + "%, " + i(P(this._g, 255) * 100) + "%, " + i(P(this._b, 255) * 100) + "%)" : "rgba(" + i(P(this._r, 255) * 100) + "%, " + i(P(this._g, 255) * 100) + "%, " + i(P(this._b, 255) * 100) + "%, " + this._roundA + ")"
                    },
                    toName: function() {
                        return this._a === 0 ? "transparent" : this._a < 1 ? !1 : M[v(this._r, this._g, this._b, !0)] || !1
                    },
                    toFilter: function(e) {
                        var t = "#" + m(this._r, this._g, this._b, this._a),
                            n = t,
                            r = this._gradientType ? "GradientType = 1, " : "";
                        if (e) {
                            var i = a(e);
                            n = i.toHex8String()
                        }
                        return "progid:DXImageTransform.Microsoft.gradient(" + r + "startColorstr=" + t + ",endColorstr=" + n + ")"
                    },
                    toString: function(e) {
                        var t = !!e;
                        e = e || this._format;
                        var n = !1,
                            r = this._a < 1 && this._a >= 0,
                            i = !t && r && (e === "hex" || e === "hex6" || e === "hex3" || e === "name");
                        if (i) return e === "name" && this._a === 0 ? this.toName() : this.toRgbString();
                        e === "rgb" && (n = this.toRgbString()), e === "prgb" && (n = this.toPercentageRgbString());
                        if (e === "hex" || e === "hex6") n = this.toHexString();
                        return e === "hex3" && (n = this.toHexString(!0)), e === "hex8" && (n = this.toHex8String()), e === "name" && (n = this.toName()), e === "hsl" && (n = this.toHslString()), e === "hsv" && (n = this.toHsvString()), n || this.toHexString()
                    },
                    _applyModification: function(e, t) {
                        var n = e.apply(null, [this].concat([].slice.call(t)));
                        return this._r = n._r, this._g = n._g, this._b = n._b, this.setAlpha(n._a), this
                    },
                    lighten: function() {
                        return this._applyModification(w, arguments)
                    },
                    brighten: function() {
                        return this._applyModification(E, arguments)
                    },
                    darken: function() {
                        return this._applyModification(S, arguments)
                    },
                    desaturate: function() {
                        return this._applyModification(g, arguments)
                    },
                    saturate: function() {
                        return this._applyModification(y, arguments)
                    },
                    greyscale: function() {
                        return this._applyModification(b, arguments)
                    },
                    spin: function() {
                        return this._applyModification(x, arguments)
                    },
                    _applyCombination: function(e, t) {
                        return e.apply(null, [this].concat([].slice.call(t)))
                    },
                    analogous: function() {
                        return this._applyCombination(L, arguments)
                    },
                    complement: function() {
                        return this._applyCombination(T, arguments)
                    },
                    monochromatic: function() {
                        return this._applyCombination(A, arguments)
                    },
                    splitcomplement: function() {
                        return this._applyCombination(k, arguments)
                    },
                    triad: function() {
                        return this._applyCombination(N, arguments)
                    },
                    tetrad: function() {
                        return this._applyCombination(C, arguments)
                    }
                }, a.fromRatio = function(e, t) {
                    if (typeof e == "object") {
                        var n = {};
                        for (var r in e) e.hasOwnProperty(r) && (r === "a" ? n[r] = e[r] : n[r] = q(e[r]));
                        e = n
                    }
                    return a(e, t)
                }, a.equals = function(e, t) {
                    return !e || !t ? !1 : a(e).toRgbString() == a(t).toRgbString()
                }, a.random = function() {
                    return a.fromRatio({
                        r: u(),
                        g: u(),
                        b: u()
                    })
                }, a.mix = function(e, t, n) {
                    n = n === 0 ? 0 : n || 50;
                    var r = a(e).toRgb(),
                        i = a(t).toRgb(),
                        s = n / 100,
                        o = s * 2 - 1,
                        u = i.a - r.a,
                        f;
                    o * u == -1 ? f = o : f = (o + u) / (1 + o * u), f = (f + 1) / 2;
                    var l = 1 - f,
                        c = {
                            r: i.r * f + r.r * l,
                            g: i.g * f + r.g * l,
                            b: i.b * f + r.b * l,
                            a: i.a * s + r.a * (1 - s)
                        };
                    return a(c)
                }, a.readability = function(e, t) {
                    var n = a(e),
                        r = a(t),
                        i = n.toRgb(),
                        s = r.toRgb(),
                        o = n.getBrightness(),
                        u = r.getBrightness(),
                        f = Math.max(i.r, s.r) - Math.min(i.r, s.r) + Math.max(i.g, s.g) - Math.min(i.g, s.g) + Math.max(i.b, s.b) - Math.min(i.b, s.b);
                    return {
                        brightness: Math.abs(o - u),
                        color: f
                    }
                }, a.isReadable = function(e, t) {
                    var n = a.readability(e, t);
                    return n.brightness > 125 && n.color > 500
                }, a.mostReadable = function(e, t) {
                    var n = null,
                        r = 0,
                        i = !1;
                    for (var s = 0; s < t.length; s++) {
                        var o = a.readability(e, t[s]),
                            u = o.brightness > 125 && o.color > 500,
                            f = 3 * (o.brightness / 125) + o.color / 500;
                        if (u && !i || u && i && f > r || !u && !i && f > r) i = u, r = f, n = a(t[s])
                    }
                    return n
                };
                var O = a.names = {
                        aliceblue: "f0f8ff",
                        antiquewhite: "faebd7",
                        aqua: "0ff",
                        aquamarine: "7fffd4",
                        azure: "f0ffff",
                        beige: "f5f5dc",
                        bisque: "ffe4c4",
                        black: "000",
                        blanchedalmond: "ffebcd",
                        blue: "00f",
                        blueviolet: "8a2be2",
                        brown: "a52a2a",
                        burlywood: "deb887",
                        burntsienna: "ea7e5d",
                        cadetblue: "5f9ea0",
                        chartreuse: "7fff00",
                        chocolate: "d2691e",
                        coral: "ff7f50",
                        cornflowerblue: "6495ed",
                        cornsilk: "fff8dc",
                        crimson: "dc143c",
                        cyan: "0ff",
                        darkblue: "00008b",
                        darkcyan: "008b8b",
                        darkgoldenrod: "b8860b",
                        darkgray: "a9a9a9",
                        darkgreen: "006400",
                        darkgrey: "a9a9a9",
                        darkkhaki: "bdb76b",
                        darkmagenta: "8b008b",
                        darkolivegreen: "556b2f",
                        darkorange: "ff8c00",
                        darkorchid: "9932cc",
                        darkred: "8b0000",
                        darksalmon: "e9967a",
                        darkseagreen: "8fbc8f",
                        darkslateblue: "483d8b",
                        darkslategray: "2f4f4f",
                        darkslategrey: "2f4f4f",
                        darkturquoise: "00ced1",
                        darkviolet: "9400d3",
                        deeppink: "ff1493",
                        deepskyblue: "00bfff",
                        dimgray: "696969",
                        dimgrey: "696969",
                        dodgerblue: "1e90ff",
                        firebrick: "b22222",
                        floralwhite: "fffaf0",
                        forestgreen: "228b22",
                        fuchsia: "f0f",
                        gainsboro: "dcdcdc",
                        ghostwhite: "f8f8ff",
                        gold: "ffd700",
                        goldenrod: "daa520",
                        gray: "808080",
                        green: "008000",
                        greenyellow: "adff2f",
                        grey: "808080",
                        honeydew: "f0fff0",
                        hotpink: "ff69b4",
                        indianred: "cd5c5c",
                        indigo: "4b0082",
                        ivory: "fffff0",
                        khaki: "f0e68c",
                        lavender: "e6e6fa",
                        lavenderblush: "fff0f5",
                        lawngreen: "7cfc00",
                        lemonchiffon: "fffacd",
                        lightblue: "add8e6",
                        lightcoral: "f08080",
                        lightcyan: "e0ffff",
                        lightgoldenrodyellow: "fafad2",
                        lightgray: "d3d3d3",
                        lightgreen: "90ee90",
                        lightgrey: "d3d3d3",
                        lightpink: "ffb6c1",
                        lightsalmon: "ffa07a",
                        lightseagreen: "20b2aa",
                        lightskyblue: "87cefa",
                        lightslategray: "789",
                        lightslategrey: "789",
                        lightsteelblue: "b0c4de",
                        lightyellow: "ffffe0",
                        lime: "0f0",
                        limegreen: "32cd32",
                        linen: "faf0e6",
                        magenta: "f0f",
                        maroon: "800000",
                        mediumaquamarine: "66cdaa",
                        mediumblue: "0000cd",
                        mediumorchid: "ba55d3",
                        mediumpurple: "9370db",
                        mediumseagreen: "3cb371",
                        mediumslateblue: "7b68ee",
                        mediumspringgreen: "00fa9a",
                        mediumturquoise: "48d1cc",
                        mediumvioletred: "c71585",
                        midnightblue: "191970",
                        mintcream: "f5fffa",
                        mistyrose: "ffe4e1",
                        moccasin: "ffe4b5",
                        navajowhite: "ffdead",
                        navy: "000080",
                        oldlace: "fdf5e6",
                        olive: "808000",
                        olivedrab: "6b8e23",
                        orange: "ffa500",
                        orangered: "ff4500",
                        orchid: "da70d6",
                        palegoldenrod: "eee8aa",
                        palegreen: "98fb98",
                        paleturquoise: "afeeee",
                        palevioletred: "db7093",
                        papayawhip: "ffefd5",
                        peachpuff: "ffdab9",
                        peru: "cd853f",
                        pink: "ffc0cb",
                        plum: "dda0dd",
                        powderblue: "b0e0e6",
                        purple: "800080",
                        rebeccapurple: "663399",
                        red: "f00",
                        rosybrown: "bc8f8f",
                        royalblue: "4169e1",
                        saddlebrown: "8b4513",
                        salmon: "fa8072",
                        sandybrown: "f4a460",
                        seagreen: "2e8b57",
                        seashell: "fff5ee",
                        sienna: "a0522d",
                        silver: "c0c0c0",
                        skyblue: "87ceeb",
                        slateblue: "6a5acd",
                        slategray: "708090",
                        slategrey: "708090",
                        snow: "fffafa",
                        springgreen: "00ff7f",
                        steelblue: "4682b4",
                        tan: "d2b48c",
                        teal: "008080",
                        thistle: "d8bfd8",
                        tomato: "ff6347",
                        turquoise: "40e0d0",
                        violet: "ee82ee",
                        wheat: "f5deb3",
                        white: "fff",
                        whitesmoke: "f5f5f5",
                        yellow: "ff0",
                        yellowgreen: "9acd32"
                    },
                    M = a.hexNames = _(O),
                    z = function() {
                        var e = "[-\\+]?\\d+%?",
                            t = "[-\\+]?\\d*\\.\\d+%?",
                            n = "(?:" + t + ")|(?:" + e + ")",
                            r = "[\\s|\\(]+(" + n + ")[,|\\s]+(" + n + ")[,|\\s]+(" + n + ")\\s*\\)?",
                            i = "[\\s|\\(]+(" + n + ")[,|\\s]+(" + n + ")[,|\\s]+(" + n + ")[,|\\s]+(" + n + ")\\s*\\)?";
                        return {
                            rgb: new RegExp("rgb" + r),
                            rgba: new RegExp("rgba" + i),
                            hsl: new RegExp("hsl" + r),
                            hsla: new RegExp("hsla" + i),
                            hsv: new RegExp("hsv" + r),
                            hsva: new RegExp("hsva" + i),
                            hex3: /^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,
                            hex6: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,
                            hex8: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/
                        }
                    }();
                window.tinycolor = a
            }(), e(function() {
                e.fn.spectrum.load && e.fn.spectrum.processNativeColorInputs()
            })
    }), define("text!components/app/layers/layerCustomCategory/layerCustomCategoryTemplate.html", [], function() {
        return '<div class="content-wrap">\r\n  <div class="panel-header content-container text-center">\r\n    <a href="#" class="icon-wwf_close close-item visible-xs ocean-bgcolor"></a>\r\n    <h3>\r\n      <a href="#" class="ocean-link ocean-color-<%= ocean %> link-large" data-oceanid="<%= ocean %>">\r\n        <%= t.oceans[ocean] %>\r\n      </a>\r\n    </h3>\r\n    <h2><%= t.categories[category] %></h2>\r\n  </div>\r\n  <div class="waves"></div>   \r\n  <div class="layer-container content-container">    \r\n    <%= catNav %>\r\n    <h3><%= t.ux.layers.your_layers %></h3>\r\n    <% if (layers.length > 0) { %>\r\n    <ul class="layer-select-list list-unstyled">\r\n      <% _.each(layers, function(layer){ %>\r\n        <li class="layer-group layer-group-undefined">\r\n          <table class="table-layer-select"><tbody>\r\n            <tr class="layer-key-main">\r\n              <td class="toggle">\r\n                <a href="#" class="toggle-layer <%= layer.isActive() ? \'active\' : \'\' %>"\r\n                   data-layerid="<%= layer.id %>">\r\n                  <span class="icon-wwf_tick show-on-active"></span>\r\n                </a>\r\n              </td>\r\n              <td class="title">\r\n                <% if (layer.isEdit() && editTitle === layer.id) { %>\r\n                <input class="form-control select-on-click ocean-color input-layer-title" \r\n                       type="text" \r\n                       data-layerid="<%= layer.id %>"\r\n                       value="<%= layer.getTitle() %>">\r\n                <% } else { %>\r\n                <a href="#" class="toggle-layer <%= layer.isActive() ? \'active\' : \'\' %>" \r\n                   data-layerid="<%= layer.id %>">\r\n                  <div class="title-inner"><%= layer.getTitle() %></div>\r\n                </a>\r\n                <% } %>\r\n              </td>\r\n             <td class="key">\r\n                <% if (layer.isEdit()) { %>\r\n                <a href="" class="edit-layer-color" data-layerid="<%= layer.id %>">\r\n                <% } %>\r\n                <%= layer.getKeySquareIcon(\'sm\') %>\r\n                <% if (layer.isEdit()) { %></a><% } %>\r\n              </td>\r\n            </tr>                \r\n          <% if (layer.isEdit()) { %>        \r\n            <% if (editTitle === layer.id) { %>   \r\n            <tr class="layer-key-edits">\r\n              <td></td>\r\n              <td>\r\n                <a href="#" class="save-layer-title ocean-bgcolor" data-layerid="<%= layer.id %>">\r\n                  <%= t.ux.layers.confirm %>\r\n                </a>\r\n              </td>\r\n              <td></td>\r\n              <td></td>\r\n              <td></td>\r\n            </tr>\r\n            <% } else if (editColor === layer.id) { %>  \r\n            <tr class="layer-key-edits">\r\n              <td></td>\r\n              <td colspan="4">\r\n                <div class="input-layer-color-wrap">\r\n                  <input type=\'text\' \r\n                     class="input-layer-color" \r\n                     data-layerid="<%= layer.id %>"                   \r\n                     value="<%= layer.getColor() %>"/>\r\n                </div>\r\n                <div class="input-layer-color-cancel-wrap">\r\n                  <a href="#" class="cancel-layer-color ocean-color pull-right " >\r\n                    <%= t.ux.layers.cancel %>\r\n                  </a>\r\n                </div>\r\n              </td>\r\n            </tr>              \r\n            <% } else { %>   \r\n            <tr class="layer-key-edits">\r\n              <td></td>\r\n              <td>\r\n                <a href="#" class="reveal-on-hover pull-left edit-layer-title" data-layerid="<%= layer.id %>">\r\n                  <span class="hide-on-hover hint">\r\n                    <span class="icon-wwf_edit-light"></span>\r\n                    <%= t.ux.layers.edit_title %>\r\n                  </span>\r\n                  <span class="show-on-hover ocean-color">\r\n                    <span class="icon-wwf_edit-<%= ocean %>"></span>\r\n                    <%= t.ux.layers.edit_title %>\r\n                  </span>\r\n                </a>\r\n              </td>\r\n              <td colspan="3">\r\n                <a href="#" class="reveal-on-hover pull-right edit-layer-color ocean-color" data-layerid="<%= layer.id %>">\r\n                  <span class="hide-on-hover hint">\r\n                    <span class="icon-wwf_edit-light"></span>\r\n                    <%= t.ux.layers.edit_color %>\r\n                  </span>\r\n                  <span class="show-on-hover ocean-color">\r\n                    <span class="icon-wwf_edit-<%= ocean %>"></span>\r\n                    <%= t.ux.layers.edit_color %>\r\n                  </span>\r\n                </a>\r\n              </td>\r\n            </tr>            \r\n            <tr class="layer-key-instructions">\r\n              <td></td>\r\n              <td colspan="4">\r\n                <div class="custom-layer-edit-hint hint">\r\n                  <%= t.ux.layers.edit_instructions %>\r\n                </div>\r\n              </td>\r\n            </tr>\r\n            <% } %>                        \r\n          <% } %>            \r\n          </tbody></table>\r\n        </li>\r\n      <% }) %>\r\n    </ul>\r\n    <% } %>\r\n    <a class="add-layer link-large ocean-color" href="#">+ <%= t.ux.layers.add_layer %></a>\r\n    \r\n  </div>\r\n</div>\r\n'
    }), define("components/app/layers/layerCustomCategory/LayerCustomCategoryView", ["jquery", "underscore", "backbone", "jquery.spectrum", "text!./layerCustomCategoryTemplate.html"], function(e, t, n, r, i, s) {
        var o = n.View.extend({
            events: {
                "click .toggle-layer": "toggleLayer",
                "click .edit-layer": "handleLayerEdit",
                "click .edit-layer-title": "handleLayerTitleEdit",
                "click .save-layer-title": "handleLayerTitleSave",
                "click .edit-layer-color": "handleLayerColorEdit",
                "click .cancel-layer-color": "handleLayerColorCancel",
                "click .save-layer-color": "handleLayerColorSave",
                "click .add-layer": "handleLayerAdd",
                "click .remove-layer": "handleLayerRemove",
                "click .print-map": "handlePrintMap",
                "click .close-item": "closeCategory"
            },
            initialize: function() {
                this.listenTo(this.model, "change:layers", this.handleLayersUpdate), this.listenTo(this.model, "change:customData", this.handleLayersUpdate), this.listenTo(this.model, "change:edit", this.handleLayersUpdate), this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:activeLayerIds", this.handleActiveLayersUpdate), this.listenTo(this.model, "change:categories", this.handleActiveLayersUpdate)
            },
            render: function() {
                this.$el.html(t.template(i)({
                    category: this.model.getCategory(),
                    catNav: t.template(s)({
                        categories: this.model.getCategories(),
                        t: tlang,
                        category: this.model.getCategory()
                    }),
                    ocean: this.model.getOcean(),
                    layers: this.model.getLayers().models,
                    editTitle: this.model.getEditTitleId(),
                    editColor: this.model.getEditColorId(),
                    lang: lang,
                    t: tlang
                }));
                if (this.model.getEditTitleId() !== "") {
                    var n = this;
                    this.$(".input-layer-title").on("click", this.selectOnClick).keyup(function(t) {
                        t.keyCode == 13 && e(this).trigger("enterKey")
                    }).bind("enterKey", function(e) {
                        n.handleLayerTitleSave(e)
                    })
                }
                if (this.model.getEditColorId() !== "") {
                    var n = this;
                    this.$(".input-layer-color").spectrum({
                        flat: !0,
                        showInitial: !0,
                        chooseText: tlang.ux.layers.confirm,
                        cancelText: "",
                        clickoutFiresChange: !1
                    }).on("change.spectrum", t.bind(n.handleLayerColorSave, this))
                }
                return this
            },
            selectOnClick: function(e) {
                e.preventDefault(), e.target.focus(), e.target.select(), setTimeout(function() {
                    e.target.setSelectionRange(0, 9999)
                }, 1)
            },
            handleActive: function() {
                this.model.isActive() ? (this.render(), this.$el.show()) : this.$el.hide()
            },
            handleLayersUpdate: function() {
                this.model.setEditTitleId(""), this.model.setEditColorId(""), this.render()
            },
            handleActiveLayersUpdate: function() {
                this.render()
            },
            closeCategory: function(e) {
                e.preventDefault(), e.stopPropagation(), this.$el.trigger("layerCategoryClose")
            },
            toggleLayer: function(t) {
                t.preventDefault(), t.stopPropagation(), this.$el.trigger("layerToggled", {
                    id: e(t.currentTarget).data("layerid")
                })
            },
            handlePrintMap: function(e) {
                e.preventDefault(), this.$el.trigger("printMapModal")
            },
            handleLayerAdd: function(e) {
                e.preventDefault(), this.$el.trigger("addCustomLayer", {
                    ocean: this.model.getOcean()
                })
            },
            handleLayerRemove: function(t) {
                t.preventDefault(), this.$el.trigger("removeCustomLayer", {
                    id: e(t.target).data("layerid")
                })
            },
            handleLayerEdit: function(t) {
                t.preventDefault(), this.$el.trigger("editCustomLayer", {
                    id: e(t.target).data("layerid")
                })
            },
            handleLayerTitleEdit: function(t) {
                t.preventDefault(), this.model.setEditTitleId(e(t.target).closest("a").data("layerid")), this.render()
            },
            handleLayerColorEdit: function(t) {
                t.preventDefault(), this.model.setEditColorId(e(t.target).closest("a").data("layerid")), this.render()
            },
            handleLayerTitleSave: function(t) {
                t.preventDefault();
                var n = e(t.target).data("layerid"),
                    r = this.$(".title input[data-layerid=" + n + "]").val();
                r !== this.model.getLayers().findWhere({
                    id: n
                }).getTitle() ? this.$el.trigger("customUpdated", {
                    layer: {
                        id: n,
                        title: r
                    }
                }) : (this.model.setEditTitleId(""), this.render())
            },
            handleLayerColorSave: function(t, n) {
                t.preventDefault();
                var r = e(t.target).data("layerid"),
                    i = n.toHexString();
                this.$el.trigger("customUpdated", {
                    layer: {
                        id: r,
                        color: i
                    }
                })
            },
            handleLayerColorCancel: function(e, t) {
                e.preventDefault(), this.model.setEditColorId(""), this.render()
            }
        });
        return o
    }), define("components/app/layers/layerCustomCategory/LayerCustomCategoryModel", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.Model.extend({
            initialize: function(e) {
                this.options = e || {}, this.set("editTitleId", ""), this.set("editColorId", "")
            },
            setActive: function(e) {
                e = typeof e != "undefined" ? e : !0, this.set("active", e)
            },
            isActive: function() {
                return this.attributes.active
            },
            getCategory: function() {
                return this.attributes.category
            },
            setCategories: function(e) {
                this.set("categories", e)
            },
            getCategories: function() {
                return this.attributes.categories
            },
            setLayers: function(e) {
                return this.set("layers", e)
            },
            getLayers: function() {
                return this.attributes.layers
            },
            setEdit: function(e) {
                this.set("edit", e)
            },
            setCustomData: function(e) {
                this.set("customData", e)
            },
            getCustomData: function() {
                return this.attributes.customData
            },
            setEditTitleId: function(e) {
                this.set("editTitleId", e)
            },
            getEditTitleId: function() {
                return this.attributes.editTitleId
            },
            setEditColorId: function(e) {
                this.set("editColorId", e)
            },
            getEditColorId: function() {
                return this.attributes.editColorId
            },
            setActiveLayerIds: function(e) {
                this.set("activeLayerIds", e)
            },
            getOcean: function() {
                return this.attributes.ocean
            }
        });
        return r
    }), define("text!templates/categoryCountTemplate.html", [], function() {
        return '<a href="#"\r\n   data-catid=\'<%= cat.value %>\' \r\n   class="cat-layers-remove reveal-on-hover">\r\n  <span class="hide-on-hover"><%= cat.activeCount %></span>\r\n  <span class="show-on-hover icon-wwf_close-menu"></span>\r\n</a>'
    }), define("components/app/layers/layerHome/LayerHomeView", ["jquery", "underscore", "backbone", "text!templates/oceanHeaderTemplate.html", "text!templates/categoryCountTemplate.html"], function(e, t, n, r, i) {
        var s = n.View.extend({
            events: {
                "click .close-item": "closeHome"
            },
            initialize: function() {
                this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:ocean", this.handleOceanChange), this.listenTo(this.model, "change:categories", this.handleCategoriesChange), this.render()
            },
            render: function() {
                var e = this;
                return this.$(".content").html('<span class="loading-animation panel-loading-animation"></span>'), this.model.getContent().getContent(function(t) {
                    e.$(".content").html(""), e.$(".content").append(t), e.$(".content").addClass("layers-home"), e.populatePlaceholders(), e.updateCategoryCounts()
                }), this
            },
            updateCategoryCounts: function() {
                var n = this;
                this.$(".layer-links td a").each(function() {
                    var r = e(this).data("catid"),
                        s = t.findWhere(n.model.getCategories(), {
                            value: r
                        });
                    e(this).find(".cat-layers-remove").remove(), s.activeCount > 0 && e(this).append(t.template(i)({
                        cat: s
                    }))
                })
            },
            populatePlaceholders: function() {
                var e = this.model.getOcean(),
                    n = this;
                waitFor(function() {
                    return n.model.getContent().isContentReady()
                }, function() {
                    n.$(".placeholder-ocean").html(t.template(r)({
                        ocean: e,
                        t: tlang
                    }))
                })
            },
            handleOceanChange: function() {
                this.populatePlaceholders()
            },
            handleCategoriesChange: function() {
                this.updateCategoryCounts()
            },
            handleActive: function() {
                this.model.isActive() ? (this.$el.show(), this.updateCategoryCounts()) : this.$el.hide()
            },
            closeHome: function(e) {
                if (e.target !== e.currentTarget) return;
                e.preventDefault(), e.stopPropagation(), this.$el.addClass("hidden-xs"), this.$el.addClass("hidden-sm")
            },
            handlePageLink: function(t) {
                t.preventDefault(), t.stopPropagation(), this.$el.trigger("pageLinkClick", {
                    target: t.target,
                    id: e(t.target).data("pageid")
                }), e("#navbar-collapse").collapse("hide")
            }
        });
        return s
    }), define("components/app/layers/layerHome/LayerHomeModel", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.Model.extend({
            initialize: function(e) {
                this.options = e || {}
            },
            getContent: function() {
                return this.attributes.content
            },
            getOcean: function() {
                return this.attributes.ocean
            },
            setOcean: function(e) {
                this.set("ocean", e)
            },
            getCategories: function() {
                return this.attributes.categories
            },
            setCategories: function(e) {
                this.set("categories", e)
            },
            setActive: function(e) {
                e = typeof e != "undefined" ? e : !0, this.set("active", e)
            },
            isActive: function() {
                return this.get("active")
            }
        });
        return r
    }), define("components/app/layers/layerItem/LayerItemView", ["jquery", "underscore", "backbone", "text!templates/categoryPlaceholderTemplate.html", "text!templates/layerControlPlaceholderTemplate.html", "text!templates/layerReferencePlaceholderTemplate.html", "text!templates/oceanHeaderTemplate.html"], function(e, t, n, r, i, s, o) {
        var u = n.View.extend({
            events: {
                "click .toggle-layer": "toggleLayer",
                "click .close-item": "closeItem"
            },
            initialize: function() {
                this.listenTo(this.model, "change:activeLayerIds", this.render), this.listenTo(this.model, "change:active", this.handleActive), this.render()
            },
            render: function() {
                var e = this;
                return this.$el.html('<span class="loading-animation panel-loading-animation"></span>'), this.model.getLayer().getContent(function(t) {
                    e.$el.html(""), e.$el.append(t), e.populatePlaceholders()
                }), this
            },
            populatePlaceholders: function() {
                var e = this.model.getLayer();
                e.getCategory() !== "undefined" && this.$(".placeholder-category").html(t.template(r)({
                    catId: e.getCategory(),
                    catTitle: tlang.categories[e.getCategory()],
                    subcatTitle: e.getSubcategory() !== "undefined" ? tlang.subcategories[e.getSubcategory()].title : ""
                })), this.$(".placeholder-ocean").html(t.template(o)({
                    ocean: this.model.getOcean(),
                    t: tlang
                })), this.$(".placeholder-layercontrol").html(t.template(i)({
                    id: e.id,
                    title: e.getTitle(),
                    hint: e.getHint(),
                    info: !1,
                    toggable: !e.isBasemap(),
                    layerGradient: e.makeLayerGradientKey(),
                    layerCategories: e.makeLayerCategoriesKey(),
                    isActive: e.isActive() || e.isBasemap(),
                    keyHtml: e.getKeySquareIcon("sm"),
                    t: tlang
                })), this.$(".placeholder-layer-reference").html(t.template(s)({
                    text: e.getReference().linkify()
                })), this.$(".placeholder-layer-reference").find('a[href^="http"]').attr("target", "_blank")
            },
            handleActive: function() {
                this.model.isActive() ? this.$el.show() : this.$el.hide()
            },
            toggleLayer: function(t) {
                t.preventDefault(), t.stopPropagation(), (e(t.currentTarget).data("toggable") || e(t.currentTarget).data("toggable") === "true") && this.$el.trigger("layerToggled", {
                    id: e(t.currentTarget).data("layerid")
                })
            },
            closeItem: function(e) {
                e.preventDefault(), e.stopPropagation(), this.$el.trigger("closeLayerInfo", {
                    target: e.target,
                    id: this.model.get("layer").id
                })
            }
        });
        return u
    }), define("components/app/layers/layerItem/LayerItemModel", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.Model.extend({
            initialize: function(e) {
                this.options = e || {}
            },
            getLayer: function() {
                return this.attributes.layer
            },
            getOcean: function() {
                return this.attributes.ocean
            },
            setActiveLayerIds: function(e) {
                return this.set("activeLayerIds", e)
            },
            setActive: function(e) {
                e = typeof e != "undefined" ? e : !0, this.set("active", e)
            },
            isActive: function() {
                return this.get("active")
            }
        });
        return r
    }),
    function() {
        function e(e) {
            "use strict";
            var t = {
                omitExtraWLInCodeBlocks: {
                    "default": !1,
                    describe: "Omit the default extra whiteline added to code blocks",
                    type: "boolean"
                },
                noHeaderId: {
                    "default": !1,
                    describe: "Turn on/off generated header id",
                    type: "boolean"
                },
                prefixHeaderId: {
                    "default": !1,
                    describe: "Specify a prefix to generated header ids",
                    type: "string"
                },
                headerLevelStart: {
                    "default": !1,
                    describe: "The header blocks level start",
                    type: "integer"
                },
                parseImgDimensions: {
                    "default": !1,
                    describe: "Turn on/off image dimension parsing",
                    type: "boolean"
                },
                simplifiedAutoLink: {
                    "default": !1,
                    describe: "Turn on/off GFM autolink style",
                    type: "boolean"
                },
                literalMidWordUnderscores: {
                    "default": !1,
                    describe: "Parse midword underscores as literal underscores",
                    type: "boolean"
                },
                strikethrough: {
                    "default": !1,
                    describe: "Turn on/off strikethrough support",
                    type: "boolean"
                },
                tables: {
                    "default": !1,
                    describe: "Turn on/off tables support",
                    type: "boolean"
                },
                tablesHeaderId: {
                    "default": !1,
                    describe: "Add an id to table headers",
                    type: "boolean"
                },
                ghCodeBlocks: {
                    "default": !0,
                    describe: "Turn on/off GFM fenced code blocks support",
                    type: "boolean"
                },
                tasklists: {
                    "default": !1,
                    describe: "Turn on/off GFM tasklist support",
                    type: "boolean"
                },
                smoothLivePreview: {
                    "default": !1,
                    describe: "Prevents weird effects in live previews due to incomplete input",
                    type: "boolean"
                }
            };
            if (e === !1) return JSON.parse(JSON.stringify(t));
            var n = {};
            for (var r in t) t.hasOwnProperty(r) && (n[r] = t[r].default);
            return n
        }

        function o(e, n) {
            "use strict";
            var r = n ? "Error in " + n + " extension->" : "Error in unnamed extension",
                i = {
                    valid: !0,
                    error: ""
                };
            t.helper.isArray(e) || (e = [e]);
            for (var s = 0; s < e.length; ++s) {
                var o = r + " sub-extension " + s + ": ",
                    u = e[s];
                if (typeof u != "object") return i.valid = !1, i.error = o + "must be an object, but " + typeof u + " given", i;
                if (!t.helper.isString(u.type)) return i.valid = !1, i.error = o + 'property "type" must be a string, but ' + typeof u.type + " given", i;
                var a = u.type = u.type.toLowerCase();
                a === "language" && (a = u.type = "lang"), a === "html" && (a = u.type = "output");
                if (a !== "lang" && a !== "output" && a !== "listener") return i.valid = !1, i.error = o + "type " + a + ' is not recognized. Valid values: "lang/language", "output/html" or "listener"', i;
                if (a === "listener") {
                    if (t.helper.isUndefined(u.listeners)) return i.valid = !1, i.error = o + '. Extensions of type "listener" must have a property called "listeners"', i
                } else if (t.helper.isUndefined(u.filter) && t.helper.isUndefined(u.regex)) return i.valid = !1, i.error = o + a + ' extensions must define either a "regex" property or a "filter" method', i;
                if (u.listeners) {
                    if (typeof u.listeners != "object") return i.valid = !1, i.error = o + '"listeners" property must be an object but ' + typeof u.listeners + " given", i;
                    for (var f in u.listeners)
                        if (u.listeners.hasOwnProperty(f) && typeof u.listeners[f] != "function") return i.valid = !1, i.error = o + '"listeners" property must be an hash of [event name]: [callback]. listeners.' + f + " must be a function but " + typeof u.listeners[f] + " given", i
                }
                if (u.filter) {
                    if (typeof u.filter != "function") return i.valid = !1, i.error = o + '"filter" must be a function, but ' + typeof u.filter + " given", i
                } else if (u.regex) {
                    t.helper.isString(u.regex) && (u.regex = new RegExp(u.regex, "g"));
                    if (!u.regex instanceof RegExp) return i.valid = !1, i.error = o + '"regex" property must either be a string or a RegExp object, but ' + typeof u.regex + " given", i;
                    if (t.helper.isUndefined(u.replace)) return i.valid = !1, i.error = o + '"regex" extensions must implement a replace string or function', i
                }
            }
            return i
        }

        function u(e, t) {
            "use strict";
            var n = t.charCodeAt(0);
            return "~E" + n + "E"
        }
        var t = {},
            n = {},
            r = {},
            i = e(!0),
            s = {
                github: {
                    omitExtraWLInCodeBlocks: !0,
                    prefixHeaderId: "user-content-",
                    simplifiedAutoLink: !0,
                    literalMidWordUnderscores: !0,
                    strikethrough: !0,
                    tables: !0,
                    tablesHeaderId: !0,
                    ghCodeBlocks: !0,
                    tasklists: !0
                },
                vanilla: e(!0)
            };
        t.helper = {}, t.extensions = {}, t.setOption = function(e, t) {
            "use strict";
            return i[e] = t, this
        }, t.getOption = function(e) {
            "use strict";
            return i[e]
        }, t.getOptions = function() {
            "use strict";
            return i
        }, t.resetOptions = function() {
            "use strict";
            i = e(!0)
        }, t.setFlavor = function(e) {
            "use strict";
            if (s.hasOwnProperty(e)) {
                var t = s[e];
                for (var n in t) t.hasOwnProperty(n) && (i[n] = t[n])
            }
        }, t.getDefaultOptions = function(t) {
            "use strict";
            return e(t)
        }, t.subParser = function(e, r) {
            "use strict";
            if (t.helper.isString(e)) {
                if (typeof r == "undefined") {
                    if (n.hasOwnProperty(e)) return n[e];
                    throw Error("SubParser named " + e + " not registered!")
                }
                n[e] = r
            }
        }, t.extension = function(e, n) {
            "use strict";
            if (!t.helper.isString(e)) throw Error("Extension 'name' must be a string");
            e = t.helper.stdExtName(e);
            if (t.helper.isUndefined(n)) {
                if (!r.hasOwnProperty(e)) throw Error("Extension named " + e + " is not registered!");
                return r[e]
            }
            typeof n == "function" && (n = n()), t.helper.isArray(n) || (n = [n]);
            var i = o(n, e);
            if (!i.valid) throw Error(i.error);
            r[e] = n
        }, t.getAllExtensions = function() {
            "use strict";
            return r
        }, t.removeExtension = function(e) {
            "use strict";
            delete r[e]
        }, t.resetExtensions = function() {
            "use strict";
            r = {}
        }, t.validateExtension = function(e) {
            "use strict";
            var t = o(e, null);
            return t.valid ? !0 : (console.warn(t.error), !1)
        }, t.hasOwnProperty("helper") || (t.helper = {}), t.helper.isString = function(t) {
            "use strict";
            return typeof t == "string" || t instanceof String
        }, t.helper.isFunction = function(t) {
            "use strict";
            var n = {};
            return t && n.toString.call(t) === "[object Function]"
        }, t.helper.forEach = function(t, n) {
            "use strict";
            if (typeof t.forEach == "function") t.forEach(n);
            else
                for (var r = 0; r < t.length; r++) n(t[r], r, t)
        }, t.helper.isArray = function(t) {
            "use strict";
            return t.constructor === Array
        }, t.helper.isUndefined = function(t) {
            "use strict";
            return typeof t == "undefined"
        }, t.helper.stdExtName = function(e) {
            "use strict";
            return e.replace(/[_-]||\s/g, "").toLowerCase()
        }, t.helper.escapeCharactersCallback = u, t.helper.escapeCharacters = function(t, n, r) {
            "use strict";
            var i = "([" + n.replace(/([\[\]\\])/g, "\\$1") + "])";
            r && (i = "\\\\" + i);
            var s = new RegExp(i, "g");
            return t = t.replace(s, u), t
        };
        var a = function(e, t, n, r) {
            "use strict";
            var i = r || "",
                s = i.indexOf("g") > -1,
                o = new RegExp(t + "|" + n, "g" + i.replace(/g/g, "")),
                u = new RegExp(t, i.replace(/g/g, "")),
                a = [],
                f, l, c, h, p;
            do {
                f = 0;
                while (c = o.exec(e))
                    if (u.test(c[0])) f++ || (l = o.lastIndex, h = l - c[0].length);
                    else if (f && !--f) {
                    p = c.index + c[0].length;
                    var d = {
                        left: {
                            start: h,
                            end: l
                        },
                        match: {
                            start: l,
                            end: c.index
                        },
                        right: {
                            start: c.index,
                            end: p
                        },
                        wholeMatch: {
                            start: h,
                            end: p
                        }
                    };
                    a.push(d);
                    if (!s) return a
                }
            } while (f && (o.lastIndex = l));
            return a
        };
        t.helper.matchRecursiveRegExp = function(e, t, n, r) {
            "use strict";
            var i = a(e, t, n, r),
                s = [];
            for (var o = 0; o < i.length; ++o) s.push([e.slice(i[o].wholeMatch.start, i[o].wholeMatch.end), e.slice(i[o].match.start, i[o].match.end), e.slice(i[o].left.start, i[o].left.end), e.slice(i[o].right.start, i[o].right.end)]);
            return s
        }, t.helper.replaceRecursiveRegExp = function(e, n, r, i, s) {
            "use strict";
            if (!t.helper.isFunction(n)) {
                var o = n;
                n = function() {
                    return o
                }
            }
            var u = a(e, r, i, s),
                f = e,
                l = u.length;
            if (l > 0) {
                var c = [];
                u[0].wholeMatch.start !== 0 && c.push(e.slice(0, u[0].wholeMatch.start));
                for (var h = 0; h < l; ++h) c.push(n(e.slice(u[h].wholeMatch.start, u[h].wholeMatch.end), e.slice(u[h].match.start, u[h].match.end), e.slice(u[h].left.start, u[h].left.end), e.slice(u[h].right.start, u[h].right.end))), h < l - 1 && c.push(e.slice(u[h].wholeMatch.end, u[h + 1].wholeMatch.start));
                u[l - 1].wholeMatch.end < e.length && c.push(e.slice(u[l - 1].wholeMatch.end)), f = c.join("")
            }
            return f
        }, t.helper.isUndefined(console) && (console = {
            warn: function(e) {
                "use strict";
                alert(e)
            },
            log: function(e) {
                "use strict";
                alert(e)
            },
            error: function(e) {
                "use strict";
                throw e
            }
        }), t.Converter = function(e) {
            "use strict";

            function l() {
                e = e || {};
                for (var r in i) i.hasOwnProperty(r) && (n[r] = i[r]);
                if (typeof e != "object") throw Error("Converter expects the passed parameter to be an object, but " + typeof e + " was passed instead.");
                for (var s in e) e.hasOwnProperty(s) && (n[s] = e[s]);
                n.extensions && t.helper.forEach(n.extensions, c)
            }

            function c(e, n) {
                n = n || null;
                if (t.helper.isString(e)) {
                    e = t.helper.stdExtName(e), n = e;
                    if (t.extensions[e]) {
                        console.warn("DEPRECATION WARNING: " + e + " is an old extension that uses a deprecated loading method." + "Please inform the developer that the extension should be updated!"), h(t.extensions[e], e);
                        return
                    }
                    if (!!t.helper.isUndefined(r[e])) throw Error('Extension "' + e + '" could not be loaded. It was either not found or is not a valid extension.');
                    e = r[e]
                }
                typeof e == "function" && (e = e()), t.helper.isArray(e) || (e = [e]);
                var i = o(e, n);
                if (!i.valid) throw Error(i.error);
                for (var s = 0; s < e.length; ++s) {
                    switch (e[s].type) {
                        case "lang":
                            u.push(e[s]);
                            break;
                        case "output":
                            a.push(e[s])
                    }
                    if (e[s].hasOwnProperty(f))
                        for (var l in e[s].listeners) e[s].listeners.hasOwnProperty(l) && p(l, e[s].listeners[l])
                }
            }

            function h(e, n) {
                typeof e == "function" && (e = e(new t.Converter)), t.helper.isArray(e) || (e = [e]);
                var r = o(e, n);
                if (!r.valid) throw Error(r.error);
                for (var i = 0; i < e.length; ++i) switch (e[i].type) {
                    case "lang":
                        u.push(e[i]);
                        break;
                    case "output":
                        a.push(e[i]);
                        break;
                    default:
                        throw Error("Extension loader error: Type unrecognized!!!")
                }
            }

            function p(e, n) {
                if (!t.helper.isString(e)) throw Error("Invalid argument in converter.listen() method: name must be a string, but " + typeof e + " given");
                if (typeof n != "function") throw Error("Invalid argument in converter.listen() method: callback must be a function, but " + typeof n + " given");
                f.hasOwnProperty(e) || (f[e] = []), f[e].push(n)
            }
            var n = {},
                u = [],
                a = [],
                f = {};
            l(), this._dispatch = function(t, n, r, i) {
                if (f.hasOwnProperty(t))
                    for (var s = 0; s < f[t].length; ++s) {
                        var o = f[t][s](t, n, this, r, i);
                        o && typeof o != "undefined" && (n = o)
                    }
                return n
            }, this.listen = function(e, t) {
                return p(e, t), this
            }, this.makeHtml = function(e) {
                if (!e) return e;
                var r = {
                    gHtmlBlocks: [],
                    gHtmlMdBlocks: [],
                    gHtmlSpans: [],
                    gUrls: {},
                    gTitles: {},
                    gDimensions: {},
                    gListLevel: 0,
                    hashLinkCounts: {},
                    langExtensions: u,
                    outputModifiers: a,
                    converter: this,
                    ghCodeBlocks: []
                };
                return e = e.replace(/~/g, "~T"), e = e.replace(/\$/g, "~D"), e = e.replace(/\r\n/g, "\n"), e = e.replace(/\r/g, "\n"), e = "\n\n" + e + "\n\n", e = t.subParser("detab")(e, n, r), e = t.subParser("stripBlankLines")(e, n, r), t.helper.forEach(u, function(i) {
                    e = t.subParser("runExtension")(i, e, n, r)
                }), e = t.subParser("hashPreCodeTags")(e, n, r), e = t.subParser("githubCodeBlocks")(e, n, r), e = t.subParser("hashHTMLBlocks")(e, n, r), e = t.subParser("hashHTMLSpans")(e, n, r), e = t.subParser("stripLinkDefinitions")(e, n, r), e = t.subParser("blockGamut")(e, n, r), e = t.subParser("unhashHTMLSpans")(e, n, r), e = t.subParser("unescapeSpecialChars")(e, n, r), e = e.replace(/~D/g, "$$"), e = e.replace(/~T/g, "~"), t.helper.forEach(a, function(i) {
                    e = t.subParser("runExtension")(i, e, n, r)
                }), e
            }, this.setOption = function(e, t) {
                n[e] = t
            }, this.getOption = function(e) {
                return n[e]
            }, this.getOptions = function() {
                return n
            }, this.addExtension = function(e, t) {
                t = t || null, c(e, t)
            }, this.useExtension = function(e) {
                c(e)
            }, this.setFlavor = function(e) {
                if (s.hasOwnProperty(e)) {
                    var t = s[e];
                    for (var r in t) t.hasOwnProperty(r) && (n[r] = t[r])
                }
            }, this.removeExtension = function(e) {
                t.helper.isArray(e) || (e = [e]);
                for (var n = 0; n < e.length; ++n) {
                    var r = e[n];
                    for (var i = 0; i < u.length; ++i) u[i] === r && u[i].splice(i, 1);
                    for (var s = 0; s < a.length; ++i) a[s] === r && a[s].splice(i, 1)
                }
            }, this.getAllExtensions = function() {
                return {
                    language: u,
                    output: a
                }
            }
        }, t.subParser("anchors", function(e, n, r) {
            "use strict";
            e = r.converter._dispatch("anchors.before", e, n, r);
            var i = function(e, n, i, s, o, u, a, f) {
                t.helper.isUndefined(f) && (f = ""), e = n;
                var l = i,
                    c = s.toLowerCase(),
                    h = o,
                    p = f;
                if (!h) {
                    c || (c = l.toLowerCase().replace(/ ?\n/g, " ")), h = "#" + c;
                    if (!t.helper.isUndefined(r.gUrls[c])) h = r.gUrls[c], t.helper.isUndefined(r.gTitles[c]) || (p = r.gTitles[c]);
                    else {
                        if (!(e.search(/\(\s*\)$/m) > -1)) return e;
                        h = ""
                    }
                }
                h = t.helper.escapeCharacters(h, "*_", !1);
                var d = '<a href="' + h + '"';
                return p !== "" && p !== null && (p = p.replace(/"/g, "&quot;"), p = t.helper.escapeCharacters(p, "*_", !1), d += ' title="' + p + '"'), d += ">" + l + "</a>", d
            };
            return e = e.replace(/(\[((?:\[[^\]]*]|[^\[\]])*)][ ]?(?:\n[ ]*)?\[(.*?)])()()()()/g, i), e = e.replace(/(\[((?:\[[^\]]*]|[^\[\]])*)]\([ \t]*()<?(.*?(?:\(.*?\).*?)?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g, i), e = e.replace(/(\[([^\[\]]+)])()()()()()/g, i), e = r.converter._dispatch("anchors.after", e, n, r), e
        }), t.subParser("autoLinks", function(e, n, r) {
            "use strict";

            function a(e, n) {
                var r = t.subParser("unescapeSpecialChars")(n);
                return t.subParser("encodeEmailAddress")(r)
            }
            e = r.converter._dispatch("autoLinks.before", e, n, r);
            var i = /\b(((https?|ftp|dict):\/\/|www\.)[^'">\s]+\.[^'">\s]+)(?=\s|$)(?!["<>])/gi,
                s = /<(((https?|ftp|dict):\/\/|www\.)[^'">\s]+)>/gi,
                o = /(?:^|[ \n\t])([A-Za-z0-9!#$%&'*+-/=?^_`\{|}~\.]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)(?:$|[ \n\t])/gi,
                u = /<(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi;
            return e = e.replace(s, '<a href="$1">$1</a>'), e = e.replace(u, a), n.simplifiedAutoLink && (e = e.replace(i, '<a href="$1">$1</a>'), e = e.replace(o, a)), e = r.converter._dispatch("autoLinks.after", e, n, r), e
        }), t.subParser("blockGamut", function(e, n, r) {
            "use strict";
            e = r.converter._dispatch("blockGamut.before", e, n, r), e = t.subParser("blockQuotes")(e, n, r), e = t.subParser("headers")(e, n, r);
            var i = t.subParser("hashBlock")("<hr />", n, r);
            return e = e.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm, i), e = e.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm, i), e = e.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm, i), e = t.subParser("lists")(e, n, r), e = t.subParser("codeBlocks")(e, n, r), e = t.subParser("tables")(e, n, r), e = t.subParser("hashHTMLBlocks")(e, n, r), e = t.subParser("paragraphs")(e, n, r), e = r.converter._dispatch("blockGamut.after", e, n, r), e
        }), t.subParser("blockQuotes", function(e, n, r) {
            "use strict";
            return e = r.converter._dispatch("blockQuotes.before", e, n, r), e = e.replace(/((^[ \t]{0,3}>[ \t]?.+\n(.+\n)*\n*)+)/gm, function(e, i) {
                var s = i;
                return s = s.replace(/^[ \t]*>[ \t]?/gm, "~0"), s = s.replace(/~0/g, ""), s = s.replace(/^[ \t]+$/gm, ""), s = t.subParser("githubCodeBlocks")(s, n, r), s = t.subParser("blockGamut")(s, n, r), s = s.replace(/(^|\n)/g, "$1  "), s = s.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm, function(e, t) {
                    var n = t;
                    return n = n.replace(/^  /mg, "~0"), n = n.replace(/~0/g, ""), n
                }), t.subParser("hashBlock")("<blockquote>\n" + s + "\n</blockquote>", n, r)
            }), e = r.converter._dispatch("blockQuotes.after", e, n, r), e
        }), t.subParser("codeBlocks", function(e, n, r) {
            "use strict";
            e = r.converter._dispatch("codeBlocks.before", e, n, r), e += "~0";
            var i = /(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g;
            return e = e.replace(i, function(e, i, s) {
                var o = i,
                    u = s,
                    a = "\n";
                return o = t.subParser("outdent")(o), o = t.subParser("encodeCode")(o), o = t.subParser("detab")(o), o = o.replace(/^\n+/g, ""), o = o.replace(/\n+$/g, ""), n.omitExtraWLInCodeBlocks && (a = ""), o = "<pre><code>" + o + a + "</code></pre>", t.subParser("hashBlock")(o, n, r) + u
            }), e = e.replace(/~0/, ""), e = r.converter._dispatch("codeBlocks.after", e, n, r), e
        }), t.subParser("codeSpans", function(e, n, r) {
            "use strict";
            return e = r.converter._dispatch("codeSpans.before", e, n, r), e = e.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm, function(e, n, r, i) {
                var s = i;
                return s = s.replace(/^([ \t]*)/g, ""), s = s.replace(/[ \t]*$/g, ""), s = t.subParser("encodeCode")(s), n + "<code>" + s + "</code>"
            }), e = r.converter._dispatch("codeSpans.after", e, n, r), e
        }), t.subParser("detab", function(e) {
            "use strict";
            return e = e.replace(/\t(?=\t)/g, "    "), e = e.replace(/\t/g, "~A~B"), e = e.replace(/~B(.+?)~A/g, function(e, t) {
                var n = t,
                    r = 4 - n.length % 4;
                for (var i = 0; i < r; i++) n += " ";
                return n
            }), e = e.replace(/~A/g, "    "), e = e.replace(/~B/g, ""), e
        }), t.subParser("encodeAmpsAndAngles", function(e) {
            "use strict";
            return e = e.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g, "&amp;"), e = e.replace(/<(?![a-z\/?\$!])/gi, "&lt;"), e
        }), t.subParser("encodeBackslashEscapes", function(e) {
            "use strict";
            return e = e.replace(/\\(\\)/g, t.helper.escapeCharactersCallback), e = e.replace(/\\([`*_{}\[\]()>#+-.!])/g, t.helper.escapeCharactersCallback), e
        }), t.subParser("encodeCode", function(e) {
            "use strict";
            return e = e.replace(/&/g, "&amp;"), e = e.replace(/</g, "&lt;"), e = e.replace(/>/g, "&gt;"), e = t.helper.escapeCharacters(e, "*_{}[]\\", !1), e
        }), t.subParser("encodeEmailAddress", function(e) {
            "use strict";
            var t = [function(e) {
                return "&#" + e.charCodeAt(0) + ";"
            }, function(e) {
                return "&#x" + e.charCodeAt(0).toString(16) + ";"
            }, function(e) {
                return e
            }];
            return e = "mailto:" + e, e = e.replace(/./g, function(e) {
                if (e === "@") e = t[Math.floor(Math.random() * 2)](e);
                else if (e !== ":") {
                    var n = Math.random();
                    e = n > .9 ? t[2](e) : n > .45 ? t[1](e) : t[0](e)
                }
                return e
            }), e = '<a href="' + e + '">' + e + "</a>", e = e.replace(/">.+:/g, '">'), e
        }), t.subParser("escapeSpecialCharsWithinTagAttributes", function(e) {
            "use strict";
            var n = /(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi;
            return e = e.replace(n, function(e) {
                var n = e.replace(/(.)<\/?code>(?=.)/g, "$1`");
                return n = t.helper.escapeCharacters(n, "\\`*_", !1), n
            }), e
        }), t.subParser("githubCodeBlocks", function(e, n, r) {
            "use strict";
            return n.ghCodeBlocks ? (e = r.converter._dispatch("githubCodeBlocks.before", e, n, r), e += "~0", e = e.replace(/(?:^|\n)```(.*)\n([\s\S]*?)\n```/g, function(e, i, s) {
                var o = n.omitExtraWLInCodeBlocks ? "" : "\n";
                return s = t.subParser("encodeCode")(s), s = t.subParser("detab")(s), s = s.replace(/^\n+/g, ""), s = s.replace(/\n+$/g, ""), s = "<pre><code" + (i ? ' class="' + i + " language-" + i + '"' : "") + ">" + s + o + "</code></pre>", s = t.subParser("hashBlock")(s, n, r), "\n\n~G" + (r.ghCodeBlocks.push({
                    text: e,
                    codeblock: s
                }) - 1) + "G\n\n"
            }), e = e.replace(/~0/, ""), r.converter._dispatch("githubCodeBlocks.after", e, n, r)) : e
        }), t.subParser("hashBlock", function(e, t, n) {
            "use strict";
            return e = e.replace(/(^\n+|\n+$)/g, ""), "\n\n~K" + (n.gHtmlBlocks.push(e) - 1) + "K\n\n"
        }), t.subParser("hashElement", function(e, t, n) {
            "use strict";
            return function(e, t) {
                var r = t;
                return r = r.replace(/\n\n/g, "\n"), r = r.replace(/^\n/, ""), r = r.replace(/\n+$/g, ""), r = "\n\n~K" + (n.gHtmlBlocks.push(r) - 1) + "K\n\n", r
            }
        }), t.subParser("hashHTMLBlocks", function(e, n, r) {
            "use strict";
            var i = ["pre", "div", "h1", "h2", "h3", "h4", "h5", "h6", "blockquote", "table", "dl", "ol", "ul", "script", "noscript", "form", "fieldset", "iframe", "math", "style", "section", "header", "footer", "nav", "article", "aside", "address", "audio", "canvas", "figure", "hgroup", "output", "video", "p"],
                s = function(e, t, n, i) {
                    var s = e;
                    return n.search(/\bmarkdown\b/) !== -1 && (s = n + r.converter.makeHtml(t) + i), "\n\n~K" + (r.gHtmlBlocks.push(s) - 1) + "K\n\n"
                };
            for (var o = 0; o < i.length; ++o) e = t.helper.replaceRecursiveRegExp(e, s, "^(?: |\\t){0,3}<" + i[o] + "\\b[^>]*>", "</" + i[o] + ">", "gim");
            return e = e.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g, t.subParser("hashElement")(e, n, r)), e = e.replace(/(<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g, t.subParser("hashElement")(e, n, r)), e = e.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g, t.subParser("hashElement")(e, n, r)), e
        }), t.subParser("hashHTMLSpans", function(e, n, r) {
            "use strict";
            var i = t.helper.matchRecursiveRegExp(e, "<code\\b[^>]*>", "</code>", "gi");
            for (var s = 0; s < i.length; ++s) e = e.replace(i[s][0], "~L" + (r.gHtmlSpans.push(i[s][0]) - 1) + "L");
            return e
        }), t.subParser("unhashHTMLSpans", function(e, t, n) {
            "use strict";
            for (var r = 0; r < n.gHtmlSpans.length; ++r) e = e.replace("~L" + r + "L", n.gHtmlSpans[r]);
            return e
        }), t.subParser("hashPreCodeTags", function(e, n, r) {
            "use strict";
            var i = function(e, n, i, s) {
                var o = i + t.subParser("encodeCode")(n) + s;
                return "\n\n~G" + (r.ghCodeBlocks.push({
                    text: e,
                    codeblock: o
                }) - 1) + "G\n\n"
            };
            return e = t.helper.replaceRecursiveRegExp(e, i, "^(?: |\\t){0,3}<pre\\b[^>]*>\\s*<code\\b[^>]*>", "^(?: |\\t){0,3}</code>\\s*</pre>", "gim"), e
        }), t.subParser("headers", function(e, n, r) {
            "use strict";

            function a(e) {
                var n, s = e.replace(/[^\w]/g, "").toLowerCase();
                return r.hashLinkCounts[s] ? n = s + "-" + r.hashLinkCounts[s]++ : (n = s, r.hashLinkCounts[s] = 1), i === !0 && (i = "section"), t.helper.isString(i) ? i + n : n
            }
            e = r.converter._dispatch("headers.before", e, n, r);
            var i = n.prefixHeaderId,
                s = isNaN(parseInt(n.headerLevelStart)) ? 1 : parseInt(n.headerLevelStart),
                o = n.smoothLivePreview ? /^(.+)[ \t]*\n={2,}[ \t]*\n+/gm : /^(.+)[ \t]*\n=+[ \t]*\n+/gm,
                u = n.smoothLivePreview ? /^(.+)[ \t]*\n-{2,}[ \t]*\n+/gm : /^(.+)[ \t]*\n-+[ \t]*\n+/gm;
            return e = e.replace(o, function(e, i) {
                var o = t.subParser("spanGamut")(i, n, r),
                    u = n.noHeaderId ? "" : ' id="' + a(i) + '"',
                    f = s,
                    l = "<h" + f + u + ">" + o + "</h" + f + ">";
                return t.subParser("hashBlock")(l, n, r)
            }), e = e.replace(u, function(e, i) {
                var o = t.subParser("spanGamut")(i, n, r),
                    u = n.noHeaderId ? "" : ' id="' + a(i) + '"',
                    f = s + 1,
                    l = "<h" + f + u + ">" + o + "</h" + f + ">";
                return t.subParser("hashBlock")(l, n, r)
            }), e = e.replace(/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm, function(e, i, o) {
                var u = t.subParser("spanGamut")(o, n, r),
                    f = n.noHeaderId ? "" : ' id="' + a(o) + '"',
                    l = s - 1 + i.length,
                    c = "<h" + l + f + ">" + u + "</h" + l + ">";
                return t.subParser("hashBlock")(c, n, r)
            }), e = r.converter._dispatch("headers.after", e, n, r), e
        }), t.subParser("images", function(e, n, r) {
            "use strict";

            function o(e, n, i, s, o, u, a, f) {
                var l = r.gUrls,
                    c = r.gTitles,
                    h = r.gDimensions;
                i = i.toLowerCase(), f || (f = "");
                if (s === "" || s === null) {
                    if (i === "" || i === null) i = n.toLowerCase().replace(/ ?\n/g, " ");
                    s = "#" + i;
                    if (!!t.helper.isUndefined(l[i])) return e;
                    s = l[i], t.helper.isUndefined(c[i]) || (f = c[i]), t.helper.isUndefined(h[i]) || (o = h[i].width, u = h[i].height)
                }
                n = n.replace(/"/g, "&quot;"), n = t.helper.escapeCharacters(n, "*_", !1), s = t.helper.escapeCharacters(s, "*_", !1);
                var p = '<img src="' + s + '" alt="' + n + '"';
                return f && (f = f.replace(/"/g, "&quot;"), f = t.helper.escapeCharacters(f, "*_", !1), p += ' title="' + f + '"'), o && u && (o = o === "*" ? "auto" : o, u = u === "*" ? "auto" : u, p += ' width="' + o + '"', p += ' height="' + u + '"'), p += " />", p
            }
            e = r.converter._dispatch("images.before", e, n, r);
            var i = /!\[(.*?)]\s?\([ \t]*()<?(\S+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(['"])(.*?)\6[ \t]*)?\)/g,
                s = /!\[(.*?)][ ]?(?:\n[ ]*)?\[(.*?)]()()()()()/g;
            return e = e.replace(s, o), e = e.replace(i, o), e = r.converter._dispatch("images.after", e, n, r), e
        }), t.subParser("italicsAndBold", function(e, t, n) {
            "use strict";
            return e = n.converter._dispatch("italicsAndBold.before", e, t, n), t.literalMidWordUnderscores ? (e = e.replace(/(^|\s|>|\b)__(?=\S)([^]+?)__(?=\b|<|\s|$)/gm, "$1<strong>$2</strong>"), e = e.replace(/(^|\s|>|\b)_(?=\S)([^]+?)_(?=\b|<|\s|$)/gm, "$1<em>$2</em>"), e = e.replace(/(\*\*)(?=\S)([^\r]*?\S[*]*)\1/g, "<strong>$2</strong>"), e = e.replace(/(\*)(?=\S)([^\r]*?\S)\1/g, "<em>$2</em>")) : (e = e.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g, "<strong>$2</strong>"), e = e.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g, "<em>$2</em>")), e = n.converter._dispatch("italicsAndBold.after", e, t, n), e
        }), t.subParser("lists", function(e, n, r) {
            "use strict";

            function i(e, i) {
                r.gListLevel++, e = e.replace(/\n{2,}$/, "\n"), e += "~0";
                var s = /(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,
                    o = /\n[ \t]*\n(?!~0)/.test(e);
                return e = e.replace(s, function(e, i, s, u, a, f, l) {
                    l = l && l.trim() !== "";
                    var c = t.subParser("outdent")(a, n, r),
                        h = "";
                    return f && n.tasklists && (h = ' class="task-list-item" style="list-style-type: none;"', c = c.replace(/^[ \t]*\[(x|X| )?]/m, function() {
                        var e = '<input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"';
                        return l && (e += " checked"), e += ">", e
                    })), i || c.search(/\n{2,}/) > -1 ? (c = t.subParser("githubCodeBlocks")(c, n, r), c = t.subParser("blockGamut")(c, n, r)) : (c = t.subParser("lists")(c, n, r), c = c.replace(/\n$/, ""), o ? c = t.subParser("paragraphs")(c, n, r) : c = t.subParser("spanGamut")(c, n, r)), c = "\n<li" + h + ">" + c + "</li>\n", c
                }), e = e.replace(/~0/g, ""), r.gListLevel--, i && (e = e.replace(/\s+$/, "")), e
            }

            function s(e, t, n) {
                var r = t === "ul" ? /^ {0,2}\d+\.[ \t]/gm : /^ {0,2}[*+-][ \t]/gm,
                    s = [],
                    o = "";
                if (e.search(r) !== -1) {
                    (function a(e) {
                        var s = e.search(r);
                        s !== -1 ? (o += "\n\n<" + t + ">" + i(e.slice(0, s), !!n) + "</" + t + ">\n\n", t = t === "ul" ? "ol" : "ul", r = t === "ul" ? /^ {0,2}\d+\.[ \t]/gm : /^ {0,2}[*+-][ \t]/gm, a(e.slice(s))) : o += "\n\n<" + t + ">" + i(e, !!n) + "</" + t + ">\n\n"
                    })(e);
                    for (var u = 0; u < s.length; ++u);
                } else o = "\n\n<" + t + ">" + i(e, !!n) + "</" + t + ">\n\n";
                return o
            }
            e = r.converter._dispatch("lists.before", e, n, r), e += "~0";
            var o = /^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;
            return r.gListLevel ? e = e.replace(o, function(e, t, n) {
                var r = n.search(/[*+-]/g) > -1 ? "ul" : "ol";
                return s(t, r, !0)
            }) : (o = /(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm, e = e.replace(o, function(e, t, n, r) {
                var i = r.search(/[*+-]/g) > -1 ? "ul" : "ol";
                return s(n, i)
            })), e = e.replace(/~0/, ""), e = r.converter._dispatch("lists.after", e, n, r), e
        }), t.subParser("outdent", function(e) {
            "use strict";
            return e = e.replace(/^(\t|[ ]{1,4})/gm, "~0"), e = e.replace(/~0/g, ""), e
        }), t.subParser("paragraphs", function(e, n, r) {
            "use strict";
            e = r.converter._dispatch("paragraphs.before", e, n, r), e = e.replace(/^\n+/g, ""), e = e.replace(/\n+$/g, "");
            var i = e.split(/\n{2,}/g),
                s = [],
                o = i.length;
            for (var u = 0; u < o; u++) {
                var a = i[u];
                a.search(/~(K|G)(\d+)\1/g) >= 0 ? s.push(a) : (a = t.subParser("spanGamut")(a, n, r), a = a.replace(/^([ \t]*)/g, "<p>"), a += "</p>", s.push(a))
            }
            o = s.length;
            for (u = 0; u < o; u++) {
                var f = "",
                    l = s[u],
                    c = !1;
                while (l.search(/~(K|G)(\d+)\1/) >= 0) {
                    var h = RegExp.$1,
                        p = RegExp.$2;
                    h === "K" ? f = r.gHtmlBlocks[p] : c ? f = t.subParser("encodeCode")(r.ghCodeBlocks[p].text) : f = r.ghCodeBlocks[p].codeblock, f = f.replace(/\$/g, "$$$$"), l = l.replace(/(\n\n)?~(K|G)\d+\2(\n\n)?/, f), /^<pre\b[^>]*>\s*<code\b[^>]*>/.test(l) && (c = !0)
                }
                s[u] = l
            }
            return e = s.join("\n\n"), e = e.replace(/^\n+/g, ""), e = e.replace(/\n+$/g, ""), r.converter._dispatch("paragraphs.after", e, n, r)
        }), t.subParser("runExtension", function(e, t, n, r) {
            "use strict";
            if (e.filter) t = e.filter(t, r.converter, n);
            else if (e.regex) {
                var i = e.regex;
                !i instanceof RegExp && (i = new RegExp(i, "g")), t = t.replace(i, e.replace)
            }
            return t
        }), t.subParser("spanGamut", function(e, n, r) {
            "use strict";
            return e = r.converter._dispatch("spanGamut.before", e, n, r), e = t.subParser("codeSpans")(e, n, r), e = t.subParser("escapeSpecialCharsWithinTagAttributes")(e, n, r), e = t.subParser("encodeBackslashEscapes")(e, n, r), e = t.subParser("images")(e, n, r), e = t.subParser("anchors")(e, n, r), e = t.subParser("autoLinks")(e, n, r), e = t.subParser("encodeAmpsAndAngles")(e, n, r), e = t.subParser("italicsAndBold")(e, n, r), e = t.subParser("strikethrough")(e, n, r), e = e.replace(/  +\n/g, " <br />\n"), e = r.converter._dispatch("spanGamut.after", e, n, r), e
        }), t.subParser("strikethrough", function(e, t, n) {
            "use strict";
            return t.strikethrough && (e = n.converter._dispatch("strikethrough.before", e, t, n), e = e.replace(/(?:~T){2}([\s\S]+?)(?:~T){2}/g, "<del>$1</del>"), e = n.converter._dispatch("strikethrough.after", e, t, n)), e
        }), t.subParser("stripBlankLines", function(e) {
            "use strict";
            return e.replace(/^[ \t]+$/mg, "")
        }), t.subParser("stripLinkDefinitions", function(e, n, r) {
            "use strict";
            var i = /^ {0,3}\[(.+)]:[ \t]*\n?[ \t]*<?(\S+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n+|(?=~0))/gm;
            return e += "~0", e = e.replace(i, function(e, i, s, o, u, a, f) {
                return i = i.toLowerCase(), r.gUrls[i] = t.subParser("encodeAmpsAndAngles")(s), a ? a + f : (f && (r.gTitles[i] = f.replace(/"|'/g, "&quot;")), n.parseImgDimensions && o && u && (r.gDimensions[i] = {
                    width: o,
                    height: u
                }), "")
            }), e = e.replace(/~0/, ""), e
        }), t.subParser("tables", function(e, n, r) {
            "use strict";

            function s(e) {
                return /^:[ \t]*--*$/.test(e) ? ' style="text-align:left;"' : /^--*[ \t]*:[ \t]*$/.test(e) ? ' style="text-align:right;"' : /^:[ \t]*--*[ \t]*:$/.test(e) ? ' style="text-align:center;"' : ""
            }

            function o(e, i) {
                var s = "";
                return e = e.trim(), n.tableHeaderId && (s = ' id="' + e.replace(/ /g, "_").toLowerCase() + '"'), e = t.subParser("spanGamut")(e, n, r), "<th" + s + i + ">" + e + "</th>\n"
            }

            function u(e, i) {
                var s = t.subParser("spanGamut")(e, n, r);
                return "<td" + i + ">" + s + "</td>\n"
            }

            function a(e, t) {
                var n = "<table>\n<thead>\n<tr>\n",
                    r = e.length;
                for (var i = 0; i < r; ++i) n += e[i];
                n += "</tr>\n</thead>\n<tbody>\n";
                for (i = 0; i < t.length; ++i) {
                    n += "<tr>\n";
                    for (var s = 0; s < r; ++s) n += t[i][s];
                    n += "</tr>\n"
                }
                return n += "</tbody>\n</table>\n", n
            }
            if (!n.tables) return e;
            var i = /^[ \t]{0,3}\|?.+\|.+\n[ \t]{0,3}\|?[ \t]*:?[ \t]*(?:-|=){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:-|=){2,}[^]+?(?:\n\n|~0)/gm;
            return e = r.converter._dispatch("tables.before", e, n, r), e = e.replace(i, function(e) {
                var n, r = e.split("\n");
                for (n = 0; n < r.length; ++n) /^[ \t]{0,3}\|/.test(r[n]) && (r[n] = r[n].replace(/^[ \t]{0,3}\|/, "")), /\|[ \t]*$/.test(r[n]) && (r[n] = r[n].replace(/\|[ \t]*$/, ""));
                var i = r[0].split("|").map(function(e) {
                        return e.trim()
                    }),
                    f = r[1].split("|").map(function(e) {
                        return e.trim()
                    }),
                    l = [],
                    c = [],
                    h = [],
                    p = [];
                r.shift(), r.shift();
                for (n = 0; n < r.length; ++n) {
                    if (r[n].trim() === "") continue;
                    l.push(r[n].split("|").map(function(e) {
                        return e.trim()
                    }))
                }
                if (i.length < f.length) return e;
                for (n = 0; n < f.length; ++n) h.push(s(f[n]));
                for (n = 0; n < i.length; ++n) t.helper.isUndefined(h[n]) && (h[n] = ""), c.push(o(i[n], h[n]));
                for (n = 0; n < l.length; ++n) {
                    var d = [];
                    for (var v = 0; v < c.length; ++v) t.helper.isUndefined(l[n][v]), d.push(u(l[n][v], h[v]));
                    p.push(d)
                }
                return a(c, p)
            }), e = r.converter._dispatch("tables.after", e, n, r), e
        }), t.subParser("unescapeSpecialChars", function(e) {
            "use strict";
            return e = e.replace(/~E(\d+)E/g, function(e, t) {
                var n = parseInt(t);
                return String.fromCharCode(n)
            }), e
        });
        var f = this;
        typeof module != "undefined" && module.exports ? module.exports = t : typeof define == "function" && define.amd ? define("showdown", [], function() {
            "use strict";
            return t
        }) : f.showdown = t
    }.call(this), define("models/ContentModel", ["jquery", "underscore", "backbone", "showdown", "leaflet"], function(e, t, n, r, i) {
        var s = n.Model.extend({
            initialize: function(e) {
                this.options = e || {}, this.isContentLoading = !1, this.isContentLoaded = !1
            },
            loadContent: function(t, n) {
                var r = this;
                e.get(this.getUrl(), function(i) {
                    var s = e(i).find(n);
                    s = r.setupContent(s), t(s.children())
                })
            },
            setupContent: function(t) {
                var n = new r.Converter({
                    ghCodeBlocks: !1
                });
                return t.find(".convert-markdown").each(function() {
                    e(this).html(n.makeHtml(e(this).text().trim().split("_ ").join("<br/>")))
                }), t.find('a[href^="http"], .link-download').attr("target", "_blank"), t.find(".link-download").prepend('<span class="icon-wwf_download"></span>'), L.Browser.retina && t.find("img.img-retina, .item-media-type-graphic img").each(function(t, n) {
                    var r = e(n);
                    r.attr("src", r.attr("src").replace(".png", "@2.png")), r.attr("src", r.attr("src").replace(".jpg", "@2.jpg")), r.attr("src", r.attr("src").replace(".gif", "@2.gif"))
                }), t
            },
            isContentReady: function() {
                return !this.isContentLoading && this.isContentLoaded
            },
            getUrl: function() {
                if (typeof this.attributes.url != "undefined") {
                    var t = e("#application").data("baseurl");
                    return lang !== "en" ? t + "/" + lang + this.attributes.url : t + this.attributes.url
                }
            },
            getContent: function(e, t) {
                t = typeof t != "undefined" ? t : ".content";
                if (this.isContentLoaded && typeof this.attributes.content != "undefined" && this.attributes.content[0].innerHTML !== "") e(this.attributes.content);
                else {
                    var n = this;
                    this.isContentLoading ? waitFor(function() {
                        return n.isContentLoaded
                    }, function() {
                        e(n.attributes.content, n)
                    }) : (this.isContentLoading = !0, this.loadContent(function(t) {
                        n.set("content", t), n.isContentLoading = !1, n.isContentLoaded = !0, e(n.attributes.content)
                    }, t))
                }
            }
        });
        return s
    }), define("components/app/layers/LayersView", ["jquery", "underscore", "backbone", "./layerCategory/LayerCategoryView", "./layerCategory/LayerCategoryModel", "./layerCustomCategory/LayerCustomCategoryView", "./layerCustomCategory/LayerCustomCategoryModel", "./layerHome/LayerHomeView", "./layerHome/LayerHomeModel", "./layerItem/LayerItemView", "./layerItem/LayerItemModel", "models/ContentModel"], function(e, t, n, r, i, s, o, u, a, f, l, c) {
        var h = n.View.extend({
            events: {
                "click .cat-link": "handleCategoryLink",
                "click .cat-layers-remove": "handleCategoryRemove"
            },
            initialize: function() {
                this.views = {}, this.listenTo(this.model, "change:active", this.handleActive), this.listenTo(this.model, "change:layerId", this.render), this.listenTo(this.model, "change:category", this.render), this.listenTo(this.model, "change:ocean", this.render), this.listenTo(this.model, "change:customLayerEdit", this.handleCustomEditUpdate), this.listenTo(this.model, "change:customLayerData", this.handleCustomDataUpdate), this.listenTo(this.model, "change:customLayerIds", this.handleCustomLayersUpdate), this.listenTo(this.model, "change:activeLayerIds", this.handleActiveLayersUpdate)
            },
            render: function() {
                var e, n;
                n = this.model.getOcean(), t.each(this.views, function(e) {
                    e.model.setActive(!1)
                }), this.$("#layer-item").hide(), this.$("#layers-home").hide(), this.$("#layers-control").hide();
                var h = this.model.getLayerId();
                if (h !== "")
                    if (t.contains(this.model.getLayers().getIds(), h)) {
                        this.$("#layer-item").show();
                        var p = this.model.getLayers().get(h);
                        n !== "" ? (this.$("#layer-item-" + h).length === 0 && this.$("#layer-item").append('<div id="layer-item-' + h + '"></div>'), p.get("contentid") !== h && this.$("#layer-item-" + p.get("contentid")).length > 0 && this.$("#layer-item-" + p.get("contentid")).remove(), this.views["item-" + h] = this.views["item-" + h] || new f({
                            el: this.$("#layer-item-" + h),
                            model: new l({
                                id: h,
                                layer: p,
                                ocean: n,
                                activeLayerIds: this.model.getActiveLayerIds()
                            })
                        }), this.views["item-" + h].model.setActive(!0), e = p.get("category")) : (this.$("#layer-item-" + h).remove(), typeof p != "undefined" && this.$el.trigger("layerInfoSubpage", {
                            id: p.id
                        }))
                    } else {
                        this.$("#layer-item-" + h).remove();
                        var p = this.model.getLayers().findWhere({
                            contentid: h
                        });
                        typeof p != "undefined" && this.$el.trigger("layerInfoSubpage", {
                            id: p.id
                        })
                    } else {
                    var d = t.map(categoriesGlobal.layers, function(e) {
                        return e.activeCount = this.model.getLayers().byActive().byOcean(n).byCategory(e.value).length, e
                    }, this);
                    e = this.model.getCategory();
                    if (e === "custom" || e !== "" && t.contains(this.model.getLayers().getCategories(), e)) {
                        var v = n + "-" + e;
                        this.$("#layers-control").show(), this.$("#layers-control-" + v).length === 0 && this.$("#layers-control").append('<div id="layers-control-' + v + '" class="layers-control-category"></div>'), e === "custom" ? (this.views[v] = this.views[v] || new s({
                            el: this.$("#layers-control-" + v),
                            model: new o({
                                id: v,
                                category: e,
                                categories: d
                            })
                        }), this.views[v].model.set({
                            ocean: n,
                            layers: this.model.getLayers().byOcean(n).byCategory(e),
                            activeLayerIds: this.model.getActiveLayerIds(),
                            customData: this.model.get("customLayerData"),
                            edit: this.model.get("customLayerEdit")
                        })) : (this.views[v] = this.views[v] || new r({
                            el: this.$("#layers-control-" + v),
                            model: new i({
                                id: v,
                                category: e,
                                categories: d
                            })
                        }), this.views[v].model.set({
                            ocean: n,
                            layers: this.model.getLayers().byOptional(!0).byOcean(n).byCategory(e),
                            activeLayerIds: this.model.getActiveLayerIds()
                        })), this.views[v].model.setActive(!0)
                    } else {
                        this.$("#layers-home").show();
                        var m = "/layers/home/";
                        this.views.home = this.views.home || new u({
                            el: this.$("#layers-home"),
                            model: new a({
                                content: new c({
                                    url: m
                                })
                            })
                        }), this.views.home.model.setOcean(n), this.views.home.model.setCategories(d), this.views.home.model.setActive(!0), e = !1
                    }
                }
                return this.checkActiveCategory(e), this
            },
            checkActiveCategory: function(e) {
                this.$(".layer-links-bar .cat-link-layers").removeClass("active"), e && this.$(".layer-links-bar .cat-link-layers-" + e).addClass("active")
            },
            handleActive: function() {
                this.model.isActive() ? this.$el.show() : this.$el.hide()
            },
            handleCustomDataUpdate: function(e) {
                var t = this.model.getOcean(),
                    n = this.model.getCategory(),
                    r = t + "-" + n;
                this.model.isActive() && n === "custom" && typeof this.views[r] != "undefined" && this.views[r].model.setCustomData(this.model.get("customLayerData"))
            },
            handleCustomEditUpdate: function(e) {
                var t = this.model.getOcean(),
                    n = this.model.getCategory(),
                    r = t + "-" + n;
                this.model.isActive() && n === "custom" && typeof this.views[r] != "undefined" && this.views[r].model.setEdit(this.model.get("customLayerEdit"))
            },
            handleCustomLayersUpdate: function(e) {
                var t = this.model.getOcean(),
                    n = this.model.getCategory(),
                    r = t + "-" + n;
                this.model.isActive() && n === "custom" && typeof this.views[r] != "undefined" && this.views[r].model.setLayers(this.model.getLayers().byOcean(t).byCategory(n))
            },
            handleActiveLayersUpdate: function(e) {
                var n = this.model.getOcean(),
                    r = this.model.getCategory(),
                    i = this.model.getOcean() + "-" + r,
                    s = t.map(categoriesGlobal.layers, function(e) {
                        return e.activeCount = this.model.getLayers().byActive().byOcean(n).byCategory(e.value).length, e
                    }, this);
                this.model.isActive() && (r === "custom" || r !== "") && typeof this.views[i] != "undefined" && this.views[i].model.set({
                    activeLayerIds: this.model.getActiveLayerIds(),
                    categories: s
                }), this.model.isActive() && typeof this.views["item-" + this.model.getLayerId()] != "undefined" && this.views["item-" + this.model.getLayerId()].model.setActiveLayerIds(this.model.getActiveLayerIds())
            },
            handleCategoryLink: function(t) {
                t.preventDefault(), this.$el.trigger("layerCategoryLinkClick", {
                    target: t.target,
                    id: e(t.target).closest("a").data("catid")
                })
            },
            handleCategoryRemove: function(t) {
                t.preventDefault(), t.stopPropagation(), this.$el.trigger("layerCategoryRemove", {
                    target: t.target,
                    id: e(t.target).closest("a").data("catid")
                })
            }
        });
        return h
    }), define("components/app/layers/LayersModel", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.Model.extend({
            initialize: function(e) {
                this.options = e || {}
            },
            getCategory: function() {
                return this.attributes.category
            },
            getOcean: function() {
                return this.attributes.ocean
            },
            getLayerId: function() {
                return this.attributes.layerId
            },
            getLayers: function() {
                return this.attributes.layers
            },
            setActiveLayerIds: function(e) {
                return this.set("activeLayerIds", e)
            },
            getActiveLayerIds: function() {
                return this.attributes.activeLayerIds
            },
            setActive: function(e) {
                e = typeof e != "undefined" ? e : !0, this.set("active", e)
            },
            isActive: function() {
                return this.get("active")
            }
        });
        return r
    }), define("text!templates/labelTemplate.html", [], function() {
        return "<div class=\"label\">\r\n<% if (typeof supTitle !== 'undefined' && supTitle !== '') { %>\r\n<div class=\"label-sup-title\"><small><%= supTitle %></small></div>  \r\n<% } %>\r\n<% if (typeof title !== 'undefined' && title !== '') { %>\r\n<div class=\"label-title\"><strong><%= title %></strong></div>  \r\n<% } %>\r\n<% if (typeof description !== 'undefined' && description !== '') { %>\r\n  <div class=\"label-description\"><%= description %></div>  \r\n<% } %>\r\n\r\n</div>\r\n"
    }), define("text!templates/textIconTemplate.html", [], function() {
        return '<% var sizeInner = (size - (paddingOuter*2)) %>\r\n<div class="text-icon-outer" \r\n     style="background-color:<%= fillColorOuter %>;width:<%= size %>px;height:<%= size %>px;padding:<%= paddingOuter %>px">\r\n  <div class="text-icon-inner" \r\n       style="background-color:<%= fillColor %>;color:<%= color %>;width:<%= sizeInner %>px;height:<%= sizeInner %>px;"\r\n  >\r\n    <%= title %>\r\n    <div class="<%= iconClass %>"></div>\r\n  </div>\r\n</div>'
    }), define("text!templates/divIconTemplate.html", [], function() {
        return '<div style="<%= cssStyle %>"></div>'
    }), define("text!templates/divSvgIconTemplate.html", [], function() {
        return "<% pin = typeof pin !== \"undefined\" \r\n    ? pin \r\n    : \"M7.56,24.23c0-.05-2.82-5.31-5.07-10.13a18.28,18.28,0,0,1-2-6.29C0.5,2,5.21.5,8,.5S15.5,2,15.5,7.81a18.3,18.3,0,0,1-2,6.29c-2.26,4.83-5,10.08-5.07,10.13L8,25.07Z\" \r\n%>\r\n<svg xmlns='http://www.w3.org/2000/svg' \r\n     version='1.1' \r\n     width='62%' \r\n     height='100%' \r\n     viewBox='0 0 16 26'\r\n     preserveAspectRatio=\"xMaxYMax\">\r\n  <path stroke='<%= color %>' stroke-width='<%= weight %>' fill='<%= fillColor %>' d='<%= pin %>'/>\r\n</svg>"
    }), define("models/LocationModel", ["jquery", "underscore", "backbone", "leaflet", "./ContentModel", "text!templates/labelTemplate.html", "text!templates/textIconTemplate.html", "text!templates/divIconTemplate.html", "text!templates/divSvgIconTemplate.html"], function(e, t, n, r, i, s, o, u, a) {
        var f = i.extend({
            initialize: function(e) {
                this.options = e || {}, this.isContentLoading = !1, this.isContentLoaded = !1, this.set("active", !1), this.attributes.markerLayer.options.parent = this, typeof this.attributes.featureAttributeMap != "undefined" && t.each(this.attributes.featureAttributeMap, function(e, n) {
                    if (typeof e == "object") {
                        var r = {};
                        t.each(e, function(e, n) {
                            t.contains(e, "[") ? r[n] = this.getAttributeValue(e) : r[n] = this.attributes[e]
                        }, this), this.set(n, r)
                    } else t.contains(e, "[") ? this.set(n, this.getAttributeValue(e)) : this.set(n, this.attributes[e])
                }, this), this.makeIcon(), (typeof this.attributes.parentLayer.get("tooltip") == "undefined" || this.attributes.parentLayer.get("tooltip")) && this.makeLocationLabel(), this.initInteractions()
            },
            getAttributeValue: function(e) {
                var t = e.split("["),
                    n = t[0],
                    r = t[1].split("]"),
                    i = r.length > 1 ? r[1] : "",
                    e = r[0];
                return n + this.attributes[e] + i
            },
            initInteractions: function() {
                var e = this.attributes.parentLayer,
                    t = this;
                this.attributes.markerLayer.off("click").on("click", function(n) {
                    typeof t.collection.options.eventContext != "undefined" && t.collection.options.eventContext.trigger("mapMarkerClick", {
                        target: n.target,
                        layerId: e.get("id"),
                        locationId: t.get("id")
                    })
                })
            },
            makeIcon: function() {
                var n = this.attributes.parentLayer,
                    r;
                switch (n.get("icon").type) {
                    case "image":
                        var i = t.clone(n.get("icon").style);
                        i.className = "image-icon " + this.attributes.className, typeof i.iconUrl == "object" && (i.iconUrl = i.iconUrl[this.attributes[i.iconUrl.attribute]], typeof i.iconUrl == "object" && (i.iconUrl = i.iconUrl[this.attributes[i.iconUrl.attribute]])), this.get("active") && (i.iconUrl = i.iconUrl.replace(".png", "-active.png")), i.iconUrl = e("#application").data("baseurl") + "/" + i.iconUrl, this.collection.options.print ? (i.iconSize = [i.iconSize[0] * this.collection.options.printScale, i.iconSize[1] * this.collection.options.printScale], i.iconAnchor = [i.iconAnchor[0] * this.collection.options.printScale, i.iconAnchor[1] * this.collection.options.printScale], i.iconUrl = i.iconUrl.replace(".png", "@2.png")) : i.iconRetinaUrl = i.iconUrl.replace(".png", "@2.png"), r = L.icon(i);
                        break;
                    case "circle":
                        r = L.divIcon({
                            html: t.template(u)({
                                cssStyle: n.getCssStyle("circle")
                            }),
                            className: "circle-icon " + this.attributes.className,
                            iconSize: new L.Point(n.get("icon").size, n.get("icon").size)
                        });
                        break;
                    case "text-icon-circle":
                        var s = this.attributes[n.get("icon").title.attribute],
                            f = this.attributes[n.get("icon").style.attribute],
                            l = n.get("icon").style[f],
                            c = l.icon,
                            h = l.color,
                            p = l.fillColor.colorToRgb(),
                            d = "rgba(" + p[0] + "," + p[1] + "," + p[2] + ",0.5)",
                            p = "rgb(" + p[0] + "," + p[1] + "," + p[2] + ")",
                            v = l.size,
                            m = l.paddingOuter;
                        r = L.divIcon({
                            html: t.template(o)({
                                title: s,
                                iconClass: c,
                                size: v,
                                paddingOuter: m,
                                color: h,
                                fillColor: p,
                                fillColorOuter: d
                            }),
                            className: "text-icon",
                            iconSize: new L.Point(v, v)
                        });
                        break;
                    case "marker":
                    default:
                        var g = n.get("icon").width,
                            y = n.get("icon").height,
                            h, b = n.attributes.style.fillColor.colorToRgb(),
                            w = "rgba(" + b[0] + "," + b[1] + "," + b[2] + "," + n.attributes.style.fillOpacity + ")";
                        b = n.attributes.style.color.colorToRgb();
                        var h = "rgba(" + b[0] + "," + b[1] + "," + b[2] + "," + n.attributes.style.opacity + ")",
                            E = t.template(a)({
                                color: h,
                                weight: n.attributes.style.weight,
                                fillColor: w
                            });
                        r = L.icon({
                            iconUrl: "data:image/svg+xml;base64," + btoa(E),
                            iconSize: [g, y],
                            iconAnchor: [g / 2, y]
                        })
                }
                this.attributes.markerLayer.setIcon(r)
            },
            makeLocationLabel: function() {
                var e = this.getFeatureTitle();
                e = typeof e != "undefined" && e !== "<Null>" ? e : "";
                var n = this.getCategoryText();
                n = typeof n != "undefined" && n !== "<Null>" ? n : "";
                var r = this.attributes.parentLayer.getTitle(),
                    i = (n !== "" ? n : "") + (e !== "" && n !== "" ? ": " : "") + (e !== "" ? e : "");
                if (typeof i == "undefined" || i === "") i = r, r = "";
                var o = {
                    supTitle: r,
                    title: i,
                    description: this.getDescription(lang)
                };
                this.attributes.markerLayer.bindLabel(t.template(s)(o), this.attributes.labelOptions.options)
            },
            getCategoryText: function() {
                var e = this.get("category");
                return e && typeof e == "object" ? e[lang] : typeof tlang.categories[e] != "undefined" ? tlang.categories[e] : e
            },
            getCategory: function() {
                return this.get("category")
            },
            getFeatureTitle: function() {
                return this.getAttribute("title", lang) !== "undefined" ? this.getAttribute("title", lang) : this.getAttribute("featureTitle", lang)
            },
            getDescription: function() {
                return this.getAttribute("description", lang)
            },
            getAttribute: function(e, t) {
                var n = this.get(e);
                return typeof t != "undefined" && typeof n == "object" ? n[t] : typeof n != "undefined" ? n : ""
            }
        });
        return f
    }), define("models/LocationCollection", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.Collection.extend({
            initialize: function(e, t) {
                this.options = t || {}
            },
            getIds: function() {
                return t.map(this.models, function(e) {
                    return e.id
                })
            }
        });
        return r
    }), define("models/FeatureModel", ["jquery", "underscore", "backbone", "leaflet", "leaflet.label", "text!templates/labelTemplate.html", "text!templates/divIconTemplate.html"], function(e, t, n, r, i, s) {
        var o = n.Model.extend({
            initialize: function(e) {
                this.options = e || {}, typeof this.attributes.featureAttributeMap != "undefined" && t.each(this.attributes.featureAttributeMap, function(e, n) {
                    if (typeof e == "object") {
                        var r = {};
                        t.each(e, function(e, n) {
                            t.contains(e, "[") ? r[n] = this.getAttributeValue(e) : r[n] = this.attributes[e]
                        }, this), this.set(n, r)
                    } else t.contains(e, "[") ? this.set(n, this.getAttributeValue(e)) : this.set(n, this.attributes[e])
                }, this), this.makeFeatureLabel(), this.initStyles()
            },
            initStyles: function() {
                var e = this.attributes.parentLayer.attributes.featureStyle;
                if (typeof e != "undefined") {
                    var t = this.attributes[e.attribute].split(" ").join("-");
                    typeof e[t] != "undefined" && this.attributes.featureLayer.setStyle(e[t].style)
                }
            },
            getAttributeValue: function(e) {
                var t = e.split("["),
                    n = t[0],
                    r = t[1].split("]"),
                    i = r.length > 1 ? r[1] : "",
                    e = r[0];
                return n + this.attributes[e] + i
            },
            makeFeatureLabel: function() {
                var e = this.getTitle();
                e = typeof e != "undefined" && e !== "<Null>" ? e : "";
                var n = this.getCategoryText();
                n = typeof n != "undefined" && n !== "<Null>" ? n : "";
                var r = this.attributes.parentLayer.getTitle(),
                    i = (n !== "" ? n : "") + (e !== "" && n !== "" ? ": " : "") + (e !== "" ? e : "");
                if (typeof i == "undefined" || i === "") i = r, r = "";
                var o = {
                    supTitle: r,
                    title: i,
                    description: this.getDescription(lang)
                };
                this.attributes.featureLayer.bindLabel(t.template(s)(o), this.attributes.labelOptions.options)
            },
            getCategoryText: function() {
                var e = this.getCategory();
                return e && typeof e == "object" ? e[lang] : typeof tlang.categories[e] != "undefined" ? tlang.categories[e] : e
            },
            getCategory: function() {
                return this.get("featureCategory")
            },
            getTitle: function() {
                return this.getAttribute("featureTitle", lang)
            },
            getDescription: function() {
                return this.getAttribute("featureDescription", lang)
            },
            getAttribute: function(e, t) {
                var n = this.get(e);
                return typeof t != "undefined" && typeof n == "object" ? n[t] : typeof n != "undefined" ? n : ""
            }
        });
        return o
    }), define("models/FeatureCollection", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.Collection.extend({
            initialize: function(e, t) {
                this.options = t || {}
            },
            getIds: function() {
                return t.map(this.models, function(e) {
                    return e.id
                })
            }
        });
        return r
    }), define("text!templates/clusterIconTemplate.html", [], function() {
        return '<div class="cluster-icon-outer" style="<%= css_outer %>">\r\n  <div class="cluster-icon-inner" style="<%= css_inner %>">\r\n    <span><%= childCount %></span>\r\n  </div>\r\n</div>'
    }), define("text!templates/layerKeyGradientTemplate.html", [], function() {
        return '<div class="<%= classes %>">\r\n  <svg viewBox="0 0 100 100">\r\n    <defs>\r\n      <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%">\r\n        <stop offset="0%" style="stop-color:<%= min %>;stop-opacity:1" />\r\n        <stop offset="100%" style="stop-color:<%= max %>;stop-opacity:1" />\r\n      </linearGradient>\r\n    </defs>\r\n    <rect width="100" height="100" fill="url(#grad1)" />\r\n  </svg>\r\n</div>'
    }), define("text!templates/layerKeyFullGradientTemplate.html", [], function() {
        return '<div class="color-gradient-key">\r\n  <div class="color-gradient-key-svg-wrap">\r\n    <svg viewBox="0 0 100 100">\r\n      <defs>\r\n        <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%">\r\n          <stop offset="0%" style="stop-color:<%= min %>;stop-opacity:1" />\r\n          <stop offset="100%" style="stop-color:<%= max %>;stop-opacity:1" />\r\n        </linearGradient>\r\n      </defs>\r\n      <rect width="100" height="100" fill="url(#grad1)" />\r\n    </svg>\r\n  </div>\r\n  <div class="hint color-gradient-key-min"><%= minLabel %></div>\r\n  <div class="hint color-gradient-key-max"><%= maxLabel %></div>\r\n</div>'
    }), define("text!templates/layerKeyCategoricalTemplate.html", [], function() {
        return '<div class="<%= classes %>">\r\n  <ul class="list-inline">\r\n    <% _.each(colors,function(color,i,list){ %>  \r\n      <li style="background-color:<%= color %>;width:<%= 100/list.length %>%"></li>\r\n    <% }) %>  \r\n  </ul>\r\n</div>'
    }), define("text!templates/layerKeyIconTemplate.html", [], function() {
        return '<div class="key-wrap key-<%= size %>-wrap key-type-<%= styleType %> ">   \r\n  <%= keySquare %>  \r\n</div>'
    }), define("models/LayerModel", ["jquery", "underscore", "backbone", "./ContentModel", "./LocationModel", "./LocationCollection", "./FeatureModel", "./FeatureCollection", "leaflet", "leaflet.markercluster", "esri.leaflet", "text!templates/labelTemplate.html", "text!templates/clusterIconTemplate.html", "text!templates/layerKeyGradientTemplate.html", "text!templates/layerKeyFullGradientTemplate.html", "text!templates/layerKeyCategoricalTemplate.html", "text!templates/layerKeyIconTemplate.html", "text!templates/divSvgIconTemplate.html"], function(e, t, n, r, i, s, o, u, a, f, l, c, h, p, d, v, m, g) {
        var y = r.extend({
            initialize: function(e) {
                this.options = e || {}, this.isContentLoading = !1, this.isContentLoaded = !1, this.id = this.attributes.id, this.setBasemap(typeof this.attributes.basemap != "undefined" && this.attributes.basemap), this.setShowInKey(typeof this.attributes.key == "undefined" || this.attributes.key !== !1), this.set("print", this.collection.options.print), this.set("mapConfig", this.collection.options.mapConfig), this.set("crs", typeof this.attributes.crs != "undefined" ? this.attributes.crs : this.attributes.mapConfig.crsDefault), typeof this.attributes.category == "undefined" && this.setCategory("undefined"), typeof this.attributes.subcategory == "undefined" && this.setSubcategory("undefined"), typeof this.attributes.group == "undefined" && this.setGroup("undefined"), typeof this.attributes.optional == "undefined" && this.setOptional(!0), typeof this.attributes.attribution == "undefined" && this.set("attribution", ""), this.attributes.type === "point" && this.set("featureAttributeMap", typeof this.attributes.featureAttributeMap != "undefined" ? this.attributes.featureAttributeMap : {}), this.initializeSource(), this.initContentURL(), this.initStyles(), this.initPrintScale(), this.initCssStyles(), this.setModuleDefault(!1), this.setActive(!1)
            },
            initializeSource: function() {},
            loadData: function() {},
            fadeEnabled: function() {
                return this.get("type") !== "point" && this.get("type") !== "raster"
            },
            setModuleDefault: function(e) {
                this.set("isModuleDefault", e)
            },
            isModuleDefault: function() {
                return this.attributes.isModuleDefault
            },
            setActive: function(e) {
                e = typeof e != "undefined" ? e : !0, this.isActive() || this.set("activeTime", e ? Date.now() + this.attributes.order : !1), this.set("active", e)
            },
            isActive: function() {
                return this.attributes.active
            },
            setOptional: function(e) {
                e = typeof e != "undefined" ? e : !0, this.set("optional", e)
            },
            isOptional: function() {
                return this.attributes.optional
            },
            setBasemap: function(e) {
                e = typeof e != "undefined" ? e : !0, this.set("basemap", e)
            },
            isBasemap: function() {
                return this.attributes.basemap
            },
            setLoading: function(e) {
                e = typeof e != "undefined" ? e : !0, this.set("loading", e)
            },
            isLoading: function() {
                return this.attributes.loading
            },
            isLoaded: function() {
                return typeof this.attributes.mapLayer != "undefined" && !this.isLoading()
            },
            isCustom: function() {
                return this.attributes.source === "custom"
            },
            setShowInKey: function(e) {
                this.set("showInKey", e)
            },
            showInKey: function() {
                return this.attributes.showInKey
            },
            getHint: function() {
                return this.getAttribute("hint", lang)
            },
            getTitle: function() {
                return this.getAttribute("title", lang)
            },
            getDescription: function() {
                return this.getAttribute("description", lang)
            },
            getAttribute: function(e, t) {
                var n = this.get(e);
                return typeof t != "undefined" && typeof n == "object" ? n[t] : typeof n != "undefined" ? n : ""
            },
            getType: function() {
                return this.attributes.type
            },
            setCategory: function(e) {
                this.set("category", e)
            },
            getCategory: function() {
                return this.attributes.category
            },
            setSubcategory: function(e) {
                this.set("subcategory", e)
            },
            getSubcategory: function() {
                return this.attributes.subcategory
            },
            setGroup: function(e) {
                this.set("group", e)
            },
            getGroup: function() {
                return this.attributes.group
            },
            getOcean: function() {
                return this.attributes.ocean
            },
            getReference: function() {
                return this.attributes.attribution
            },
            getCrs: function() {
                return this.attributes.crs
            },
            initStyles: function() {
                this.attributes.type === "point" && (typeof this.attributes.icon == "undefined" ? this.attributes.icon = {
                    type: "marker"
                } : typeof this.attributes.icon.type == "undefined" && (this.attributes.icon.type = "marker"));
                var e = t.clone(this.collection.options.mapConfig.layerStyles);
                typeof e[this.getStyleType()] != "undefined" && (typeof this.attributes.style != "undefined" ? (typeof this.attributes.style.color != "undefined" && (this.attributes.style.fillColor = typeof this.attributes.style.fillColor != "undefined" ? this.attributes.style.fillColor : this.attributes.style.color), typeof this.attributes.style.opacity != "undefined" && (this.attributes.style.fillOpacity = typeof this.attributes.style.fillOpacity != "undefined" ? this.attributes.style.fillOpacity : this.attributes.style.opacity), this.attributes.style = t.extend({}, e[this.getStyleType()], t.clone(this.attributes.style))) : this.attributes.style = e[this.getStyleType()], this.attributes.style.weight = parseFloat(this.attributes.style.weight)), this.attributes.type === "raster" && (this.attributes.style = t.extend({}, e.raster, t.clone(this.attributes.style))), this.attributes.type === "point" && (typeof this.attributes.icon == "undefined" ? this.attributes.icon = {
                    type: "marker"
                } : typeof this.attributes.icon.type == "undefined" && (this.attributes.icon.type = "marker"), this.attributes.icon.type === "marker" && (this.attributes.icon.width = 15, this.attributes.icon.height = 25), typeof this.attributes.clusterOptions == "undefined" ? this.attributes.clusterOptions = {
                    cluster: !1
                } : typeof this.attributes.clusterOptions.cluster == "undefined" && (this.attributes.clusterOptions.cluster = !0), this.attributes.clusterOptions.cluster && (this.attributes.clusterOptions.options = t.extend({}, typeof this.collection.options.mapConfig.clusterOptions != "undefined" ? this.collection.options.mapConfig.clusterOptions : {}, this.attributes.clusterOptions.options), typeof this.attributes.clusterOptions.iconStyle == "undefined" && (this.attributes.clusterOptions.iconStyle = {
                    size: 30,
                    "default": {
                        backgroundColor: this.attributes.style.fillColor,
                        color: this.attributes.style.color
                    }
                }), t.extend(this.attributes.clusterOptions.options, {
                    iconCreateFunction: t.bind(this.clusterIconCreateFunction, this)
                })))
            },
            initPrintScale: function() {
                this.scaleFactor = 1, this.scaleFactorCircle = 1, this.scaleFactorMarker = 1, this.collection.options.print && this.scaleFactorCircle === 1 && (this.scaleFactor = this.collection.options.mapConfig.printScales.default, this.scaleFactorCircle = this.collection.options.mapConfig.printScales.circle, this.scaleFactorMarker = this.collection.options.mapConfig.printScales.marker, typeof this.attributes.style.weight != "undefined" && (this.attributes.type !== "point" || this.attributes.icon.type !== "marker") && (this.attributes.style.weight = Math.min(this.attributes.style.weight * this.scaleFactor, 5)), typeof this.attributes.icon != "undefined" && this.attributes.icon.type === "circle" && (this.attributes.icon.size = this.attributes.icon.size * this.scaleFactorCircle), this.attributes.type === "point" && (this.attributes.clusterOptions.cluster && (this.attributes.clusterOptions.options.maxClusterRadius = this.attributes.clusterOptions.options.maxClusterRadius * this.scaleFactor), this.attributes.icon.type === "marker" && (this.attributes.icon.width = this.attributes.icon.width * this.scaleFactorMarker, this.attributes.icon.height = this.attributes.icon.height * this.scaleFactorMarker)))
            },
            initCssStyles: function() {
                this.attributes.cssStyle = t.clone(this.collection.options.mapConfig.cssStyle);
                if (typeof this.attributes.style != "undefined") {
                    if (this.attributes.style.weight > 0 || this.getStyleType() === "line") this.attributes.cssStyle.borderColor = this.attributes.style.color, this.attributes.cssStyle.borderWidth = Math.max(this.attributes.style.weight, this.getStyleType() === "circle" ? 1 : 2), this.attributes.cssStyle.borderRadius = typeof this.attributes.icon != "undefined" && this.attributes.icon.type === "circle" ? this.attributes.icon.size / 2 : 0;
                    if (this.getKeyType() === "categorical" || this.getKeyType() === "gradient") this.attributes.layerCategories = [], t.each(this.attributes.key.categories, function(e) {
                        var t = e.fillColor.colorToRgb(),
                            n = "rgba(" + t[0] + "," + t[1] + "," + t[2] + "," + Math.min(1, Math.max(.5, this.attributes.style.opacity * 1.5)) + ")",
                            r = typeof e.title != "undefined" ? typeof e.title == "object" ? e.title[lang] : e.title : this.getTitle();
                        this.attributes.layerCategories.push({
                            color: n,
                            label: r
                        })
                    }, this);
                    if (this.getKeyType() === "multiPolygon") {
                        this.attributes.cssStyle.borderColor = "", this.attributes.layerCategories = [];
                        var n = [];
                        t.each(this.attributes.featureStyle, function(e, r) {
                            r !== "attribute" && (e.style.fillColor = typeof e.style.fillColor != "undefined" ? e.style.fillColor : typeof e.style.color != "undefined" ? e.style.color : this.attributes.style.fillColor, e.style.fillOpacity = typeof e.style.fillOpacity != "undefined" ? e.style.fillOpacity : typeof e.style.opacity != "undefined" ? e.style.opacity : this.attributes.style.fillOpacity);
                            var i = t.extend({}, this.attributes.style, e.style);
                            if (r !== "attribute" && typeof i.fillColor != "undefined") {
                                var s = i.fillColor.colorToRgb(),
                                    o = "rgba(" + s[0] + "," + s[1] + "," + s[2] + "," + Math.min(1, Math.max(.5, i.fillOpacity * 1.5)) + ")";
                                n.push(o);
                                var u = typeof e.title != "undefined" ? typeof e.title == "object" ? e.title[lang] : e.title : this.getTitle();
                                this.attributes.layerCategories.push({
                                    color: o,
                                    label: u
                                })
                            }
                        }, this);
                        switch (n.length) {
                            case 0:
                                var r = this.attributes.style.fillColor.colorToRgb(),
                                    i = "rgba(" + r[0] + "," + r[1] + "," + r[2] + "," + Math.min(1, Math.max(.5, this.attributes.style.fillOpacity * 1.5)) + ")";
                                n.push(i), n.push(i), n.push(i), n.push(i);
                                break;
                            case 1:
                                n.push(n[0]), n.push(n[0]), n.push(n[0]);
                                break;
                            case 2:
                                n.push(n[1]), n.push(n[0]);
                                break;
                            case 3:
                                n.push(n[0])
                        }
                        t.each(n, function(e, t) {
                            t < 4 && (this.attributes.cssStyle.borderColor += e + " ")
                        }, this)
                    }
                    if (typeof this.attributes.style.fillColor != "undefined") {
                        var s = this.attributes.style.fillColor.colorToRgb();
                        this.attributes.cssStyle.backgroundColor = "rgba(" + s[0] + "," + s[1] + "," + s[2] + "," + Math.min(1, Math.max(.4, this.attributes.style.fillOpacity * 1.85)) + ")"
                    }
                    if (this.getStyleType() === "image") {
                        var o;
                        typeof this.attributes.key != "undefined" ? typeof this.attributes.key.iconRetinaUrl != "undefined" && L.Browser.retina ? o = this.attributes.key.iconRetinaUrl : typeof this.attributes.key.iconUrl != "undefined" && (o = this.attributes.key.iconUrl) : typeof this.attributes.icon.style.iconUrl == "object" ? o = this.attributes.icon.style.iconUrl.key : o = this.attributes.icon.style.iconUrl, this.attributes.cssStyle.backgroundImage = "url('" + e("#application").data("baseurl") + "/" + o + "')"
                    }
                }
            },
            initContentURL: function() {
                var e = "/";
                typeof this.attributes.pageid != "undefined" ? (e += "page/", e += typeof this.attributes.pageid != "undefined" ? this.attributes.pageid : this.id) : (e += "layers/", e += typeof this.attributes.contentid != "undefined" ? this.attributes.contentid : this.id), e += "/", this.set("url", e)
            },
            getKeyType: function() {
                var e;
                return typeof this.attributes.key != "undefined" && typeof this.attributes.key.type != "undefined" ? e = this.attributes.key.type : this.attributes.type === "polygon" && typeof this.attributes.featureStyle != "undefined" ? e = "multiPolygon" : e = this.getStyleType(), e
            },
            getStyleType: function() {
                var e = "default";
                return typeof this.attributes.key != "undefined" && typeof this.attributes.key.type != "undefined" ? e = this.attributes.key.type : this.attributes.type === "point" ? e = this.attributes.icon.type : this.attributes.type === "mixed" ? e = "polygon" : e = this.attributes.type, e
            },
            getKeySquareIcon: function(e) {
                return t.template(m)({
                    keySquare: this.getKeySquare("key-" + e + " key-inner"),
                    styleType: this.getStyleType(),
                    size: e
                })
            },
            getKeySquare: function(e) {
                switch (this.getKeyType()) {
                    case "multiPolygon":
                        return e += " multiple-areas", '<span class="' + e + '" style="' + this.getCssStyle() + '"></span>';
                    case "marker":
                        var n, r = this.attributes.style.fillColor.colorToRgb(),
                            i = "rgba(" + r[0] + "," + r[1] + "," + r[2] + "," + this.attributes.style.fillOpacity + ")";
                        r = this.attributes.style.color.colorToRgb();
                        var n = "rgba(" + r[0] + "," + r[1] + "," + r[2] + "," + this.attributes.style.opacity + ")",
                            s = t.template(g)({
                                color: n,
                                weight: this.attributes.style.weight,
                                fillColor: i
                            });
                        return s;
                    case "categorical":
                        return e += " categorical", t.template(v)({
                            colors: t.pluck(this.attributes.layerCategories, "color"),
                            classes: e
                        });
                    case "gradient":
                        e += " key-gradient";
                        var o = this.attributes.key.minmax.min.fillColor.colorToRgb();
                        o = "rgb(" + o[0] + "," + o[1] + "," + o[2] + ")";
                        var u = this.attributes.key.minmax.max.fillColor.colorToRgb();
                        return u = "rgb(" + u[0] + "," + u[1] + "," + u[2] + ")", t.template(p)({
                            min: o,
                            max: u,
                            classes: e
                        });
                    default:
                        return '<span class="' + e + '" style="' + this.getCssStyle() + '"></span>'
                }
            },
            makeLayerGradientKey: function() {
                if (this.getKeyType() === "gradient") {
                    var e = this.attributes.key.minmax.min.fillColor.colorToRgb();
                    e = "rgb(" + e[0] + "," + e[1] + "," + e[2] + ")";
                    var n = this.attributes.key.minmax.max.fillColor.colorToRgb();
                    return n = "rgb(" + n[0] + "," + n[1] + "," + n[2] + ")", t.template(d)({
                        minLabel: typeof this.attributes.key.minmax.min.title == "object" ? this.attributes.key.minmax.min.title[lang] : this.attributes.key.minmax.min.title,
                        maxLabel: typeof this.attributes.key.minmax.max.title == "object" ? this.attributes.key.minmax.max.title[lang] : this.attributes.key.minmax.max.title,
                        min: e,
                        max: n
                    })
                }
                return !1
            },
            makeLayerCategoriesKey: function() {
                if (this.getKeyType() === "multiPolygon" || this.getKeyType() === "categorical" || this.getKeyType() === "gradient") {
                    var e = [];
                    return t.each(this.attributes.layerCategories, function(t) {
                        e.push({
                            color: '<span class="feature-group-color" style="background-color:' + t.color + ';"></span>',
                            label: '<span class="feature-group-label hint">' + t.label + "</span>"
                        })
                    }, this), e
                }
                return !1
            },
            getCssStyle: function(e) {
                e = typeof e != "undefined" ? e : this.getKeyType();
                var t = "";
                switch (e) {
                    case "line":
                        t = "border-color:" + this.attributes.cssStyle.borderColor + ";";
                        break;
                    case "marker":
                    case "polygon":
                        t = "background-color:" + this.attributes.cssStyle.backgroundColor + ";", this.attributes.style.weight > 0 && (t += "border-color:" + this.attributes.cssStyle.borderColor + ";", t += "border-width:" + this.attributes.cssStyle.borderWidth + "px;");
                        break;
                    case "multiPolygon":
                        t = "border-color:" + this.attributes.cssStyle.borderColor + ";";
                        break;
                    case "circle":
                        t = "background-color:" + this.attributes.cssStyle.backgroundColor + ";", this.attributes.style.weight > 0 && (t += "border-color:" + this.attributes.cssStyle.borderColor + ";", t += "border-width:" + this.attributes.cssStyle.borderWidth + "px;");
                        break;
                    case "image":
                        t = "background-image:" + this.attributes.cssStyle.backgroundImage + ";"
                }
                return t
            },
            getMapLayer: function(e, t, n) {
                n = typeof n != "undefined" ? n : !1;
                if (this.isLoaded() && !n) typeof e != "undefined" && e(this.attributes.mapLayer, this);
                else {
                    var r = this;
                    this.attributes.loading && !n ? waitFor(function() {
                        return r.isLoaded()
                    }, function() {
                        typeof e != "undefined" && e(r.attributes.mapLayer, r)
                    }) : this.loadData(function(t) {
                        switch (r.attributes.type) {
                            case "point":
                                r.set("mapLayer", r.handleResultForPointLayer(t));
                                break;
                            case "polygon":
                                r.set("mapLayer", r.handleResultForPolygonLayer(t));
                            default:
                                r.set("mapLayer", t)
                        }
                        typeof e != "undefined" && e(r.attributes.mapLayer, r)
                    }, t)
                }
            },
            handleResultForPolygonLayer: function(e) {
                var n = this.collection.options.mapConfig,
                    r = typeof n.labelOptions != "undefined" ? n.labelOptions : {};
                this.set("features", new u(t.map(e.getLayers(), function(n) {
                    return t.extend({}, n.feature.properties, {
                        featureAttributeMap: this.attributes.featureAttributeMap,
                        featureLayer: n,
                        parentLayer: this,
                        labelOptions: r,
                        className: e.options.className
                    })
                }, this), {
                    model: o,
                    print: this.collection.options.print,
                    printScale: this.scaleFactor
                }));
                var i = new L.layerGroup;
                return t.each(this.get("features").models, function(e) {
                    i.addLayer(e.get("featureLayer"))
                }, this), i
            },
            handleResultForPointLayer: function(n) {
                var r = this.collection.options.mapConfig,
                    o = {};
                typeof r != "undefined" && typeof r.labelOptions != "undefined" && (o = e.extend(!0, {}, r.labelOptions)), o.options.className = typeof o.options.className != "undefined" ? o.options.className : "pointLabel", this.set("locations", new s(t.map(n.getLayers(), function(e) {
                    return t.extend({}, e.feature.properties, {
                        featureAttributeMap: this.attributes.featureAttributeMap,
                        markerLayer: e,
                        parentLayer: this,
                        labelOptions: o,
                        className: n.options.className
                    })
                }, this), {
                    model: i,
                    print: this.collection.options.print,
                    printScale: this.scaleFactorMarker
                }));
                var u = this.attributes.clusterOptions.cluster ? new L.markerClusterGroup(this.attributes.clusterOptions.options) : new L.layerGroup;
                return t.each(this.get("locations").models, function(e) {
                    u.addLayer(e.get("markerLayer"))
                }, this), u
            },
            clusterIconCreateFunction: function(e) {
                var n = this.attributes.clusterOptions.iconStyle,
                    r = typeof n.attribute != "undefined" ? t.uniq(t.map(e.getAllChildMarkers(), function(e) {
                        return e.options.parent.attributes[n.attribute]
                    })) : [],
                    i = r.length === 1 ? n[r[0]] : n["default"],
                    s = typeof i.backgroundColor != "undefined" ? i.backgroundColor.colorToRgb() : [255, 255, 255],
                    o = "background-color:rgba(" + s[0] + "," + s[1] + "," + s[2] + ",0.5);",
                    u = typeof i.backgroundColor != "undefined" ? "background-color:" + i.backgroundColor + ";" : "";
                return u += typeof i.color != "undefined" ? "color:" + i.color + ";" : "", new L.DivIcon({
                    html: t.template(h)({
                        css_outer: o,
                        css_inner: u,
                        childCount: e.getChildCount()
                    }),
                    className: "marker-cluster",
                    iconSize: new L.Point(n.size * this.scaleFactor, n.size * this.scaleFactor)
                })
            }
        });
        return y
    }), define("models/LayerCollection", ["jquery", "underscore", "backbone", "./LayerModel"], function(e, t, n, r) {
        var i = n.Collection.extend({
            model: r,
            initialize: function(e, t) {
                this.options = t || {}, this.on("add", function(e) {
                    e.set("baseurl", this.options.baseurl), e.set("print", this.options.print)
                })
            },
            byIds: function(e) {
                var t = this.filter(function(t) {
                    return e.indexOf(t.id) > -1
                });
                return new i(t)
            },
            bySource: function(e) {
                return new i(this.where({
                    source: e
                }))
            },
            setActive: function(e) {
                this.each(function(t) {
                    t.setActive(e.indexOf(t.id) > -1)
                })
            },
            byActive: function(e) {
                e = typeof e != "undefined" ? e : !0;
                var n = this.where({
                    active: e
                });
                return new i(t.sortBy(n, function(e) {
                    return e.get("activeTime")
                }).reverse())
            },
            byOptional: function(e) {
                return e = typeof e != "undefined" ? e : !0, new i(this.where({
                    optional: e,
                    basemap: !1
                }))
            },
            byActiveKey: function() {
                var e = this.byActive().byKey();
                return e.add(this.where({
                    basemap: !0
                })), e
            },
            byKey: function() {
                return new i(this.where({
                    showInKey: !0
                }))
            },
            byBasemap: function(e) {
                return e = typeof e != "undefined" ? e : !0, new i(this.where({
                    basemap: e
                }))
            },
            byLoading: function(e) {
                return e = typeof e != "undefined" ? e : !0, new i(this.where({
                    loading: e
                }))
            },
            isLoading: function() {
                return this.byLoading().length > 0
            },
            byOcean: function(e) {
                return new i(this.filter(function(t) {
                    return t.getOcean() === e
                }))
            },
            byCategory: function(e) {
                return new i(this.where({
                    category: e
                }))
            },
            bySubcategory: function(e) {
                return new i(this.where({
                    subcategory: e
                }))
            },
            byGroup: function(e) {
                return new i(this.where({
                    group: e
                }))
            },
            getCategories: function() {
                return t.unique(t.map(this.models, function(e) {
                    return e.attributes.category
                }))
            },
            getSubcategories: function() {
                return t.unique(t.map(this.models.where(function(e) {
                    return typeof e.attributes.subcategory != "undefined"
                }), function(e) {
                    return e.attributes.subcategory
                }))
            },
            getGroups: function() {
                return t.unique(t.map(this.models.where(function(e) {
                    return typeof e.attributes.subcategory != "undefined"
                }), function(e) {
                    return e.attributes.group
                }))
            },
            getIds: function() {
                return t.map(this.models, function(e) {
                    return e.id
                })
            }
        });
        return i
    }), define("models/LayerModelArcGis", ["jquery", "underscore", "backbone", "./LayerModel", "leaflet", "esri.leaflet", "proj4.leaflet"], function(e, t, n, r, i, s, o) {
        var u = r.extend({
            propSort: function(e) {
                return !e instanceof Array && (e = e.split(",")),
                    function(n, r) {
                        var i;
                        n = n.attributes, r = r.attributes;
                        for (var s = 0; s < e.length; s++) {
                            i = e[s];
                            if (typeof n[i] == "undefined") return -1;
                            if (n[i] < r[i]) return -1;
                            if (n[i] > r[i]) return 1
                        }
                        return 0
                    }
            },
            loadData: function(n) {
                this.setLoading(!0);
                var r = e.param(t.extend({}, this.attributes.mapConfig.arcgisOptions.queryArgs, this.attributes.queryArgs)),
                    i = this;
                e.ajax({
                    dataType: "json",
                    url: i.getURL() + "query?" + r,
                    success: function(e) {
                        i.setLoading(!1), e.error ? console.log("error loading arcgis layer " + this.id + ". message: " + e.error.message + " - code: " + e.error.code) : e.error || e.features.length < 1 ? console.log("error loading arcgis layer " + this.id + " - no features") : (typeof i.attributes.sortBy != "undefined" && e.features.sort(i.propSort(i.attributes.sortBy)).reverse(), n(L.Proj.geoJson(t.extend({}, L.esri.Util.responseToFeatureCollection(e), {
                            crs: i.getCrs()
                        }), {
                            style: i.attributes.style,
                            className: "wwf-layer wwf-layer-" + i.id + " " + "wwf-layer-type-" + i.attributes.type
                        })))
                    },
                    error: function() {
                        i.setLoading(!1), console.log("error loading arcgis layer")
                    }
                })
            },
            getURL: function() {
                return "//" + this.attributes.mapConfig.arcgisOptions.ip + "/" + this.attributes.mapConfig.arcgisOptions.path + "/" + this.attributes.path
            }
        });
        return u
    }), define("models/LayerModelArcGisRaster", ["jquery", "underscore", "backbone", "./LayerModel", "leaflet", "esri.leaflet", "proj4.leaflet"], function(e, t, n, r, i, s, o) {
        var u = r.extend({
            loadData: function(n, r) {
                this.setLoading(!0);
                var i = this.attributes.options.bbox,
                    s = 0;
                if (typeof this.attributes.options.imageSize != "undefined") s = this.attributes.options.imageSize;
                else {
                    var o = r.map.project([i.XMin, i.YMin], this.attributes.mapConfig.mapOptions.maxZoom),
                        u = r.map.project([i.XMax, i.YMax], this.attributes.mapConfig.mapOptions.maxZoom);
                    s = Math.max(Math.abs(o.x - u.x), Math.abs(o.y - u.y))
                }
                var a = e.param(t.extend({}, this.attributes.mapConfig.arcgisOptions.queryArgsRaster, {
                        bbox: i.XMin + "," + i.YMin + "," + i.XMax + "," + i.YMax,
                        bboxSR: this.attributes.options.bboxSR,
                        imageSR: this.attributes.options.imageSR,
                        size: s + "," + s
                    })),
                    f = this;
                n(L.Proj.imageOverlay(f.getURL() + "export?" + a, L.bounds([i.XMin, i.YMin], [i.XMax, i.YMax]), f.attributes.style).on("load", function() {
                    f.setLoading(!1)
                }))
            },
            getURL: function() {
                return "//" + this.attributes.mapConfig.arcgisOptions.ip + "/" + this.attributes.mapConfig.arcgisOptions.path + "/" + this.attributes.path
            }
        });
        return u
    }), ! function() {
        function t(e, t) {
            function u(t) {
                var n = e.arcs[t < 0 ? ~t : t],
                    r = n[0],
                    i;
                return e.transform ? (i = [0, 0], n.forEach(function(e) {
                    i[0] += e[0], i[1] += e[1]
                })) : i = n[n.length - 1], t < 0 ? [i, r] : [r, i]
            }

            function a(e, t) {
                for (var r in e) {
                    var i = e[r];
                    delete t[i.start], delete i.start, delete i.end, i.forEach(function(e) {
                        n[e < 0 ? ~e : e] = 1
                    }), s.push(i)
                }
            }
            var n = {},
                r = {},
                i = {},
                s = [],
                o = -1;
            return t.forEach(function(n, r) {
                var i = e.arcs[n < 0 ? ~n : n],
                    s;
                i.length < 3 && !i[1][0] && !i[1][1] && (s = t[++o], t[o] = n, t[r] = s)
            }), t.forEach(function(e) {
                var t = u(e),
                    n = t[0],
                    s = t[1],
                    o, a;
                if (o = i[n]) {
                    delete i[o.end], o.push(e), o.end = s;
                    if (a = r[s]) {
                        delete r[a.start];
                        var f = a === o ? o : o.concat(a);
                        r[f.start = o.start] = i[f.end = a.end] = f
                    } else r[o.start] = i[o.end] = o
                } else if (o = r[s]) {
                    delete r[o.start], o.unshift(e), o.start = n;
                    if (a = i[n]) {
                        delete i[a.end];
                        var l = a === o ? o : a.concat(o);
                        r[l.start = a.start] = i[l.end = o.end] = l
                    } else r[o.start] = i[o.end] = o
                } else o = [e], r[o.start = n] = i[o.end = s] = o
            }), a(i, r), a(r, i), t.forEach(function(e) {
                n[e < 0 ? ~e : e] || s.push([e])
            }), s
        }

        function n(e, n, r) {
            var i = [];
            if (arguments.length > 1) {
                var s = [],
                    o;

                function u(e) {
                    var t = e < 0 ? ~e : e;
                    (s[t] || (s[t] = [])).push({
                        i: e,
                        g: o
                    })
                }

                function a(e) {
                    e.forEach(u)
                }

                function f(e) {
                    e.forEach(a)
                }

                function l(e) {
                    e.type === "GeometryCollection" ? e.geometries.forEach(l) : e.type in c && (o = e, c[e.type](e.arcs))
                }
                var c = {
                    LineString: a,
                    MultiLineString: f,
                    Polygon: f,
                    MultiPolygon: function(e) {
                        e.forEach(f)
                    }
                };
                l(n), s.forEach(arguments.length < 3 ? function(e) {
                    i.push(e[0].i)
                } : function(e) {
                    r(e[0].g, e[e.length - 1].g) && i.push(e[0].i)
                })
            } else
                for (var h = 0, p = e.arcs.length; h < p; ++h) i.push(h);
            return {
                type: "MultiLineString",
                arcs: t(e, i)
            }
        }

        function r(e, n) {
            function u(e) {
                e.forEach(function(t) {
                    t.forEach(function(t) {
                        (r[t = t < 0 ? ~t : t] || (r[t] = [])).push(e)
                    })
                }), i.push(e)
            }

            function a(t) {
                return c(o(e, {
                    type: "Polygon",
                    arcs: [t]
                }).coordinates[0]) > 0
            }
            var r = {},
                i = [],
                s = [];
            return n.forEach(function(e) {
                e.type === "Polygon" ? u(e.arcs) : e.type === "MultiPolygon" && e.arcs.forEach(u)
            }), i.forEach(function(e) {
                if (!e._) {
                    var t = [],
                        n = [e];
                    e._ = 1, s.push(t);
                    while (e = n.pop()) t.push(e), e.forEach(function(e) {
                        e.forEach(function(e) {
                            r[e < 0 ? ~e : e].forEach(function(e) {
                                e._ || (e._ = 1, n.push(e))
                            })
                        })
                    })
                }
            }), i.forEach(function(e) {
                delete e._
            }), {
                type: "MultiPolygon",
                arcs: s.map(function(n) {
                    var i = [],
                        s;
                    n.forEach(function(e) {
                        e.forEach(function(e) {
                            e.forEach(function(e) {
                                r[e < 0 ? ~e : e].length < 2 && i.push(e)
                            })
                        })
                    }), i = t(e, i);
                    if ((s = i.length) > 1) {
                        var o = a(n[0][0]);
                        for (var u = 0, f; u < s; ++u)
                            if (o === a(i[u])) {
                                f = i[0], i[0] = i[u], i[u] = f;
                                break
                            }
                    }
                    return i
                })
            }
        }

        function i(e, t) {
            return t.type === "GeometryCollection" ? {
                type: "FeatureCollection",
                features: t.geometries.map(function(t) {
                    return s(e, t)
                })
            } : s(e, t)
        }

        function s(e, t) {
            var n = {
                type: "Feature",
                id: t.id,
                properties: t.properties || {},
                geometry: o(e, t)
            };
            return t.id == null && delete n.id, n
        }

        function o(e, t) {
            function i(e, t) {
                t.length && t.pop();
                for (var i = r[e < 0 ? ~e : e], s = 0, o = i.length, a; s < o; ++s) t.push(a = i[s].slice()), n(a, s);
                e < 0 && u(t, o)
            }

            function s(e) {
                return e = e.slice(), n(e, 0), e
            }

            function o(e) {
                var t = [];
                for (var n = 0, r = e.length; n < r; ++n) i(e[n], t);
                return t.length < 2 && t.push(t[0].slice()), t
            }

            function a(e) {
                var t = o(e);
                while (t.length < 4) t.push(t[0].slice());
                return t
            }

            function f(e) {
                return e.map(a)
            }

            function l(e) {
                var t = e.type;
                return t === "GeometryCollection" ? {
                    type: t,
                    geometries: e.geometries.map(l)
                } : t in c ? {
                    type: t,
                    coordinates: c[t](e)
                } : null
            }
            var n = v(e.transform),
                r = e.arcs,
                c = {
                    Point: function(e) {
                        return s(e.coordinates)
                    },
                    MultiPoint: function(e) {
                        return e.coordinates.map(s)
                    },
                    LineString: function(e) {
                        return o(e.arcs)
                    },
                    MultiLineString: function(e) {
                        return e.arcs.map(o)
                    },
                    Polygon: function(e) {
                        return f(e.arcs)
                    },
                    MultiPolygon: function(e) {
                        return e.arcs.map(f)
                    }
                };
            return l(t)
        }

        function u(e, t) {
            var n, r = e.length,
                i = r - t;
            while (i < --r) n = e[i], e[i++] = e[r], e[r] = n
        }

        function a(e, t) {
            var n = 0,
                r = e.length;
            while (n < r) {
                var i = n + r >>> 1;
                e[i] < t ? n = i + 1 : r = i
            }
            return n
        }

        function f(e) {
            function r(e, n) {
                e.forEach(function(e) {
                    e < 0 && (e = ~e);
                    var r = t[e];
                    r ? r.push(n) : t[e] = [n]
                })
            }

            function i(e, t) {
                e.forEach(function(e) {
                    r(e, t)
                })
            }

            function s(e, t) {
                e.type === "GeometryCollection" ? e.geometries.forEach(function(e) {
                    s(e, t)
                }) : e.type in o && o[e.type](e.arcs, t)
            }
            var t = {},
                n = e.map(function() {
                    return []
                }),
                o = {
                    LineString: r,
                    MultiLineString: i,
                    Polygon: i,
                    MultiPolygon: function(e, t) {
                        e.forEach(function(e) {
                            i(e, t)
                        })
                    }
                };
            e.forEach(s);
            for (var u in t)
                for (var f = t[u], l = f.length, c = 0; c < l; ++c)
                    for (var h = c + 1; h < l; ++h) {
                        var p = f[c],
                            d = f[h],
                            v;
                        (v = n[p])[u = a(v, d)] !== d && v.splice(u, 0, d), (v = n[d])[u = a(v, p)] !== p && v.splice(u, 0, p)
                    }
            return n
        }

        function l(e, t) {
            function s(e) {
                i.remove(e), e[1][2] = t(e), i.push(e)
            }
            var n = v(e.transform),
                r = m(e.transform),
                i = d();
            return t || (t = h), e.arcs.forEach(function(e) {
                var o = [],
                    u = 0,
                    a;
                for (var f = 0, l = e.length, c; f < l; ++f) c = e[f], n(e[f] = [c[0], c[1], Infinity], f);
                for (var f = 1, l = e.length - 1; f < l; ++f) a = e.slice(f - 1, f + 2), a[1][2] = t(a), o.push(a), i.push(a);
                for (var f = 0, l = o.length; f < l; ++f) a = o[f], a.previous = o[f - 1], a.next = o[f + 1];
                while (a = i.pop()) {
                    var h = a.previous,
                        p = a.next;
                    a[1][2] < u ? a[1][2] = u : u = a[1][2], h && (h.next = p, h[2] = a[2], s(h)), p && (p.previous = h, p[0] = a[0], s(p))
                }
                e.forEach(r)
            }), e
        }

        function c(e) {
            var t = -1,
                n = e.length,
                r, i = e[n - 1],
                s = 0;
            while (++t < n) r = i, i = e[t], s += r[0] * i[1] - r[1] * i[0];
            return s / 2
        }

        function h(e) {
            var t = e[0],
                n = e[1],
                r = e[2];
            return Math.abs((t[0] - r[0]) * (n[1] - t[1]) - (t[0] - n[0]) * (r[1] - t[1]))
        }

        function p(e, t) {
            return e[1][2] - t[1][2]
        }

        function d() {
            function r(e, n) {
                while (n > 0) {
                    var r = (n + 1 >> 1) - 1,
                        i = t[r];
                    if (p(e, i) >= 0) break;
                    t[i._ = n] = i, t[e._ = n = r] = e
                }
            }

            function i(e, r) {
                for (;;) {
                    var i = r + 1 << 1,
                        s = i - 1,
                        o = r,
                        u = t[o];
                    s < n && p(t[s], u) < 0 && (u = t[o = s]), i < n && p(t[i], u) < 0 && (u = t[o = i]);
                    if (o === r) break;
                    t[u._ = r] = u, t[e._ = r = o] = e
                }
            }
            var e = {},
                t = [],
                n = 0;
            return e.push = function(e) {
                return r(t[e._ = n] = e, n++), n
            }, e.pop = function() {
                if (n <= 0) return;
                var e = t[0],
                    r;
                return --n > 0 && (r = t[n], i(t[r._ = 0] = r, 0)), e
            }, e.remove = function(e) {
                var s = e._,
                    o;
                if (t[s] !== e) return;
                return s !== --n && (o = t[n], (p(o, e) < 0 ? r : i)(t[o._ = s] = o, s)), s
            }, e
        }

        function v(e) {
            if (!e) return g;
            var t, n, r = e.scale[0],
                i = e.scale[1],
                s = e.translate[0],
                o = e.translate[1];
            return function(e, u) {
                u || (t = n = 0), e[0] = (t += e[0]) * r + s, e[1] = (n += e[1]) * i + o
            }
        }

        function m(e) {
            if (!e) return g;
            var t, n, r = e.scale[0],
                i = e.scale[1],
                s = e.translate[0],
                o = e.translate[1];
            return function(e, u) {
                u || (t = n = 0);
                var a = (e[0] - s) / r | 0,
                    f = (e[1] - o) / i | 0;
                e[0] = a - t, e[1] = f - n, t = a, n = f
            }
        }

        function g() {}
        var e = {
            version: "1.6.20",
            mesh: function(e) {
                return o(e, n.apply(this, arguments))
            },
            meshArcs: n,
            merge: function(e) {
                return o(e, r.apply(this, arguments))
            },
            mergeArcs: r,
            feature: i,
            neighbors: f,
            presimplify: l
        };
        typeof define == "function" && define.amd ? define("topojson", e) : typeof module == "object" && module.exports ? module.exports = e : this.topojson = e
    }(), define("models/LayerModelTopo", ["jquery", "underscore", "backbone", "./LayerModel", "topojson"], function(e, t, n, r, i) {
        var s = r.extend({
            loadData: function(n) {
                this.setLoading(!0);
                var r = this;
                e.ajax({
                    dataType: "json",
                    url: this.attributes.baseurl + "/" + this.attributes.path,
                    success: function(e) {
                        var s = i.feature(e, e.objects[Object.keys(e.objects)[0]]);
                        r.setLoading(!1), n(L.Proj.geoJson(t.extend({}, s, {
                            crs: r.getCrs()
                        }), {
                            style: r.attributes.style,
                            filter: function(e) {
                                return typeof r.attributes.filters != "undefined" ? t.reduce(r.attributes.filters, function(t, n, r) {
                                    return t || e.properties[r] === n
                                }, !1) : !0
                            },
                            className: "wwf-layer wwf-layer-" + r.id + " " + "wwf-layer-type-" + r.attributes.type
                        }))
                    },
                    error: function() {
                        r.setLoading(!1)
                    }
                })
            }
        });
        return s
    }), define("models/LayerModelGeoJson", ["jquery", "underscore", "backbone", "./LayerModel", "proj4.leaflet"], function(e, t, n, r, i) {
        var s = r.extend({
            loadData: function(n) {
                this.setLoading(!0);
                var r = this;
                e.ajax({
                    dataType: "json",
                    url: this.attributes.baseurl + "/" + this.attributes.path,
                    success: function(e) {
                        r.setLoading(!1), n(L.Proj.geoJson(t.extend({}, e, {
                            crs: r.getCrs()
                        }), {
                            style: r.attributes.style,
                            filter: function(e) {
                                return typeof r.attributes.filters != "undefined" ? t.reduce(r.attributes.filters, function(t, n, r) {
                                    return t || e.properties[r] === n
                                }, !1) : !0
                            },
                            className: "wwf-layer wwf-layer-" + r.id + " " + "wwf-layer-type-" + r.attributes.type
                        }))
                    },
                    error: function() {
                        console.log("error loading geojson layer"), r.setLoading(!1)
                    }
                })
            }
        });
        return s
    }), define("models/LayerModelMapboxTiles", ["jquery", "underscore", "backbone", "./LayerModel", "leaflet"], function(e, t, n, r, i) {
        var s = r.extend({
            loadData: function(e) {
                this.setLoading(!0);
                var t = this.attributes.options.id;
                this.collection.options.print && typeof this.attributes.options.printId != "undefined" ? t = this.attributes.options.printId : L.Browser.retina && typeof this.attributes.options.retinaId != "undefined" && (t = this.attributes.options.retinaId);
                var n = this;
                e(L.tileLayer("http://{s}.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={token}", {
                    detectRetina: !0,
                    id: t,
                    subdomains: ["a", "b", "c", "d"],
                    token: this.attributes.options.accessToken,
                    zIndex: this.isBasemap() ? 0 : 1,
                    opacity: this.isBasemap() ? 1 : typeof this.attributes.options.opacity != "undefined" ? this.attributes.options.opacity : this.attributes.style.opacity
                }).on("loading", function() {}).on("load", function() {
                    n.setLoading(!1)
                }))
            }
        });
        return s
    }), define("models/LayerModelCustom", ["jquery", "underscore", "backbone", "./LayerModel", "leaflet", "leaflet.draw", "text!templates/divSvgIconTemplate.html"], function(e, t, n, r, i, s, o) {
        var u = r.extend({
            initializeSource: function() {
                var e = parseInt(this.id.split("_c")[1]),
                    t = tlang.ux.layers.custom_default_title + (e > 0 ? " " + (e + 1) : "");
                this.set("mapLayer", new L.FeatureGroup), this.set("ocean", this.id.split("_c")[0]), this.setTitle(t);
                var n = this.getRandomColor();
                this.set("style", {
                    fillColor: n,
                    color: n,
                    weight: 3
                }), this.attributes.icon = {
                    type: "marker",
                    width: 15,
                    height: 25
                }, this.set("control", new L.Control.Draw({
                    draw: {
                        rectangle: {
                            showArea: !1
                        },
                        polygon: {
                            showArea: !1
                        },
                        circle: {
                            showRadius: !1
                        },
                        polyline: {
                            showLength: !1
                        },
                        marker: {
                            icon: this.getMarkerIcon()
                        }
                    },
                    edit: {
                        featureGroup: this.attributes.mapLayer,
                        edit: {
                            selectedPathOptions: {
                                maintainColor: !0
                            }
                        }
                    },
                    position: "topright"
                })), L.drawLocal = {
                    draw: {
                        toolbar: {
                            actions: {
                                title: tlang.ux.layers.cancel,
                                text: tlang.ux.layers.cancel
                            },
                            finish: {
                                title: tlang.ux.layers.draw.finish,
                                text: tlang.ux.layers.draw.finish
                            },
                            undo: {
                                title: tlang.ux.layers.draw.undo,
                                text: tlang.ux.layers.draw.undo
                            },
                            buttons: {
                                polyline: tlang.ux.layers.draw.add_line,
                                polygon: tlang.ux.layers.draw.add_area,
                                rectangle: tlang.ux.layers.draw.add_rectangle,
                                circle: tlang.ux.layers.draw.add_circle,
                                marker: tlang.ux.layers.draw.add_marker
                            }
                        },
                        handlers: {
                            circle: {
                                tooltip: {
                                    start: tlang.ux.layers.draw.circle_tooltip
                                }
                            },
                            marker: {
                                tooltip: {
                                    start: tlang.ux.layers.draw.marker_tooltip
                                }
                            },
                            polygon: {
                                tooltip: {
                                    start: tlang.ux.layers.draw.polygon_tooltip_start,
                                    cont: tlang.ux.layers.draw.polygon_tooltip_continue,
                                    end: tlang.ux.layers.draw.polygon_tooltip_end
                                }
                            },
                            polyline: {
                                tooltip: {
                                    start: tlang.ux.layers.draw.line_tooltip_start,
                                    cont: tlang.ux.layers.draw.line_tooltip_continue,
                                    end: tlang.ux.layers.draw.line_tooltip_end
                                }
                            },
                            rectangle: {
                                tooltip: {
                                    start: tlang.ux.layers.draw.rectangle_tooltip
                                }
                            },
                            simpleshape: {
                                tooltip: {
                                    end: tlang.ux.layers.draw.tooltip_end
                                }
                            }
                        }
                    },
                    edit: {
                        toolbar: {
                            actions: {
                                save: {
                                    title: tlang.ux.layers.confirm,
                                    text: tlang.ux.layers.confirm
                                },
                                cancel: {
                                    title: tlang.ux.layers.cancel,
                                    text: tlang.ux.layers.cancel
                                }
                            },
                            buttons: {
                                edit: tlang.ux.layers.draw.edit,
                                editDisabled: tlang.ux.layers.draw.edit,
                                remove: tlang.ux.layers.draw.remove,
                                removeDisabled: tlang.ux.layers.draw.remove
                            }
                        },
                        handlers: {
                            edit: {
                                tooltip: {
                                    text: tlang.ux.layers.draw.edit_tooltip,
                                    subtext: tlang.ux.layers.draw.edit_tooltip_hint
                                }
                            },
                            remove: {
                                tooltip: {
                                    text: tlang.ux.layers.draw.remove_tooltip
                                }
                            }
                        }
                    }
                }
            },
            getMarkerIcon: function() {
                var e = this.attributes.icon.width,
                    n = this.attributes.icon.height,
                    r = t.template(o)({
                        color: "rgba(0,0,0,0.5)",
                        weight: 2,
                        fillColor: this.attributes.style.fillColor
                    });
                return L.icon({
                    iconUrl: "data:image/svg+xml;base64," + btoa(r),
                    iconSize: [e, n],
                    iconAnchor: [e / 2, n]
                })
            },
            getDrawControl: function() {
                return this.attributes.control
            },
            getColor: function() {
                return this.attributes.style.color
            },
            setColor: function(e) {
                this.set("style", t.extend(this.attributes.style, {
                    fillColor: e,
                    color: e
                })), this.initStyles(), this.initCssStyles()
            },
            getRandomColor: function() {
                return "#" + Math.random().toString(16).slice(2, 8).toUpperCase()
            },
            getMapLayer: function(e) {
                e(this.attributes.mapLayer, this)
            },
            setEdit: function(e) {
                this.set("edit", e)
            },
            isEdit: function() {
                return this.attributes.edit
            },
            setTitle: function(e) {
                this.set("title", e)
            },
            getTitle: function() {
                return this.attributes.title
            },
            setCustomData: function(e) {
                if (typeof e != "undefined" && e.id === this.id) {
                    typeof e.title != "undefined" && this.setTitle(e.title), typeof e.color != "undefined" && this.setColor(e.color);
                    if (typeof e.shapes != "undefined") {
                        this.attributes.mapLayer.clearLayers();
                        if (e.shapes.length > 0) {
                            var n = this;
                            t.each(e.shapes, function(e) {
                                L.geoJson(e, {
                                    onEachFeature: function(t, r) {
                                        switch (e.properties.type) {
                                            case "rectangle":
                                                var i = new L.Rectangle(r.getBounds(), n.attributes.style);
                                                i.feature = r.feature, r = i;
                                                break;
                                            case "circle":
                                                var s = new L.Circle(r.getLatLng(), e.properties.radius, n.attributes.style);
                                                s.feature = r.feature, r = s;
                                                break;
                                            case "polyline":
                                                var o = new L.Polyline(r.getLatLngs(), n.attributes.style);
                                                o.feature = r.feature, r = o;
                                                break;
                                            case "polygon":
                                                var o = new L.Polygon(r.getLatLngs(), n.attributes.style);
                                                o.feature = r.feature, r = o;
                                                break;
                                            case "marker":
                                                var u = new L.marker(r.getLatLng(), {
                                                    icon: n.getMarkerIcon()
                                                });
                                                u.feature = r.feature, r = u
                                        }
                                        n.attributes.mapLayer.addLayer(r)
                                    }
                                })
                            })
                        }
                    }
                }
            },
            getReference: function(e) {
                return e = typeof e != "undefined" ? e : !1, e ? tlang.ux.print.custom_attribution : ""
            }
        });
        return u
    }), define("models/LayerModelNav", ["jquery", "underscore", "backbone", "./LayerModel", "leaflet", "proj4.leaflet", "./LocationModel", "./LocationCollection"], function(e, t, n, r, i, s, o, u) {
        var a = r.extend({
            makeLayer: function(e, n) {
                this.set("title", "");
                var r = this.makeGeoJsonLayer(e);
                n = typeof n != "undefined" ? n : {};
                var i = typeof n.labelOptions != "undefined" ? n.labelOptions : {},
                    s = this;
                this.set("locations", new u(t.map(r.getLayers(), function(e) {
                    return t.extend({}, e.feature.properties, {
                        markerLayer: e,
                        parentLayer: s,
                        labelOptions: i,
                        className: r.options.className
                    })
                }), {
                    model: o,
                    eventContext: this.collection.options.eventContext
                }));
                var a = new L.layerGroup;
                t.each(this.get("locations").models, function(e) {
                    a.addLayer(e.get("markerLayer"))
                }, this), this.set("mapLayer", a)
            },
            makeGeoJsonLayer: function(e) {
                return L.Proj.geoJson({
                    type: "FeatureCollection",
                    crs: {
                        type: "name",
                        properties: {
                            name: "urn:ogc:def:crs:EPSG::4326"
                        }
                    },
                    features: t.map(e, function(e) {
                        return {
                            type: "Feature",
                            properties: {
                                id: e.id,
                                title: e.title
                            },
                            geometry: {
                                type: "Point",
                                coordinates: e.location
                            }
                        }
                    })
                })
            },
            getMapLayer: function(e) {
                e(this.attributes.mapLayer, this)
            }
        });
        return a
    }), define("components/app/AppView", ["jquery", "underscore", "backbone", "jsonpack", "domReady!", "./header/HeaderView", "./header/HeaderModel", "./key/KeyView", "./key/KeyModel", "./print/PrintView", "./print/PrintModel", "./story/StoryView", "./story/StoryViewModel", "./home/HomeView", "./ocean/OceanView", "./ocean/OceanViewModel", "./pages/PagesView", "./pages/PagesModel", "./map/MapView", "./map/MapModel", "./modal/ModalView", "./modal/ModalModel", "./layers/LayersView", "./layers/LayersModel", "models/ViewModel", "models/LayerCollection", "models/LayerModelArcGis", "models/LayerModelArcGisRaster", "models/LayerModelTopo", "models/LayerModelGeoJson", "models/LayerModelMapboxTiles", "models/LayerModelCustom", "models/LayerModelNav"], function(e, t, n, r, i, s, o, u, a, f, l, c, h, p, d, v, m, g, y, b, w, E, S, x, T, N, C, k, L, A, O, M, _) {
        var D = n.View.extend({
            el: e("#application"),
            events: {
                "click .close-item": function(e, t) {
                    e.preventDefault();
                    var n = this.model.getHistoryWithoutPages();
                    n.length === 0 ? this.model.getRouter().resetApp() : this.model.getRouter().goToFragment(n[n.length - 1].fragment)
                },
                "click .module-link": function(t) {
                    t.preventDefault();
                    var n = e(t.target).closest("[data-module]").data("module");
                    this.$el.trigger("moduleLinkClick", {
                        target: t.target,
                        id: n
                    })
                },
                "click .ocean-link": function(t) {
                    t.preventDefault();
                    var n = e(t.target).closest("[data-oceanid]").data("oceanid");
                    this.$el.trigger("oceanLinkClick", {
                        target: t.target,
                        id: n
                    })
                },
                "click .page-link": function(t) {
                    t.preventDefault();
                    var n = e(t.target).closest("[data-pageid]").data("pageid");
                    this.$el.trigger("pageLinkClick", {
                        target: t.target,
                        id: n
                    })
                },
                moduleLinkClick: function(e, t) {
                    var n = t.id;
                    switch (n) {
                        case "story":
                            this.model.getRouter().update({
                                link: !0,
                                route: "ocean",
                                path: this.model.getActiveOceanId(),
                                query: {
                                    view: this.model.getActiveOcean().getMapview(),
                                    clayers: this.model.getCustomLayerIds(),
                                    cdata: this.model.getCustomData()
                                }
                            });
                            break;
                        case "layers":
                            this.model.getRouter().update({
                                link: !0,
                                route: "layers",
                                path: "home",
                                query: {
                                    view: this.model.getActiveOcean().getMapview(),
                                    ocean: this.model.getActiveOceanId(),
                                    clayers: this.model.getCustomLayerIds(),
                                    cdata: this.model.getCustomData()
                                }
                            })
                    }
                },
                resetApp: function(e, t) {
                    this.model.getRouter().resetApp()
                },
                pageLinkClick: function(e, t) {
                    this.model.getRouter().update({
                        link: !0,
                        route: "page",
                        path: t.id,
                        query: {
                            view: this.model.getActiveMapview(!0),
                            clayers: this.model.getCustomLayerIds(),
                            cdata: this.model.getCustomData()
                        }
                    })
                },
                storyLinkClick: function(e, t) {
                    this.model.getRouter().update({
                        link: !0,
                        route: "story",
                        path: t.id,
                        query: {
                            view: this.model.getStory(t.id).getMapview(),
                            clayers: this.model.getCustomLayerIds(),
                            cdata: this.model.getCustomData()
                        }
                    })
                },
                nextStoryLinkClick: function(e, t) {
                    this.$el.trigger("storyLinkClick", {
                        target: e.target,
                        id: this.model.getNextStoryId()
                    })
                },
                previousStoryLinkClick: function(e, t) {
                    this.$el.trigger("storyLinkClick", {
                        target: e.target,
                        id: this.model.getPreviousStoryId()
                    })
                },
                oceanLinkClick: function(e, t) {
                    this.model.getRouter().update({
                        link: !0,
                        route: "ocean",
                        path: t.id,
                        query: {
                            view: this.model.getOcean(t.id).getMapview(),
                            clayers: this.model.getCustomLayerIds(),
                            cdata: this.model.getCustomData()
                        }
                    })
                },
                nextOceanLinkClick: function(e, t) {
                    this.$el.trigger("oceanLinkClick", {
                        target: e.target,
                        id: this.model.getNextOceanId()
                    })
                },
                previousOceanLinkClick: function(e, t) {
                    this.$el.trigger("oceanLinkClick", {
                        target: e.target,
                        id: this.model.getPreviousOceanId()
                    })
                },
                storeMap: function(e) {
                    this.model.storeMapStateOnServer()
                },
                printMap: function(e, t) {
                    this.model.storeMapStateOnServer(!0)
                },
                shareOnFacebook: function(e, t) {
                    this.model.storeMapStateOnServer(!0)
                },
                printMapModal: function(e) {
                    this.model.getRouter().queryUpdate({
                        modal: "print",
                        modalid: this.model.storeMapStateOnServer(!0)
                    })
                },
                mapViewUpdated: function(e, t) {
                    var n = t.center.lat + "|" + t.center.lng + "|" + t.zoom + "||" + t.dimensions[0] + "|" + t.dimensions[1];
                    n !== this.model.getActiveMapview(!0) && this.model.getRouter().queryUpdate({
                        view: n
                    })
                },
                addCustomLayer: function(e, n) {
                    var r = this.model.getCustomLayerIds(),
                        i = r.length ? parseInt(t.last(r).split("_c")[1]) + 1 : 0,
                        s = n.ocean + "_c" + i;
                    this.model.getRouter().queryUpdate({
                        layers: t.uniq(this.model.getActiveLayerIds().concat(s)),
                        clayers: r.concat(s),
                        cedit: s
                    })
                },
                removeCustomLayer: function(e, n) {
                    var i = n.id,
                        s = t.reject(this.model.getCustomData(!0), function(e) {
                            return e.id = i
                        });
                    this.model.getRouter().queryUpdate({
                        layers: t.without(this.model.getActiveLayerIds(), i),
                        clayers: t.without(this.model.getCustomLayerIds(), i),
                        cedit: this.model.getCustomEdit() === i ? "" : this.model.getCustomEdit(),
                        cdata: s.length > 0 ? r.pack(s) : ""
                    })
                },
                editCustomLayer: function(e, n) {
                    this.model.getRouter().update({
                        link: !0,
                        extendQuery: !0,
                        route: "layers",
                        path: "home",
                        query: {
                            layers: t.uniq(this.model.getActiveLayerIds().concat(n.id)),
                            cat: "custom",
                            cedit: this.model.getCustomEdit() === n.id ? "" : n.id
                        }
                    })
                },
                customDeleted: function(e, n) {
                    var i = this.model.getCustomData(!0),
                        s = t.findWhere(i, {
                            id: n.layer.id
                        });
                    if (typeof s != "undefined") {
                        if (typeof n.layer.shapes != "undefined") {
                            var o = [];
                            t.each(s.shapes, function(e) {
                                n.layer.shapes.indexOf(e.properties.featureid) < 0 && o.push(e)
                            }), s.shapes = o
                        }
                        this.model.getRouter().queryUpdate({
                            cdata: r.pack(i)
                        })
                    }
                },
                customUpdated: function(e, n) {
                    var i = this.model.getCustomData(!0),
                        s = t.findWhere(i, {
                            id: n.layer.id
                        });
                    if (typeof s != "undefined") {
                        if (typeof n.layer.shapes != "undefined") {
                            var o = t.pluck(t.pluck(n.layer.shapes, "properties"), "featureid");
                            t.each(s.shapes, function(e) {
                                o.indexOf(e.properties.featureid) < 0 && n.layer.shapes.push(e)
                            })
                        }
                        t.extend(s, n.layer)
                    } else {
                        var u = n.layer;
                        u.color = this.model.getLayer(n.layer.id).getColor(), i.push(u)
                    }
                    this.model.getRouter().queryUpdate({
                        cdata: r.pack(i)
                    })
                },
                mapMarkerClick: function(e, n) {
                    t.pluck(this.model.getOceans().models, "id").indexOf(n.locationId) >= 0 && this.$el.trigger("oceanLinkClick", {
                        target: e.target,
                        id: n.locationId
                    }), t.pluck(this.model.getStories().models, "id").indexOf(n.locationId) >= 0 && this.$el.trigger("storyLinkClick", {
                        target: e.target,
                        id: n.locationId
                    })
                },
                storyItemActivated: function(e, t) {
                    this.model.getRouter().queryUpdate({
                        layers: t.layerIds
                    })
                },
                layerToggled: function(e, n) {
                    var r = typeof n.toggle != "undefined" ? n.toggle : this.model.getActiveLayerIds().indexOf(n.id) === -1,
                        i = typeof n.id == "string" ? [n.id] : n.id;
                    this.model.getRouter().queryUpdate({
                        cedit: "",
                        layers: r ? t.uniq(this.model.getActiveLayerIds().concat(i)) : t.difference(this.model.getActiveLayerIds(), i)
                    })
                },
                preloadLayers: function(e, t) {
                    var n = this;
                    waitFor(function() {
                        return n.model.layersConfigured() && n.model.mapConfigured()
                    }, function() {
                        n.model.preloadLayers(t.layerids)
                    })
                },
                layerCategoryClose: function(e, t) {
                    this.model.getRouter().queryDelete("cat")
                },
                layerCategoryOpen: function(e, t) {
                    this.model.getRouter().update({
                        link: !0,
                        extendQuery: !0,
                        path: "home",
                        query: {
                            cat: t.id,
                            cedit: ""
                        }
                    })
                },
                layerCategoryRemove: function(e, n) {
                    var r = t.pluck(this.model.getActiveLayers().byCategory(n.id).models, "id");
                    this.model.getRouter().queryUpdate({
                        cedit: "",
                        layers: t.difference(this.model.getActiveLayerIds(), r)
                    })
                },
                layerCategoryLinkClick: function(e, t) {
                    var n = this.model.getRouter().queryToggle({
                        cat: t.id,
                        cedit: ""
                    }, !1);
                    this.model.getRouter().update({
                        link: !0,
                        path: "home",
                        query: n
                    })
                },
                layerInfoLinkClick: function(e, t) {
                    this.model.isViewActive("layers") ? this.model.getRouter().update({
                        route: "layers",
                        path: t.id
                    }) : this.model.getRouter().queryUpdate({
                        modal: "layer",
                        modalid: t.id
                    })
                },
                layerInfoSubpage: function(e, t) {
                    var n = this.model.getLayers().get(t.id);
                    this.model.getRouter().update({
                        route: "layers",
                        path: t.id,
                        query: {
                            view: this.model.getOcean(n.getOcean()).getMapview(),
                            ocean: n.getOcean(),
                            layers: [t.id]
                        }
                    })
                },
                closeLayerInfo: function(e, t) {
                    var n = this.model.getLayers().get(t.id);
                    this.model.isViewActive("layers") ? typeof n.getOcean() != "undefined" ? this.model.getRouter().update({
                        link: !0,
                        extendQuery: !0,
                        path: "home",
                        query: {
                            cat: n.getCategory(),
                            cedit: "",
                            ocean: n.getOcean()
                        }
                    }) : this.model.getActiveOceanId() !== "" ? this.model.getRouter().update({
                        link: !0,
                        extendQuery: !0,
                        path: "home",
                        query: {
                            cat: "",
                            cedit: "",
                            ocean: this.model.getActiveOceanId()
                        }
                    }) : this.model.getRouter().resetApp() : this.model.isViewActive("modal") && this.model.getRouter().queryDelete(["modal", "modalid"])
                },
                modalOpen: function(e, t) {
                    this.model.getRouter().queryUpdate({
                        modal: t.type
                    })
                },
                modalClose: function(e, t) {
                    this.model.getRouter().queryDelete(["modal", "modalid"])
                }
            },
            initialize: function() {
                this.layerModels = {
                    arcgis: C,
                    arcgisraster: k,
                    topo: L,
                    geojson: A,
                    mapbox: O,
                    custom: M,
                    appconfig: _
                }, this.views = this.model.getViews();
                var e = this;
                waitFor(function() {
                    return e.model.appConfigured()
                }, function() {
                    e.checkMode(), e.render(), e.model.loadMapConfig(), e.model.loadLayersConfig(), waitFor(function() {
                        return e.model.layersConfigLoaded() && e.model.mapConfigLoaded()
                    }, function() {
                        e.configureLayers()
                    })
                }), waitFor(function() {
                    return e.model.mapReady()
                }, function() {
                    e.$el.addClass("app-loaded")
                }), this.listenTo(this.model, "change:route", this.routeChanged), this.listenTo(this.model, "change:serverStateId", this.serverStateIdChanged), this.listenTo(this.model, "change:printURL", this.printUrlChanged)
            },
            render: function() {
                this.setClass(), this.setNavBottomOceanActiveClass(), this.setNavBottomModuleActiveClass();
                var e = this;
                return this.model.validateRouter(function(t) {
                    t && (waitFor(function() {
                        return e.model.layersConfigured()
                    }, function() {
                        e.updateCustomLayers(), e.model.setActiveLayersFromQuery()
                    }), e.renderHeader(), e.renderHome(), e.renderOcean(), e.renderStory(), e.renderPages(), e.renderLayers(), e.renderMap(), e.renderModal(), e.renderKey(), e.model.getMode() === "print" && e.renderPrint())
                }), this
            },
            setClass: function() {
                this.$el.removeClass(function(e, t) {
                    return (t.match(/\bmodule-\S+/g) || []).join(" ")
                }), this.$el.removeClass(function(e, t) {
                    return (t.match(/\bocean-\S+/g) || []).join(" ")
                }), this.$el.removeClass("layer-item"), this.$el.removeClass("layer-category"), this.$el.addClass(this.model.getActiveModule().class), this.model.getActiveLayerId() !== "" ? this.$el.addClass("layer-item") : this.model.isViewActive("layers") && this.model.getActiveCategory() !== "" && this.$el.addClass("layer-category"), this.model.getActiveOceanId() !== "" && this.$el.addClass("ocean-" + this.model.getActiveOceanId())
            },
            setNavBottomOceanActiveClass: function() {
                this.$("#nav-bottom-oceans .ocean-link").removeClass("active"), this.model.getActiveOceanId() !== "" && this.$("#nav-bottom-oceans .ocean-link-" + this.model.getActiveOceanId()).addClass("active")
            },
            setNavBottomModuleActiveClass: function() {
                this.$("#nav-bottom-modules .module-link").removeClass("active");
                var e = this.model.getActiveModule().id === "layers" ? "layers" : "story";
                this.$('#nav-bottom-modules .module-link[data-module="' + e + '"]').addClass("active")
            },
            renderHeader: function() {
                this.views.header = this.views.header || new s({
                    el: this.$("header"),
                    model: new o({
                        mode: this.model.getMode()
                    })
                }), this.views.header.model.setActivePath(this.model.getPath()), this.views.header.model.setActivePage(this.model.getActivePage())
            },
            renderKey: function() {
                this.views.key = this.views.key || new u({
                    el: this.$("#key"),
                    model: new a({})
                });
                if (this.model.isViewActive("key")) {
                    var e = this;
                    waitFor(function() {
                        return e.model.layersConfigured()
                    }, function() {
                        e.views.key.model.setActive(!0), e.views.key.model.setActiveLayers(e.model.getKeyLayers().models), e.views.key.model.setCustomLayerData(e.model.getCustomData())
                    })
                } else this.views.key.model.setActive(!1);
                this.views.key.model.setAllowLayerToggle(this.model.getActiveModule().id === "layers")
            },
            renderPrint: function() {
                if (this.$("#print").length > 0) {
                    var e = this;
                    waitFor(function() {
                        return e.model.layersConfigured()
                    }, function() {
                        e.views.print = new f({
                            el: e.$("#print"),
                            model: new l({
                                mapid: e.model.getQuery().modalid,
                                activeLayers: e.model.getKeyLayers().models
                            })
                        })
                    })
                }
            },
            renderHome: function() {
                this.$("#home").length > 0 && !this.model.isSubpage() && (this.views.home = this.views.home || new p({
                    el: this.$("#home"),
                    model: new T({})
                }), this.model.isViewActive("home") ? this.views.home.model.setActive(!0) : this.views.home.model.setActive(!1))
            },
            renderOcean: function() {
                this.$("#ocean").length > 0 && (this.views.ocean = this.views.ocean || new d({
                    el: this.$("#ocean"),
                    model: new v({})
                }), this.model.isViewActive("ocean") ? (this.views.ocean.model.setActive(!0), this.views.ocean.model.setOcean(this.model.getActiveOcean()), this.views.ocean.model.setStories(this.model.getStoriesByOcean())) : this.views.ocean.model.setActive(!1))
            },
            renderStory: function() {
                if (this.$("#story").length > 0) {
                    var e = this;
                    waitFor(function() {
                        return e.model.layersConfigured()
                    }, function() {
                        e.views.story = e.views.story || new c({
                            el: e.$("#story"),
                            model: new h({
                                layers: e.model.getLayers()
                            })
                        }), e.model.isViewActive("story") ? (e.views.story.model.setActive(!0), e.views.story.model.setStories(e.model.getStoriesByOcean()), e.views.story.model.setStory(e.model.getActiveStory())) : (e.views.story.model.setActive(!1), e.views.story.model.setStory(null))
                    })
                }
            },
            renderPages: function() {
                this.$("#pages").length > 0 && (this.views.pages = this.views.pages || new m({
                    el: this.$("#pages"),
                    model: new g({
                        pages: this.model.getPages()
                    })
                }), this.model.isViewActive("pages") ? (this.views.pages.model.set("isSubpage", this.model.isSubpage()), this.views.pages.model.setActive(!0), this.views.pages.model.setPath(this.model.getPath())) : this.views.pages.model.setActive(!1))
            },
            renderModal: function() {
                if (this.$("#modal").length > 0) {
                    var e = this;
                    waitFor(function() {
                        return e.model.layersConfigured()
                    }, function() {
                        e.views.modal = e.views.modal || new w({
                            el: e.$("#modal"),
                            model: new E({
                                layers: e.model.getLayers(),
                                printURL: "",
                                modalid: ""
                            })
                        }), e.model.isViewActive("modal") ? (e.views.modal.model.setActive(!0), e.views.modal.model.set({
                            modal: e.model.getQuery().modal,
                            modalid: e.model.getQuery().modalid,
                            ocean: e.model.getActiveOceanId()
                        })) : (e.views.modal.model.setActive(!1), e.views.modal.model.set({
                            modal: "",
                            modalid: ""
                        }))
                    })
                }
            },
            renderMap: function() {
                if (this.$("#map").length > 0) {
                    var e = this;
                    waitFor(function() {
                        return e.model.layersConfigured() && e.model.mapConfigLoaded()
                    }, function() {
                        e.views.map = e.views.map || new y({
                            el: e.$("#map"),
                            model: new b({
                                baseLayers: e.model.getLayers().byBasemap(!0),
                                config: e.model.getMapConfig(),
                                mode: e.model.getMode()
                            })
                        }), e.model.isViewActive("map") ? (e.views.map.model.setActive(!0), e.views.map.model.setMapControl(e.model.getActiveModule().mapControl && e.model.getMode() !== "print"), e.views.map.model.setView(e.model.getActiveMapview()), e.views.map.model.setActiveLayers(e.model.getActiveLayers().models), e.views.map.model.set({
                            customLayerEdit: e.model.getCustomEdit(),
                            customLayerData: e.model.getCustomData()
                        }), e.views.map.model.setInvalidateSize(Date.now()), e.$el.removeClass("app-loaded"), waitFor(function() {
                            return e.model.mapReady()
                        }, function() {
                            e.$el.addClass("app-loaded")
                        })) : e.views.map.model.setActive(!1)
                    })
                }
            },
            renderLayers: function() {
                if (this.$("#layers").length > 0) {
                    var e = this;
                    waitFor(function() {
                        return e.model.layersConfigured()
                    }, function() {
                        e.views.layers = e.views.layers || new S({
                            el: e.$("#layers"),
                            model: new x({
                                layers: e.model.getLayers(),
                                activeLayerIds: e.model.getActiveLayerIds()
                            })
                        }), e.model.isViewActive("layers") ? e.views.layers.model.set({
                            active: !0,
                            layerId: e.model.getActiveLayerId(),
                            category: e.model.getActiveCategory(),
                            ocean: e.model.getActiveOceanId(),
                            customLayerIds: e.model.getCustomLayerIds(),
                            customLayerEdit: e.model.getCustomEdit(),
                            customLayerData: e.model.getCustomData(),
                            activeLayerIds: e.model.getActiveLayerIds()
                        }) : e.views.layers.model.setActive(!1)
                    })
                }
            },
            checkMode: function() {
                var e = this.model.getRoute(),
                    t = this.model.getQuery();
                e === "layers" && typeof t.mode != "undefined" && t.mode === "print" && (this.model.setMode("print"), this.$el.addClass("mode-print"))
            },
            configureLayers: function() {
                var e = t.map(this.model.getLayersConfig(), function(e, t) {
                        return e.order = t, e
                    }),
                    n = {
                        baseurl: this.model.getBaseURL(),
                        comparator: "order",
                        print: this.model.getMode() === "print",
                        mapConfig: this.model.getMapConfig(),
                        eventContext: this.$el
                    },
                    r = new N(null, n),
                    i = t.chain(e).pluck("source").uniq().value();
                t.each(i, function(i) {
                    r.add((new N(t.filter(e, function(e) {
                        return e.source === i
                    }), t.extend({}, n, {
                        model: this.layerModels[i]
                    }))).models)
                }, this), this.model.setLayers(r), this.initNavLayers(), this.model.layersConfigured(!0)
            },
            initNavLayers: function() {
                this.model.getLayer("oceans").makeLayer(t.map(this.model.getOceans().models, function(e) {
                    return {
                        location: e.getMarker(),
                        title: e.getTitle(),
                        id: e.id
                    }
                })), t.each(this.model.getOceans().models, function(e) {
                    this.model.getLayer(e.id).makeLayer(t.map(this.model.getStoriesByOcean(e.id), function(e) {
                        return {
                            location: e.getMarker(),
                            title: e.getTitle(),
                            id: e.id
                        }
                    }), {
                        labelOptions: {
                            options: {
                                offset: [0, 0],
                                direction: "right",
                                pane: "popupPane",
                                className: "storyLabel"
                            },
                            timeout: 3e3
                        }
                    })
                }, this)
            },
            updateCustomLayers: function() {
                var e = this;
                waitFor(function() {
                    return e.model.layersConfigured()
                }, function() {
                    var n = e.model.getCustomLayerIds();
                    e.model.getLayers().remove(t.difference(t.pluck(e.model.getLayers().bySource("custom").models, "id"), n)), t.each(n, function(n) {
                        typeof e.model.getLayer(n) == "undefined" && e.model.getLayers().add(new e.layerModels.custom({
                            id: n,
                            title: "",
                            category: "custom",
                            source: "custom",
                            type: "mixed"
                        }, {
                            collection: e.model.getLayers()
                        })), e.model.getLayer(n).setEdit(n === e.model.getCustomEdit());
                        var r = t.findWhere(e.model.getCustomData(!0), {
                            id: n
                        });
                        e.model.getLayer(n).setCustomData(r)
                    })
                })
            },
            routeChanged: function() {
                this.model.pushHistory({
                    fragment: n.history.fragment
                }), this.render()
            },
            serverStateIdChanged: function() {
                this.model.getRouter().queryUpdate({
                    modal: "print",
                    modalid: this.model.getServerStateId()
                })
            },
            printUrlChanged: function() {
                this.views.modal.model.setPrintURL(this.model.getPrintURL())
            }
        });
        return D
    }), define("models/ContentCollection", ["jquery", "underscore", "backbone"], function(e, t, n) {
        var r = n.Collection.extend({});
        return r
    }), define("models/OceanModel", ["jquery", "underscore", "backbone", "./ContentModel"], function(e, t, n, r) {
        var i = r.extend({
            initialize: function(e) {
                this.options = e || {}, this.isContentLoading = !1, this.isContentLoaded = !1;
                var t = "/ocean/" + this.id + "/";
                this.set("url", t)
            },
            getTitle: function() {
                return tlang.oceans[this.id]
            },
            getMapview: function() {
                return this.attributes.mapview
            },
            getMarker: function() {
                return this.attributes.marker.split("|").reverse()
            }
        });
        return i
    }), define("models/StoryModel", ["jquery", "underscore", "backbone", "./ContentModel"], function(e, t, n, r) {
        var i = r.extend({
            initialize: function(e) {
                this.options = e || {}, this.isContentLoading = !1, this.isContentLoaded = !1;
                var t = "/story/" + this.id + "/";
                this.set("url", t)
            },
            getTitle: function() {
                return this.attributes.title[lang]
            },
            getOceanId: function() {
                return this.attributes.ocean
            },
            getMapview: function() {
                return this.attributes.mapview
            },
            getMarker: function() {
                return this.attributes.marker.split("|").reverse()
            }
        });
        return i
    }), define("models/PageModel", ["jquery", "underscore", "backbone", "./ContentModel"], function(e, t, n, r) {
        var i = r.extend({
            initialize: function(e) {
                this.options = e || {}, this.isContentLoading = !1, this.isContentLoaded = !1, this.attributes.parent === "undefined" && (this.attributes.parent = this.id);
                var t = "/page/" + this.id + "/";
                this.set("url", t)
            },
            getTitle: function() {
                return this.attributes.title[lang]
            },
            getParent: function() {
                return this.attributes.parent
            }
        });
        return i
    }), define("components/app/AppModel", ["jquery", "underscore", "backbone", "jsonpack", "models/ContentCollection", "models/OceanModel", "models/StoryModel", "models/PageModel"], function(e, t, n, r, i, s, o, u) {
        var a = n.Model.extend({
            initialize: function(t) {
                this.options = t || {}, this.set("appConfigLoaded", !1), this.set("layersConfigLoaded", !1), this.set("mapConfigLoaded", !1), this.set("layersConfigured", !1);
                var n = this;
                e.ajax({
                    dataType: "json",
                    url: this.attributes.baseurl + "/" + this.attributes.configPath,
                    success: function(e) {
                        n.setConfig(e[0]), n.initModels()
                    },
                    error: function() {
                        console.log("error loading app config")
                    }
                }), window.systemapic = {
                    ready: function() {
                        return n.mapReady()
                    },
                    version: "0.4",
                    app: this,
                    style: "color: blue; font-weight: bold"
                }
            },
            setConfig: function(e) {
                return this.set("config", e)
            },
            getConfig: function() {
                return this.attributes.config
            },
            initModels: function() {
                this.setPages(new i(this.getConfig().pages, {
                    model: u
                })), this.setOceans(new i(this.getConfig().oceans, {
                    model: s
                })), this.setStories(new i(this.getConfig().stories, {
                    model: o
                }))
            },
            storeMapStateOnServer: function(e) {
                e = typeof e != "undefined" ? e : !1, e && this.set("printURL", "loading");
                var n = Math.random().toString(36).slice(-8);
                this.set("serverStateId", n);
                var r = "http://www.rom.on.ca/wwf/#!" + window.location.href.split("#!")[1] + "&mode=print",
                    i = t.clone(this.attributes.route);
                typeof i.query != "undefined" && (i.query = t.clone(i.query), delete i.query.print, delete i.query.modal, delete i.query.modalid);
                var s = JSON.stringify({
                        map: n,
                        state: {
                            map_state: i,
                            snapshot: e,
                            print_url: r
                        }
                    }),
                    o = {
                        json: s,
                        url: this.attributes.serverURL + "set"
                    };
                return this.request(o, function(t, r) {
                    if (t || !r) return console.error("Something went wrong: ", t || "No response data.");
                    console.log("%cSaved state to server, got this response: ", systemapic.style, r), this.set("serverStateId", n), e && this.getScreenshotFromServer(n, function(e, t) {
                        if (e) return console.error("Something went wrong: ", e);
                        this.set("printURL", t)
                    }.bind(this))
                }.bind(this)), n
            },
            getPrintURL: function() {
                return this.attributes.printURL
            },
            setPrintURL: function(e) {
                this.set("printURL", e)
            },
            getMapStateFromServer: function(e, t) {
                var n = JSON.stringify({
                        map: e
                    }),
                    r = {
                        url: this.attributes.serverURL + "get",
                        json: n
                    };
                return this.request(r, function(e, n) {
                    if (e) return console.error("Something went wrong:", e);
                    console.log("%cGot saved state from server: ", systemapic.style, n), n = this.parse(n), t && t(n.err, n.data)
                }.bind(this)), this
            },
            getScreenshotFromServer: function(e, t) {
                var n = JSON.stringify({
                        map: e,
                        width: 3300,
                        height: 2550,
                        quality: 100
                    }),
                    r = {
                        url: this.attributes.serverURL + "print",
                        json: n
                    };
                return this.request(r, function(e, n) {
                    if (e) return console.error("Something went wrong: ", e);
                    var r = this.parse(n);
                    console.log("%cReceived data: ", systemapic.style, r);
                    if (!r) return console.error("Something went wrong: no data.");
                    if (r.err) return console.error("Something went wrong: ", r.err);
                    var i = this.attributes.serverURL + "print/" + r.print_id + ".jpeg";
                    console.log("%cGET screenshot at this url:", systemapic.style, i), t && t(null, i)
                }.bind(this)), this
            },
            request: function(e, t) {
                var n = e.url,
                    r = e.json;
                if (!n || !r) return console.error("Missing parameters!");
                var i = new XMLHttpRequest;
                i.open("POST", n, !0), i.setRequestHeader("Content-type", "application/json"), i.onreadystatechange = function() {
                    if (i.readyState != 4) return;
                    i.status == 200 ? t && t(null, i.responseText) : t && t(i.status)
                }, i.send(r)
            },
            getServerStateId: function() {
                return this.attributes.serverStateId
            },
            parse: function(e) {
                try {
                    var t = JSON.parse(e)
                } catch (n) {
                    console.error("error parsing: ", n, e);
                    var t = !1
                }
                return t
            },
            validateRouter: function(e) {
                var n = this.getActiveModule(),
                    r = this.get("router");
                if (n === "") r.update({
                    route: "home"
                }), e(!1);
                else if (typeof this.getQuery().view == "undefined") r.queryUpdate({
                    view: this.getMapviewForModule(!0)
                }), e(!1);
                else {
                    var i = this.getActiveLayerIds(),
                        s = this.getLayerIdsByModule(n.id),
                        o = t.intersection(i, s);
                    if (o.length !== s.length) r.queryUpdate({
                        layers: t.union(i, s)
                    }), e(!1);
                    else {
                        var u = !0;
                        if (n.id === "ocean") {
                            var a = this.getActiveOcean(),
                                i = this.getActiveLayerIds(),
                                f = this.getLayerIdsByOcean(a.id),
                                l = t.intersection(i, f);
                            l.length !== f.length && (r.queryUpdate({
                                layers: t.union(i, f)
                            }), u = !1)
                        }
                        if (!u) e(!1);
                        else {
                            var c = t.difference(t.keys(this.getQuery()), n.query_allow);
                            c.length > 0 ? (r.queryAllow(n.query_allow, !0), e(!1)) : e(!0)
                        }
                    }
                }
            },
            getViews: function() {
                return this.attributes.views
            },
            getRouter: function() {
                return this.attributes.router
            },
            getBaseURL: function() {
                return this.attributes.baseurl
            },
            setRoute: function(e) {
                return this.set("route", {
                    route: e.route,
                    path: e.path,
                    query: e.query
                }), this
            },
            getDeFactoRoute: function() {
                return this.attributes.subpage ? this.attributes.sourcePath.route : this.attributes.route.route
            },
            isSubpage: function(e) {
                if (typeof e == "undefined") return this.attributes.subpage;
                this.set("subpage", e)
            },
            getHistory: function() {
                return this.attributes.history
            },
            getHistoryWithoutPages: function() {
                return t.filter(this.attributes.history, function(e) {
                    return !e.fragment.startsWith("!/page")
                })
            },
            pushHistory: function(e) {
                this.attributes.history.push(e)
            },
            getRoute: function() {
                return this.attributes.route.route
            },
            getPath: function() {
                return this.attributes.route.path
            },
            getQuery: function() {
                return this.attributes.route.query
            },
            getSourcePath: function() {
                return this.attributes.sourcePath
            },
            setSourceQuery: function(e) {
                this.attributes.sourcePath.query = e
            },
            getActiveCategory: function() {
                return typeof this.attributes.route.query.cat != "undefined" ? this.attributes.route.query.cat : ""
            },
            setMode: function(e) {
                this.set("mode", e)
            },
            getMode: function() {
                return this.attributes.mode
            },
            appConfigured: function() {
                return typeof this.attributes.config != "undefined"
            },
            isViewActive: function(e) {
                var t = {
                        home: ["home", "map"],
                        ocean: ["ocean", "map"],
                        story: ["story", "map", "key"],
                        layers: ["layers", "map", "key"],
                        page: ["pages"]
                    },
                    n = {
                        modal: typeof this.getQuery().modal != "undefined"
                    };
                return t[this.getDeFactoRoute()].indexOf(e) >= 0 || typeof n[e] != "undefined" && n[e]
            },
            getModule: function(e) {
                return typeof e != "undefined" ? t.findWhere(this.attributes.config.modules, {
                    id: e
                }) : this.getActiveModule()
            },
            getActiveModule: function() {
                var e = this.getRoute();
                return t.contains(t.pluck(this.attributes.config.modules, "id"), e) ? t.findWhere(this.attributes.config.modules, {
                    id: e
                }) : ""
            },
            setPages: function(e) {
                this.set("pages", e)
            },
            getPages: function() {
                return this.attributes.pages
            },
            getActivePage: function() {
                return this.attributes.pages.findWhere({
                    id: this.getPath()
                })
            },
            layersLoading: function() {
                return typeof this.attributes.layerCollection == "undefined" ? !0 : this.attributes.layerCollection.isLoading()
            },
            layerLoaded: function(e) {
                return this.getLayers().get(e).isLoaded()
            },
            layersConfigLoaded: function() {
                return typeof this.attributes.layersConfig != "undefined"
            },
            layersConfigured: function(e) {
                if (typeof e == "undefined") return this.attributes.layersConfigured;
                this.set("layersConfigured", e)
            },
            loadLayersConfig: function() {
                var t = this;
                e.ajax({
                    dataType: "json",
                    url: this.attributes.baseurl + "/" + this.attributes.config.layersConfig,
                    success: function(e) {
                        t.set("layersConfig", e)
                    },
                    error: function() {
                        console.log("error loading layer config")
                    }
                })
            },
            getLayersConfig: function() {
                return this.attributes.layersConfig
            },
            getLayer: function(e) {
                return this.getLayers().get(e)
            },
            getLayers: function() {
                return this.attributes.layerCollection
            },
            setLayers: function(e) {
                return this.set("layerCollection", e), this
            },
            setActiveLayersFromQuery: function() {
                return this.attributes.layerCollection.setActive(this.getActiveLayerIds()), this
            },
            getActiveLayers: function() {
                return this.attributes.layerCollection.byActive()
            },
            getActiveLayerIds: function() {
                var e = this.attributes.route.query;
                return typeof e.layers != "undefined" ? e.layers : []
            },
            getActiveLayerId: function() {
                return this.isLayerItemActive() ? this.getPath() : ""
            },
            isLayerItemActive: function() {
                return this.isViewActive("layers") && this.getPath() !== "home"
            },
            getLayerIdsByModule: function(e) {
                var n = typeof e != "undefined" ? this.getModule(e) : this.getActiveModule();
                return typeof n.layers != "undefined" || n.layers === "" ? t.map(n.layers.split(","), function(e) {
                    return e.trim()
                }) : []
            },
            getLayerIdsByOcean: function(e) {
                var n = typeof e != "undefined" ? this.getOcean(e) : this.getActiveOcean();
                return typeof n.get("layers") != "undefined" || n.get("layers") === "" ? t.map(n.get("layers").split(","), function(e) {
                    return e.trim()
                }) : []
            },
            getLayerIdsByGroup: function(e) {
                return t.pluck(this.getLayers().byGroup(e).models, "id")
            },
            preloadLayers: function(e) {
                t.each(e, function(e) {
                    var t = this.attributes.layerCollection.get(e);
                    this.attributes.views.map.model.preloadLayer(t)
                }, this)
            },
            getKeyLayers: function() {
                return this.attributes.layerCollection.byActiveKey()
            },
            getCustomData: function(e) {
                e = typeof e != "undefined" ? e : !1;
                var t = this.attributes.route.query,
                    n = typeof t.cdata != "undefined" ? t.cdata : r.pack([]);
                return e ? r.unpack(n) : n
            },
            getCustomLayerIds: function() {
                var e = this.attributes.route.query;
                return typeof e.clayers != "undefined" ? e.clayers : []
            },
            getCustomEdit: function() {
                var e = this.attributes.route.query;
                return typeof e.cedit != "undefined" ? e.cedit : ""
            },
            loadMapConfig: function() {
                var t = this;
                e.ajax({
                    dataType: "json",
                    url: this.attributes.baseurl + "/" + this.attributes.config.mapConfig,
                    success: function(e) {
                        t.set("mapConfig", e[0]), t.set("mapConfigLoaded", !0)
                    },
                    error: function() {
                        console.log("error loading map config")
                    }
                })
            },
            mapConfigLoaded: function() {
                return this.attributes.mapConfigLoaded
            },
            getMapConfig: function() {
                return this.attributes.mapConfig
            },
            mapReady: function() {
                return this.appConfigured() && this.layersConfigured() && this.mapConfigured() && !this.layersLoading()
            },
            mapConfigured: function() {
                return typeof this.attributes.views.map != "undefined" && this.attributes.views.map.model.mapConfigured()
            },
            getActiveMapview: function(e) {
                e = typeof e != "undefined" ? e : !1;
                var t = typeof this.attributes.route.query.view != "undefined" ? this.attributes.route.query.view : "default";
                return e ? t : this.toMapviewObject(t)
            },
            toMapviewObject: function(e) {
                if (typeof e != "undefined") {
                    var t = e.split("||");
                    if (t.length === 2) {
                        var e = t[0].split("|"),
                            n = t[1].split("|");
                        return e.length === 3 && n.length === 2 ? {
                            center: {
                                lat: parseFloat(e[0]),
                                lng: parseFloat(e[1])
                            },
                            zoom: parseFloat(e[2]),
                            dimensions: [parseFloat(n[0]), parseFloat(n[1])]
                        } : null
                    }
                    return e
                }
                return null
            },
            getMapviewForModule: function(e) {
                e = typeof e != "undefined" ? e : !1;
                var t = this.getActiveModule(),
                    n;
                switch (t.id) {
                    case "home":
                        n = t.mapview;
                        break;
                    case "story":
                        n = this.getActiveStory().getMapview();
                        break;
                    case "ocean":
                        n = this.getActiveOcean().getMapview();
                        break;
                    default:
                        n = this.getActiveMapview(!0)
                }
                return e ? n : this.toMapviewObject(n)
            },
            getOcean: function(e) {
                return this.attributes.oceans.findWhere({
                    id: e
                })
            },
            setOceans: function(e) {
                this.set("oceans", e)
            },
            getOceans: function() {
                return this.attributes.oceans
            },
            getActiveOcean: function() {
                return this.getOcean(this.getActiveOceanId())
            },
            getActiveOceanId: function() {
                return this.attributes.route.route === "home" ? "" : this.attributes.route.route === "ocean" ? this.attributes.route.path : this.attributes.route.route === "story" ? this.getActiveStory().getOceanId() : typeof this.attributes.route.query.ocean != "undefined" ? this.attributes.route.query.ocean : ""
            },
            getNextOceanId: function() {
                var e = this.getActiveOceanId(),
                    n = t.pluck(this.attributes.oceans.models, "id"),
                    r = n.indexOf(e),
                    i = r === n.length - 1 ? 0 : r + 1;
                return n[i]
            },
            getPreviousOceanId: function() {
                var e = this.getActiveOceanId(),
                    n = t.pluck(this.attributes.oceans.models, "id"),
                    r = n.indexOf(e),
                    i = r === 0 ? n.length - 1 : r - 1;
                return n[i]
            },
            getStory: function(e) {
                return this.attributes.stories.findWhere({
                    id: e
                })
            },
            setStories: function(e) {
                this.set("stories", e)
            },
            getStories: function() {
                return this.attributes.stories
            },
            getStoriesByOcean: function(e) {
                return e = typeof e != "undefined" ? e : this.getActiveOceanId(), this.attributes.stories.where({
                    ocean: e
                })
            },
            getActiveStory: function() {
                return this.getStory(this.getActiveStoryId())
            },
            getActiveStoryId: function() {
                return this.attributes.route.route === "story" ? this.attributes.route.path : ""
            },
            getNextStoryId: function() {
                var e = this.getActiveStoryId(),
                    n = t.pluck(this.attributes.stories.where({
                        ocean: this.getActiveOceanId()
                    }), "id"),
                    r = n.indexOf(e),
                    i = r === n.length - 1 ? 0 : r + 1;
                return n[i]
            },
            getPreviousStoryId: function() {
                var e = this.getActiveStoryId(),
                    n = t.pluck(this.attributes.stories.where({
                        ocean: this.getActiveOceanId()
                    }), "id"),
                    r = n.indexOf(e),
                    i = r === 0 ? n.length - 1 : r - 1;
                return n[i]
            }
        });
        return a
    }), define("router", ["jquery", "underscore", "backbone", "jquery.deparam", "components/app/AppView", "components/app/AppModel"], function(e, t, n, r, i, s) {
        var o = {},
            u = n.Router.extend({
                routes: {
                    "": "root",
                    "/": "root",
                    "!": "root",
                    "!/": "root",
                    "!/home": "home",
                    "!/home/": "home",
                    "!/ocean/*path": "ocean",
                    "!/story/*path": "story",
                    "!/id/:id": "id",
                    "!/layers": "layers",
                    "!/layers/": "layers",
                    "!/layers/*path": "layers",
                    "!/page/:page": "page"
                },
                resetApp: function(e) {
                    o.model.isSubpage() ? window.location.href = "http://" + window.location.host + o.model.getBaseURL() + (lang === "en" ? "" : "/" + lang) + "/" : this.navigate("", {
                        trigger: !0
                    })
                },
                goToFragment: function(e) {
                    this.navigate(e, {
                        trigger: !0
                    })
                },
                queryAllow: function(e) {
                    this.queryDelete(t.difference(t.keys(o.model.getQuery()), e))
                },
                queryDelete: function(e) {
                    var n = t.clone(o.model.getQuery());
                    typeof e == "string" ? delete n[e] : t.each(e, function(e) {
                        delete n[e]
                    }), this.update({
                        query: n,
                        replace: !0
                    })
                },
                queryUpdate: function(e, n) {
                    var n = typeof n != "undefined" ? n : !0,
                        e = t.extend({}, o.model.getQuery(), e);
                    return this.update({
                        query: e,
                        trigger: n,
                        replace: !0
                    }), e
                },
                queryToggle: function(e, n, r) {
                    var n = typeof n != "undefined" ? n : !0,
                        r = typeof r != "undefined" ? r : !1,
                        i = t.clone(o.model.getQuery());
                    return typeof e == "object" ? t.each(e, function(e, n) {
                        t.contains(t.keys(i), n) && i[n] === e ? delete i[n] : i[n] = e
                    }, this) : t.contains(t.keys(i), e) ? delete i[e] : i[e] = "true", n && this.update({
                        query: i,
                        link: r
                    }), i
                },
                update: function(n) {
                    var r = typeof n.link != "undefined" ? n.link : !1,
                        i = typeof n.trigger != "undefined" ? n.trigger : !0,
                        s = typeof n.replace != "undefined" ? n.replace : !1,
                        u = typeof n.extendQuery != "undefined" ? n.extendQuery : !1,
                        a = typeof n.route != "undefined" ? n.route : o.model.getRoute();
                    a = a !== "" ? "/" + a : "";
                    var f = typeof n.path != "undefined" ? n.path : o.model.getPath() !== "" ? o.model.getPath() : "";
                    f = f !== "" ? "/" + f : "";
                    var l = typeof n.query != "undefined" ? u ? t.extend({}, o.model.getQuery(), n.query) : n.query : o.model.getQuery();
                    t.each(t.clone(l), function(e, t) {
                        (!e.length || e.length === 1 && e[0] === "" || e === "^^^@]") && delete l[t]
                    }), l = e.param(l), l = l !== "" ? "?" + l : "", r && o.model.isSubpage() ? window.location.href = "http://" + window.location.host + o.model.getBaseURL() + (lang === "en" ? "" : "/" + lang) + "/#!" + a + f + l : this.navigate("!" + a + f + l, {
                        trigger: i,
                        replace: s
                    })
                },
                goBack: function() {
                    window.history.back()
                }
            }),
            a = function(t) {
                o.Router = new u;
                var r = url.replace(/\/$/, "").replace(/^\//, "").split("/"),
                    a = document.URL.match(/conf=([^&;]+?)(&|#|;|$)/),
                    f = a ? a[1] : "appConfig",
                    l = "app/config/" + f + ".json.js",
                    c, h;
                r[0] === lang ? (c = r.length > 1 ? r[1] : "", h = r.length > 2 ? r[2] : "") : (c = r[0], h = r.length > 1 ? r[1] : ""), o.model = o.model || new s({
                    sourcePath: {
                        route: c,
                        path: h,
                        query: {}
                    },
                    views: {},
                    history: [],
                    baseurl: baseurl,
                    configPath: l,
                    router: o.Router,
                    route: {
                        route: "",
                        path: "",
                        query: {}
                    },
                    serverURL: "https://printserver.wwf.ca/map/"
                }), o.model.getSourcePath().route === "" || o.model.getSourcePath().route === lang && o.model.getSourcePath().path === "" ? o.model.isSubpage(!1) : o.model.isSubpage(!0), o.Router.on("route:root", function() {
                    if (!o.model.isSubpage()) this.navigate("!/home", {
                        trigger: !0,
                        replace: !0
                    });
                    else {
                        var t = o.model.getSourcePath();
                        o.model.setRoute({
                            route: t.route,
                            path: t.path,
                            query: t.query
                        }), this.navigate("!/" + t.route + "/" + t.path + "?" + e.param(t.query), {
                            trigger: !0,
                            replace: !0
                        })
                    }
                }), o.Router.on("route:home", function(t) {
                    o.model.setRoute({
                        route: "home",
                        path: "",
                        query: t !== null && typeof t != "undefined" ? e.deparam(t) : {}
                    }), typeof o.view == "undefined" && (o.view = new i({
                        model: o.model
                    }))
                }), o.Router.on("route:id", function(t) {
                    var n = this;
                    o.model.getMapStateFromServer(t, function(t, r) {
                        if (t) return console.error("Something went wrong: ", t);
                        var i = r.state.map_state;
                        n.navigate("!/" + i.route + "/" + i.path + "?" + e.param(i.query), {
                            trigger: !0,
                            replace: !0
                        })
                    })
                }), o.Router.on("route:ocean", function(t, n) {
                    t = t !== null && typeof t != "undefined" ? t : "", n = n !== null && typeof n != "undefined" ? e.deparam(n) : {}, o.model.setRoute({
                        route: "ocean",
                        path: t,
                        query: n
                    }), typeof o.view == "undefined" && (o.view = new i({
                        model: o.model
                    }))
                }), o.Router.on("route:story", function(t, n) {
                    t = t !== null && typeof t != "undefined" ? t : "", n = n !== null && typeof n != "undefined" ? e.deparam(n) : {}, o.model.setRoute({
                        route: "story",
                        path: t,
                        query: n
                    }), typeof o.view == "undefined" && (o.view = new i({
                        model: o.model
                    }))
                }), o.Router.on("route:layers", function(t, n) {
                    t = t !== null && typeof t != "undefined" ? t : "home", n = n !== null && typeof n != "undefined" ? e.deparam(n) : {}, o.model.setRoute({
                        route: "layers",
                        path: t,
                        query: n
                    }), typeof o.view == "undefined" && (o.view = new i({
                        model: o.model
                    }))
                }), o.Router.on("route:page", function(t, n) {
                    o.model.setRoute({
                        route: "page",
                        path: t !== null && typeof t != "undefined" ? t : "about",
                        query: n !== null && typeof n != "undefined" ? e.deparam(n) : {}
                    }), typeof o.view == "undefined" && (o.view = new i({
                        model: o.model
                    }))
                }), n.history.start(), o.model.pushHistory({
                    fragment: n.history.fragment
                })
            };
        return {
            initialize: a
        }
    }), define("app", ["jquery", "underscore", "backbone", "router"], function(e, t, n, r) {
        var i = function() {
            r.initialize()
        };
        return {
            initialize: i
        }
    }),
    function() {
        var e, t = function() {},
            n = ["assert", "clear", "count", "debug", "dir", "dirxml", "error", "exception", "group", "groupCollapsed", "groupEnd", "info", "log", "markTimeline", "profile", "profileEnd", "table", "time", "timeEnd", "timeStamp", "trace", "warn"],
            r = n.length,
            i = window.console = window.console || {};
        while (r--) e = n[r], i[e] || (i[e] = t)
    }(), hexToRgb = function(e) {
        return e = e.replace("#", ""), e.length === 3 && (e = e.split(""), e = e[0] + e[0] + e[1] + e[1] + e[2] + e[2]), [parseInt(e.substr(0, 2), 16), parseInt(e.substr(2, 2), 16), parseInt(e.substr(4, 2), 16), 255]
    }, String.prototype.colorToRgb = function() {
        var e = this.toString();
        return e.charAt(0) === "#" ? hexToRgb(e) : colorToRGBA(e)
    }, Array.prototype.filter || (Array.prototype.filter = function(e) {
        var t = this.length >>> 0;
        if (typeof e != "function") throw new TypeError;
        var n = [],
            r = arguments[1];
        for (var i = 0; i < t; i++)
            if (i in this) {
                var s = this[i];
                e.call(r, s, i, this) && n.push(s)
            }
        return n
    }), String.prototype.startsWith || (String.prototype.startsWith = function(e, t) {
        return t = t || 0, this.lastIndexOf(e, t) === t
    }), String.linkify || (String.prototype.linkify = function() {
        var e = /\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim,
            t = /(^|[^\/])(www\.[\S]+(\b|$))/gim,
            n = /[\w.]+@[a-zA-Z_-]+?(?:\.[a-zA-Z]{2,6})+/gim;
        return this.replace(e, '<a href="$&">$&</a>').replace(t, '$1<a href="http://$2">$2</a>').replace(n, '<a href="mailto:$&">$&</a>')
    }), require.config({
        paths: {
            domReady: "libs/domReady",
            jquery: "libs/jquery",
            "jquery.deparam": "libs/jquery.deparam",
            "jquery.waypoints": "libs/jquery.waypoints",
            showdown: "libs/showdown",
            jsonpack: "libs/jsonpack",
            "jquery.spectrum": "libs/spectrum",
            underscore: "libs/underscore",
            backbone: "libs/backbone",
            bootstrap: "libs/bootstrap",
            leaflet: "libs/leaflet-src",
            "esri.leaflet": "libs/esri-leaflet-src",
            "leaflet.draw": "libs/leaflet.draw-custom",
            "leaflet.label": "libs/leaflet.label",
            "leaflet.markercluster": "libs/leaflet.markercluster",
            "proj4.leaflet": "libs/proj4-leaflet",
            proj4: "libs/proj4-src_infinity",
            topojson: "libs/topojson",
            templates: "templates"
        },
        shim: {
            "jquery.waypoints": {
                deps: ["jquery"]
            },
            "jquery.spectrum": {
                deps: ["jquery"]
            },
            "jquery.deparam": {
                deps: ["jquery"]
            },
            "esri.leaflet": {
                deps: ["leaflet"]
            },
            "leaflet.draw": {
                deps: ["leaflet"]
            },
            "leaflet.label": {
                deps: ["leaflet"]
            },
            "leaflet.markercluster": {
                deps: ["leaflet"]
            },
            "proj4.leaflet": {
                deps: ["leaflet", "proj4"]
            },
            leaflet: {
                exports: "L"
            },
            proj4: {
                exports: "proj4"
            }
        }
    }), require(["app"], function(e) {
        googletagmanager("GTM-MMJ5SZ"), e.initialize()
    }), define("main", function() {});

$(document).on('click', '#key .reveal-on-hover', function() {
		$(this).toggleClass('popup-key');
});

$(document).ready(function() {
	 $('#application').click(function() {
		$('.reveal-on-hover.popup-key')[0].click();
	});
});